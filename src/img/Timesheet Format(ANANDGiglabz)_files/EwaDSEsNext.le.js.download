'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1236:function(u,E,a){u=a(0);var c=a(7),b=a(15),e=a(27),f=a(87),d=a(14),h=a(83),m=a(416),l=a(78),w=a(8),n=a(70),y=a(460);class t{constructor(da,S){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=S;this.parentElement=da}b$g(){const da=this.c$g();y.a(this.$,243,242,0,S=>{this.cardViewManager=S;S.t7f(this.parentElement,2,da)})}Oaf(){this.cardViewManager&&
this.cardViewManager.fMa(-1,-1,this.parentElement)}c$g(){const da={layoutId:"AutoDetectTooltip"};da.description=this.longDescription;da.convertToDomainName=this.convertToDomainName;da.longDescription=this.longDescription;da.urlValue=this.urlValue;da.imageAltText=this.imageAltText;da.helpText=this.helpText;da.helpId=this.helpId;return da}}Object(u.a)(t,"AutoDetectCardManager",null,[]);var r=a(31),v=a(209),B=a(30),A=a(224),z=a(19),x=a(53),D=a(1);class J extends l.a{constructor(da,S,oa){super();this.gd=
K=>{if(K.Gb.id===this.uua.firstChild.id){K=this.jwe;const ea={};ea.Id=K.Ipb;this.convertToLinkedEntityManager.j4c(ea,!0,K);this.uua.removeChild(this.uua.firstChild);return!0}return!1};this.jwe=da;this.convertToLinkedEntityManager=S;this.uua=document.createElement("div");this.uua.className="clip16x16";this.Lka=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',B.a.Gg("autodetectid"+this.jwe.left),z.a.oad,x.a.we(11));D.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
D.EwaSettings.isChangeGateEnabled("OfficeVSO:7188168_ReduceInnerHTMLUsageForAutoDetectColumnHeaderButton")?oa.dk(this.uua,this.Lka):this.uua.innerHTML=this.Lka;da=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");A.a.instance.ta(d.a.click,da,this.gd)}get domElement(){return this.uua}dispose(){if(this.uua){const da=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");A.a.instance.Ba(d.a.click,da,this.gd)}super.dispose()}static get FXg(){return"clip16x16"}}Object(u.a)(J,
"AutoDetectColumnHeaderButton",l.a,[]);var L=a(1088),T=a(11),O=a(21),G=a(176);class C extends l.a{constructor(da,S,oa){super();this.htmlSanitizationHelper=null;this.$=da;this.gridView=O.h(da);this.convertToLinkedEntityManager=S;this.htmlSanitizationHelper=oa;this.U2c=new G.a}dispose(){super.dispose()}rlh(da){for(let S of this.gridView.eia)for(let oa of S){const K=oa,ea=K.Jt,ya=L.a(K.X4);this.XFg(da,ya,ea);K.hRd(ya)}}XFg(da,S,oa){if(S.length){var K=oa.length;oa[K-1]<da.left||(oa=T.HelperMethods.jw(new v.a(oa),
0,K,da.left,T.HelperMethods.FB),0>oa||!(S=S[oa]))||(this.gridView.rtl?S.classList.add(r.a.$yh):S.classList.add(r.a.Zyh),this.U2c.mb(da.left)||this.U2c.add(da.left,new J(da,this.convertToLinkedEntityManager,this.htmlSanitizationHelper)),da=this.U2c.na(da.left).domElement,!S.getElementsByClassName(J.FXg).length&&this.fIj(S)&&S.appendChild(da))}}fIj(da){const S=parseInt(da.style.width,10);var oa=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";oa=C.Lah(oa);da=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.htmlSanitizationHelper.Q_h(da.firstChild.innerHTML),
oa,!0,D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<S-(S/2+da/2)?!0:!1}static Lah(da){return`${"normal"} ${"normal"} ${da} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(u.a)(C,"AutoDetectColumnHeaderManager",l.a,[]);var H=a(425),I=a(24),M=a(64),Q=a(142),U=a(12),N=a(13),W=a(145),X=a(72);a.d(E,"a",function(){return sa});class sa extends l.a{constructor(da,S,oa,K,ea){super();this.isMac=e.a.isMac;this.fZa=
-1;this.k6b=null;this.Pta=-1;this.JN=this.gkc=this.$Ud=this.I_=this.kwe=!1;this.VT=null;this.Cg=()=>{this.exa&&this.gridView&&this.iX()};this.Bc=()=>{this.ny()};this.gd=()=>{this.xIa();O.h(this.$).kg(!0,!1)};this.pza=(ha,La)=>{La?(this.Agg(this.k6b),this.Ieb()):(ha=[29],this.gridView.qb.Xg(ha),this.gridView.qb.Ti(null,ha),this.VT&&this.VT.Oaf())};this.hj=()=>{this.G7a()&&this.Eh.hide();1===this.gridView.ha.Oe&&this.iX()};this.AR=()=>{const ha=this.gridView.ha.Oe;this.gridView.ha.ra.activeCell&&1===
ha&&this.iX()};this.onKeyUp=ha=>this.TCb?this.I_?!1:17===ha.Ca.keyCode&&this.$Ud?(this.JN?(this.Ieb(),this.Qda()):this.sMb(),!0):!1:this.I_=!1;this.onKeyDown=ha=>{if(!this.TCb)return this.I_=!1;this.$Ud=!1;this.I_=ha.ctrlKey;switch(ha.Ca.keyCode){case 27:return this.JN?(this.pza(null,!1),this.Qda()):this.VT&&(this.VT.Oaf(),this.sMb()),!0;case 13:if(this.JN)return this.JN=!1,this.xIa(),!0;break;case 17:return this.$Ud=!0}return!1};const {AutoDetectActionButton:ya}=a(1346);this.$=da;this.Jpb=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",
!1);S||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=K;K.MHb();this.Eh=new ya(da,S,this.gd,oa,"");this.hSg=new C(this.$,K,ea);this.gridView=O.h(this.$);this.gridView.ha.NT(this.Cg);this.gridView.Vb.xZa(this.Cg);this.gridView.jv(this.AR);da.ik(this.Bc);da.PA(this.hj);this.gridBlockManager=Object(h.a)(702,this.gridView.Ea);this.Ho=da.frame.Xt;this.iX()}get mc(){return this.Eh.domElement(1)}get TCb(){const da=
this.Eh.domElement(sa.Vea);return da?U.DOMElementExtensions.isVisible(da):!1}get exa(){return this.$.isEditMode&&D.EwaSettings.ma(135)&&D.EwaSettings.ma(138)&&(new Q.a(this.$.xa)).ki?!1:-1!==this.Pta}dispose(){this.gridView&&this.gridView.ha.XR(this.Cg);if(this.$){const da=this.$;da.Il(this.Bc);da.YD(this.hj);O.h(da).Ky(this.AR)}f.a.Ia(this.Eh);this.Ho=this.$=this.gridView=this.Eh=null;super.dispose()}ny(){this.pza(null,!1);this.fZa=-1;this.Eh.hide();this.jTj();this.JN=!1}Qda(){this.Eh.getButton(sa.Vea).Rcb();
this.JN=!1}sMb(){this.Eh.getButton(sa.Vea).HHb();this.Agg(this.k6b);this.JN=!0;this.$.da.$a(211,da=>{da.MQa(N.a.instance.ga(1742))})}onAutoDetectUIShown(){if(this.exa&&-1!==this.fZa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}iSg(da){var S=new I.Range(1===da.top?1:da.top-1,da.left,da.bottom,da.right,!0,!1);S=this.gridView.getRangeInformation(S);for(const oa of S)if(Object(m.a)(H.AutoDetectRange,oa)&&this.Ygc(da,!1,oa))return!0;return!1}xIa(){if(this.exa&&-1!==this.fZa){this.Eh.getButton(sa.Vea).HHb();
var da={};da.Id=this.Pta;da.StringId=null;this.convertToLinkedEntityManager.j4c(da,!0,this.k6b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");da=[Object(c.a)(new X.a,{name:"Domain",int64:this.Pta})];W.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,da);this.Pta=-1}}INh(){let da=N.a.instance.ga(1738);if(-1!==this.Pta){da+=" ";try{da+=this.convertToLinkedEntityManager.oCb(this.Pta.toString())}catch(S){b.ULS.sendTraceTag(537166982,0,10,
`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.Pta}`)}}da+=" ";return da=this.Jpb?da+N.a.instance.ga(1741):da+N.a.instance.ga(this.isMac?1740:1739)}Ieb(){this.Jpb&&(this.VT||(this.VT=new t(this.mc,this.$),this.VT.convertToDomainName=N.a.instance.ga(1743),this.VT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.VT.imageAltText=N.a.instance.ga(1745),this.VT.helpId="HID_DataTypes_Wolfram",this.VT.helpText=
N.a.instance.ga(1744)),this.VT.longDescription=this.convertToLinkedEntityManager.eZd(this.fZa.toString()),this.VT.b$g())}Ygc(da,S,oa){if((new I.Range(oa.top,oa.left,oa.bottom===w.a.fh?oa.bottom:oa.bottom+1,oa.right,!0,!1)).Bd(da)){if(S){if(oa&&oa.Ipb!==this.fZa){this.fZa=oa.Ipb;da=oa.Ipb.toString();S=this.Jpb?"":this.convertToLinkedEntityManager.eZd(da);const K=this.convertToLinkedEntityManager.Kai(da);this.Eh.Cgb(this.convertToLinkedEntityManager.oCb(da),S,K,sa.Vea)}this.Pta=oa.Ipb;this.k6b=oa}return!0}return!1}iX(){if(this.convertToLinkedEntityManager){var da=
this.gridView.ha.Oe;if(this.gridBlockManager&&this.gridBlockManager.Dkd){var S=this.gridView.ha.ra.activeCell,oa=!this.gridBlockManager.ps(S),K=this.gridView.getRangeInformation(this.gridView.vi);for(const ea of K)if(Object(m.a)(H.AutoDetectRange,ea))switch(K=ea,K.O1g){case 3:if(this.Ygc(S,!0,K)){if(1!==da||oa){this.ny();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.kKd();this.Eh.ABa(S,this.pza);this.kwe||(this.kwe=!0,this.onAutoDetectUIShown());
return}break;case 2:case 1:(D.EwaSettings.ma(467)||D.EwaSettings.ma(468))&&this.hSg.rlh(K);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.ny()}}Agg(da){const S=[29];this.gridView.qb.Ti(da,S);this.gridView.qb.Sn(S)}G7a(){return this.$.ea.isNamedObjectViewMode&&M.f(this.$.oa)}kKd(){this.Jpb&&!this.gkc&&this.Ho&&(this.Ho.Ms(d.a.Pb,this.$.domElement,this.onKeyDown,!0),this.Ho.Ms(d.a.Fd,this.$.domElement,this.onKeyUp,
!0),this.gkc=!0)}jTj(){this.Jpb&&this.gkc&&this.Ho&&(this.Ho.Vs(d.a.Pb,this.$.domElement,this.onKeyDown,!0),this.Ho.Vs(d.a.Fd,this.$.domElement,this.onKeyUp,!0),this.gkc=!1)}static get Vea(){return 1}static PPh(da){return N.a.instance.ga(1799)+n.a.space+da}}Object(u.a)(sa,"AutoDetectManager",l.a,[])},1346:function(u,E,a){a.r(E);a.d(E,"AutoDetectActionButton",function(){return d});u=a(0);E=a(78);var c=a(1236),b=a(53),e=a(13),f=a(21);class d extends E.a{constructor(h,m,l,w,n){super();this.$=h;this.wo=
w.R5b(h,m,l,"",b.a.we(11),n,"AutoDetectPointerDown",e.a.instance.ga(1799)+"...")}get zz(){return this.wo.zz}dispose(){this.wo.dispose();this.$=null;super.dispose()}domElement(h){return this.wo.domElement(h)}getButton(h){return this.wo.getButton(h,!1)}Cgb(h,m,l,w){this.wo.RUa(c.a.PPh(h),m,w);this.wo.vhg(l,m,w)}ABa(h,m){const l=f.h(this.$),w=l.ib.Ni(h);h=l.fg(h,w);const n=l.Bf(w).Am;if(h&&0<=h.x&&0<=h.y&&n.width>h.width+160){let y=h.bottomRight.x+this.zz,t=h.topLeft.y+this.zz,r=!1;y+160>n.bottomRight.x&&
(y=h.topLeft.x-this.zz,r=!0);if(t<n.topLeft.y+this.zz){if(l.ib.iCa){this.hide();return}t=n.topLeft.y+this.zz}this.wo.T8b(m,w);this.Qp(y,t,l.rtl,w,r)}else this.hide()}Qp(h,m,l,w,n){this.wo.Qp(h,m,l,w,!1,n)}hide(){this.wo.hide()}}Object(u.a)(d,"AutoDetectActionButton",E.a,[])},1453:function(u,E,a){a.r(E);u=a(0);var c=a(692),b=a(15),e=a(5),f=a(76),d=a(37),h=a(1),m=a(183),l=a(21),w=a(145);class n{constructor(Q,U){this.$=U;this.convertToLinkedEntityManager=Q}nc(Q,U){switch(U){case -1203788282:case 48568533:case -1662108744:return Q=
l.h(this.$),U=this.convertToLinkedEntityManager.aEi||7E3,(null===Q||void 0===Q?0:Q.ha)&&Q.ha.ra.$c.qH>U?!0:!1;default:return!1}}executeCommand(Q,U,N){Q=d.TaskExtensions.Sj();U=U.command;switch(U){case -1203788282:this.convertToLinkedEntityManager.u8g(N[f.a.Jc].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();
break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(N[f.a.Jc].toString());break;case 1266950951:this.convertToLinkedEntityManager.lvi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:h.EwaSettings.ma(644)&&this.convertToLinkedEntityManager.zOe();break;case 1702917262:h.EwaSettings.ma(644)&&this.convertToLinkedEntityManager.showHelpArticle(e.a.BUj);break;case -90814711:h.EwaSettings.ma(644)&&
this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===U||N[f.a.Dof]&&"ConvertToLinkedEntityGallery"===N[f.a.Dof].toString())b.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),w.a("ExpandDataTypeGallery");break;default:Q=m.a(U)}return Q}wc(Q,U){switch(U.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return h.EwaSettings.ma(130);
case -1081442996:case 1702917262:case -90814711:return h.EwaSettings.ma(644);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}}Kc(Q,U,N){return"PopulateConvertToLinkedEntityMenu"===U&&h.EwaSettings.ma(130)?this.convertToLinkedEntityManager.Kc(Q,U,N):!1}}Object(u.a)(n,"ConvertToLinkedEntityCommandHandler",null,[223]);var y=a(460);class t extends c.a{constructor(Q){super(Q)}ld(){y.a(this.$,271,272,this.Ya,Q=>{this.Yc([new n(Q,this.$)])})}static ka(Q){c.a.Nd(273,
new t(Q))}}Object(u.a)(t,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);var r=a(55);E=a(222);var v=a(758),B=a(50),A=a(417),z=a(695);class x extends E.a{constructor(Q){super();this.$=Q;this.Fb()}create(){const Q=B.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.Ya),U=B.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Ya),N=B.GetServiceTaskFactory.Oa(this.$.da,388,387,this.Ya),W=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7126083_ReduceInnerHTMLUsageForEnrichmentTaskPaneWrapper")?
B.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):r.Task.Ta(null),X=B.GetServiceTaskFactory.Oa(this.$.da,257,258,this.Ya),sa=A.a(this.$);d.TaskExtensions.Aa(d.TaskExtensions.Ed([Q,X,sa,U,N,W],this.la),()=>{this.ob(Object(z.a)(this.$.da,271,()=>new v.ConvertToLinkedEntityManager(this.$,Q.result,N.result,X.result,sa.result,U.result,W.result)))},this.$.la,3)}static ka(Q){Q.da.Ga(272,new x(Q))}}Object(u.a)(x,"ConvertToLinkedEntityManagerFactory",E.a,[]);var D=a(238),J=a(259),L=a(33),T=a(247),O=a(12),
G=a(701);const C=a(19).a.Hyh;class H extends D.a{constructor(Q,U,N){super(Q);this.vq=0;this.Sp=!1;this.Bc=()=>{this.wg(!1)};this.$=U;this.taskPaneManager=N;J.a(U).ai(this);this.$.ik(this.Bc);L.a.fd(this.$)&&(this.isVisible=!1)}LP(Q){this.get_events().addHandler("EnrichmentTaskPaneRemoved",Q)}WR(Q){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",Q)}ME(Q){this.addHandler("EnrichmentTaskPaneVilibilityChanged",Q)}kG(Q){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",Q)}rLg(Q){this.addHandler("EnrichmentTaskPaneOnFocus",
Q)}ugj(Q){this.removeHandler("EnrichmentTaskPaneOnFocus",Q)}get isVisible(){return super.isVisible}set isVisible(Q){super.isVisible=Q;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Gf(){return this.isVisible}get de(){return T.a.eqh}get jh(){return 10}get Fk(){return C}get sN(){return this.titleText}get titleText(){return"Enrichment"}get Kp(){return 300}get isResizable(){return!1}get mc(){return this.domElement}get height(){return this.taskPaneManager.XO.offsetHeight}get ZB(){return this.taskPaneManager.zva(this.mc,
this.titleText,this.Kp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Kp)}lq(){return this.Sp}Ds(){return this.Sp}FR(){}dispose(){this.$&&this.$.Il(this.Bc);this.taskPaneManager=this.$=null;super.dispose()}kg(Q,U){U||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!U}mh(Q){return O.DOMElementExtensions.yf(this.mc,Q)}sj(){}Zj(){}wg(Q){this.Sp=Q;const U=this.taskPaneManager;this.isVisible=Q;L.a.fd(this.$)?Q?this.taskPaneManager.X6("EnrichmentTaskPane",
this.ZB):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(Q&&0<U.YB.length&&(!U.oh||10!==U.oh.taskPane.jh||U.isCollapsed)&&U.nG(this,!0),U.kA());Q||(l.h(this.$).kg(!0,!1),this.$.af())}TQ(){return!1}static ka(Q,U){var N=Q.Eb;let W=document.getElementById(N+e.a.XOe);W||(W=G.a("div",Q.Eb+e.a.XOe,"cui-taskpane"),L.a.fd(Q)||(N=document.getElementById(N+e.a.xR),void 0!==N&&null!==N?N.appendChild(W):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${Q.wD}`)));
N=Q.da;return N.za(257)||N.Ga(257,new H(W,Q,U))}}Object(u.a)(H,"EnrichmentTaskPane",D.a,[683,2,368,36]);class I extends E.a{constructor(Q){super();this.hh=this.yi=null;this.$=Q;this.Fb()}get ND(){this.yi||(this.yi=d.TaskExtensions.Aa(A.a(this.$),Q=>{this.hh=H.ka(this.$,Q.result)},this.la,3));return this.yi}create(){const Q=B.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Ya),U=B.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya);d.TaskExtensions.Aa(d.TaskExtensions.ts(d.TaskExtensions.Ed([Q,
U],this.la),()=>this.ND,this.la),()=>{this.ob(this.hh)},this.la,3)}dispose(){this.hh=this.yi=this.$=null;super.dispose()}static ka(Q){Q.da.Ga(258,new I(Q))}}Object(u.a)(I,"EnrichmentTaskPaneFactory",E.a,[]);var M=a(9);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{M.a.Fa(Q=>{I.ka(Q);x.ka(Q);t.ka(Q)})})()},758:function(u,E,a){a.r(E);var c=a(0),b=a(15),e=a(87),f=a(263),d=a(4),h=a(30),m=a(816),l=a(135),w=a(82),n=a(38),y=a(19),t=a(5),r=a(161),v=a(1236),B=a(1239),
A=a(170),z=a(556),x=a(346),D=a(60);const J=(ob,Fa,Ab,$b,Cb,Rb=null)=>{Rb=ob.Na(1,Rb);return D.g(ob,"GetRichDataClassificationLabels",Rb,Fa,Ab,$b,Cb,4)},L=(ob,Fa,Ab,$b,Cb,Rb,uc,nb,Fb=null)=>{Fb=ob.Na(1,Fb);Fb.selectedRanges=Fa;Fb.domainId=Ab;Fb.autodetect=$b;return D.g(ob,"ConvertToLinkedEntity",Fb,Cb,Rb,uc,nb,4)},T=(ob,Fa,Ab,$b,Cb,Rb=null)=>{Rb=ob.Na(1,Rb);return D.g(ob,"OnAutoDetectUIShown",Rb,Fa,Ab,$b,Cb,4)},O=(ob,Fa,Ab,$b,Cb,Rb=null)=>{Rb=ob.Na(1,Rb);return D.g(ob,"GetLinkedEntityMetadata",Rb,
Fa,Ab,$b,Cb,4)},G=(ob,Fa,Ab,$b,Cb,Rb,uc=null)=>{uc=ob.Na(1,uc);uc.selectedRanges=Fa;return D.g(ob,"ConvertLinkedEntityToText",uc,Ab,$b,Cb,Rb,4)},C=(ob,Fa,Ab,$b,Cb,Rb,uc=null)=>{uc=ob.Na(1,uc);uc.selectedRanges=Fa;return D.g(ob,"RefreshLinkedEntitiesInRange",uc,Ab,$b,Cb,Rb,4)},H=(ob,Fa,Ab,$b,Cb,Rb,uc,nb,Fb,Jc,Fc=null)=>{Fc=ob.Na(1,Fc);Fc.selectedRanges=Fa;Fc.isChangeObject=Ab;Fc.isFloodgateEnabled=$b;Fc.isStarterData=Cb;Fc.starterDataDomainId=Rb;return D.g(ob,"GetDataSelectorPaneData",Fc,uc,nb,Fb,
Jc,4)},I=(ob,Fa,Ab,$b,Cb,Rb,uc,nb=null)=>{nb=ob.Na(9,nb);nb.activeCell=Fa;nb.selectionIndex=Ab;return D.g(ob,"SelectLinkedEntityForDisambiguation",nb,$b,Cb,Rb,uc,4)},M=(ob,Fa,Ab,$b,Cb,Rb,uc,nb,Fb,Jc,Fc,zb=null)=>{zb=ob.Na(1,zb);zb.searchCell=Fa;zb.searchQuery=Ab;zb.isFloodgateEnabled=$b;zb.isStarterData=Cb;zb.starterDataDomainId=Rb;zb.starterDataDomainIdString=uc;return D.g(ob,"LinkedEntitySearch",zb,nb,Fb,Jc,Fc,4)},Q=(ob,Fa,Ab,$b,Cb,Rb,uc,nb,Fb=null)=>{Fb=ob.Na(1,Fb);Fb.cell=Fa;Fb.starterDataDomainId=
Ab;Fb.starterDataDomainIdString=$b;return D.g(ob,"InsertStarterDataTable",Fb,Cb,Rb,uc,nb,4)},U=(ob,Fa,Ab,$b,Cb,Rb,uc,nb=null)=>{nb=ob.Na(1,nb);nb.activeCell=Fa;nb.isBackward=Ab;return D.g(ob,"MoveToNextAmbiguousLinkedEntity",nb,$b,Cb,Rb,uc,4)},N=(ob,Fa,Ab,$b,Cb,Rb,uc=null)=>{uc=ob.Na(9,uc);uc.activeCell=Fa;return D.g(ob,"CancelSearchLinkedEntity",uc,Ab,$b,Cb,Rb,4)},W=(ob,Fa,Ab,$b,Cb,Rb,uc,nb=null)=>{nb=ob.Na(1,nb);nb.selectedRanges=Fa;nb.letyDomainId=Ab;return D.g(ob,"GetDataTypeSelectorData",nb,
$b,Cb,Rb,uc,4)},X=(ob,Fa,Ab,$b,Cb,Rb=null)=>{Rb=ob.Na(1,Rb);return D.g(ob,"GetErrorMessageForLinkedDataTypeRefresh",Rb,Fa,Ab,$b,Cb,4)},sa=(ob,Fa,Ab,$b,Cb,Rb=null)=>{Rb=ob.Na(1,Rb);return D.g(ob,"GetHasUntrustedImageUrls",Rb,Fa,Ab,$b,Cb,4)},da=(ob,Fa,Ab,$b,Cb,Rb=null)=>{Rb=ob.Na(1,Rb);return D.g(ob,"LinkedEntitiesEnableUntrustedImages",Rb,Fa,Ab,$b,Cb,0)},S=(ob,Fa,Ab,$b,Cb,Rb=null)=>{Rb=ob.Na(1,Rb);return D.g(ob,"LinkedEntityTryAutoRefresh",Rb,Fa,Ab,$b,Cb,0)};var oa=a(84),K=a(701),ea=a(788);class ya{}
ya.Eai="EnrichmentContentFrame";ya.width=320;Object(c.a)(ya,"EnrichmentConstants",null,[]);class ha{constructor(ob){this.messageType=0;this.messageType=ob}}Object(c.a)(ha,"EnrichmentResponseMessage",null,[]);class La extends ha{constructor(ob,Fa){super(ob);this.messageContent=null;this.messageContent=Fa}}Object(c.a)(La,"EnrichmentResponseMessageWithContent",ha,[]);class Ia extends La{constructor(ob,Fa,Ab){super(ob,Fa);this.telemetryJson=null;this.telemetryJson=Ab}}Object(c.a)(Ia,"EnrichmentResponseMessageWithContentAndTelemetryData",
La,[]);var ra=a(260),pa=a(14),ba=a(95),fa=a(45),Ka=a(85),aa=a(107),ja=a(41),Va=a(80),bb=a(27),wa=a(105),ka=a(693),ta=a(25);class qa{constructor(ob,Fa,Ab,$b,Cb){this.mr=this.xk=this.iae=this.gae=this.aw=this.$u=null;this.tx=!1;this.Hi=ob;this.Yd=Fa;this.vP=Ab;this.Yb=$b;this.La=Cb;this.oqa=aa.KeyInputManager.El(Ka.a.kpa,0)}get WMb(){return!0}get pub(){return d.AFrameworkApplication.fa.Xa("EnrichmentPaneUrl")}dispose(){this.WMb&&this.mr&&(this.Hi.Ba(pa.a.click,this.mr,Object(oa.a)(this,this.rk,"onClosePaneClick")),
this.Yd.Ba(pa.a.Fd,this.mr,Object(oa.a)(this,this.hDf,"onKeyHide")));this.mr=null;this.aw&&(this.QTj(),this.aw.parentNode.removeChild(this.aw),this.aw=null);this.Yb.Ci("EnrichmentPaneId").Ik(this.oqa)}show(ob,Fa,Ab){this.$u=ob;this.tx||(this.xk=this.E1a(),this.Dna.appendChild(this.xk),this.Gbj(),this.La.Nb(ta.a.RCe,wa.a.frame,Object(oa.a)(this,this.n6h,"handleEscapeKeyAction")),this.SSa(),this.tx=!0);this.aw.src=this.pub&&this.pub.length?this.pub+"?culture="+Fa.market+"&appName="+Fa.applicationName+
"&themeId="+Fa.themeId+"&featuresBitMask="+Fa.featuresBitMask:qa.Rwf;this.gae=Fa;this.iae=Ab;this.Ceb()}nDc(ob,Fa){ob=new Ia(2,ob,Fa);this.Nrc(ob)}SSa(){const ob=this.Yb.Ci("EnrichmentPaneId");ob.parent=ra.AFrame.OOa;this.Hi.Ynb("EnrichmentPaneId",this.xk);ob.bindAction(this.oqa,ta.a.RCe)}O2f(){if(this.aw){ba.FocusManager.Voa(this.aw.contentWindow);const ob=new Ia(4,null,null);this.Nrc(ob)}}rk(){this.Z3b();return!0}hDf(ob){ob=ob.Ca.keyCode;return ob===Sys.UI.Key.enter||ob===Sys.UI.Key.space?(this.Z3b(),
!0):!1}Z3b(){this.hide();if(this.$u)this.$u.onPaneClosed()}E1a(){const ob=K.a("div","EnrichmentPaneId","EnrichmentPane");this.WMb&&ob.appendChild(this.k5c());this.oei(ob);return ob}k5c(){const ob=K.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),Fa=K.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");Fa.innerText=CommonUIStrings.l_EnrichmentPaneTitle;Fa.title=CommonUIStrings.l_EnrichmentPaneTitle;const Ab=ea.a.pb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.Hi.ta(pa.a.click,Ab,Object(oa.a)(this,this.rk,"onClosePaneClick"));this.Yd.ta(pa.a.Fd,Ab,Object(oa.a)(this,this.hDf,"onKeyHide"));ob.appendChild(Fa);ob.appendChild(Ab);this.mr=Ab;return ob}oei(ob){this.aw=K.b("iframe","","EnrichmentFrame");ob.appendChild(this.aw);this.aw.id=ya.Eai;this.aw.setAttribute("role","presentation")}Gbj(){fa.a.addHandler(this.aw,"load",Object(oa.a)(this,this.LCf,"onIFrameLoad"));fa.a.addHandler(this.aw,"error",Object(oa.a)(this,this.Woc,
"onIFrameError"));$addHandler(window,"message",Object(oa.a)(this,this.MCf,"onIFrameMessage"))}QTj(){fa.a.removeHandler(this.aw,"load",Object(oa.a)(this,this.LCf,"onIFrameLoad"));fa.a.removeHandler(this.aw,"error",Object(oa.a)(this,this.Woc,"onIFrameError"));$removeHandler(window,"message",Object(oa.a)(this,this.MCf,"onIFrameMessage"))}hhh(){this.aw.src=qa.Rwf}hide(){this.bfc();this.hhh()}n6h(ob,Fa,Ab){if(1!==Ab&&(this.hide(),this.$u))this.$u.onPaneClosed();return 32}LCf(){}Woc(){}MCf(ob){ob=ob.rawEvent;
if(!this.aw||-1!==this.aw.src.indexOf(ob.origin)){try{var Fa=ja.a(ob.data)}catch(Ab){return}if(!ka.c(Fa.messageType)){ob=window.g_badCastCallback;window.g_badCastCallback=null;switch(Fa.messageType){case 2:this.Nrc(new Ia(1,ja.c(this.gae),this.iae));break;case 1:this.Nrc(new La(0,this.gMh()));break;case 3:this.$u&&this.$u.selectEntity(Fa.messageContent);break;case 5:this.$u&&this.$u.wEb(Fa.messageContent);break;case 8:this.$u&&(Fa=ja.a(Fa.messageContent),0<Fa.DomainId?this.$u.nPd(Fa.Query,Fa.TelemetryJson,
Fa.DomainId,Fa.DomainIdString):this.$u.searchEntity(Fa.Query,Fa.TelemetryJson));break;case 6:this.$u&&this.$u.cancelSearch();break;case 11:Fa=ja.a(Fa.messageContent);Fa=qa.N5b("keydown","f6",Ka.a.xRb,!0,!1,Fa,!0,!1);this.aw&&this.aw.dispatchEvent(Fa);break;case 12:if(ja.a(Fa.messageContent).keyCode===Ka.a.JG&&(Fa=qa.N5b("keydown","esc",Ka.a.JG,!0,!1,!1,!1,!1),this.aw&&(this.aw.dispatchEvent(Fa),this.hide(),this.$u)))this.$u.onPaneClosed();break;case 13:this.$u&&this.$u.selectDataType(Fa.messageContent);
break;case 14:this.$u&&this.$u.showHelpArticle(Fa.messageContent);break;case 15:this.$u&&this.$u.showSurveyDialog(Fa.messageContent);break;case 16:this.$u&&(Fa=ja.a(Fa.messageContent),this.$u.insertTable(Fa.DomainId,Fa.DomainIdString))}window.g_badCastCallback=ob}}}gMh(){return ja.c([2,1,3,5,8,6])}Nrc(ob){ob=ja.c(ob);this.aw.contentWindow.postMessage(ob,Va.a.eba(this.pub))}static N5b(ob,Fa,Ab,$b,Cb,Rb,uc,nb){bb.a.Jw?(Rb=String.format("{0} {1} {2}",Rb?"Shift":"",uc?"Control":"",nb?"Alt":""),Rb.trim(),
Ab=document.createEvent("KeyboardEvent"),Ab.initKeyboardEvent(ob,$b,Cb,window.self,Fa,0,Rb,!1,"en-US")):(Fa={},Fa.keyCode=Ab,Fa.ctrlKey=uc,Fa.shiftKey=Rb,Fa.altKey=nb,Fa.bubbles=$b,Fa.cancelable=Cb,Ab=new KeyboardEvent(ob,Fa));return Ab}}qa.Rwf="about:blank";Object(c.a)(qa,"EnrichmentPane",null,[741,2]);class rb extends qa{constructor(ob){super(d.AFrameworkApplication.sa.Uy,d.AFrameworkApplication.sa.Xt,d.AFrameworkApplication.sa.Cea,d.AFrameworkApplication.sa.Me,d.AFrameworkApplication.ub);this.taskPane=
ob;this.taskPane.rLg(this.O2f)}get Dna(){return this.taskPane.mc}Ceb(){this.taskPane.isVisible||this.taskPane.wg(!0)}bfc(){this.taskPane.wg(!1)}dispose(){this.taskPane&&(this.taskPane.ugj(this.O2f),this.taskPane=null);super.dispose()}}Object(c.a)(rb,"EnrichmentTaskPaneWrapper",qa,[]);class Za{constructor(ob){this.cz=null;this.Ffa=ob}ovi(ob,Fa){this.cz=ob;this.Ffa&&this.Ffa.show(this,Fa,null)}nDc(ob,Fa){this.Ffa&&this.Ffa.nDc(ob,Fa)}Nyb(){this.Ffa&&this.Ffa.hide()}dispose(){this.Ffa&&(this.Ffa.dispose(),
this.Ffa=null)}selectEntity(ob){return this.cz?this.cz.selectEntity(ob):!1}searchEntity(ob,Fa){this.cz&&this.cz.searchEntity(ob,Fa)}nPd(ob,Fa,Ab,$b){this.cz&&this.cz.nPd(ob,Fa,Ab,$b)}wEb(ob){return this.cz?this.cz.wEb(ob):!1}onPaneClosed(){if(this.cz)this.cz.onPaneClosed()}cancelSearch(){this.cz&&this.cz.cancelSearch()}selectDataType(ob){this.cz&&this.cz.selectDataType(ob)}showHelpArticle(ob){this.cz&&this.cz.showHelpArticle(ob)}showSurveyDialog(ob){this.cz&&this.cz.showSurveyDialog(ob)}insertTable(ob,
Fa){this.cz&&this.cz.insertTable(ob,Fa)}}Object(c.a)(Za,"EnrichmentManager",null,[740,2]);class gb extends Za{constructor(ob){super(ob)}dispose(){super.dispose()}}Object(c.a)(gb,"ExcelEnrichmentManager",Za,[]);var mb=a(13);class Ga{constructor(ob){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=ob;this.commentQuestion=
mb.a.instance.nb(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=mb.a.instance.nb(195);this.ratingValuesAscending=[mb.a.instance.nb(196),mb.a.instance.nb(197),mb.a.instance.nb(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=mb.a.instance.nb(194)}}Object(c.a)(Ga,"FloodgateSurvey",null,[]);var ib=a(24),cc=a(76),ic=a(419),xb=a(42),Vb=a(371),wb=a(188),cb=a(33),lb=a(91),Y=a(29),Oa=a(1),Wa=a(281),Ca=a(21);class Ra{constructor(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(Ra,"EnrichmentMessageContentAppProperties",null,[]);class la{constructor(ob,Fa,Ab,$b,Cb){this.nua=this.ILe=!1;this.wdb=this.vxa=!0;this.QGb=this.fNb=!1;this.Neb=null;this.Pqc=0;this.AR=()=>{(this.wdb||this.nua)&&2!==this.Pqc&&(this.QGb||this.Tud(!1))};this.Tc=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.vMi=Rb=>{Y.a.ag(Rb.Errors)?(Rb=Y.a.sc(Rb.Errors),Rb.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Rb}`)):Rb.Result&&(this.$.ea.uk(this.Tc),this.$.ea.Uj(this.Tc),Rb=Rb.Result,this.Neb=Rb.SkydanceFeatureBitmask,this.izd(Rb),this.fNb=!0)};this.Cg=()=>{(this.wdb||this.nua)&&this.Tud(!1)};this.Qoc=(Rb,uc)=>{Y.a.ag(Rb.Errors)?b.ULS.sendTraceTag(36975688,
0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${Y.a.sc(Rb.Errors)}`):Rb.Result&&(Rb=Rb.Result,Rb.DisambiguationJson?(this.fNb=!1,this.N3f(uc),this.Neb=Rb.SkydanceFeatureBitmask,uc=Rb.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.QGb=!1,this.Aof(uc)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};
this.ePi=(Rb,uc)=>{Y.a.ag(Rb.Errors)?(uc=Y.a.sc(Rb.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${uc}`)):Rb.Result&&(Rb=Rb.Result,Rb.DisambiguationJson?(this.N3f(uc),this.Neb=Rb.SkydanceFeatureBitmask,uc=Rb.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.QGb=!0,this.Aof(uc)):b.ULS.sendTraceTag(537166939,0,10,
"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.NSi=Rb=>{Y.a.ag(Rb.Errors)?(Rb=Y.a.sc(Rb.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Rb}`),this.wdb=!0):Rb.Result&&(Rb=Rb.Result,this.Neb=Rb.SkydanceFeatureBitmask,this.izd(Rb),this.fNb=!0)};this.CVi=Rb=>{if(Y.a.ag(Rb.Errors)){const uc=Y.a.sc(Rb.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${uc}`)}Rb.Result?
(this.izd(Rb.Result),this.fNb=!0):this.nta()};this.DGf=Rb=>{Y.a.ag(Rb.Errors)?(Rb=Y.a.sc(Rb.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Rb}`)):Rb.Result?this.b9b.nDc(Rb.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.nta())};this.vRi=Rb=>{Y.a.ag(Rb.Errors)?(Rb=Y.a.sc(Rb.Errors),b.ULS.sendTraceTag(537166926,0,15,
`Failed to insert starter data table. Error id names: ${Rb}`)):this.nta()};this.$=ob;this.gridView=Ca.h(this.$);this.gridView.ha.NT(this.Cg);this.gridView.jv(this.AR);this.yPe=$b;this.convertToLinkedEntityManager=Cb;cb.a.fd(this.$)||Ab.vN(Fa);ob=new rb(Fa);this.b9b=new gb(ob);w.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Rb=>{Rb.isFeatureEnabled("mso_sendASmile",!0).then(uc=>{this.vxa=uc;return null})})}dispose(){this.$&&(this.gridView.ha.XR(this.Cg),this.gridView.Ky(this.AR))}selectEntity(ob){const Fa=
xb.o(this.gridView.ha.ra.activeCell,this.$),Ab=()=>new ic.a;Vb.a(this.$.userOperationManager,($b,Cb,Rb)=>I(this.$.pa.ya,Fa,ob,Wa.b($b,this.CVi),Cb,Rb,null),$b=>new wb.a(109,0,$b,void 0,Ab),null);return!0}searchEntity(ob,Fa,Ab=!1,$b=0,Cb=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${Fa}`);const Rb=xb.o(this.gridView.ha.ra.activeCell,this.$);Vb.a(this.$.userOperationManager,(uc,nb,Fb)=>M(this.$.pa.ya,Rb,ob,this.vxa,Ab,$b,
Cb,Wa.b(uc,this.DGf),nb,Fb,null),uc=>new wb.a(110,0,uc,16),null)}wEb(ob){const Fa=xb.o(this.gridView.ha.ra.activeCell,this.$);this.wdb=!1;Vb.a(this.$.userOperationManager,(Ab,$b,Cb)=>U(this.$.pa.ya,Fa,ob,Wa.b(Ab,this.NSi),$b,Cb,null),Ab=>new wb.a(111,0,Ab,16),null);return!0}onPaneClosed(){this.nua=!1;this.ILe=!0;this.Pqc=0;this.QGb=!1}cancelSearch(){const ob=this.FPd();ob&&Vb.a(this.$.userOperationManager,(Fa,Ab,$b)=>N(this.$.pa.ya,ob,Wa.b(Fa,this.DGf),Ab,$b,null),Fa=>new wb.a(112,0,Fa,16),null)}selectDataType(ob){b.ULS.sendTraceTag(537166977,
0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.nta();if(ob&&ob.length)if(ob=JSON.parse(ob))if(null==ob.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var Fa={};Fa.Id=ob.domainId;Fa.StringId=ob.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(Fa)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,
0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(ob){const Fa=new lb.a(-859308420,cc.a.Db,this.$.Hc,9,null);this.$.Ja.Kb(Fa,{[cc.a.og]:"HelpID="+ob,["InputMethod"]:cc.a.Db,["ShouldCanvasTakeFocus"]:!0,[cc.a.Jc]:t.a.qV})}showSurveyDialog(ob){B.a.FNb(new Ga(ob))}insertTable(ob,Fa){const Ab=this.FPd();Ab&&Vb.a(this.$.userOperationManager,($b,Cb,Rb)=>Q(this.$.pa.ya,Ab,ob,Fa,Wa.b($b,this.vRi),Cb,Rb,null),$b=>new wb.a(259,0,$b,1),null)}Tud(ob){this.launchOrCloseDisambiguationPane(ob)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,
0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const ob=this.qqj();ob&&Vb.a(this.$.userOperationManager,(Fa,Ab,$b)=>H(this.$.pa.ya,ob,!0,this.vxa,!1,null,Wa.b(Fa,this.ePi),Ab,$b,1),Fa=>new wb.a(114,0,Fa,16),null)}launchLinkedEntityDataTypeSelectorPane(ob,Fa){Vb.a(this.$.userOperationManager,(Ab,$b,Cb)=>W(this.$.pa.ya,ob,Fa,Wa.b(Ab,this.Qoc),$b,Cb,2),Ab=>new wb.a(233,0,Ab,16),null)}ivi(ob,Fa){ob&&Vb.a(this.$.userOperationManager,
(Ab,$b,Cb)=>H(this.$.pa.ya,ob,!1,!1,!0,Fa,Wa.b(Ab,this.Qoc),$b,Cb,2),Ab=>new wb.a(257,0,Ab,16),null)}N3f(ob){ob&&(this.Pqc=ob)}Aof(ob){if(Oa.EwaSettings.ma(644)){var Fa=new lb.a(-90814711,cc.a.Db,0,10,null);this.$.Ja.Kb(Fa,null)}this.nua?this.b9b.nDc(ob,null):(Fa=3,null!=this.Neb?Fa=this.Neb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(ob=this.RRh(ob,Fa))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.yPe||b.ULS.sendTraceTag(537166935,
0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.b9b.ovi(this.yPe,ob),this.nua=!0)}nta(){this.nua&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.b9b.Nyb(),this.nua=!1,this.Pqc=0,this.QGb=!1)}izd(ob){var Fa=ob.Row+1;ob=ob.Column+1;0>Fa||0>ob?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.nta(),this.$.ea.uk(this.Tc)):(Fa=new ib.Range(Fa,
ob,Fa,ob,!0,!1),this.gridView.ha.updateSelection(Fa,Fa,60),this.wdb=!0)}RRh(ob,Fa){const Ab=new Ra;Ab.applicationVersion=d.AFrameworkApplication.buildVersion;Ab.applicationName="ExcelWac";Ab.anid="00000000-0000-0000-0000-000000000000";Ab.sessionId=d.AFrameworkApplication.userSessionId;Ab.appCorrelationId=A.a.create().toString();var $b=z.a.qK(d.AFrameworkApplication.lcid);$b=$b?$b.name:null;Ab.uiLanguage=$b;Ab.market=this.Pbc($b);Ab.themeId=0;Ab.disambiguationJson=ob;Fa<=x.a.LS?Ab.featuresBitMask=
Fa:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Ab}Pbc(ob){ob=ob.split("-");return ob[ob.length-1]}launchOrCloseDisambiguationPane(ob){const Fa=this.gridView.ha.ra.activeCell;if(this.FPd()&&Fa)if(this.gridView.Bb.Ozb(Fa)){if((!this.ILe||ob||this.fNb)&&!this.gridView.eb){ob&&(this.wdb=!0);var Ab=xb.q(Fa,this.$);Vb.a(this.$.userOperationManager,($b,Cb,Rb)=>H(this.$.pa.ya,Ab,!1,this.vxa,!1,null,Wa.b($b,this.Qoc),Cb,Rb,1),$b=>
new wb.a(114,0,$b,16),null)}}else this.nta();else this.nta()}vaj(){if(this.nua){var ob=this.gridView.ha.ra.activeCell;if(ob){var Fa=xb.q(ob,this.$);Vb.a(this.$.userOperationManager,(Ab,$b,Cb)=>H(this.$.pa.ya,Fa,!1,this.vxa,!1,null,Wa.b(Ab,this.Qoc),$b,Cb,1),Ab=>new wb.a(114,0,Ab,16),null)}else this.nta()}}FPd(){const ob=this.gridView.ha.ra;return ob.Yba()?xb.o(ob.activeCell,this.$):null}qqj(){const ob=this.gridView.ha.ra;return ob.Yba()?xb.q(ob.activeCell,this.$):null}}Object(c.a)(la,"ConvertToLinkedEntityDisambiguationPane",
null,[2]);var ua=a(7),xa=a(375),fb=a(1393),Jb=a(53),Ob=a(708);class eb{constructor(ob,Fa,Ab){this.Xof=2;this.Wof="Size64by48";this.$=ob;this.Va=Fa;this.convertToLinkedEntityManager=Ab}hKh(ob,Fa){var {ConvertToLinkedEntityManager:Ab}=a(758);this.pWj();Fa=this.Va.aq(Fa).JC();let $b=0,Cb=0,Rb=!1;for(var uc of ob.Categories){const nb=this.MKh(uc,$b);nb&&(Cb===Ab.i9a&&(Rb=!0),Fa.MenuSectionList.push(nb),++$b);++Cb}Rb&&$b<=Ab.Yof&&Fa.MenuSectionList.splice(Ab.i9a,1);Ab=this.Va.Ec().j2b();uc=Jb.a.we(11);
for(const nb of ob.LongButtons)this.convertToLinkedEntityManager.xCj(nb)&&this.VHg(Ab,nb,uc);0<Ab.ControlList.length&&Fa.MenuSectionList.push(Ab);return Fa}VHg(ob,Fa,Ab){if(Fa){var $b="Data.ConvertToLinkedEntityMenuItem_"+Fa.Name,Cb=this.convertToLinkedEntityManager.FU(Fa.DomainId);Cb&&(Fa=Object(ua.a)(new xa.a,{Id:$b,ExternalId:$b,Command:"-1662108744",LabelText:Fa.Name,Alt:Fa.SuperTip,Visible:!0,MenuItemId:a(758).ConvertToLinkedEntityManager.A2a(Fa.DomainId),Image16by16:Ab,Image16by16Class:this.kbi(Cb.FontLocator)}),
ob.ControlList.push(Fa))}}HKh(ob,Fa){return Object(ua.a)(new fb.a,{Id:a(758).ConvertToLinkedEntityManager.tNe+ob.toString(),ExternalId:a(758).ConvertToLinkedEntityManager.tNe+ob.toString(),MenuItemId:a(758).ConvertToLinkedEntityManager.T8c+ob.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.hcf(Fa.FontLocator),LabelText:Fa.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.qfd(Fa)})}jSg(ob){switch(ob){case "Animal":return Ob.a.IOg;
case "Apple":return Ob.a.KPg;case "Atom":return Ob.a.dRg;case "Beaker":return Ob.a.$Sg;case "Bridge":return Ob.a.AUg;case "Cat":return Ob.a.z_g;case "City":return Ob.a.L1g;case "Constellation":return Ob.a.H6g;case "Dog":return Ob.a.Tmh;case "Finance":return Ob.a.TSg;case "GradCap":return Ob.a.b5h;case "HumanAnatomy":return Ob.a.Bai;case "LocationPointer":return Ob.a.Ixi;case "Map":return Ob.a.gZi;case "MedicineNeedle":return Ob.a.fEi;case "Mountain":return Ob.a.yFi;case "Movie":return Ob.a.RFi;case "Music":return Ob.a.cGi;
case "OuterSpace":return Ob.a.KZi;case "Planet":return Ob.a.M1i;case "Satellite":return Ob.a.Pnj;case "WolframGeneric":return Ob.a.Lmj;default:return Ob.a.t8g}}kbi(ob){if("PowerBIRibbon"!==ob)return y.a.oad;switch(ob){case "AnimalRibbon":return y.a.Yxh;case "AppleRibbon":return y.a.Zxh;case "AtomRibbon":return y.a.$xh;case "BeakerRibbon":return y.a.ayh;case "BridgeRibbon":return y.a.byh;case "CenterMapRibbon":return y.a.cyh;case "CityRibbon":return y.a.dyh;case "CurrencyRibbon":return y.a.eyh;case "ExerciseRibbon":return y.a.fyh;
case "FinanceRibbon":return y.a.ETe;case "FirstAidRibbon":return y.a.gyh;case "GlobeLightningRibbon":return y.a.hyh;case "GradCapRibbon":return y.a.iyh;case "HumanAnatomyRibbon":return y.a.jyh;case "LeafRibbon":return y.a.kyh;case "LocationPointerRibbon":return y.a.myh;case "MapRibbon":return y.a.CTe;case "MountainRibbon":return y.a.nyh;case "MovieRibbon":return y.a.oyh;case "MusicRibbon":return y.a.pyh;case "NotablePeopleRibbon":return y.a.qyh;case "OuterSpaceRibbon":return y.a.ryh;case "PartlySunnyWeatherRibbon":return y.a.syh;
case "PowerBIRibbon":return y.a.DTe;case "SatelliteRibbon":return y.a.tyh;case "WolframGenericRibbon":return y.a.lyh;case "YogaRibbon":return y.a.vyh;default:return y.a.BTe}}hcf(ob){switch(ob){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";
case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";
case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";
case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}MKh(ob,Fa){Fa=this.Va.aB("ConvertToLinkedEntitySection_"+Fa,this.Xof,this.Wof);var Ab=!1;for(var $b of ob.DomainIds){const Cb=this.convertToLinkedEntityManager.FU($b);if(!Cb||Cb.DomainBlocked||!Cb.ShowInRibbon)continue;Ab=Cb.Name;const Rb=a(758).ConvertToLinkedEntityManager.A2a($b);Fa.iu("Data.ConvertToLinkedEntityMenuItem_"+Rb,-1203788282,"QueryLinkedEntityGalleryIcon",
void 0,Rb,this.hcf(Cb.FontLocator),void 0,void 0,this.qfd(Cb),Ab);Ab=!0}if(!Ab)return null;$b=Fa.jqb(!0);Fa=this.Va.Ec();Fa.title=ob.Name;ob=Fa.j2b();ob.ControlList.push($b);return ob}pWj(){this.Xof=5;this.Wof="Size112by64"}qfd(ob){return ob.RibbonTooltipHeader?ob.RibbonTooltipHeader+"\n\n"+ob.RibbonTooltip:ob.RibbonTooltip}}Object(c.a)(eb,"ConvertToLinkedEntityMenuRenderer",null,[701]);var Ma=a(58),va=a(283),Pa=a(116),Ha=a(145),tb=a(72);class Ya{constructor(ob,Fa){this.Wkd=this.Xkd=!1;this.oUi=Ab=>
{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Xkd=!0;if(Y.a.ag(Ab.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${Y.a.sc(Ab.Errors)}`);else{var $b=0,Cb=[],Rb=!1;try{if(!Ab.Result)return;const uc=Ab.Result;if(!uc){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}Cb=this.a0i(uc);if(!Cb||!Cb.length)return;$b=Cb.length;this.uEi(Cb);this.QAa.kXf();b.ULS.sendTraceTag(537166677,
0,50,`OnReadRoamingStringSuccess MruCount:${this.QAa.Wbb.length}`);if(Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const nb of this.QAa.Wbb)if(1===(nb.Id&1048320)>>8){Rb=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Rb}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${$b} data types.`),Ab=[],Ab.push(Object(ua.a)(new tb.a,{name:"MruCount",int64:$b})),Ab.push(Object(ua.a)(new tb.a,
{name:"MruWolframAvailable",bool:Rb})),Ha.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Ab)}this.Wkd&&(this.Blg(this.QAa.Wbb),this.Wkd=!1)}};this.FYi=Ab=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Y.a.ag(Ab.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${Y.a.sc(Ab.Errors)}`):Ab.Result&&(Ab.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.hGf=
(Ab,$b,Cb)=>{Ab=Pa.a.Pe(Ab.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${Cb}. Errors: ${Y.a.sc(Ab)}.`)};this.$=ob;this.QAa=Fa}HZh(){this.Xkd||Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.Zb||(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),va.w(this.$.pa.ya,0,this.oUi,this.hGf,null,null))}Blg(ob){ob&&ob.length?
this.Xkd?(ob=this.Yrj(ob))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),va.C(this.$.pa.ya,0,ob,this.FYi,this.hGf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Wkd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}Yrj(ob){if(!ob||
!ob.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var Fa=[];for(const Ab of ob)ob={},ob.Id=Ab.Id,Ab.StringId&&(ob.StringId=Ab.StringId),Fa.push(ob);Fa="<DataTypes>"+Ma.a.hc(Fa)+"</DataTypes>";return 1906<Fa.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):Fa}a0i(ob){if(!ob)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!ob.startsWith("<DataTypes>")||!ob.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;ob=ob.substring(11,ob.length-12);if(!ob)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let Fa=[];try{Fa=Ma.a.li(ob)}catch(Ab){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Ab.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Fa.length} data types.`);return Fa}uEi(ob){const Fa=this.QAa.Wbb,Ab=this.QAa.t$i;if(Fa.length!==Ab){for(let $b=0;$b<ob.length&&Fa.length<Ab;++$b){const Cb=ob[$b];this.QAa.FU(Cb)&&!Fa.includes(Cb)&&Fa.push(Cb)}this.QAa.Wbb=Fa}}}Object(c.a)(Ya,"LinkedDataTypeRoamingHandler",null,[]);var V=a(59),za=a(50),yb=a(190),jc=a(37),Cc=a(47),Sa=a(28),na=a(282),jb=a(22),Ib=a(98);a.d(E,"ConvertToLinkedEntityManager",function(){return dc});
class dc extends n.a{constructor(ob,Fa,Ab,$b,Cb,Rb,uc){super();this.slf=this.Fsd=this.Ctd=this.xrd=this.wrd=this.R7a=this.yod=null;this.YEb=this.ykd=0;this.Fla=null;this.Jod=!1;this.Add=this.co=this.kOd=null;this.Fs=0;this.PY=null;this.TLa=8;this.m0c=this.Vof=this.whf=this.Aab=!1;this.Oza=this.JZe=this.EWe=null;this.jZc=0;this.vSg=5;this.A1b=3E4;this.Odg=!1;this.c3=null;this.Dua=Array(5);this.qgg=this.T_d=!1;this.xYf=this.svd=0;this.htmlSanitizationHelper=this.aee=null;this.K8f=!0;this.Tc=(nb,Fb)=>
{Fb.Zb&&!Fb.zBb&&this.showUntrustedImageBusinessBarIfNecessary()};this.fQi=nb=>{if(nb.Result){var Fb=nb.Result;if(Fb&&Fb.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Fb.length} labels`);var Jc=za.GetServiceTaskFactory.Oa(this.$.da,274,275,0);jc.TaskExtensions.Aa(Jc,()=>{Jc.result.$Yc(Fb,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.la,3)}}else b.ULS.sendTraceTag(537166923,
0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.zf=()=>{this.ARj();this.W6h(this.$.ea.Io.LinkedEntityAsyncRefreshStateId);this.Z7a?this.Y7h(this.$.ea.Io.RichDataClassificationLabelStateId):this.g7a&&this.f_d(!0)};this.CNi=()=>{this.T_d=!0;this.co&&this.co.vaj()};this.xPi=nb=>{if(nb&&!na.a(nb))try{nb.Result.HasUntrustedImageUrl&&(this.businessBar.ng(59,null),this.qgg=!0)}catch(Fb){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Fb}.`)}};
this.xof=()=>{if(!this.Vof&&this.fAb()&&!this.ypd())if(Ha.a("DataTabActive"),V.a.zg.fR)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var nb=this.A5b();if(nb){var Fb={};Fb.InputMethod=cc.a.Db;Fb.CalloutName=8;Fb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ja.Kb(nb,Fb);this.Vof=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.wMi=nb=>{Y.a.ag(nb.Errors)||(this.Z7a||this.f_d(!1),this.raiseEvent("LinkedEntityConverted"))};this.FWi=()=>{this.$.da.$a(211,nb=>{nb.readText(mb.a.instance.ga(1804))})};this.dd=(nb,Fb)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Fb.KV?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.qBe():this.okj(),Oa.EwaSettings.ma(644)&&this.T_d&&this.zOe())};this.HPi=nb=>{this.J3b();if(nb.Result){var Fb=nb.Result;nb=Fb.DomainDataArray;if(this.Fla=Fb.Ribbon){var Jc={};Jc.Name=mb.a.instance.ga(1794);Jc.DomainIds=this.NK;this.Fla.Categories.splice(dc.i9a,0,Jc)}0<Fb.MaximumCellsToConvert&&(this.aee=Fb.MaximumCellsToConvert);this.Fs=2;Fb=!1;if(nb){b.ULS.sendTraceTag(39949271,0,50,
`OnGetLinkedEntityServiceDomainsSuccess: Received ${nb.length} domains`);this.oOa||(this.oOa=[]);Jc=mb.a.instance.ga(1791);const Fc=mb.a.instance.ga(1793);for(const zb of nb)zb.DomainId?(this.oOa.push(zb),zb.DomainBlocked?(nb=!!zb.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${nb?zb.DomainId.Id.toString():zb.Name} is telemetry only, do not show in menu (Has String ID: ${nb})`)):(this.EU.ia(dc.A2a(zb.DomainId),zb),zb.Name===Jc||268435456===zb.DomainId.Id?this.EWe=zb.DomainId.Id.toString():
zb.Name===Fc||536870912===zb.DomainId.Id?this.JZe=zb.DomainId.Id.toString():268435712===zb.DomainId.Id&&zb.ShowInRibbon&&(this.m0c=!0),Fb=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Fb||(this.oOa=null);this.dhg();this.kOd.HZh();this.Odg||(this.wRj(),this.Odg=!0)}else this.oOa=null,this.Fs=3,-1<this.TLa&&window.setTimeout(()=>{this.MHb()},100*(8-this.TLa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
this.UJd();this.uHe();this.m0c&&this.Nif&&yb.c(this.xof,this.$.la,500);this.g7a&&!this.Z7a&&this.f_d(!0)};this.GPi=nb=>{nb=Pa.a.Pe(nb.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${Y.a.sc(nb)}].`);this.oOa=null;this.Fs=3;this.Aab=!0;this.UJd()};this.onContentReady=()=>{this.bfg()&&this.gridView.Ky(this.onContentReady);this.K8f&&this.$.workbookContext.Options&1048576&&(this.businessBar.pGj(),this.K8f=!1)};this.hj=()=>{this.J3b()};this.mSi=nb=>{if(na.a(nb)){const Fb=
za.GetServiceTaskFactory.Oa(this.$.da,5,4,0);jc.TaskExtensions.Aa(Fb,()=>{let Fc=null;if(null===nb||void 0===nb?0:nb.Errors)Fc=nb.Errors[0];Fb.result.p8f(Fc,null)},this.$.la,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Y.a.sc(nb.Errors)}].`);const Jc=Y.a.PB(nb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.Qo(Jc)}};
this.d0c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.A1b} millisecond interval`);this.Zef("Periodic auto-refresh check",this.PKi,this.OKi)};this.PKi=nb=>{na.a(nb)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Y.a.sc(nb.Errors)}].`),++this.jZc):this.jZc=0;e.a.Ia(this.Oza);this.jZc>=this.vSg?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.Oza=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.Oza=Cc.a.instance.create(this.d0c,this.A1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.OKi=nb=>{nb=Pa.a.Pe(nb.data);f.a.Dh(nb)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${Y.a.sc(nb)}].`);e.a.Ia(this.Oza);this.Oza=Cc.a.instance.create(this.d0c,this.A1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.mTi=nb=>{nb=!!nb.Result&&nb.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${nb.toString()}`);nb?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${Sa.a.Qa.ve.m-
this.ykd} ms, retry count = ${this.YEb}`),this.MHb()):this.jAc()};this.lTi=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.jAc()};this.iPi=nb=>{nb.Result?(nb=nb.Result)?(this.eLd(),this.businessBar.p8f(null,nb)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=ob;this.businessBar=Rb;this.svgIconProvider=
Ab;this.htmlSanitizationHelper=uc;this.oOa=[];this.NK=[];this.gridView=Ca.h(this.$);this.xec=-1;this.tni=Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.g7a=this.$.ma(436)&&this.$.ma(287);this.Z7a=this.$.ma(664);this.Nif=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.EU=new Ib.a;this.Q9a=new eb(ob,Fa,this);$b&&(this.co=new la(ob,$b,Cb,this,this));this.$.ml(this.dd);r.a(this.$)&&
r.a(this.$).Btj(this);this.qBe();(this.g7a||this.Z7a)&&this.$.ea.ku(this.zf);Oa.EwaSettings.ma(130)&&Oa.EwaSettings.ma(138)&&(this.bfg()||this.gridView.jv(this.onContentReady));this.$.PA(this.hj);Oa.EwaSettings.ma(644)&&(this.$.ea.Uj(this.Tc),this.showUntrustedImageBusinessBarIfNecessary());this.kOd=new Ya(this.$,this)}dispose(){(this.g7a||this.Z7a)&&this.$.ea.Mv(this.zf);Oa.EwaSettings.ma(644)&&this.$.ea.uk(this.Tc);!this.c3&&Oa.EwaSettings.ma(130)&&Oa.EwaSettings.ma(138)&&this.gridView.Ky(this.onContentReady);
this.co&&this.co.dispose();this.$.YD(this.hj);this.$.Jl(this.dd);this.g7a&&(this.yod=null);e.a.Ia(this.Oza)}YKg(ob){this.addHandler("LinkedEntityConverted",ob)}egj(ob){this.removeHandler("LinkedEntityConverted",ob)}get t$i(){return 5}get Wbb(){return this.NK}set Wbb(ob){this.NK=ob}selectEntity(ob){return this.co?this.co.selectEntity(ob):!1}searchEntity(ob,Fa){this.co&&this.co.searchEntity(ob,Fa)}nPd(ob,Fa,Ab,$b){this.co&&this.co.searchEntity(ob,Fa,!0,Ab,$b)}wEb(ob){return this.co?this.co.wEb(ob):
!1}onPaneClosed(){if(this.co)this.co.onPaneClosed()}cancelSearch(){this.co&&this.co.cancelSearch()}selectDataType(ob){this.co&&this.co.selectDataType(ob)}showHelpArticle(ob){this.co&&this.co.showHelpArticle(ob)}showSurveyDialog(ob){this.co&&this.co.showSurveyDialog(ob)}insertTable(ob,Fa){this.co&&this.co.insertTable(ob,Fa)}Y7h(ob){this.$.isEditMode&&this.xYf!==ob&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&(this.xYf=ob,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),
J(this.$.pa.ya,this.fQi,null,null,null))}zOe(){this.$.userOperationManager.Ic(new wb.a(589,0,(ob,Fa,Ab)=>da(this.$.pa.ya,Wa.b(ob,this.CNi),Fa,Ab,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.T_d||this.qgg||!this.$.ea.Zb||this.drj()}drj(){this.$.userOperationManager.Ic(new wb.a(588,0,(ob,Fa,Ab)=>sa(this.$.pa.ya,Wa.b(ob,this.xPi),Fa,Ab,null),80),null)}f_d(ob){if(this.g7a&&null==this.yod&&!this.Z7a&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.R7a&&this.R7a&&(!ob||
this.$.workbookContext.Options&262144)){var Fa=za.GetServiceTaskFactory.Oa(this.$.da,274,275,0);jc.TaskExtensions.Aa(Fa,()=>{this.yod=Fa.result.VRf(2)},this.$.la,3)}}get ZDb(){return this.Dua.length}get aEi(){return this.aee}u8g(ob){(ob=this.Xmh(ob))?this.convertToLinkedEntity(ob):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(ob){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${ob.Id}].`);
if(this.gridView){var Fa=this.gridView.ha.ra.$c,Ab=Fa.Ke(this.gridView.IH);this.Jod&&this.IIg(ob);if(Ab){Ab=this.gridView.Bb.Ixa(Ab);if(!this.y$e(ob)&&this.Pjf(ob.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(V.a.zg.fR){Fa=this.Ied();if(!Fa){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ab=this.A5b();if(!Ab){b.ULS.sendTraceTag(537166916,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}var $b={["InputMethod"]:cc.a.Db,CalloutName:3};$b.Target=Fa;$b.RibbonButtonLabel=Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.lYf(ob):this.oCb(ob.Id.toString());$b.ExampleEntities=this.DUe(ob);this.$.Ja.Kb(Ab,$b);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Pjf(ob.Id)&&
!ob.StringId)this.launchLinkedEntityDataTypeSelectorPane(dc.A2a(ob));else{if(Ab){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.tLj(ob)){Fa=xb.r(this.gridView.ha.ra.selectedRanges,this.$);this.co.ivi(Fa,ob);return}if(V.a.zg.fR){Fa=this.Ied();if(!Fa){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");
return}Ab=this.A5b();if(!Ab){b.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}$b={["InputMethod"]:cc.a.Db,CalloutName:2};$b.Target=Fa;$b.RibbonButtonLabel=this.lYf(ob);$b.ExampleEntities=this.DUe(ob);$b.BlankCellResourceId=this.ATg(ob);$b.HasBlankCellWalkthrough=this.L8h(ob);$b.ServiceDomain=ob.Id;this.$.Ja.Kb(Ab,$b);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.j4c(ob,
!1,Fa)}}}else b.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.c3&&this.c3.xIa()}onAutoDetectUIShown(){Vb.a(this.$.userOperationManager,(ob,Fa,Ab)=>T(this.$.pa.ya,ob,Fa,Ab,null),ob=>new wb.a(230,0,ob,80),null)}j4c(ob,Fa,Ab){const $b=xb.q(Ab,this.$),Cb=()=>new ic.a;Vb.a(this.$.userOperationManager,(Rb,uc,nb)=>L(this.$.pa.ya,$b,ob,Fa,Wa.b(Rb,this.wMi,this.FWi,this.co.vMi),uc,nb,null),Rb=>new wb.a(115,0,Rb,void 0,Cb),null)}IIg(ob){if(this.Jod){var Fa=
{};Fa.Id=ob.Id;ob.StringId&&(Fa.StringId=ob.StringId);if(!(0<this.NK.length&&this.NK[0].Id===Fa.Id&&this.NK[0].StringId===Fa.StringId)){ob=!1;this.NK.splice(0,0,Fa);for(let Ab=1;Ab<this.NK.length;++Ab)if(this.NK[Ab].Id===Fa.Id&&this.NK[Ab].StringId===Fa.StringId){this.NK.splice(Ab,1);ob=!0;break}for(;5<this.NK.length;)this.NK.splice(this.NK.length-1,1);this.Fla.Categories[dc.i9a].DomainIds=this.NK;this.kXf();ob||this.kOd.Blg(this.NK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,
"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var ob=xb.q(this.gridView.ha.ra.$c,this.$);Vb.a(this.$.userOperationManager,(Fa,Ab,$b)=>G(this.$.pa.ya,ob,Fa,Ab,$b,null),Fa=>new wb.a(116,0,Fa),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(Ca.h(this.$)){this.$.isEditMode||
b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.eLd();var ob=xb.r(this.gridView.ha.ra.selectedRanges,this.$);Vb.a(this.$.userOperationManager,(Fa,Ab,$b)=>C(this.$.pa.ya,ob,Fa,Ab,$b,null),Fa=>new wb.a(248,0,Fa),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}xCj(ob){ob=this.FU(ob.DomainId);if(!ob||ob.DomainBlocked||Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!ob.HasCuratedData)return!1;if(this.tni){for(let Fa of this.EU)if(Fa.value.DomainId.Id===ob.DomainId.Id&&Fa.value.ShowInRibbon)return!0;return!1}return ob.ShowInRibbon}kBj(ob){return 2!==this.Fs||!this.Dua[ob]}launchDisambiguationPaneForSearch(){this.co&&this.co.launchDisambiguationPaneForSearch()}Kc(ob,Fa,Ab){if("PopulateConvertToLinkedEntityMenu"!==Fa)return!1;this.Add=Ab.MenuId;if(0===this.Fs||3===this.Fs)return this.m2i(),!0;if(!this.Fla)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),
!1;if(!this.EU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.PY=this.PY||this.Q9a.hKh(this.Fla,Ab.MenuId);Ab.MenuItems=this.PY;return this.Jod=!0}m2i(){-1===this.xec&&(this.MHb(),this.xec=window.setInterval(()=>{this.MHb()},2E3))}MHb(){this.$.ea.Zb&&2!==this.Fs&&(this.TLa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.Fs=1,O(this.$.pa.ya,this.HPi,this.GPi,null,null))}ypd(){return this.$.isEditMode&&
2!==this.Fs&&(0<=this.TLa||!this.Aab)}E0d(ob){d.AFrameworkApplication.Ng?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):r.a(this.$)?(this.SWj(),ob&&this.$.af()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}okj(){this.YEb=0;this.TLa=8;this.Aab=!1;this.Fs=this.xec=0;this.oOa=this.Fla=null;this.J3b();for(let ob=0;ob<this.ZDb;++ob)this.Dua[ob]=null;this.fAb()&&this.E0d(!0)}J3b(){this.PY=null}fAb(){const ob=
t.a.DIb,Fa=r.a(this.$);return!!Fa&&Fa.Em.cA===ob}dhg(){if(this.Fla){let Ab=0;var ob=-1,Fa=-1;let $b=0,Cb=0,Rb=0,uc=0;const nb=[null,null,null,null,null];for(const Fb of this.Fla.Categories){let Jc=!1;for(const Fc of Fb.DomainIds){let zb=this.FU(Fc);zb&&!zb.DomainBlocked&&zb.ShowInRibbon&&(Ab<this.ZDb?(this.Dua[Ab]=Fc,Cb===dc.i9a&&(-1===ob&&(ob=Ab),Fa=Ab,uc=Fa-ob+1),++Ab):Ab===this.ZDb&&$b<uc&&Cb!==dc.i9a&&(nb[$b]=Fc,++$b),Jc=!0)}Jc&&++Rb;++Cb}if(-1<ob&&Rb<=dc.Yof){for(;Fa>=ob;--Fa)this.Dua.splice(Fa,
1);for(ob=0;ob<uc;++ob)this.Dua.splice(Ab+ob,0,nb[ob])}for(;Ab<this.ZDb;)this.Dua[Ab]=null,++Ab}}bfg(){const ob=Ca.h(this.$).Ea,Fa=this.gridView.ha.Oe;if(ob&&ob.Dkd&&1===Fa&&this.gridView.ha.ra.activeCell){const Ab=za.GetServiceTaskFactory.Oa(this.$.da,12,477,1);Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7252908_ConvertToLinkedEntityManagerInvalidOperationFix")?jc.TaskExtensions.Aa(Ab,()=>{this.c3=new v.a(this.$,this.svgIconProvider,Ab.result,this,this.htmlSanitizationHelper)},this.$.la,3):this.c3=
new v.a(this.$,this.svgIconProvider,Ab.result,this,this.htmlSanitizationHelper);return!0}return!1}lvi(){this.co&&this.co.Tud(!0)}launchLinkedEntityDataTypeSelectorPane(ob){if(this.co)if(ob=this.z8c(ob))if(ob.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var Fa=xb.r(this.gridView.ha.ra.selectedRanges,this.$);this.co.launchLinkedEntityDataTypeSelectorPane(Fa,ob.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}L6g(ob){const Fa=
this.jbi(ob),Ab=h.a.Gg(this.oCb(ob));ob=h.a.Gg(this.eZd(ob));return dc.KJh(Fa,Jb.a.we(11),Ab,ob)}eZd(ob){try{return this.GMe(parseInt(ob,10)).Description}catch(Fa){}return mb.a.instance.ga(1788)}oCb(ob){try{return this.GMe(parseInt(ob,10)).Name}catch(Fa){}return mb.a.instance.ga(1774)}lYf(ob){try{return this.FU(ob).Name}catch(Fa){}return this.oCb(ob.Id.toString())}ATg(ob){try{return this.FU(ob).BlankCellResourceId}catch(Fa){}return null}L8h(ob){try{return this.FU(ob).HasBlankCellWalkthrough}catch(Fa){}return!1}y$e(ob){try{const Fa=
dc.A2a(ob);if(this.EU.mb(Fa))return this.EU.na(Fa).HasCuratedData}catch(Fa){}return!1}tLj(ob){try{return this.FU(ob).SupportsStarterData}catch(Fa){}return!1}Pjf(ob){return 268435968===ob}Ied(){return 2===r.a(this.$).zO?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}A5b(){return new lb.a(-847286761,cc.a.Db,this.$.Hc,0,t.a.p0)}uHe(){if(this.fAb()&&!this.ypd()&&!this.whf&&Oa.EwaSettings.ma(436)&&this.y$e({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
V.a.zg.fR){const Ab=this.Ied();if(Ab){var ob=this.A5b();if(ob){var Fa={["InputMethod"]:cc.a.Db,CalloutName:6};Fa.Target=Ab;Fa.ShouldCanvasTakeFocus=!0;this.$.Ja.Kb(ob,Fa);this.whf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}Kai(ob){ob=
this.z8c(ob);return ob?this.Q9a.jSg(ob.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}Ygc(ob){return this.c3?this.c3.iSg(ob):!1}MMh(){return this.c3?this.c3.INh():""}Jii(){return this.c3?this.c3.TCb:!1}ARh(ob,Fa){const Ab=this.Vcf(ob);if(0>Ab)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${ob}`);else if(ob=(ob=this.HMe(ob))?this.FU(ob):
null)Fa[m.a.GalleryButtonProps]=this.Q9a.HKh(Ab,ob),Fa[m.a.Alt]=this.Q9a.qfd(ob)}kXf(){this.dhg();this.fAb()&&this.E0d(!0);this.J3b()}jbi(ob){return ob===this.EWe?y.a.ETe:ob===this.JZe?y.a.CTe:y.a.BTe}DUe(ob){try{return this.FU(ob).ExampleEntities}catch(Fa){}return mb.a.instance.ga(1796)}UJd(){(0>this.TLa||this.Aab)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Fs||0>this.TLa||this.Aab)&&window.clearInterval(this.xec);this.ypd()?
this.Add&&this.$.frame.px(this.Add):this.E0d(this.fAb())}Hb(ob){return this.$.Eb+ob}SWj(){var ob=!0;const Fa=Array(this.ZDb),Ab=r.a(this.$)?r.a(this.$).Em:null;if(Ab){for(let $b=0;$b<Fa.length;++$b)this.kBj($b)?Fa[$b]=!0:ob=Fa[$b]=!1;Ab.GRd(["ConvertToLinkedEntityGallery"],ob);if(!ob)for(ob=0;ob<Fa.length;++ob)Fa[ob]&&Ab.GRd([this.zRh(ob)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}FU(ob){const Fa=dc.A2a(ob);if(this.EU.mb(Fa))return this.EU.na(Fa);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${ob.Id} (Has String ID: ${!!ob.StringId})`);return null}zRh(ob){return"ConvertToLinkedEntityPreview"+ob.toString()}v0d(){l.a.get_instance().Xj(10,()=>{this.uHe();this.m0c&&this.Nif&&yb.c(this.xof,this.$.la,500)})}lec(ob,Fa){switch(ob){case "QueryLinkedEntityGalleryButtons":if(!Fa[m.a.InnerHTML]){ob=Fa[cc.a.Jc].toString();const Ab=jb.a.equals(ob,mb.a.instance.ga(1791),!0)||jb.a.equals(ob,mb.a.instance.ga(1792),!0),$b=jb.a.equals(ob,mb.a.instance.ga(1793),
!0);Ab||$b||this.ARh(ob,Fa)}break;case "QueryLinkedEntityMenuGalleryButtons":Fa[m.a.InnerHTML]||(Fa[m.a.InnerHTML]=this.L6g(Fa[cc.a.Jc]))}return Fa}Xmh(ob){var Fa=this.HMe(ob);if(Fa)return Fa;if(Fa=this.z8c(ob))return Fa.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${ob}`);return null}GMe(ob){const Fa={};Fa.Id=ob;return this.FU(Fa)}z8c(ob){return this.EU.mb(ob)?this.EU.na(ob):null}Vcf(ob){if(!ob.startsWith(dc.T8c))return-1;const Fa=parseInt(ob.substr(dc.T8c.length),
10);return isNaN(Fa)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${ob}`),-1):Fa}HMe(ob){ob=this.Vcf(ob);return 0>ob?null:this.Dua[ob]}Zef(ob,Fa,Ab){this.EU&&this.EU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${ob})`),ob=this.$.pa.ya.Wb(),this.$.ea.Zb&&S(this.$.pa.ya,Wa.b(this.mSi,Fa),Ab,null,null,ob))}wRj(){this.Zef("Auto-refresh on load",null,null)}ARj(){this.EU&&this.EU.count&&(this.Oza?b.ULS.sendTraceTag(537166799,
0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Io.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.Oza=Cc.a.instance.create(this.d0c,this.A1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}jAc(){if(this.$.ea.Zb&&null!=this.R7a&&null!=this.wrd&&null!=this.xrd&&null!=this.Ctd&&null!=this.Fsd)if(++this.YEb,12>=this.YEb){1===this.YEb&&(this.ykd=Sa.a.Qa.ve.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const ob=this.$.pa.ya.Wb();
va.u(this.$.pa.ya,this.owi,this.pwi(),this.mTi,this.lTi,null,ob)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${Sa.a.Qa.ve.m-this.ykd} ms`),this.Aab=!0,this.UJd()}qBe(){if(this.$.isEditMode)if(null!=this.R7a)this.jAc();else{var ob=Sa.a.Qa.ve.m,Fa=[];w.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ab=>{Ab.isFeatureEnabled("ExcelPowerBiPro",!1).then($b=>{b.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${Sa.a.Qa.ve.m-ob} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${$b}]`);return this.R7a=$b}).then(()=>{Fa.push(Ab.isFeatureEnabled("ExcelWolframAlpha",!1).then($b=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${Sa.a.Qa.ve.m-ob} Millisecond.`);b.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${$b}]`);return this.Ctd=$b}))}).then(()=>{Fa.push(Ab.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then($b=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${Sa.a.Qa.ve.m-ob} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${$b}]`);
let Cb;const Rb=[(Cb=new tb.a,Cb.name="IsRestrictedByLicense",Cb.bool=$b,Cb)];Ha.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Rb);this.slf=$b&&Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return $b}))}).then(()=>{Fa.push(Ab.isFeatureEnabled("StockHistory",!1).then($b=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${Sa.a.Qa.ve.m-ob} Millisecond.`);b.ULS.sendTraceTag(537166738,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${$b}]`);return this.Fsd=$b}))}).then(()=>{Fa.push(Ab.isFeatureEnabled("ExcelPowerBiFree",!1).then($b=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${Sa.a.Qa.ve.m-ob} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${$b}]`);return this.wrd=$b}))}).then(()=>
{Fa.push(Ab.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then($b=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${Sa.a.Qa.ve.m-ob} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${$b}]`);return this.xrd=$b}))}).then(()=>{Promise.all(Fa).then(()=>{this.jAc()})})})}}get owi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}pwi(){return[this.R7a,
this.Ctd,this.Fsd,this.wrd,this.xrd,this.slf]}eLd(){this.businessBar&&this.businessBar.cla(58)&&this.businessBar.removeEntry(58)}W6h(ob){this.svd!==ob&&this.businessBar&&((this.svd=ob)?X(this.$.pa.ya,this.iPi,null,null,null):this.eLd())}static KJh(ob,Fa,Ab,$b){ob=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',ob,Fa,$b);Ab=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Ab);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',ob,Ab)}static A2a(ob){return ob.StringId?ob.Id.toString()+"."+ob.StringId:ob.Id.toString()}}dc.tNe="ConvertToLinkedEntityPreview";dc.T8c="PreviewGalleryButtonIndex.";dc.i9a=0;dc.Yof=2;Object(c.a)(dc,"ConvertToLinkedEntityManager",n.a,[684,685,2,686])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/97a78f13b2bc078893660535129c1cc7/EwaDSEsNext.le.js.map