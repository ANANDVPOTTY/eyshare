'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[33],{1257:function(u,E,a){u=a(0);var c=a(552),b=a(84),e=a(15),f=a(157),d=a(4),h=a(41),m=a(80),l=a(766);class w{constructor(r,v){this.sSc=this.rSc=null;this.zYa=new f.a;this.yh=r;this.gGa=v.appSettings[w.r1j]||""}get Wzj(){return this.zYa.task}get v3(){return this.yh.value}Sjj(){const r={};r[w.E8h]=d.AFrameworkApplication.Ii;r["Content-Type"]="application/json; charset=utf-8";e.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");
const v=m.a.Nl(this.gGa+w.Xzj,w.hJi,d.AFrameworkApplication.sa.Pa.Gj.toString());this.v3.Pm(v,1,"",r,!0,2,Object(b.a)(this,this.BGb,"onSuccessCallback"),Object(b.a)(this,this.OFb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}Dzi(r){try{const v={};v.FlightName=r.FlightName;v.SessionID=r.SessionID;e.ULS.sendTraceTag(594883776,215,50,h.c(v))}catch(v){e.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}BGb(r){if((r=r.data.ue)&&r.length)try{const v=h.a(r);this.rSc=v.NavBarDataJson;
e.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.rSc?({At:this.sSc}=h.d(v.NavBarDataJson)).returnValue?(this.Dzi(this.sSc),this.zYa.setResult(this.sSc)):(e.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:l.a.Yfb(this.rSc)}),this.zYa.Qs()):(e.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.zYa.Qs())}catch(v){e.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.zYa.Qs()}else e.ULS.sendTraceTag(6362369,
215,10,"Response from O365ShellServiceProxy is null.")}OFb(){this.zYa.Qs();e.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return w.Ma||(w.Ma=w.fwb())}static fwb(){return new w(new c.a(()=>d.AFrameworkApplication.Dd),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.Pa.Gj)}}w.E8h="X-qs";w.hJi="at";w.Xzj="O365ShellServiceProxy.ashx";w.Ma=null;w.r1j="ShellWebServiceBase";Object(u.a)(w,"O365ShellActor",null,[373]);var n=a(248);class y{constructor(){this.gb=
null}get name(){return"Common.App.O365Shell"}Wh(r){this.gb=r;this.gb.register(w,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").xc().Fc(()=>new w(new c.a(()=>d.AFrameworkApplication.Dd),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.Pa.Gj))}init(){d.AFrameworkApplication.fa.Dv(Object(b.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){d.AFrameworkApplication.useO365ShellService&&d.AFrameworkApplication.sa.Pa.Es&&this.gb.resolve("Common.App.O365Shell.O365ShellActor").Sjj()}dispose(){}static main(){n.a.instance.Fi(new y)}}
Object(u.a)(y,"PackageManager",null,[4,5]);a.d(E,"a",function(){return t});const t=()=>{Type.registerNamespace("Common.App.O365Shell");y.main()}},1402:function(u,E,a){a.r(E);u=a(1257);Object(u.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.shell.js.map/48d93544a8250cb3a0cc795809ef9b9d/EwaDSEsNext.shell.js.map