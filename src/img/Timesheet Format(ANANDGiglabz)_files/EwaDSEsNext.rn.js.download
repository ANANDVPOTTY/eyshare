'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1143:function(u,E,a){u=a(0);var c=a(84),b=a(552),e=a(15),f=a(134);class d{constructor(gb,mb,Ga){this.DUd=this.EUd=this.FUd=!1;this.UUd=!gb&&!mb;this.VUd=!gb&&!Ga;this.UUd||this.VUd||(this.FUd=!gb,this.EUd=!mb,this.DUd=!Ga)}}Object(u.a)(d,"RenameDisabledDialogInfo",null,[]);class h extends f.StandardDialog{constructor(gb,mb,Ga,ib,cc){super();this.fYd=[];this.d2=new d(gb,mb,Ga);this.Tra=ib;this.Kqa=cc;this.Fe=
"RenameDisabledDialog";this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose);this.Oxj();this.Thj()}Oxj(){this.d2.UUd?this.CNb(this.Tra?this.Kqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.d2.VUd?this.CNb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.UGg();this.esa(this.fYd)}CNb(gb){Array.add(this.fYd,gb)}UGg(){const gb=[];this.d2.FUd||Array.add(gb,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.d2.EUd||Array.add(gb,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.d2.DUd||Array.add(gb,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<gb.length&&Array.add(this.fYd,gb)}}Object(u.a)(h,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class m extends h{constructor(gb,mb,Ga,ib,cc){super(gb,mb,Ga,ib,cc)}Thj(){this.jEb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(u.a)(m,"ReactRenameDisabledDialog",h,[]);var l=a(146);class w{static get qg(){return l.a.gq(w.ol,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}w.ol="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(u.a)(w,"RenameDisabledDialogHtml",null,[]);class n extends l.a{constructor(gb,mb,Ga,ib,cc){super();this.d2=new d(gb,mb,Ga);this.Tra=ib;this.Kqa=cc;this.Fe="RenameDisabledDialog";this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose);this.qg=w.qg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.eX("RenameRow")}Q$a(){if(this.d2.UUd){let gb;gb=this.Tra?this.Kqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;n.CNb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),gb)}else this.d2.VUd?n.CNb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.K$h()}K$h(){this.d2.FUd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.d2.EUd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.d2.DUd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static CNb(gb,mb,Ga){gb.style.display="none";mb.innerText=Ga}}Object(u.a)(n,"RenameDisabledDialog",l.a,[]);var y=a(4),t=a(30),r=a(105),v=a(25);class B{constructor(gb,mb){this.VEa=0;this.La=gb;this.X8=mb}initialize(gb){if(!this.La||!this.X8)return!1;this.VEa=gb;this.Hg();return!0}Hg(){this.La.Nb(v.a.gia,r.a.frame,Object(c.a)(this,this.gia,"commitNewDocumentTitle"))}gia(gb,mb,Ga,ib,cc){if(1===Ga)return this.La.processAction(v.a.renameFile,
1);gb=t.a.Rq(this.X8.tn);cc=(0,cc.getNewDocumentTitle)();cc.length>this.VEa&&(cc=cc.substr(0,this.VEa));if(32!==this.La.ae(v.a.renameFile,2,cc))return this.zX(gb),8;this.zX(cc);return 32}zX(gb){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(gb))}static Dgd(){return new B(y.AFrameworkApplication.ub,y.AFrameworkApplication.sm)}}Object(u.a)(B,"ReactRenameUIHandler",null,[732]);var A=a(93),z=a(520),x=a(554),D=a(14),J=a(107),L=a(239),T=a(86),O=a(40),G=a(27),C=a(82);class H{constructor(gb,
mb,Ga,ib,cc,ic,xb,Vb,wb,cb,lb,Y){this._initialized=!1;this._element=null;this.VEa=0;this.bSc=this.ELc=!1;this.La=gb;this.TGc=mb;this.Yd=Ga;this.GA=ib;this.X8=cc;this.Sie=ic;this.uXb=xb;this.PHc=Vb;this.j9=wb;this.zbe=cb;this.eXa=lb;this.zMc=Y}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(gb,mb,Ga){if(!(this.La&&this.X8&&this.Sie&&this.uXb&&this.PHc&&mb)||0>=gb)return!1;this._element=mb;this._element.title=Ga;this._element.setAttribute(T.a.Ld,T.a.ot);this._element.setAttribute("Unselectable",
"on");this.VEa=gb;this.Ns();return this._initialized=!0}Ns(){this.TGc&&(this.TGc.ta(D.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.TGc.ta(D.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Yd.ta(D.a.Pb,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.GA.ta(D.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.GA.ta(D.a.Qf,this._element,Object(c.a)(this,this.Pf,"onPointerUp"))}onBlur(){this.isActive&&!this.ELc&&
(this.zbe||this.PHc(this._element),this.kEe(),this.e7c(!1));return this.ELc=!1}onPaste(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(gb){return this.isActive?this.VRi(gb):this.WRi(gb)}VRi(gb){let mb=!1;switch(gb.Ca.keyCode){case Sys.UI.Key.enter:this.kEe();this.e7c(this.eXa||this.zMc);mb=!0;break;case Sys.UI.Key.tab:this.zbe&&this.PHc(this._element);break;case Sys.UI.Key.esc:this.LNd(),this.e7c(this.eXa||this.zMc),mb=!0}return mb}WRi(gb){let mb=
!1;switch(gb.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.leg(this.zMc),this.isActive&&this.uXb(this._element),mb=!0}return mb}onPointerDown(){this.isActive||(this.leg(!1),this.isActive&&(this._element.focus(),this.uXb(this._element),this.bSc=!0));return!1}Pf(){return this.bSc?(this.uXb(this._element),this.bSc=!1,!0):!1}W7a(){return 32===this.La.processAction(v.a.renameFile,1)}kEe(){const gb=t.a.Rq(this.X8.tn);let mb=this._element.innerText.trim();mb.length>this.VEa&&(mb=mb.substr(0,
this.VEa));mb!==gb&&""!==mb?32!==this.La.ae(v.a.renameFile,2,mb)?this.LNd():this.zX(mb):this.LNd()}LNd(){this.zX(t.a.Rq(this.X8.tn))}zX(gb){this._initialized&&(this._element.innerText=gb,this.Sie())}leg(gb){this.W7a()?this.isActive||(gb&&(this.ELc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(T.a.Ld,T.a.DYc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,A.CuiHelper.ANe),
this.j9&&this.j9.execute(mb=>{mb.nPf(!0)}),gb&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(v.a.Heb,2)}e7c(gb){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(T.a.Ld,T.a.ot);Sys.UI.DomElement.removeCssClass(this._element,A.CuiHelper.ANe);this.j9&&this.j9.execute(mb=>{mb.nPf(!1)});gb&&(this._element.blur(),this._element.focus())}static aA(){z.a.aA(y.AFrameworkApplication.isRtl)}static Dgd(){return new H(y.AFrameworkApplication.ub,
x.a.instance,J.KeyInputManager.instance,L.a.instance,y.AFrameworkApplication.sm,H.aA,O.a.$pj,O.a.H2g,C.a.instance.Ub("Common.App.Header.HeaderEventSource"),G.a.kla,G.a.Yg,G.a.If)}}Object(u.a)(H,"RenameUIHandler",null,[732]);class I{static get instance(){return y.AFrameworkApplication.sa.Pa.Es?I.Ma||(I.Ma=B.Dgd()):I.Ma||(I.Ma=H.Dgd())}}I.Ma=null;Object(u.a)(I,"RenameUIHandlerFactory",null,[]);var M=a(97),Q=a(136);class U{constructor(){this.hHi=this.dHi=this.Wfh=null}}Object(u.a)(U,"RenameMruEntryProperties",
null,[]);var N=a(373),W=a(164),X=a(642),sa;(function(gb){gb[gb.unknown=-1]="unknown";gb[gb.success=0]="success";gb[gb.renameInvalidFileName=1]="renameInvalidFileName";gb[gb.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";gb[gb.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";gb[gb.permissionDenied=4]="permissionDenied";gb[gb.serverCommunicationFailure=5]="serverCommunicationFailure";gb[gb.fileNameTooLong=6]="fileNameTooLong"})(sa||(sa={}));Object(u.b)("CommonOperationResult",
sa);class da{constructor(gb,mb,Ga,ib,cc,ic,xb,Vb,wb,cb,lb,Y){this.Lbe=gb;this.La=mb;this.ZHc=Ga;this.Zv=ib;this.OEa=cc;this.BDg=ic;this.Tra=xb;this.Tle=Vb;this.fAg=wb;this.Kqa=cb;this.lb=lb;this.eAg=Y}Hg(){y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Pa.Es||this.Uh.Nb(v.a.zzb,r.a.frame,Object(c.a)(this,this.zzb,"initializeRenameUIHandler"));this.Uh.Nb(v.a.Heb,r.a.frame,Object(c.a)(this,this.Heb,"showRenameDisabledDialog"));this.Uh.Nb(v.a.renameFile,r.a.frame,Object(c.a)(this,this.renameFile,
"renameFile"));this.Uh.Ne(v.a.fileNameUpdate,r.a.frame,Object(c.a)(this,this.yaj,"refreshFilename"),64);this.Uh.Ne(v.a.Wmc,r.a.frame,Object(c.a)(this,this.Wmc,"moveToFolderCompleteByHost"),64);this.Uh.Nb(v.a.$Oa,r.a.frame,Object(c.a)(this,this.$Oa,"moveToFolder"));(y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||y.AFrameworkApplication.sa&&(y.AFrameworkApplication.fa.qa("PostMessageEmbedded")||y.AFrameworkApplication.fa.qa("IsJsApi"))&&
y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&y.AFrameworkApplication.jV().execute(gb=>{gb.so(W.a.bvf);gb.dm(W.a.bvf,da.o$i);gb.so(W.a.Lbd);gb.dm(W.a.Lbd,da.m$i)})}W7a(){return 0===this.eAg.v5e()?32:8}qZj(){return this.qz?this.Tra?this.qz.BMe:this.qz.ewb:!0}zzb(){return I.instance.initialize(y.AFrameworkApplication.I$b,y.AFrameworkApplication.x2a,y.AFrameworkApplication.cMd||CommonUIStrings.l_RenameFileTooltip)?32:8}Heb(){const gb=this.qZj(),
mb=this.BDg();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.OEa,mb,gb,this.Tra);y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Pa.Hv&&y.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new m(this.OEa,!mb,!gb,this.Tra,this.Kqa()):new n(this.OEa,!mb,!gb,this.Tra,this.Kqa());return 32}renameFile(gb,mb,Ga,ib,cc){if(1===
Ga)return this.W7a();if(!y.AFrameworkApplication.i$b)return 8;if(8===this.W7a())return this.Uh.processAction(v.a.Heb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");y.AFrameworkApplication.i$b(cc,Object(c.a)(this,this.qGb,"onRenameFileSuccess"),Object(c.a)(this,this.AUi,"onRenameFileFailure"));return 32}qGb(gb,mb){gb?0!==gb.OperationResult?this.k9e(gb.OperationResult):(this.lrj(mb,gb.NewName),this.NUj(gb,Object(c.a)(y.AFrameworkApplication.sa.Pa,y.AFrameworkApplication.sa.Pa.Ohg,"updateOpenInClientDocumentUrl")),
y.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&y.AFrameworkApplication.sa.updateCommandUI(),this.fAg.sgg()):this.k9e(5)}lrj(gb,mb){const Ga={};Ga[N.a.QDh]=mb;gb.Pj(W.a.Lbd,Ga)}NUj(gb,mb){this.aVj(gb);y.AFrameworkApplication.I7b=gb.DirectInvokeDavUrl;mb=mb(gb.EditDocInClientUrl);const Ga=new U;Ga.hHi=this.Zv.tn;Ga.Wfh=mb;Ga.dHi=gb.EditDocInClientUrl;this.Uh.ae(v.a.renameMostRecentlyUsedFileEntry,2,Ga)}k9e(gb){switch(gb){case 1:gb=new f.StandardDialog,gb.Rb=0,gb.kX(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileInvalidName,null),this.XXf()}}aVj(gb){this.Zv.tn=da.rPg(this.Zv.tn,gb.NewName);gb.BreadcrumbFolderName&&(this.Zv.breadcrumbFolderName=gb.BreadcrumbFolderName);gb.BreadcrumbFolderUrl&&(this.Zv.breadcrumbFolderUrl=gb.BreadcrumbFolderUrl);this.Tle(gb.NewName)}AUi(gb){const mb=new f.StandardDialog;mb.Rb=0;switch(gb){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");mb.CBa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,
null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");mb.CBa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:gb}),mb.CBa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}y.AFrameworkApplication.jV().execute(Ga=>{Ga.Pj(W.a.PDh,{["FailureMessage"]:sa[gb]})});this.XXf()}yaj(gb,mb,Ga){if(1===
Ga)return this.W7a();if(!y.AFrameworkApplication.YJa)return 8;y.AFrameworkApplication.YJa(Object(c.a)(this,this.Lpc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.Kpc,"onRefreshFilenameFailure"),!1);return 32}$Oa(gb,mb,Ga,ib,cc){if(1===Ga)return y.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===Ga){const ic={};gb=y.AFrameworkApplication.$ba;mb=y.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");gb=(!gb||gb&&mb)&&y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);ic[N.a.kLj]=gb;cc&&cc.MoveButtonClickedTime&&(ic[N.a.EFi]=cc.MoveButtonClickedTime.getTime());y.AFrameworkApplication.jV().execute(xb=>{xb.Pj(W.a.$Oa,ic)});if(cc&&cc.MoveButtonClickedTime){if(gb=Q.a.fs())cc=(new Date).getTime()-cc.MoveButtonClickedTime.getTime(),gb.set("MovePostDuration",cc.toString());M.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",gb)}return 32}return 8}Wmc(gb,mb,Ga,ib,cc){if(1===Ga)return y.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?this.W7a():8;
if(2===Ga){if(!y.AFrameworkApplication.H0f)return M.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!cc)return M.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(cc[N.a.jki])if(cc[N.a.Mig])if(gb=cc[N.a.Mig].toLowerCase(),mb=y.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),Ga=y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),mb&&y.AFrameworkApplication.$ba&&
Ga){const ic={};ic[N.a.QQa]="1";ic[N.a.documentUrl]=gb;ic[N.a.reason]=X.a.saveAs;M.Health.instance.recordKpiSuccess("MoveToFolder",null);y.AFrameworkApplication.jV().execute(xb=>{xb.Pj(W.a.tua,ic)})}else if(!y.AFrameworkApplication.$ba&&Ga)M.Health.instance.recordKpiSuccess("MoveToFolder",null),O.a.lf(gb,O.a.CX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return M.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else M.Health.instance.recordKpiFailure("MoveToFolder",
"Null newDocUrl",!1,!1,null);else y.AFrameworkApplication.YJa(Object(c.a)(this,this.Lpc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.Kpc,"onRefreshFilenameFailure"),!1),y.AFrameworkApplication.H0f(),M.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}aDj(gb,mb){return gb&&mb?gb!==this.Zv.breadcrumbFolderName||mb!==this.Zv.breadcrumbFolderUrl:!1}Lpc(gb,mb){gb&&(gb.NewName!==t.a.Rq(this.Zv.tn)||this.aDj(gb.BreadcrumbFolderName,gb.BreadcrumbFolderUrl))&&this.qGb(gb,mb)}Kpc(){}XXf(){this.Tle(t.a.Rq(this.Zv.tn))}get Uh(){return this.La.value}get qz(){return this.ZHc.value}static get instance(){return da.Ma||
(da.Ma=da.fwb())}static fwb(){return new da(y.AFrameworkApplication.X7a,new b.a(()=>y.AFrameworkApplication.ub),new b.a(()=>y.AFrameworkApplication.qz),y.AFrameworkApplication.sm,y.AFrameworkApplication.limitedEdit,()=>y.AFrameworkApplication.userCanRename,y.AFrameworkApplication.Kuc,Object(c.a)(I.instance,I.instance.zX,"updateTitle"),C.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>y.AFrameworkApplication.isReadOnlyRecommended,y.AFrameworkApplication.fa,C.a.instance.resolve("Common.IRenameProps"))}static rPg(gb,
mb){gb=t.a.D4(gb);return mb+gb}static o$i(gb){const mb=gb.Values[N.a.Sni];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",mb);mb?y.AFrameworkApplication.ub.ae(v.a.Wmc,2,gb.Values):M.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static m$i(gb){y.AFrameworkApplication.ub.ae(v.a.renameFile,2,gb.Values.NewName)}}da.Ma=null;Object(u.a)(da,"RenameActor",null,[]);a(567);class S{}Object(u.a)(S,"ActivityEventName",null,[]);class oa{}
oa.compatMode="CompatMode";oa.noSelection="NoSelection";Object(u.a)(oa,"ActivityEventReason",null,[]);var K=a(641);class ea{constructor(gb,mb){this.La=gb;this.nWa=mb}Hg(){this.La.Nb(v.a.q8f,r.a.frame,Object(c.a)(this,this.IFj,"showRenameDialogAction"))}IFj(gb,mb,Ga){gb=32;if(1===Ga)return K.SessionStatusManager.instance.Q5a||y.AFrameworkApplication.u5?8:32;2===Ga&&(32!==this.La.processAction(v.a.renameFile,1)?(this.La.processAction(v.a.Heb,2),gb=8):32===this.La.processAction(v.a.BNb,1)?this.La.processAction(v.a.BNb,
2):this.nWa.value.create().hzc());return gb}}Object(u.a)(ea,"RenameDialogActor",null,[714]);class ya{constructor(gb,mb,Ga){this.dialog=null;this.La=gb;this.Zv=mb;this.vqa=Ga}TZh(){const gb={};gb.nameInputProps={["type"]:"AppInputProps",["id"]:ya.w2a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:t.a.Rq(this.Zv.tn),["maxLength"]:this.vqa};return gb}hzc(){const gb={["id"]:"RenameDialog",["bodyControls"]:this.TZh()};this.dialog=new l.a(!1,!1,!0);this.dialog.Rb=1;this.dialog.Fe="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.aMd,"renameDialogHandler"),gb)}aMd(gb,mb){mb&&1===gb&&mb[ya.w2a]&&(gb=t.a.Rq(this.Zv.tn),mb=(mb[ya.w2a]||"").trim(),mb!==gb&&""!==mb&&this.La.ae(v.a.renameFile,2,mb))}}ya.w2a="txtDocumentName";Object(u.a)(ya,"ReactRenameDialog",null,[734]);class ha{static get qg(){return l.a.gq(ha.ol,CommonUIStrings.l_RenameDialogLabel)}}ha.ol="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(u.a)(ha,"RenameDialogHtml",null,[]);class La extends l.a{constructor(gb,mb,Ga){super();this.La=gb;this.Zv=mb;this.vqa=Ga;this.Fe="RenameDialog";this.qg=ha.qg}hzc(){var gb={["txtDocumentName"]:t.a.Rq(this.Zv.tn)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.aMd,"renameDialogHandler"),gb);gb=document.getElementById(La.w2a);0<this.vqa&&(gb.maxLength=this.vqa);gb.focus()}aMd(gb,mb){1===gb&&(gb=t.a.Rq(this.Zv.tn),mb=(mb[La.w2a]||"").trim(),mb!==gb&&""!==mb&&this.La.ae(v.a.renameFile,
2,mb))}}La.w2a="txtDocumentName";Object(u.a)(La,"RenameDialog",l.a,[734]);class Ia{constructor(gb){this.X8=null;this.vqa=0;this.La=gb;this._initialized=!1}initialize(gb,mb){this.X8=gb;this.vqa=mb;this._initialized=!0}create(){return this._initialized?y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Pa.Hv&&y.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new ya(this.La,this.X8,this.vqa):new La(this.La,this.X8,this.vqa):null}}Object(u.a)(Ia,"RenameDialogFactory",null,[713]);var ra=
a(260),pa=a(145),ba=a(137),fa=a(106),Ka=a(102);class aa{constructor(gb,mb){this.La=gb;this.Yb=mb}Hg(){this.La.Nb(v.a.BNb,r.a.frame,Object(c.a)(this,this.JFj,"showRenameFlyoutAction"))}IZg(){return ba.d("setDocumentTitleFlyoutOpened")&&y.AFrameworkApplication.sa.Pa.Es}JFj(gb,mb,Ga){if(1===Ga)return this.IZg()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}fIg(){aa.Qqi&&y.AFrameworkApplication.I7a&&Ka.a.instance.Eg(new fa.a(5,1,5E3,()=>{32===this.La.processAction(v.a.BNb,
1)&&this.Yb&&this.Yb.gi.name===ra.AFrame.naa&&(pa.a("RenameFloatieShownOnNewDocumentLoad",!0),this.La.processAction(v.a.BNb,2))}))}static get Qqi(){aa.bVb&&null!=aa.bVb||(y.AFrameworkApplication.pya("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),aa.bVb=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return aa.bVb}}aa.bVb=null;Object(u.a)(aa,"RenameFlyoutActor",null,
[715]);class ja{constructor(gb,mb,Ga,ib,cc){this.ZHc=cc;this.Mbe=Ga;this.Lbe=ib;this.FDg=gb;this.Kqa=mb}get qz(){return this.ZHc.value}v5e(){if(!this.Lbe())return 5;if(this.Kqa())return 1;if(this.qz){if(this.Mbe&&!this.qz.BMe)return 3;if(!this.Mbe&&!this.qz.ewb)return 4}return this.FDg()?0:2}}Object(u.a)(ja,"RenameProps",null,[711]);a(187);var Va=a(98);class bb{constructor(gb,mb,Ga,ib,cc,ic){this.nn=!1;this.XNc=new Va.a;this.tWa=mb;this.aM=Ga;this.Trg=ib;this.lb=cc;this.Cke=ic}enable(){this.nn||(this.sgg(),
this.rWd(),this.nn=!0)}generateKey(gb,mb,Ga){return String.format("{0}/{1}/{2}",Ga,gb,mb)}dVh(){const gb=t.a.Rq(this.tWa().tn);return this.generateKey(this.tWa().breadcrumbFolderName,this.tWa().breadcrumbFolderUrl,gb)}eVh(gb,mb,Ga){return gb&&mb?this.generateKey(gb,mb,Ga):Ga}wkh(gb,mb,Ga){return gb&&gb!==this.tWa().breadcrumbFolderName||mb&&mb!==this.tWa().breadcrumbFolderUrl?!0:Ga!==t.a.Rq(this.tWa().tn)}sgg(){const gb=this.dVh();this.XNc.ia(gb,new Date)}IFd(gb){this.EBj(gb)&&this.Zme(gb)}EBj(gb){const mb=
this.Trg();return mb?this.Cke&&this.Cke.MAb||!mb.rhf||!y.AFrameworkApplication.YJa?(this.T$f(gb),this.nn=!1):!0:!1}CHf(gb,mb,Ga,ib){const cc=this.wkh(gb,mb,Ga);gb=this.eVh(gb,mb,Ga);mb=this.XNc.Dc(gb).returnValue;cc&&!mb&&(this.l9e(ib),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.mwd));cc||this.XNc.ia(gb,this.aM())}}Object(u.a)(bb,"ARenamedFileChecker",null,[659]);class wa extends bb{constructor(gb,mb,Ga,ib,cc,ic,xb,Vb){super(gb,mb,Ga,ib,cc,ic);this.Lhe=cc;this.dAg=xb;this.Evg=
Vb}get mwd(){return"RenamedFileCheckerUsingSettingsRefresh"}rWd(){this.Lhe.NWc(Object(c.a)(this,this.Y9e,"handleSettingsRefresh"))}Y9e(gb,mb){mb&&mb.OEb&&mb.xJi&&(mb.d8a("BreadcrumbDocName")||mb.d8a("BreadcrumbFolderName")||mb.d8a("BreadcrumbFolderUrl")||mb.d8a("DirectInvokeDAVUrl")||mb.d8a("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.mwd),this.IFd(mb))}T$f(){this.Lhe.Agj(Object(c.a)(this,this.Y9e,"handleSettingsRefresh"))}Zme(gb){if(gb&&gb.OEb){const mb=
gb.OEb;this.CHf(mb.Xa("BreadcrumbFolderName"),mb.Xa("BreadcrumbFolderUrl"),mb.Xa("BreadcrumbDocName"),gb)}}l9e(gb){const mb={OperationResult:0,classId:1};gb=gb.OEb;mb.BreadcrumbFolderName=gb.Xa("BreadcrumbFolderName");mb.BreadcrumbFolderUrl=gb.Xa("BreadcrumbFolderUrl");mb.DirectInvokeDavUrl=gb.Xa("DirectInvokeDAVUrl");mb.EditDocInClientUrl=gb.Xa("EditDocInClientUrl");gb=gb.Xa("BreadcrumbDocName");mb.NewName=y.AFrameworkApplication.sua?gb:t.a.Rq(gb);this.Evg.execute(Ga=>{this.Ghi(mb,Ga)})}Ghi(gb,mb){this.dAg().qGb(gb,
mb)}}Object(u.a)(wa,"RenamedFileCheckerUsingSettingsRefresh",bb,[]);class ka extends bb{constructor(gb,mb,Ga,ib,cc,ic,xb,Vb,wb,cb){super(gb,Ga,ib,cc,ic,wb);this.Zlb=this.XYb=null;this.lzg=mb;this.La=xb;this.he=Vb;cb&&cb.execute(lb=>{this.Ncj(lb)})}get mwd(){return"RenamedFileCheckerUsingTask"}Ncj(gb){this.XYb=gb;this.XYb.gre(Object(c.a)(this,this.cyb,"handleVisibilityChange"))}cyb(gb,mb){!this.nn||0!==mb.newState&&1!==mb.newState||this.Zlb||(this.rWd(),this.IFd(this.Zlb))}rWd(){this.Zlb=new fa.a(3,
2,this.lzg(),Object(c.a)(this,this.IFd,"performRenameFileCheckTick"),89);this.he.Eg(this.Zlb)}T$f(gb){this.he.np(gb)}Zme(gb){this.XYb&&2===this.XYb.J3j?this.Ndj(gb):y.AFrameworkApplication.YJa(Object(c.a)(this,this.Lpc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.Kpc,"onRefreshFilenameFailure"),!0)}Ndj(gb){this.he.np(gb);this.Zlb=null}Lpc(gb){gb&&this.CHf(gb.BreadcrumbFolderName,gb.BreadcrumbFolderUrl,gb.NewName,null)}l9e(){this.La.processAction(v.a.fileNameUpdate,2)}Kpc(){}}Object(u.a)(ka,"RenamedFileCheckerUsingTask",
bb,[]);var ta=a(95);class qa{constructor(){this.lb=this.gb=null}get name(){return"Common.App.RenameFile"}Wh(gb){this.gb=gb;this.lb=y.AFrameworkApplication.fa;this.gb.register(ea,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Fc(()=>new ea(y.AFrameworkApplication.ub,this.gb.ENd("Common.App.Rename.IRenameDialogFactory"))).xc();this.gb.register(Ia,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Fc(()=>new Ia(y.AFrameworkApplication.ub)).xc();
this.gb.register(659,"Common.App.Rename.IRenamedFileChecker").Fc(()=>this.Hdh()).xc();this.gb.register(aa,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Fc(()=>new aa(y.AFrameworkApplication.ub,ta.FocusManager.instance())).xc()}Hdh(){if(this.lb.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const gb=this.gb.Kh("Common.IRefreshableAppSettings");if(gb&&gb.Nrd)return new wa(()=>gb.rd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>y.AFrameworkApplication.sm,()=>
new Date,()=>y.AFrameworkApplication.qz,gb,this.gb.Kh("Common.ISessionStatus"),()=>da.instance,this.gb.Ub("Postmessage.IHostPostmessenger"))}return new ka(()=>this.lb.rd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.lb.rd("RenamedFileCheckerPingIntervalInMs",12E4),()=>y.AFrameworkApplication.sm,()=>new Date,()=>y.AFrameworkApplication.qz,y.AFrameworkApplication.fa,y.AFrameworkApplication.ub,y.AFrameworkApplication.Gi,this.gb.Kh("Common.ISessionStatus"),this.gb.Ub("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.lb.Dv(Object(c.a)(this,
this.HB,"onFullAppSettingsReady"))}HB(){const gb=y.AFrameworkApplication.sa.Pa.Es;y.AFrameworkApplication.X7a()&&I.instance.initialize(y.AFrameworkApplication.I$b,gb?null:y.AFrameworkApplication.x2a,gb?null:y.AFrameworkApplication.cMd||CommonUIStrings.l_RenameFileTooltip)&&(this.gb.register(ja,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Fc(()=>new ja(()=>y.AFrameworkApplication.userCanRename,()=>y.AFrameworkApplication.isReadOnlyRecommended,y.AFrameworkApplication.Kuc,y.AFrameworkApplication.X7a,
new b.a(()=>y.AFrameworkApplication.qz))).xc(),da.instance.Hg(),this.lb.qa("RenameDialogIsEnabled")&&(this.gb.resolve("Common.App.Rename.RenameDialogFactory").initialize(y.AFrameworkApplication.sm,y.AFrameworkApplication.I$b),this.gb.resolve("Common.App.Rename.IRenameDialogActor").Hg()),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").Hg(),y.AFrameworkApplication.Kuc&&this.gb.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").fIg())}dispose(){}}
Object(u.a)(qa,"PackageManager",null,[4,5]);var rb=a(248);a.d(E,"a",function(){return Za});const Za=()=>{Type.registerNamespace("Common.App.Rename");rb.a.instance.Fi(new qa,7)}},1450:function(u,E,a){a.r(E);u=a(1143);var c=a(9);E=a(0);var b=a(692),e=a(50),f=a(37),d=a(4),h=a(59),m=a(183),l=a(25),w=a(55);class n{constructor(da){this.renameFileManager=da}executeCommand(da,S,oa){switch(S.command){case l.a.gia:return h.a.zg.Es?2!==d.AFrameworkApplication.ub.ae(l.a.gia,2,oa)?w.Task.Ta(!0):m.a(S.command):
m.a(S.command);case 1897077126:return this.renameFileManager.renameFile(oa,S),w.Task.Ta(!0);default:return m.a(S.command)}}wc(da,S,oa,K){switch(S.command){case l.a.gia:return h.a.zg.Es;case 1897077126:return!!K&&2===K.mz}return!1}Kc(){return!1}nc(){return!1}dispose(){this.renameFileManager=null}}Object(E.a)(n,"RenameFileCommandHandler",null,[223,2]);class y extends b.a{constructor(da){super(da)}ld(){const da=e.GetServiceTaskFactory.create(this.$.da,119,this.la,this.Ya);f.TaskExtensions.Aa(da,()=>
{this.Yc([new n(da.result)])},this.la,3)}static ka(da){b.a.Nd(118,new y(da))}}Object(E.a)(y,"RenameFileCommandHandlerFactory",b.a,[]);var t=a(87),r=a(222),v=a(227),B=a(15),A=a(30),z=a(78),x=a(378),D=a(76),J=a(371),L=a(188),T=a(91),O=a(282),G=a(1),C=a(22),H=a(281);class I{constructor(da){this.$=da}get rhf(){return this.$.workbookContext.FileCoauthorable}get MAb(){return!1}get ewb(){return this.$.ea.amIAlone}get BMe(){if(this.ewb)return!0;for(const da of this.$.ea.Xm)if(!da.SupportsRename)return!1;
return!0}}Object(E.a)(I,"EwaCoauthManager",null,[920]);var M=a(60),Q=a(69);class U extends z.a{constructor(da,S){super();this.Ada=this.bMd=this.mVf=this.l7c=null;this.ska=()=>{var oa=this.$.ea.Io;if(oa&&oa.WorkbookFileName){var K=A.a.Rq(oa.WorkbookFileName),ea=!!C.a.compare(this.$.workbookContext.WorkbookFileName,oa.WorkbookFileName,!1),ya=G.EwaSettings.ma(531)&&!!oa.BreadcrumbFolderUrl&&!!C.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,oa.BreadcrumbFolderUrl,!1);if(ea||ya)this.Ada=
{},this.Ada.NewFileName=K,this.Ada.EditDocInClientUrl=oa.EditDocInClientUrl,this.Ada.DirectInvokeDAVUrl=oa.DirectInvokeDAVUrl,this.Ada.DownloadACopyUrl=oa.DownloadACopyUrl,G.EwaSettings.ma(531)&&oa.BreadcrumbFolderUrl&&(this.Ada.BreadcrumbFolderName=oa.BreadcrumbFolderName,this.Ada.BreadcrumbFolderUrl=oa.BreadcrumbFolderUrl),oa=d.AFrameworkApplication.ub.ae(l.a.fileNameUpdate,2,K),this.Ada=null,B.ULS.shipAssertTag(537154064,0,32===oa,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};
this.NNi=(oa,K,ea)=>{this.mVf=K;this.bMd=ea;this.$.Ja.Kb(new T.a(1897077126,D.a.Db,2,3,null),{["newFileName"]:oa})};this.MNi=oa=>{this.Ada&&oa(this.w5e(this.Ada),this.As)};this.qGb=oa=>{O.a(oa)||!oa.Result?(oa=U.KKh(oa),Q.a(this.$).hd.sM([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.bMd(oa)):this.mVf(this.w5e(oa.Result),this.As)};this.zUi=()=>{this.bMd(5)};this.$=da;this.As=S;this.$.ea.ku(this.ska)}initialize(){d.AFrameworkApplication.i$b=this.NNi;d.AFrameworkApplication.YJa=
this.MNi;this.l7c=d.AFrameworkApplication.qz;d.AFrameworkApplication.qz=new I(this.$)}dispose(){d.AFrameworkApplication.i$b=null;d.AFrameworkApplication.YJa=null;this.$.ea.Mv(this.ska);d.AFrameworkApplication.qz=this.l7c;this.$=this.l7c=null;super.dispose()}renameFile(da,S){const oa=da.newFileName;if(oa){const K=this.$.pa.ya.Wb();J.a(this.$.userOperationManager,(ea,ya,ha)=>{var La=this.$.pa.ya;ea=H.b(ea,this.qGb);ya=H.a(ya,this.zUi);const Ia=La.Na(9,K);Ia.newFileName=oa;return M.g(La,"RenameFile",
Ia,ea,ya,ha,null,0)},ea=>new L.a(134,0,ea),S)}}Uji(){return 32===d.AFrameworkApplication.ub.processAction(l.a.gia,1)}w5e(da){var S=this.$.workbookContext;d.AFrameworkApplication.vZ=da.DownloadACopyUrl;const oa=G.EwaSettings.ma(531)&&!!da.BreadcrumbFolderUrl;oa&&(d.AFrameworkApplication.sm.breadcrumbFolderName=da.BreadcrumbFolderName,d.AFrameworkApplication.sm.breadcrumbFolderUrl=da.BreadcrumbFolderUrl,S.FullDocumentInfo.BreadcrumbFolderUrl=da.BreadcrumbFolderUrl,S.FullDocumentInfo.BreadcrumbFolderName=
da.BreadcrumbFolderName);S.FullDocumentInfo.BreadcrumbDocName=da.NewFileName;x.d(S,da.NewFileName);S={};S.NewName=da.NewFileName;S.DirectInvokeDavUrl=da.DirectInvokeDAVUrl;S.EditDocInClientUrl=da.EditDocInClientUrl;oa&&(S.BreadcrumbFolderName=da.BreadcrumbFolderName,S.BreadcrumbFolderUrl=da.BreadcrumbFolderUrl);S.OperationResult=0;return S}static KKh(da){switch(da.Errors[0].MessageId){case -414480287:da=2;break;case 650565124:da=1;break;case 1636785843:da=6;break;case -782844485:da=4;break;default:da=
5}return da}}Object(E.a)(U,"RenameFileManager",z.a,[899,2]);var N=a(51);class W extends r.a{constructor(da){super();this.jZ=this.renameFileManager=null;this.$=da;this.Fb()}create(){if(!this.jZ){const da=v.a.L1a(N.b(),this.la,"Task","IRenameFileManager");this.jZ=da.task;const S=e.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Ya),oa=e.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Ed([oa,S],this.la),()=>{const K=new U(this.$,S.result);this.$.da.Ga(120,
K);da.setResult(K)},this.la,3)}this.jZ.continueWith(da=>{this.ob(da.result)})}dispose(){t.a.Ia(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static ka(da){da.da.Ga(119,new W(da))}}Object(E.a)(W,"RenameFileManagerServiceFactory",r.a,[]);class X{constructor(da){this.Uh=da}nc(){return!1}executeCommand(da,S,oa){return 2!==this.Uh.ae(l.a.q8f,2,oa)?w.Task.Ta(!0):m.a(S.command)}wc(da,S){return 1204860550===S.command}Kc(){return!1}}Object(E.a)(X,"RenameFileDialogCommandHandler",
null,[223]);class sa extends b.a{constructor(da){super(da)}ld(){f.TaskExtensions.Aa(e.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),()=>{this.Yc([new X(d.AFrameworkApplication.ub)])},this.la,3)}static ka(da){b.a.Nd(131,new sa(da))}}Object(E.a)(sa,"RenameFileDialogCommandHandlerFactory",b.a,[]);Type.registerNamespace("_Ewa");Object(u.a)();(()=>{c.a.Fa(da=>{W.ka(da);y.ka(da)})})();c.a.Fa(sa.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.rn.js.map/697774f3f130052266c5af150a90a99e/EwaDSEsNext.rn.js.map