/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1146:function(u,E,a){u=a(0);var c=a(15),b=a(692),e=a(76),f=a(37);class d{constructor(na,jb){this.automateCommandManager=na;this.$=jb}nc(){return!1}executeCommand(na,jb,Ib){na=f.TaskExtensions.Sj();jb=jb.command;switch(jb){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.Xc(2045014907,-1,0,null),this.automateCommandManager.Ykc(jb,
1904816141===jb?Ib[e.a.Jc].toString():null)}return na}wc(na,jb){na=!1;switch(jb.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:na=this.$.GV}return na}Kc(na,jb,Ib){return"PopulateAutomateGalleryMenu"===jb&&this.$.GV?(this.automateCommandManager.Kc(jb,Ib),!0):!1}}Object(u.a)(d,"AutomateCommandHandler",null,[223]);var h=a(460);class m extends b.a{constructor(na){super(na)}ld(){h.a(this.$,374,375,
this.Ya,()=>{const na=this.$.da.za(352);na?this.Yc([new d(na,this.$)]):c.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})}static ka(na){na.da.Ga(308,new m(na))}}Object(u.a)(m,"AutomateCommandHandlerFactory",b.a,[]);b=a(222);var l=a(7),w=a(4);class n{constructor(){this.token=null;this.timeStamp=0}}Object(u.a)(n,"AuthContext",null,[]);var y=a(721),t=a(132),r=a(110),v=a(28),B=a(764),A=a(145),z=a(72);class x{constructor(na,jb,Ib){var dc,
ob;this.$=na;this.oAuthManager=jb;this.lv=Ib;this.a3=new n;this.Hpb=null!==(ob=null===(dc=this.oAuthManager)||void 0===dc?void 0:dc.PMa())&&void 0!==ob?ob:!1}getAuthContext(){return this.a3}cba(){const na=v.a.Qa.zb,jb=[];if(this.oAuthManager)jb.push(Object(l.a)(new z.a,{name:"IsAuthSupported",bool:this.Hpb}));else return this.bva(jb,na,"need_OAuthManager","No OAuthManager");if(!this.lv.Jo||!this.lv.Jo.value)return this.bva(jb,na,"need_license","No License");if(w.AFrameworkApplication.fa.qa("IsAnonymousUser"))return this.bva(jb,
na,"need_user","Anonymous User");if(33E5>Date.now()-this.a3.timeStamp)return jb.push(Object(l.a)(new z.a,{name:"UsedCachedToken",bool:!0})),A.a(t.a.w$a,!0,0,jb),Promise.resolve(Object(l.a)(new B.a,{IsSuccess:!0,Token:this.a3.token}));jb.push(Object(l.a)(new z.a,{name:"UsedCachedToken",bool:!1}));let Ib=1;const dc=(ob,Fa)=>(new Promise(Ab=>{window.setTimeout(()=>{Ab(ob)},Fa)})).then(Ab=>{jb.push(Object(l.a)(new z.a,{name:"Error"+Ib,string:Ab.ErrorMessage}));jb.push(Object(l.a)(new z.a,{name:"ErrorCode"+
Ib,string:Ab.ErrorCode}));Ib++;return this.CPb()});return this.CPb().catch(ob=>dc(ob,200)).catch(ob=>dc(ob,400)).then(ob=>{ob.IsSuccess?(this.a3.token=ob.Token,this.a3.timeStamp=Date.now()):(jb.push(Object(l.a)(new z.a,{name:"Error"+Ib,string:ob.ErrorMessage})),jb.push(Object(l.a)(new z.a,{name:"ErrorCode"+Ib,string:ob.ErrorCode})));jb.push(Object(l.a)(new z.a,{name:"Attempts",int64:Ib}));jb.push(Object(l.a)(new z.a,{name:"Error",string:ob.ErrorMessage}));jb.push(Object(l.a)(new z.a,{name:"ErrorCode",
string:ob.ErrorCode}));A.a(t.a.w$a,ob.IsSuccess,r.getElapsedMilliseconds(na,v.a.Qa.zb),jb);return Promise.resolve(ob)}).catch(ob=>{jb.push(Object(l.a)(new z.a,{name:"Error"+Ib,string:ob.ErrorMessage}));jb.push(Object(l.a)(new z.a,{name:"ErrorCode"+Ib,string:ob.ErrorCode}));jb.push(Object(l.a)(new z.a,{name:"Attempts",int64:Ib}));return this.bva(jb,na,ob.ErrorCode,ob.ErrorMessage)})}bva(na,jb,Ib,dc){na.push(Object(l.a)(new z.a,{name:"Error",string:dc}));na.push(Object(l.a)(new z.a,{name:"ErrorCode",
string:Ib}));A.a(t.a.w$a,!1,r.getElapsedMilliseconds(jb,v.a.Qa.zb),na);return Promise.resolve(Object(l.a)(new B.a,{IsSuccess:!1,ErrorMessage:dc,ErrorCode:Ib}))}CPb(){var na=y.a.Xid();let jb=0;na=this.oAuthManager.PL("Maker",na).then(Ib=>{if(Ib)return!Ib.IsSuccess&&this.KTd(Ib)?Promise.reject(Ib):Promise.resolve(Ib);Ib=Object(l.a)(new B.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Ib)}).catch(Ib=>{let dc=new B.a;Object.getType(Ib)===Object.getType(dc)?
dc=Ib:(dc.ErrorMessage=Ib.toString(),dc.ErrorCode="exception");return Promise.reject(dc)});return Promise.race([na,new Promise((Ib,dc)=>{jb=window.setTimeout(()=>{dc(Object(l.a)(new B.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(Ib=>{window.clearTimeout(jb);return Ib})}KTd(na){return"interaction_required"===na.ErrorCode||"InitFailed"===na.ErrorCode||"invalid_resource"===na.ErrorCode||"login_required"===na.ErrorCode&&na.ErrorMessage.startsWith("AADSTS500341")?
!1:!0}}Object(u.a)(x,"AutomateCommandAuth",null,[772]);var D=a(816);class J{constructor(){this.Ku=null}}Object(u.a)(J,"AutomateCommandGalleryBase",null,[]);var L=a(375),T=a(30),O=a(558),G=a(1393),C=a(19),H=a(53),I=a(13);a(313);var M=a(576);class Q{constructor(na,jb){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=na;this.currentUserMlapiToken=jb}}Object(u.a)(Q,"UserInfo",null,[]);var U=a(188),N=a(60),W=a(33),X=a(1),sa=a(281);const da=na=>"TestHost"===na.va.DocumentHostInfo.HostTier,
S=(na,jb)=>{jb.WacTaskPaneInfra=W.a.fd(na);jb.TaskpanelessRFB=!0;jb.OfficeScriptsAutomateTask=y.a.Bxf;jb.DeferAdminCheck=y.a.dua;jb.SharedScriptsButton=oa()},oa=()=>X.EwaSettings.getBooleanFeatureGate(y.a.Fzj,!1),K=(na,jb)=>{da(na)&&(X.EwaSettings.getBooleanFeatureGate(y.a.Tla,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(na.va.UserSessionId);makerstorage.setUserAccessInfo(new Q(jb,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,
"1")},ea=na=>{if(da(na))return X.EwaSettings.getBooleanFeatureGate(y.a.Tla,!1)?"makerservicelocal":"localstorage";na=y.a.jLa();return y.a.Exb(na)},ya=(na,jb,Ib,dc,ob)=>{const Fa=na.userOperationManager,Ab=na.pa;let $b=null,Cb=null,Rb=null;const uc=()=>{if(Fa.xta()||0<Ab.ya.TU||0<Ab.Nk.TU)return!1;$b&&Fa.ko($b);Cb&&Ab.Lr(Cb);Rb&&Ab.hx(Rb);Fa.kD(new U.a(507,0,(nb,Fb,Jc)=>N.g(Ab.ya,"ExecuteRichApiRequest",dc,sa.b(nb,jb),sa.a(Fb,Ib),Jc,null,0),80));return!0};uc()||($b=()=>{uc()},Cb=()=>{uc()},Rb=()=>
{uc()},Fa.ur($b),Ab.Mq(Cb),Ab.iw(Rb));return ob.task},ha=na=>{na=na.pa.ya.Na(1);na.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return na},La=na=>W.a.fd(na)?na.isChromeRtl?C.a.ARe:C.a.zRe:C.a.QJa,Ia=na=>W.a.fd(na)?C.a.W$c:C.a.V$c;class ra{constructor(na,jb){this.automateCommandManager=na;this.$=jb}bed(na){const jb=this.automateCommandManager.Va.aq().JC();
if(!oa()){var Ib=ra.$C(na,I.a.instance.ga(2133));this.zGa(Ib,y.a.cEd,this.automateCommandManager.Od,y.a.XAd,I.a.instance.ga(2129),this.automateCommandManager.Va);jb.MenuSectionList.push(Ib)}Ib=ra.$C(na,I.a.instance.ga(2134));this.zGa(Ib,y.a.wzd,y.a.Tw?this.automateCommandManager.Sh.fvb(this.automateCommandManager.Od):this.automateCommandManager.ug.fvb(this.automateCommandManager.Od),y.a.cFb,I.a.instance.ga(2130),this.automateCommandManager.Va);jb.MenuSectionList.push(Ib);Ib=ra.$C(na,I.a.instance.ga(2135));
this.zGa(Ib,y.a.HOd,this.automateCommandManager.Uk,y.a.cFb,"",this.automateCommandManager.Va);jb.MenuSectionList.push(Ib);Ib=Object(l.a)(new L.a,{Id:y.a.Job,ExternalId:y.a.Job,Command:"1606046412",LabelText:I.a.instance.ga(2126),Alt:I.a.instance.ga(2127),Image16by16:H.a.we(16),Image16by16Class:C.a.Z$c,Visible:!0});na=ra.$C(na,null);na.ControlsId="myScriptsSection.Controls";if(oa()){const dc=Object(l.a)(new L.a,{Id:y.a.tSd,ExternalId:y.a.tSd,Command:"1043696663",LabelText:I.a.instance.ga(2136),Alt:I.a.instance.ga(2136),
ExternalImageId:"PeopleSharedIcon_16",Visible:!0});na.ControlList.push(dc)}na.ControlList.push(Ib);jb.MenuSectionList.push(na);return jb}zGa(na,jb,Ib,dc,ob,Fa){if(Ib&&0<Ib.length){jb=Fa.aB(jb,1,"Size150by20").jqb();ob={};Fa={};Fa.root=ra.iZ(320,30);Fa.flexContainer=ra.c5c(!1);Fa.label=ra.v5c(!1);ob.galleryButtonInExpanded=Fa;jb.GalleryStyle=ob;for(ob=0;ob<Ib.length&&ob<dc;ob++)Fa=Ib.Fw(ob),jb.GalleryItems.push(ra.GIa(Fa.id,Fa));na.ControlList.push(jb)}else Ib=Object(l.a)(new M.a,{Id:jb,ExternalId:jb,
LabelText:ob}),na.ControlsId=Ib.Id+".Controls",na.ControlList.push(Ib)}static LJh(na){if(na){const jb=String.format(y.a.bef,na.isShared?y.a.Ydg:y.a.D_f,H.a.we(16));na=String.format(y.a.cef,T.a.Gg(na.name));return String.format(y.a.aef,jb,na)}return""}static $C(na,jb){return Object(l.a)(new O.a,{Id:na,Title:jb,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})}static GIa(na,jb){const Ib=y.a.JZd,dc=y.a.aPd,ob=y.a.KZd,Fa=y.a.bPd;return jb?ra.wsb(jb.shareId||
jb.id,"1904816141",jb.name,jb.isShared&&!oa()?Ib:dc,na,na,jb.isShared&&!oa()?ob:Fa):ra.wsb("","1904816141","","",na,na)}static wsb(na,jb,Ib,dc,ob=null,Fa=null,Ab=null){const $b={},Cb={};$b.root=ra.iZ(20,20);Cb.root=ra.iZ(20,20);return Object(l.a)(new G.a,{Id:na,ExternalId:ob||na,MenuItemId:Fa||na,Command:jb,Icon:dc,Image:H.a.we(16),ImageClass:Ab,LabelText:Ib,FullIconStyle:$b,PreviewIconStyle:Cb,Alt:Ib})}static c5c(na){const jb={display:"flex"};na?jb.flexDirection="column":(jb.height="100%",jb.flexWrap=
"nowrap",jb.justifyContent="left",jb.alignItems="left",jb.lineHeight="normal");return jb}static v5c(na){const jb={margin:"0px 3px"};na&&(jb["max-width"]="68px");return jb}static iZ(na,jb){const Ib={};Ib.width=na;Ib["min-width"]=na;Ib.height=jb;return Ib}}Object(u.a)(ra,"AutomateCommandRenderer",null,[]);class pa{constructor(na,jb){this.scripts=na;this.SNb=jb}get length(){return this.scripts.length}mN(na){for(let jb=0;jb<this.scripts.length;jb++)if(this.scripts[jb].id===na||this.scripts[jb].shareId===
na)return jb;return-1}sort(){this.SNb(this.scripts)}Nh(na){return-1===this.mN(na.id)?(this.scripts.push(na),!0):!1}yGa(na){return-1===this.mN(na.id)?(this.scripts=[na].concat(this.scripts),!0):!1}hzd(na){na=this.mN(na.id);if(-1!==na){for(var jb=this.scripts[na].iU();0<na;)this.scripts[na]=this.scripts[na-1],na--;this.scripts[0]=jb}}yX(na){const jb=this.mN(na.id);if(-1!==jb){const Ib=this.scripts[jb].shareId;this.scripts[jb]=na;this.scripts[jb].shareId=Ib}}TAb(na){const jb=this.mN(na.id);return-1!==
jb?na.name===this.scripts[jb].name:!1}AU(na){na=this.mN(na);return-1!==na?(this.scripts.splice(na,1),!0):!1}clear(){this.scripts=[]}getScripts(){return this.scripts}Vm(na){na=this.mN(na);return-1!==na?this.scripts[na]:null}Fw(na){return 0<=na&&this.length>na?this.scripts[na]:null}fvb(na){const jb=new pa([],this.SNb);for(let Ib=0;Ib<this.scripts.length;Ib++){const dc=this.scripts[Ib];na.Vm(dc.id)||jb.Nh(dc)}return jb}sX(){const na=[];for(const jb of this.scripts)na.push(jb.Ffb());return na}}Object(u.a)(pa,
"ScriptCollection",null,[]);var ba=a(193);class fa{constructor(na){this.uz=ba.b(na)||{};this.shareId=this.shareId||null}get id(){return this.uz.id}get shareId(){return this.uz.shareId}set shareId(na){this.uz.shareId=na||null}get name(){return this.uz.name}get jtb(){return this.uz.dateLastPublished}get body(){return this.uz.body}get description(){return this.uz.description}get bAb(){return this.uz.isCreator}get isShared(){return!!this.shareId&&0<this.shareId.length}iU(){return new fa(this.uz)}Ffb(){return this.uz}}
Object(u.a)(fa,"ScriptCore",null,[]);var Ka=a(41);class aa extends J{constructor(na,jb){super();this.$=na;this.Se=jb}tLa(na){switch(na){case "1":case "2":case "3":case "4":case "5":case "6":return this.Ku.Fw(parseInt(na,10)-1);default:return this.Se.Sh.Vm(na)||this.Se.ug.Vm(na)||this.Se.Od.Vm(na)||this.Se.Uk.Vm(na)}}cLa(na,jb){let Ib=null;if(this.Se.pV)switch(na){case "1":case "2":case "3":case "4":case "5":case "6":Ib=this.Ku.Fw(parseInt(na,10)-1);break;default:Ib=this.Ku.Vm(na)}W.a.isReactRibbonEnabled()?
jb[D.a.GalleryButtonProps]=ra.GIa(na,Ib):jb[D.a.InnerHTML]=ra.LJh(Ib);jb[D.a.Alt]=Ib?Ib.name:""}Np(na){this.Ku=this.RQa();this.$.af();const jb=[];jb.push(Object(l.a)(new z.a,{name:"Operation",string:na}));jb.push(Object(l.a)(new z.a,{name:"HasReadRecentCachedScripts",bool:this.Se.uka}));jb.push(Object(l.a)(new z.a,{name:"ReadScriptsDone",bool:this.Se.XLa}));jb.push(Object(l.a)(new z.a,{name:"ReadSamplesScriptsDone",bool:this.Se.o7}));jb.push(Object(l.a)(new z.a,{name:"SamplesScriptCount",int64:this.Se.Uk.length}));
jb.push(Object(l.a)(new z.a,{name:"ReadRecentScriptsDone",bool:this.Se.EW}));jb.push(Object(l.a)(new z.a,{name:"RecentScriptCount",int64:this.Se.Sh.length}));jb.push(Object(l.a)(new z.a,{name:"ReadWorkbookScriptsDone",bool:this.Se.Ks}));jb.push(Object(l.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Se.Od.length}));A.a(t.a.Snc,!0,0,jb)}SLa(na){let jb=!1,Ib="";const dc=new fa(na.scriptMetadata),ob={Operation:"HandleRefreshRibbonGallery"};ob.RefreshOperation=na.operationName;switch(na.operationName){case y.a.YIb:({message:Ib,
returnValue:jb}=this.RLa(dc));break;case y.a.WIb:({message:Ib,returnValue:jb}=this.PLa(dc));break;case y.a.VIb:({message:Ib,returnValue:jb}=this.OLa(dc));break;case y.a.XIb:({message:Ib,returnValue:jb}=this.QLa(dc));break;case y.a.RJd:({message:Ib,returnValue:jb}=this.nkd(dc))}(ob.GalleryUpdated=jb)?(c.ULS.sendTraceTag(537170322,0,50,`AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: ${Ib}`),this.Np("RefreshGallery")):c.ULS.sendTraceTag(537170321,0,15,`AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: ${Ib}`);
ob.Message=Ib;c.ULS.sendTraceTag(537170320,0,50,Ka.c(ob))}RQa(){const na=new pa([],()=>{}),jb=this.Se.Od?this.Se.Od.length:0,Ib=this.Se.Sh?this.Se.Sh.length:0,dc=this.Se.Uk?this.Se.Uk.length:0;let ob=0,Fa=y.a.$Hb;for(let Ab=0;Ab<Fa;Ab++)if(Ab<jb)na.Nh(this.Se.Od.Fw(Ab));else if(Ab-jb+ob<Ib){const $b=this.Se.Sh.Fw(Ab-jb+ob);this.Se.Od.Vm($b.id)?(ob++,Ab--):na.Nh($b)}else Ab-jb-Ib+ob<dc&&na.Nh(this.Se.Uk.Fw(Ab-jb+ob-Ib));return na}RLa(na){let jb;if(this.Se.Sh.yGa(na))jb="";else{jb="";const Ib=na.iU();
this.Se.Od.yX(Ib);this.Se.Od.sort();this.Se.Sh.yX(na)}return{returnValue:!0,message:jb}}PLa(na){this.Se.Od.AU(na.id);return this.Se.Sh.AU(na.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}}OLa(na){const jb=na.iU();jb.shareId=null;this.Se.Sh.yGa(jb);return this.Se.Od.Nh(na)?(this.Se.Od.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}QLa(na){return this.Se.Od.AU(na.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}nkd(na){const jb=na.iU();let Ib=!1;this.Se.Od.TAb(jb)&&(this.Se.Od.yX(jb),this.Se.Od.sort(),Ib=!0);this.Se.Sh.yGa(na)?Ib=!0:this.Se.Sh.TAb(na)&&(this.Se.Sh.yX(na),this.Se.Sh.hzd(na),Ib=!0);return{returnValue:Ib,message:""}}}Object(u.a)(aa,"AutomateCommandGallery",J,[]);var ja=a(82);class Va{constructor(){this.Jo=null}}Object(u.a)(Va,"AutomateCommandLicensingBase",null,[]);
class bb{constructor(na,jb,Ib=null,dc="",ob=""){this.value=na;this.isSuccess=jb;this.timeStamp=Ib;this.errorCode=dc;this.errorMessage=ob}}Object(u.a)(bb,"BoolResultWrapper",null,[]);class wa extends Va{constructor(){super()}hta(){const na=v.a.Qa.zb,jb=[];return new Promise(Ib=>{ja.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(dc=>{dc.isFeatureEnabled("ExcelOfficeScripting",!1).then(ob=>{jb.push(Object(l.a)(new z.a,{name:"IsLicensed",bool:ob}));A.a(t.a.Onc,
!0,r.getElapsedMilliseconds(na,v.a.Qa.zb),jb);this.Jo=new bb(ob,!0);Ib(ob)}).catch(ob=>{jb.push(Object(l.a)(new z.a,{name:"IsLicensed",bool:!1}));jb.push(Object(l.a)(new z.a,{name:"Error",string:ob.toString()}));jb.push(Object(l.a)(new z.a,{name:"ErrorCode",string:"exception"}));A.a(t.a.Onc,!1,r.getElapsedMilliseconds(na,v.a.Qa.zb),jb);this.Jo=new bb(!1,!1,void 0,"exception",ob.toString());Ib(!1)})})})}}Object(u.a)(wa,"AutomateCommandLicensing",Va,[]);var ka=a(1306),ta=a(1304),qa=a(1303),rb=a(1305),
Za=a(1394),gb=a(27),mb=a(170),Ga=a(570),ib=a(314),cc=a(5);class ic{constructor(na,jb,Ib,dc){this.e6a=na;this.n$b=jb;this.gW=Ib;this.cZ=dc}}Object(u.a)(ic,"LaunchSDXParams",null,[]);class xb{constructor(na,jb,Ib,dc,ob,Fa){this.actionName=na;this.shapeId=jb;this.scriptLink=Ib;this.clickId=dc;this.hR=ob;this.buttonText=Fa}}Object(u.a)(xb,"RunfromButtonParameters",null,[]);var Vb=a(161),wb=a(58),cb=a(750),lb=a(51),Y=a(39),Oa=a(137);class Wa{constructor(na,jb,Ib,dc,ob,Fa,Ab,$b,Cb){this.QA=null;this.cache=
new ib.a;this.r_=!1;this.xM={};this.$=na;this.fmb=Ib;this.indexedDB=dc;this.Npb=ob;this.lv=Fa;this.wha=Ab;this.Se=$b;this.DC=Cb;this.BSg=new ra(this,na);this.SLc=v.a.Qa.zb;this.fOb="";dc.se()&&(this.r_=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));na=!0;if(gb.a.i_c){this.cache.se()&&!y.a.dua&&(jb=this.Se.I_e(y.a.NKa(this.$)),jb.isSuccess&&(na=r.getElapsedSeconds(jb.timeStamp,v.a.Qa.zb),this.lv.Jo=new bb(!0,!0),this.QA=new bb(jb.value,!0),na=this.QA.value?604800<na:86400<na,this.qyb=
this.gTa(!0)));this.qed();if("undefined"!==typeof makerstorage&&this.v8a)if(this.fOb=ea(this.$),da(this.$))K(this.$,"localstorageToken"),this.lv.Jo=new bb(!0,!0),this.QA=new bb(!0,!0),this.qyb=this.gTa(!0);else if((jb=y.a.jLa())&&makerstorage.setStorageEnvironmentOverride(jb),na||y.a.dua)try{this.$.Udb("automateTab",!0),this.qyb=y.a.dua?this.lv.hta().then(()=>this.wha.cba()).then(()=>this.gTa(!1)).catch(()=>this.gTa(!1)):this.lv.hta().then(()=>this.wha.cba()).then(Rb=>this.J8h(Rb)).then(()=>this.gTa(!1)).catch(()=>
this.gTa(!1))}catch(Rb){c.ULS.sendTraceTag(537170314,0,15,`AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: ${Rb.message}`),this.qyb=Promise.resolve(!1),this.$.Udb("automateTab",!1)}this.qyb?this.qyb.then(Rb=>{this.vMd(Rb);this.Se.Nid()}):this.vMd(!1)}else c.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.vMd(!1)}get ug(){return this.Se.ug}get Od(){return oa()?
new pa([],()=>{}):this.Se.Od}get Uk(){return this.Se.Uk}get Sh(){return this.Se.Sh}get Va(){return this.fmb}get pV(){return this.Se.pV}get initTime(){return this.SLc}get hR(){const na=!!this.lv.Jo&&this.lv.Jo.isSuccess&&this.lv.Jo.value;var jb=!!this.QA&&!this.QA.isSuccess;const Ib=!!this.QA&&this.lv.Jo.isSuccess&&this.QA.value;jb=y.a.dua||Ib||jb&&!gb.a.Wba(11);return this.v8a&&na&&jb}get v8a(){const na="TestHost"===this.$.va.DocumentHostInfo.HostTier;var jb=w.AFrameworkApplication.fa.Xa("UserPrincipalName");
jb=!w.AFrameworkApplication.fa.qa("IsAnonymousUser")&&!!jb&&!jb.includes("ext#")&&!jb.includes("guest#");return!gb.a.v5&&(na||this.wha.Hpb&&jb)}gTa(na){const jb=w.AFrameworkApplication.fa.qa("IsO365CommercialHost");let Ib="",dc="",ob=!1;var Fa,Ab=(Fa=this.lv.Jo&&this.lv.Jo.isSuccess)&&this.lv.Jo.value;Fa=y.a.dua?Fa:!(Ab&&(!this.QA||!this.QA.isSuccess));this.lv.Jo&&!this.lv.Jo.isSuccess?(dc=this.lv.Jo.errorCode,Ib=this.lv.Jo.errorMessage):this.QA&&!this.QA.isSuccess&&(dc=this.QA.errorCode,Ib=this.QA.errorMessage);
Ab=[];Ab.push(Object(l.a)(new z.a,{name:"IsScriptingEnabled",bool:this.hR}));Ab.push(Object(l.a)(new z.a,{name:"IsValidHost",bool:jb}));Ab.push(Object(l.a)(new z.a,{name:"IsUserLicensed",bool:this.lv.Jo?this.lv.Jo.value:!1}));y.a.dua||Ab.push(Object(l.a)(new z.a,{name:"IsAdminSwitchOn",bool:this.QA?this.QA.value:!1}));Ab.push(Object(l.a)(new z.a,{name:"ShowTab",bool:this.hR}));y.a.dua||Ab.push(Object(l.a)(new z.a,{name:"ServiceChecked",bool:!na}));this.hR?W.a.Jxa(this.$)&&(na=Vb.a(this.$),(null===
na||void 0===na?0:na.Em)?(Ab.push(Object(l.a)(new z.a,{name:"RibbonType",string:"React"})),na.Em.KFj(cc.a.tda),na.Em.GRd(["AutomateAutomateTask"],!y.a.Bxf&&!y.a.Dzd),X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(ob=!0)):(dc="ribbon_manager_error",Ib="The RibbonManager or RibbonUser is null")):this.C$h();Ab.push(Object(l.a)(new z.a,{name:"Error",string:Ib}));
Ab.push(Object(l.a)(new z.a,{name:"ErrorCode",string:dc}));A.a(t.a.nJi,Fa,r.getElapsedMilliseconds(this.initTime,v.a.Qa.zb),Ab);this.$.Udb("automateTab",!1);return Promise.resolve(ob)}Kc(na,jb){if(!jb)return!1;jb.MenuItems=this.BSg.bed(jb.MenuId);return!0}aGd(){this.r_&&(y.a.Tw?this.Se.HIb(this.DC).continueWith(na=>{na.result&&this.DC.Np(y.a.rO)}):this.Se.hJd(this.DC));da(this.$)?this.zxb(Object(l.a)(new B.a,{IsSuccess:!0,Token:"FakeToken"})):this.wha.cba().then(na=>{this.zxb(na)})}cLa(na,jb,Ib){if(y.a.Tw)this.DC.cLa(na,
jb,Ib);else{Ib=null;if(this.Se.pV)switch(na){case "1":case "2":case "3":case "4":case "5":case "6":Ib=this.DC.Ku.Fw(parseInt(na,10)-1);break;default:Ib=this.DC.Ku.Vm(na)}jb[D.a.GalleryButtonProps]=ra.GIa(na,Ib);jb[D.a.Alt]=Ib?Ib.name:""}}SLa(na){if(y.a.Tw)this.DC.SLa(na);else{let jb=!1,Ib="";const dc=new fa(na.scriptMetadata),ob={Operation:"HandleRefreshRibbonGallery"};ob.RefreshOperation=na.operationName;switch(na.operationName){case y.a.YIb:({message:Ib,returnValue:jb}=this.RLa(dc));break;case y.a.WIb:({message:Ib,
returnValue:jb}=this.PLa(dc));break;case y.a.VIb:({message:Ib,returnValue:jb}=this.OLa(dc));break;case y.a.XIb:({message:Ib,returnValue:jb}=this.QLa(dc))}(ob.GalleryUpdated=jb)?(c.ULS.sendTraceTag(537170313,0,50,`AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: ${Ib}`),this.Np("RefreshGallery")):c.ULS.sendTraceTag(537170312,0,15,`AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: ${Ib}`);ob.Message=Ib;c.ULS.sendTraceTag(537170311,0,50,
Ka.c(ob))}}qkd(na,jb,Ib,dc){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.Yp(null,!1,1023))na=new xb(y.a.aLb,na,jb,Ib,this.hR,dc),this.Npb.zwa(na)}ayb(na,jb,Ib){na=new xb(y.a.W1d,na,jb,Ib,this.hR);this.Npb.zwa(na)}Qjd(na){this.Npb.MLa(y.a.YUd,na)}Pjd(na){this.Npb.MLa(y.a.N3c,na)}Rjd(na){this.Npb.MLa(y.a.GWd,na)}Ykc(na,jb){var Ib=lb.b().uj(na);const dc=[];dc.push(Object(l.a)(new z.a,{name:"SessionId",string:this.$.va.UserSessionId}));y.a.Dzd||(dc.push(Object(l.a)(new z.a,
{name:"MenuItemId",string:jb})),dc.push(Object(l.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Od.length})),dc.push(Object(l.a)(new z.a,{name:"PublishedScriptCount",int64:this.ug.length})),dc.push(Object(l.a)(new z.a,{name:"RecentScriptCount",int64:this.Sh.length})),dc.push(Object(l.a)(new z.a,{name:"Command",string:Ib})));jb=this.Whd(na,jb);if(Ib=this.f6f(na)?this.vVh():this.Jgd(na,Ib,jb))this.f6f(na)?(ka.a.instance.f6(Ib.n$b,"Taskpane",Ib.cZ,Ib.e6a,Ib.gW),A.a(t.a.eMf,void 0,void 0,dc)):(dc.push(Object(l.a)(new z.a,
{name:y.a.QC,string:Ib.gW.Bh[y.a.QC]})),ka.a.instance.f6(Ib.n$b,"Taskpane",Ib.cZ,Ib.e6a,Ib.gW),1904816141===na&&(dc.push(Object(l.a)(new z.a,{name:"ScriptId",string:jb.id})),dc.push(Object(l.a)(new z.a,{name:"ShareId",string:jb.shareId})),dc.push(Object(l.a)(new z.a,{name:"IsPreviewGallery",bool:!!this.DC.Ku.Vm(jb.id)})),dc.push(Object(l.a)(new z.a,{name:"IsOwner",bool:jb.bAb||!!this.ug.Vm(jb.id)})),this.$.af()),A.a(t.a.yxf,void 0,void 0,dc))}vVh(){const na=new ta.a(y.a.Qwa,y.a.qva,y.a.locale),jb=
new qa.a(y.a.TEd,OSF.StoreType.Sdx,OSF.StoreType.Sdx,y.a.UEd),Ib=new rb.a;Ib.optionalProperties[Za.a.sourceLocationOverrideResourceId]=y.a.pxb(this.$);return new ic(na,jb,Ib,null)}Jgd(na,jb,Ib){let dc=null;const ob=y.a.vq,Fa=new ta.a(y.a.Qwa,y.a.qva,y.a.locale),Ab=new qa.a(y.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,y.a.fSa),$b=new rb.a;$b.Bh.AdminPolicyForFeedback=Ka.c(this.xM);$b.Bh.DocumentHostInfo=wb.a.hc(this.$.va.DocumentHostInfo);$b.Bh.CodeEditorUrl=y.a.C4(this.$);$b.Bh.MakerTestService=
X.EwaSettings.getBooleanFeatureGate(y.a.Tla,!1);$b.Bh[y.a.QKb]=y.a.bV(this.$);$b.Bh.StorageModePreference=this.fOb||"";$b.Bh.Source="Ribbon";$b.Bh[y.a.GOb]=wb.a.hc(ob);$b.Bh[y.a.Ypb]=this.$.Nnc?"true":"false";$b.Bh[y.a.QC]=mb.a.create().toString();var Cb=La(this.$);const Rb=Ia(this.$);$b.optionalProperties.HeaderCssClass=Cb;$b.optionalProperties.TitleCssClass=Rb;$b.Bh[y.a.Ayb]=Cb;$b.Bh[y.a.cPb]=Rb;Cb={};Cb.ribbonCommand=jb;Cb[y.a.dOb]=this.wha.getAuthContext();Cb[y.a.xW]=this.Se.GIb?this.ug.sX():
null;Cb[y.a.F2d]=this.Se.LQa?this.Od.sX():null;y.a.Tw&&(Cb[y.a.rO]=this.Se.KQa?this.Sh.sX():null);$b.Bh[y.a.Jzb]=wb.a.hc(Cb);jb={};S(this.$,jb);$b.Bh[y.a.rvb]=wb.a.hc(jb);switch(na){case -45542983:$b.Bh.Script="";$b.Bh.Destination="Editor";$b.Bh.IsOwner=!0;$b.optionalProperties[Za.a.kj]=I.a.instance.ga(2122);$b.optionalProperties[Za.a.taskPaneWidth]=ob;$b.optionalProperties[Za.a.sourceLocationOverrideResourceId]=y.a.C4(this.$);dc=y.a.qta;break;case -1342227603:$b.optionalProperties[Za.a.kj]=I.a.instance.ga(2124);
$b.optionalProperties[Za.a.taskPaneWidth]=ob;$b.optionalProperties[Za.a.sourceLocationOverrideResourceId]=y.a.pxb(this.$);break;case 971811139:case 1606046412:$b.Bh.Script="";$b.Bh.Destination="BackStage";$b.Bh.IsOwner=!0;$b.optionalProperties[Za.a.kj]=I.a.instance.ga(2122);$b.optionalProperties[Za.a.taskPaneWidth]=ob;$b.optionalProperties[Za.a.sourceLocationOverrideResourceId]=y.a.C4(this.$);dc=y.a.qta;break;case 1043696663:$b.Bh.Script="";$b.Bh.Destination="BackStage_Workbook";$b.optionalProperties[Za.a.kj]=
I.a.instance.ga(2122);$b.optionalProperties[Za.a.taskPaneWidth]=ob;$b.optionalProperties[Za.a.sourceLocationOverrideResourceId]=y.a.C4(this.$);dc=y.a.qta;break;case 1845457202:$b.optionalProperties[Za.a.kj]=I.a.instance.ga(2123);$b.optionalProperties[Za.a.taskPaneWidth]=ob;$b.optionalProperties[Za.a.sourceLocationOverrideResourceId]=y.a.bdc(this.$);dc=y.a.dPd;break;case -2126202430:case 1623358083:case 1904816141:if(Ib)$b.Bh.Script=wb.a.hc(Ib.Ffb()),$b.Bh.Destination="Details",$b.Bh.IsOwner=Ib.bAb||
!!this.ug.Vm(Ib.id),$b.optionalProperties[Za.a.kj]=I.a.instance.ga(2122),$b.optionalProperties[Za.a.taskPaneWidth]=ob,$b.optionalProperties[Za.a.sourceLocationOverrideResourceId]=y.a.C4(this.$),dc=y.a.qta;else return null;break;default:return null}return new ic(Fa,Ab,$b,dc)}Whd(na,jb){switch(na){case -2126202430:na=this.Se.e8.Vm(y.a.LOb);break;case 1623358083:na=this.Se.e8.Vm(y.a.MOb);break;default:na=jb?this.tLa(jb):null}return na}qed(){ja.a.instance.Ub("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(na=>
{this.xM.FeedbackEnabled=!0;this.xM.ScreenshotEnabled=!0;this.xM.EmailEnabled=!0;na.wF("Enabled").then(jb=>{this.xM.FeedbackEnabled=jb},()=>{});na.wF("IncludeScreenshot").then(jb=>{this.xM.ScreenshotEnabled=jb},()=>{});na.wF("IncludeEmail").then(jb=>{this.xM.EmailEnabled=jb},()=>{})})}J8h(na){const jb=v.a.Qa.zb,Ib=[];if(!na||!na.IsSuccess){const dc=na?na.ErrorCode:"need_token";na=na?na.ErrorMessage:"No Access Token";Ib.push(Object(l.a)(new z.a,{name:"ServiceChecked",bool:!1}));Ib.push(Object(l.a)(new z.a,
{name:"Error",string:na}));Ib.push(Object(l.a)(new z.a,{name:"ErrorCode",string:dc}));A.a(t.a.jBd,!1,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);this.QA=new bb(!1,!1,void 0,dc,na);return Promise.resolve(!1)}Ib.push(Object(l.a)(new z.a,{name:"ServiceChecked",bool:!0}));K(this.$,na.Token);return makerstorage.getUserPermissions(this.$.va.UserSessionId).then(dc=>{this.QA=new bb(dc.OfficeScriptingEnabled,!0);this.Se.Hye(y.a.NKa(this.$),dc.OfficeScriptingEnabled);Ib.push(Object(l.a)(new z.a,{name:"IsEnabled",
bool:this.QA.value}));A.a(t.a.jBd,!0,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);return Promise.resolve(this.QA.value)}).catch(dc=>{Object.getType(dc)===makerstorage.StorageServiceError?(Ib.push(Object(l.a)(new z.a,{name:"Error",string:dc.message})),Ib.push(Object(l.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${dc.errorCode.toString()}_${dc.status.toString()}`}))):(Ib.push(Object(l.a)(new z.a,{name:"Error",string:dc.toString()})),Ib.push(Object(l.a)(new z.a,{name:"ErrorCode",string:"exception"})));
A.a(t.a.jBd,!1,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);this.QA=new bb(!1,!1,void 0,"exception",dc.toString());return Promise.resolve(!1)})}zxb(na){this.Se.Thd(this.DC);y.a.Tw?this.Se.Khd(na,this.DC,this.cache):this.Chd(na);oa()||this.Se.gJd(jb=>{this.Se.hid(jb,na,this.DC)},this.DC)}Chd(na){const jb=v.a.Qa.zb,Ib=[];if(na&&na.IsSuccess){K(this.$,na.Token);var dc=Ga.a.create().toString();Ib.push(Object(l.a)(new z.a,{name:"CorrelationId",string:dc}));makerstorage.getScripts(dc).then(ob=>{Ib.push(Object(l.a)(new z.a,
{name:"HasReadCachedScripts",bool:this.Se.W4}));this.ug.clear();for(const Fa of ob)this.ug.Nh(new fa(Fa));this.ug.sort();this.Se.GIb=!0;this.Se.DW=!0;this.r_&&(ob=wb.a.hc(this.ug.sX()),this.indexedDB.Gna(new cb.a(y.a.xW,ob)));Ib.push(Object(l.a)(new z.a,{name:"ScriptCount",int64:this.ug.length}));A.a(t.a.Ica,!0,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);this.Np(y.a.xW)}).catch(ob=>{Object.getType(ob)===makerstorage.StorageServiceError?(Ib.push(Object(l.a)(new z.a,{name:"Error",string:ob.message})),
Ib.push(Object(l.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${ob.errorCode.toString()}_${ob.status.toString()}`})),17===ob.errorCode&&this.cache.vJb(y.a.NKa(this.$))):(Ib.push(Object(l.a)(new z.a,{name:"Error",string:ob.toString()})),Ib.push(Object(l.a)(new z.a,{name:"ErrorCode",string:"exception"})));A.a(t.a.Ica,!1,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);this.Se.DW=!0;this.Np(y.a.xW)})}else dc=na?na.ErrorCode:"need_token",na=na?na.ErrorMessage:"No Access Token",Ib.push(Object(l.a)(new z.a,
{name:"ServiceChecked",bool:!1})),Ib.push(Object(l.a)(new z.a,{name:"Error",string:na})),Ib.push(Object(l.a)(new z.a,{name:"ErrorCode",string:dc})),A.a(t.a.Ica,!1,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib),this.Se.DW=!0,this.Np(y.a.xW)}tLa(na){if(y.a.Tw)return this.DC.tLa(na);switch(na){case "1":case "2":case "3":case "4":case "5":case "6":return this.DC.Ku.Fw(parseInt(na,10)-1);default:return this.ug.Vm(na)||this.Od.Vm(na)||this.Uk.Vm(na)}}RLa(na){let jb;if(this.ug.Nh(na))this.ug.sort(),jb="";else{jb=
"";const Ib=na.iU();this.Od.yX(Ib);this.Od.sort();this.ug.yX(na);this.ug.sort()}return{returnValue:!0,message:jb}}PLa(na){this.Od.AU(na.id);return this.ug.AU(na.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}}OLa(na){const jb=na.iU();jb.shareId=null;this.ug.Nh(jb)&&this.ug.sort();return this.Od.Nh(na)?(this.Od.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}QLa(na){return this.Od.AU(na.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}Np(na){if(y.a.Tw)this.DC.Np(na);else{this.RQa();this.$.af();const jb=[];jb.push(Object(l.a)(new z.a,{name:"Operation",string:na}));jb.push(Object(l.a)(new z.a,{name:"HasReadCachedScripts",bool:this.Se.W4}));jb.push(Object(l.a)(new z.a,{name:"ReadScriptsDone",bool:this.Se.XLa}));jb.push(Object(l.a)(new z.a,{name:"ReadSamplesScriptsDone",bool:this.Se.o7}));jb.push(Object(l.a)(new z.a,
{name:"SamplesScriptCount",int64:this.Uk.length}));jb.push(Object(l.a)(new z.a,{name:"ReadPublishedScriptsDone",bool:this.Se.DW}));jb.push(Object(l.a)(new z.a,{name:"PublishedScriptCount",int64:this.ug.length}));jb.push(Object(l.a)(new z.a,{name:"ReadWorkbookScriptsDone",bool:this.Se.Ks}));jb.push(Object(l.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Od.length}));A.a(t.a.Snc,!0,0,jb)}}RQa(){this.DC.Ku=new pa([],()=>{});const na=this.Od?this.Od.length:0,jb=this.ug?this.ug.length:0,Ib=this.Uk?
this.Uk.length:0;let dc=0;const ob=y.a.$Hb;for(let Fa=0;Fa<ob;Fa++)if(Fa<na)this.DC.Ku.Nh(this.Od.Fw(Fa));else if(Fa-na+dc<jb){const Ab=this.ug.Fw(Fa-na+dc);this.Od.Vm(Ab.id)?(dc++,Fa--):this.DC.Ku.Nh(Ab)}else Fa-na-jb+dc<Ib&&this.DC.Ku.Nh(this.Uk.Fw(Fa-na+dc-jb))}vMd(na){X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(na?(Y.PageLoadTrackingInfo.instance.x0(cc.a.yO,
["automateTab"]),Y.PageLoadTrackingInfo.instance.YR(cc.a.yO,["automateTab"]),Y.PageLoadTrackingInfo.instance.MW(cc.a.yO,["automateTab"])):Y.PageLoadTrackingInfo.instance.Mda(cc.a.yO,["automateTab"]))}C$h(){X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&Oa.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(cc.a.tda))}f6f(na){return y.a.Dzd&&-1342227603===na}}Object(u.a)(Wa,"AutomateCommandManager",null,[640]);var Ca=a(1361),Ra=a(1308),la=a(249),
ua=a(857),xa=a(50),fb=a(103),Jb=a(21),Ob;(function(na){na.preparing="preparing";na.running="running";na.succeeded="succeeded";na.fetchFailed="fetchFailed";na.runFailed="runFailed";na.canceled="canceled";na.alreadyRunning="alreadyRunning";na.initializing="initializing"})(Ob||(Ob={}));Object(u.b)("OfficeScriptsRunStatus",Ob);class eb{constructor(na,jb,Ib,dc,ob,Fa){this.scriptLink="";this.runStatus=Ob.preparing;this.clickId="";this.hasLogs=this.isOwner=this.buttonText=void 0;this.scriptLink=na;this.runStatus=
jb;this.clickId=Ib;this.buttonText=dc;this.isOwner=ob;this.hasLogs=Fa}}Object(u.a)(eb,"OfficeScriptsBusinessBarParams",null,[]);class Ma{constructor(na){this.shareId="";this.shareId=na}}Object(u.a)(Ma,"OfficeScriptsShareLinkObject",null,[]);class va{constructor(na,jb,Ib,dc){this.LV=!1;this.Kca=()=>{this.eNb()?(this.SHb(),Jb.h(this.$).Ea.GJb(this.Kca)):this.LV&&Jb.h(this.$).Ea.GJb(this.Kca)};this.cCd=(ob,Fa)=>{Object.getType(Fa)===String&&Fa.toString().endsWith(y.a.gba(this.$))&&(this.LV=!1)};this.$=
na;this.wha=jb;this.lv=Ib;this.businessBarManager=dc;this.nSd()}zwa(na){if(na.hR){const jb=[];jb.push(Object(l.a)(new z.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.LV}));jb.push(Object(l.a)(new z.a,{name:"actionName",string:na.actionName}));jb.push(Object(l.a)(new z.a,{name:y.a.QC,string:na.clickId.toString()}));this.LV?this.ILb(na):this.ckd(na);A.a(t.a.zxf,void 0,void 0,jb)}}MLa(na,jb){const Ib={};Ib[y.a.QC]=jb;this.qSa(na,Ib)}nSd(){this.eNb()?this.SHb():Jb.h(this.$).Ea.oWc(this.Kca)}eNb(){if(this.LV||
da(this.$))return!1;const na=fb.a(this.$);return Jb.h(this.$).Ea.Iob&&na.vff()}SHb(){this.lv.Jo?this.lv.Jo.value&&this.wha.cba():this.lv.hta().then(na=>{na&&this.wha.cba()});A.a(t.a.uxf)}WPd(){const na=mb.a.create().toString();var jb={};S(this.$,jb);const Ib={};Ib[y.a.dOb]=this.wha.getAuthContext();const dc={};dc[y.a.rvb]=wb.a.hc(jb);dc[y.a.Jzb]=wb.a.hc(Ib);dc[y.a.x8c]=wb.a.hc(this.$.va.DocumentHostInfo);dc[y.a.KWd]=ea(this.$);dc[y.a.GOb]=wb.a.hc(y.a.vq);dc[y.a.Ypb]=this.$.Nnc?"true":"false";dc[y.a.QKb]=
y.a.bV(this.$);dc[y.a.Ayb]=La(this.$);dc[y.a.cPb]=Ia(this.$);dc[y.a.QC]=na;jb=[];jb.push(Object(l.a)(new z.a,{name:y.a.QC,string:na}));A.a(t.a.xxf,void 0,void 0,jb);this.qSa(y.a.lnd,dc)}ckd(na){this.hUd(na);da(this.$)&&K(this.$,"localstorage");f.TaskExtensions.Aa(xa.GetServiceTaskFactory.Oa(this.$.da,374,375,1),jb=>{this.Evd(jb.result).continueWith(()=>{this.VPd(na)});this.LV=!0},this.$.la,3)}Evd(na){const jb={};jb.SolutionId=y.a.solutionId;jb.Version=y.a.fSa;jb.StoreType=OSF.StoreType.Sdx;jb.StoreId=
OSF.StoreType.Sdx;X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(jb.AssetId=null,jb.AssetStoreId=null):(jb.AssetId=y.a.solutionId,jb.AssetStoreId=OSF.StoreType.Sdx);jb.TargetType=1;jb.SharedRuntimeId=y.a.gba(this.$);jb.SourceLocationOverrideResourceId=y.a.gba(this.$);jb.IsToBePersisted=!1;const Ib=new Ca.a;Ib.kj=I.a.instance.ga(2146);Ib.taskPaneWidth=y.a.vq;const dc=new ua.a;dc.oUa=Ia(this.$);dc.$Z=La(this.$);return na.mLb(jb,Ib,void 0,void 0,dc)}VPd(na){this.WPd();
la.a(this.$)&&la.a(this.$).xWc(this.cCd);this.ILb(na)}ILb(na){const jb={};jb[y.a.BOd]=na.shapeId;jb[y.a.AOd]=na.scriptLink;jb[y.a.QC]=na.clickId.toString();jb[y.a.zOd]=na.buttonText;this.qSa(na.actionName,jb)}qSa(na,jb){const Ib=new qa.a(y.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,y.a.fSa),dc=new ta.a(y.a.Qwa,y.a.qva,this.$.va.UICultureTag),ob=new rb.a;ob.optionalProperties[Za.a.kj]=I.a.instance.ga(2146);ob.optionalProperties[Za.a.sourceLocationOverrideResourceId]=y.a.gba(this.$);ob.optionalProperties[Za.a.jZb]=
jb;ob.optionalProperties[Za.a.taskPaneWidth]=y.a.vq;ka.a.instance.f6(Ib,Ra.a.action,na,dc,ob)}hUd(na){na.actionName===y.a.aLb&&(na=new eb(na.scriptLink,"initializing",na.clickId.toString(),na.buttonText),this.businessBarManager.cWc(64,na))}}Object(u.a)(va,"AutomateCommandRunFromButton",null,[638]);var Pa=a(157),Ha=a(22);class tb{constructor(){this.Sh=null;this.W4=this.o7=this.Ks=this.DW=this.LQa=this.GIb=this.KQa=this.EW=this.uka=!1;this.e8=this.Uk=this.Od=this.ug=null}get pV(){const na=y.a.Tw?this.uka:
this.W4;return this.o7||na||this.XLa}get XLa(){return(y.a.Tw?this.EW:this.DW)&&this.Ks&&this.o7}static MVd(na){na.sort((jb,Ib)=>Ib.jtb-jb.jtb)}static toa(na){na.sort((jb,Ib)=>Ha.a.compare(jb.name,Ib.name,!0))}static zid(na){let jb,Ib;Ib=jb=null;if(na){const dc=na.indexOf(":");if(-1!==dc)return jb=na.substr(0,dc),Ib=na.substr(dc+1),{returnValue:!0,eOb:jb,shareId:Ib}}return{returnValue:!1,eOb:jb,shareId:Ib}}static bid(na,jb){const Ib={};Ib[y.a.jRb]=encodeURIComponent(na.workbookContext.WorkbookFileName);
Ib[y.a.rLb]=jb.sX();return Ka.c(Ib)}static IIb(na,jb){return f.TaskExtensions.TJ(jb.Sja(y.a.qpa),Ib=>{Ib=Ib.result;if(""!==Ib){var dc=Ka.b(Ib);Ib=dc[y.a.rLb];if(dc[y.a.jRb]===encodeURIComponent(na.workbookContext.WorkbookFileName)){dc=new pa([],ob=>{tb.toa(ob)});for(const ob of Ib)dc.Nh(new fa(ob));dc.sort();return dc}}},na.la,3)}}Object(u.a)(tb,"AutomateCommandStorageBase",null,[]);var Ya=a(116),V=a(98);class za extends tb{constructor(na,jb){super();this.$=na;this.vua=new DOMParser;this.cache=new ib.a;
this.indexedDB=jb;jb.se()&&this.indexedDB.initialize("Scripts","OfficeScriptingCache");this.W4=!1;this.ug=new pa([],Ib=>{tb.MVd(Ib)});this.Od=new pa([],Ib=>{tb.toa(Ib)});this.Uk=new pa([],Ib=>{tb.toa(Ib)});this.Sh=new pa([],()=>{});this.e8=new pa([],Ib=>{tb.toa(Ib)})}Hye(na,jb){if(this.cache.se()){const Ib={};Ib.TimeStamp=v.a.Qa.zb;Ib.IsEnabled=jb;this.cache.Rxc(na,wb.a.hc(Ib))}}I_e(na){let jb=!1,Ib=!1,dc=null;this.cache.se()&&(na=Ka.b(this.cache.V4a(na)))&&(Ib=na.IsEnabled,dc=new Date(na.TimeStamp),
jb=!0);return new bb(Ib,jb,dc)}HIb(na){const jb=v.a.Qa.zb,Ib=[];return f.TaskExtensions.TJ(this.indexedDB.Sja(y.a.rO),dc=>{const ob=!this.EW||!this.Sh.length;dc=dc.result;Ib.push(Object(l.a)(new z.a,{name:"ExistingScriptCount",int64:this.Sh.length}));if(""!==dc&&(dc=Ka.b(dc),Ib.push(Object(l.a)(new z.a,{name:"CachedScriptCount",int64:dc.length})),ob)){for(const Fa of dc)this.Sh.Nh(new fa(Fa));this.uka=!0;this.KQa=0<dc.length;A.a(t.a.Qnc,ob,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);this.XQa(na);return!0}A.a(t.a.Qnc,
ob,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);return!1},this.$.la,3)}hJd(na){X.EwaSettings.getBooleanFeatureGate(y.a.mZc,!1)&&!oa()&&this.kJd(na);y.a.Tw?this.HIb(na):this.fJd(na)}Khd(na,jb,Ib){const dc=v.a.Qa.zb,ob=[];if(na&&na.IsSuccess){K(this.$,na.Token);var Fa=Ga.a.create().toString();ob.push(Object(l.a)(new z.a,{name:"CorrelationId",string:Fa}));makerstorage.getRecentScripts(Fa).then(Ab=>{ob.push(Object(l.a)(new z.a,{name:"HasReadCachedScripts",bool:this.uka}));this.Sh.clear();for(const $b of Ab)this.Sh.Nh(new fa($b));
this.EW=this.KQa=!0;this.indexedDB.se()&&(Ab=wb.a.hc(this.Sh.sX()),this.indexedDB.Gna(new cb.a(y.a.rO,Ab)));ob.push(Object(l.a)(new z.a,{name:"ScriptCount",int64:this.Sh.length}));A.a(t.a.Ica,!0,r.getElapsedMilliseconds(dc,v.a.Qa.zb),ob);jb.Np(y.a.rO)}).catch(Ab=>{Object.getType(Ab)===makerstorage.StorageServiceError?(ob.push(Object(l.a)(new z.a,{name:"Error",string:Ab.message})),ob.push(Object(l.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${Ab.errorCode.toString()}_${Ab.status.toString()}`})),
17===Ab.errorCode&&Ib.vJb(y.a.NKa(this.$))):(ob.push(Object(l.a)(new z.a,{name:"Error",string:Ab.toString()})),ob.push(Object(l.a)(new z.a,{name:"ErrorCode",string:"exception"})));A.a(t.a.vxf,!1,r.getElapsedMilliseconds(dc,v.a.Qa.zb),ob);this.EW=!0;jb.Np(y.a.rO)})}else Fa=na?na.ErrorCode:"need_token",na=na?na.ErrorMessage:"No Access Token",ob.push(Object(l.a)(new z.a,{name:"ServiceChecked",bool:!1})),ob.push(Object(l.a)(new z.a,{name:"Error",string:na})),ob.push(Object(l.a)(new z.a,{name:"ErrorCode",
string:Fa})),A.a(t.a.Ica,!1,r.getElapsedMilliseconds(dc,v.a.Qa.zb),ob),this.EW=!0,jb.Np(y.a.rO)}gJd(na,jb){const Ib=new Pa.a,dc=ha(this.$);ya(this.$,ob=>{if((ob=ob.Result)&&200===ob.ResponseStatusCode)ob=ob.ResponseBody.join(""),ob=JSON.parse(ob),na(this.mFd(ob.value)),Ib.setResult(!0);else{ob=ob?"RichApi_"+ob.ResponseStatusCode:"RichApiError";const Fa=[];Fa.push(Object(l.a)(new z.a,{name:"Error",string:"Failed to read shared script ids from document"}));Fa.push(Object(l.a)(new z.a,{name:"ErrorCode",
string:ob}));this.Ks=!0;this.fU(jb,v.a.Qa.zb,0,Fa);Ib.setResult(!1)}},ob=>{ob=Ya.a.Pe(ob.data);c.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");const Fa=[];Fa.push(Object(l.a)(new z.a,{name:"Error",string:"Failure using rich api: "+ob}));Fa.push(Object(l.a)(new z.a,{name:"ErrorCode",string:"RichApiFailure"}));this.Ks=!0;this.fU(jb,v.a.Qa.zb,0,Fa);Ib.setResult(!1)},dc,Ib)}hid(na,jb,Ib){const dc=v.a.Qa.zb;let ob=0,Fa=0;this.Ks=ob===na.count;const Ab=
[];Ab.push(Object(l.a)(new z.a,{name:"ScriptIds",int64:na.count}));if(na.count)if(jb&&jb.IsSuccess){K(this.$,jb.Token);for(var $b of na){const Cb=Ga.a.create().toString();makerstorage.getSharedScript($b.value,Cb).then(Rb=>{const uc=[];uc.push(Object(l.a)(new z.a,{name:"BodySize",int64:Rb.body.length}));uc.push(Object(l.a)(new z.a,{name:"CorrelationId",string:Cb}));A.a(t.a.Rnc,!0,r.getElapsedMilliseconds(dc,v.a.Qa.zb),uc);ob++;Rb=new fa(Rb);Rb.shareId=na.na(Rb.id);this.Od.Nh(Rb);this.Ks=ob===na.count;
this.LQa=!0;this.fU(Ib,dc,Fa,Ab)}).catch(Rb=>{const uc=[];Object.getType(Rb)===makerstorage.StorageServiceError?(Ab.push(Object(l.a)(new z.a,{name:"Error",string:Rb.message})),Ab.push(Object(l.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${Rb.errorCode.toString()}_${Rb.status.toString()}`}))):(uc.push(Object(l.a)(new z.a,{name:"Error",string:Rb.toString()})),uc.push(Object(l.a)(new z.a,{name:"ErrorCode",string:"exception"})));uc.push(Object(l.a)(new z.a,{name:"CorrelationId",string:Cb}));A.a(t.a.Rnc,
!1,r.getElapsedMilliseconds(dc,v.a.Qa.zb),uc);ob++;Fa++;this.Ks=ob===na.count;this.fU(Ib,dc,Fa,Ab)}).finally(()=>{if(X.EwaSettings.getBooleanFeatureGate(y.a.mZc,!1)&&this.indexedDB.se()&&this.Ks){const Rb=tb.bid(this.$,this.Od);this.indexedDB.Gna(new cb.a(y.a.qpa,Rb))}})}}else $b=jb?jb.ErrorCode:"need_token",jb=jb?jb.ErrorMessage:"No Access Token",Ab.push(Object(l.a)(new z.a,{name:"Error",string:jb})),Ab.push(Object(l.a)(new z.a,{name:"ErrorCode",string:$b})),this.Ks=!0,this.fU(Ib,dc,Fa,Ab);else this.Ks=
this.LQa=!0,this.fU(Ib,dc,Fa,Ab),X.EwaSettings.getBooleanFeatureGate(y.a.mZc,!1)&&f.TaskExtensions.TJ(tb.IIb(this.$,this.indexedDB),Cb=>{Cb.result&&(this.indexedDB.n7b(y.a.qpa),this.Od.clear(),Ib.Np("CachedScripts"))},this.$.la,3)}Thd(na){const jb={id:"samples-6"};jb.name=I.a.instance.ga(2140);this.Uk.Nh(new fa(jb));jb.id="samples-8";jb.name=I.a.instance.ga(2141);this.Uk.Nh(new fa(jb));jb.id="samples-2";jb.name=I.a.instance.ga(2137);this.Uk.Nh(new fa(jb));jb.id="samples-4";jb.name=I.a.instance.ga(2138);
this.Uk.Nh(new fa(jb));jb.id="samples-5";jb.name=I.a.instance.ga(2139);this.Uk.Nh(new fa(jb));jb.id="samples-9";jb.name=I.a.instance.ga(2142);this.Uk.Nh(new fa(jb));this.o7=!0;na.Np("SampleScripts")}Nid(){const na={};na.id=y.a.LOb;na.name=I.a.instance.ga(2143);this.e8.Nh(new fa(na));na.id=y.a.MOb;na.name=I.a.instance.ga(2144);this.e8.Nh(new fa(na))}mFd(na){const jb=new V.a;if(na=this.vua.parseFromString(na,"text/xml").querySelector('[id="script-ids-node-id"]')){na=na.getElementsByTagName("scriptId");
for(let Ib=0;Ib<na.length;Ib++){const dc=na[Ib].getAttribute("id");if(dc){let ob,Fa;({eOb:ob,shareId:Fa}=tb.zid(dc)).returnValue&&jb.ia(ob,Fa)}}}return jb}kJd(na){const jb=v.a.Qa.zb,Ib=[];f.TaskExtensions.TJ(tb.IIb(this.$,this.indexedDB),dc=>{dc=dc.result;Ib.push(Object(l.a)(new z.a,{name:"ExistingScriptCount",int64:this.Od.length}));if(dc){Ib.push(Object(l.a)(new z.a,{name:"CachedScriptCount",int64:dc.length}));const ob=!this.Ks||0===this.Od.length;if(ob){for(const Fa of dc.getScripts())this.Od.Nh(Fa);
this.Od.sort();A.a(t.a.v$a,ob,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);this.XQa(na);return!0}A.a(t.a.v$a,ob,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib)}else A.a(t.a.v$a,!1,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);return!1},this.$.la,3)}fJd(na){const jb=v.a.Qa.zb,Ib=[];f.TaskExtensions.TJ(this.indexedDB.Sja(y.a.xW),dc=>{const ob=!this.DW||!this.ug.length;dc=dc.result;Ib.push(Object(l.a)(new z.a,{name:"ExistingScriptCount",int64:this.ug.length}));if(""!==dc&&(dc=Ka.b(dc),Ib.push(Object(l.a)(new z.a,
{name:"CachedScriptCount",int64:dc.length})),ob)){for(const Fa of dc)this.ug.Nh(new fa(Fa));this.ug.sort();A.a(t.a.Pnc,ob,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);this.XQa(na);return!0}A.a(t.a.Pnc,ob,r.getElapsedMilliseconds(jb,v.a.Qa.zb),Ib);return!1},this.$.la,3)}fU(na,jb,Ib,dc){this.Ks&&(dc.push(Object(l.a)(new z.a,{name:"ScriptCount",int64:this.Od.length})),dc.push(Object(l.a)(new z.a,{name:"ScriptErrorCount",int64:Ib})),A.a(t.a.wxf,!Ib,r.getElapsedMilliseconds(jb,v.a.Qa.zb),dc),this.Od.sort(),
na.Np(y.a.qpa))}XQa(na){this.W4=!0;na.Np("CachedScripts")}}Object(u.a)(za,"AutomateCommandStorage",tb,[]);var yb=a(695);class jc extends b.a{constructor(na){super();this.$=na;this.Fb()}create(){const na=xa.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Ya),jb=H.a.loadScript(133,4,this.Ya,void 0,void 0,351),Ib=xa.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.Ya),dc=xa.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.Ya),ob=xa.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Ed([na,
jb,Ib,dc,ob],this.la,3),()=>{const Fa=na.result,Ab=dc.result;var $b=ob.result;const Cb=new wa,Rb=new x(this.$,Fa,Cb),uc=new za(this.$,Ab),nb=new aa(this.$,uc),Fb=new va(this.$,Rb,Cb,$b);$b=Object(yb.a)(this.$.da,352,()=>new Wa(this.$,Fa,Ib.result,Ab,Fb,Cb,Rb,uc,nb));this.ob($b)},this.la,3)}static ka(na){na&&na.da.Ga(351,new jc(na))}}Object(u.a)(jc,"AutomateCommandManagerFactory",b.a,[]);var Cc=a(9);a.d(E,"a",function(){return Sa});const Sa=()=>{Cc.a.Fa(na=>{m.ka(na);jc.ka(na)})}},1187:function(u,
E,a){u=a(0);var c=a(15),b=a(84),e;(function(O){O[O.generalException=0]="generalException";O[O.invalidArgument=1]="invalidArgument";O[O.notAllowed=2]="notAllowed";O[O.apiNotAvailable=3]="apiNotAvailable";O[O.unresolvedPendingRequest=4]="unresolvedPendingRequest";O[O.timeout=5]="timeout";O[O.adalTimeout=6]="adalTimeout";O[O.userNotSignedIn=7]="userNotSignedIn";O[O.userAborted=8]="userAborted";O[O.silentSignInFailed=9]="silentSignInFailed";O[O.invalidResourceUrl=10]="invalidResourceUrl";O[O.invalidGrant=
11]="invalidGrant";O[O.connectionLost=12]="connectionLost";O[O.clientError=13]="clientError";O[O.serverError=14]="serverError"})(e||(e={}));Object(u.b)("ErrorCodes",e);a(1302);class f{constructor(O,G){this.requestCallback=this.requestParameters=null;this.requestParameters=O;this.requestCallback=G}}Object(u.a)(f,"OutstandingRequest",null,[]);class d{}d.DHi="AADSTS50058";d.invalidResourceUrl="AADSTS50001";d.yHi="AADSTS65001";d.NHi="AADSTS70011";d.userAborted="13002";d.T2i="Popup Window is null";d.S2i=
"Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.kPj="tokenRevoked";Object(u.a)(d,"WopiHostErrorType",null,[]);var h=a(4),m=a(729),l=a(570),w=a(41),n=a(1301);class y{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(u.a)(y,"WopiIdentityInfo",null,[790]);class t{constructor(O,G,C){this.expiration=this.authority=this.accessToken=null;this.accessToken=O;this.authority=G;this.expiration=C}}Object(u.a)(t,
"WopiIdentityToken",null,[791]);var r=a(27),v=a(147),B=a(373),A=a(164),z=a(72),x=a(344);class D{constructor(O){this._initialized=!1;this.Dab={};this.yAc={};this.QO=h.AFrameworkApplication.sa.iE;this.Tld=O}U2a(O){this._initialized||(O.so(A.a.TLf),O.dm(A.a.TLf,Object(b.a)(this,this.sUi,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(O,G,C=null){this.COa(O,G);return new Promise((H,I)=>{if(this.uod(G))if(G in this.Dab)I("unresolvedPendingRequest");else{var M=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,
344,10,w.c({["error"]:"Request timeout.",["callerId"]:G}));I("timeout")},12E4);this.ged(O,G,C,(Q,U)=>{window.clearTimeout(M);Q?H(Q):(c.ULS.sendTraceTag(37856033,369,15,w.c({["error"]:e[U]})),I(U))})}else c.ULS.sendTraceTag(37856034,344,10,w.c({["error"]:"Caller is not allowed."})),I("notAllowed")})}getPrimaryIdentityInfo(O){return new Promise((G,C)=>{this.uod(O)?this.OYh((H,I)=>{H?G(H):(c.ULS.sendTraceTag(37856064,369,10,w.c({["error"]:I.toString()})),C(I))}):(c.ULS.sendTraceTag(37856065,344,10,w.c({["error"]:"Caller is not allowed."})),
C("notAllowed"))})}getAuthContext(O){return new Promise((G,C)=>{const H=this.getAuthContextSync(O);H?G(H):C("notAllowed")})}getAuthContextSync(O){if(this.uod(O)){const G=new n.a;G.upn=h.AFrameworkApplication.fa.Xa("UserPrincipalName");G.userId=h.AFrameworkApplication.fa.Xa("LoggableUserId");G.authority=h.AFrameworkApplication.fa.Xa("HostAuthAuthority");G.tenantId=h.AFrameworkApplication.fa.Xa("TenantId");G.isAnonymous=h.AFrameworkApplication.fa.qa("IsAnonymousUser");G.supportsAuthToken=this.sai(O);
O=h.AFrameworkApplication.fa.Xa("HostAuthType");G.authorityType="aad"===O.toLowerCase()?2:"msa"===O.toLowerCase()?1:0;return G}c.ULS.sendTraceTag(40751647,344,10,w.c({["error"]:"Caller is not allowed."}));return null}sai(O){const G=m.a.Uyb;return r.a.Rxa?G&&m.a.Pbg?Array.contains(m.a.Pbg,O.toLowerCase()):!1:G}ged(O,G,C,H){var I=[];Array.add(I,Object.assign(new z.a,{name:"CallerId",string:G}));Array.add(I,Object.assign(new z.a,{name:B.a.WVd,string:O.correlationId}));v.a.sendTelemetryEvent(Object.assign(new x.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:I}));I=l.a.create().toString();const M="getAccessToken_"+I,Q=this.QO.Ac("ComponentAttach",M);this.yAc[M]=Q;const U={};U[B.a.XVd]=I;U[B.a.HIj]=O.resource;U[B.a.IIj]=O.scope;U[B.a.P9f]=h.AFrameworkApplication.fa.Xa("HostAuthType");U[B.a.LIj]=h.AFrameworkApplication.fa.Xa("UserPrincipalName");U[B.a.JIj]=O.silentLogin;U[B.a.EIj]=O.options;U[B.a.WVd]=O.correlationId;U[B.a.FIj]=G;C&&(U[B.a.addinName]=C.AddinName,U[B.a.DIj]=
C.AddinTrustId);this.Tld.execute(N=>{this.U2a(N);N.Pj(A.a.getAuthToken,U)});this.Dab[I]=new f(O,H)}OYh(O){const G=h.AFrameworkApplication.fa.Xa("UserName"),C=h.AFrameworkApplication.fa.Xa("UserPrincipalName"),H=h.AFrameworkApplication.fa.Xa("LoggableUserIdSpace"),I=new y;I.email=C;I.displayName=G;switch(H){case "OrgIdPuid":I.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":I.authority="MicrosoftAccount";break;default:I.authority=H}O(I,null)}sUi(O){let G=null;try{let H=O.Values[B.a.XVd];
const I=O.Values[B.a.CIj],M=O.Values[B.a.P9f],Q=O.Values[B.a.KIj];let U=null,N=null;const W=this.Dab[H];if("undefined"!==typeof W&&W){var C=[];Array.add(C,Object.assign(new z.a,{name:B.a.WVd,string:W.requestParameters.correlationId}));v.a.sendTelemetryEvent(Object.assign(new x.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:C}));G=W.requestCallback;delete this.Dab[H];"undefined"!==typeof I&&I&&I.length?N=new t(I,M,Q):U=e[this.KCi(O)];C="getAccessToken_"+H;C in
this.yAc&&(this.yAc[C].stop(),delete this.yAc[C]);G(N,U)}else c.ULS.sendTraceTag(37856066,344,10,w.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:H}))}catch(H){O=O.Values[B.a.XVd],O in this.Dab&&delete this.Dab[O],this.xlc(),c.ULS.sendTraceTag(37856067,344,10,w.c({["error"]:H.message,["stack"]:H.stack})),G&&G(null,"generalException")}}uod(O){var G=h.AFrameworkApplication.G4h();O=O.toLowerCase();for(const C of G)if(O===C.toLowerCase())return!0;G=m.a.UXc;for(let C in G)if(O===
G[C].toLowerCase())return!0;return!1}KCi(O){O=O.Values[B.a.GIj];this.xlc();c.ULS.sendTraceTag(39068821,344,15,w.c({["error"]:O}));return O?-1<O.indexOf(d.DHi)?9:-1<O.indexOf(d.T2i)||-1<O.indexOf(d.S2i)?12:-1<O.indexOf(d.invalidResourceUrl)?10:-1<O.indexOf(d.userAborted)?8:-1<O.indexOf(d.NHi)||-1<O.indexOf(d.yHi)||O===d.kPj?11:-1<O.indexOf(d.adalTimeout)?6:0:13}COa(O,G){O=this.naj(O.resource);c.ULS.sendTraceTag(39921882,344,50,w.c({["callerId"]:G,["resource"]:O}))}xlc(){c.ULS.sendTraceTag(39068822,
344,50,w.c({["userAgent"]:window.navigator.userAgent}))}naj(O){return(O?O:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(u.a)(D,"WopiIdentityManager",null,[777]);var J=a(248);class L{constructor(){this.gb=null}get name(){return"Common.App.WopiIdentity"}Wh(O){this.gb=O;O.register(D,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").xc().Fc(()=>new D(O.Ub("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&
h.AFrameworkApplication.fa.Dv(Object(b.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){try{this.gb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(O){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+O)}}dispose(){}static main(){J.a.instance.Fi(new L)}}Object(u.a)(L,"WopiIdentityPackage",null,[4,5]);a.d(E,"a",function(){return T});const T=()=>{Type.registerNamespace("Common.App.WopiIdentity");L.main()}},1192:function(u,E,a){a.r(E);u=a(0);var c=
a(7),b=a(15),e=a(4),f=a(157),d=a(187),h=a(83),m=a(188),l=a(60),w=a(50),n=a(37),y=a(227),t=a(116),r=a(527);class v{constructor(ra){ra=ra.split("|");this.yx=ra[1];this.RSc=ra[2];this.RWd=ra[3]}get solutionId(){return this.yx}get solutionVersion(){return this.RSc}get needToRestoreManifest(){return this.RWd===OSF.StoreTypeEnum.Registry.toString()}}Object(u.a)(v,"AddinStoreInfo",null,[]);class B{}Object(u.a)(B,"CustomFunctionRegistrationInfos",null,[]);var A=a(196),z=a(66);const x=(ra,pa,ba)=>D(ra,pa,
A.a.none,z.a.current,ba),D=(ra,pa,ba,fa,Ka)=>{ba=ra.continueWith(()=>{pa(ra)},3,ba,fa);ba.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,Ka)},4);return ba},J=(ra,pa,ba)=>L(ra,pa,A.a.none,z.a.current,ba),L=(ra,pa,ba,fa,Ka)=>{ba=ra.jp(()=>pa(ra),3,ba,fa);ba.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,Ka)},4);return n.TaskExtensions.PCc(ba)},T=(ra,pa,ba)=>O(ra,pa,A.a.none,z.a.current,ba),O=(ra,pa,ba,fa,Ka)=>{ba=ra.jp(()=>pa(ra),3,ba,fa);ba.continueWith(()=>{b.ULS.sendTraceTag(537163461,
0,10,Ka)},4);return ba},G=(ra,pa,ba)=>C(ra,pa,A.a.none,z.a.current,ba),C=(ra,pa,ba,fa,Ka)=>{ba=ra.jp(()=>pa(ra),3,ba,fa);ba.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,Ka)},4);return n.TaskExtensions.PCc(ba)},H=(ra,pa,ba)=>I(ra,pa,A.a.none,z.a.current,ba),I=(ra,pa,ba,fa,Ka)=>{ba=ra.continueWith(()=>{pa(ra)},3,ba,fa);ba.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,Ka)},4);return ba},M=(ra,pa)=>{T(a(1192).CustomFunctionsInstaller.q3e("CustomFunctionsRuntimeLogging"),ba=>{if(ba.result&&
window.console)switch(ba=Q(ra.severity)+" "+ra.message+pa,ra.severity){case 2:window.console.log&&window.console.log(ba);break;case 0:window.console.info&&window.console.info(ba);break;case 1:window.console.error&&window.console.error(ba)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},Q=ra=>{switch(ra){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var U=a(960);class N{}Object(u.a)(N,"InstallationInfo",
null,[]);class W{}Object(u.a)(W,"UninstallationInfo",null,[]);var X=a(28),sa=a(91),da=a(35),S=a(29),oa=a(1),K=a(22),ea=a(281),ya=a(750),ha=a(55);class La{constructor(ra,pa){this.nSc=ra;this._message=pa}get severity(){return this.nSc}get message(){return this._message}}Object(u.a)(La,"CustomFunctionLog",null,[]);a.d(E,"CustomFunctionsInstaller",function(){return Ia});class Ia{constructor(ra,pa,ba){this.r_=!1;this.KF={};this.$=ra;this.wj=pa;this.Rnd().Fna();this.indexedDB=ba;this.indexedDB.se()&&(this.r_=
!0,this.indexedDB.initialize(Ia.ozb,Ia.pzb))}get vV(){return this.wj.vV}qef(ra,pa,ba,fa){if(fa.invariantNamespace)for(let Ka=0;Ka<fa.invariantNamespace.length;++Ka){const aa=fa.invariantNamespace.charAt(Ka);if("."!==aa&&"_"!==aa&&"a">aa&&"z"<aa&&"A">aa&&"Z"<aa&&"0">aa&&"9"<aa)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${aa}', Position=${Ka}.`),Error.create("InvariantNamespace validation failed");}return J(this.sYg(ba,
fa.manifest),()=>J(this.cJd(ra),Ka=>{let aa=Ka.result;return(null===aa||void 0===aa?0:aa.isDynamicMetadata)?this.gKd(ra,pa,aa,!1,!1,!1):J(this.s2j(ra,pa,fa),ja=>{let Va;aa=(Va=new N,Va.addinId=ba,Va.locale=fa.locale,Va.addinInvariantNamespace=fa.invariantNamespace,Va.addinNamespace=fa.namespace,Va.addinTitle=fa.title,Va.isXllCompatible=fa.isXllCompatible,Va.metadataContent=JSON.stringify(JSON.parse(ja.result)),Va);return this.gKd(ra,pa,aa,!1,Ia.TCh(fa.osfControl.getStoreType()),U.a(this.$,fa))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},
"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}tef(ra,pa,ba,fa){if(!Ia.ntd(ba))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return J(this.cJd(ra),Ka=>{Ka=Ka.result;if(!Ka&&(Ka=da.a.Dc(this.vV,ra),!Ka))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,
pa,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");Ka.metadataContent=JSON.stringify(JSON.parse(ba));Ka.isDynamicMetadata=!0;return this.gKd(ra,pa,Ka,!0,!0,fa)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Cfg(ra,pa){this.wj.Tia();const ba=Object(c.a)(new W,{solutionId:ra}),fa=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,
pa,null)}.`;return J(this.SKd(ra),()=>J(this.YKd(ra),()=>this.G_d(this.wj,ra,pa,ba),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),fa)}s2j(ra,pa,ba){const fa=new f.a;OSF.OUtil.xhrGet(ba.metadataUrl,Ka=>{Ka?fa.setResult(Ka):fa.setException(Error.create("Invalid manifest"))},Ka=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,
pa,null)}. ErrorCode: ${Ka}.`);oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7223300_HandleFaultedTaskXhrGetMetadataAsync")?fa.Qs():fa.setException(Error.create("Failed to download manifest"))});return fa.task}Rnd(){return J(this.$sc(),ra=>{const pa=ra.result;if(!pa.length)return ha.Task.Ta(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");ra=new d.a;const ba=[];for(let fa=0;fa<pa.length;fa++){const Ka=Object(h.a)(String,
pa[fa]);ra.add(T(this.cJd(Ka),aa=>{if(aa=aa.result){const ja=da.a.Dc(this.KF,aa.addinId);ja&&ja===aa.metadataContent||(this.KF[aa.addinId]=aa.metadataContent,this.vV[Ka]=aa,ba.push(aa))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return G(ha.Task.WhenAllEnumerable(ra),()=>{if(ba.length){let fa;const Ka=(fa=new B,fa.registrationInfos=ba,fa);return this.H1b(this.wj,pa,Ka)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");
return ha.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}uef(){var ra=new f.a;new d.a;const pa=[],ba=[];Object.keys(this.vV).forEach(fa=>{fa=Object(h.a)(String,fa);const Ka=da.a.Dc(this.vV,fa);pa.push(Ka);ba.push(fa)});if(!ba.length)return ra.setResult(!0),ra.task;ra=Object(c.a)(new B,{registrationInfos:pa});return this.H1b(this.wj,ba,ra)}$sc(){return T(this.Mgd(r.a.MZa),ra=>{ra=
ra.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(ra||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(ra||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Clg(ra){return this.rRd(r.a.MZa,Sys.Serialization.JavaScriptSerializer.serialize(ra))}cJd(ra){return J(this.Mgd(r.a.Z4a(ra)),pa=>{pa=pa.result||"";return 0<pa.length?ha.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(pa,!0)):
ha.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}k2j(ra,pa){return J(this.aPe(ra),()=>J(this.rRd(r.a.Z4a(ra),Sys.Serialization.JavaScriptSerializer.serialize(pa)),()=>Ia.sRd(r.a.Kkd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}SKd(ra){return J(this.YSf(ra),
()=>J(this.pTf(r.a.Z4a(ra)),()=>J(this.$sc(),pa=>pa.result.length?ha.Task.Ta(!0):Ia.sRd(r.a.Kkd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}rQf(ra){return this.Mgd(r.a.Y4a(ra))}zlg(ra,pa){return J(this.aPe(ra),
()=>this.rRd(r.a.Y4a(ra),pa),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}YKd(ra){return J(this.YSf(ra),()=>this.pTf(r.a.Y4a(ra)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}aPe(ra){return J(this.$sc(),pa=>{pa=pa.result;const ba=ra.toLowerCase();if(pa.includes(ba))return ha.Task.Ta(!0);pa.push(ba);return this.Clg(pa)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}YSf(ra){return J(this.$sc(),
pa=>{pa=pa.result;const ba=ra.toLowerCase();return pa.includes(ba)?(pa.splice(Array.indexOf(pa,ba),1),this.Clg(pa)):ha.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}sYg(ra,pa){if(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return ra=new OSF.AddinIdInfo(ra),ra.needToRestoreManifest()?this.zlg(ra.getSolutionId(),pa):ha.Task.Ta(!0);ra=new v(ra);return ra.needToRestoreManifest?this.zlg(ra.solutionId,
pa):ha.Task.Ta(!0)}Hlj(ra){if(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const ba=new OSF.AddinIdInfo(ra);return ba.needToRestoreManifest()?T(this.rQf(ba.getSolutionId()),fa=>{(fa=fa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(ba.getSolutionId(),ba.getSolutionVersion(),fa,this.$.va.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ha.Task.Ta(!0)}const pa=new v(ra);return pa.needToRestoreManifest?
T(this.rQf(pa.solutionId),ba=>{(ba=ba.result)&&OSF.OsfManifestManager.cacheManifestFromXml(pa.solutionId,pa.solutionVersion,ba,this.$.va.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ha.Task.Ta(!0)}pTf(ra){return this.r_?this.indexedDB.n7b(ra):Ia.Wdj(ra)}rRd(ra,pa){return this.r_?this.indexedDB.Gna(new ya.a(ra,pa)):Ia.sRd(ra,pa)}Mgd(ra){return this.r_?this.indexedDB.Sja(ra):Ia.q3e(ra)}gKd(ra,pa,ba,fa,Ka,aa){const ja=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,
pa,null)}.`;return n.TaskExtensions.PCc(T(this.hKd(this.wj,ra,pa,ba,!1,fa,aa),()=>Ka?this.k2j(ra,ba):ha.Task.Ta(!0),ja))}hKd(ra,pa,ba,fa,Ka,aa,ja){if(!aa&&(aa=da.a.Dc(this.KF,fa.addinId))&&aa===fa.metadataContent)return ha.Task.Ta(!0);this.KF[fa.addinId]=fa.metadataContent;this.vV[pa]=fa;ja||ra.sJb(pa);ra.Tia();return J(this.sbj(pa,ba,fa),()=>this.LHd(fa.addinId,Ka),"Failed to register functions for customfunction addin")}sbj(ra,pa,ba){const fa=new f.a,Ka=this.xHa(ba);return this.p4(aa=>{oa.EwaSettings.ma(254)&&
M(Ia.dtb,ra);(aa=aa.Result)&&204===aa.ResponseStatusCode?fa.setResult(!0):(delete this.KF[ba.addinId],delete this.vV[ra],x(this.SKd(ra),()=>{x(this.YKd(ra),()=>{this.s7f()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${ra}. Received status code ${aa?aa.ResponseStatusCode.toString():"Unknown"}.`),fa.setResult(!1))},aa=>{aa=t.a.Pe(aa.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,
pa,null)}. Errors: ${S.a.sc(aa)}.`);oa.EwaSettings.ma(254)&&M(Ia.ctb,ra);delete this.KF[ba.addinId];delete this.vV[ra];fa.setResult(!1)},Ka,fa,!0)}H1b(ra,pa,ba){const fa=new f.a,Ka=X.a.Qa.ve.m;pa.forEach(ja=>{ja=Object(h.a)(String,ja);ra.hBe(ja)});ra.Tia();const aa=this.o_c(ba);return this.p4(ja=>{oa.EwaSettings.ma(254)&&M(Ia.dtb,Sys.Serialization.JavaScriptSerializer.serialize(pa));ja=ja.Result;let Va=!0;var bb=Sys.Serialization.JavaScriptSerializer.deserialize(ja.ResponseBody.toString());bb=Array.isArray(bb.value)?
bb.value:null;const wa=new d.a;for(let ka=0;ka<bb.length;ka++)if(!bb[ka]){Va=!1;const ta=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${ja.ResponseStatusCode}.`;wa.add(J(this.SKd(pa[ka]),()=>{delete this.KF[ba.registrationInfos[ka].addinId];delete this.vV[pa[ka]];return this.YKd(pa[ka])},ta))}H(ha.Task.WhenAllEnumerable(wa),()=>{x(this.LHd("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${X.a.Qa.ve.m-
Ka} Millisecond.`);Va?fa.setResult(Va):H(this.s7f(),()=>{fa.setResult(Va)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},ja=>{ja=t.a.Pe(ja.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${S.a.sc(ja)}.`);
oa.EwaSettings.ma(254)&&M(Ia.ctb,Sys.Serialization.JavaScriptSerializer.serialize(pa));for(ja=0;ja<ba.registrationInfos.length;ja++)delete this.KF[ba.registrationInfos[ja].addinId],delete this.vV[pa[ja]];fa.setResult(!1)},aa,fa,!0)}G_d(ra,pa,ba,fa){return J(this.MTj(ra,pa,ba,fa),()=>this.LHd(fa.solutionId,!1),"Failed to unregister functions for customfunction addin")}MTj(ra,pa,ba,fa){const Ka=new f.a;ra.sJb(pa);(ra=da.a.Dc(this.vV,pa))&&delete this.KF[ra.addinId];delete this.vV[pa];fa=this.A_c(fa);
return this.p4(()=>{oa.EwaSettings.ma(254)&&M(Ia.D6c,pa);Ka.setResult(!0)},aa=>{aa=t.a.Pe(aa.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(pa,ba,null)}. Errors: ${S.a.sc(aa)}.`);oa.EwaSettings.ma(254)&&M(Ia.C6c,pa);Ka.setResult(!1)},fa,Ka,!1)}p4(ra,pa,ba,fa,Ka){const aa=this.$.userOperationManager,ja=this.$.pa;let Va=null,bb=null,wa=null;const ka=
()=>{if(aa.xta()||0<ja.ya.TU||0<ja.Nk.TU)return!1;Va&&aa.ko(Va);bb&&ja.Lr(bb);wa&&ja.hx(wa);const ta=ba.request;let qa=0;oa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?ta.RequestFlags&1&&256!==(ta.RequestFlags&256)||(qa=16):qa=ta.RequestFlags&1?0:16;aa.kD(new m.a(507,0,(rb,Za,gb)=>{oa.EwaSettings.ma(254)&&M(Ka?Ia.B6c:Ia.E6c,ta.RequestBody);return l.g(ja.ya,"ExecuteRichApiRequest",ba,ea.b(rb,ra),ea.a(Za,pa),gb,null,0)},qa|64));return!0};ka()||(Va=()=>{ka()},
bb=()=>{ka()},wa=()=>{ka()},aa.ur(Va),ja.Mq(bb),ja.iw(wa));return fa.task}xHa(ra){const pa={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};pa.RequestBody=JSON.stringify(ra);pa.RequestFlags=1;oa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(pa.RequestFlags|=256);ra=this.$.pa.ya.Na(1);ra.request=pa;return ra}o_c(ra){const pa={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};pa.RequestBody=JSON.stringify(ra);
pa.RequestFlags=1;oa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(pa.RequestFlags|=256);ra=this.$.pa.ya.Na(1);ra.request=pa;return ra}A_c(ra){const pa={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};pa.RequestBody=JSON.stringify(ra);pa.RequestFlags=1;oa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(pa.RequestFlags|=256);ra=this.$.pa.ya.Na(1);ra.request=pa;return ra}LHd(ra,pa){const ba=
w.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return L(ba,()=>{ba.result.cNd();return ra&&pa?this.Hlj(ra):ha.Task.Ta(!0)},this.$.la,y.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}s7f(){const ra=new sa.a(1949669462,0,this.$.Hc,0,null);return this.$.Ja.Kb(ra)}static q3e(ra){try{return ha.Task.Ta(localStorage.getItem(ra))}catch(pa){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${pa.message||
"Unknown"}`),ha.Task.Ta(null)}}static sRd(ra,pa){try{return localStorage.setItem(ra,pa),ha.Task.Ta(!0)}catch(ba){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${ba.message||"Unknown"}`),ha.Task.Ta(!1)}}static Wdj(ra){try{return localStorage.removeItem(ra),ha.Task.Ta(!0)}catch(pa){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${pa.message||
"Unknown"}`),ha.Task.Ta(!1)}}static TCh(ra){return K.a.equals(ra,"registry",!0)||K.a.equals(ra,"uploadfiledevcatalog",!0)||e.AFrameworkApplication.userNameUnknown||e.AFrameworkApplication.limitedEdit}static ntd(ra){if(!ra)return!1;try{JSON.parse(ra)}catch(pa){return!1}return!0}}Ia.ozb="CustomFunctionCache";Ia.pzb="CustomFunction";Ia.B6c=new La(2,"CustomFunctions [Registration] [Begin] SolutionId=");Ia.dtb=new La(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Ia.ctb=new La(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Ia.E6c=new La(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Ia.D6c=new La(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Ia.C6c=new La(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(Ia,"CustomFunctionsInstaller",null,[688])},1195:function(u,E,a){a.r(E);u=a(0);var c=a(7),b=a(15),e=a(933),f=a(157),d=a(83),h=a(188),m=a(60),l=a(50),w=a(37),n=a(116),y=a(527),t=a(960);class r{constructor(Q){Q=Q.split("|");this.yx=Q[1];this.RSc=Q[2];this.RWd=
Q[3]}get solutionId(){return this.yx}get solutionVersion(){return this.RSc}get needToRestoreManifest(){return this.RWd===OSF.StoreTypeEnum.Registry.toString()}}Object(u.a)(r,"AddinStoreInfo",null,[]);class v{}Object(u.a)(v,"CustomFunctionRegistrationInfos",null,[]);const B=(Q,U)=>{if(a(1195).CustomFunctionsLegacyInstaller.Zwb("CustomFunctionsRuntimeLogging")&&window.console)switch(U=A(Q.severity)+" "+Q.message+U,Q.severity){case 2:window.console.log&&window.console.log(U);break;case 0:window.console.info&&
window.console.info(U);break;case 1:window.console.error&&window.console.error(U)}},A=Q=>{switch(Q){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class z{}Object(u.a)(z,"InstallationInfo",null,[]);class x{}Object(u.a)(x,"UninstallationInfo",null,[]);var D=a(153),J=a(35),L=a(29),T=a(1),O=a(13),G=a(281),C=a(863),H=a(55);class I{constructor(Q,U){this.nSc=Q;this._message=U}get severity(){return this.nSc}get message(){return this._message}}Object(u.a)(I,"CustomFunctionLog",
null,[]);a.d(E,"CustomFunctionsLegacyInstaller",function(){return M});class M{constructor(Q){this.KF={};this.$=Q;this.Rnd().Fna()}qef(Q,U,N,W){const X=new f.a;if(W.invariantNamespace)for(U=0;U<W.invariantNamespace.length;++U){const da=W.invariantNamespace.charAt(U);if("."!==da&&"_"!==da&&"a">da&&"z"<da&&"A">da&&"Z"<da&&"0">da&&"9"<da)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${da}', Position=${U}.`),X.setResult(!1),
X.task}M.cacheManifest(N,W.manifest);let sa=M.dJd(Q);(null===sa||void 0===sa?0:sa.isDynamicMetadata)?this.fKd(Q,sa,X,!1,!1):OSF.OUtil.xhrGet(W.metadataUrl,da=>{sa=Object(c.a)(new z,{addinId:N,locale:W.locale,addinInvariantNamespace:W.invariantNamespace,addinNamespace:W.namespace,addinTitle:W.title,isXllCompatible:W.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(da))});this.fKd(Q,sa,X,!1,t.a(this.$,W))},da=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${Q}. ErrorCode: ${da}.`);
X.setResult(!1)});return X.task}tef(Q,U,N,W){U=new f.a;if(!M.ntd(N))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),U.setResult(!1),U.task;const X=M.dJd(Q);if(!X)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),U.setResult(!1),U.task;X.metadataContent=JSON.stringify(JSON.parse(N));X.isDynamicMetadata=
!0;this.fKd(Q,X,U,!0,W);return U.task}Cfg(Q){const U=new f.a,N=l.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);w.TaskExtensions.Aa(N,()=>{const W=N.result;W.Tia();const X=Object(c.a)(new x,{solutionId:Q});M.TKd(Q);M.ZKd(Q);w.TaskExtensions.Aa(this.G_d(W,Q,X),sa=>{D.b(sa)?U.setResult(sa.result):(sa.Xf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Q}.`):sa.Ch&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${Q}.`),
U.setResult(!1))},this.$.la,0)},this.$.la,3);return U.task}Rnd(){const Q=new f.a,U=M.jJd();0<U.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const N=[];U.forEach(X=>{X=Object(d.a)(String,X);if(X=M.dJd(X)){const sa=J.a.Dc(this.KF,X.addinId);sa&&sa===X.metadataContent||(this.KF[X.addinId]=X.metadataContent,N.push(X))}});if(!N.length)return Q.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
Q.task;const W=l.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);w.TaskExtensions.Aa(W,()=>{const X=W.result,sa=Object(c.a)(new v,{registrationInfos:N});w.TaskExtensions.Aa(this.H1b(X,U,sa),da=>{D.b(da)?Q.setResult(da.result):(da.Xf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):da.Ch&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
Q.setResult(!1))},this.$.la,0)},this.$.la,3);return Q.task}Glj(Q){Q=new r(Q);if(Q.needToRestoreManifest){const U=M.X9i(Q.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(Q.solutionId,Q.solutionVersion,U,this.$.va.UICultureTag)}}fKd(Q,U,N,W,X){const sa=l.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);w.TaskExtensions.Aa(sa,()=>{w.TaskExtensions.Aa(this.hKd(sa.result,Q,U,!1,W,X),da=>{D.b(da)?((da=da.result)&&M.l2j(Q,U),N.setResult(da)):(da.Xf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${Q}.`):
da.Ch&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${Q}.`),N.setResult(!1))},this.$.la,0)},this.$.la,3)}hKd(Q,U,N,W,X,sa){if(!X&&(X=J.a.Dc(this.KF,N.addinId))&&X===N.metadataContent)return H.Task.Ta(!0);this.KF[N.addinId]=N.metadataContent;const da=new f.a;sa||Q.sJb(U);Q.Tia();Q=this.xHa(N);return this.p4(S=>{T.EwaSettings.ma(254)&&B(M.dtb,U);const oa=S.Result;204===oa.ResponseStatusCode?w.TaskExtensions.Aa(this.KHd(da,
N.addinId,W),K=>{K.Xf?U?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${U}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${N.addinId}.`):K.Ch&&(U?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${U}.`):
b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${N.addinId}.`));da.setResult(!1)},this.$.la,4):(S=()=>{delete this.KF[N.addinId];M.TKd(U);M.ZKd(U);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${U}. Received status code ${oa.ResponseStatusCode}.`);da.setResult(!1)},S=Object(c.a)(new C.a,{yMa:OSF.InfoType.Error,title:N.addinTitle,
description:String.format(O.a.instance.nb(153),O.a.instance.ga(1883)),buttonText:O.a.instance.ga(4),Hha:S,hfc:!1,Hia:S,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),e.a.dUd(S))},S=>{S=n.a.Pe(S.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${U}. Errors: ${L.a.sc(S)}.`);T.EwaSettings.ma(254)&&B(M.ctb,U);delete this.KF[N.addinId];da.setResult(!1)},Q,da,!0)}H1b(Q,U,N){const W=
new f.a;U.forEach(sa=>{sa=Object(d.a)(String,sa);Q.hBe(sa)});Q.Tia();const X=this.o_c(N);return this.p4(sa=>{T.EwaSettings.ma(254)&&B(M.dtb,Sys.Serialization.JavaScriptSerializer.serialize(U));sa=sa.Result;let da=!0;var S=Sys.Serialization.JavaScriptSerializer.deserialize(sa.ResponseBody.toString());S=Array.isArray(S.value)?S.value:null;for(let oa=0;oa<S.length;oa++)S[oa]||(da=!1,delete this.KF[N.registrationInfos[oa].addinId],M.TKd(U[oa]),M.ZKd(U[oa]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${U[oa]}. Received status code ${sa.ResponseStatusCode}.`));
w.TaskExtensions.Aa(this.KHd(W,"",!1),oa=>{oa.Xf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):oa.Ch&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");W.setResult(!1)},this.$.la,4);W.setResult(da)},sa=>{sa=n.a.Pe(sa.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(U)}. Errors: ${L.a.sc(sa)}.`);
T.EwaSettings.ma(254)&&B(M.ctb,Sys.Serialization.JavaScriptSerializer.serialize(U));for(const da of N.registrationInfos)delete this.KF[da.addinId];W.setResult(!1)},X,W,!0)}G_d(Q,U,N){const W=new f.a;Q.sJb(U);Q=this.A_c(N);return this.p4(()=>{T.EwaSettings.ma(254)&&B(M.D6c,U);w.TaskExtensions.Aa(this.KHd(W,N.solutionId,!1),X=>{X.Xf?U&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${U}.`):X.Ch&&
U&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${U}.`);W.setResult(!1)},this.$.la,4)},X=>{X=n.a.Pe(X.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${U}. Errors: ${L.a.sc(X)}.`);T.EwaSettings.ma(254)&&B(M.C6c,U);W.setResult(!1)},Q,W,!1)}p4(Q,U,N,W,X){const sa=this.$.userOperationManager,
da=this.$.pa;let S=null,oa=null,K=null;const ea=()=>{if(sa.xta()||0<da.ya.TU||0<da.Nk.TU)return!1;S&&sa.ko(S);oa&&da.Lr(oa);K&&da.hx(K);const ya=N.request;sa.kD(new h.a(507,0,(ha,La,Ia)=>{T.EwaSettings.ma(254)&&B(X?M.B6c:M.E6c,ya.RequestBody);return m.g(da.ya,"ExecuteRichApiRequest",N,G.b(ha,Q),G.a(La,U),Ia,null,0)},(ya.RequestFlags&1?0:16)|64));return!0};ea()||(S=()=>{ea()},oa=()=>{ea()},K=()=>{ea()},sa.ur(S),da.Mq(oa),da.iw(K));return W.task}xHa(Q){const U={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};U.RequestBody=JSON.stringify(Q);U.RequestFlags=1;Q=this.$.pa.ya.Na(1);Q.request=U;return Q}o_c(Q){const U={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};U.RequestBody=JSON.stringify(Q);U.RequestFlags=1;Q=this.$.pa.ya.Na(1);Q.request=U;return Q}A_c(Q){const U={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};U.RequestBody=JSON.stringify(Q);U.RequestFlags=1;Q=this.$.pa.ya.Na(1);Q.request=U;return Q}KHd(Q,U,N){const W=
l.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);w.TaskExtensions.Aa(W,()=>{W.result.cNd();U&&N&&this.Glj(U);Q.setResult(!0)},this.$.la,3);return W}uef(){return H.Task.Ta(!0)}static jJd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(M.Zwb(y.a.MZa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(M.Zwb(y.a.MZa)||"[]"):null)||[]}static Dlg(Q){M.tRd(y.a.MZa,Sys.Serialization.JavaScriptSerializer.serialize(Q))}static dJd(Q){Q=M.Zwb(y.a.Z4a(Q))||"";return 0<
Q.length?Sys.Serialization.JavaScriptSerializer.deserialize(Q,!0):null}static l2j(Q,U){M.$Oe(Q);M.tRd(y.a.Z4a(Q),Sys.Serialization.JavaScriptSerializer.serialize(U))}static TKd(Q){M.XSf(Q);M.qTf(y.a.Z4a(Q))}static X9i(Q){return M.Zwb(y.a.Y4a(Q))}static m2j(Q,U){M.$Oe(Q);M.tRd(y.a.Y4a(Q),U)}static ZKd(Q){M.XSf(Q);M.qTf(y.a.Y4a(Q))}static $Oe(Q){const U=M.jJd();Q=Q.toLowerCase();U.includes(Q)||(U.push(Q),M.Dlg(U))}static XSf(Q){const U=M.jJd();Q=Q.toLowerCase();U.includes(Q)&&(U.splice(Array.indexOf(U,
Q),1),M.Dlg(U))}static cacheManifest(Q,U){Q=new r(Q);Q.needToRestoreManifest&&M.m2j(Q.solutionId,U)}static Zwb(Q){try{return localStorage.getItem(Q)}catch(U){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${U.message||"Unknown"}`),null}}static tRd(Q,U){try{localStorage.setItem(Q,U)}catch(N){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${N.message||
"Unknown"}`)}}static qTf(Q){try{localStorage.removeItem(Q)}catch(U){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${U.message||"Unknown"}`)}}static ntd(Q){if(!Q)return!1;try{JSON.parse(Q)}catch(U){return!1}return!0}}M.B6c=new I(2,"CustomFunctions [Registration] [Begin] SolutionId=");M.dtb=new I(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");M.ctb=new I(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
M.E6c=new I(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");M.D6c=new I(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");M.C6c=new I(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(M,"CustomFunctionsLegacyInstaller",null,[688])},1235:function(u,E,a){u=a(0);var c=a(196),b=a(15);class e{}Object(u.a)(e,"AddinCommandsHost",null,[]);var f=a(1318),d=a(1395),h=a(861),m=a(60);const l=(J,L,T,O,G,C)=>{const H=J.Na(9);H.sharedInfo=L;return m.g(J,"InsertAgaveTaskpane",
H,T,O,G,C,0)},w=(J,L,T,O,G,C,H=null)=>{H=J.Na(9,H);H.sharedInfo=L;return m.g(J,"ShowAgaveTaskpane",H,T,O,G,C,0)};var n=a(371),y=a(188),t=a(37),r=a(1),v=a(281),B=a(146);class A extends B.a{constructor(J){super();this.Fe=this.RDa="AddInCommandsDialog";this.Rb=5;this.dialogWidth=695;this.dialogHeight=438;this.W6g="100%";this.T6g="408px";this.U6g="15px";this.V6g="0";this.Fyg=J}get containerDiv(){return this.Wk}Vz(){super.Vz();this.Wk.style.width=this.W6g;this.Wk.style.height=this.T6g;this.Wk.style.marginTop=
this.U6g;this.Wk.style.padding=this.V6g}VI(){super.VI();this.wb.style.width=String.format("{0}px",this.dialogWidth);this.wb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.Fyg()}}Object(u.a)(A,"AddInCommandsDialog",B.a,[]);var z=a(55),x=a(66);B=a(98);a.d(E,"a",function(){return D});class D extends e{constructor(J,L,T,O=null,G=null){super();this.$=J;this.je=L;this.ownerAddinInfo=T;this.Wd=G;this.ddb=O||z.Task.Ta(!0)}Q6g(){const J=this.ddb;this.ddb=z.Task.Ta(!0);
return J}disposeHost(J){this.je.jRa(J)}setOwnerAddinEToken(J){this.ownerAddinInfo.eToken=J}showTaskpane(J,L,T){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let O=null,G=!1,C=(new f.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,!0)).qJe(J.solutionId.substr(this.ownerAddinInfo.solutionId.length));O=L.getSharedRuntimeForTaskpane("Workbook",C);G=!!O&&1===O.LifeTime;this.je.kBe(G?this.ownerAddinInfo.solutionId:J.solutionId,G?O:null,null)||(this.Yqf(G,!0),this.ddb=
this.Pnd(J,O,(H,I)=>{H?(G&&(H.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,H.SharedRuntime=O),H.WebExtensionOsfControlType=3,this.je.HIa(H),T(H.InstanceId,I),this.Yqf(G,!1),r.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),T(null,I))}))}getSettings(J,L){let T=this.je.Jaa(J.solutionId);
T?L(this.je.FZ(T).OsfPropertyBag):this.ddb=this.Pnd(J,null,O=>{O?L(O.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(J,L,T){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const O=this.$.pa.ya,G=H=>{const I=H.Result,M=I?I.AgaveData:null;M?(this.je.kIe(M,()=>{const Q=new A(()=>{this.disposeHost(M.InstanceId)});Q.initializeAndShow("",null,null);return Q.containerDiv}),T(M.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),
T(null,H.Errors?H.Errors[0].ErrorCause:5001))},C=D.Jsb(J,this.ownerAddinInfo);this.ddb=n.a(this.$.userOperationManager,(H,I,M)=>l(O,C,v.b(H,G),I,M,null),H=>new y.a(500,0,H,64),this.Wd)}createUILessSandbox(J,L,T){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const O=L.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),G=!!O&&1===O.LifeTime;(L=this.je.wFh(G?this.ownerAddinInfo.solutionId:J.solutionId,G?O:null))?T(L,0):this.ddb=this.Pnd(J,O,(C,H)=>{C?(G?(C.PrimaryMarketplace.SolutionId=
this.ownerAddinInfo.solutionId,C.SharedRuntime=O,C.TaskpaneVisible=!1,C.WebExtensionOsfControlType=3,this.je.HIa(C)):(C.WebExtensionOsfControlType=4,this.je.kIe(C,()=>{D.dgb.ia(C.InstanceId,new d.a);return D.dgb.na(C.InstanceId).Fia})),T(C.InstanceId,H)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),T(null,H))})}Pnd(J,L,T){let O=null;const G=this.$.pa.ya,C=U=>{const N=U.Result;(O=N?N.AgaveData:null)||T(null,U.Errors?U.Errors[0].ErrorCause:5001)},H=D.Jsb(J,this.ownerAddinInfo);
L&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),H.SharedRuntimeId=L.Resid);let I=500;var M=(U,N,W)=>l(G,H,v.b(U,C),N,W,null);let Q=0;void 0===H.IsToBePersisted||null===H.IsToBePersisted||H.IsToBePersisted||(I=538,M=(U,N,W)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,
null,null,this.ownerAddinInfo.storeId));return w(G,H,v.b(U,C),N,W,null)},Q=16);Q|=64;M=n.a(this.$.userOperationManager,M,U=>new y.a(I,0,U,Q),this.Wd);return t.TaskExtensions.ts(M,()=>O?this.Gvd(G,O.InstanceId,(U,N)=>{if(U){L||(O.PrimaryMarketplace.MarketplaceType=J.storeType);r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)&&(J.assetId?J.assetId.toLowerCase().startsWith("wa")?O.AssetMarketplace={SolutionId:J.assetId,SolutionVersion:J.version,MarketplaceType:OSF.StoreType.OMEX,
MarketplaceRef:J.assetStoreId}:(O.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,50,"WACExcelAddinCommandsHost: AssetId is not a valid value")):O.AssetMarketplace=null);O.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;O.OwnerAddinStoreType=this.ownerAddinInfo.storeType;O.OsfPropertyBag=[];for(N=0;N<U.Settings.length;N++){const W=[];W[0]=U.Settings[N].Name;W[1]=U.Settings[N].Value;O.OsfPropertyBag[N]=W}T(O,0)}else T(null,N.Errors?N.Errors[0].ErrorCause:5001)}):z.Task.Ta(!1),c.a.none,3,
x.a.current)}Gvd(J,L,T){const O=G=>{T(G.Result,G)};return n.a(this.$.userOperationManager,(G,C,H)=>{G=v.b(G,O);const I=J.Na(1);I.controlId=L;return m.g(J,"DdaLoadSettings",I,G,C,H,null,0)},G=>new y.a(501,0,G,80),this.Wd)}Yqf(J,L){var T;J&&(null===(T=window.performance)||void 0===T?0:T.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${L}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(J){D.dgb.mb(J)&&
D.dgb.na(J).initializeAndShowWithTitle()}static hideUILessDialog(J){D.dgb.mb(J)&&D.dgb.na(J).hide()}static Jsb(J,L){const T={};T.SolutionId=J.solutionId;T.Version=J.version;T.StoreType=L.storeType;T.StoreId=J.storeId;T.AssetId=J.solutionId;T.AssetStoreId="omex";T.TargetType=1;T.Width=350;T.OwnerAddinSolutionId=L.solutionId;T.OwnerAddinStoreType=L.storeType;T.SharedRuntimeId=null;T.Preload=!1;return T}}D.dgb=new B.a;Object(u.a)(D,"WACExcelAddinCommandsHost",e,[])},1241:function(u,E,a){var c=a(9);u=
a(0);var b=a(692),e=a(15),f=a(102),d=a(4),h=a(1309),m=a(1),l=a(183),w=a(55);class n{constructor(B,A,z){this.gtb=null;this.$=B;A?(e.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.gtb=new h.a(B,A,z)):e.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}nc(){return!1}executeCommand(B,A,z){B=!1;switch(A.command){case 73979048:this.gtb&&
this.gtb.$3i(A,f.a.instance,d.AFrameworkApplication.fa,z),B=!0}return B?w.Task.Ta(!0):l.a(A.command)}wc(B,A){return 73979048===A.command&&m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Kc(){return!1}dispose(){this.gtb&&this.gtb.dispose()}}Object(u.a)(n,"DataFromPictureCommandHandler",null,[223,2]);var y=a(37),t=a(50);class r extends b.a{constructor(B){super(B)}ld(){const B=t.GetServiceTaskFactory.Oa(this.$.da,328,327,1),A=t.GetServiceTaskFactory.Oa(this.$.da,
484,485,1);y.TaskExtensions.Aa(y.TaskExtensions.Ed([B,A],this.$.la),()=>{this.Yc([new n(this.$,B.result,A.result)])},this.$.la,3)}static ka(B){b.a.Nd(452,new r(B))}}Object(u.a)(r,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(E,"a",function(){return v});const v=()=>{c.a.Fa(B=>{r.ka(B)})}},1301:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=
this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static LMh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(u.a)(c,"WopiAuthContext",null,[789])},1302:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{}c.VIf="OneDriveWOPI";Object(u.a)(c,"HostApplicationType",null,[])},1309:function(u,E,a){(function(c){a.d(E,"a",function(){return D});var b=a(0),e=a(15),f=a(170),d=a(83),
h=a(1315),m=a(38),l=a(249),w=a(42),n=a(371),y=a(188),t=a(60),r=a(91),v=a(13),B=a(21),A=a(41),z=a(1316),x=a(1);class D extends m.a{constructor(J,L,T){super();this.Amd=h.a.getTypeName();this.czb=this.kU=this.Wd=null;this.imageHeight=this.imageWidth=0;this.vMa=this.errorMessage=this.tableData=null;this.amd=0;this.QUc=!1;this.Lya=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6646472_DataFromPictureMigratingToNewALAPI");this.xJe=O=>{if(O){var G={};if(({At:G}=A.d(this.shh(O.data))).returnValue&&(O=Object(d.a)(Object,
G),"."===O.DataFromPictureWildcard))if(O.SessionId!==this.vMa)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),O.CmdType){case "ACK":this.QUc=!0;this.Lbg.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");
this.grj();0<this.errorMessage.length?this.G0f():0<this.tableData.length&&this.Z0f();break;case "insert_html":const H=this.$.pa.ya;G={};var C=B.h(this.$).ha.ra.$c.clone();G.PasteId=f.a.create().toString();G.DestinationRanges=w.s(w.v(C,this.$));C=O.Parameters.split("|",3);x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${C[0]}|${C[1]}|${C[2]}.`);
C=O.Parameters.indexOf("|");C=O.Parameters.indexOf("|",C+1);C=O.Parameters.indexOf("|",C+1);G.SourceHtml=O.Parameters.substring(C+1);G.CopyOperationId=null;const I=H.Na(1,H.Wb());I.pasteHtmlParameters=G;n.a(this.$.userOperationManager,(M,Q,U)=>t.g(H,"pasteHtmlContent",I,M,Q,U,null,64),M=>new y.a(204,0,M,1),null);this.amd++;e.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.amd.toString()}`)}}};this.Bcf=
(O,G)=>{if(O=G.AM)if(!G.parentPath||1>=G.parentPath.length||G.parentPath[1]!==this.vMa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");G=O.errorCode;switch(G){case null:case -1:this.errorMessage=v.a.instance.ga(2267);break;case 1:this.errorMessage=v.a.instance.ga(2268);
break;case 2:this.errorMessage=v.a.instance.ga(2269)}0<this.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${G?G.toString():"null"}.`);this.ete.stop();this.tableData=O.html;this.QUc&&(0<this.errorMessage.length?this.G0f():0<this.tableData.length&&this.Z0f())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=J;this.augmentationLoopManager=
L;this.uploaderCreator=T;this.initialize()}dispose(){window.removeEventListener("message",this.xJe,!1);this.Lya&&this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}HWi(J,L){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let T=new Image;T.onload=()=>{var O=document.createElement("canvas");O.width=T.width;O.height=T.height;const G=O.getContext("2d");try{G.drawImage(T,0,0,T.width,T.height)}catch(I){e.ULS.sendTraceTag(523805145,
0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${I.message}`);return}let C;try{C=O.toDataURL("image/jpeg")}catch(I){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${I.message}`);return}O=C.split(",");if(2>O.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{O=O[1];try{var H=window.self.atob(O)}catch(I){e.ULS.sendTraceTag(523805142,
0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${I.message}`);return}28E5<H.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),L.lEj()):(this.xnj(this.Wd,this.kU,O,T.width,T.height),URL.revokeObjectURL(T.src),T=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};T.src=J}$3i(J,L,T,O){this.Wd=J;this.kU=O;this.uploaderCreator.Wdi(this.$,
L,T,O,this)}xnj(J,L,T,O,G){this.vMa=f.a.create().toString();this.amd=0;this.czb=T;this.imageWidth=O;this.imageHeight=G;this.errorMessage=this.tableData="";this.QUc=!1;this.Lbg=this.$.Jb.Pg("LoadResource","DataFromPictureTaskpaneLaunch");this.Lbg.start();this.oZi(J,L);this.ete=this.$.Jb.Pg("LoadResource","DataFromPictureAnnotation");this.ete.start();this.WYj()}WYj(){if(this.czb.length){var J=window.self.atob(this.czb);var L=new Uint8Array(J.length);for(let T=0;T<J.length;T++)L[T]=J.charCodeAt(T);this.augmentationLoopManager.VYj(L,
this.vMa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}oZi(J,L){L.SessionID=this.vMa;L.DataFromPictureAssetId="FA000000050";L.LoadDataFromPictureTaskpane=!0;J=new r.a(-859308420,J.method,J.mode,J.$e,J.tabName);this.$.Ja.Kb(J,L)}z9c(J){try{const L=c.from(J,"utf16le").toString("base64");return z.a.xIa(this.vMa,L)}catch(L){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),
""}}shh(J){try{const L=z.a.xIa(this.vMa,J);return c.from(L,"base64").toString("utf16le")}catch(L){return e.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}grj(){if(this.czb.length){var J=l.a(this.$).Jaa("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.imageData=this.z9c(this.czb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(J,"onCustomMessage",L,T=>{T&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,
0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}Z0f(){if(this.tableData.length){var J=l.a(this.$).Jaa("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.tableHtml=this.z9c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(J,"onCustomMessage",L,T=>{T&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,
0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}G0f(){if(this.errorMessage.length){var J=l.a(this.$).Jaa("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.errorMessage=this.z9c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(J,"onCustomMessage",L,T=>{T&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,
0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.xJe,!1);this.Lya?this.augmentationLoopManager.register(this.augmentationLoopManager.lbc().Jxc("DataFromPicture").wxc(()=>{}).activateAnnotation({annotationType:this.Amd,t_:!1,dPa:this.Bcf}).build()):(this.augmentationLoopManager.activateAnnotation(this.Amd),this.augmentationLoopManager.yY(this.Amd,this.Bcf))}}Object(b.a)(D,
"DataFromPictureManager",m.a,[648])}).call(this,a(1310).lmg)},1310:function(u,E,a){(function(c){function b(){try{var G=new Uint8Array(1);G.__proto__={__proto__:Uint8Array.prototype,$3j:function(){return 42}};return"function"===typeof G.subarray&&0===G.subarray(1,1).byteLength}catch(C){return!1}}function e(G,C){if((f.mP?2147483647:1073741823)<C)throw new RangeError("Invalid typed array length");f.mP?(G=new Uint8Array(C),G.__proto__=f.prototype):(null===G&&(G=new f(C)),G.length=C);return G}function f(G,
C,H){if(!(f.mP||this instanceof f))return new f(G,C,H);if("number"===typeof G){if("string"===typeof C)throw Error("If encoding is specified then the first argument must be a string");return m(this,G)}return d(this,G,C,H)}function d(G,C,H,I){if("number"===typeof C)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&C instanceof ArrayBuffer){C.byteLength;if(0>H||C.byteLength<H)throw new RangeError("'offset' is out of bounds");if(C.byteLength<H+(I||0))throw new RangeError("'length' is out of bounds");
C=void 0===H&&void 0===I?new Uint8Array(C):void 0===I?new Uint8Array(C,H):new Uint8Array(C,H,I);f.mP?(G=C,G.__proto__=f.prototype):G=l(G,C);C=G}else if("string"===typeof C){I=G;G=H;if("string"!==typeof G||""===G)G="utf8";if(!f.$gf(G))throw new TypeError('"encoding" must be a valid string encoding');H=y(C,G)|0;I=e(I,H);C=I.write(C,G);C!==H&&(I=I.slice(0,C));C=I}else C=w(G,C);return C}function h(G){if("number"!==typeof G)throw new TypeError('"size" argument must be a number');if(0>G)throw new RangeError('"size" argument must not be negative');
}function m(G,C){h(C);G=e(G,0>C?0:n(C)|0);if(!f.mP)for(var H=0;H<C;++H)G[H]=0;return G}function l(G,C){var H=0>C.length?0:n(C.length)|0;G=e(G,H);for(var I=0;I<H;I+=1)G[I]=C[I]&255;return G}function w(G,C){if(f.isBuffer(C)){var H=n(C.length)|0;G=e(G,H);if(0===G.length)return G;C.copy(G,0,0,H);return G}if(C){if("undefined"!==typeof ArrayBuffer&&C.buffer instanceof ArrayBuffer||"length"in C)return(H="number"!==typeof C.length)||(H=C.length,H=H!==H),H?e(G,0):l(G,C);if("Buffer"===C.type&&L(C.data))return l(G,
C.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function n(G){if(G>=(f.mP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.mP?2147483647:1073741823).toString(16)+" bytes");return G|0}function y(G,C){if(f.isBuffer(G))return G.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(G)||G instanceof ArrayBuffer))return G.byteLength;
"string"!==typeof G&&(G=""+G);var H=G.length;if(0===H)return 0;for(var I=!1;;)switch(C){case "ascii":case "latin1":case "binary":return H;case "utf8":case "utf-8":case void 0:return A(G).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*H;case "hex":return H>>>1;case "base64":return x(G).length;default:if(I)return A(G).length;C=(""+C).toLowerCase();I=!0}}function t(G,C,H){var I=!1;if(void 0===C||0>C)C=0;if(C>this.length)return"";if(void 0===H||H>this.length)H=this.length;if(0>=
H)return"";H>>>=0;C>>>=0;if(H<=C)return"";for(G||(G="utf8");;)switch(G){case "hex":G=C;C=H;H=this.length;if(!G||0>G)G=0;if(!C||0>C||C>H)C=H;I="";for(H=G;H<C;++H)G=I,I=this[H],I=16>I?"0"+I.toString(16):I.toString(16),I=G+I;return I;case "utf8":case "utf-8":return B(this,C,H);case "ascii":G="";for(H=Math.min(this.length,H);C<H;++C)G+=String.fromCharCode(this[C]&127);return G;case "latin1":case "binary":G="";for(H=Math.min(this.length,H);C<H;++C)G+=String.fromCharCode(this[C]);return G;case "base64":return 0===
C&&H===this.length?J.KYe(this):J.KYe(this.slice(C,H));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":C=this.slice(C,H);H="";for(G=0;G<C.length;G+=2)H+=String.fromCharCode(C[G]+256*C[G+1]);return H;default:if(I)throw new TypeError("Unknown encoding: "+G);G=(G+"").toLowerCase();I=!0}}function r(G,C,H,I,M){if(0===G.length)return-1;"string"===typeof H?(I=H,H=0):2147483647<H?H=2147483647:-2147483648>H&&(H=-2147483648);H=+H;isNaN(H)&&(H=M?0:G.length-1);0>H&&(H=G.length+H);if(H>=G.length){if(M)return-1;
H=G.length-1}else if(0>H)if(M)H=0;else return-1;"string"===typeof C&&(C=f.from(C,I));if(f.isBuffer(C))return 0===C.length?-1:v(G,C,H,I,M);if("number"===typeof C)return C&=255,f.mP&&"function"===typeof Uint8Array.prototype.indexOf?M?Uint8Array.prototype.indexOf.call(G,C,H):Uint8Array.prototype.lastIndexOf.call(G,C,H):v(G,[C],H,I,M);throw new TypeError("val must be string, number or Buffer");}function v(G,C,H,I,M){function Q(X,sa){return 1===U?X[sa]:X.f$i(sa*U)}var U=1,N=G.length,W=C.length;if(void 0!==
I&&(I=String(I).toLowerCase(),"ucs2"===I||"ucs-2"===I||"utf16le"===I||"utf-16le"===I)){if(2>G.length||2>C.length)return-1;U=2;N/=2;W/=2;H/=2}if(M)for(I=-1;H<N;H++)if(Q(G,H)===Q(C,-1===I?0:H-I)){if(-1===I&&(I=H),H-I+1===W)return I*U}else-1!==I&&(H-=H-I),I=-1;else for(H+W>N&&(H=N-W);0<=H;H--){N=!0;for(I=0;I<W;I++)if(Q(G,H+I)!==Q(C,I)){N=!1;break}if(N)return H}return-1}function B(G,C,H){H=Math.min(G.length,H);for(var I=[];C<H;){var M=G[C],Q=null,U=239<M?4:223<M?3:191<M?2:1;if(C+U<=H)switch(U){case 1:128>
M&&(Q=M);break;case 2:var N=G[C+1];128===(N&192)&&(M=(M&31)<<6|N&63,127<M&&(Q=M));break;case 3:N=G[C+1];var W=G[C+2];128===(N&192)&&128===(W&192)&&(M=(M&15)<<12|(N&63)<<6|W&63,2047<M&&(55296>M||57343<M)&&(Q=M));break;case 4:N=G[C+1];W=G[C+2];var X=G[C+3];128===(N&192)&&128===(W&192)&&128===(X&192)&&(M=(M&15)<<18|(N&63)<<12|(W&63)<<6|X&63,65535<M&&1114112>M&&(Q=M))}null===Q?(Q=65533,U=1):65535<Q&&(Q-=65536,I.push(Q>>>10&1023|55296),Q=56320|Q&1023);I.push(Q);C+=U}G=I.length;if(G<=T)I=String.fromCharCode.apply(String,
I);else{H="";for(C=0;C<G;)H+=String.fromCharCode.apply(String,I.slice(C,C+=T));I=H}return I}function A(G,C){C=C||Infinity;for(var H,I=G.length,M=null,Q=[],U=0;U<I;++U){H=G.charCodeAt(U);if(55295<H&&57344>H){if(!M){if(56319<H){-1<(C-=3)&&Q.push(239,191,189);continue}else if(U+1===I){-1<(C-=3)&&Q.push(239,191,189);continue}M=H;continue}if(56320>H){-1<(C-=3)&&Q.push(239,191,189);M=H;continue}H=(M-55296<<10|H-56320)+65536}else M&&-1<(C-=3)&&Q.push(239,191,189);M=null;if(128>H){if(0>--C)break;Q.push(H)}else if(2048>
H){if(0>(C-=2))break;Q.push(H>>6|192,H&63|128)}else if(65536>H){if(0>(C-=3))break;Q.push(H>>12|224,H>>6&63|128,H&63|128)}else if(1114112>H){if(0>(C-=4))break;Q.push(H>>18|240,H>>12&63|128,H>>6&63|128,H&63|128)}else throw Error("Invalid code point");}return Q}function z(G){for(var C=[],H=0;H<G.length;++H)C.push(G.charCodeAt(H)&255);return C}function x(G){var C=J,H=C.IOj;G=(G.trim?G.trim():G.replace(/^\s+|\s+$/g,"")).replace(O,"");if(2>G.length)G="";else for(;0!==G.length%4;)G+="=";return H.call(C,
G)}function D(G,C,H,I){for(var M=0;M<I&&!(M+H>=C.length||M>=G.length);++M)C[M+H]=G[M];return M}var J=a(1312);a(1313);var L=a(1314);E.lmg=f;E.u3j=function(G){+G!=G&&(G=0);return f.yse(+G)};E.a3j=50;f.mP=void 0!==c.mP?c.mP:b();E.i4j=f.mP?2147483647:1073741823;f.from=function(G,C,H){return d(null,G,C,H)};f.mP&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));
f.yse=function(G){h(G);return e(null,G)};f.nOg=function(G){return m(null,G)};f.isBuffer=function(G){return!(null==G||!G.pwg)};f.compare=function(G,C){if(!f.isBuffer(G)||!f.isBuffer(C))throw new TypeError("Arguments must be Buffers");if(G===C)return 0;for(var H=G.length,I=C.length,M=0,Q=Math.min(H,I);M<Q;++M)if(G[M]!==C[M]){H=G[M];I=C[M];break}return H<I?-1:I<H?1:0};f.$gf=function(G){switch(String(G).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};f.concat=function(G,C){if(!L(G))throw new TypeError('"list" argument must be an Array of Buffers');if(0===G.length)return f.yse(0);var H;if(void 0===C)for(H=C=0;H<G.length;++H)C+=G[H].length;C=f.nOg(C);var I=0;for(H=0;H<G.length;++H){var M=G[H];if(!f.isBuffer(M))throw new TypeError('"list" argument must be an Array of Buffers');M.copy(C,I);I+=M.length}return C};f.byteLength=y;f.prototype.pwg=!0;f.prototype.toString=function(){var G=this.length|0;return 0===G?"":0===arguments.length?
B(this,0,G):t.apply(this,arguments)};f.prototype.equals=function(G){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:0===f.compare(this,G)};f.prototype.compare=function(G,C,H,I,M){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");void 0===C&&(C=0);void 0===H&&(H=G?G.length:0);void 0===I&&(I=0);void 0===M&&(M=this.length);if(0>C||H>G.length||0>I||M>this.length)throw new RangeError("out of range index");if(I>=M&&C>=H)return 0;if(I>=M)return-1;if(C>=
H)return 1;C>>>=0;H>>>=0;I>>>=0;M>>>=0;if(this===G)return 0;var Q=M-I,U=H-C,N=Math.min(Q,U);I=this.slice(I,M);G=G.slice(C,H);for(C=0;C<N;++C)if(I[C]!==G[C]){Q=I[C];U=G[C];break}return Q<U?-1:U<Q?1:0};f.prototype.includes=function(G,C,H){return-1!==this.indexOf(G,C,H)};f.prototype.indexOf=function(G,C,H){return r(this,G,C,H,!0)};f.prototype.lastIndexOf=function(G,C,H){return r(this,G,C,H,!1)};f.prototype.write=function(G,C,H,I){if(void 0===C)I="utf8",H=this.length,C=0;else if(void 0===H&&"string"===
typeof C)I=C,H=this.length,C=0;else if(isFinite(C))C|=0,isFinite(H)?(H|=0,void 0===I&&(I="utf8")):(I=H,H=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var M=this.length-C;if(void 0===H||H>M)H=M;if(0<G.length&&(0>H||0>C)||C>this.length)throw new RangeError("Attempt to write outside buffer bounds");I||(I="utf8");for(M=!1;;)switch(I){case "hex":C=Number(C)||0;I=this.length-C;H?(H=Number(H),H>I&&(H=I)):H=I;I=G.length;if(0!==I%2)throw new TypeError("Invalid hex string");
H>I/2&&(H=I/2);for(I=0;I<H;++I){M=parseInt(G.substr(2*I,2),16);if(isNaN(M))break;this[C+I]=M}return I;case "utf8":case "utf-8":return D(A(G,this.length-C),this,C,H);case "ascii":return D(z(G),this,C,H);case "latin1":case "binary":return D(z(G),this,C,H);case "base64":return D(x(G),this,C,H);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":I=G;M=this.length-C;for(var Q=[],U=0;U<I.length&&!(0>(M-=2));++U){var N=I.charCodeAt(U);G=N>>8;N%=256;Q.push(N);Q.push(G)}return D(Q,this,C,H);default:if(M)throw new TypeError("Unknown encoding: "+
I);I=(""+I).toLowerCase();M=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.z3j||this,0)}};var T=4096;f.prototype.slice=function(G,C){var H=this.length;G=~~G;C=void 0===C?H:~~C;0>G?(G+=H,0>G&&(G=0)):G>H&&(G=H);0>C?(C+=H,0>C&&(C=0)):C>H&&(C=H);C<G&&(C=G);if(f.mP)C=this.subarray(G,C),C.__proto__=f.prototype;else{H=C-G;C=new f(H,void 0);for(var I=0;I<H;++I)C[I]=this[I+G]}return C};f.prototype.f$i=function(G){if(0!==G%1||0>G)throw new RangeError("offset is not uint");
if(G+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[G]<<8|this[G+1]};f.prototype.copy=function(G,C,H,I){H||(H=0);I||0===I||(I=this.length);C>=G.length&&(C=G.length);C||(C=0);0<I&&I<H&&(I=H);if(I===H||0===G.length||0===this.length)return 0;if(0>C)throw new RangeError("targetStart out of bounds");if(0>H||H>=this.length)throw new RangeError("sourceStart out of bounds");if(0>I)throw new RangeError("sourceEnd out of bounds");I>this.length&&(I=this.length);G.length-
C<I-H&&(I=G.length-C+H);var M=I-H;if(this===G&&H<C&&C<I)for(I=M-1;0<=I;--I)G[I+C]=this[I+H];else if(1E3>M||!f.mP)for(I=0;I<M;++I)G[I+C]=this[I+H];else Uint8Array.prototype.set.call(G,this.subarray(H,H+M),C);return M};f.prototype.fill=function(G,C,H,I){if("string"===typeof G){"string"===typeof C?(I=C,C=0,H=this.length):"string"===typeof H&&(I=H,H=this.length);if(1===G.length){var M=G.charCodeAt(0);256>M&&(G=M)}if(void 0!==I&&"string"!==typeof I)throw new TypeError("encoding must be a string");if("string"===
typeof I&&!f.$gf(I))throw new TypeError("Unknown encoding: "+I);}else"number"===typeof G&&(G&=255);if(0>C||this.length<C||this.length<H)throw new RangeError("Out of range index");if(H<=C)return this;C>>>=0;H=void 0===H?this.length:H>>>0;G||(G=0);if("number"===typeof G)for(I=C;I<H;++I)this[I]=G;else for(G=f.isBuffer(G)?G:A((new f(G,I)).toString()),M=G.length,I=0;I<H-C;++I)this[I+C]=G[I%M];return this};var O=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1311))},1311:function(u){var E=function(){return this}();
try{E=E||(new Function("return this"))()}catch(a){"object"===typeof window&&(E=window)}u.exports=E},1312:function(u,E){function a(f){var d=f.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=d);return[f,f===d?0:4-f%4]}E.byteLength=function(f){f=a(f);var d=f[1];return 3*(f[0]+d)/4-d};E.IOj=function(f){var d=a(f);var h=d[0];d=d[1];var m=new e(3*(h+d)/4-d),l=0,w=0<d?h-4:h,n;for(n=0;n<w;n+=4)h=b[f.charCodeAt(n)]<<18|b[f.charCodeAt(n+1)]<<12|b[f.charCodeAt(n+
2)]<<6|b[f.charCodeAt(n+3)],m[l++]=h>>16&255,m[l++]=h>>8&255,m[l++]=h&255;2===d&&(h=b[f.charCodeAt(n)]<<2|b[f.charCodeAt(n+1)]>>4,m[l++]=h&255);1===d&&(h=b[f.charCodeAt(n)]<<10|b[f.charCodeAt(n+1)]<<4|b[f.charCodeAt(n+2)]>>2,m[l++]=h>>8&255,m[l++]=h&255);return m};E.KYe=function(f){for(var d=f.length,h=d%3,m=[],l=0,w=d-h;l<w;l+=16383){for(var n=m,y=n.push,t,r=f,v=l+16383>w?w:l+16383,B=[],A=l;A<v;A+=3)t=(r[A]<<16&16711680)+(r[A+1]<<8&65280)+(r[A+2]&255),B.push(c[t>>18&63]+c[t>>12&63]+c[t>>6&63]+c[t&
63]);t=B.join("");y.call(n,t)}1===h?(f=f[d-1],m.push(c[f>>2]+c[f<<4&63]+"==")):2===h&&(f=(f[d-2]<<8)+f[d-1],m.push(c[f>>10]+c[f>>4&63]+c[f<<2&63]+"="));return m.join("")};var c=[],b=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(u=0;64>u;++u)c[u]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(u)]=u;b[45]=62;b[95]=63},1313:function(u,E){E.read=function(a,c,b,e,f){var d=8*f-e-1;var h=(1<<
d)-1,m=h>>1,l=-7;f=b?f-1:0;var w=b?-1:1,n=a[c+f];f+=w;b=n&(1<<-l)-1;n>>=-l;for(l+=d;0<l;b=256*b+a[c+f],f+=w,l-=8);d=b&(1<<-l)-1;b>>=-l;for(l+=e;0<l;d=256*d+a[c+f],f+=w,l-=8);if(0===b)b=1-m;else{if(b===h)return d?NaN:Infinity*(n?-1:1);d+=Math.pow(2,e);b-=m}return(n?-1:1)*d*Math.pow(2,b-e)};E.write=function(a,c,b,e,f,d){var h,m=8*d-f-1,l=(1<<m)-1,w=l>>1,n=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;d=e?0:d-1;var y=e?1:-1,t=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,e=l):
(e=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-e))&&(e--,h*=2),c=1<=e+w?c+n/h:c+n*Math.pow(2,1-w),2<=c*h&&(e++,h/=2),e+w>=l?(c=0,e=l):1<=e+w?(c=(c*h-1)*Math.pow(2,f),e+=w):(c=c*Math.pow(2,w-1)*Math.pow(2,f),e=0));for(;8<=f;a[b+d]=c&255,d+=y,c/=256,f-=8);e=e<<f|c;for(m+=f;0<m;a[b+d]=e&255,d+=y,e/=256,m-=8);a[b+d-y]|=128*t}},1314:function(u){var E={}.toString;u.exports=Array.isArray||function(a){return"[object Array]"==E.call(a)}},1315:function(u,E,a){a.d(E,"a",function(){return b});u=a(0);
E=a(722);var c=a(697);class b extends E.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.Pd()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Pd(){return["AugLoop_Core_Annotation"]}}Object(u.a)(b,"DetectedHtmlTableAnnotation",E.a,[])},1316:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{static xIa(b,e){if(!(b&&e&&b.length&&e.length)||256<b.length)return"";const f=
Array(256),d=Array(256);let h,m=0,l=0;let w,n="";for(h=0;256>h;h++)f[h]=h;for(h=0;256>h;h++){var y=b.charCodeAt(h%b.length);if(256<=y)return"";m=(m+f[h]+y)%256;y=f[h];f[h]=f[m];f[m]=y}for(h=0;256>h;h++)d[h]=f[256-h-1];m=h=0;for(b=0;b<e.length;b++){h=(h+1)%256;m=(m+f[h])%256;y=f[h];f[h]=f[m];f[m]=y;y=e.charCodeAt(b);if(256<=y)return"";w=y^f[(f[h]+f[m])%256];l=(l+d[h])%256;y=d[h];d[h]=d[l];d[l]=y;n+=String.fromCharCode(w^f[(d[h]+d[l])%256])}return n}}Object(u.a)(c,"RC4A",null,[])},1318:function(u,E,
a){a.d(E,"a",function(){return b});u=a(0);a(15);var c=a(4);class b{constructor(e,f,d,h){this.blb=e;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&d.jWh();this.yx=f;this.nBg=h}get HEb(){return this.blb}get solutionId(){return this.yx}get ATd(){return this.nBg}TKa(e){e=this.HEb+this.solutionId+e;return this.ATd?(e in b.h0b||(b.h0b[e]="AddinControl"+b.aNg++),b.h0b[e]):e}qJe(e){if(this.ATd){const d=b.h0b;for(let h in d){var f=h;if(e===d[h])return f.substr(this.HEb.length+this.solutionId.length)}}return e}U6e(e){e=
this.HEb+this.solutionId+e;return this.ATd?(e in b.jXc||(b.jXc[e]="AddinTab"+b.lNg++),b.jXc[e]):e}}b.h0b={};b.jXc={};b.lNg=0;b.aNg=0;Object(u.a)(b,"DefaultRibbonNamingProvider",null,[723])},1365:function(u,E,a){a.r(E);u=a(0);var c=a(15),b=a(83),e;(function(t){t[t.none=0]="none";t[t.testEvent=1]="testEvent";t[t.test1Event=2]="test1Event";t[t.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";t[t.worksheetActivatedEvent=11]="worksheetActivatedEvent";t[t.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";
t[t.worksheetAddedEvent=13]="worksheetAddedEvent";t[t.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";t[t.worksheetDeletedEvent=15]="worksheetDeletedEvent";t[t.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";t[t.worksheetFilteredEvent=17]="worksheetFilteredEvent";t[t.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";t[t.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";t[t.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";t[t.worksheetSingleClickedEvent=
21]="worksheetSingleClickedEvent";t[t.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";t[t.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";t[t.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";t[t.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";t[t.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";t[t.worksheetMovedEvent=27]="worksheetMovedEvent";t[t.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";
t[t.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";t[t.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";t[t.chartAddedEvent=50]="chartAddedEvent";t[t.chartActivatedEvent=51]="chartActivatedEvent";t[t.chartDeactivatedEvent=52]="chartDeactivatedEvent";t[t.chartDeletedEvent=53]="chartDeletedEvent";t[t.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";t[t.tableDataChangedEvent=101]="tableDataChangedEvent";t[t.tableAddedEvent=102]=
"tableAddedEvent";t[t.tableDeletedEvent=103]="tableDeletedEvent";t[t.tableFilteredEvent=104]="tableFilteredEvent";t[t.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";t[t.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";t[t.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";t[t.commentAddedEvent=250]="commentAddedEvent";t[t.commentDeletedEvent=251]="commentDeletedEvent";t[t.commentChangedEvent=252]="commentChangedEvent";t[t.invocationMessage=1E3]=
"invocationMessage";t[t.cancellationMessage=1001]="cancellationMessage";t[t.metadataMessage=1002]="metadataMessage";t[t.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";t[t.visualChangeEvent=2001]="visualChangeEvent";t[t.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";t[t.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";t[t.shapeActivatedEvent=2101]="shapeActivatedEvent";t[t.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";t[t.shapeAddedEvent=2103]=
"shapeAddedEvent";t[t.shapeDeletedEvent=2104]="shapeDeletedEvent";t[t.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";t[t.wacOperationEvent=2201]="wacOperationEvent";t[t.recordingStateChangedEvent=2202]="recordingStateChangedEvent";t[t.workbookActivatedEvent=2203]="workbookActivatedEvent";t[t.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";t[t.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";t[t.linkedDataTypeRefreshRequestCompletedEvent=
2500]="linkedDataTypeRefreshRequestCompletedEvent";t[t.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";t[t.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";t[t.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";t[t.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";t[t.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";t[t.rangePickerDeactivatedEvent=
2701]="rangePickerDeactivatedEvent";t[t.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";t[t.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";t[t.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";t[t.pivotTableAddedEvent=2900]="pivotTableAddedEvent";t[t.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";t[t.namedItemAddedEvent=3E3]="namedItemAddedEvent";t[t.namedItemDeletedEvent=3001]="namedItemDeletedEvent";t[t.guidedReapplyManagerUpdateAvailableEvent=
3100]="guidedReapplyManagerUpdateAvailableEvent";t[t.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";t[t.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";t[t.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(e||(e={}));Object(u.b)("MessageType",e);var f=a(765),d=a(249),h=a(734),m=a(58),l=a(37),w=a(153),n=a(1);a.d(E,"DdaEventDispatch",function(){return y});class y{constructor(t){this.cB=null;this.ydg={};this.Adg=
{};this.kcd={};this.AAd={};this.okd=(r,v)=>{r=this.$.Jb.Ac("Task","DdaEventDispatch.HandleServerEvent");v=v.e1f;for(let x=0;x<v.length;x++)switch(v[x].EventType){case 2:var B=v[x],A={};A.Name=B.Name;A.BindingType=B.BindingType;A.ColCount=B.ColCount;A.RowCount=B.RowCount;this.xwa(B.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,A,null);break;case 4:this.xwa(v[x].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(B=v[x],B.InstanceId){A=Array(B.Entries.length);
for(var z=0;z<B.Entries.length;z++)A[z]=y.edc(B.Entries[z],B.IsRemoteOverride);0<B.Entries.length&&1===B.Entries[0].Category?this.n5i(B.InstanceId,A):B.InstanceId&&this.xwa(B.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,A)}else{this.kcd={};this.AAd={};for(A=0;A<B.Entries.length;A++)this.VLe(B.Entries[A],B.IsRemoteOverride);B=JSON.stringify(this.kcd);A=JSON.stringify(this.AAd);z=JSON.stringify(this.ydg);const D=JSON.stringify(this.Adg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${B}, Number of Not Fired event: ${A}, Total Number of Fired event: ${z}, Total Number of Not Fired event: ${D}`)}}r.stop()};
this.HLb=(r,v)=>{this.xwa(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)};this.$=t;this.dxc=this.okd}M_b(t){t&&(this.Tia(),this.cB.push(t))}uuc(t){this.cB&&(Array.remove(this.cB,t),this.cB.length||(this.$.wantServerEvents=!1,this.$.ihj(this.dxc),this.cB=null))}n5i(t,r){const v=Object(b.a)(h.DdaFacade,d.a(this.$));l.TaskExtensions.Aa(v.EXh(t),B=>{if(w.b(B)){var A=B.result;B=v.zn(A);if(A)if(B.Fic)this.xwa(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r);else if(B.J6b)for(A=0;A<r.length;A++)B.J6b.push(r[A]);
else B.J6b=r}else B.Xf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):B.Ch&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)}J5i(t,r){const v=Object(b.a)(h.DdaFacade,d.a(this.$)),B=v.OLh(t);B?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(B,r,this.HLb):v.p9g(t,r)}VLe(t,r){let v=!1;const B=parseInt(t.Type,
10);var A=t.Target;const z=Object(b.a)(h.DdaFacade,d.a(this.$));if((A=z.jj.JXh(B,A))&&0<Object.keys(A).length){v=!0;for(let D in A)if(A=D,z.jj.X0b(A)){const J=Array(1);J[0]=y.edc(t,r);if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var x=J[0][3];if(void 0!==x&&null!==x&&(x=Object(b.a)(Object,m.a.li(x)))&&void 0!==x.triggerControlId&&null!==x.triggerControlId&&void 0!==x.triggerSource&&null!==x.triggerSource){let L=!1;r?(x.triggerSource="Unknown",L=!0):z.jmh(x.triggerControlId,
A)&&(x.triggerSource="ThisLocalAddin",L=!0);L&&(J[0][3]=m.a.hc(x))}}this.xwa(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,J)}}v?(this.Qfc(e[B],this.kcd),this.Qfc(e[B],this.ydg)):(this.Qfc(e[B],this.AAd),this.Qfc(e[B],this.Adg))}Tia(){this.cB||(this.cB=[],this.$.vre(this.dxc),this.$.wantServerEvents=!0)}Qfc(t,r){t in r||(r[t]=0);r[t]+=1}cN(t,r,v){const B={};B.Target=r;B.Category=65536;B.Type=t;B.Message=v;B.Id=-1;this.VLe(B,!1)}LFh(t,r){const v={Target:"",Category:2,Type:1E3};v.Message=r;v.Id=
0;r=Array(1);r[0]=y.edc(v,!1);this.J5i(t,r)}cac(t,r,v,B){const A={};A.Target=v;A.Category=65536;A.Type=r;A.Message=B;A.Id=-1;r=Array(1);r[0]=y.edc(A,!1);this.xwa(t,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r)}KFh(t,r){this.xwa(t,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r)}xwa(t,r,v,B){if(this.cB){var A=Object(b.a)(h.DdaFacade,d.a(this.$));if(!A||r!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&r!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||A.jj.X0b(t)){t=new f.a(r,t,
v,B);for(let z=0,x=this.cB.length;z<x;z++)(r=this.cB[z])&&r(t)}}}static edc(t,r){const v=Array(6);v[0]=t.Category;v[1]=t.Type;v[2]=t.Target;v[3]=t.Message;v[4]=t.Id;v[5]=r;return v}}Object(u.a)(y,"DdaEventDispatch",null,[])},1395:function(u,E,a){a.d(E,"a",function(){return b});u=a(0);E=a(146);var c=a(86);class b extends E.a{constructor(){super(void 0,void 0,void 0,!0);this.RDa="AddinCommandsUILessDialog";this.PTc="WACDialogTitleText";this.rfa="0";this.WX=380;this.jqa=190;this.Fe=this.RDa;this.Rb=
5;this.usg=String.format("{0}px",this.WX);this.qfa=String.format("{0}px",this.jqa);this.s$e=this.It=!1;this.Vz()}Vz(){super.Vz();this.Wk.style.width=this.usg;this.Wk.style.height=this.qfa;this.Wk.style.padding=this.rfa}Ov(e){this.VI();document.getElementById(this.mi(this.PTc)).innerText=e}VI(){super.VI();this.wb.style.width=String.format("{0}px",this.WX);this.wb.style.height=String.format("{0}px",this.jqa);this.wb.removeAttribute(c.a.Ld);this.wb.removeAttribute(c.a.QP)}hide(){this.Pyb()}get Fia(){return this.Wk}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(u.a)(b,"AddinCommandsUILessDialog",E.a,[726])},1425:function(u,E,a){a.r(E);var c=a(511),b=a(953),e=a(1187),f=a(9),d=a(0),h=a(222),m=a(187),l=a(586);class w{constructor(){this.whb=null}get YSg(){this.whb||(this.whb=new m.a,this.whb.add(12),this.whb.add(11));return this.whb}Nii(P){return this.YSg.contains(P.operation)}$Sj(P){const Ta=[],Hb=P.payload;for(const lc of Hb.batchedOperations)Ta.push(new l.a(P.operation,lc));return Ta}}Object(d.a)(w,"MacroRecorderBatchedEventList",null,
[]);var n=a(15),y=a(58),t=a(121),r=a(639);class v{equals(P,Ta){return P===Ta}getHashCode(P){return P}Pja(P){return P}}Object(d.a)(v,"UserOperationNameComparer",null,[116,117]);class B{static E4h(){B.Oc||(B.Oc=new r.a(new v),B.Oc.add(507),B.Oc.add(10),B.Oc.add(576),B.Oc.add(563),B.Oc.add(564),B.Oc.add(565),B.Oc.add(566),B.Oc.add(567),B.Oc.add(568),B.Oc.add(569),B.Oc.add(570),B.Oc.add(571),B.Oc.add(572),B.Oc.add(573),B.Oc.add(574),B.Oc.add(575),B.Oc.add(501),B.Oc.add(520),B.Oc.add(1),B.Oc.add(1002),
B.Oc.add(129),B.Oc.add(198),B.Oc.add(500),B.Oc.add(519),B.Oc.add(538),B.Oc.add(1E3),B.Oc.add(1003),B.Oc.add(144),B.Oc.add(502),B.Oc.add(505),B.Oc.add(179),B.Oc.add(205),B.Oc.add(134),B.Oc.add(230),B.Oc.add(103),B.Oc.add(110),B.Oc.add(112),B.Oc.add(113),B.Oc.add(124),B.Oc.add(133),B.Oc.add(154),B.Oc.add(162),B.Oc.add(168),B.Oc.add(172),B.Oc.add(201),B.Oc.add(222),B.Oc.add(227),B.Oc.add(513),B.Oc.add(534),B.Oc.add(539),B.Oc.add(545),B.Oc.add(600),B.Oc.add(547),B.Oc.add(555),B.Oc.add(558),B.Oc.add(562),
B.Oc.add(585),B.Oc.add(1001),B.Oc.add(1005),B.Oc.add(1008),B.Oc.add(1010),B.Oc.add(1011),B.Oc.add(1012),B.Oc.add(1018),B.Oc.add(252),B.Oc.add(253),B.Oc.add(258),B.Oc.add(101),B.Oc.add(102),B.Oc.add(108),B.Oc.add(257),B.Oc.add(119),B.Oc.add(120),B.Oc.add(123),B.Oc.add(126),B.Oc.add(127),B.Oc.add(130),B.Oc.add(140),B.Oc.add(159),B.Oc.add(160),B.Oc.add(165),B.Oc.add(166),B.Oc.add(167),B.Oc.add(169),B.Oc.add(189),B.Oc.add(223),B.Oc.add(214),B.Oc.add(228),B.Oc.add(233),B.Oc.add(247),B.Oc.add(504),B.Oc.add(511),
B.Oc.add(512),B.Oc.add(525),B.Oc.add(533),B.Oc.add(537),B.Oc.add(542),B.Oc.add(544),B.Oc.add(548),B.Oc.add(550),B.Oc.add(551),B.Oc.add(552),B.Oc.add(554),B.Oc.add(577),B.Oc.add(584),B.Oc.add(586),B.Oc.add(587),B.Oc.add(588),B.Oc.add(592),B.Oc.add(1009),B.Oc.add(1016),B.Oc.add(1017));return B.Oc}}B.Oc=null;Object(d.a)(B,"MacroRecorderUnrecognizedEventList",null,[]);class A{constructor(P,Ta,Hb){this.aac=null;this.XBi=(lc,xc)=>{this.r6f()&&this.hcd(xc)};this.etf=Ta;this.dtf=Hb;this.$=P;this.$.GV&&this.$.vLg(this.XBi);
P.da.Ga(297,this)}init(P){this.$.GV&&(P?this.aac=P:n.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}hcd(P){if(this.r6f())try{if(this.dtf.Nii(P)){const Ta=this.dtf.$Sj(P);for(const Hb of Ta)this.gXe(Hb)}else this.gXe(P)}catch(Ta){P=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${t.a(P.operation)}, Exception: ${Ta.stack}`,n.ULS.sendTraceTag(537155423,0,10,P)}}gXe(P){var Ta=this.etf.w3e(P,!0);Ta?(this.aac(Ta.eventId,y.a.hc(P.payload)),
n.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ta.eventId}`)):(Ta=this.etf.w3e(P,!1))?n.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ta.eventId}, but failed to match filters`):B.E4h().contains(P.operation)||(this.aac(0,y.a.hc(P.operation)),P=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${t.a(P.operation)}`,n.ULS.sendTraceTag(537155420,0,50,P))}r6f(){return this.$.z5&&this.aac&&this.$.Qba?
!0:!1}}Object(d.a)(A,"MacroRecorderEventHandler",null,[825]);var z=a(1);class x{constructor(){this.QJc=this.RJc=this.NPc=this.lUc=null}get operations(){this.NPc||(this.NPc=new m.a,this.Xb());return this.NPc}get nEc(){this.lUc||(this.lUc=new m.a,this.hg());return this.lUc}get NVe(){this.QJc||(this.QJc=new m.a);return this.QJc}get featureGates(){this.RJc||(this.RJc=new m.a,this.Zwa());return this.RJc}hg(){}Zwa(){}kd(P){this.nEc.add(P)}Ob(P){this.operations.contains(P)||this.operations.add(P)}Wnb(){this.featureGates.add(663)}Eoe(P){this.NVe.add(P)}}
Object(d.a)(x,"MacroRecorderEventBase",null,[]);class D extends x{constructor(){super()}get eventId(){return 130}Xb(){this.Ob(100)}}Object(d.a)(D,"AccessibilityCheckRunEvent",x,[]);class J extends x{constructor(){super()}get eventId(){return 160}Xb(){this.Ob(241)}hg(){this.kd(P=>P.addToPrintArea)}}Object(d.a)(J,"AddedToPrintAreaEvent",x,[]);class L extends x{constructor(){super()}get eventId(){return 65}Xb(){this.Ob(516)}}Object(d.a)(L,"AutoFilterToggledEvent",x,[]);class T extends x{constructor(){super()}get eventId(){return 118}Xb(){this.Ob(502)}hg(){this.kd(P=>
!(P.m5a().FirstColumn===P.m5a().LastColumn&&P.m5a().FirstRow===P.m5a().LastRow))}}Object(d.a)(T,"AutoSumEvent",x,[]);class O extends x{constructor(P,Ta){super();this.Gfa=P;this.A_j=Ta}get eventId(){return this.Gfa}Xb(){this.Ob(529);this.Ob(594)}hg(){this.kd(P=>this.A_j.includes(P.ihd()))}}Object(d.a)(O,"ChartPropertyAppliedEventBase",x,[]);class G extends O{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(d.a)(G,"ChartAxisChangedEvent",O,[]);class C extends O{constructor(){super(80,
[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(d.a)(C,"ChartAxisTitleChangedEvent",O,[]);class H extends O{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(d.a)(H,"ChartDataLabelsChangedEvent",O,[]);class I extends O{constructor(){super(76,[-100])}}Object(d.a)(I,"ChartDataSelectedEvent",O,[]);class M extends O{constructor(){super(83,[500,501,502])}}Object(d.a)(M,"ChartDataTableChangedEvent",O,[]);var Q=a(553),U=a(416),N=a(83);class W extends x{constructor(){super()}}
Object(d.a)(W,"RichApiRequestExecutedEventBase",x,[]);class X{constructor(P,Ta,Hb){this.response=this.request=this.eventId=this.source=null;P&&(this.source=P.source,this.eventId=P.eventId,this.request=Ta,this.response=Hb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(d.a)(X,"MacroRecorderRichApiRequestExecutedPayload",null,[137]);class sa extends W{constructor(){super()}get eventId(){return 117}sy(P){sa.r7||(sa.r7=new r.a(Q.a.Yj()),
sa.r7.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),sa.r7.add("fa000000014"));return!!P&&sa.r7.contains(P.toLowerCase())}Xb(){this.Ob(507);this.Ob(10);this.Ob(576)}hg(){this.kd(P=>Object(U.a)(X,P)&&(P=Object(N.a)(X,P),P.isValid&&this.sy(P.source))?(n.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${P.eventId}`),!0):!1)}}sa.r7=null;Object(d.a)(sa,"ChartFormatRichApiRequestExecutedEvent",W,[]);class da extends O{constructor(){super(85,
[328,329,330,331,332,333,334,335])}}Object(d.a)(da,"ChartGridlinesChangedEvent",O,[]);class S extends x{constructor(){super()}get eventId(){return 66}Xb(){this.Ob(528)}}Object(d.a)(S,"ChartInsertedEvent",x,[]);class oa extends O{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(d.a)(oa,"ChartLegendChangedEvent",O,[]);class K extends O{constructor(){super(75,[-101])}}Object(d.a)(K,"ChartRowColumnSwitchedEvent",O,[]);class ea extends O{constructor(){super(79,[0,1,2,-102])}}Object(d.a)(ea,
"ChartTitleChangedEvent",O,[]);class ya extends O{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(d.a)(ya,"ChartTypeChangedEvent",O,[]);class ha extends x{constructor(){super()}get eventId(){return 131}Xb(){this.Ob(521)}}Object(d.a)(ha,"ConnectorFloatingObjectResizedEvent",x,[]);class La extends x{constructor(){super()}get eventId(){return 129}Xb(){this.Ob(109)}}
Object(d.a)(La,"EntitySelectedEvent",x,[]);class Ia extends x{constructor(){super()}get eventId(){return 49}Xb(){this.Ob(149);this.Ob(147)}}Object(d.a)(Ia,"FindCellEvent",x,[]);class ra extends x{constructor(){super()}get eventId(){return 96}Xb(){this.Ob(122)}}Object(d.a)(ra,"FloatingObjectAltTextAppliedEvent",x,[]);class pa extends x{constructor(){super()}get eventId(){return 93}Xb(){this.Ob(522)}}Object(d.a)(pa,"FloatingObjectDeletedEvent",x,[]);class ba extends x{constructor(){super()}get eventId(){return 94}Xb(){this.Ob(524)}}
Object(d.a)(ba,"FloatingObjectMovedAndResizedEvent",x,[]);class fa extends x{constructor(){super()}get eventId(){return 95}Xb(){this.Ob(523)}}Object(d.a)(fa,"FloatingObjectRotatedEvent",x,[]);class Ka extends x{constructor(){super()}get eventId(){return 100}Xb(){this.Ob(543)}}Object(d.a)(Ka,"GroupDetailsShownOrHiddenEvent",x,[]);class aa extends x{constructor(){super()}get eventId(){return 154}Xb(){this.Ob(125)}}Object(d.a)(aa,"HyperlinksRemovedFromRangeEvent",x,[]);class ja extends W{constructor(){super()}get eventId(){return 125}sy(P){ja.r7||
(ja.r7=new r.a(Q.a.Yj()),ja.r7.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ja.r7.add("fa000000005"));return!!P&&ja.r7.contains(P.toLowerCase())}Xb(){this.Ob(507);this.Ob(10);this.Ob(576)}hg(){this.kd(P=>Object(U.a)(X,P)?(P=Object(N.a)(X,P),P.isValid&&this.sy(P.source)):!1)}}ja.r7=null;Object(d.a)(ja,"IdeasRichApiRequestExecutedEvent",W,[]);class Va extends x{constructor(){super()}get eventId(){return 136}Xb(){this.Ob(115)}}Object(d.a)(Va,"LinkedEntityConvertedEvent",x,[]);class bb extends x{constructor(){super()}get eventId(){return 148}Xb(){this.Ob(114)}}
Object(d.a)(bb,"LinkedEntityDisambiguationPaneToggledEvent",x,[]);class wa extends x{constructor(){super()}get eventId(){return 127}Xb(){this.Ob(119)}}Object(d.a)(wa,"MovedToEdgeEvent",x,[]);class ka extends x{constructor(){super()}get eventId(){return 135}Xb(){this.Ob(191)}Zwa(){this.Wnb()}}Object(d.a)(ka,"NamedSheetViewCreatedEvent",x,[]);class ta extends x{constructor(){super()}get eventId(){return 166}Xb(){this.Ob(200)}Zwa(){this.Wnb()}}Object(d.a)(ta,"NamedSheetViewDeletedEvent",x,[]);class qa extends x{constructor(){super()}get eventId(){return 133}Xb(){this.Ob(192)}Zwa(){this.Wnb()}}
Object(d.a)(qa,"NamedSheetViewExitedEvent",x,[]);class rb extends x{constructor(){super()}get eventId(){return 162}Xb(){this.Ob(199)}Zwa(){this.Wnb()}}Object(d.a)(rb,"NamedSheetViewRenamedEvent",x,[]);class Za extends x{constructor(){super()}get eventId(){return 167}Xb(){this.Ob(195)}Zwa(){this.Wnb()}}Object(d.a)(Za,"NamedSheetViewSwitchedEvent",x,[]);class gb extends x{constructor(){super()}get eventId(){return 99}Xb(){this.Ob(174)}}Object(d.a)(gb,"OutlineLevelSetEvent",x,[]);class mb extends x{constructor(){super()}get eventId(){return 156}Xb(){this.Ob(244)}}
Object(d.a)(mb,"PageBreakInsertedEvent",x,[]);class Ga extends x{constructor(){super()}get eventId(){return 157}Xb(){this.Ob(245)}}Object(d.a)(Ga,"PageBreakRemovedEvent",x,[]);class ib extends x{constructor(){super()}get eventId(){return 158}Xb(){this.Ob(246)}}Object(d.a)(ib,"PageBreaksAllResetEvent",x,[]);class cc extends x{constructor(){super()}get eventId(){return 112}Xb(){this.Ob(503)}hg(){this.kd(P=>!!P.pasteParameters.ClientEstimationFloatingObjectId&&2===P.pasteParameters.CopyPasteTargetType&&
!P.isFromCurrentSession)}}Object(d.a)(cc,"PasteArtOtherWorkbookEvent",x,[]);class ic extends x{constructor(){super()}get eventId(){return 52}Xb(){this.Ob(503)}hg(){this.kd(P=>!!P.pasteParameters.ClientEstimationFloatingObjectId&&2===P.pasteParameters.CopyPasteTargetType&&P.isFromCurrentSession)}}Object(d.a)(ic,"PasteArtSameWorkbookEvent",x,[]);class xb extends x{constructor(){super()}get eventId(){return 110}Xb(){this.Ob(204)}}Object(d.a)(xb,"PasteHtmlEvent",x,[]);class Vb extends x{constructor(){super()}get eventId(){return 35}Xb(){this.Ob(506)}}
Object(d.a)(Vb,"PasteRangeEvent",x,[]);class wb extends x{constructor(){super()}get eventId(){return 111}Xb(){this.Ob(503)}hg(){this.kd(P=>1===P.pasteParameters.CopyPasteTargetType)}}Object(d.a)(wb,"PasteShadowWorkbookRangeEvent",x,[]);class cb extends x{constructor(){super()}get eventId(){return 42}Xb(){this.Ob(180)}}Object(d.a)(cb,"PasteStringEvent",x,[]);class lb extends x{constructor(){super()}get eventId(){return 134}Xb(){this.Ob(220)}}Object(d.a)(lb,"PendingMergeEvent",x,[]);class Y extends x{constructor(){super()}get eventId(){return 122}Xb(){this.Ob(510)}}
Object(d.a)(Y,"PictureInsertedEvent",x,[]);class Oa extends x{constructor(){super()}get eventId(){return 153}Xb(){this.Ob(161)}}Object(d.a)(Oa,"PivotDrillToggledEvent",x,[]);class Wa extends x{constructor(P,Ta){super();this.Gfa=P;this.opType=Ta}get eventId(){return this.Gfa}Xb(){this.Ob(225)}hg(){this.kd(P=>P.opType===this.opType)}}Object(d.a)(Wa,"PivotTableSettingsChangedEventBase",x,[]);class Ca extends Wa{constructor(){super(171,4)}}Object(d.a)(Ca,"PivotTableAllItemLabelsRepeatedEvent",Wa,[]);
class Ra extends Wa{constructor(){super(184,17)}}Object(d.a)(Ra,"PivotTableAltTextDescriptionChangedEvent",Wa,[]);class la extends Wa{constructor(){super(183,16)}}Object(d.a)(la,"PivotTableAltTextTitleChangedEvent",Wa,[]);class ua extends Wa{constructor(){super(173,6)}}Object(d.a)(ua,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",Wa,[]);class xa extends Wa{constructor(){super(172,5)}}Object(d.a)(xa,"PivotTableBlankLineAfterEachItemToggledEvent",Wa,[]);class fb extends Wa{constructor(){super(170,
3)}}Object(d.a)(fb,"PivotTableColumnGrandTotalShownEvent",Wa,[]);class Jb extends x{constructor(){super()}get eventId(){return 98}Xb(){this.Ob(132)}}Object(d.a)(Jb,"PivotTableCreatedEvent",x,[]);class Ob extends Wa{constructor(){super(177,10)}}Object(d.a)(Ob,"PivotTableDisplayErrorStringToggledEvent",Wa,[]);class eb extends Wa{constructor(){super(178,11)}}Object(d.a)(eb,"PivotTableDisplayNullStringToggledEvent",Wa,[]);class Ma extends Wa{constructor(){super(179,12)}}Object(d.a)(Ma,"PivotTableErrorStringChangedEvent",
Wa,[]);class va extends Wa{constructor(){super(174,7)}}Object(d.a)(va,"PivotTableExpandCollapseButtonsShownEvent",Wa,[]);class Pa extends Wa{constructor(){super(187,20)}}Object(d.a)(Pa,"PivotTableIndentChangedEvent",Wa,[]);class Ha extends Wa{constructor(){super(176,9)}}Object(d.a)(Ha,"PivotTableItemsWithNoDataOnColumnsShownEvent",Wa,[]);class tb extends Wa{constructor(){super(175,8)}}Object(d.a)(tb,"PivotTableItemsWithNoDataOnRowsShownEvent",Wa,[]);class Ya extends Wa{constructor(){super(186,19)}}
Object(d.a)(Ya,"PivotTableLayoutTypeSetEvent",Wa,[]);class V extends Wa{constructor(){super(180,13)}}Object(d.a)(V,"PivotTableNullStringChangedEvent",Wa,[]);class za extends x{constructor(){super()}get eventId(){return 149}Xb(){this.Ob(219)}}Object(d.a)(za,"PivotTablePivotLocationChangedEvent",x,[]);class yb extends x{constructor(){super()}get eventId(){return 102}Xb(){this.Ob(145)}}Object(d.a)(yb,"PivotTablePivotedEvent",x,[]);class jc extends Wa{constructor(){super(182,15)}}Object(d.a)(jc,"PivotTableRefreshDataOnLoadToggledEvent",
Wa,[]);class Cc extends x{constructor(){super()}get eventId(){return 104}Xb(){this.Ob(50)}hg(){this.kd(P=>!!P.pivotTableId&&!!P.pivotTableName)}}Object(d.a)(Cc,"PivotTableRefreshedEvent",x,[]);class Sa extends Wa{constructor(){super(168,1)}}Object(d.a)(Sa,"PivotTableRenamedEvent",Wa,[]);class na extends Wa{constructor(){super(169,2)}}Object(d.a)(na,"PivotTableRowGrandTotalShownEvent",Wa,[]);class jb extends Wa{constructor(){super(181,14)}}Object(d.a)(jb,"PivotTableSaveSourceDataWithFileToggledEvent",
Wa,[]);var Ib=a(606);class dc extends x{constructor(){super()}get eventId(){return 155}Xb(){this.Ob(131)}hg(){this.kd(P=>{P=Object(N.a)(Ib.a,P);return!!P&&!!P.XKa()&&!!P.hierarchyName})}}Object(d.a)(dc,"PivotTableSortedEvent",x,[]);class ob extends Wa{constructor(){super(185,18)}}Object(d.a)(ob,"PivotTableSubTotalsVisibilitySettingSetEvent",Wa,[]);class Fa extends x{constructor(){super()}get eventId(){return 206}Xb(){this.Ob(560)}}Object(d.a)(Fa,"PivotValueFieldSettingAppliedEvent",x,[]);class Ab extends x{constructor(){super()}get eventId(){return 161}Xb(){this.Ob(243)}}
Object(d.a)(Ab,"PrintAreaClearedEvent",x,[]);class $b extends x{constructor(){super()}get eventId(){return 159}Xb(){this.Ob(241)}hg(){this.kd(P=>!P.addToPrintArea)}}Object(d.a)($b,"PrintAreaSetEvent",x,[]);class Cb extends x{constructor(){super()}get eventId(){return 57}Xb(){this.Ob(517)}}Object(d.a)(Cb,"RangeAutoFilterClearedEvent",x,[]);class Rb extends x{constructor(P,Ta){super();this.Gfa=P;this.u1d=Ta}get eventId(){return this.Gfa}Xb(){this.Ob(11)}hg(){this.kd(P=>16===P.MZ().ValidMembers);this.kd(P=>
P.MZ().Font.ValidMembers===this.u1d)}}Object(d.a)(Rb,"RangeFontFormattedEventBase",x,[]);class uc extends Rb{constructor(){super(3,4)}}Object(d.a)(uc,"RangeBoldedEvent",Rb,[]);class nb extends x{constructor(){super()}get eventId(){return 2}Xb(){this.Ob(11)}hg(){this.kd(P=>128===P.MZ().ValidMembers)}}Object(d.a)(nb,"RangeBorderedEvent",x,[]);class Fb{}Fb.wab="Table";Fb.wqc="Sheet";Object(d.a)(Fb,"MacroRecorderEventConstants",null,[]);class Jc extends x{constructor(){super()}get eventId(){return 113}Xb(){this.Ob(208)}hg(){this.kd(P=>
P.getParameters().FilterType===Fb.wqc)}}Object(d.a)(Jc,"RangeCheckedItemsFilteredEvent",x,[]);class Fc extends x{constructor(){super()}get eventId(){return 109}Xb(){this.Ob(105)}}Object(d.a)(Fc,"RangeConditionalFormattingCreatedEvent",x,[]);class zb extends x{constructor(){super()}get eventId(){return 124}Xb(){this.Ob(221)}}Object(d.a)(zb,"RangeConditionalFormattingRuleDeletedEvent",x,[]);class hb extends x{constructor(){super()}get eventId(){return 29}Xb(){this.Ob(508)}hg(){this.kd(P=>3===P.us()||
1===P.us()||4===P.us())}}Object(d.a)(hb,"RangeContentClearedEvent",x,[]);class Pb extends x{constructor(){super()}get eventId(){return 40}Xb(){this.Ob(104)}}Object(d.a)(Pb,"RangeCopiedCutCellsInsertedEvent",x,[]);class ud extends x{constructor(){super()}get eventId(){return 114}Xb(){this.Ob(209)}hg(){this.kd(P=>P.getParameters().FilterType===Fb.wqc)}}Object(d.a)(ud,"RangeCustomFilteredEvent",x,[]);class Ub extends x{constructor(){super()}get eventId(){return 106}Xb(){this.Ob(121)}}Object(d.a)(Ub,
"RangeDataValidationChangedEvent",x,[]);class Ac extends Rb{constructor(){super(4,64)}}Object(d.a)(Ac,"RangeDoubleUnderlinedEvent",Rb,[]);class Ic extends x{constructor(){super()}get eventId(){return 69}Xb(){this.Ob(190)}}Object(d.a)(Ic,"RangeDuplicatesRemovedEvent",x,[]);class dd extends x{constructor(){super()}get eventId(){return 1}Xb(){this.Ob(527);this.Ob(12)}}Object(d.a)(dd,"RangeEditedEvent",x,[]);class Ud extends x{constructor(){super()}get eventId(){return 164}Xb(){this.Ob(255)}hg(){this.kd(P=>
4===P.actionType)}}Object(d.a)(Ud,"RangeExternalLinksBrokeAllLinksEvent",x,[]);class Hd extends x{constructor(){super()}get eventId(){return 119}Xb(){this.Ob(255)}hg(){this.kd(P=>3===P.actionType)}}Object(d.a)(Hd,"RangeExternalLinksBrokeLinkEvent",x,[]);class me extends x{constructor(){super()}get eventId(){return 205}Xb(){this.Ob(256)}Zwa(){this.Eoe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(d.a)(me,"RangeExternalLinksChangeSourceEvent",x,[]);class xe extends x{constructor(){super()}get eventId(){return 163}Xb(){this.Ob(553)}hg(){this.kd(P=>
1===P.actionType)}}Object(d.a)(xe,"RangeExternalLinksRefreshedAllEvent",x,[]);class Ke extends x{constructor(){super()}get eventId(){return 77}Xb(){this.Ob(553)}hg(){this.kd(P=>0===P.actionType)}}Object(d.a)(Ke,"RangeExternalLinksRefreshedEvent",x,[]);class vd extends x{constructor(){super()}get eventId(){return 165}Xb(){this.Ob(224)}}Object(d.a)(vd,"RangeExternalLinksSetAutoRefreshEvent",x,[]);class Qe extends x{constructor(){super()}get eventId(){return 5}Xb(){this.Ob(11)}hg(){this.kd(P=>64===P.MZ().ValidMembers)}}
Object(d.a)(Qe,"RangeFillColoredEvent",x,[]);class bc extends x{constructor(){super()}get eventId(){return 59}Xb(){this.Ob(155)}}Object(d.a)(bc,"RangeFilledEvent",x,[]);class Zc extends x{constructor(){super()}get eventId(){return 115}Xb(){this.Ob(176)}hg(){this.kd(P=>P.cV().AutoFilterType===Fb.wqc&&!!P.cV().CriteriaType)}}Object(d.a)(Zc,"RangeFilterAppliedEvent",x,[]);class gd extends x{constructor(){super()}get eventId(){return 58}Xb(){this.Ob(176)}hg(){this.kd(P=>P.cV().AutoFilterType===Fb.wqc&&
!P.cV().CriteriaType)}}Object(d.a)(gd,"RangeFilterClearedEvent",x,[]);class Sc extends x{constructor(){super()}get eventId(){return 41}Xb(){this.Ob(518)}}Object(d.a)(Sc,"RangeFilterReappliedEvent",x,[]);class Gd extends x{constructor(){super()}get eventId(){return 86}Xb(){this.Ob(150)}}Object(d.a)(Gd,"RangeFlashFilledEvent",x,[]);class Vd extends Rb{constructor(){super(6,32)}}Object(d.a)(Vd,"RangeFontColoredEvent",Rb,[]);class Ed extends Rb{constructor(){super(7,8)}}Object(d.a)(Ed,"RangeFontItalicizedEvent",
Rb,[]);class Od extends Rb{constructor(){super(8,1)}}Object(d.a)(Od,"RangeFontNamedEvent",Rb,[]);class se extends Rb{constructor(){super(9,2)}}Object(d.a)(se,"RangeFontSizedEvent",Rb,[]);class Le extends x{constructor(){super()}get eventId(){return 74}Xb(){this.Ob(215)}}Object(d.a)(Le,"RangeFormattedAsTableEvent",x,[]);class Id extends x{constructor(){super()}get eventId(){return 97}Xb(){this.Ob(188)}}Object(d.a)(Id,"RangeGroupedOrUngroupedEvent",x,[]);class fe extends x{constructor(){super()}get eventId(){return 60}Xb(){this.Ob(11)}hg(){this.kd(P=>
2===P.MZ().ValidMembers)}}Object(d.a)(fe,"RangeHorizontallyAlignedEvent",x,[]);class Yd extends x{constructor(){super()}get eventId(){return 43}Xb(){this.Ob(526)}}Object(d.a)(Yd,"RangeHyperlinkAppliedEvent",x,[]);class Ce extends x{constructor(){super()}get eventId(){return 63}Xb(){this.Ob(11)}hg(){this.kd(P=>256===P.MZ().ValidMembers)}}Object(d.a)(Ce,"RangeIndentChangedEvent",x,[]);class ye extends x{constructor(){super()}get eventId(){return 53}Xb(){this.Ob(156)}hg(){this.kd(P=>2===P.us()||5===
P.us()||6===P.us()||7===P.us())}}Object(d.a)(ye,"RangeMergedEvent",x,[]);class Ae extends x{constructor(){super()}get eventId(){return 107}Xb(){this.Ob(216)}}Object(d.a)(Ae,"RangeNamedCellStyleAppliedEvent",x,[]);class He extends x{constructor(){super()}get eventId(){return 12}Xb(){this.Ob(11)}hg(){this.kd(P=>32===P.MZ().ValidMembers)}}Object(d.a)(He,"RangeNumberFormattedEvent",x,[]);var gf=a(955);class Xe extends x{constructor(){super()}get eventId(){return 108}Xb(){this.Ob(141)}hg(){this.kd(P=>
Object(U.a)(gf.a,P))}}Object(d.a)(Xe,"RangeSortedEvent",x,[]);class $a extends Rb{constructor(){super(10,128)}}Object(d.a)($a,"RangeStrikedThroughEvent",Rb,[]);class ac extends Rb{constructor(){super(11,16)}}Object(d.a)(ac,"RangeUnderlinedEvent",Rb,[]);class Da extends x{constructor(){super()}get eventId(){return 61}Xb(){this.Ob(11)}hg(){this.kd(P=>1===P.MZ().ValidMembers)}}Object(d.a)(Da,"RangeVerticallyAlignedEvent",x,[]);class Na extends x{constructor(){super()}get eventId(){return 62}Xb(){this.Ob(11)}hg(){this.kd(P=>
8===P.MZ().ValidMembers)}}Object(d.a)(Na,"RangeWrapTextToggledEvent",x,[]);class sb extends x{constructor(){super()}get eventId(){return 103}Xb(){this.Ob(51)}}Object(d.a)(sb,"RefreshedAllEvent",x,[]);class Kb extends x{constructor(){super()}get eventId(){return 47}Xb(){this.Ob(148)}}Object(d.a)(Kb,"ReplaceAllEvent",x,[]);class Yb extends x{constructor(){super()}get eventId(){return 91}Xb(){this.Ob(532)}hg(){this.kd(P=>95!==P.getShapeType()&&96!==P.getShapeType()&&97!==P.getShapeType()&&98!==P.getShapeType()&&
100!==P.getShapeType()&&102!==P.getShapeType()&&103!==P.getShapeType())}}Object(d.a)(Yb,"ShapeInsertedEvent",x,[]);class vc extends x{constructor(){super()}get eventId(){return 92}Xb(){this.Ob(531)}}Object(d.a)(vc,"ShapeStyleSetEvent",x,[]);var ad=a(815);class ld extends x{constructor(P,Ta){super();this.Gfa=P;this.u1d=Ta}get eventId(){return this.Gfa}Xb(){this.Ob(581)}hg(){this.kd(P=>Object(U.a)(ad.a,P)&&4===P.getShapeTextFormat().ValidMembers);this.kd(P=>Object(U.a)(ad.a,P)&&P.getShapeTextFormat().Font.ValidMembers===
this.u1d)}}Object(d.a)(ld,"ShapeTextFontFormattedEventBase",x,[]);class md extends ld{constructor(){super(193,4)}}Object(d.a)(md,"ShapeTextBoldedEvent",ld,[]);var Qd=a(957);class ce extends x{constructor(){super()}get eventId(){return 191}Xb(){this.Ob(581)}hg(){this.kd(P=>Object(U.a)(Qd.a,P))}}Object(d.a)(ce,"ShapeTextChangedEvent",x,[]);class ec extends ld{constructor(){super(196,32)}}Object(d.a)(ec,"ShapeTextFontColorChangedEvent",ld,[]);class Vc extends ld{constructor(){super(197,1)}}Object(d.a)(Vc,
"ShapeTextFontNameChangedEvent",ld,[]);class td extends ld{constructor(){super(198,2)}}Object(d.a)(td,"ShapeTextFontSizeChangedEvent",ld,[]);class he extends x{constructor(){super()}get eventId(){return 199}Xb(){this.Ob(581)}hg(){this.kd(P=>Object(U.a)(ad.a,P)&&2===P.getShapeTextFormat().ValidMembers)}}Object(d.a)(he,"ShapeTextHorizontallyAlignedEvent",x,[]);class ne extends ld{constructor(){super(194,8)}}Object(d.a)(ne,"ShapeTextItalicizedEvent",ld,[]);class Te extends ld{constructor(){super(195,
16)}}Object(d.a)(Te,"ShapeTextUnderlinedEvent",ld,[]);class Me extends x{constructor(){super()}get eventId(){return 200}Xb(){this.Ob(581)}hg(){this.kd(P=>Object(U.a)(ad.a,P)&&1===P.getShapeTextFormat().ValidMembers)}}Object(d.a)(Me,"ShapeTextVerticallyAlignedEvent",x,[]);class Ye extends x{constructor(){super()}get eventId(){return 13}Xb(){this.Ob(138)}}Object(d.a)(Ye,"SheetAddedEvent",x,[]);var pf=a(8);class Be extends x{constructor(){super()}get eventId(){return 142}Xb(){this.Ob(237)}hg(){this.kd(P=>
!!P.insertDeleteMultiRangeParameters);this.kd(P=>!P.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(P=>{P=P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>P.DeltaColumn&&!P.DeltaRow&&(!!P.InsertDeleteRange.FirstRow||P.InsertDeleteRange.LastRow!==pf.a.Lz)||!P.DeltaColumn&&0>P.DeltaRow&&(!!P.InsertDeleteRange.FirstColumn||P.InsertDeleteRange.LastColumn!==pf.a.Qw)})}}Object(d.a)(Be,"SheetCellsDeletedEvent",x,[]);class Ie extends x{constructor(){super()}get eventId(){return 143}Xb(){this.Ob(237)}hg(){this.kd(P=>
!!P.insertDeleteMultiRangeParameters);this.kd(P=>!P.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(P=>{P=P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<P.DeltaColumn&&!P.DeltaRow&&(!!P.InsertDeleteRange.FirstRow||P.InsertDeleteRange.LastRow!==pf.a.Lz)||!P.DeltaColumn&&0<P.DeltaRow&&(!!P.InsertDeleteRange.FirstColumn||P.InsertDeleteRange.LastColumn!==pf.a.Qw)})}}Object(d.a)(Ie,"SheetCellsInsertedEvent",x,[]);class Hf extends x{constructor(){super()}get eventId(){return 139}Xb(){this.Ob(237)}hg(){this.kd(P=>
!!P.insertDeleteMultiRangeParameters);this.kd(P=>!P.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(P=>0>P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(P=>P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===pf.a.Lz)}}Object(d.a)(Hf,"SheetColumnDeletedEvent",
x,[]);class Ne extends x{constructor(){super()}get eventId(){return 138}Xb(){this.Ob(237)}hg(){this.kd(P=>!!P.insertDeleteMultiRangeParameters);this.kd(P=>!P.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(P=>0<P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(P=>P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
pf.a.Lz)}}Object(d.a)(Ne,"SheetColumnInsertedEvent",x,[]);class Je extends x{constructor(){super()}get eventId(){return 14}Xb(){this.Ob(137)}}Object(d.a)(Je,"SheetDeletedEvent",x,[]);class Jf extends x{constructor(){super()}get eventId(){return 137}Xb(){this.Ob(185)}}Object(d.a)(Jf,"SheetDirectionChangedEvent",x,[]);class Ue extends x{constructor(){super()}get eventId(){return 54}Xb(){this.Ob(139)}}Object(d.a)(Ue,"SheetDuplicatedEvent",x,[]);class ab extends x{constructor(){super()}get eventId(){return 15}Xb(){this.Ob(207)}}
Object(d.a)(ab,"SheetNameEditedEvent",x,[]);class Nb extends x{constructor(){super()}get eventId(){return 90}Xb(){this.Ob(151)}}Object(d.a)(Nb,"SheetPaneFrozenEvent",x,[]);class tc extends x{constructor(){super()}get eventId(){return 120}Xb(){this.Ob(226)}}Object(d.a)(tc,"SheetPrintSettingsSavedEvent",x,[]);var Nc=a(855);class pd extends x{constructor(){super()}get eventId(){return 215}Xb(){this.Ob(507)}Zwa(){this.Eoe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}hg(){this.kd(P=>Object.getType(P)===
Nc.a)}}Object(d.a)(pd,"SheetProtectionPausedResumedEvent",x,[]);class zd extends x{constructor(){super()}get eventId(){return 64}Xb(){this.Ob(557)}}Object(d.a)(zd,"SheetReorderedEvent",x,[]);class Sd extends x{constructor(){super()}get eventId(){return 141}Xb(){this.Ob(237)}hg(){this.kd(P=>!!P.insertDeleteMultiRangeParameters);this.kd(P=>!P.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(P=>0>P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(P=>P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===pf.a.Qw)}}Object(d.a)(Sd,"SheetRowDeletedEvent",x,[]);class ke extends x{constructor(){super()}get eventId(){return 140}Xb(){this.Ob(237)}hg(){this.kd(P=>!!P.insertDeleteMultiRangeParameters);this.kd(P=>!P.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.kd(P=>0<P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(P=>P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===pf.a.Qw)}}Object(d.a)(ke,"SheetRowInsertedEvent",x,[]);class ie extends x{constructor(){super()}get eventId(){return 39}Xb(){this.Ob(135)}}Object(d.a)(ie,"SheetRowsColumnsAutoFitEvent",x,[]);class Fe extends x{constructor(){super()}get eventId(){return 36}Xb(){this.Ob(136)}}
Object(d.a)(Fe,"SheetRowsColumnsResizedEvent",x,[]);class qc extends x{constructor(){super()}get eventId(){return 68}Xb(){this.Ob(183)}}Object(d.a)(qc,"SheetShowGridlinesToggledEvent",x,[]);class Uc extends x{constructor(){super()}get eventId(){return 67}Xb(){this.Ob(184)}}Object(d.a)(Uc,"SheetShowHeadingsToggledEvent",x,[]);class ub extends x{constructor(){super()}get eventId(){return 89}Xb(){this.Ob(213)}}Object(d.a)(ub,"SheetSpellCheckedEvent",x,[]);class Xb extends x{constructor(){super()}get eventId(){return 70}Xb(){this.Ob(515)}}
Object(d.a)(Xb,"SheetTabColoredEvent",x,[]);class wc extends x{constructor(){super()}get eventId(){return 71}Xb(){this.Ob(157)}}Object(d.a)(wc,"SheetVisibilityChangedEvent",x,[]);class Tc extends x{constructor(){super()}get eventId(){return 126}Xb(){this.Ob(239)}}Object(d.a)(Tc,"SheetsVisibilityChangedEvent",x,[]);class sd extends x{constructor(){super()}get eventId(){return 188}Xb(){this.Ob(203)}}Object(d.a)(sd,"SlicerInsertedEvent",x,[]);class qb extends x{constructor(){super()}get eventId(){return 189}Xb(){this.Ob(173)}hg(){this.kd(P=>
!P.clearFilter)}}Object(d.a)(qb,"SlicerSelectionAppliedEvent",x,[]);class Sb extends x{constructor(){super()}get eventId(){return 190}Xb(){this.Ob(173)}hg(){this.kd(P=>P.clearFilter)}}Object(d.a)(Sb,"SlicerSelectionClearedEvent",x,[]);class mc extends x{constructor(){super()}get eventId(){return 27}Xb(){this.Ob(208)}hg(){this.kd(P=>P.getParameters().FilterType===Fb.wab)}}Object(d.a)(mc,"TableCheckedItemsFilteredEvent",x,[]);class Lc extends x{constructor(){super()}get eventId(){return 144}Xb(){this.Ob(237)}hg(){this.kd(P=>
!!P.insertDeleteMultiRangeParameters);this.kd(P=>P.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(P=>0>P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Lc,"TableColumnDeletedEvent",x,[]);class rd extends x{constructor(){super()}get eventId(){return 145}Xb(){this.Ob(237)}hg(){this.kd(P=>!!P.insertDeleteMultiRangeParameters);this.kd(P=>P.insertDeleteMultiRangeParameters.IsTableCommand);
this.kd(P=>0<P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(rd,"TableColumnInsertedEvent",x,[]);var Z=a(956);class db extends x{constructor(){super()}get eventId(){return 121}Xb(){this.Ob(141)}hg(){this.kd(P=>Object(U.a)(Z.a,P))}}Object(d.a)(db,"TableColumnSortedEvent",x,[]);class Lb extends x{constructor(){super()}get eventId(){return 105}Xb(){this.Ob(193)}}Object(d.a)(Lb,"TableConvertedToRangeEvent",
x,[]);class hc extends x{constructor(){super()}get eventId(){return 16}Xb(){this.Ob(206)}}Object(d.a)(hc,"TableCreatedEvent",x,[]);class Pc extends x{constructor(){super()}get eventId(){return 30}Xb(){this.Ob(209)}hg(){this.kd(P=>P.getParameters().FilterType===Fb.wab)}}Object(d.a)(Pc,"TableCustomFilteredEvent",x,[]);class Rc extends x{constructor(){super()}get eventId(){return 25}Xb(){this.Ob(187)}hg(){this.kd(P=>1===P.options.OperationType)}}Object(d.a)(Rc,"TableCustomSortedEvent",x,[]);class xd extends x{constructor(){super()}get eventId(){return 28}Xb(){this.Ob(176)}hg(){this.kd(P=>
P.cV().AutoFilterType===Fb.wab);this.kd(P=>0===P.cV().CriteriaType)}}Object(d.a)(xd,"TableFilterClearedEvent",x,[]);class Wd extends x{constructor(){super()}get eventId(){return 32}Xb(){this.Ob(176)}hg(){this.kd(P=>P.cV().AutoFilterType===Fb.wab);this.kd(P=>{const Ta=new m.a;Ta.add(1);Ta.add(2);Ta.add(8);Ta.add(9);Ta.add(10);Ta.add(11);Ta.add(12);Ta.add(13);Ta.add(14);Ta.add(15);Ta.add(16);Ta.add(17);Ta.add(18);Ta.add(19);Ta.add(20);Ta.add(21);Ta.add(22);Ta.add(23);Ta.add(24);Ta.add(25);Ta.add(26);
Ta.add(27);Ta.add(28);Ta.add(29);Ta.add(30);Ta.add(31);Ta.add(32);Ta.add(33);Ta.add(34);Ta.add(35);Ta.add(36);Ta.add(37);Ta.add(38);Ta.add(39);return Ta.contains(P.cV().CriteriaType)})}}Object(d.a)(Wd,"TableItemFilteredEvent",x,[]);class ue extends x{constructor(){super()}get eventId(){return 101}Xb(){this.Ob(217)}}Object(d.a)(ue,"TableRenamedEvent",x,[]);class ve extends x{constructor(){super()}get eventId(){return 73}Xb(){this.Ob(211)}}Object(d.a)(ve,"TableResizedEvent",x,[]);class qe extends x{constructor(){super()}get eventId(){return 44}Xb(){this.Ob(514)}}
Object(d.a)(qe,"TableRowColumnRearrangedEvent",x,[]);class we extends x{constructor(){super()}get eventId(){return 146}Xb(){this.Ob(237)}hg(){this.kd(P=>!!P.insertDeleteMultiRangeParameters);this.kd(P=>P.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(P=>0>P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(we,"TableRowDeletedEvent",x,[]);class Ze extends x{constructor(){super()}get eventId(){return 147}Xb(){this.Ob(237)}hg(){this.kd(P=>
!!P.insertDeleteMultiRangeParameters);this.kd(P=>P.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(P=>!P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(P=>0<P.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Ze,"TableRowInsertedEvent",x,[]);class zf extends x{constructor(){super()}get eventId(){return 26}Xb(){this.Ob(177)}hg(){this.kd(P=>P.cV().AutoFilterType===Fb.wab)}}Object(d.a)(zf,"TableSortedEvent",x,[]);class Ja extends x{constructor(){super()}get eventId(){return 87}Xb(){this.Ob(212)}}
Object(d.a)(Ja,"TableStyleAppliedEvent",x,[]);class Eb extends x{constructor(){super()}get eventId(){return 88}Xb(){this.Ob(196)}}Object(d.a)(Eb,"TableStyleOptionToggledEvent",x,[]);class zc extends x{constructor(){super()}get eventId(){return 31}Xb(){this.Ob(210)}hg(){this.kd(P=>P.getParameters().FilterType===Fb.wab)}}Object(d.a)(zc,"TableTop10FilteredEvent",x,[]);class bd extends x{constructor(){super()}get eventId(){return 207}Xb(){this.Ob(238)}}Object(d.a)(bd,"TextToColumnsEvent",x,[]);class yd extends x{constructor(){super()}get eventId(){return 128}Xb(){this.Ob(559)}}
Object(d.a)(yd,"ValuesSortedEvent",x,[]);class Nd extends x{constructor(){super()}get eventId(){return 55}Xb(){this.Ob(197)}}Object(d.a)(Nd,"WorkbookCalculationModeSetEvent",x,[]);class je extends x{constructor(){super()}get eventId(){return 34}Xb(){this.Ob(181)}hg(){this.kd(P=>!!P.parentCommentId)}}Object(d.a)(je,"WorkbookCommentRepliedEvent",x,[]);class le extends x{constructor(){super()}get eventId(){return 33}Xb(){this.Ob(181)}hg(){this.kd(P=>!P.parentCommentId)}}Object(d.a)(le,"WorkbookCommentedEvent",
x,[]);class bf extends x{constructor(){super()}get eventId(){return 56}Xb(){this.Ob(128)}}Object(d.a)(bf,"WorkbookRecalculatedEvent",x,[]);class De extends x{constructor(){super()}get eventId(){return 46}Xb(){this.Ob(171)}}Object(d.a)(De,"WorkbookRedoEvent",x,[]);class sf extends x{constructor(){super()}get eventId(){return 45}Xb(){this.Ob(170)}}Object(d.a)(sf,"WorkbookUndoEvent",x,[]);class uf extends x{constructor(){super()}get eventId(){return 116}Xb(){this.Ob(507);this.Ob(576);this.Ob(10)}hg(){this.kd(P=>
{if(Object(U.a)(X,P)&&(P=Object(N.a)(X,P),void 0!==P.source&&null!==P.source&&void 0!==P.eventId&&null!==P.eventId))return n.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${P.source}; eventId: ${P.eventId}.`),!0;n.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(d.a)(uf,"DefaultRichApiRequestExecutedEvent",x,[]);class Ee extends x{constructor(){super()}get eventId(){return 216}Xb(){this.Ob(1022)}}
Object(d.a)(Ee,"TablelAltTextEditedEvent",x,[]);class Lf extends x{constructor(){super()}get eventId(){return 217}Xb(){this.Ob(263)}}Object(d.a)(Lf,"FloatingObjectZOrderChangedEvent",x,[]);var Mf=a(958);class tg extends x{constructor(){super()}get eventId(){return 192}Xb(){this.Ob(507)}hg(){this.kd(P=>Object(U.a)(Mf.a,P)?!0:!1)}}Object(d.a)(tg,"VisualPropertySetEvent",x,[]);class Gg extends O{constructor(){super(219,[510])}}Object(d.a)(Gg,"ChartSeriesDeletedEvent",O,[]);class cg extends x{get eventId(){return 220}Xb(){this.Ob(1027)}}
Object(d.a)(cg,"ChartDataChangedEvent",x,[]);class Xa extends O{constructor(){super(221,[512])}}Object(d.a)(Xa,"ChartSeriesDataChangedEvent",O,[]);class Bb{constructor(P){this.yb=null;this.$=P}get macroRecorderEvents(){this.yb||(this.yb=new m.a,this.yb.add(new dd),this.yb.add(new nb),this.yb.add(new uc),this.yb.add(new Ac),this.yb.add(new Qe),this.yb.add(new Vd),this.yb.add(new Ed),this.yb.add(new Od),this.yb.add(new se),this.yb.add(new $a),this.yb.add(new ac),this.yb.add(new He),this.yb.add(new Ye),
this.yb.add(new Je),this.yb.add(new ab),this.yb.add(new hc),this.yb.add(new Lc),this.yb.add(new rd),this.yb.add(new we),this.yb.add(new Ze),this.yb.add(new Ne),this.yb.add(new Hf),this.yb.add(new ke),this.yb.add(new Sd),this.yb.add(new Rc),this.yb.add(new zf),this.yb.add(new mc),this.yb.add(new xd),this.yb.add(new hb),this.yb.add(new Pc),this.yb.add(new zc),this.yb.add(new Wd),this.yb.add(new le),this.yb.add(new je),this.yb.add(new Vb),this.yb.add(new Fe),this.yb.add(new Be),this.yb.add(new Ie),this.yb.add(new ie),
this.yb.add(new Pb),this.yb.add(new Sc),this.yb.add(new Yd),this.yb.add(new cb),this.yb.add(new qe),this.yb.add(new De),this.yb.add(new sf),this.yb.add(new Kb),this.yb.add(new Ia),this.yb.add(new ic),this.yb.add(new ye),this.yb.add(new Ue),this.yb.add(new Nd),this.yb.add(new bf),this.yb.add(new Cb),this.yb.add(new gd),this.yb.add(new bc),this.yb.add(new fe),this.yb.add(new Da),this.yb.add(new Na),this.yb.add(new Ce),this.yb.add(new zd),this.yb.add(new L),this.yb.add(new S),this.yb.add(new Uc),this.yb.add(new qc),
this.yb.add(new Ic),this.yb.add(new wc),this.yb.add(new Xb),this.yb.add(new ve),this.yb.add(new Le),this.yb.add(new K),this.yb.add(new I),this.yb.add(new Ke),this.yb.add(new ya),this.yb.add(new ea),this.yb.add(new C),this.yb.add(new oa),this.yb.add(new H),this.yb.add(new M),this.yb.add(new G),this.yb.add(new da),this.yb.add(new Gd),this.yb.add(new Ja),this.yb.add(new Eb),this.yb.add(new ub),this.yb.add(new Nb),this.yb.add(new Yb),this.yb.add(new vc),this.yb.add(new pa),this.yb.add(new ba),this.yb.add(new fa),
this.yb.add(new ra),this.yb.add(new Id),this.yb.add(new Jb),this.yb.add(new gb),this.yb.add(new Ka),this.yb.add(new ue),this.yb.add(new yb),this.yb.add(new sb),this.yb.add(new Cc),this.yb.add(new Lb),this.yb.add(new Ub),this.yb.add(new Ae),this.yb.add(new Xe),this.yb.add(new Fc),this.yb.add(new xb),this.yb.add(new wb),this.yb.add(new cc),this.yb.add(new Jc),this.yb.add(new ud),this.yb.add(new Zc),this.yb.add(new T),this.yb.add(new Y),this.yb.add(new Hd),this.yb.add(new tc),this.yb.add(new db),this.yb.add(new zb),
this.yb.add(new Tc),this.yb.add(new wa),this.yb.add(new yd),this.yb.add(new La),this.yb.add(new D),this.yb.add(new ha),this.yb.add(new qa),this.yb.add(new lb),this.yb.add(new ka),this.yb.add(new Va),this.yb.add(new Jf),this.yb.add(new bb),this.yb.add(new za),this.yb.add(new Oa),this.yb.add(new aa),this.yb.add(new dc),this.yb.add(new mb),this.yb.add(new Ga),this.yb.add(new ib),this.yb.add(new $b),this.yb.add(new J),this.yb.add(new Ab),this.yb.add(new rb),this.yb.add(new xe),this.yb.add(new Ud),this.yb.add(new vd),
this.yb.add(new ta),this.yb.add(new Za),this.yb.add(new Sa),this.yb.add(new na),this.yb.add(new fb),this.yb.add(new Ca),this.yb.add(new xa),this.yb.add(new ua),this.yb.add(new va),this.yb.add(new tb),this.yb.add(new Ha),this.yb.add(new Ob),this.yb.add(new eb),this.yb.add(new Ma),this.yb.add(new V),this.yb.add(new jb),this.yb.add(new jc),this.yb.add(new la),this.yb.add(new Ra),this.yb.add(new ob),this.yb.add(new Ya),this.yb.add(new Pa),this.yb.add(new sd),this.yb.add(new qb),this.yb.add(new Sb),this.yb.add(new ce),
this.yb.add(new md),this.yb.add(new ne),this.yb.add(new Te),this.yb.add(new ec),this.yb.add(new Vc),this.yb.add(new td),this.yb.add(new he),this.yb.add(new Me),this.yb.add(new me),this.yb.add(new Fa),this.yb.add(new bd),this.yb.add(new pd),this.yb.add(new Ee),this.yb.add(new Lf),this.yb.add(new tg),this.yb.add(new Gg),this.yb.add(new Xa),this.yb.add(new cg),z.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.zdj());return this.yb}w3e(P,Ta){let Hb=this.x3e(P,this.macroRecorderEvents,
Ta);Hb||(Hb=this.x3e(P,Bb.y4h(),Ta),!Hb&&this.Uif(P,Bb.hKe,Ta)&&(Hb=Bb.hKe));return Hb}x3e(P,Ta,Hb){const lc=new m.a;for(let xc of Ta)this.Uif(P,xc,Hb)&&lc.add(xc);return 1===lc.count?lc.na(0):1<lc.count?Bb.aNh(lc):null}Uif(P,Ta,Hb){const lc=Bb.uZi(P,Ta);return Hb?lc&&Bb.c0j(P,Ta):lc}zdj(){const P=new m.a;for(let Ta of this.yb){let Hb=!1;for(let lc of Ta.featureGates)if(!z.EwaSettings.ma(lc)){P.add(Ta);Hb=!0;break}if(!Hb)for(let lc of Ta.NVe)if(!z.EwaSettings.getBooleanFeatureGate(lc,!1)){P.add(Ta);
break}}for(let Ta of P)this.yb.remove(Ta)}static y4h(){Bb.VDb||(Bb.VDb=new m.a,Bb.VDb.add(new sa),Bb.VDb.add(new ja));return Bb.VDb}static uZi(P,Ta){return Ta.operations.contains(P.operation)}static c0j(P,Ta){Ta=Ta.nEc;if(!Ta.count)return!0;let Hb=!0;for(let lc of Ta)if(!lc(P.payload)){Hb=!1;break}return Hb}static aNh(P){let Ta=P.na(0);for(let Hb of P)Hb.nEc.count>Ta.nEc.count&&(Ta=Hb);return Ta}}Bb.VDb=null;Bb.hKe=new uf;Object(d.a)(Bb,"MacroRecorderEventList",null,[]);class Tb extends h.a{constructor(P){super();
this.$=P;this.Fb()}create(){this.ob(this.$.da.za(297)||new A(this.$,new Bb(this.$),new w))}static ka(P){P.da.Ga(298,new Tb(P))}}Object(d.a)(Tb,"MacroRecorderEventHandlerFactory",h.a,[]);var Bc=a(1146),Wc=a(1241),fd=a(7);a(558);class Dd{constructor(){this.yrg=new m.a}get x2b(){return this.yrg}sXh(P){n.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",P);const Ta=new m.a;for(let Hb of this.x2b)for(let lc of Hb.kFb)lc.id===P&&Ta.add(lc);return Ta}qoe(P){this.x2b.add(P)}udj(P){for(let Ta of this.x2b)if(Ta.sse===
P.sse){this.x2b.remove(Ta);break}}static Jkh(P,Ta,Hb=null){P=Dd.FPh(P);0<P.length&&(Dd.Ixc(P,!1),Hb&&Hb(Ta,P))}static FPh(P){const Ta=[];if(P&&P.kFb&&0<P.kFb.count)for(let Hb of P.kFb)if(Hb.controls&&0<Hb.controls.count)for(let lc of Hb.controls)if(lc.menuItems&&0<lc.menuItems.count)for(let xc of lc.menuItems)Array.add(Ta,xc.id);return Ta}static Ixc(P,Ta){if(P.length){var Hb=[];for(const lc of P)Hb.push(appChrome.actions.updateControlEnabledDisabledState(lc,Ta));appChrome.api.dispatch(Hb)}}}Object(d.a)(Dd,
"ContextMenuExtensibilityCache",null,[728,729]);var de=a(1464),ae=a(84),nd=a(4),Ve=a(863),$e=a(813);class k{rZa(P,Ta=null){if(P=$e.a.g4a(P)){appChrome.addInApi.dispatchActionsToInstallAddIn(P,Ta);for(const Hb of P.tabs)if(Hb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(P,()=>{});break}}}hLd(P){(P=$e.a.g4a(P))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(P)}static Rkh(P,Ta,Hb=null){P=k.r_h(P);0<P.length&&(k.Ixc(P,!1),Hb&&Hb(Ta,P))}static r_h(P){const Ta=[];if(P&&(P=P.dW,P.kt&&
0<P.kt.count))for(let Hb of P.kt)if(Hb.groups&&0<Hb.groups.length)for(const lc of Hb.groups)if(lc.controls&&0<lc.controls.length)for(const xc of lc.controls)Array.add(Ta,xc.id);return Ta}static Ixc(P){if(P.length){var Ta=[];for(const Hb of P)Ta.push(appChrome.actions.updateControlEnabledDisabledState(Hb,!0));appChrome.api.dispatch(Ta)}}}Object(d.a)(k,"OneLineRibbonExtensibilityManager",null,[739]);var Qb=a(933);class sc{constructor(){this.b5d=this.KFc=null}get SUc(){return this.KFc||(this.KFc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set SUc(P){this.KFc=
P}get ySg(){return this.b5d||(this.b5d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(P,Ta){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(P,Ta)}getTaskPaneControlIdFromAssetIdRuntimeId(P,Ta){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(P,Ta)}Njd(P,Ta,Hb,lc,xc,cd=null,id=null){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",P);if((P=Ta.ija(xc.ownerAddinInfo.storeType,
xc.ownerAddinInfo.solutionId))&&P.KB&&!P.KB.getIsUpgrading())if(Ta=null,0<P.KB.getNotificationParams().length&&(Ta=this.Vxe(P.KB.getNotificationParams()[0]))&&2147758681===Ta.errorCode&&(P.isUpgraded=!0),2!==P.KB.getStatus()&&(1!==P.KB.getStatus()||Ta&&2147758681===Ta.errorCode))Ta&&this.d7f(P,Ta,id);else try{Hb.setOwnerAddinEToken(P.KB.getEToken()),xc.action(Hb,lc.$ca),cd&&cd()}catch(od){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",nd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?
od.stack:od.message)),Qb.a.bUd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}d7f(P,Ta,Hb=null){const lc=P.KB;if(1===lc.getNotificationParams().length||Ta.hfc){const xc=Ta.Hha,cd=Ta.Hia;Ta.Hha=()=>{lc.removeFirstNotification();if(0<lc.getNotificationParams().length){const id=this.Vxe(lc.getNotificationParams()[0]);this.d7f(P,id)}2147758681===Ta.errorCode&&(k.Rkh(P.So,lc,Object(ae.a)(this,this.sdf,"initUpgradeStateDetectTask")),Dd.Jkh(P.asb,lc,Object(ae.a)(this,this.sdf,
"initUpgradeStateDetectTask")));xc&&xc()};Ta.Hia=()=>{cd&&cd();Hb&&Hb()};Qb.a.dUd(Ta)}}sdf(P,Ta){let Hb=null;Hb=()=>{P.getIsUpgrading()?window.setTimeout(Hb,1E3):P.getUpgradingFailed()?k.Ixc(Ta,!0):nd.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Hb,1E3)}Vxe(P){const Ta=new Ve.a;Ta.yMa=P.infoType;Ta.id=P.id;Ta.title=P.title;Ta.description=P.description;Ta.buttonText=P.buttonTxt;Ta.Hha=P.buttonCallback;Ta.hfc=P.highPriority;Ta.Hia=P.dismissCallback;Ta.errorCode=P.errorCode;Ta.rcf=P.iframeNotificationUrl;
return Ta}}Object(d.a)(sc,"AddinCommandsActionHandler",null,[717]);var Hc=a(82),kd=a(157),Bd=a(692),Jd=a(5),$d=a(736),Aa=a(693);class Db{constructor(P,Ta){this.Va=P;this.n7g=Ta}mKh(P){if(void 0!==P&&null!==P&&P===Jd.a.nFe)P="ContextMenuCell";else return null;const Ta=this.Va.Ec();this.EJh(Ta,P);return Ta}EJh(P,Ta){Ta=this.n7g.sXh(Ta);for(let Hb of Ta){Ta=Hb.controls;for(let lc of Ta)this.rJh(P,lc)}}rJh(P,Ta){var Hb=Ta.oU[$d.a.id];const lc=Ta.oU[$d.a.qVa],xc=Ta.oU[$d.a.uVa];let cd="Image16by16",id=
Ta.oU[$d.a.rVa];Aa.c(xc)&&(cd="None");0<Ta.menuItems.count?(Hb=this.Va.tw(Hb,Hb,lc,798637440),Hb.kMb(cd,xc,null),this.kKh(Hb.menu,Ta),P.buttons.push(Hb)):P.buttons.push(this.Va.AIa(Hb,lc,id,xc,cd,null,!1))}kKh(P,Ta){const Hb=this.Va.Ec();for(let lc of Ta.menuItems){Ta=lc.Xla[$d.a.id];const xc=lc.Xla[$d.a.qVa],cd=lc.Xla[$d.a.uVa];let id="Image16by16";const od=lc.Xla[$d.a.rVa];Aa.c(cd)&&(id="None");Ta=this.Va.AIa(Ta,xc,od,cd,id,null,!1);Hb.buttons.push(Ta)}P.tc.push(Hb)}}Object(d.a)(Db,"AddInCommandsContextMenuExtensibilityHandler",
null,[735]);var Zb=a(858);class yc{constructor(){this.ui=null;this.visible=!1}}Object(d.a)(yc,"AddinStatusCommandValues",null,[]);class Mc{static A6i(P){const Ta=new yc;Ta.ui=P.LZa;Ta.visible=Ta.ui?!0:!1;return Ta}static uzc(P,Ta,Hb,lc,xc){const cd=document.getElementById(Hb);cd?Mc.SEj(P,Ta,cd,lc,xc):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Hb))}static SEj(P,Ta,Hb,lc,xc){Hb?P.LZa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Qb.a.DDj(Ta,Hb,lc,xc):P.LZa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
Qb.a.XEj(Ta,Hb):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(d.a)(Mc,"AddinCommandsStatusHandler",null,[]);var qd=a(38),Md=a(226),Td=a(13);class oe extends qd.a{constructor(P,Ta){super();this.agaveCommandManager=this.statusBarManager=null;this.jCe=()=>{this.mG&&this.mG.OBe()};this.K8e=()=>{this.raiseEvent("LAC")};this.Tc=(Hb,lc)=>{!Hb.Zb&&Md.b(lc)&&this.statusBarManager&&(this.statusBarManager.iG(this),this.statusBarManager=null)};this.mG=
Ta;this.$=P;this.ZJj=P.Eb+"OfficeAddinLabel-Medium14";this.$.da.$a(29,Hb=>{this.statusBarManager=Hb;Hb.GJ(this)});this.$.ea.Uj(this.Tc);this.mG.fJg(this.K8e);this.$.da.$a(206,Hb=>{this.agaveCommandManager=Hb;Hb.GKg(this.jCe)})}Lq(P){this.addHandler("LAC",P)}fr(P){this.removeHandler("LAC",P)}ns(P,Ta){if("QueryAddinLabel"!==P)return!1;Ta[Zb.a.LabelText]!==this.mG.LZa&&(P=Mc.A6i(this.mG),Ta[Zb.a.LabelText]=P.ui,Ta[Zb.a.Visible]=P.visible,window.setTimeout(()=>{this.uzc()},0));return!0}Gn(){return!0}uzc(){this.$&&
Mc.uzc(this.mG,this.$.domElement,this.ZJj,Td.a.instance.ga(333),Td.a.instance.ga(334))}dispose(){this.$.ea.uk(this.Tc);this.mG.Eej(this.K8e);this.agaveCommandManager&&(this.agaveCommandManager.Rfj(this.jCe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.iG(this),this.statusBarManager=null);this.mG=this.$=null;super.dispose()}}Object(d.a)(oe,"AddinCommandsStatusBarManager",qd.a,[211,212]);var Oe=a(1317),be=a(718),Ge=a(147),Ba=a(120),Ea=a(570),rc=a(135);class wd{constructor(){this.KZa=
null}setErrorMessageForAddin(P,Ta){this.KZa||(this.KZa={});this.KZa[P]=Ta}WRh(P){return this.KZa&&P in this.KZa?this.KZa[P]:null}}Object(d.a)(wd,"AddinCommandsErrorManager",null,[]);var Pd=a(333),te=a(96);class af{constructor(){this.nq=this.pO=0;this.fXc=null;this.xsc=this.YBc=0;this.Vpa=this.wKc=this.bGc=this.S4b=this.Cja=this.e$=null}get eXc(){this.bGc||(this.bGc=new m.a);return this.bGc}get zdd(){this.wKc||(this.wKc=new m.a);return this.wKc}get rIa(){this.Vpa||(this.Vpa=new m.a);return this.Vpa}}
Object(d.a)(af,"AddinCommandsListLoaderContext",null,[]);var Cf=a(817);class Of{}Object(d.a)(Of,"AppsForOfficeEntitlementQueryInfo",null,[]);var Ef=a(41);const ig=P=>{const Ta={};Ta.solutionId=P.solutionId;Ta.version=P.version;Ta.storeType=P.storeType;Ta.storeId=P.storeId;Ta.assetId=P.assetId;Ta.assetStoreId=P.assetStoreId;Ta.targetType=P.targetType;Ta.requireConsent=P.requireConsent||!1;Ta.isAddinCommands=!0;Ta.addinCommandsActionType=0;return Ta};class Wf{constructor(P,Ta){this.entitlement=P;this.metadata=
Ta}Ucg(){const P=ig(this.entitlement);P.targetType=this.targetType;return P}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}
Object(d.a)(Wf,"AddinEntitlementEx",null,[]);var og=a(256),Xf=a(30);class xg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(xg,"AddinAbstract",null,[]);class qg extends Sys.EventArgs{constructor(){super();this.So=this.qk=null}}Object(d.a)(qg,"InsertionParamEventArgs",Sys.EventArgs,[]);class Yf{constructor(P,Ta,Hb,lc=null){this.RKb=nd.AFrameworkApplication.fa.Xa("RoamingServiceHandlerWebServiceBase");this.appName=P;this.Cjb=Ta;this.yjb=Hb;this.Hlb=lc}f$b(P){this.RBh(P)}RBh(P){const Ta=
new Sys.StringBuilder(this.RKb);Ta.append("RoamingServiceHandler.ashx?action=");Ta.append("getAddinTeachingCalloutSettings");Ta.append("&");Ta.append(this.Dhd(P));Ta.append("&");Ta.append(nd.AFrameworkApplication.Ii);nd.AFrameworkApplication.Dd.Pm(Ta.toString(),1,null,null,!0,2,Object(ae.a)(this,this.dka,"getRequestSuccessCallback"),Object(ae.a)(this,this.H4,"getRequestFailureCallback"),null)}t3a(P){this.WBh(P)}WBh(P){var Ta=new Sys.StringBuilder(this.RKb);Ta.append("RoamingServiceHandler.ashx?action=");
Ta.append("saveAddinTeachingCalloutSettings");Ta.append("&");Ta.append(nd.AFrameworkApplication.Ii);Ta=Ta.toString();P=Ef.c(P);nd.AFrameworkApplication.Dd.Pm(Ta,2,P,null,!0,4,null,Object(ae.a)(this,this.rW,"postRequestFailureCallback"),null)}dka(P){let Ta=!1,Hb=null;try{if(0<P.data.ue.length){const lc=Object(N.a)(Object,Ef.a(P.data.ue)),xc=lc?lc[this.appName]:null;xc&&(Hb=Object(N.a)(Object,Ef.a(xc.toString())))}Ta=!0}catch(lc){this.H4(null)}Ta&&this.Cjb&&this.Cjb(Hb)}H4(P){this.yjb&&this.yjb(P?P.data:
null)}rW(P){this.Hlb&&this.Hlb(P?P.data:null)}Dhd(P){const Ta=new Sys.StringBuilder("requestedsettings=");for(let Hb=0;Hb<P.count;Hb++)Ta.append(P.na(Hb)),Hb<P.count-1&&Ta.append(";");return Ta.toString()}}Object(d.a)(Yf,"AddinTeachingUIRoamingRequestHandler",null,[]);class dh extends Sys.EventArgs{constructor(P){super();this.solutionId=P.solutionId;this.assetId=P.assetId;this.storeType=P.storeType;this.storeId=P.storeId;this.assetStoreId=P.assetStoreId;this.targetType=P.targetType;this.width=P.width;
this.height=P.height;this.displayName=P.displayName;this.version=P.version}}Object(d.a)(dh,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Bf=a(344);class Bg{constructor(P){this.NZa=this.qk=null;this.ORa=!1;this.Vpa=this.LRb=this.dna=this.Xh=this.LX=this.AO=null;this.Ra=P}get appName(){return nd.AFrameworkApplication.fa.Xa("WebAppShortName")}get Dob(){this.LX||(this.LX=new Yf(this.appName,Object(ae.a)(this,this.dka,"getRequestSuccessCallback"),Object(ae.a)(this,this.H4,"getRequestFailureCallback"),
Object(ae.a)(this,this.rW,"postRequestFailureCallback")));return this.LX}get rsa(){this.LRb||(this.LRb=new m.a);return this.LRb}set rsa(P){this.LRb=P}get rIa(){this.Vpa||(this.Vpa=new m.a);return this.Vpa}set rIa(P){this.Vpa=P}NVc(P,Ta){window.addEventListener?(this.qk=P,this.NZa=Ta,window.addEventListener("LaunchAddinTaskpane",Object(ae.a)(this,this.ZCd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(ae.a)(this,this.gCd,"onDismissButtonClickedEventHandler"),
!0),window.addEventListener("CloseCallout",Object(ae.a)(this,this.WBd,"onCloseButtonClickedEventHandler"),!0),nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(ae.a)(this,this.xFb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}$Qj(P,Ta,Hb,lc){this.Xh=P;this.rsa=Ta;this.rIa=Hb;this.dna=lc;n.ULS.sendTraceTag(0,
220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Ta?Ta.count.toString():"null",Hb?Hb.count.toString():"null");0<this.rsa.count||0<this.rIa.count?(P=new m.a,P.add(this.appName),this.Dob.f$b(P)):this.dna(new m.a,null)}ZCd(){const P=new og.ScriptSharpLegacyMap;this.NZa&&this.NZa.tabs&&!this.NZa.tabs[0].isOfficeTab&&P.ia("SDX.FeatureFlags","NonOfficeTab");this.Ila(Bg.iV(this.qk),"ClickOnLaunch",P);nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Ula();this.NZa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.NZa,()=>{const Ta=new qg;Ta.qk=this.qk;this.Ra.raiseEvent(be.a.Qud,Ta)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}WBd(){this.Ila(Bg.iV(this.qk),"ClickOnClose");nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Ula()}gCd(){this.Ila(Bg.iV(this.qk),"ClickOnDismiss");nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Ula()}xFb(P){if(P&&(P=P.detail)&&P.id&&this.Mod(P.id)){const Ta=(P.action||"").toLowerCase();if(P.success&&"opened"===Ta)this.Ila(Bg.iV(this.qk),"CampaignLaunched"),n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Ula(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(ae.a)(this,this.xFb,"onCampaignLaunchedHandler"),!0);else{let Hb;try{Hb=JSON.stringify(P),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+
Hb)}catch(lc){Hb="id : "+P.id+" telemetryEventName: "+P.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Hb+" Error: "+(lc?lc.toString():""))}}}}Mod(P){P=Xf.a.ul(P);return-1!==P.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==P.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==P.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==P.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==P.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==P.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}B7(P){if(this.appName){const Ta=
{},Hb={};Hb.LastTeachingUIShowTime=(new Date).toUTCString();Hb.AddinHasShown=P;Ta[this.appName]=Ef.c(Hb);this.Dob.t3a(Ta);n.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}Ula(){if(!this.ORa){const P=window.g_roamingAddinList;P&&(this.B7(P),this.ORa=!0)}}dka(P){P?this.STd(P)?(n.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),
this.AO="AddinHasShown"in P&&P.AddinHasShown?P.AddinHasShown.toString():null,this.Nrb()):(n.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.dna(this.rsa,null)):(n.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.AO=null,this.Nrb())}H4(P){n.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",P?P.httpStatus:-1);this.dna(this.rsa,null)}rW(P){n.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",
P?P.httpStatus:-1)}Nrb(){const P=this.J7c();0===P.targetType?(P.solutionId?this.iId(P):this.Ila(null,"NoSolutionId"),this.dig(P),this.dna(this.rsa,null)):this.dna(this.rsa,P);n.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",P.addinId)}iId(P){const Ta=new Of;Ta.callbackFunc=Hb=>{if(Hb.errorCode){if(this.Ila(P.solutionId,"FailToGetAppDetails"),nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var lc=window.g_roamingAddinList;
lc&&this.B7(lc)}}else if(Hb.value)for(lc of Hb.value)if(Hb=lc[1],Hb===P.solutionId){const xc={};xc.solutionId=Hb;xc.assetId=lc[5];xc.storeType=lc[12];xc.storeId=lc[11];xc.assetStoreId=lc[6];xc.targetType=lc[3];xc.width=lc[7];xc.height=lc[8];xc.displayName=lc[0];xc.version=lc[4];n.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",P.solutionId);lc=new dh(xc);this.Ra.raiseEvent(be.a.iUd,lc);break}};Ta.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ta.fromInsertDialog=!1;
Ta.refresh=!1;this.Xh.queryEntitlementDetails(Ta)}STd(P){if("LastTeachingUIShowTime"in P){if(P=+new Date-+new Date(P.LastTeachingUIShowTime.toString()),P<nd.AFrameworkApplication.fa.iN("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",P),!1}else n.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}J7c(){let P=new Pd.a(new xg,0),Ta=new Pd.a(new xg,0),Hb=0,lc=0,xc=0;var cd=new m.a;
for(var id of this.rsa)cd.add(id);for(let od of this.rIa)cd.add(od);for(let od of cd)if(!("excatalog"!==od.storeType||Aa.c(od.installTimeInMS)||!od.installTimeInMS||od.installTimeInMS<=nd.AFrameworkApplication.fa.iN("DateTimeInMSForNewAddin",16409952E5))){cd=Bg.cwb(od);if(this.AO&&(id=this.AO.split(","),0<id.length&&Array.contains(id,cd))){xc++;n.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}cd.startsWith("private_")?(P=Bg.h3e(od,P),lc++):(Ta=Bg.h3e(od,Ta),
Hb++)}n.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",lc,Hb,xc);return 0<Ta.value?Ta.key:0<P.value?P.key:Object.assign(new xg,{addinId:null,targetType:-1,solutionId:null})}Ila(P,Ta,Hb=null){P={["AppTeachingUICalloutAction"]:Ta,["SDX.Id"]:P,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Hb)for(let lc of Hb.keys)P[lc]=Hb.na(lc);Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)}))}dig(P){P&&(P=this.AO?this.AO+","+P.addinId:P.addinId,nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=P:this.B7(P))}static iV(P){return Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.storeType,P.assetId,null,null,P.storeId)}static h3e(P,Ta){return Ta.value<P.installTimeInMS?new Pd.a(Object.assign(new xg,{addinId:Bg.cwb(P),
targetType:P.targetType,solutionId:P.solutionId}),P.installTimeInMS):Ta}static cwb(P){return Telemetry.PrivacyRules.IsPrivateAddin(P.storeType,P.assetId,null,null,P.storeId)?"private_"+P.installTimeInMS:P.solutionId}}Object(d.a)(Bg,"PrivateCatalogTeachingCalloutHandler2",null,[]);var Hg=a(80);const Ig=()=>{const P=Hg.a.VZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!P&&"4"===P},Jg=()=>Hg.a.VZ(window.location.href.toLowerCase(),"wdtpl"),Cg=()=>{const P=Hg.a.VZ(window.location.href.toLowerCase(),
"wdomexsrctype");return!!P&&"1"===P},xh=P=>{let Ta=null;switch(P){case 0:Ta="omex";break;case 1:Ta="spcatalog";break;case 2:Ta="spapp";break;case 3:Ta="filesystem";break;case 4:Ta="exchange";break;case 6:Ta="registry";break;case 7:Ta="inmemory";break;case 8:Ta="uploadfiledevcatalog";break;case 9:Ta="hardcodedpreinstall";break;case 10:Ta="excatalog";break;case 16:Ta="wopicatalog"}return Ta},Yg=P=>{let Ta=-1;switch(P.toLowerCase()){case "omex":Ta=0;break;case "spcatalog":Ta=1;break;case "spapp":Ta=
2;break;case "filesystem":Ta=3;break;case "exchange":Ta=4;break;case "registry":Ta=6;break;case "inmemory":Ta=7;break;case "uploadfiledevcatalog":Ta=8;break;case "hardcodedpreinstall":Ta=9;break;case "excatalog":Ta=10;break;case "wopicatalog":Ta=16}return Ta};var Zg=a(681);class jh{constructor(P){this.Xr=null;this.EA=P}get_current(){if(!this.Xr)throw Error.argumentOutOfRange();return this.Xr.data}moveNext(){if(!this.Xr)return this.Xr=this.EA,!!this.EA;if(!this.Xr.next)return!1;this.Xr=this.Xr.next;
return!0}Vmc(){if(!this.Xr)return this.Xr=this.EA,!!this.EA;if(!this.Xr.previous)return!1;this.Xr=this.Xr.previous;return!0}reset(){this.Xr=this.EA}}Object(d.a)(jh,"ListEnumerator",null,[0]);class eh{constructor(P,Ta,Hb){this.next=Hb;this.previous=Ta;this.data=P}}Object(d.a)(eh,"ListNode",null,[]);class fh{constructor(){this.JA=this.Aq=null;this._count=0}add(P){this.Aq?this.JA=this.JA.next=new eh(P,this.JA,null):this.Aq=this.JA=new eh(P,null,null);this._count=this.count+1}insert(P,Ta){if(P>this.count||
0>P)throw Error.argumentOutOfRange("pos");if(P===this.count)this.add(Ta);else{for(var Hb=this.Aq;0!==P--;)Hb=Hb.next;P=new eh(Ta,Hb.previous,Hb);P.previous?P.previous.next=P:this.Aq=P;P.next?P.next.previous=P:this.JA=P;this._count=this.count+1}}remove(P){let Ta=this.Aq;for(;Ta&&Ta.data!==P;)Ta=Ta.next;if(!Ta)return!1;Ta.previous?Ta.previous.next=Ta.next:this.Aq=Ta.next;Ta.next?Ta.next.previous=Ta.previous:this.JA=Ta.previous;this._count=this.count-1;return!0}clear(){let P=this.Aq,Ta;for(this.JA=this.Aq=
null;P;)Ta=P.next,P.previous=null,P.next=null,P=Ta;this._count=0}indexOf(P){let Ta=this.Aq,Hb=0;for(;Ta&&Ta.data!==P;)Ta=Ta.next,Hb++;return Ta?Hb:-1}na(P){return this.at(P).data}get count(){return this._count}getEnumerator(){return new jh(this.Aq)}[Symbol.iterator](){return Object(Zg.a)(this.getEnumerator())}acc(P){P=this.at(P);return new jh(P)}toArray(){const P=Array(this.count);let Ta=0;for(let Hb of this)P[Ta]=Hb,Ta++;return P}at(P){let Ta=this.Aq,Hb=0;for(;Hb!==P;){if(!Ta)throw Error.argumentOutOfRange("pos");
Ta=Ta.next;Hb++}return Ta}}Object(d.a)(fh,"List",null,[1]);class Kg extends Sys.EventArgs{constructor(P){super();this.properties=P}}Object(d.a)(Kg,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class $g{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)($g,"MiniAddinInfo",null,[]);class nf{constructor(P,Ta,Hb){this.Ra=new te.a;this.context=new af;this.vTc=this.KVd=this.MGa=this.AO=this.LX=null;this.contextActivationMgr=P;this.bNg=Ta;this.NGa=Hb;this.appName=
nd.AFrameworkApplication.fa.Xa("WebAppShortName")}get HOb(){this.vTc||(this.vTc=new Bg(this.Ra));return this.vTc}dJg(P){this.Ra.addHandler(be.a.zob,P)}wMg(P){this.Ra.addHandler(be.a.iUd,P)}uSj(P){null!==P&&(this.context.pO=P[be.a.T2],this.context.nq=P[be.a.wM],this.context.YBc=this.context.xsc=0,P=be.a.OGa in P?P[be.a.OGa]:0,-1!==this.context.pO&&0!==this.context.nq&&(this.context.e$=new fh,this.context.Cja=new fh,this.context.S4b=new fh,this.context.fXc=this.bNg.createAddinDataProvider(xh(this.context.pO),
this.contextActivationMgr),this.context.fXc?this.context.fXc.getEntitlementsAsync(this.contextActivationMgr.$ca,!0,P,Ta=>{this.nSi(Ta)}):n.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.pO)))}nSi(P){if(P&&0<P.length){this.context.YBc=P.length;const Hb=nd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Jg():null;for(let lc=0;lc<P.length;lc++){const xc=P[lc];if(nd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&
Cg()&&xc&&xc.storeType&&"omex"===xc.storeType.toLowerCase()&&xc.assetId&&Hb&&xc.assetId.toLowerCase()===Hb.toLowerCase()){var Ta={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:nf.iV(xc)};Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ba.a.Wj(Ta)}))}!xc||1!==xc.targetType&&-1!==xc.targetType?this.Znc():(Ta={},nd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?
(Ta.solutionId=xc.solutionId,Ta.version=xc.version):(Ta.marketplaceId=xc.solutionId,Ta.marketplaceVersion=xc.version),Ta.storeType=xc.storeType,Ta.storeId=xc.storeId,Ta.targetData=xc,nf.IOb?this.contextActivationMgr.isAddinCommandsExAsync(Ta,Object(ae.a)(this,this.JRi,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(Ta,(cd,id,od)=>{cd?(id&&this.context.e$.add(od.targetData),10===this.context.pO&&(cd=od.targetData,id=cd.targetType,Aa.c(od.targetTypeForExp)||(id=od.targetTypeForExp,
cd.targetType=id),this.context.Cja.add(cd),0===id&&this.context.S4b.add(cd))):(od=od.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(od.solutionId,od.storeType,od.assetId,null,null,od.storeId),od.storeType));this.Znc()}))}}else this.Znc()}Znc(){var P;(P=this.context).xsc=P.xsc+1;this.context.xsc>=this.context.YBc&&(this.NGa.v1f(this.context.pO,!1),0<this.context.YBc&&10===this.context.pO&&("Excel"===this.appName||
"PowerPoint"===this.appName||"Word"===this.appName)?(P=!1,nd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&Ig()&&(P=this.Dyi()),this.Qxi(),nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!P?nf.IOb?this.HOb.$Qj(this.contextActivationMgr,this.context.eXc,this.context.rIa,(Ta,Hb)=>{const lc=new m.a;for(let xc of Ta)Ta=xc.Ucg(),Hb&&Hb.solutionId===xc.solutionId&&(Ta.showCallout=
!0,this.HOb.dig(Hb)),lc.add(Ta);this.dna(lc)}):this.ULh(this.context.e$):this.d_b(this.context.e$)):this.d_b(this.context.e$))}d_b(P){if(nf.IOb)this.dna(this.K5g(this.context.eXc));else{var Ta=new m.a;if(P)for(let Hb of this.context.e$)Ta.add(ig(Hb));this.context.e$&&1>this.context.e$.count&&Cf.a.agb(be.a.Aob,"false",this.context.pO);P={["ack2"]:Ta};P[be.a.T2]=this.context.pO;P[be.a.wM]=this.context.nq;this.Ra.raiseEvent(be.a.zob,new Kg(P),this)}}K5g(P){const Ta=new m.a;if(P)for(let Hb of P)Ta.add(Hb.Ucg());
return Ta}dna(P){P&&P.count||Cf.a.agb(be.a.Aob,"false",this.context.pO);P={["ack2"]:P};P[be.a.T2]=this.context.pO;P[be.a.wM]=this.context.nq;this.Ra.raiseEvent(be.a.zob,new Kg(P),this)}B7(P){if(this.appName){const Ta={},Hb={};Hb.LastTeachingUIShowTime=(new Date).toUTCString();Hb.AddinHasShown=P;Ta[this.appName]=Ef.c(Hb);this.LX&&(this.LX.t3a(Ta),n.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else n.ULS.sendTraceTag(539530528,
306,10,"Fail to save roaming service since AppName is null")}ULh(P){(this.MGa=P)?(P=new m.a,P.add(this.appName),this.LX=new Yf(this.appName,Object(ae.a)(this,this.dka,"getRequestSuccessCallback"),Object(ae.a)(this,this.H4,"getRequestFailureCallback"),Object(ae.a)(this,this.rW,"postRequestFailureCallback")),this.LX.f$b(P)):(P={["ack2"]:new m.a},P[be.a.T2]=this.context.pO,P[be.a.wM]=this.context.nq,this.Ra.raiseEvent(be.a.zob,new Kg(P),this))}dka(P){P?this.STd(P)?(n.ULS.sendTraceTag(527523845,306,50,
"should show teaching UI"),this.AO="AddinHasShown"in P&&P.AddinHasShown?P.AddinHasShown.toString():null,this.Nrb()):(n.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.d_b(this.MGa)):(n.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.AO=null,this.Nrb())}H4(P){n.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",P?P.httpStatus:-1);this.d_b(this.MGa)}rW(P){n.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
P?P.httpStatus:-1)}Nrb(){const P=this.J7c();if(0===P.targetType){P.solutionId?(this.KVd=P.solutionId,this.iId()):this.Ila("NoSolutionId");if(P.addinId){const Ta=this.AO?this.AO+","+P.addinId:P.addinId;nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Ta:this.B7(Ta)}this.Poe(null)}else this.Poe(P.addinId);n.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",P.addinId)}iId(){const P=new Of;P.callbackFunc=
Ta=>{if(Ta.errorCode){if(this.Ila("FailToGetAppDetails"),nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var Hb=window.g_roamingAddinList;Hb&&this.B7(Hb)}}else if(Ta.value)for(Hb of Ta.value)if(Ta=Hb[1],Ta===this.KVd){const lc={};lc.solutionId=Ta;lc.assetId=Hb[5];lc.storeType=Hb[12];lc.storeId=Hb[11];lc.assetStoreId=Hb[6];lc.targetType=Hb[3];lc.width=Hb[7];lc.height=Hb[8];lc.displayName=Hb[0];lc.version=Hb[4];Hb=new dh(lc);this.Ra.raiseEvent(be.a.iUd,
Hb);break}};P.storeType=OSF.StoreTypeEnum.PrivateCatalog;P.fromInsertDialog=!1;P.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(P)}STd(P){if("LastTeachingUIShowTime"in P){if(P=+new Date-+new Date(P.LastTeachingUIShowTime.toString()),P<nd.AFrameworkApplication.fa.iN("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",P),!1}else n.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");
return!0}J7c(){let P=new Pd.a(new $g,0),Ta=new Pd.a(new $g,0),Hb=0,lc=0,xc=0;var cd=new fh;if(0<this.context.e$.count)for(var id of this.context.e$)cd.add(id);if(0<this.context.S4b.count)for(let od of this.context.S4b)cd.add(od);for(let od of cd)if(!("excatalog"!==od.storeType||Aa.c(od.installTimeInMS)||!od.installTimeInMS||od.installTimeInMS<=nd.AFrameworkApplication.fa.iN("DateTimeInMSForNewAddin",16409952E5))){cd=nf.cwb(od);if(this.AO&&(id=this.AO.split(","),0<id.length&&Array.contains(id,cd))){xc++;
n.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}cd.startsWith("private_")?(P.value<od.installTimeInMS&&(P=new Pd.a(Object.assign(new $g,{addinId:cd,targetType:od.targetType,solutionId:od.solutionId}),od.installTimeInMS)),lc++):(Ta.value<od.installTimeInMS&&(Ta=new Pd.a(Object.assign(new $g,{addinId:cd,targetType:od.targetType,solutionId:od.solutionId}),od.installTimeInMS)),Hb++)}n.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
lc,Hb,xc);return 0<Ta.value?Ta.key:0<P.value?P.key:Object.assign(new $g,{addinId:null,targetType:-1,solutionId:null})}Poe(P){const Ta=new m.a;for(let lc of this.MGa){const xc=ig(lc);if(P){var Hb=nf.cwb(lc);P===Hb&&(xc.showCallout=!0,Hb=this.AO?this.AO+","+P:P,nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Hb:this.B7(Hb))}Ta.add(xc)}this.MGa&&1>this.MGa.count&&Cf.a.agb(be.a.Aob,"false",this.context.pO);P={["ack2"]:Ta};
P[be.a.T2]=this.context.pO;P[be.a.wM]=this.context.nq;this.Ra.raiseEvent(be.a.zob,new Kg(P),this)}Dyi(){if(nf.IOb)return this.Eyi(this.context.zdd);var P=!1;if(this.context.Cja&&1>this.context.Cja.count)return P;const Ta=Jg();if(!Ta)return P;for(let Hb of this.context.Cja)if(Hb.storeId&&Hb.storeId.toLowerCase()===Ta.toLowerCase()||Hb.assetId&&Hb.assetId.toLowerCase()===Ta.toLowerCase())P={["SDX_Id"]:nf.iV(Hb),["SDX_TargetType"]:Aa.c(Hb.targetType)?"":Hb.targetType.toString()},Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Ba.a.Wj(P)})),P=!0;return P}Qxi(){if(nf.IOb)this.Rxi(this.context.zdd);else if(!(this.context.Cja&&1>this.context.Cja.count))if(this.NGa.Qif()){var P=this.NGa.$4e();P?(P=this.M0e(this.context.Cja,P),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(P=this.M0e(this.context.Cja,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.NGa.Y3f(P)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}M0e(P,
Ta){const Hb={};let lc=!1;for(let xc of P)if(P=nf.iV(xc))!Ta||P in Ta||(this.oya(xc,P),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===P.toLowerCase()?lc||(lc=!0,Hb[P]=null):Hb[P]=null;return Hb}oya(P,Ta){var Hb=P.installTimeInMS?(new Date(P.installTimeInMS)).toISOString():"";Hb={["SDX.Id"]:Ta,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Aa.c(P.targetType)?"":P.targetType.toString(),["SDX.AdminDeploymentTime"]:Hb};Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:Ba.a.Wj(Hb)}));1===P.targetType&&(P={["SDX.Id"]:Ta,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Ba.a.Wj(P)})))}Eyi(P){let Ta=!1;if(P&&1>P.count)return Ta;const Hb=Jg();if(!Hb)return Ta;for(let lc of P)if(lc.storeId&&lc.storeId.toLowerCase()===Hb.toLowerCase()||lc.assetId&&lc.assetId.toLowerCase()===Hb.toLowerCase())P=
{["SDX_Id"]:nf.c5e(lc),["SDX_TargetType"]:Aa.c(lc.targetType)?"":lc.targetType.toString()},Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Ba.a.Wj(P)})),Ta=!0;return Ta}Rxi(P){if(!(P&&1>P.count))if(this.NGa.Qif()){var Ta=this.NGa.$4e();Ta?(P=this.N0e(P,Ta),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(P=this.N0e(P,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.NGa.Y3f(P)}else n.ULS.sendTraceTag(528589915,
306,50,"Local storage got disabled")}N0e(P,Ta){const Hb={};let lc=!1;for(let xc of P)if(P=nf.c5e(xc))!Ta||P in Ta||(this.HAi(xc,P),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===P.toLowerCase()?lc||(lc=!0,Hb[P]=null):Hb[P]=null;return Hb}HAi(P,Ta){var Hb=P.installTimeInMS?(new Date(P.installTimeInMS)).toISOString():"";Hb={["SDX.Id"]:Ta,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Aa.c(P.targetType)?"":P.targetType.toString(),["SDX.AdminDeploymentTime"]:Hb};
Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ba.a.Wj(Hb)}));1===P.targetType&&(P={["SDX.Id"]:Ta,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Ba.a.Wj(P)})))}JRi(P,Ta,Hb,lc){P?(-1===lc.targetType&&(lc.targetType=Hb.targetTypeForExp),P=new Wf(Hb.targetData,lc),Ta&&this.context.eXc.add(P),10===this.context.pO&&(this.context.zdd.add(P),
0===P.targetType&&this.context.rIa.add(P))):(Ta=Hb.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.solutionId,Ta.storeType,Ta.assetId,null,null,Ta.storeId),Ta.storeType));this.Znc()}Ila(P){P={["AppTeachingUICalloutAction"]:P,["SDX.Id"]:this.KVd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Ba.a.Wj(P)}))}static get IOb(){return nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)}static iV(P){return Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.storeType,P.assetId,null,null,P.storeId)}static c5e(P){return Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.storeType,P.assetId,null,null,P.storeId)}static cwb(P){return Telemetry.PrivacyRules.IsPrivateAddin(P.storeType,P.assetId,null,null,P.storeId)?
"private_"+P.installTimeInMS:P.solutionId}}Object(d.a)(nf,"AddInCommandsListLoader",null,[]);class ma{constructor(P){this.Qyg=P}get $ca(){return this.Qyg}insertOsfControl(P){return this.$ca.insertOsfControl(P)}getManifestInvaildErrorString(){return this.$ca.getManifestInvaildErrorString()}isAddinCommandsAsync(P,Ta){this.$ca.isAddinCommandsAsync(P,Ta)}isAddinCommandsExAsync(P,Ta){this.$ca.isAddinCommandsExAsync(P,Ta)}ownerAddinControlRecreated(P,Ta){this.$ca.ownerAddinControlRecreated(P,Ta)}queryEntitlementDetails(P){this.$ca.queryEntitlementDetails(P)}}
Object(d.a)(ma,"ContextActivationMgrWrapper",null,[721]);class vb{createAddinDataProvider(P,Ta){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(P,Ta.$ca)}static get instance(){vb.Ma||(vb.Ma=new vb);return vb.Ma}}vb.Ma=null;Object(d.a)(vb,"OSFAddinDataProviderFactory",null,[720]);class nc{constructor(){this.Ver=1}}Object(d.a)(nc,"CacheItem",null,[]);class Ec{constructor(P){this.QEa=P}Dl(P){const Ta=this.QEa.getItem(P);if(Ta){let Hb=new nc;try{Hb=Sys.Serialization.JavaScriptSerializer.deserialize(Ta,
!0)}catch(lc){return this.QEa.removeItem(P),null}return Hb.Data?Hb.Data:Hb.data}return null}hRa(P){this.QEa.removeItem(P)}}Object(d.a)(Ec,"AppsDataCacheManager",null,[753]);var Ad=a(818);class Ld{constructor(){new Ec(Ad.a.instance)}v1f(P,Ta){P=be.a.S1e()+P;Ad.a.instance.setItem(P,Ta.toString())}$4e(){var P=be.a.d5e();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",P);P=Ad.a.instance.getItem(P);return Ef.a(P)}Y3f(P){const Ta=be.a.d5e();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",
Ta);Ad.a.instance.setItem(Ta,Ef.c(P))}Qif(){return!!Ad.a.instance.localStorage}static get instance(){Ld.Ma||(Ld.Ma=new Ld);return Ld.Ma}}Ld.Ma=null;Object(d.a)(Ld,"AddInCommandsCacheManager",null,[724]);class ge{constructor(P,Ta,Hb,lc,xc,cd){this.nq=P;this.qk=Ta;this.WW=Hb;this.displayName=xc;this.Anf=cd}}Object(d.a)(ge,"PostLaunchAddinCommandsParameters",null,[]);class ca{constructor(P,Ta,Hb){this.ORa=!1;this.LX=null;this.fb=P;this.Ujb=Ta;this.lhb=Hb}NVc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",
Object(ae.a)(this,this.ZCd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(ae.a)(this,this.gCd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(ae.a)(this,this.WBd,"onCloseButtonClickedEventHandler"),!0),nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(ae.a)(this,this.xFb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}ZCd(){const P={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:ca.iV(this.Ujb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.lhb&&this.lhb.tabs&&!this.lhb.tabs[0].isOfficeTab&&(P["SDX.FeatureFlags"]="NonOfficeTab");Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)}));nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Ula();this.lhb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.lhb,()=>{const Ta=new qg;Ta.qk=this.Ujb;this.fb.raiseEvent(be.a.Qud,Ta)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}WBd(){const P={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:ca.iV(this.Ujb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Ba.a.Wj(P)}));nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Ula()}gCd(){const P={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:ca.iV(this.Ujb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)}));nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Ula()}xFb(P){if(P&&(P=P.detail)&&P.id&&this.Mod(P.id)){const Hb=(P.action||"").toLowerCase();if(P.success&&"opened"===Hb){var Ta={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:ca.iV(this.Ujb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(Ta)}));n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");
this.Ula();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(ae.a)(this,this.xFb,"onCampaignLaunchedHandler"),!0)}else try{Ta=JSON.stringify(P),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ta)}catch(lc){Ta="id : "+P.id+" telemetryEventName: "+P.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ta+" Error: "+(lc?lc.toString():""))}}}Mod(P){P=Xf.a.ul(P);return-1!==P.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==P.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==P.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==P.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==P.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==P.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}B7(P){const Ta=nd.AFrameworkApplication.fa.Xa("WebAppShortName");if(Ta){const Hb={},lc={};lc.LastTeachingUIShowTime=(new Date).toUTCString();lc.AddinHasShown=P;Hb[Ta]=Ef.c(lc);this.LX=new Yf(Ta,null,null,Object(ae.a)(this,
this.rW,"postRequestFailureCallback")),this.LX.t3a(Hb),n.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(523535565,220,10,"Fail to save roaming service since AppName is null")}Ula(){if(!this.ORa){const P=window.g_roamingAddinList;P&&(this.B7(P),this.ORa=!0)}}rW(P){n.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",P?P.httpStatus:-1)}static iV(P){return Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,
P.storeType,P.assetId,null,null,P.storeId)}}Object(d.a)(ca,"PrivateCatalogTeachingCalloutHandler",null,[]);class kb{constructor(P){this.wce=null;this.mae=P}get $xa(){return this.wce}rZa(P,Ta=null){this.mae.rZa(P,Ta);this.wce=P}hLd(P){this.mae.hLd(P)}}Object(d.a)(kb,"RibbonExtensibilityManagerWithChangeDetection",null,[739]);var Mb=a(862),F=a(98);class ia{static G2e(P){const Ta=new m.a;if(ia.sEe)for(var Hb of ia.sEe)Ta.add(Hb);Hb=null;switch(P){case "Workbook":Hb=ia.V1j;break;case "Document":Hb=ia.Emh;
break;case "Presentation":Hb=ia.u4i}if(Hb)for(const lc of Hb)Ta.add(lc);return Ta}}ia.sEe=["PrimaryCommandSurface","ContextMenu"];ia.V1j=null;ia.Emh=null;ia.u4i=null;Object(d.a)(ia,"ExtensionPointType",null,[]);class Qa{constructor(P){this.vfe=null;if(Aa.c(P))throw n.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.fqg=P}get kFb(){return this.vfe||(this.vfe=new m.a)}get sse(){return this.fqg}}Object(d.a)(Qa,
"ContextMenuExtensibility",null,[730]);class Gb{constructor(P,Ta=null,Hb=0){if(Aa.c(P))throw n.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.Jyg=P;this.XBg=Ta;this.Gug=Hb}get dW(){return this.Jyg}get startedNode(){return this.XBg}get iLh(){return this.Gug}}Object(d.a)(Gb,"RibbonExtensibility",null,[766]);class kc{constructor(P){this.Gtg=P.entitlement}get entitlement(){return this.Gtg}createActionContext(P,
Ta){P={};P.ownerAddinInfo=this.entitlement;P.action=Ta;return P}}Object(d.a)(kc,"AddInCommandsContextProvider",null,[]);class gc{constructor(P,Ta,Hb){this.v4d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=P;this.eventBuilder=Ta;this.contextMenuBuilder=Hb}get Nre(){return this.v4d}O$g(P){return new kc(P)}createActionBuilder(P,Ta){return OfficeExt.DefaultControlActionBinder.createActionBuilder(P,Ta.entitlement,Ta.manifest)}startApplyAddin(P){this.v4d=
P;const Ta=this.O$g(P);this.actionBuilder=this.createActionBuilder(Ta,P)}endApplyAddin(){}aed(P,Ta,Hb=0){return this.ribbonBuilder.kt&&0<this.ribbonBuilder.kt.count?new Gb(this.zKh(P,Ta),this.Nre.startedNode,Hb):null}jZe(){var P=null;if(this.contextMenuBuilder.Bmc&&0<this.contextMenuBuilder.Bmc.count){P||(P=this.Nre.entitlement.solutionId);P=new Qa(P);for(let Ta of this.contextMenuBuilder.Bmc)P.kFb.add(Ta);return P}return null}zKh(P,Ta){return this.ribbonBuilder.kt&&0<this.ribbonBuilder.kt.count?
new $e.a(this.ribbonBuilder.kt,P,Ta):null}}Object(d.a)(gc,"AddinCommandsBuilder",null,[]);class fc{constructor(P,Ta,Hb,lc,xc,cd,id){this.RTa=new F.a;this.nq=P;this.Xh=Ta;this.ap=Hb;this.ribbonManager=lc;this.contextMenuManager=xc;this.mG=cd;this.hha=id;this.QO=nd.AFrameworkApplication.sa.iE}SCb(P,Ta,Hb,lc,xc,cd,id){const od=(Fd,Rd,Re,We)=>{xc(Fd,Rd,Re,We);Fd=Mb.a[this.nq]+Rd.assetId;({value:Rd}=this.RTa.Dc(Fd)).returnValue&&(Rd.stop(),this.RTa.remove(Fd))};if(0!==this.nq&&P){n.ULS.sendTraceTag(17326351,
220,50,"Addin count {0}.",P.count);4===this.nq&&(n.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",lc)),this.Y1g(P,lc),cd());for(let Fd of P)if(P=Fd,n.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.ap.rN,Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.ownerAddinStoreType||P.storeType,P.assetId,null,null,P.storeId))),this.$jg(P))if(id&&P.requireConsent)id(P,Rd=>{try{if(this.QO){const We=Mb.a[this.nq]+Rd.solutionId,
lf=this.QO.Ac("ComponentAttach",We);this.RTa.ia(We,lf)}const Re=this.mG.ija(Rd.storeType,Rd.solutionId);6!==this.nq&&(Re&&(this.H3b(Re),Re.KB.purge(!1)),this.Xh.insertOsfControl(this.VHb(Rd,Ta,Hb,od)),Re&&this.Xh.ownerAddinControlRecreated(Rd.solutionId,Rd.storeType))}catch(Re){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.ap.rN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.solutionId,
Rd.ownerAddinStoreType||Rd.storeType,Rd.assetId,null,null,Rd.storeId),Rd.version,Rd.storeType,Rd.storeId,Re.message)),od(!1,Rd,null,null)}});else try{if(this.QO){const Re=Mb.a[this.nq]+P.solutionId,We=this.QO.Ac("ComponentAttach",Re);this.RTa.ia(Re,We)}const Rd=this.mG.ija(P.storeType,P.solutionId);6!==this.nq&&(Rd&&(this.H3b(Rd),Rd.KB.purge(!1)),this.Xh.insertOsfControl(this.VHb(P,Ta,Hb,od)),Rd&&this.Xh.ownerAddinControlRecreated(P.solutionId,P.storeType))}catch(Rd){n.ULS.sendTraceTag(17388185,220,
10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.ap.rN,Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.ownerAddinStoreType||P.storeType,P.assetId,null,null,P.storeId),P.version,P.storeType,P.storeId,Rd.message)),od(!1,P,null,null)}else od(!1,P,null,null)}}mvi(P,Ta,Hb,lc,xc,cd){const id=(od,Fd,Rd,Re)=>{cd(od,Fd,Rd,Re);od=Mb.a[this.nq]+Fd.solutionId;({value:Fd}=this.RTa.Dc(od)).returnValue&&(Fd.stop(),
this.RTa.remove(od))};if(6===this.nq&&P)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.ap.rN,Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.ownerAddinStoreType||P.storeType,P.assetId,null,null,P.storeId))),this.$jg(P))try{if(this.QO){const Fd=Mb.a[this.nq]+P.solutionId,Rd=this.QO.Ac("ComponentAttach",Fd);this.RTa.ia(Fd,Rd)}const od=this.mG.ija(P.storeType,P.solutionId);od||id(!1,P,null,null);nd.AFrameworkApplication.sa&&nd.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?
this.HZe(P,Ta,lc,xc,Hb,Fd=>{id(Fd,P,Hb,od.displayName)}):(this.HZe(P,Ta,lc,xc,Hb),id(!0,P,Hb,od.displayName))}catch(od){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.ap.rN,Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.ownerAddinStoreType||P.storeType,P.assetId,null,null,P.storeId),P.version,P.storeType,P.storeId,od.message)),id(!1,P,null,null)}else id(!1,
P,null,null)}KJi(P,Ta,Hb,lc,xc,cd){if(cd)if(cd._isAddinCommandsManifest(this.ap.rN))try{nd.AFrameworkApplication.sa&&nd.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.GZe(P,Ta,Hb,xc,cd,id=>{lc(id,P,cd,cd.getDefaultDisplayName())}):(this.GZe(P,Ta,Hb,xc,cd),lc(!0,P,cd,cd.getDefaultDisplayName()))}catch(id){n.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.ap.rN,
Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.ownerAddinStoreType||P.storeType,P.assetId,null,null,P.storeId),P.version,P.storeType,P.storeId,id.message)),lc(!1,P,cd,cd.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.ap.rN,Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.ownerAddinStoreType||P.storeType,P.assetId,
null,null,P.storeId),P.version,P.storeType,P.storeId)),lc(!1,P,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.ap.rN,Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.ownerAddinStoreType||P.storeType,P.assetId,null,null,P.storeId),P.version,P.storeType,P.storeId)),lc(!1,P,null,null)}VHb(P,Ta,Hb,lc){const xc={},cd=document.createElement("div");cd.setAttribute("visible",
"false");xc.div=cd;xc.id=P.solutionId;xc.solutionId=P.solutionId;xc.version=P.version;xc.storeType=P.storeType;xc.storeId=P.storeId;xc.assetId=P.assetId;xc.assetStoreId=P.assetStoreId;xc.isvirtualOsfControl=!0;xc.virtualOsfControlActivationCallback=(id,od)=>{const Fd=this.mG.ija(P.storeType,P.solutionId);Fd&&(Fd.isUpgraded&&(P.isUpgraded=!0),this.H3b(Fd));this.KJi(P,Ta,Hb,lc,id,od)};xc.reason=3===this.nq?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;
return xc}GZe(P,Ta,Hb,lc,xc,cd=null){const id={};id.solutionId=lc.getSolutionId();id.version=lc.getVersion();id.storeType=lc.getStoreType();id.storeId=lc.getStoreId();id.assetId=lc.getAssetId();id.assetStoreId=lc.getAssetStoreId();id.targetType=lc.getOsfControlType();let od=null,Fd=null;if(nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))od=(new OfficeExt.Parser.AddinCommandsManifestParser(this.ap.rN,this.ap.formFactor)).parseExtensions(id,
xc,this.hha),Fd=ia.G2e(this.ap.rN);else try{od=(new OfficeExt.Parser.AddinCommandsManifestParser(this.ap.rN,this.ap.formFactor)).parseExtensions(id,xc,this.hha),Fd=ia.G2e(this.ap.rN)}catch(Re){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Re.message),Re;}if(Fd&&0<Fd.count){if(nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Rd=Ta(P);Ta=Hb(P);Hb=!!nd.AFrameworkApplication.fa&&
nd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Rd=new gc(Rd,null,Ta);for(let Re of Fd)Rd.commandSurface=Re,od.apply(Rd,this.hha,Hb)}else try{let Re=Ta(P),We=Hb(P),lf=!!nd.AFrameworkApplication.fa&&nd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Rd=new gc(Re,null,We);for(let rg of Fd)Rd.commandSurface=rg,od.apply(Rd,this.hha,lf)}catch(Re){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Re.message),
Re;}if(OSF.OUtil.checkFlight(14))try{let Re=Rd.aed(P.solutionId,xc.getDefaultDisplayName()),We=Rd.jZe();Re&&this.ribbonManager.rZa(Re,cd);We&&this.contextMenuManager.qoe(We);this.mG.Xoe(lc,Re,We,xc.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",xc.getDefaultDisplayName())}catch(Re){throw OfficeExt.DevConsole.log(Re),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Re.message),Re;}else try{let Re=Rd.aed(P.solutionId,xc.getDefaultDisplayName()),
We=Rd.jZe();Re&&this.ribbonManager.rZa(Re);We&&this.contextMenuManager.qoe(We);this.mG.Xoe(lc,Re,We,xc.getDefaultDisplayName());n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",xc.getDefaultDisplayName())}catch(Re){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Re.message),Re;}}}HZe(P,Ta,Hb,lc,xc,cd=null){const id={};id.solutionId=P.solutionId;id.version=P.version;id.storeType=P.storeType;id.storeId=P.storeId;id.assetId=P.assetId;id.assetStoreId=
P.assetStoreId;id.targetType=P.targetType;const od=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.ap.rN,this.ap.formFactor);try{const Fd=Ta.getManifest(),Rd=od.parse(id,Fd,xc,this.hha,Ta.getSharedRuntimeId(),Ta),Re=Hb(P),We=lc(P),lf=new gc(Re,null,We);lf.commandSurface="PrimaryCommandSurface";Rd.apply(lf,this.hha,!0);if(lf.ribbonBuilder.kt&&0<lf.ribbonBuilder.kt.count){const rg=lf.aed(P.solutionId,Ta.getManifest().getDefaultDisplayName(),1);nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.rZa(rg,cd):rg&&this.ribbonManager.rZa(rg,cd);this.mG.hHg(Ta,rg,xc,Ta.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ta.getManifest().getDefaultDisplayName())}}catch(Fd){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Ta.getManifest().getDefaultDisplayName(),Fd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Fd)}}H3b(P){P.So&&this.ribbonManager.hLd(P.So);
P.asb&&this.contextMenuManager.udj(P.asb);this.mG.cdj(P.KB.getStoreType(),P.KB.getSolutionId())}Y1g(P,Ta){Ta=xh(Ta);for(let Hb of this.mG.E6a){if(Hb.KB.getStoreType()!==Ta)continue;let lc=!0;for(let xc of P){const cd=xc;if(cd&&Hb.Fkf(cd.storeType,cd.solutionId)){lc=!1;break}}lc&&(this.H3b(Hb),Hb.KB.purge(!1))}}$jg(P){return!!P&&!!P.solutionId&&!!P.version&&!!P.storeType&&!!P.storeId}}Object(d.a)(fc,"AddInCommandsIntegration",null,[]);class $c{constructor(P,Ta,Hb,lc,xc,cd,id,od=null){this.fb=new te.a;
this.dGc=P;this.zsg=Ta;this.Im=Hb;this.Hle=lc;this.fYa=xc;this.Upg=cd;this.MRb=id;this.Byg=od;this.twg=nd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.eMc=nd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}eJg(P){this.fb.addHandler(be.a.Mre,P)}WKg(P){this.fb.addHandler(be.a.Qud,P)}vMg(P){this.fb.addHandler(be.a.j7f,P)}lJg(P){this.fb.addHandler(be.a.iZc,P)}Fvi(P,Ta,Hb){const lc=Hb[be.a.yob],
xc=void 0===Hb[be.a.wM]?0:Hb[be.a.wM];if(lc&&0!==xc)if(0>=lc.count&&4!==xc)this.ZLf(new ge(xc,null,null,Ta,null,!0));else{var cd=lc.count,id=new kb(new k),od=void 0===Hb[be.a.T2]?-1:Hb[be.a.T2],Fd=new fc(xc,this.Im,this.dGc,id,this.zsg,this.fYa,this.MRb),Rd=fg=>this.Hle.rWg(fg.solutionId,this.MRb,this.dGc,P),Re=fg=>this.Hle.BVg(fg.solutionId),We=(fg,$f,bg)=>{cd--;bg=new ge(xc,$f,id,Ta,bg,0>=cd);if(fg&&$f)this.ZLf(bg);else{if(3===xc||$f&&$f.isUpgraded)fg="",$f&&(fg=Telemetry.PrivacyRules.GetPrivacyCompliantId($f.solutionId,
$f.ownerAddinStoreType||$f.storeType,$f.assetId,null,null,$f.storeId)),$f={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:fg},Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ba.a.Wj($f)}));this.YLf(bg)}cd||nd.AFrameworkApplication.sa.updateCommandUI()},lf=(fg,$f,bg,jg)=>{We(fg,$f,jg)},rg=()=>{this.NAd();0>=lc.count&&4===xc&&this.fYa.SQd()};6===xc?(od=Hb[be.a.zJa],Hb=Hb[be.a.AJa],Fd.mvi(lc.na(0),
od,Hb,Rd,Re,(fg,$f,bg,jg)=>{We(fg,$f,jg)})):Fd.SCb(lc,Rd,Re,od,lf,rg,this.Byg)}else Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ba.a.Wj({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.dGc.rN)),this.YLf(new ge(xc,null,null,Ta,null,!0))}YLf(P){this.NAd(P);this.a8f(!1,
P)}ZLf(P){const Ta=P.qk;let Hb=null;null!==Ta&&(Hb=Ta.storeType,Hb=Hb.toLowerCase());if(P&&"omex"===Hb&&(3===P.nq||Ta.isUpgraded)){var lc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.solutionId,Ta.ownerAddinStoreType||Ta.storeType,Ta.assetId,null,null,Ta.storeId)};Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ba.a.Wj(lc)}))}this.NAd(P);lc=this.eMc&&Cg()&&"omex"===
Hb&&!!P.WW&&!!Ta.solutionId&&2===P.nq&&Ta.solutionId.toLowerCase()===Jg().toLowerCase();var xc="omex"===Hb&&!!P.WW&&(3===P.nq&&"hardcodedpreinstall"!==Hb||Ta.isUpgraded);const cd=nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableLaunchCDAddIn",!1)&&"excatalog"===Hb&&3===P.nq;if(xc||lc||cd)lc=new qg,lc.qk=Ta,lc.So=P.WW.$xa,this.fb.raiseEvent(be.a.iZc,lc);this.twg&&(lc=Ig(),xc=Jg(),lc&&Ta&&"excatalog"===Ta.storeType&&P.WW&&5===P.nq&&xc&&(Ta.storeId&&Ta.storeId.toLowerCase()===
xc.toLowerCase()||Ta.assetId&&Ta.assetId.toLowerCase()===xc.toLowerCase())&&(lc=new qg,lc.qk=Ta,lc.So=P.WW.$xa,this.fb.raiseEvent(be.a.iZc,lc),n.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event.")));Ta&&(Ld.instance.v1f(Yg(Hb),!0),"uploadfiledevcatalog"===Hb&&(lc=this.Upg.createAddinDataProvider(Hb,this.Im))&&lc.localCacheAddinCommands(this.Im.$ca,Ta.solutionId,Ta.version,Ta.storeId),Cf.a.agb(be.a.Aob,"true",Yg(Hb)));this.a8f(!0,P)}a8f(P,Ta){P?nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&Ta.WW&&5===Ta.nq&&Ta.WW.$xa&&void 0!==Ta.qk.showCallout&&null!==Ta.qk.showCallout&&Ta.qk.showCallout?(nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new Bg(this.fb)).NVc(Ta.qk,$e.a.g4a(Ta.WW.$xa)):(new ca(this.fb,Ta.qk,$e.a.g4a(Ta.WW.$xa))).NVc(),P=new qg,P.So=Ta.WW.$xa,P.qk=Ta.qk,this.fb.raiseEvent(be.a.j7f,P)):3!==Ta.nq?Ta.Anf&&this.fYa.SQd():Ta.WW&&Ta.WW.$xa&&"hardcodedpreinstall"!==Ta.qk.storeType&&Qb.a.FDj(Ta.displayName,
Ta.WW.$xa,Ta.qk.isAutoLaunched):3===Ta.nq?Ta.qk&&"uploadfiledevcatalog"===Ta.qk.storeType.toLowerCase()?(Ta=this.MRb.WRh(Ta.qk.solutionId),Qb.a.bUd(Ta?Ta:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.fYa.E2f():Ta.Anf&&this.fYa.SQd()}NAd(P=null){var Ta=P?P.qk:null;const Hb=new qg;if(Hb.qk=Ta){var lc=this.fYa.ija(Ta.storeType,Ta.solutionId,6===P.nq?1:0);if(lc&&lc.So){Hb.So=lc.So;var xc=this.eMc?Jg():null;xc=this.eMc&&Cg()&&!!Ta.solutionId&&!!xc&&Ta.solutionId.toLowerCase()===
xc.toLowerCase()&&2===P.nq;if(3===P.nq&&"hardcodedpreinstall"!==Ta.storeType||xc)P="",lc.So.dW&&lc.So.dW.kt&&(lc=lc.So.dW.kt.na(0))&&(P=lc.id),Ta={["SDX_CommandPlacement"]:P,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.solutionId,Ta.ownerAddinStoreType||Ta.storeType,Ta.assetId,null,null,Ta.storeId)},Ge.a.sendTelemetryEvent(Object.assign(new Bf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Ba.a.Wj(Ta)}))}}this.fb.raiseEvent(be.a.Mre,
Hb)}}Object(d.a)($c,"LaunchAddinCommandsHandler",null,[731]);class hd{}hd.qVa="Alt";hd.rVa="Command";hd.id="Id";hd.uVa="Image16by16";hd.uRb="LabelText";hd.yVa="Title";hd.GROUP="Group";hd.s3d="Groups";hd.ehb="Controls";hd.button="Button";hd.Qaa="FlyoutAnchor";hd.LARGE="Large";hd.SMALL="Small";Object(d.a)(hd,"AddinDataNodeConstants",null,[]);a(375);a(566);a(561);a(137);class jd{constructor(P,Ta){this.XEa=this.Y6d=null;if(Aa.c(P)||Aa.c(Ta))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),
Error.create("ControlDefinition id or type should not be null or undefined");this.Gsg=Ta;this._id=P;this.oU[hd.id]=this._id}get id(){return this._id||""}get oU(){return this.Y6d||(this.Y6d={})}get controlType(){return this.Gsg||""}get menuItems(){return this.XEa||(this.XEa=new m.a)}}Object(d.a)(jd,"ControlDefinition",null,[725]);class Xd{constructor(P){this.cee=null;if(Aa.c(P))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");
this._id=P;this.Xla[hd.id]=this._id}get Xla(){return this.cee||(this.cee={})}get id(){return this._id||""}}Object(d.a)(Xd,"MenuItemDefinition",null,[759]);class ee{constructor(P){this.Xpa=null;if(Aa.c(P))throw n.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=P}get id(){return this._id}get controls(){return this.Xpa||(this.Xpa=new m.a)}}Object(d.a)(ee,"OfficeMenuDefinition",
null,[727]);var re=a(25);class ze{constructor(P,Ta,Hb){this.pJ=this.jWa=null;this.mPc=P;this.ZVa=Ta;this.AVa=Hb;this.$xg=new m.a}get gnc(){return this.mPc}get Brb(){return this.ZVa}get RUc(){return this.AVa}addButton(P){n.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",P.actionType);this.pJ=new jd(this.Ssa(P.id),hd.button);this.pJ.oU[hd.uRb]=P.label;this.pJ.oU[hd.qVa]=P.label;this.pJ.oU[hd.uVa]=P.icon["16"];this.Wpb(this.pJ.oU[hd.id],P.action);this.uGa(this.pJ.oU);this.jWa.controls.add(this.pJ);
this.pJ=null}startBuildMenu(P){if(Aa.c(this.jWa))this.jWa=new ee(P.id);else{const Ta=this.Ssa(P.id);this.pJ=new jd(Ta,hd.Qaa);this.$_a(this.pJ.oU,P);this.pJ.oU[hd.uVa]=P.icon["16"];this.pJ.oU[hd.rVa]=re.a.alwaysEnabled}}addMenuItem(P){n.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",P.actionType);const Ta=new Xd(this.Ssa(P.id));this.$_a(Ta.Xla,P);P.icon&&(Ta.Xla[hd.uVa]=P.icon["16"]);this.Wpb(Ta.Xla[hd.id],P.action);this.uGa(Ta.Xla);this.pJ.menuItems.add(Ta)}endBuildMenu(){Aa.c(this.pJ)?
(this.Bmc.add(this.jWa),this.jWa=null):(this.jWa.controls.add(this.pJ),this.pJ=null)}get Bmc(){return this.$xg}Wpb(P,Ta){this.RUc.bindAction(P,Ta)}uGa(P){this.Brb.uGa(P)}Ssa(P){return this.gnc.TKa(P)}$_a(P,Ta){P[hd.uRb]=Ta.label;P[hd.qVa]=Ta.label}}Object(d.a)(ze,"ContextMenuExtensibilityCreator",null,[752,748]);class Se{constructor(P){this.blb=P}get HEb(){return this.blb}TKa(P){return this.HEb+P}}Object(d.a)(Se,"DefaultContextMenuNamingProvider",null,[751]);var df=a(1318);class cf{bindAction(P,Ta){OfficeExt.DefaultControlActionBinder.bindAction(P,
Ta)}}Object(d.a)(cf,"DefaultUIControlActionBinder",null,[750]);class of{constructor(P){this.EDa=P}get command(){return this.EDa}uGa(P){P[hd.rVa]=this.command}}Object(d.a)(of,"DefaultUIControlCommandBinder",null,[749]);var tf=a(32);class Df{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(d.a)(Df,"AddInControl",null,[]);class If{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(d.a)(If,"AddInGroup",null,[]);class vf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(d.a)(vf,"AddInMenuItem",null,[]);class mf{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(d.a)(mf,"AddInTab",null,[]);class sg{constructor(P,Ta,Hb,lc,xc,cd){this.JRb=new m.a;this.sib=this.tfa=this.kWa=null;this.mPc=P;this.AVa=
Ta;this.ZVa=Hb;this.yx=lc;this.MRb=xc;this.Y8d=cd}get gnc(){return this.mPc}get kt(){return this.JRb}get RUc(){return this.AVa}get Brb(){return this.ZVa}startBuildTab(P){const Ta=P.isOfficeTab?P.id:this.gnc.U6e(P.id),Hb=P.isOfficeTab?null:P.label;this.kWa=Object.assign(new mf,{id:Ta,title:Hb,isOfficeTab:P.isOfficeTab,visible:P.visible,groups:[],tabType:P.tabType,insertBefore:P.insertBefore,insertAfter:P.insertAfter,autoFocus:P.autoFocus})}startBuildGroup(P){const Ta=this.Ssa(P.id);this.tfa=Object.assign(new If,
{id:Ta,mlrId:P.mlrId,title:P.label,controls:[],groupType:0})}addNativeGroup(P){this.tfa=Object.assign(new If,{id:P.id,mlrId:P.mlrId,title:P.label,controls:[],groupType:1});this.kWa.groups.push(this.tfa)}addButton(P){const Ta=this.Ssa(P.id);Ta&&(this.Wpb(Ta,P.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",P.actionType),P=Object.assign(new Df,{id:Ta,title:P.label,iconLocation:this.ugd(P),enabled:P.enabled,controlType:0,attributes:this.$_a()}),this.Y8d.doe(new tf.a(Ta,
this.Brb.command.toString())),this.tfa.controls.push(P))}addNativeControl(P){P.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",P.actionType),P=Object.assign(new Df,{id:P.id,title:"",iconLocation:"",enabled:P.enabled,controlType:2,attributes:this.$_a()}),this.tfa.controls.push(P))}startBuildMenu(P){const Ta=this.Ssa(P.id);Ta&&(this.sib=Object.assign(new Df,{id:Ta,title:P.label,iconLocation:this.ugd(P),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(P){const Ta=
this.Ssa(P.id);Ta&&(this.Wpb(Ta,P.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",P.actionType),P=Object.assign(new vf,{id:Ta,title:P.label,iconLocation:this.ugd(P),enabled:P.enabled,attributes:this.$_a()}),this.Y8d.doe(new tf.a(Ta,this.Brb.command.toString())),this.sib.menuItems.push(P))}endBuildMenu(){Aa.c(this.sib.id)||this.tfa.controls.push(this.sib);this.sib=null}endBuildGroup(){Aa.c(this.tfa.id)||this.kWa.groups.push(this.tfa);this.tfa=null}endBuildTab(){Aa.c(this.kWa.id)||
this.JRb.add(this.kWa);this.kWa=null}$_a(){const P={};this.uGa(P);return P}ugd(P){return P.icon["80"]?P.icon["80"]:P.icon["32"]}uGa(P){this.Brb.uGa(P)}Ssa(P){return this.gnc.TKa(P)}Wpb(P,Ta){this.RUc.bindAction(P,Ta)}}Object(d.a)(sg,"OneLineRibbonExtensibilityCreator",null,[747,748]);class ng{constructor(P,Ta){this.blb=P;this.AVa=new cf;this.ZVa=new of(Ta)}BVg(P){P=new Se(P);return new ze(P,this.ZVa,this.AVa)}rWg(P,Ta,Hb,lc){Hb=new df.a(this.blb,P,Hb,!0);return new sg(Hb,this.AVa,this.ZVa,P,Ta,lc)}}
Object(d.a)(ng,"UIExtensibilityFactory",null,[722]);var wg=a(91),yh=a(861),Fh=a(22),Vf=a(37),Lg=a(76),ug=a(50);class Rg{constructor(P){this.LGa=this.QGa=this.qk=this.So=null;this.hTf=0;this.bSi=()=>{if(this.qk&&this.LGa){const Ta=new wg.a(re.a.L2,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Ta,{["SourceControlId"]:this.LGa},null);n.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.GDj=(Ta,Hb)=>{Ta=null;if(Hb)if(Ta=Hb,this.qk=Ta.qk,(this.So=Ta.So)&&this.So.dW&&
this.So.dW.kt&&(this.QGa=this.So.dW.kt.na(0)),this.QGa&&this.QGa.id)if(this.QGa.isOfficeTab)if(Hb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Ta=this.qk.solutionId,Ta in Hb?this.LGa=Hb[Ta]:(Hb=Rg.GetPrivacyCompliantId(this.qk),n.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Hb}`),this.LGa=this.TLh(this.So)),this.LGa)if(Fh.a.contains(this.QGa.id,Jd.a.BW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn($e.a.g4a(this.So),
()=>{this.C8f(this.Ehd(this.LGa))});else{if(Hb=this.$.Ja)Hb.Dre(this.OHf),n.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else n.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Hb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Rg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Ba.a.Wj(Hb)})),this.p6();else this.E8f(this.Ehd(this.QGa.id),0);else n.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Hb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Rg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(Hb)})),this.p6();
else this.p6()};this.OHf=()=>{if(Fh.a.contains(this.QGa.id,appChrome.selectors.getSelectedTabId(),!0)){var Ta=this.$.Ja;Ta&&Ta.fVf(this.OHf);this.C8f(this.Ehd(this.LGa))}};this.dSi=()=>{var Ta={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Rg.sVa(this.WC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(Ta)}));this.p6();let Hb=
{};Hb[Lg.a.og]=this.WC;Ta={};Ta.solutionId=this.WC.solutionId;Ta.assetId=this.WC.assetId;Ta.assetStoreId=this.WC.assetStoreId;Ta.height=0!=this.WC.height?this.WC.height:600;Ta.storeId=this.WC.storeId;Ta.storeType=this.WC.storeType;Ta.targetType=this.WC.targetType;Ta.width=0!=this.WC.width?this.WC.width:600;Ta.displayName=this.WC.displayName;Ta.version=this.WC.version;Ta.isAddinCommands=!1;Hb[be.a.ssa]=Ta;let lc=new wg.a(-741808261,0,0,2,null);Vf.TaskExtensions.Aa(ug.GetServiceTaskFactory.Oa(this.$.da,
374,375,1),xc=>{xc=xc.result;null!=xc&&xc.insertAgave(Hb,lc)},this.$.la,3)};this.ILi=()=>{let Ta={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Rg.sVa(this.WC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(Ta)}));this.p6()};this.cNi=()=>{let Ta={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Rg.sVa(this.WC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(Ta)}));this.p6()};this.rW=Ta=>{n.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Ta?Ta.httpStatus:-1}`)};this.$=P.$;this.addinUICommandHandler=P;this.appName=nd.AFrameworkApplication.fa.Xa("WebAppShortName")||"Excel";this.fNg=nd.AFrameworkApplication.fa.rd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(P){return Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.storeType,P.assetId,null,null,P.storeId)}static sVa(P){return Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,P.storeType,P.assetId,null,null,P.storeId)}vcj(P){this.WC=P;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.dSi,!0),window.addEventListener("DismissCallout",this.cNi,!0),window.addEventListener("CloseCallout",this.ILi,!0))}Ehd(P){return"[id="+P+"]"}E8f(P,
Ta){Ta>this.fNg?(window.clearTimeout(this.hTf),this.D8f("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+P)?this.D8f(P):this.hTf=window.setTimeout(()=>{this.E8f(P,Ta+1)},1E3)}C8f(P){var Ta=document.querySelector("button[data-unique-id='RightPaddle']");if(Ta)P={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Rg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)}));else if(Ta=document.querySelector("button"+P),!Ta||"none"===window.getComputedStyle(Ta).display)if(Ta=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ta){Ta={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Rg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(Ta)}));n.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.p6();return}this.Zdg(Ta,"ShowTeachingUIForAddinButton")}D8f(P){P=document.querySelector("button"+P);if(!P&&(P=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!P)){P={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Rg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)}));n.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.p6();return}this.Zdg(P,"ShowTeachingUIForAddinTab")}Zdg(P,Ta){P.setAttribute("lpp-id","latestAddin");const Hb=Hc.a.instance.Ub("Common.ISystemInitiatedFeedback");Hb&&P?(Hb.execute(lc=>{lc.logActivity(Ta,null)}),P={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Rg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)})),n.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(n.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),P={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Rg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)})),this.p6())}TLh(P){if(!P)return null;P=P.dW;if((null===P||void 0===P?0:P.kt)&&0<P.kt.count)for(let Ta of P.kt)if(Ta.groups&&0<Ta.groups.length)for(const Hb of Ta.groups)if(Hb.controls&&0<Hb.controls.length)for(const lc of Hb.controls){if(lc.attributes&&
0===lc.controlType&&lc.enabled)return lc.id;if(lc.menuItems)for(const xc of lc.menuItems)if(xc.attributes&&xc.enabled)return lc.id}return null}bGj(){var P=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(P&&"none"!==window.getComputedStyle(P).display)n.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{P=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==P){P={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Rg.sVa(this.WC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)}));n.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.p6();return}n.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Ta=Hc.a.instance.Ub("Common.ISystemInitiatedFeedback");null==
Ta||null==P?(P={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Rg.sVa(this.WC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)})),n.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.p6()):(Ta.execute(Hb=>{Hb.logActivity("ShowTeachingUIForContentAddin",null)}),P={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Rg.sVa(this.WC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj(P)})),n.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}B7(P){const Ta={},Hb={};Hb.LastTeachingUIShowTime=(new Date).toUTCString();Hb.AddinHasShown=P;Ta[this.appName]=Ef.c(Hb);this.Dob=new Yf(this.appName,null,null,
this.rW),this.Dob.t3a(Ta),n.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}p6(){if(nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.ORa){const P=window.g_roamingAddinList;P&&(this.B7(P),this.ORa=!0)}}}Object(d.a)(Rg,"AddinTeachingCalloutHandler",null,[]);var Jh=a(1235),Qi=a(420),Zh=a(11),$h=a(183),ai=a(43),yg=a(21),lh=a(55);class bi{constructor(P,
Ta,Hb,lc,xc,cd,id=null){this.disposed=!1;this.qKi=(od,Fd)=>{if(Fd)if(Fd)if(od=Fd.qk){if(nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CheckIsDeepLinkTemplateFile",!1)&&(Cg()||Ig())){const Re=this.$.ea.workbookContext.WebExtensions;if(Re){let We=!1;for(var Rd of Re)if(Rd.PrimaryMarketplace.SolutionId.toLowerCase()===od.solutionId.toLowerCase()){We=!0;break}if(!We){n.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{n.ULS.sendTraceTag(512258443,
220,15,"Has no add-in persisted in the file.");return}}Fd=Fd.So;Rd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(od.solutionId in Rd)Fd=Rd[od.solutionId];else if(Fd=this.JPh(Fd),void 0===Fd||null===Fd){n.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Rd=new wg.a(re.a.L2,0,0,2,null);this.executeCommand(0,Rd,{["SourceControlId"]:Fd},null);od.isAutoLaunched=!0}else n.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else n.ULS.sendTraceTag(528098436,
220,15,"agaveParams is null");else n.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.mef=(od,Fd)=>{"Insert"==Fd.tabName&&(od=this.$.Ja,null!=od&&(od.fVf(this.mef),n.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.HOb.bGj())};this.cSi=(od,Fd)=>{od=null;Fd&&(od=Fd);(null===od||void 0===od?0:od.So)&&this.Lwj(od.So);this.$.af();z.EwaSettings.ma(87)&&od&&od.qk&&this.xSg(od.qk)};this.$=P;n.ULS.shipAssertTag(537170659,0,!(void 0===Ta||null===Ta),
`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${ai.a.gZ()}`);this.je=Ta;this.mFe=Hb;this.g0b=lc;this.iha=xc;this.Bob=cd;this.ap=new yh.a;this.hha=new wd;this.lbd=id;Oe.a.Tyb=Oe.a.KUe;this.m7c=new m.a;this.t2a=new m.a}dispose(){void 0!==this.Bob&&null!==this.Bob&&(this.Bob.dispose(),this.Bob=null);this.je=this.$=null;this.disposed=!0}UAj(P,Ta){switch(P){case re.a.L2:P=this.EAj(Ta);break;default:P=!1}return P}nc(){return!1}executeCommand(P,Ta,Hb){P=Vf.TaskExtensions.Sj();
Ta=Ta.command;switch(Ta){case 843847158:break;case -2025863019:Qb.a.bUd(Hb[be.a.gXc].toString(),()=>{yg.h(this.$).focus()});break;case -1777565636:Jh.a.showUILessDialog(Hb[be.a.Cob].toString());this.je.UDj(Hb[be.a.Cob].toString());break;case 1592314317:Jh.a.hideUILessDialog(Hb[be.a.Cob].toString());this.je.o$h(Hb[be.a.Cob].toString());break;case re.a.L2:P=this.Njd(Hb);break;case re.a.RCb:this.SCb(Hb);break;case re.a.zna:this.zna(Hb);break;case re.a.cUd:this.Bob.uzc();break;case re.a.refreshAddinCommands:this.paj();
break;case 1949669462:this.iha.E2f(!0);break;case -1014260128:P=this.executeDynamicAddInCommandsAPI(Hb);break;default:P=$h.a(Ta)}return P}wc(P,Ta){P=!1;switch(Ta.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case re.a.zna:case re.a.cUd:case re.a.refreshAddinCommands:case 1949669462:case re.a.RCb:case -1014260128:P=!0;break;case re.a.L2:P=!nd.AFrameworkApplication.protectedFile}return P}Kc(){return!1}JPh(P){if(!P)return n.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),
null;if((P=P.dW)&&P.kt&&0<P.kt.count)for(let Ta of P.kt){if(Ta.groups&&1===Ta.groups.length){P=Ta.groups[0];if(P.controls&&1===P.controls.length){const Hb=P.controls[0];if(Hb.attributes&&!Hb.controlType&&Hb.enabled)return Hb.id}P.controls&&n.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ta.groups&&n.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}paj(){if(this.iha.Jvd()){this.iha.OBe();var P=this.xed();if(P&&0<P.count)for(let Ta of P)P={[be.a.T2]:Ta,[be.a.wM]:4,
[be.a.OGa]:(new Date).getTime()},this.zna(P)}}zna(P){n.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${P[be.a.wM]}, DataProvider ${P[be.a.T2]}.`);this.iha.Zsj();window.setTimeout(()=>{if(void 0===this.je||null===this.je)n.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${ai.a.gZ()}`);else{const Ta=new nf(new ma(this.je.Xh),vb.instance,Ld.instance);Ta.dJg((Hb,
lc)=>{this.SCb(lc.properties)});nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&nd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Ta.wMg((Hb,lc)=>{null==lc?Ge.a.sendTelemetryEvent(Object(fd.a)(new Bf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ba.a.Wj({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"})})):(this.HOb=new Rg(this),this.HOb.vcj(lc),Hb=this.$.Ja,null!=Hb&&(Hb.Dre(this.mef),n.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Ta.uSj(P)}},0)}SCb(P){if(!this.disposed){n.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${P[be.a.wM]}.`);try{if(z.EwaSettings.ma(184)){const Hb=P[be.a.yob];if(Hb&&0<Hb.count){const lc=Hb.count;for(let xc=lc-1;0<=xc;xc--){const cd=Hb.na(xc);OSF.OsfControl.isFirstPartyStoreString(cd.storeType)||
Hb.remove(Hb.na(xc))}if(Hb.count<lc){const xc=ug.GetServiceTaskFactory.Oa(this.$.da,5,4,0);Vf.TaskExtensions.Aa(xc,()=>{xc.result.ng(36,null)},this.$.la,3)}if(!Hb.count)return}}if(void 0===this.je||null===this.je)n.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${ai.a.gZ()}`);else{var Ta=null;Ta=nd.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new $c(this.ap,this.mFe,new ma(this.je.Xh),new ng(this.$.Eb,re.a.L2),this.iha,
vb.instance,this.hha,(Hb,lc)=>{const xc={};xc.InstanceId=Ea.a.create().toString();xc.PrimaryMarketplace={};xc.PrimaryMarketplace.SolutionId=Hb.solutionId;xc.PrimaryMarketplace.SolutionVersion=Hb.version;xc.PrimaryMarketplace.MarketplaceType=Hb.storeType;xc.PrimaryMarketplace.MarketplaceRef=Hb.storeId;xc.WebExtensionType=1;this.je.hGj(xc,()=>{lc(Hb)})}):new $c(this.ap,this.mFe,new ma(this.je.Xh),new ng(this.$.Eb,re.a.L2),this.iha,vb.instance,this.hha);Ta.lJg(this.qKi);Ta.eJg(this.cSi);if(nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Hb=new Rg(this);Ta.WKg(Hb.bSi);Ta.vMg(Hb.GDj)}this.$.da.za(53).Em&&rc.a.get_instance().Xj(5,null).continueWith(()=>{this.disposed||Ta.Fvi(this.lbd,this.$.domElement,P)})}}catch(Hb){n.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Hb.message}.`)}}}Njd(P){const Ta=Vf.TaskExtensions.Sj();P=P[this.ap.lia];const Hb=this.g0b.SUc(P),lc=new Jh.a(this.$,this.je,Hb.ownerAddinInfo,Ta);return this.J8e(Ta,P,Hb,lc)}J8e(P,Ta,Hb,lc){this.g0b.Njd(Ta,this.iha,lc,new ma(this.je.Xh),
Hb,()=>{P=lc.Q6g()},()=>{yg.h(this.$).focus()});return P}xSg(P){const Ta=Vf.TaskExtensions.Sj();var Hb=this.je.Jaa(P.solutionId);if(Hb){var lc=this.je.FZ(Hb);if(Zh.HelperMethods.Gw(lc)&&0!==lc.SharedRuntime.State)return}lc=this.g0b.ySg;const xc=P.solutionId in lc?lc[P.solutionId]:null;if(xc){const cd=this.g0b.SUc(xc),id=new Jh.a(this.$,this.je,cd.ownerAddinInfo,Ta),od=Telemetry.PrivacyRules.GetPrivacyCompliantId(P.solutionId,null!==cd.ownerAddinInfo?cd.ownerAddinInfo.storeType:P.storeType,P.assetId,
null,null,P.storeId);lc=Fd=>{if(Fd){const Rd={};for(const Re of Fd)Rd[Re[0]]=Re[1];(Fd=be.a.Lre in Rd?Rd[be.a.Lre]:null)&&"true"===Fd.toLowerCase()&&(n.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${P.storeType}, StoreId ${P.storeId}, SolutionId ${od}.`),this.J8e(Ta,xc,cd,id))}};n.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${P.storeType}, StoreId ${P.storeId}, SolutionId ${od}.`);if(Hb)lc(this.je.FZ(Hb).OsfPropertyBag);else if(Hb=
this.$.ea.workbookContext.WebExtensions)for(const Fd of Hb)if((1===Fd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===P.targetType&&Fd.PrimaryMarketplace.MarketplaceType.toLowerCase()===P.storeType.toLowerCase()&&Fd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===P.storeId.toLowerCase()&&Fd.PrimaryMarketplace.SolutionId.toLowerCase()===P.solutionId.toLowerCase()){lc(Fd.OsfPropertyBag);break}}}EXd(P,Ta,Hb=!1){P&&(!Hb||Ta||this.m7c.contains(P)||this.m7c.add(P),(Hb=
this.t2a.contains(P))&&Ta&&this.t2a.remove(P),Hb||Ta||this.t2a.add(P))}Lwj(P){if((P=P.dW)&&P.kt)for(let Ta of P.kt)if(Ta.groups)for(const Hb of Ta.groups)if(Hb.controls)for(const lc of Hb.controls)if(this.EXd(lc.id,lc.enabled,!0),1===lc.controlType&&lc.menuItems)for(const xc of lc.menuItems)this.EXd(xc.id,xc.enabled,!0)}xed(){const P=new m.a;z.EwaSettings.ma(53)&&(this.$.ea.Wg.get(27)&&(P.add(0),P.add(16)),this.$.ea.Wg.get(33)&&P.add(1),P.add(8));return P}executeDynamicAddInCommandsAPI(P){let Ta=
!0;if(void 0===P||null===P||void 0===P[be.a.$tb]||null===P[be.a.$tb])return lh.Task.Ta(!1);switch(P[be.a.$tb]){case 1:Ta=this.BVj(P);break;case 2:Ta=this.Pwj(P);break;case 4:this.t2a.clear();this.t2a.addRange(this.m7c);break;case 3:Ta=this.installContextualTab(P);break;default:Ta=!1}return lh.Task.Ta(Ta)}EAj(P){return P&&this.ap.lia in P?(P=P[this.ap.lia])?this.t2a.contains(P):!1:!1}BVj(P){var Ta=null;let Hb=null,lc=null,xc=!0;void 0!==P[be.a.e4]&&null!==P[be.a.e4]&&void 0!==P[this.ap.lia]&&null!==
P[this.ap.lia]&&void 0!==P[be.a.d4]&&null!==P[be.a.d4]&&(Ta=P[be.a.e4],Hb=P[be.a.G8b],lc=P[this.ap.lia],xc=P[be.a.d4]);if(!Ta||!lc)return n.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;P=(new df.a(this.$.Eb,Ta,this.ap,!0)).TKa(lc);Ta={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ta.AssetId=Hb;Ta.MaskedTabId=P;Ta.IsToEnable=xc;n.ULS.sendTraceTag(537170648,220,50,y.a.hc(Ta));this.EXd(P,xc);Qi.a.yC.updateCommandUI();return!0}Pwj(P){var Ta,
Hb,lc=null,xc=null;let cd=null;var id=null;let od=!0;void 0!==P[be.a.R8c]&&null!==P[be.a.R8c]&&void 0!==P[be.a.e4]&&null!==P[be.a.e4]&&void 0!==P[this.ap.lia]&&null!==P[this.ap.lia]&&void 0!==P[be.a.d4]&&null!==P[be.a.d4]&&(lc=P[be.a.R8c],xc=P[be.a.e4],cd=P[be.a.G8b],id=P[this.ap.lia],od=P[be.a.d4]);if(!lc||!xc||!id)return n.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;P=(new df.a(this.$.Eb,xc,this.ap,!0)).U6e(id);id={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
id.StoreType=lc;id.AssetId=cd;id.MaskedTabId=P;id.IsToShow=od;n.ULS.sendTraceTag(537170646,220,15,y.a.hc(id));lc=this.iha.ija(lc,xc,1);xc=!1;if(null===(Hb=null===(Ta=null===lc||void 0===lc?void 0:lc.So)||void 0===Ta?void 0:Ta.dW)||void 0===Hb?0:Hb.kt)for(let Fd of lc.So.dW.kt)if(Fd.id===P){xc=!0;break}if(!xc)return n.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ta=[];od?appChrome.selectors.getSelectedTabId()!==P&&Ta.push(appChrome.actions.activateRibbonTab(P)):
(appChrome.selectors.getSelectedTabId()===P&&Ta.push(appChrome.actions.setCurrentTab(Jd.a.BW)),Ta.push(appChrome.actions.deactivateRibbonTab(P)));appChrome.api.dispatch(Ta);return!0}installContextualTab(P){let Ta=null,Hb=null,lc=null;var xc=null;if(void 0!==P[be.a.e4]&&null!==P[be.a.e4]&&void 0!==P[be.a.d4]&&null!==P[be.a.d4]){const cd=P[be.a.d4];Ta=P[be.a.e4];void 0!==cd[be.a.zJa]&&null!==cd[be.a.zJa]&&void 0!==cd[be.a.AJa]&&null!==cd[be.a.AJa]&&(Hb=cd[be.a.zJa],lc=cd[be.a.AJa],xc=cd[be.a.S8c])}if(!(Ta&&
lc&&Hb&&xc))return n.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;P=this.iha.ija(xc.PrimaryMarketplace.MarketplaceType,xc.PrimaryMarketplace.SolutionId,1);if(null===P||void 0===P?0:P.So)return n.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;P={};P.solutionId=xc.PrimaryMarketplace.SolutionId;P.version=xc.PrimaryMarketplace.SolutionVersion;P.storeType=xc.PrimaryMarketplace.MarketplaceType;P.storeId=xc.PrimaryMarketplace.MarketplaceRef;
z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?xc.AssetMarketplace?(P.assetId=xc.AssetMarketplace.SolutionId,P.assetStoreId=xc.AssetMarketplace.MarketplaceRef):(P.assetId=null,P.assetStoreId=null):(P.assetId=xc.PrimaryMarketplace.SolutionId,P.assetStoreId=xc.PrimaryMarketplace.MarketplaceRef);P.targetType=xc.WebExtensionOsfControlType;P.width=xc.TaskpaneWidth;P.height=0;P.isAddinCommands=!0;xc=new m.a;xc.add(P);P={};P[be.a.yob]=xc;P[be.a.wM]=6;P[be.a.zJa]=Hb;
P[be.a.AJa]=lc;this.SCb(P);return!0}}Object(d.a)(bi,"AddinUICommandHandler",null,[221,223,2]);var qi=a(63),ri=a(600),Ri=a(18),Si=a(16);class Ch extends Bd.a{constructor(P){super(P);this.handler=null;this.QEg=()=>{n.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.qd&16384)}]`);const Ta=new kd.a;this.$.da.$a(53,Rd=>{n.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
Ta.setResult(Rd)});const Hb=Ta.task,lc=new Dd,xc=de.a.getInstance(),cd=new oe(this.$,xc),id=ug.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Ya),od=this.Zaj(lc),Fd=ug.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Ya);return Vf.TaskExtensions.Aa(Vf.TaskExtensions.Ed([Hb,id,od,Fd],this.la),()=>{n.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Vf.TaskExtensions.Aa(ug.GetServiceTaskFactory.create(this.$.da,106,this.la,
this.Ya),Rd=>{this.handler=new bi(this.$,Rd.result,lc,new sc,xc,cd,Hc.a.instance.Kh("Common.IExternalUICommandDefinitionMapping"));n.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Yc([this.handler]);this.$.da.Ga(198,this.handler)},this.la,3)},this.la,3)};this.fhh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ja.mcb(this.handler),this.$.da.BU(198),this.handler=null):n.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
this.$.da.BU(204);Si.a(Ri.a,20,this.$.da,198)}}ld(){n.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");qi.a(this.$).add(Object(fd.a)(new ri.a,{Fyc:()=>{const P=this.$.ea.fI&&this.$.ea.Zb&&!!(this.$.qd&16384)&&this.$.isEditMode;this.$.ea.Zb&&n.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${P}] IsSessionFullyLoaded [${this.$.ea.fI}] IsSessionActive [${this.$.ea.Zb}] ShowCommandUI [${!!(this.$.qd&
16384)}] IsEditMode [${this.$.isEditMode}]`);return P},rZb:this.QEg,W6b:this.fhh,z3a:2}))}Zaj(P){const Ta=ug.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya);return Vf.TaskExtensions.Aa(Ta,()=>{n.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ga(204,new Db(Ta.result,P))},this.la,3)}static ka(P){Bd.a.Nd(199,new Ch(P))}}Object(d.a)(Ch,"AddinUICommandHandlerFactory",Bd.a,[]);var gh=a(1192),
si=a(1195),Oh=a(695);class ph extends h.a{constructor(P){super();this.$=P;this.Fb()}create(){let P;if(z.EwaSettings.ma(396)){const Ta=ug.GetServiceTaskFactory.create(this.$.da,106,this.$.la,this.Ya),Hb=ug.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.Ya);Vf.TaskExtensions.Aa(lh.Task.jJ(Ta,Hb),()=>{this.ob(Object(Oh.a)(this.$.da,278,()=>new gh.CustomFunctionsInstaller(this.$,Ta.result,Hb.result)))},this.$.la,3)}else P=Object(Oh.a)(this.$.da,278,()=>new si.CustomFunctionsLegacyInstaller(this.$)),
this.ob(P)}static ka(P){P.da.Ga(279,new ph(P))}}Object(d.a)(ph,"CustomFunctionsInstallerFactory",h.a,[]);var ci=a(87),qh=a(47),Fi=a(46);class di{constructor(P,Ta){this.NQa=this.OQa=null;this.beg=(Hb,lc)=>{let xc=null,cd=null,id=null;lc?(Object(U.a)(327,lc)?(xc=lc.VGa,id=lc.instanceId):Object(U.a)(322,lc)&&(xc=lc.get_element(),id=lc.instanceId),xc)?(cd=Object(N.a)(678,Hb),cd)?this.LQf(id,xc,cd)||id in this.NQa||(this.OQa[id]=0,this.NQa[id]=qh.a.instance.ZC(()=>{10<=this.OQa[id]||this.LQf(id,xc,cd)?
(delete this.OQa[id],this.NQa[id].dispose(),delete this.NQa[id]):this.OQa[id]+=1},500,Fi.a.RNg,!0,!1)):n.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):n.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):n.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=P;this.$=Ta;this.XYc=!1;this.$.da.Ga(224,this)}ka(P){this.XYc?n.ULS.sendTraceTag(537170629,0,
10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.XYc=!0,this.NQa={},this.OQa={},P?P.PJg(this.beg):n.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(P){if(P){P.hfj(this.beg);P=this.NQa;for(let Ta in P)ci.a.Ia(P[Ta]);this.OQa=this.NQa=null;this.XYc=!1}else n.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}LQf(P,Ta,Hb){if(this.rii(Hb,P))return!1;
P=Ta.querySelector("iframe");if(!P)return n.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;P=P.title;if(!P||!P.length)return n.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(P);return!0}rii(P,Ta){return(P=P.Xh.getOsfControl(Ta))?P.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(d.a)(di,"AgaveOnSelectedReadoutHandler",null,[679]);
class Xc extends h.a{constructor(P){super();this.$=P;this.Fb()}create(){const P=this.$.da;Vf.TaskExtensions.Aa(ug.GetServiceTaskFactory.Oa(P,211,212,this.Ya),Ta=>{Ta=P.za(224)||new di(Ta.result,this.$);this.ob(Ta)},this.la,3)}static ka(P){P.da.Ga(225,new Xc(P))}}Object(d.a)(Xc,"AgaveOnSelectedReadoutHandlerFactory",h.a,[]);var Cd=a(734),Sg=a(53);const Gi=(P,Ta)=>Sg.a.Fvd(65,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,nd.AFrameworkApplication.fa.rd("MaxRetriesForLoadingScript",
0),P,Ta);var ti=a(240);class ei{constructor(P,Ta,Hb){this.iframe=P;this.onSuccess=Ta;this.onError=Hb;$addHandler(window,"message",Object(ae.a)(this,this.T9e,"handleResponse"))}T9e(P){try{if(P&&P.rawEvent&&P.rawEvent.origin&&this.iframe&&this.iframe.id){var Ta=this.qKf(P.rawEvent.origin);const Hb=this.qKf(document.domain);if(Q.a.Yj().equals(Hb,Ta))if(P.rawEvent.source&&P.rawEvent.source.frameElement&&P.rawEvent.source.frameElement.id&&Q.a.Yj().equals(P.rawEvent.source.frameElement.id,this.iframe.id)){Ta=
null;try{Ta=JSON.parse(P.rawEvent.data)}catch(lc){n.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",lc.message)}Ta?(Ta.statusCode!==ti.a.lP||void 0!==Ta.error&&Ta.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Ta.statusCode,Ta.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.onSuccess(Ta.authorizationCode?Ta.authorizationCode:Ta.signInUrl)),$removeHandler(window,"message",Object(ae.a)(this,this.T9e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Hb){n.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Hb.message)}}qKf(P){let Ta=
"";try{P&&(Ta=-1<P.indexOf("//")?P.split("/")[2]:P.split("/")[0])&&(Ta=Ta.split(":")[0],Ta=Ta.split("?")[0])}catch(Hb){n.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Hb.message)}return Ta}static ka(P,Ta,Hb){new ei(P,Ta,Hb)}}Object(d.a)(ei,"ResponseHandler",null,[]);var Hi=a(252);class hh{constructor(P){this.hGa=P}tryAuthenticate(P,Ta){this.Xab(hh.Jvg,()=>{P()},Ta)}tryAuthorize(P,Ta){this.Xab(hh.Pqg,P,Ta)}getSignInUrl(P,Ta){this.Xab(hh.fke,P,Ta)}signOut(P,Ta){this.Xab(hh.IBg,
P,Ta)}Xab(P,Ta,Hb){var lc=new Hi.QueryStringBuilder("AuthenticationProxyHandler.aspx");lc.Yi("responseType",P);nd.AFrameworkApplication.mZa(lc);lc=String.format("{0}{1}&{2}",this.hGa,lc.toString(),nd.AFrameworkApplication.Ii);const xc=document.createElement("iframe");xc.setAttribute("id","privateCatalogIframe");xc.setAttribute("name","privateCatalogIframe");xc.setAttribute("style","display: none");Q.a.Yj().equals(P,hh.fke)||xc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");
ei.ka(xc,Ta,Hb);xc.setAttribute("src",lc);document.body.appendChild(xc)}}hh.Pqg="authcode";hh.Jvg="identitytoken";hh.fke="signinurl";hh.IBg="signout";Object(d.a)(hh,"AuthenticationProxy",null,[]);class pg{}pg.getUserId="getUserId";pg.getLastStoreUpdate="laststoreupdate";pg.getEntitlement="getEntitlements";pg.getEToken="getEToken";pg.getManifest="getManifest";pg.getAppState="getAppState";pg.getKilledApps="getRemovedAddins";pg.getAppDetails="getAppDetails";pg.removeApps="removeAddin";pg.getLastPrivateCatalogUpdate=
"getLastPrivateCatalogUpdate";pg.getPrivateCatalogAddIns="getAddIns";pg.getPrivateCatalogManifests="getAppManifests";pg.isStoreDisabled="isStoreDisabled";Object(d.a)(pg,"S2SWebRequestActions",null,[]);var Ii=a(575);class rh{getUserId(P,Ta){const Hb=new m.a;Hb.add(new Pd.a("corr",P));this.bX(pg.getUserId,Hb,1,Ta)}getLastStoreUpdate(P,Ta,Hb){const lc=new m.a;lc.add(new Pd.a("lc",P));lc.add(new Pd.a("corr",Ta));this.bX(pg.getLastStoreUpdate,lc,1,Hb)}getEntitlement(P,Ta,Hb,lc){P=new m.a;P.add(new Pd.a("av",
Ta));P.add(new Pd.a("corr",Hb));this.bX(pg.getEntitlement,P,1,lc)}getEToken(P,Ta,Hb,lc,xc,cd){const id=new m.a;id.add(new Pd.a("cmu",P));id.add(new Pd.a("cmf",Ta));id.add(new Pd.a("assetid",Hb));id.add(new Pd.a("expver",lc));id.add(new Pd.a("corr",xc));this.bX(pg.getEToken,id,1,cd)}getManifest(P,Ta,Hb,lc){const xc=new m.a;xc.add(new Pd.a("cmu",P));xc.add(new Pd.a("assetid",Ta));xc.add(new Pd.a("corr",Hb));this.bX(pg.getManifest,xc,1,lc)}getAppState(P,Ta,Hb){const lc=new m.a;lc.add(new Pd.a("ma",P));
lc.add(new Pd.a("corr",Ta));this.bX(pg.getAppState,lc,1,Hb)}getKilledApps(P,Ta){const Hb=new m.a;Hb.add(new Pd.a("corr",P));this.bX(pg.getKilledApps,Hb,1,Ta)}getAppDetails(P,Ta,Hb,lc){const xc=new m.a;xc.add(new Pd.a("cmo",P));xc.add(new Pd.a("corr",Hb));this.sendWithBody(pg.getAppDetails,xc,Ta,2,lc,!1)}removeApps(P,Ta,Hb){const lc=new m.a;lc.add(new Pd.a("corr",Ta));this.sendWithBody(pg.removeApps,lc,P,2,Hb,!1)}getLastPrivateCatalogUpdate(P,Ta,Hb,lc,xc,cd){const id=new m.a;id.add(new Pd.a("catalog",
"privatecatalog"));id.add(new Pd.a("clientCode",P));id.add(new Pd.a("clientVersion",Ta));id.add(new Pd.a("corr",xc));P=String.format("authorizationCode={0}&refreshToken={1}",Hb?Xf.a.mf(Hb):"",lc?Xf.a.mf(lc):"");this.sendWithBody(pg.getLastPrivateCatalogUpdate,id,P,2,cd,!0)}getPrivateCatalogAddIns(P,Ta,Hb,lc,xc,cd){const id=new m.a;id.add(new Pd.a("catalog","privatecatalog"));id.add(new Pd.a("clientCode",P));id.add(new Pd.a("clientVersion",Ta));id.add(new Pd.a("corr",xc));P=String.format("authorizationCode={0}&refreshToken={1}",
Hb?Xf.a.mf(Hb):"",lc?Xf.a.mf(lc):"");this.sendWithBody(pg.getPrivateCatalogAddIns,id,P,2,cd,!0)}getPrivateCatalogManifests(P,Ta,Hb,lc,xc){const cd=new m.a;cd.add(new Pd.a("catalog","privatecatalog"));cd.add(new Pd.a("corr",lc));P=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Xf.a.mf(P),Ta?Xf.a.mf(Ta):"",Hb?Xf.a.mf(Hb):"");this.sendWithBody(pg.getPrivateCatalogManifests,cd,P,2,xc,!0)}isStoreDisabled(P,Ta){const Hb=new m.a;Hb.add(new Pd.a("corr",P));this.bX(pg.isStoreDisabled,
Hb,2,Ta)}bX(P,Ta,Hb,lc){this.sendWithBody(P,Ta,null,Hb,lc,!1)}sendWithBody(P,Ta,Hb,lc,xc,cd){const id=new Hi.QueryStringBuilder("AddinServiceHandler.ashx");id.Yi("action",P);id.Yi("app",Ii.a[nd.AFrameworkApplication.sa.Pa.Gj]);for(let od of Ta)id.Yi(od.key,od.value);Ta=String.format("{0}{1}&{2}",nd.AFrameworkApplication.sa.Pa.Z_,id.toString(),nd.AFrameworkApplication.Ii);nd.AFrameworkApplication.Dd.Pm(Ta,lc,Hb,null,!1,2,od=>{let Fd=null,Rd=null;od&&od.data&&(od.data.responseHeaders["X-BlockedForMinor"]&&
"1"===od.data.responseHeaders["X-BlockedForMinor"].toString()&&(od.data.httpStatus=451),Fd=od.data.ue,Rd=od.data.responseHeaders);xc(od.data.httpStatus,Fd,Rd)},od=>{var Fd=null;let Rd=null;cd&&od&&od.data&&od.data.ue&&(Fd=od.data.ue,Rd=od.data.responseHeaders);xc(od.data.httpStatus,Fd,Rd);if(nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Fd={message:"AddinServiceHandler request failed"};Fd.code=od.data.httpStatus;Fd.action=P;
if(od.data.request||od.data.request.get_headers())Fd["X-UserSessionId"]=od.data.request.get_headers()["X-UserSessionId"];408===od.data.httpStatus||503===od.data.httpStatus?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Fd)):n.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Fd))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",od.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+P,void 0,void 0,void 0,["X-UserKey"])}}Object(d.a)(rh,"S2SWebRequestManager",
null,[]);class fi extends h.a{constructor(P){super();this.KQf=this.ddaFacade=null;this.$=P;P.da.Ga(106,this);this.Fb()}get je(){return this.ddaFacade||(this.ddaFacade=new Cd.DdaFacade(this.$,this.KQf))}create(){n.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");nd.AFrameworkApplication.disableWholeAppsForOfficeFeature?n.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${nd.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
z.EwaSettings.ma(400)?Hc.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(P=>{P.isFeatureEnabled("mso_officeStore",!0).then(Ta=>{Cd.DdaFacade.c5b=Ta;this.tHe();return null})}):this.tHe()}tHe(){const P=ug.GetServiceTaskFactory.Oa(this.$.da,224,225,this.Ya),Ta=Sg.a.Fvd(64,()=>!(void 0===window.OSF||null===window.OSF),this.$.va.MaxRetriesForLoadingScript,this.$.la,this.Ya,106),Hb=Gi(this.la,this.Ya);Vf.TaskExtensions.Aa(Vf.TaskExtensions.Ed([P,Ta,Hb],this.$.la),
()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?n.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${ai.a.gZ()}`):this.Rci();n.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.KQf=P.result;this.ob(this.je);n.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)}Rci(){z.EwaSettings.ma(64)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new rh);
this.$.ie.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new rh,new hh(nd.AFrameworkApplication.fa.appSettings.WebServiceBase),z.EwaSettings.ma(71),z.EwaSettings.ma(427));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new rh);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new rh)}dispose(){ci.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static ka(P){new fi(P)}}Object(d.a)(fi,"DdaFacadeServiceFactory",
h.a,[]);var gi=a(460);class Ji{constructor(P,Ta,Hb,lc,xc,cd){this.$=P;this.agaveCommandManager=cd}Kc(){return!1}nc(){return!1}wc(P,Ta,Hb,lc){let xc=!1;switch(Ta.command){case -684355545:xc=!0;break;case -741808261:xc=!!Hb;break;case -859308420:xc=!!lc&&1===lc.mz;break;case 418618014:xc=1===P&&!!lc&&1===lc.mz;break;case -515602470:Ta=z.EwaSettings.ma(232)&&2===P;xc=(1===P||Ta)&&!!lc&&1===lc.mz;break;case 2086613372:xc=z.EwaSettings.ma(232)&&2===P&&!!lc&&1===lc.mz;break;case -1336341324:xc=z.EwaSettings.ma(475)&&
1===P&&!!lc&&1===lc.mz;break;case 451940422:xc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===P&&!!lc&&1===lc.mz;break;case -1444574190:case -336193495:xc=1===P&&!!lc&&1===lc.mz;break;case 1296389134:xc=1===P&&!!lc&&1===lc.mz;break;case -1473679467:xc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===P&&!!lc&&1===lc.mz;break;case 1221897806:xc=z.EwaSettings.ma(164)&&2===P;break;case 1172793074:case 1930653487:xc=
z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===P;break;case -1753056834:xc=!0;break;case 932597253:xc=!0;break;case 301511274:xc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:xc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:xc=this.$.isEditMode&&this.$.ea.OMb}return xc}executeCommand(P,Ta,Hb){let lc=Vf.TaskExtensions.Sj();
const xc=Ta.command;switch(Ta.command){case -1473679467:gi.a(this.$,488,489,1,cd=>{lc=cd.Nfi(Hb.SourceControlId,Ta)});break;case 1296389134:this.agaveCommandManager.iJj(Hb.SourceControlId,Hb.LabelText);break;case -684355545:this.agaveCommandManager.s0c();break;case -741808261:lc=this.agaveCommandManager.insertAgave(Hb,Ta);gi.a(this.$,488,489,1,cd=>{cd.sFg(Hb)});break;case -1336341324:z.EwaSettings.ma(475)&&(lc=this.agaveCommandManager.bkd(Hb,P,Ta));break;case 1172793074:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(lc=this.agaveCommandManager.bkd(Hb,P,Ta));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:lc=this.agaveCommandManager.bkd(Hb,P,Ta);break;default:lc=$h.a(xc)}return lc}}Object(d.a)(Ji,"AgaveCommandHandler",null,[223]);class Kh{}Object(d.a)(Kh,"Selection",null,[]);var hi=a(1304),Lh=a(1303),kg=a(1305),vg=a(1394),ui=a(1306);
class zh{}Object(d.a)(zh,"SmartLookupApplicationInterface",null,[]);class Ki{}Object(d.a)(Ki,"ApplicationProperties",null,[]);class ii{}Object(d.a)(ii,"EnterpriseUserInfo",null,[]);class Ah{}Object(d.a)(Ah,"FeatureGates",null,[]);class ji{constructor(P,Ta,Hb=!0){this.gPj=9E5;this.jPj=3E5;this.ixd=null;this.Urf="";this.fxd=0;this.ktb=Date.now;this.xya=P;this.E9a=Ta;Hb&&this.ued()}N0h(){const P=this.ktb();if(P<this.fxd+this.gPj)return P>this.fxd+this.jPj&&this.ued(),this.Urf;this.ued();return""}ued(){this.ixd=
this.ixd||new Promise(P=>{this.O0h().then(Ta=>{this.Urf=Ta;this.fxd=this.ktb();this.ixd=null;P(Ta)})})}O0h(){return this.E9a&&this.E9a.length?new Promise(P=>{this.xya.PL("SmartLookup",this.E9a).then(Ta=>{Ta.IsSuccess?Ta.Token||(P(""),n.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(n.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Ta.ErrorCode+": "+Ta.ErrorMessage),P(""));P(Ta.Token)}).catch(Ta=>{Ta=Ef.c(Ta);n.ULS.sendTraceTag(51446546,
1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ta);P("")})}):(n.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(d.a)(ji,"SmartLookupAuthenticationManager",null,[712]);class jf{static QRh(){switch(Object(N.a)(String,nd.AFrameworkApplication.Qb.AudienceGroup)||""){case "Dogfood":if(nd.AFrameworkApplication.fa){let P=nd.AFrameworkApplication.fa.Xa("UserPrincipalName");P=Xf.a.ul(P);const Ta=nd.AFrameworkApplication.fa.Zp("SmartLookupINTEnabledForSKITeam")?
nd.AFrameworkApplication.fa.Cw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Ta,P)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static n0h(){switch(nd.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":nd.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":nd.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?"INT":jf.QRh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";
case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(d.a)(jf,"Utils",null,[]);var Dh=a(556),Tg=a(170);class zg{constructor(P){n.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Asf=nd.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");this.mBi=nd.AFrameworkApplication.fa.Xa("SmartLookupApprovedOriginPattern");this.E9a=nd.AFrameworkApplication.fa.Xa("SmartLookupShredderServiceEndpoint");
this.RBi=Hg.a.hN(nd.AFrameworkApplication.fa.Xa("AppCatalogUrl")||"");this.D9a=new Ah;this.D9a.EnableAllTabV2=!0;this.D9a.EnableIntentService=!0;this.D9a.EnableInDocumentSearch=nd.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.D9a.EnableLocalSearch=nd.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.D9a.IntentServiceEndpoint=jf.n0h();this.MBi=new ji(P,this.E9a)}get approvedOriginPattern(){return this.mBi}vMh(){return Promise.resolve(this.wMh())}wMh(){const P=
new Ki;P.anid="";P.applicationVersion=nd.AFrameworkApplication.buildVersion;P.appCorrelationId=Tg.a.create().toString();P.themePlatform=zg.b1j;P.lcid=nd.AFrameworkApplication.lcid;P.launchUtcTime=(new Date).toUTCString();P.featureGates=this.D9a;var Ta=Dh.a.qK(nd.AFrameworkApplication.lcid);Ta=Ta?Ta.name:null;P.market=this.Pbc(Ta);P.uiLanguage=Ta;P.sessionId=nd.AFrameworkApplication.userSessionId;P.themeId=0;P.parentalControl=zg.H_i;const Hb=new ii;Hb.CountryCode=this.Pbc(Ta);Hb.ServiceEndpoint=this.E9a;
Hb.IsGoLocal=!1;Hb.IsEnabled=this.Asf;Hb.IsEnterpriseEnabled=this.Asf;Hb.TenantRoot=this.RBi;P.enterpriseUserInfo=Hb;P.accessToken=this.MBi.N0h();return P}Pbc(P){P=P.split("-");return P[P.length-1]}}zg.b1j="web";zg.H_i="yes";Object(d.a)(zg,"SmartLookupManager",null,[699]);class Ag extends qd.a{constructor(P){super();this.$=P;this.isFirstLaunch=!1}Kc(){return!1}nc(){return!1}wc(P,Ta){P=z.EwaSettings.ma(134);return-983891024===Ta.command&&P}executeCommand(P,Ta){P=Vf.TaskExtensions.Sj();-983891024===
Ta.command&&this.nvi();return P}nvi(){var P=new zg(null);const Ta={};var Hb=yg.h(this.$).Sb(null).originalText;Hb=Object(fd.a)(new Kh,{neighborhood:Hb,mentionStart:0,mentionLength:Hb?Hb.length:0});const lc=Object(fd.a)(new zh,{selection:Hb,entryPoint:0});P.vMh().then(cd=>{cd.applicationName=Ag.appName;cd.isFirstLaunch=this.isFirstLaunch;cd.themeId=5;Ta[Ag.smartLookupApplicationInterface]=JSON.stringify(lc);Ta[Ag.hPg]=JSON.stringify(cd);this.isFirstLaunch=!1});P=new hi.a("ExcelOnline","Web","en-Us");
Hb=new Lh.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const xc=new kg.a;xc.optionalProperties[vg.a.kj]=Td.a.instance.ga(1801);xc.optionalProperties[vg.a.taskPaneWidth]=350;xc.optionalProperties[vg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";xc.Bh=Ta;ui.a.instance.f6(Hb,"Taskpane","SmartLookupSDXTaskpane",P,xc)}}Ag.hPg="AppProperties";Ag.appName="Excel";Ag.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(d.a)(Ag,"SmartLookupCommandHandler",
qd.a,[223]);class Ph extends Bd.a{constructor(P){super(P)}ld(){gi.a(this.$,374,375,this.Ya,P=>{this.Yc([new Ji(this.$,null,null,null,null,P),new Ag(this.$)])})}static ka(P){Bd.a.Nd(76,new Ph(P))}}Object(d.a)(Ph,"AgaveCommandHandlerFactory",Bd.a,[]);var Qh=a(1319),sh=a(105);class kh{constructor(){this.je=null;this.Cbb=(P,Ta,Hb,lc,xc)=>{if(2===Hb){P=xc?xc:{};Ta=P.callback;Hb=P.refresh?P.refresh:!1;if(!Ta)return 16;nd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&
null!=P.storeType?this.je.rOf(Ta,Hb,P.storeType):this.je.sda(Ta,Hb)}return 32};this.Wbj=(P,Ta,Hb,lc,xc)=>{2===Hb&&(P=xc?xc.callback:null)&&this.je.OJg(P);return 32};this.Mfi=(P,Ta,Hb,lc,xc)=>{2===Hb&&this.je.oDd(null,OSF.AgaveHostAction.InsertAgave,xc);return 32}}initialize(P){kh.initialized||(this.je=P,this.Hg(),kh.initialized=!0)}Hg(){nd.AFrameworkApplication.ub.Ne(re.a.Cbb,sh.a.frame,this.Cbb,96);nd.AFrameworkApplication.ub.Nb(re.a.Paj,sh.a.frame,this.Wbj);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",
!1)&&nd.AFrameworkApplication.ub.Ne(re.a.jef,sh.a.frame,this.Mfi,96)}static get instance(){kh.Ma||(kh.Ma=new kh);return kh.Ma}}kh.Ma=null;kh.initialized=!1;Object(d.a)(kh,"AgaveCommandActor",null,[]);var Wg=a(1361),ki=a(1308),Rh=a(111),Sh=a(354),Ti=a(351),Ui=a(1239),Mg=a(19),Li=a(346);class vi{constructor(){this.WXd=this.lBc=null;this.vq=0;this.jBc=null}}Object(d.a)(vi,"FirstPartyAddinTaskpaneOverrides",null,[]);class li{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=
null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(d.a)(li,"IdeasSelectionContext",null,[]);class wi extends li{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(d.a)(wi,"IdeasTableSelectionContext",li,[]);class th{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(d.a)(th,"AutoFilterRange",
null,[]);class mi{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(d.a)(mi,"IdeasAutoFilterSource",null,[]);class xi{constructor(P,Ta){this.selection=P;this.tables=Ta}}Object(d.a)(xi,"IdeasXLIMTableBoundaries",null,[]);var Dg=a(60);const Th=(P,Ta,Hb,lc,xc,cd,id=null)=>{id=P.Na(9,id);id.sharedInfo=Ta;return Dg.g(P,"ShowAgaveTaskpane",id,Hb,lc,xc,cd,0)};var Ug=a(857),Gh=a(64),yi=a(132),Eh=a(42),lg=a(371),Hh=a(188),zi=a(162),Vi=a(564),Tf=a(281),uh=a(103),Wi=
a(133),Uh=a(51),mh=a(146),ah=a(180);class Ai extends mh.a{constructor(){super();this.qfa="calc(100% - 46px)";this.JDa="15px";this.rfa="0";this.kJc="WACDialogPanel";this.WX=695;this.lJc=462;this.jqa="80%";this.$Gc=350;this.Ahb="100%";this.Rb=5;this.Fe="AppsForOfficeInsertionDialog";this.wJc=!!nd.AFrameworkApplication.fa&&nd.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}Vz(){super.Vz();this.Wk.style.width=this.Ahb;this.Wk.style.height=this.qfa;this.Wk.style.marginTop=
this.JDa;this.Wk.style.padding=this.rfa}kAa(){this.Wk.style.width=this.Ahb;this.Wk.style.height=this.qfa;this.Wk.style.marginTop=this.JDa;this.Wk.style.padding=this.rfa;this.WX>ah.a.Nma?(this.wb.style.width=String.format("{0}px",ah.a.Nma),this.wb.style.overflowX="scroll",nd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.WX),this.wb.style.overflowX="hidden");this.wb.offsetHeight>ah.a.Mma||this.lJc+50>ah.a.Mma?(this.wb.style.height=
String.format("{0}px",ah.a.Mma),this.wb.style.overflowY="scroll",this.wb.style.top="0",nd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0",this.wJc||(this.wb.style.marginTop="-48px"),this.Wk.style.minHeight=String.format("{0}px",this.$Gc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.jqa);this.cta()}cta(){if(this.wb){var P=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.WX>ah.a.Nma)nd.AFrameworkApplication.isRtl?this.wb.style.marginRight=
"0":this.wb.style.marginLeft="0";else{const Ta=String.format("{0}px",Math.floor(-this.wb.offsetWidth/2));nd.AFrameworkApplication.isRtl?this.wb.style.marginRight=Ta:this.wb.style.marginLeft=Ta;nd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(P)}else n.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}VI(){super.VI();const P=document.getElementById(this.mi(this.kJc));P.style.width=String.format("{0}px",this.WX);
P.style.height=this.jqa}get Fia(){return this.Wk}}Object(d.a)(Ai,"AppsForOfficeInsertionDialog",mh.a,[133]);class Mi extends mh.a{constructor(){super();this.qfa="calc(100% - 46px)";this.JDa="15px";this.rfa="0";this.kJc="WACDialogPanel";this.WX=695;this.lJc=462;this.jqa="80%";this.$Gc=350;this.Ahb="100%";this.Rb=5;this.Fe="SDXDialog"}Vz(){super.Vz();this.Wk.style.width=this.Ahb;this.Wk.style.height=this.qfa;this.Wk.style.marginTop=this.JDa;this.Wk.style.padding=this.rfa}kAa(){this.Wk.style.width=this.Ahb;
this.Wk.style.height=this.qfa;this.Wk.style.marginTop=this.JDa;this.Wk.style.padding=this.rfa;this.WX>ah.a.Nma?(this.wb.style.width=String.format("{0}px",ah.a.Nma),this.wb.style.overflowX="scroll",nd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.WX),this.wb.style.overflowX="hidden");this.wb.offsetHeight>ah.a.Mma||this.lJc+50>ah.a.Mma?(this.wb.style.height=String.format("{0}px",ah.a.Mma),this.wb.style.overflowY="scroll",
this.wb.style.top="0",nd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0",this.Wk.style.minHeight=String.format("{0}px",this.$Gc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.jqa);this.cta()}cta(){if(this.wb){var P=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.WX>ah.a.Nma)nd.AFrameworkApplication.isRtl?this.wb.style.marginRight="0":this.wb.style.marginLeft="0";else{const Ta=String.format("{0}px",Math.floor(-this.wb.offsetWidth/
2));nd.AFrameworkApplication.isRtl?this.wb.style.marginRight=Ta:this.wb.style.marginLeft=Ta;nd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(P)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}VI(){super.VI();const P=document.getElementById(this.mi(this.kJc));P.style.width=String.format("{0}px",this.WX);P.style.height=this.jqa}get Fia(){return this.Wk}}Object(d.a)(Mi,"SDXDialog",mh.a,[]);var bh=a(959),
ni=a(145),Ni=a(573),Vh;(function(P){P[P.Valid=2]="Valid";P[P.Invalid=4]="Invalid";P[P.All=6]="All"})(Vh||(Vh={}));Object(d.b)("MetadataState",Vh);var Bi=a(343);class qf extends qd.a{constructor(P,Ta,Hb,lc,xc){super();this.qBa={};this.qcd={};this.Wza=this.sdxDialog=this.e5=null;this.fcb=!1;this.U6h=(cd,id,od,Fd,Rd)=>{if(2!==od)return 32;cd=Rd[bh.a.Uub];id=Rd[bh.a.cZ];od=Rd[bh.a.gW];Rd=new Wg.a;Rd.pgc=od.optionalProperties.InstanceToken;Rd.sourceLocationOverrideResourceId=od.optionalProperties[vg.a.sourceLocationOverrideResourceId];
Rd.CB=od.Bh;Rd.cZ=id;id=null!=Rd.pgc?Rd.pgc:(new Ea.a(Tg.a.create(),1)).toString();od=null!=Rd.CB?Rd.CB:{};Fd={};Fd.id=id;Fd.solutionId=cd.getId();Fd.version=cd.lDa;Fd.storeType=cd.getStoreType();Fd.storeId=cd.getStoreId();Fd.assetId=null;Fd.assetStoreId=null;Fd.settings=od;Fd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Fd.osfControlType=OSF.OsfControlType.ContainerLevel;Fd.sourceLocationOverrideResourceId=Rd.sourceLocationOverrideResourceId;Fd.featureGates=nd.AFrameworkApplication.fa.T1e(cd.getId());
this.Zkc(Rd,Fd);return 32};this.Ukc=(cd,id,od,Fd,Rd)=>{2===od&&(this.e5=new Ai,this.e5.initializeAndShow("",null,null),cd=Rd.CommandValueId,id=[],id.push(Rd.SourceControlId),id.push(cd),id.push(null),this.je.Bof(this.e5.Fia,id));return 32};this.Zkc=(cd,id)=>{this.sdxDialog=new Mi;this.sdxDialog.initializeAndShow("",null,null);id.div=this.sdxDialog.Fia;cd={};cd.InstanceId=id.id;cd.WebExtensionType=2;cd.PrimaryMarketplace={};cd.PrimaryMarketplace.SolutionId=id.solutionId;cd.PrimaryMarketplace.MarketplaceType=
id.storeType;cd.PrimaryMarketplace.MarketplaceRef=id.storeId;cd.PrimaryMarketplace.SolutionVersion=id.version;cd.SrcLocationOverrideResourceId=id.sourceLocationOverrideResourceId;cd.WebExtensionOsfControlType=6;this.qBa[id.solutionId]=id.settings;cd.OsfPropertyBag=this.Dmc([],id.solutionId);this.je.HIa(cd);this.je.Xh.insertOsfControl(id)};this.f8h=(cd,id,od,Fd,Rd)=>{if(2!==od)return 32;cd=Rd[bh.a.Uub];od=Rd[bh.a.cZ];Rd=Rd[bh.a.gW];id=new Wg.a;id.pgc=Rd.optionalProperties.InstanceToken;id.kj=Rd.optionalProperties[vg.a.kj];
id.wS=Rd.optionalProperties[vg.a.wS];vg.a.taskPaneWidth in Rd.optionalProperties&&(id.taskPaneWidth=Rd.optionalProperties[vg.a.taskPaneWidth]);id.sourceLocationOverrideResourceId=Rd.optionalProperties[vg.a.sourceLocationOverrideResourceId];id.CB=Rd.Bh;id.onTaskPaneClose=Rd.optionalProperties[vg.a.onTaskPaneClose];id.cZ=od;od=new wg.a(-859308420,0,2,0,"");Fd=cd.getStoreType()===OSF.StoreType.Sdx;const Re=new Ug.a;Re.$Z=Rd.optionalProperties.HeaderCssClass||Mg.a.QJa;Re.oUa=Rd.optionalProperties.TitleCssClass;
this.U7(od,cd.getId(),id,Fd,Re);return 32};this.R7h=(cd,id,od,Fd,Rd)=>{if(2!==od)return 32;cd=Rd[bh.a.Uub].getId();Rd=Rd[bh.a.gW].optionalProperties[vg.a.sourceLocationOverrideResourceId];return cd?(this.je.Xh.refreshOsfControl(cd,Rd),32):8};this.f3i=cd=>{cd=cd.Result;if(cd=null===cd?null:cd.SolutionId)this.je.toe(cd),uh.a(this.$).Lna(3,cd)};this.XLf=(cd,id)=>{var od;const Fd=(cd=cd.Result)?cd.AgaveData:null;if(Fd){var Rd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Fd.PrimaryMarketplace.SolutionId,
Fd.PrimaryMarketplace.MarketplaceType,null===(od=null===Fd||void 0===Fd?void 0:Fd.AssetMarketplace)||void 0===od?void 0:od.SolutionId,null,null,Fd.PrimaryMarketplace.MarketplaceRef);n.ULS.shipAssertTag(537170434,0,Fd.TaskpaneWidth===qf.aih,`Taskpane width is ${Fd.TaskpaneWidth}, assetId is ${Rd}.`);if(od=this.qcd[Fd.PrimaryMarketplace.SolutionId])od.lBc&&(Fd.TaskpaneTitle=od.lBc),od.jBc&&(Fd.TaskpaneIconId=od.jBc),od.WXd&&(Fd.TaskpaneButtonTooltip=od.WXd),0<od.vq&&(Fd.TaskpaneWidth=od.vq);id&&(Fd.FocusOnIframeWhenLoaded=
id.focusOnIframeWhenLoaded,id.width&&(Fd.TaskpaneWidth=id.width),Fd.TaskpaneIconCssClass=id.Fk,Fd.TaskpaneHeaderCssClass=id.$Z,Fd.TaskpaneTitleCssClass=id.oUa,Fd.IsFirstPartyOptOutAppContextOptmization=id.isFirstPartyOptOutAppContextOptmization);this.qBa[Fd.PrimaryMarketplace.SolutionId]&&(Fd.OsfPropertyBag=this.Dmc(Fd.OsfPropertyBag,Fd.PrimaryMarketplace.SolutionId));Vi.a(Fd)||(Fd.WebExtensionOsfControlType=1);Fd&&(this.je.toe(cd.SolutionId),this.je.HIa(Fd))}else n.ULS.sendTraceTag(593285650,220,
10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.fDh=cd=>{cd&&(this.Abd.dnf(cd),this.qAe())};this.aMf=cd=>{cd=cd.toDataURL("image/jpeg");const id=this.je.Jaa(qf.Haf+"."+qf.Sdc),od={};od.screenshot=cd;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(id,"onScreenshot",od,()=>{})};this.q6h=(cd,id,od,Fd,Rd)=>{if(2!==od)return 32;if(Rh.a.Dh(Rd)||Rd[bh.a.CEe]!==ki.a.action)return 8;id=Rd[bh.a.gW];return id?(cd=(cd=this.IXh(Rd))?this.je.Jaa(cd):null)?
(Rd=this.je.m9g(Rd[bh.a.cZ],id.optionalProperties[vg.a.jZb]),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(od=this.je.FZ(cd),od.TaskpaneTitle!==id.optionalProperties[vg.a.kj]&&(od.TaskpaneTitle=id.optionalProperties[vg.a.kj],od.TaskpaneIconCssClass=id.optionalProperties.IconCssClass,od.TaskpaneIconUrl=id.optionalProperties.TaskPaneIconUrl,od.TaskpaneIconId=id.optionalProperties.TaskPaneIconId,z.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?
(id=this.je.Xh,id.changeIframeTitle(cd,od.TaskpaneTitle),od=id.getOsfControl(cd),id.raiseOsfControlStatusChange(od)):(id=this.je.Xh.getOsfControl(cd),this.je.Xh.raiseOsfControlStatusChange(id)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(cd,Rd,this.HLb),32):8:8};this.HLb=(cd,id)=>{this.je.GFh(cd,id)};this.qKd=()=>{Vf.TaskExtensions.TJ(ug.GetServiceTaskFactory.Oa(this.$.da,20,404,1),cd=>{cd.result.s5a()},this.$.la)};this.$=P;this.viewBlockContainerHelpers=Hb;this.je=Ta;this.Abd=
lc;this.Uh=xc;this.Uh.Nb(re.a.B7f,sh.a.frame,this.f8h);this.Uh.Nb(re.a.SXf,sh.a.frame,this.R7h);this.Uh.Nb(re.a.OUe,sh.a.frame,this.q6h);this.Uh.Nb(re.a.Zkc,sh.a.frame,this.U6h);this.Uh.Nb(re.a.Ukc,sh.a.frame,this.Ukc)}GKg(P){this.addHandler(qf.xEd,P)}Rfj(P){this.removeHandler(qf.xEd,P)}dispose(){ci.a.Ia(this.e5);this.e5=null;this.fcb&&(this.$.ea.jo(this.qKd),this.fcb=!1);super.dispose()}s0c(){this.e5.hide()}iJj(P,Ta){if(P){this.raiseEvent(qf.xEd);const Hb=P.split("|");this.rzi(P,Ta,Hb);this.e5=new Ai;
this.e5.initializeAndShow("",null,null);this.je.Bof(this.e5.Fia,Hb);z.EwaSettings.isChangeGateEnabled("OfficeVSO:7163330_LogAddinInstallOriginEnabledForExcel")&&(window[qf.cNg]=P===qf.QSg?"Backstage":P===qf.umj?"Ribbon":P===qf.MMj?"TellMe":"Unknown")}}bkd(P,Ta,Hb){var lc=Vf.TaskExtensions.Sj();if(-515602470===Hb.command||-336193495===Hb.command||2086613372===Hb.command||-1444574190===Hb.command||-1336341324===Hb.command||451940422===Hb.command)lc=this.J6h(P,Ta,Hb);418618014===Hb.command&&(Ta=new Wg.a,
Ta.kj=Td.a.instance.ga(1814),lc=this.U7(Hb,qf.$9h,Ta,!0));if((Hb.tabName===this.$.Eb+Jd.a.pYf||Hb.tabName===Jd.a.p0)&&2===Hb.$e||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),P[Lg.a.Jc])||P[Lg.a.Jc]===Jd.a.qV)return this.x9e(P,Hb);if(7===Hb.$e&&P.SourceControlId===this.$.Eb+Jd.a.Rdc)return P.MenuItemId=Jd.a.mJd,this.x9e(P,Hb);1221897806===Hb.command&&(lc=this.l7f(Hb,"Format"));if(1930653487===Hb.command||1172793074===Hb.command)lc=this.l7f(Hb,"Data");-1753056834===
Hb.command&&(lc=this.QEj(Hb));932597253===Hb.command&&(n.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),ni.c(932597253,!0),Ta=new Wg.a,Ta.kj=Td.a.instance.ga(2157),Ta.sourceLocationOverrideResourceId=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?qf.o3i:qf.q3i,Ta.focusOnIframeWhenLoaded=!0,Ta.taskPaneWidth=qf.ocf,lc={},lc.LaunchSource=Object(N.a)(String,P.SourceControlId),lc.LaunchMode="Default",Ta.CB=lc,lc=this.U7(Hb,qf.p3i,
Ta,!0));301511274===Hb.command&&(lc=this.$Ej(Hb));if(515196233===Hb.command){Ta=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);if(lc=this.$.da.za(465))lc.Paf(),Ta&&lc.ofi();lc=new Wg.a;lc.kj=Td.a.instance.ga(2231);const xc={};xc.SourceUILocation=Sh.a[Hb.$e];Ta&&(xc.SessionID=this.$.ea.sessionId,this.TQd(xc));lc.CB=xc;Ta=new Ug.a;Ta.$Z=Mg.a.QJa;lc=this.U7(Hb,qf.vZi,lc,!0,Ta,void 0,lc.kj)}1723441034===Hb.command&&(Ta=new Wg.a,Ta.kj=
Td.a.instance.ga(2243),Ta.focusOnIframeWhenLoaded=!0,Ta.taskPaneWidth=qf.g6i,lc=new Ug.a,lc.$Z=Mg.a.ouh,lc=this.U7(Hb,Ni.a,Ta,!0,lc));z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&P.LoadDataFromPictureTaskpane&&(Ta={},lc=new Wg.a,lc.kj=Td.a.instance.ga(2270),Ta.SessionID=P.SessionID,lc.CB=Ta,lc.focusOnIframeWhenLoaded=!0,lc=this.U7(Hb,P.DataFromPictureAssetId,lc,!0));return lc}insertAgave(P,Ta){var Hb=Vf.TaskExtensions.Sj();const lc=this.$;let xc;var cd=P[be.a.ssa];
xc=P[Lg.a.og];let id=null;Ug.a.key in P&&(id=P[Ug.a.key]);this.e5&&this.e5.hide();if(!xc||!cd)return n.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Hb;this.$.J5&&Jd.a.Ioa in P&&(xc.EnabledInViewMode=P[Jd.a.Ioa]);P=this.gPh(Ta.command);if(!xc.EnabledInViewMode&&!lc.Yp(null,!1,P))return Hb;let od=void 0===xc.IsToBePersisted||null===xc.IsToBePersisted||xc.IsToBePersisted?0:16;if(1===xc.TargetType)Hb=this.fgi(xc,cd,Ta,id,od);else{cd=yg.h(lc);Hb=this.viewBlockContainerHelpers.Rgb(cd);
const Fd=lc.ea.isNamedObjectViewMode?lc.oa.sheetName:lc.oa.name;let Rd,Re,We,lf;Hb?(cd=Hb.fe,Rd=cd.qf.top,Re=cd.qf.left,We=Hb.iJ.x,lf=Hb.iJ.y):(Rd=Re=1,Hb=this.viewBlockContainerHelpers.ALa(cd),We=Hb.x,lf=Hb.y);const rg=this.$.pa.ya.Wb();od|=64;Hb=lg.a(this.$.userOperationManager,(fg,$f,bg)=>{var jg=lc.pa.ya,Pg=Rd,Ng=Re,Qg=We,Ih=lf;fg=Tf.b(fg,this.f3i);const Yh=jg.Na(9,rg);Yh.sharedInfo=xc;Yh.sheetName=Fd;Yh.positionRow=Pg;Yh.positionCol=Ng;Yh.positionOffsetX=Qg;Yh.positionOffsetY=Ih;return Dg.g(jg,
"InsertWebExtension",Yh,fg,$f,bg,null,0)},fg=>new Hh.a(534,0,fg,od),Ta)}return Hb}K6g(){var P=Hc.a.instance.Ub("Common.App.ICustomerFeedbackUiWrapper");if(!z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)){var Ta=Hc.a.instance.Ub("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.Abd?this.Abd.mkb?this.qAe():Ta.instance.A8c(this.fDh):n.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Ta={};nd.AFrameworkApplication.fa.Noe(Ta);
P=P.instance.getContext(Ta);Ta={};"telemetryGroup"in P&&(Ta=P.telemetryGroup);Ta.processSessionId=P.sessionId;Ta.officeBuild=P.build;P.telemetryGroup=Ta;P.feedbackType=-1;P.userVoiceEnabled=!1;"disableIncludeScreenshot"in P||(P.disableIncludeScreenshot=!1);"screenshot"in P||(P.screenshot=!1);P.disableScreenshotPreview=!1;P.includeScreenshotSelectedDefault=!0;return P}qMf(P){if(!this.Wza&&z.EwaSettings.getBooleanFeatureGate(qf.Vai,!1)){var Ta=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Ta=this.Oxe(Ta);const Hb=new Ug.a;Hb.Fk=Mg.a.wad;Hb.$Z=Mg.a.yRe;Hb.oUa=Mg.a.U$c;this.Wza=this.mLb(Ta,null,!1,null,Hb);Wi.b(this.$).ud(yi.a.F3i,{["Location"]:P?Sh.a[P.$e]:0,["InputMethod"]:P?Ti.a[P.method]:0},void 0,!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.PZd()}}TQd(P){const Ta=this.$.ea.Wg.get(17);Hc.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Hb=>
{Hb.isFeatureEnabled("mso_sendASmile",Ta).then(lc=>{P.FeedbackEnabled=Ta&&lc;return null})})}l7f(P,Ta){const Hb=yg.h(this.$),lc=new Wg.a;var xc={};xc.ActiveTab=Ta;xc.DatapaneFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);xc.AceFlighting=!0;xc.ChartNewSDXRecording=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);xc.ThemeColorsFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");xc.UOMirror=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);xc.FormatTaskPaneAceButtonDark=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);xc.FormatTaskPaneBetterFeedbackButton=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);xc.FormatTaskPaneBetterScrollbar=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",
!1);xc.FormatTaskPaneUXImprovePhase2=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);this.TQd(xc);xc.startTimeMs=Date.now();xc.UserSessionId=this.$.va.UserSessionId;(Ta=Hb.ha.Sa.mo)&&(xc.SubSelection=Ta);n.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${xc.UserSessionId}, UILocation: ${void 0===P.$e||null===P.$e?"Null":Sh.a[P.$e]}, SubSelection: ${Ta||"ChartRoot"}`);lc.CB=xc;lc.kj=Td.a.instance.ga(981);xc=new Ug.a;xc.$Z=Mg.a.QJa;
return this.U7(P,qf.D0g,lc,!0,xc)}QEj(P){const Ta=new Wg.a;Ta.CB={};Ta.kj=Td.a.instance.ga(1800);Ta.wS=qf.Zof;const Hb=new Ug.a;Hb.$Z=Mg.a.QJa;return this.U7(P,qf.Zof,Ta,!0,Hb,void 0,Ta.kj)}$Ej(P){const Ta=new Wg.a;Ta.CB={};Ta.kj=Td.a.instance.ga(2181);const Hb=new Ug.a;Hb.$Z=Mg.a.Ovh;Hb.oUa=Mg.a.CRe;return this.U7(P,qf.OGi,Ta,!0,Hb)}x9e(P,Ta){const Hb=qf.Haf;var lc=P[Lg.a.Jc].toString();const xc={},cd=new Wg.a;cd.kj=Td.a.instance.ga(9);switch(lc){case "A0":xc.query=(P[Lg.a.og]||"").split("|").slice(2,
Li.a.LS).join("|");break;case "A1":xc.query=P.CommandValueId;break;case "Help":xc.gwdropdownflightinfo=z.EwaSettings.ma(237);xc.query="";break;case Jd.a.mJd:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(cd.kj=Td.a.instance.ga(1766),cd.sourceLocationOverrideResourceId=qf.Sdc,xc.feedback=this.K6g()):xc.query=lc;break;case "HelpArticle":xc.query=P[Lg.a.og];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":xc.query=lc;break;default:return lh.Task.Ta(!0)}cd.CB=
xc;lc=new Ug.a;lc.$Z=Mg.a.QJa;return this.U7(Ta,Hb,cd,!1,lc,P[Jd.a.Ioa]||!1)}Oxe(P){const Ta={};z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Ta.SolutionId=qf.Twa,Ta.Version="0.0.0.0",Ta.StoreType=OSF.StoreType.Sdx,Ta.StoreId=OSF.StoreType.Sdx,Ta.AssetId=null,Ta.AssetStoreId=null,Ta.Height=0,Ta.Width=0):(Ta.Version="0.0.0.0",Ta.AssetId=qf.Twa,Ta.SolutionId=qf.Twa,Ta.AssetStoreId="",Ta.StoreType=OSF.StoreType.Sdx,Ta.Height=0,Ta.Width=0,Ta.StoreId=OSF.StoreType.Sdx);
Ta.TargetType=OSF.OsfControlTarget.TaskPane;Ta.IsToBePersisted=!1;Ta.SourceLocationOverrideResourceId=P;Ta.SharedRuntimeId=P;return Ta}J6h(P,Ta,Hb){function lc(){id.LaunchMode="Default";z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?xc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":xc.sourceLocationOverrideResourceId="Insights.Https.Bundle";xc.kj=Td.a.instance.ga(1813);xc.wS=qf.LXc;xc.Fk=Mg.a.wad;cd.Fk=Mg.a.wad}const xc=new Wg.a,cd=new Ug.a,id={};this.Wza&&
this.TQd(id);id.LaunchSource="";id.StartTimeMs=Date.now();id.CorrelationId=Tg.a.create().toString();xc.CB=id;xc.focusOnIframeWhenLoaded=!0;xc.taskPaneWidth=qf.ocf;cd.$Z=Mg.a.yRe;cd.oUa=Mg.a.U$c;switch(Hb.command){case -1444574190:let Rd;id.LaunchMode="RecommendedPivotTables";id.SelectionContext="";id.LaunchSource="PivotTableHandRaise"===Object(N.a)(String,P.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
P.SourceSelection){var od=P.SourceSelection.split(",")[0];Ta=z.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:od,IPf:Rd,range:Fd}=Eh.Z(od,this.$.xa)).returnValue&&!yg.h(this.$).Bb.E5(Fd))P=this.$.xa.getItemByName(od),id.SelectionContext=JSON.stringify(Object(fd.a)(new li,{address:Rd,addressWithSheet:od+"!"+Fd.Ew(!1),sheetId:Gh.d(P),sheetName:od,isSheetEmpty:!1,columnCount:Fd.width,rowCount:Fd.height,columnIndex:Fd.left+Ta,rowIndex:Fd.top+Ta,selectionType:"Continuous"}));
else if((P=this.$.Cb.getItemByName(Object(N.a)(String,P.SourceSelection)))&&Gh.n(P)){var Fd=zi.a(P,!0);od=this.$.xa.getItemByName(P.sheetName);id.SelectionContext=JSON.stringify(Object(fd.a)(new wi,{tableName:P.name,hasTableHeaders:zi.d(P),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Fd.Ew(!1),addressWithSheet:od.name+"!"+Fd.Ew(!1),sheetId:Gh.d(od),sheetName:od.name,isSheetEmpty:!1,columnCount:Fd.width,rowCount:Fd.height,columnIndex:Fd.left+Ta,rowIndex:Fd.top+Ta,selectionType:"Continuous"}))}}z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?xc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":xc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";xc.kj=Td.a.instance.ga(1812);xc.wS=qf.C1i;xc.Fk=Mg.a.VTe;cd.Fk=Mg.a.VTe;break;case -336193495:id.LaunchMode="RecommendedCharts";z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?xc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":xc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";xc.kj=Td.a.instance.ga(1811);
xc.wS=qf.v$i;xc.Fk=Mg.a.WTe;cd.Fk=Mg.a.WTe;break;case -1336341324:if(!z.EwaSettings.ma(475))return lh.Task.Ta(!1);id.LaunchMode="NL";xc.wS=qf.LXc;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?xc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":xc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(z.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:xc.kj=Td.a.instance.ga(1816);id.NLLaunchModeBrandingCandidatesIndex=
1;break;case 2:xc.kj=Td.a.instance.ga(1817);id.NLLaunchModeBrandingCandidatesIndex=2;break;default:xc.kj=Td.a.instance.ga(1815),id.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!z.EwaSettings.ma(232))return lh.Task.Ta(!1);id.LaunchMode="ChartDesigner";id.LaunchSelectionMode=Ta.toString();z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?xc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":xc.sourceLocationOverrideResourceId="Insights.Https.Bundle";
xc.kj=Td.a.instance.ga(1818);xc.wS=qf.LXc;break;case 451940422:id.LaunchSource="AutoFilter";Fd=JSON.parse(P.CommandValueId);id.AutoFilterSource=JSON.stringify(Object.assign(new mi,{autoFilterRange:{sheetName:Fd.AutoFilterRange.SheetName,firstColumn:Fd.AutoFilterRange.FirstColumn,lastColumn:Fd.AutoFilterRange.LastColumn,firstRow:Fd.AutoFilterRange.FirstRow,lastRow:Fd.AutoFilterRange.LastRow},autoFilterType:Fd.AutoFilterType,itemIndex:Fd.ItemIndex,id:Fd.Id}));lc();break;default:z.EwaSettings.ma(232)&&
(id.LaunchSelectionMode=Ta.toString()),z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(id.XlimTableBoundaries=this.O1h()),lc()}z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?xc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":xc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.Wza?this.Wza.jp(()=>this.y0f(id,xc)):this.qei(Hb,xc,cd,id)}qei(P,Ta,Hb,lc){const xc=this.Oxe(Ta.sourceLocationOverrideResourceId);
this.Wza=this.mLb(xc,Ta,!1,P,Hb,!1);return z.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(lc.NoActionMsgOnFirstInstance=!0,this.qBa[qf.Twa]=lc,this.Wza):this.Wza.jp(()=>this.y0f(lc,Ta))}y0f(P,Ta){const Hb=this.je.Jaa(this.je.j4a(qf.Twa,Ta.sourceLocationOverrideResourceId));if(Hb){this.qBa[qf.Twa]=P;const lc=this.Dmc(this.je.FZ(Hb).OsfPropertyBag,qf.Twa);this.je.FZ(Hb).OsfPropertyBag=lc}this.f6(qf.Twa,"LaunchIdeasAction",P,Ta);return lh.Task.Ta(!0)}U7(P,Ta,Hb=null,
lc=!1,xc=null,cd=!1,id=null){Vf.TaskExtensions.Sj();Hb||(Hb=new Wg.a);const od={};z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(od.SolutionId=Ta,od.Version="0.0.0.0",od.StoreType=lc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,od.StoreId=lc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,od.AssetId=null,od.AssetStoreId=null,od.Height=0,od.Width=0):(od.Version="0.0.0.0",od.AssetId=Ta,od.SolutionId=Ta,od.AssetStoreId="",od.StoreType=lc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,
od.Height=0,od.Width=0,od.StoreId=lc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty);od.TargetType=OSF.OsfControlTarget.TaskPane;od.IsToBePersisted=!1;od.SourceLocationOverrideResourceId=Hb.sourceLocationOverrideResourceId;if(Hb.kj||id)this.qcd[Ta]=Object(fd.a)(new vi,{lBc:Hb.kj,WXd:id,jBc:Hb.wS});z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Hb.CB||(Hb.CB={}),Hb.CB.ShowFeedback=this.$.isFeedbackEnabled,this.qBa[Ta]=Hb.CB):
Hb.CB&&(this.qBa[Ta]=Hb.CB);Ta={};Ta[Lg.a.og]=od;id={};id.solutionId=od.SolutionId;id.version=od.Version;id.storeType=od.StoreType;id.storeId=od.StoreId;id.assetId=od.AssetId;id.assetStoreId=od.AssetStoreId;id.height=od.Height;id.targetType=od.TargetType;id.width=od.Width;id.isAddinCommands=!lc;Ta[be.a.ssa]=id;xc||(xc=new Ug.a);xc.focusOnIframeWhenLoaded=Hb.focusOnIframeWhenLoaded;xc.width=Hb.taskPaneWidth;Ta[Ug.a.key]=xc;Ta[Jd.a.Ioa]=cd;return this.insertAgave(Ta,P)}fgi(P,Ta,Hb,lc,xc){const cd=(Rd,
Re)=>{var We=Rd.SolutionId;var lf=OSF.OsfControl.isFirstPartyStoreString(Rd.StoreType);lf&&Rd.SourceLocationOverrideResourceId&&(We=this.je.j4a(We,Rd.SourceLocationOverrideResourceId));var rg=this.je.kBe(We,null,Rd.SharedRuntimeId);lf&&(z.EwaSettings.ma(291)&&rg&&(lf=this.je.Jaa(We))&&(We=null,We=this.Dmc(this.je.FZ(lf).OsfPropertyBag,Rd.SolutionId),(lf=this.je.Xh.getOsfControl(lf))&&lf.setSettings(We)),Rd.SharedRuntimeId&&rg||this.je.Xh.refreshOsfControl(Rd.SolutionId,Rd.SourceLocationOverrideResourceId));
if(!rg){const fg=this.$.pa.ya.Wb();let $f=519;rg=(bg,jg,Pg)=>{var Ng=this.$.pa.ya;bg=Tf.b(bg,this.XLf);const Qg=Ng.Na(9,fg);Qg.sharedInfo=Rd;return Dg.g(Ng,"InsertAgaveTaskpane",Qg,bg,jg,Pg,lc,0)};void 0===Rd.IsToBePersisted||null===Rd.IsToBePersisted||Rd.IsToBePersisted||($f=538,rg=(bg,jg,Pg)=>{const Ng=Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.SolutionId,Rd.StoreType,Rd.AssetId,null,null,Rd.StoreId);n.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Rd.StoreType}, StoreId ${Rd.StoreId}, SolutionId ${Ng}.`);
return Th(this.$.pa.ya,Rd,Tf.b(bg,this.XLf),jg,Pg,lc,fg)});xc|=64;return lg.a(this.$.userOperationManager,rg,bg=>new Hh.a($f,0,bg,xc),Re)}return Vf.TaskExtensions.jba()},id=Rd=>{var Re=Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.solutionId,Rd.storeType,Rd.assetId,null,null,Rd.storeId);n.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Re} from ${Rd.storeType}.`);Re={};const We=new m.a;We.add(Rd);Re[be.a.yob]=We;Re[be.a.wM]=3;Rd=new wg.a(re.a.RCb,0,this.$.Hc,0,null);return this.$.Ja.Kb(Rd,
Re)};if(!z.EwaSettings.ma(53)||P.StoreId===OSF.StoreType.FirstParty)return cd(P,Hb,lc);if(Ta.isAddinCommands)return id(Ta);const od=new kd.a,Fd={};z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Fd.solutionId=P.SolutionId,Fd.version=P.Version):(Fd.marketplaceId=P.SolutionId,Fd.marketplaceVersion=P.Version);Fd.storeType=P.StoreType;Fd.storeId=P.StoreId;Fd.targetData=P;z.EwaSettings.ma(93)&&(Fd.clearCache=!0);this.je.Xh.isAddinCommandsAsync(Fd,(Rd,Re,We)=>{od.setResult(Re);
Rd||(Rd=We.targetData,Re=Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.SolutionId,Rd.StoreType,Rd.AssetId,null,null,Rd.StoreId),n.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Re} from ${Rd.StoreType} during addin inserting`))});return Vf.TaskExtensions.ts(od.task,Rd=>Rd.result?id(Ta):cd(P,Hb,lc),this.$.la)}Dmc(P,Ta){if(!this.qBa[Ta])return P;const Hb={};if(P)for(const xc of P)Hb[xc[0]]=xc[1];P=this.qBa[Ta];for(var lc of Object.keys(P))lc===qf.hDh&&z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?Hb[lc]=Sys.Serialization.JavaScriptSerializer.serialize(P[lc]):Hb[lc]=Sys.Serialization.JavaScriptSerializer.serialize(P[lc].toString());lc=Object.keys(Hb).length;lc=Array(lc);P=0;for(const xc of Object.keys(Hb))lc[P]=[xc,Hb[xc].toString()],P++;return lc}rzi(P,Ta,Hb){const lc=this.$.va.UserSessionId,xc=this.$.va.UICultureTag,cd=this.$.va.UICultureTagLcid,id=this.$.va.WacHostId;let od="",Fd="";5<=Hb.length&&(od=Hb[3],Fd=Hb[4]);this.szi(od,Fd,P,Ta,xc,cd,lc,id)}szi(P,Ta,Hb,lc,xc,cd,id,od){const Fd=
{};Fd.a=id;Fd.b=Hb;Fd.c=lc;Fd.d=P;Fd.e=Ta;Fd.f=xc;Fd.g=cd;Fd.h=od;Uh.b().Qe(36,Fd)}qAe(){if(Ui.a.mxf())n.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.aMf);return}catch(P){n.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(P?P.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.aMf)}catch(P){n.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(P?P.toString():
null))}}}mLb(P,Ta=null,Hb=!1,lc=null,xc=null,cd=!0){var id=P.SolutionId;let od=lh.Task.Ta(!1);P&&id&&P.SharedRuntimeId&&(lc=lc||new wg.a(-859308420,0,2,0,""),id={},id.solutionId=P.SolutionId,id.version=P.Version,id.storeType=P.StoreType,id.storeId=P.StoreId,id.assetId=P.AssetId,id.assetStoreId=P.AssetStoreId,id.height=P.Height,id.targetType=P.TargetType,id.width=0,id.isAddinCommands=!1,id.sharedRuntimeId=P.SharedRuntimeId,P.Preload=cd,xc=xc?xc:new Ug.a,xc.width=0,Ta&&(xc.focusOnIframeWhenLoaded=Ta.focusOnIframeWhenLoaded,
cd=new vi,Ta.kj&&(cd.lBc=Ta.kj),0<Ta.taskPaneWidth&&(cd.vq=Ta.taskPaneWidth),Ta.wS&&(cd.jBc=Ta.wS),this.qcd[P.SolutionId]=cd),Ta={},Ta[Lg.a.og]=P,Ta[be.a.ssa]=id,Ta[Ug.a.key]=xc,Ta[Jd.a.Ioa]=Hb,od=this.insertAgave(Ta,lc));return od}f6(P,Ta,Hb,lc=null){if(P&&Ta){P=new Lh.a(P,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const xc=new hi.a("ExcelOnline","Web",this.$.va.UICultureTag),cd=new kg.a;cd.optionalProperties[vg.a.jZb]=Hb;lc&&(lc.sourceLocationOverrideResourceId&&(cd.optionalProperties[vg.a.sourceLocationOverrideResourceId]=
lc.sourceLocationOverrideResourceId),lc.kj&&(cd.optionalProperties[vg.a.kj]=lc.kj),lc.Fk&&(cd.optionalProperties.IconCssClass=lc.Fk),lc.TXd&&(cd.optionalProperties.TaskPaneIconUrl=lc.TXd),lc.wS&&(cd.optionalProperties.TaskPaneIconId=lc.wS));ui.a.instance.f6(P,ki.a.action,Ta,xc,cd)}}IXh(P){if(!Rh.a.Dh(P)){var Ta=P[bh.a.Uub];if(Ta&&(Ta=Ta.getId(),P=P[bh.a.gW],Ta&&P))return this.j4a(Ta,P.optionalProperties[vg.a.sourceLocationOverrideResourceId])}return null}j4a(P,Ta=null){return P&&Ta?`${P}.${Ta}`:P}gPh(P){switch(P){case 1172793074:case 1221897806:case 1930653487:return 2;
case -515602470:case 2086613372:return z.EwaSettings.ma(232)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}}PZd(){this.$.ea.sg?this.qKd():(this.$.ea.Ak(this.qKd),this.fcb=!0)}O1h(){var P=this.$.da.za(20);if(!P)return this.PZd(),"";P=P.s5a();if(!P)return this.PZd(),"";var Ta=this.$.xa.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.oa.sheetName:this.$.oa.name);Ta=Gh.d(Ta);var Hb=yg.h(this.$).ha.ra.selectedRanges;const lc=[];for(const cd of Hb){Hb=
new Bi.a(cd,Ta);var xc=P.adc(Hb,Vh.Valid);Hb=[];if(xc)for(const id of xc)(xc=id.table.RA)&&(xc=xc.range.toString())&&Hb.push(xc);Hb=new xi(cd.toString(),Hb);lc.push(Hb)}return JSON.stringify(lc)}}qf.Vai="Microsoft.Office.Excel.IdeasXLOPreload";qf.xEd="IDS";qf.Haf="FA000000012";qf.Twa="FA000000005";qf.$9h="HelloWorld";qf.D0g="FA000000014";qf.Sdc="Help.GiveFeedback.Url";qf.hDh="feedback";qf.Zof="FA000000066";qf.q3i="PowerBi.Url";qf.o3i="PowerBi.DevUrl";qf.p3i="FA000000054";qf.OGi="FA000000064";qf.vZi=
"FA000000075";qf.LXc="AnalyzeDataTaskPane";qf.v$i="RecommendedChartsTaskPane";qf.C1i="PivotTableTaskPane";qf.aih=350;qf.ocf=320;qf.g6i=320;qf.cNg="g_InstallOrigin";qf.QSg="InsertAddInsFromBackstage";qf.umj="InsertAppsForOffice";qf.MMj="LaunchAddinDialogFromTellMe";Object(d.a)(qf,"AgaveCommandManager",qd.a,[681,682]);class Ci extends h.a{constructor(P){super();this.$=P;this.Fb()}create(){const P=this.$.da,Ta=ug.GetServiceTaskFactory.create(P,106,this.la,this.Ya),Hb=ug.GetServiceTaskFactory.create(P,
104,this.la,this.Ya),lc=Sg.a.loadScript(35,0,this.Ya,void 0,void 0,375);Vf.TaskExtensions.Aa(Vf.TaskExtensions.Ed([Hb,Ta,lc],this.la),()=>{let xc=null;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(xc=Hc.a.instance.Ub("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);kh.instance.initialize(Ta.result);const cd=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Oh.a)(this.$.da,
374,()=>new qf(this.$,Ta.result,Hb.result,xc,nd.AFrameworkApplication.ub)):new qf(this.$,Ta.result,Hb.result,xc,nd.AFrameworkApplication.ub);P.Ga(206,cd);this.ob(P.za(374)||P.Ga(374,cd))},this.la,3);Hc.a.instance.register(Qh.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").xc().Fc(()=>new Qh.a(this.$.qu))}static ka(P){P.da.Ga(375,new Ci(P))}}Object(d.a)(Ci,"AgaveCommandManagerFactory",h.a,[]);var Oi=a(560);class nh{constructor(){this.initialized=!1;this.agaveCommandManager=this.je=
this.d1a=null;this.mU={}}initialize(P){z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.znj(P)}Nfi(P,Ta){let Hb=Vf.TaskExtensions.Sj();if(this.initialized&&P&&0<P.length){let lc=this.ZLh(P);P in this.mU&&(Hb=this.agaveCommandManager.insertAgave(lc,Ta))}return Hb}sFg(P){this.initialized&&(P=P[Lg.a.og]||{},!P.SolutionId||P.SolutionId in this.mU||this.je.sda(Ta=>{this.sda(Ta)},!0))}M7h(P){this.initialized&&(P=P||"")&&
0<P.length&&P in this.mU&&(delete this.mU[P],this.je.sda(Ta=>{this.sda(Ta)},!0))}ZLh(P){return P in this.mU?this.mU[P]:{}}sda(P){var Ta=!1;if(P&&!P.errorCode){if(P.value)for(const Hb of P.value)P=Hb[1],Hb[3]==OSF.OsfControlTarget.InContent&&P&&0<P.length&&!(P in this.mU)&&(Ta={NoReporting:!1,IsSystemInitiated:!1},Ta.description=Hb[2],Ta.iconUrl=Hb[9],Ta[be.a.ssa]={solutionId:Hb[1],version:Hb[4],storeType:Hb[12],storeId:Hb[11],assetId:Hb[5],assetStoreId:Hb[6],targetType:Hb[3],width:Hb[7],height:Hb[8],
displayName:Hb[0],id:Hb[1]},Ta[Lg.a.og]={SolutionId:Hb[1],Version:Hb[4],StoreType:Hb[12],StoreId:Hb[11],AssetId:Hb[5],AssetStoreId:Hb[6],TargetType:Hb[3],Width:Hb[7],Height:Hb[8],Id:Hb[1]},this.mU[P]=Ta,Ta=!0);Ta&&this.I$g()}}I$g(){let P=[];for(const Ta in this.mU)P.push({id:Ta,controlType:0,title:this.mU[Ta][be.a.ssa].displayName});if(0<P.length){for(const Ta in this.mU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Ta,this.mU[Ta].iconUrl);this.P1g();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:nh.txf,
isOfficeTab:!0,groups:[{id:nh.vef,title:nh.wef,controls:P}]}]});for(const Ta in this.mU)this.d1a.addCommandToMaps(Object(fd.a)(new tf.a(Ta,"-1473679467"),{legacyControlId:Ta}))}}P1g(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:nh.txf,isOfficeTab:!0,groups:[{id:nh.vef,title:nh.wef,controls:[]}]}]})}znj(P){const Ta=ug.GetServiceTaskFactory.Oa(P.da,374,375,1),Hb=ug.GetServiceTaskFactory.create(P.da,106,P.la,1);Vf.TaskExtensions.Aa(Vf.TaskExtensions.Ed([Ta,Hb],P.la),()=>{this.agaveCommandManager=
Ta.result;this.d1a=Hc.a.instance.Kh("Common.IExternalUICommandDefinitionMapping")||new Oi.a(P.Eb,P);nd.AFrameworkApplication.ub.Nb(re.a.TSf,sh.a.frame,(lc,xc,cd,id,od)=>{this.M7h(od)});this.je=Hb.result;this.je.sda(lc=>{this.sda(lc)},!0);this.initialized=!0},P.la,3)}}nh.txf="tabinsert";nh.vef="installedContentAddins";nh.wef=Td.a.instance.ga(2278);Object(d.a)(nh,"AgaveCommandRibbon",null,[680]);class oi extends h.a{constructor(P){super();this.$=P;this.Fb()}create(){if(z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)){const P=this.$.da,Ta=new nh;Ta.initialize(this.$);this.ob(P.za(488)||P.Ga(488,Ta))}}static ka(P){P.da.Ga(489,new oi(P))}}Object(d.a)(oi,"AgaveCommandRibbonFactory",h.a,[]);var Wh=a(1302),eg=a(731);class Mh{constructor(){this.j9d=this.E8d=this.zfa=null;this.Pjb=0}get displayName(){return this.zfa}set displayName(P){this.zfa=P}get email(){return this.E8d}set email(P){this.E8d=P}get federationProvider(){return this.j9d}set federationProvider(P){this.j9d=P}get identityType(){return this.Pjb}set identityType(P){this.Pjb=
P}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(P){switch(P){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P,Ta){switch(P){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,
0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokeMethodAsync(P,Ta){P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}static Rah(P){const Ta=new Mh;Ta.displayName=P.displayName;Ta.email=P.email;switch(P.authority){case Wh.a.VIf:Ta.identityType=1;break;default:Ta.identityType=0}Ta.federationProvider="";return Ta}}Object(d.a)(Mh,"OfficeIdentityInfo",null,[]);class oh{static get FPe(){return oh.Ktg}static bcc(P){return P in oh.FPe?oh.FPe[P].toString():P}}oh.map=null;oh.Ktg={["GeneralException"]:eg.a.generalException,
["AccessDenied"]:eg.a.NUc,["ApiNotAvailable"]:eg.a.apiNotAvailable,["UserNotSignedIn"]:eg.a.userNotSignedIn,["UserAborted"]:eg.a.userAborted,["UnsupportedUserIdentity"]:eg.a.AUj,["InvalidResourceUrl"]:eg.a.invalidResourceUrl,["InvalidGrant"]:eg.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:eg.a.eNg,["ResourceNotAllowed"]:eg.a.qlj,["ClientError"]:eg.a.clientError,["ServerError"]:eg.a.serverError};Object(d.a)(oh,"SingleSignOnErrorCodeMap",null,[]);class Nh{constructor(P,Ta){this.ARb=P;this.Pjb=Ta}get accessToken(){return this.ARb}set accessToken(P){this.ARb=
P}get tokenIdenityType(){return this.Pjb}set tokenIdenityType(P){this.Pjb=P}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(P){switch(P){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P,Ta){switch(P){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,
0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}}
Object(d.a)(Nh,"SingleSignOnToken",null,[]);class R{constructor(){this.Z4d=null;this.Uie=this.bXb=this.qE="";this.hke=!0;this.options=null}get authChallenge(){return this.Z4d}set authChallenge(P){this.Z4d=P}get correlationId(){return this.qE}set correlationId(P){this.qE=P}get policy(){return null}set policy(P){}get resource(){return this.bXb}set resource(P){this.bXb=P}get scope(){return this.Uie}set scope(P){this.Uie=P}get silentLogin(){return this.hke}set silentLogin(P){this.hke=P}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(P){switch(P){case 3:return this.authChallenge;
case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P,Ta){switch(P){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}}Object(d.a)(R,"TokenParameters",null,[762]);class Ua{constructor(P,Ta){this.kib=Ta;this.FA=P}get roamingSettings(){return null}getAccessToken(P){const Ta=this.kib.getOsfControl(this.FA),
Hb=Ta.getManifest(),lc=Hb.getMarketplaceID();this.COa(P,lc);return OfficeExtension.WacRuntime.Utility.createPromise((xc,cd)=>{Ta.isFirstParty()&&this.kib._enableFirstPartySSO?this.Iii(Hb,P)?Hc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(P,lc).then(id=>{xc(id)},id=>{cd(id)}):cd(eg.a.NUc):cd(eg.a.apiNotAvailable)}).then(xc=>{let cd;switch(xc.authority){case Wh.a.VIf:cd=1;break;default:cd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Nh(xc.accessToken,
cd))},xc=>{this.logErrorResponse(P,lc,xc);return xc?OfficeExtension.WacRuntime.Utility.createPromise((cd,id)=>{id(OfficeExtension.WacRuntime.Utility.createRichApiException(xc,oh.bcc(xc)))}):OfficeExtension.WacRuntime.Utility.createPromise((cd,id)=>{id(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,oh.bcc(eg.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const P=this.kib.getOsfControl(this.FA);P.getManifest();const Ta=P.getManifest().getMarketplaceID();
return OfficeExtension.WacRuntime.Utility.createPromise((Hb,lc)=>{Hc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ta).then(xc=>{Hb(xc)},xc=>{lc(xc.toString())})}).then(Hb=>{Hb=Mh.Rah(Hb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Hb)},Hb=>Hb?OfficeExtension.WacRuntime.Utility.createPromise((lc,xc)=>{xc(OfficeExtension.WacRuntime.Utility.createRichApiException(Hb,oh.bcc(Hb)))}):OfficeExtension.WacRuntime.Utility.createPromise((lc,xc)=>
{xc(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,oh.bcc(eg.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(P){switch(P){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){switch(P){case 1:return this.uLh(Ta);case 3:return this.JMh();case 2:return this.NYh()}P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}uLh(P){P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,R);return this.getAccessToken(P)}JMh(){return this.getAuthContext()}NYh(){return this.getPrimaryIdentityInfo()}Iii(P,
Ta){let Hb=!1;const lc=P.getWebApplicationAuthorizations();P=null;for(const xc of lc)if(xc.getResource().toLowerCase()===Ta.resource.toLowerCase()){P=xc;Hb=!0;break}if(!Hb)return!1;Ta=Ta.scope.split(" ,+");for(const xc of Ta)if(xc&&xc.length){Ta=!1;for(const cd of P.getScopes())xc.toLowerCase()===cd.toLowerCase()&&(Ta=!0);if(!Ta)return!1}return!0}COa(P,Ta){P=this.exf(P.resource);n.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Ta,["resource"]:P})}logErrorResponse(P,Ta,Hb){P=this.exf(P.resource);
n.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Ta,["resource"]:P,["error"]:Hb})}exf(P){return P.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(d.a)(Ua,"AuthenticationService",null,[]);class pb{create(P,Ta){return new Ua(P,Ta)}}Object(d.a)(pb,"AuthenticationServiceFactory",null,[]);var Wb=a(844),pc=a(961),Kc=a(944);class Dc{}Dc.generalException="generalException";Dc.invalidArgument="invalidArgument";Dc.notAllowed="notAllowed";Dc.apiNotAvailable="apiNotAvailable";
Dc.unresolvedPendingRequest="unresolvedPendingRequest";Dc.timeout="timeout";Dc.adalTimeout="adalTimeout";Dc.userNotSignedIn="userNotSignedIn";Dc.userAborted="userAborted";Dc.silentSignInFailed="silentSignInFailed";Dc.invalidResourceUrl="invalidResourceUrl";Dc.invalidGrant="invalidGrant";Dc.connectionLost="connectionLost";Dc.clientError="clientError";Dc.serverError="serverError";Object(d.a)(Dc,"WopiHostErrorCodes",null,[]);var Gc=a(729);class oc{}Object(d.a)(oc,"OAuthCallerMetadata",null,[]);var Qc=
a(27);class ed{constructor(P){this.xya=P;this.Btg=nd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}DEg(P,Ta,Hb,lc,xc,cd){if(!this.xya)return lc=new pc.a,lc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(lc);const id=new oc;id.AddinName=xc;id.AddinTrustId=cd;let od=-1;cd=null;if(lc&&this.uif())cd=this.xya.Ieg(be.a.zBc,P,lc,ed.f5e(xc),id);else{const Fd=Date.now();cd=this.xya.PL(be.a.zBc,P,id).then(Rd=>{od=Date.now()-
Fd;const Re=(Ta||Hb)&&"login_required"===Rd.ErrorCode;return(Ta&&("interaction_required"===Rd.ErrorCode||"consent_required"===Rd.ErrorCode||"invalid_grant"===Rd.ErrorCode)||Re)&&this.uif()?this.xya.Ieg(be.a.zBc,P,null,ed.f5e(xc),id):Promise.resolve(Rd)})}return cd.then(Fd=>{const Rd=new pc.a;Fd.IsSuccess?(Rd.token=Fd.Token,Fd.Telemetry&&(Rd.uUa=Fd.Telemetry.fromCache,Rd.expiresOn=Fd.Telemetry.expiresOn)):(Rd.errorCode=this.JCi(Fd),Rd.$Xd=this.J_i(Fd));return Rd}).catch(()=>{const Fd=new pc.a;Fd.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Fd)}).then(Fd=>{Fd.uha="OauthManager";0<=od&&(Fd.Jxb=od);return Fd})}bli(P){const Ta=(nd.AFrameworkApplication.fa.Xa(nd.AFrameworkApplication.o8)||"").toLowerCase();return(Qc.a.Rxa||"teams"===Ta&&Gc.a.Uyb)&&!ed.Gki(P)||!this.xya||!this.xya.PMa()?!1:!0}uif(){return this.Btg||1!==Kc.a.nbc()}JCi(P){switch(P.ErrorCode){case "UserCancelled":case "interaction_required":P=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;
case "consent_required":case "invalid_grant":P=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":P=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":P=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":P=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":P=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:P=
P.ErrorCode===Dc.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:P.ErrorCode===Dc.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:P.ErrorCode===Dc.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:P.ErrorCode===Dc.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:P.ErrorCode===Dc.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return P}J_i(P){let Ta=
"";(P=RegExp("AADSTS(\\d+)").exec(P.ErrorMessage))&&1<P.length&&(Ta=P[1]);return Ta}static f5e(P){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,P)}static Gki(P){if(!P)return!1;P=P.toLowerCase();for(const Ta of Wb.AppsForOfficeSingleSignOnManager.oXe)if(Ta===P)return!0;return!1}}Object(d.a)(ed,"AppsforOfficeTokenFromOauthManager",null,[220]);class Yc{constructor(P){this.TBi=P}static Woa(){if(nd.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var P=
null;try{P=Hc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ta){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ta)}P=new ed(P);Yc.Ma=new Yc(P)}}static getInstance(){Yc.eae||(Yc.Woa(),Yc.eae=!0);return Yc.Ma}}Yc.Ma=null;Yc.eae=!1;Object(d.a)(Yc,"AppsForOfficeOauthManagerFactory",null,[187]);var Kd=a(1301),Zd=a(134);class pe{constructor(P,Ta,Hb,lc){this.menuItemId=P;this.uG=Ta;this.BKj=Hb;this.RDh=lc}}Object(d.a)(pe,"NewDocumentParameters",null,[]);const Pe=P=>
{var Ta=P.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Hb=Ta.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Hb.addParameter("shortcuts","String[]",1,null,0);Ta.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Hb=Ta.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Hb.addParameter("shortcuts","Object",1,null,0);Ta=P.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Hb=Ta.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Hb.addParameter("pickerCustomizationJsonString","String",1,null,0);Ta=P.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Hb=Ta.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Hb.addParameter("base64File","String",1,null,0);Ta=P.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}",
"",3,0);Ta.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Hb=Ta.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Hb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ta=P.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ta.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,
0);Hb=Ta.addMethod("Register",1,"Void",0,0,"Register",0);Hb.addParameter("metadata","String",1,null,0);Hb.addParameter("javascript","String",1,null,0);Ta=P.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Ta.addProperty("Enabled",1,"Boolean",1,!1,null,0);Ta.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ta.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ta=P.addEnumType("Microsoft.Authentication.IdentityType");Ta.addEnumField("OrganizationAccount",
0);Ta.addEnumField("MicrosoftAccount",1);Ta=P.addEnumType("Microsoft.Authentication.AuthorityType");Ta.addEnumField("External",0);Ta.addEnumField("Msa",1);Ta.addEnumField("Aad",2);Ta=P.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ta.addProperty("DisplayName",4,"String",1,!1,null,0);Ta.addProperty("Email",3,"String",1,!1,null,0);Ta.addProperty("FederationProvider",2,"String",1,!1,null,0);Ta.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ta=P.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ta.addProperty("AppId",4,"String",1,!1,null,0);Ta.addProperty("Authority",2,"String",1,!1,null,0);Ta.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ta.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ta.addProperty("TenantId",6,"String",1,!1,null,0);Ta.addProperty("Upn",
1,"String",1,!1,null,0);Ta=P.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ta.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Hb=Ta.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Hb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ta.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);Ta.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ta=P.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Ta.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ta.addProperty("CorrelationId",7,"String",1,!1,null,0);Ta.addProperty("Policy",4,"String",1,!1,null,0);Ta.addProperty("Resource",2,"String",1,!1,null,0);Ta.addProperty("Scope",
5,"String",1,!1,null,0);Ta.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Ta=P.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ta.addProperty("AccessToken",2,"String",1,!1,null,0);Ta.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ta=P.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ta.addProperty("Id",1,"String",1,
!0,null,0);Ta.addProperty("Value",2,"Object",1,!1,null,0);Ta=P.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Hb=Ta.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Hb.addParameter("id","String",1,null,0);Hb=Ta.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Hb.addParameter("id","String",1,null,0);Ta=P.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ta.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Hb=Ta.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Hb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ta=P.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ta.addEnumField("Inactive",0);Ta.addEnumField("Background",1);Ta.addEnumField("Visible",2);Ta=P.addEnumType("Microsoft.AppRuntime.Visibility");
Ta.addEnumField("Hidden",1);Ta.addEnumField("Visible",2);Ta=P.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ta.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Hb=Ta.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Hb.addParameter("jsonCreate","String",1,null,0);Hb=Ta.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Hb.addParameter("jsonUpdate",
"String",1,null,0);Hb=Ta.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Hb.addParameter("id","String",1,null,0);Hb=Ta.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Hb.addParameter("id","String",1,null,0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ta=P.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ta.addProperty("Id",2,"String",1,!0,null,0);Hb=Ta.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Hb.addParameter("visibility","Boolean",1,null,0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ta=P.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Ta.addProperty("Enabled",3,"Boolean",1,!1,null,0);Ta.addProperty("Id",2,"String",1,!0,null,0);Ta.addProperty("Label",4,"String",1,!0,null,0);Hb=Ta.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Hb.addParameter("enabled","Boolean",1,null,0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);Ta=P.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ta.addMethod("GetCount",3,"Int32",1,1,"Count",0);Hb=Ta.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Hb.addParameter("key","String",1,null,0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ta.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ta=P.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ta.addEnumField("Unknown",0);Ta.addEnumField("Basic",
1);Ta.addEnumField("Premium",2);Ta=P.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Hb=Ta.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Hb.addParameter("feature","String",1,null,0);Hb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Hb=Ta.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Hb.addParameter("feature","String",1,null,0);Hb=Ta.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Hb.addParameter("feature","String",1,null,0);Hb.addParameter("fallbackValue","Boolean",1,null,0);Ta.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Hb=Ta.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Hb.addParameter("experienceId","String",1,null,0);Hb=Ta.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Hb.addParameter("feature","String",1,null,0);Ta=P.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ta.addProperty("Id",5,"String",1,!0,null,0);Ta.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Ta.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ta=P.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
Ta.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ta=P.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Ta.addMethod("Disable",3,"Void",0,1,"Disable",0);Ta.addMethod("Enable",2,"Void",0,1,"Enable",0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var ef=a(185);class wf{constructor(P,Ta){this.Uxg=P;this.oyg=Ta}createAndOpenWorkbook(P){if(P&&
P.length>this.Uxg)throw n.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",P.length),OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.invalidArgument,ef.a.ga(1760));const Ta=new pe("blank","agave",P?"streamBase64":"streamEmpty",P);let Hb=null;return OfficeExtension.WacRuntime.Utility.createPromise((lc,xc)=>{const cd=new Zd.StandardDialog;cd.Rb=4;cd.Zl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,id=>{2===id||0===id?xc("Cancelled"):
(Hb=window.open(""),this.oyg.create(lc,xc,Ta).G1a())})}).then(lc=>{if(!lc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,ef.a.ga(1756));try{Hb.top.location.href=lc}catch(xc){n.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Qc.a.Bp,xc),n.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Hb.location.replace(lc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},lc=>{if("Cancelled"===lc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.AEd,ef.a.ga(1759));Hb.close();this.ENj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){switch(P){case 1:return this.F9g(Ta)}P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}F9g(P){P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"string");return this.createAndOpenWorkbook(P)}ENj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,
ef.a.ga(1756));}}Object(d.a)(wf,"WacWorkbook",null,[]);const Uf=(P,Ta)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof P+", objectId="+P+", value="+Ta);return null},hf=P=>{P.add("InternalTest","PreviewExecutionMethod",Uf)};var Af=a(249),kf=a(730),ag=a(738);class mg{constructor(P){this.jb=P}get $(){return this.jb}}Object(d.a)(mg,"RichApiPreviewExecutionContext",null,[]);var Eg=a(24),Fg=a(965),Vg=a(33),vh=a(207),rf=a(210),ff=a(108),yf=a(12);class Pf extends rf.a{constructor(P,
Ta,Hb,lc,xc){super(P,"Select Data");this.htmlSanitizationHelper=this.Xpb=null;this.GJe=Ta;this.d7c=Hb;this.htmlSanitizationHelper=xc;this.callback=lc}get pc(){return"DdaBindingPrompt"}start(P,Ta){let Hb="<div class='"+ff.a.Ush+" "+Mg.a.Bo+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+ff.a.oF+"' /></div>";Hb=String.format(Hb,Xf.a.Gg(this.d7c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
z.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.dk(this.Mb,Hb):this.Mb.innerHTML=Hb;this.Xpb=yf.DOMElementExtensions.getElementById(this.Mb,"bindingText");P=Ta?P.G3a(Ta,this.d7c.DdaBindingsMethod.BindingId):null;(null===P||void 0===P?0:P.IsValidRef)?(Ta=new Eg.Range(P.Reference.FirstRow+1,P.Reference.FirstColumn+1,P.Reference.LastRow+1,P.Reference.LastColumn+1,!1,!1),this.Xpb.value=P.Reference.SheetName+
"!"+Ta):(P=yg.h(this.$).ha,this.Xpb.value=Gh.f(this.$.oa)||!P.ra.Og?"":P.yia);this.initialize();this.vg()}uq(){this.L1c();this.addButton(0);this.addButton(1);super.uq()}setFocus(){yf.DOMElementExtensions.setFocus(this.Xpb)}validate(){return!0}commit(){let P=this.Xpb.value.trim();const Ta=P.indexOf("!");-1!==Ta&&(P=this.H0h(P.substring(0,Ta))+P.substr(Ta));this.GJe.addBinding(this.d7c,P,0,this.callback);return!0}Zsa(){this.GJe.yQ.rf(kf.a.internalError,this.callback);super.Zsa()}H0h(P){P=Fh.a.trimStart(P.trim(),
"=");return P.length?P.startsWith("'")&&P.endsWith("'")?P:Zh.HelperMethods.q9b(P):""}}Object(d.a)(Pf,"DdaBindingPrompt",rf.a,[]);class Sf{constructor(P){this.ea=P}rf(P,Ta){if(Ta){const Hb={};Hb.Error=P;Hb.Version=this.ea.ze;Ta(Hb)}}GKa(P,Ta){this.rf(P,Ta)}JH(P,Ta){this.rf(kf.a.LYe(P.Errors[0].MessageId),Ta)}xv(P){P&&P(this.kQ())}kQ(){const P={Error:0};P.Version=this.ea.ze;return P}}Object(d.a)(Sf,"DdaErrorGenerator",null,[]);var Kf=a(282);class Nf{constructor(P,Ta,Hb){this.$=P;this.yQ=Ta;this.oA=
Hb}Ezd(P,Ta){const Hb=P.DdaGoToByIdMethod.GoToType,lc=P.DdaGoToByIdMethod.SelectionMode,xc=P.DdaGoToByIdMethod.Id.toString().trim(),cd=id=>{const od=this.$.xa.getItemByName(id.SheetName);(null===od||void 0===od?0:od.visible)?(yg.h(this.$).Bg(id,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.yQ.xv(Ta)):this.yQ.rf(kf.a.l_g,Ta)};0===Hb?this.EGi(xc,lc,P.DdaMethod.ControlId,cd,Ta):1===Hb?this.IGi(xc,lc,cd,Ta):this.yQ.rf(kf.a.xUj,Ta)}EGi(P,Ta,Hb,lc,xc){this.oA.ddaGetBinding(Hb,
P,cd=>{if(!Kf.a(cd)&&cd.Result&&cd.Result.Reference){cd=cd.Result;var id={};id.SheetName=cd.Reference.SheetName;id.FirstRow=cd.Reference.FirstRow;id.FirstColumn=cd.Reference.FirstColumn;id.LastRow=cd.Reference.LastRow;id.LastColumn=cd.Reference.LastColumn;Nf.uXc(id,Ta);1!==cd.BindingType?lc(id):this.oA.ddaGetBindingData(Hb,P,1,0,2,0,0,-1,-1,od=>{Kf.a(od)||!od.Result?this.yQ.JH(od,xc):(od=od.Result,2!==Ta&&(id.FirstRow-=od.Headers.length,0>id.FirstRow&&(id.FirstRow=0)),lc(id))},xc)}else this.yQ.GKa(kf.a.F9f,
xc)},xc)}IGi(P,Ta,Hb,lc){var xc=Eh.z(P);xc?(xc=Eh.v(xc,this.$),Nf.uXc(xc,Ta),Hb(xc)):this.$.ea.isNamedObjectViewMode&&this.$.Cb.Rk(P)?this.$.Cb.oa=this.$.Cb.getItemByName(P):(xc=cd=>{Kf.a(cd)||!cd.Result?this.$.xa.contains(P)?(cd={},cd.SheetName=P,cd.FirstRow=0,cd.FirstColumn=0,cd.LastRow=0,cd.LastColumn=0,Hb(cd)):this.yQ.GKa(kf.a.F9f,lc):(cd=cd.Result,Nf.uXc(cd,Ta),Hb(cd))},this.$.xa.oa?this.oA.parseRangeForGoto(P,this.$.xa.oa.name,xc,lc):this.oA.parseRange(P,xc,lc))}static uXc(P,Ta){P.LastRow=2===
Ta?P.FirstRow:P.LastRow;P.LastColumn=2===Ta?P.FirstColumn:P.LastColumn}}Object(d.a)(Nf,"DdaNavigator",null,[]);const Qf=(P,Ta,Hb,lc,xc,cd)=>{const id=P.Na(1);id.request=Ta;return Dg.g(P,"ExecuteRichApiRequest",id,Hb,lc,xc,cd,0)};var Rf=a(294),gg;(function(P){P[P.unsupported=0]="unsupported";P[P.surface=1]="surface";P[P.combo=2]="combo";P[P.column=3]="column";P[P.column3D=4]="column3D";P[P.bar=5]="bar";P[P.bar3D=6]="bar3D";P[P.line=7]="line";P[P.line3D=8]="line3D";P[P.pie=9]="pie";P[P.pie3D=10]="pie3D";
P[P.scatter=11]="scatter";P[P.bubble=12]="bubble";P[P.area=13]="area";P[P.area3D=14]="area3D";P[P.doughnut=15]="doughnut";P[P.radar=16]="radar";P[P.stock=17]="stock";P[P.waterfall=18]="waterfall";P[P.funnel=19]="funnel";P[P.treemap=20]="treemap";P[P.sunburst=21]="sunburst";P[P.boxWhisker=22]="boxWhisker";P[P.histogram=23]="histogram";P[P.pareto=24]="pareto";P[P.regionMap=25]="regionMap";P[P.noVisibleSeries=26]="noVisibleSeries";P[P.complexDataSource=27]="complexDataSource";P[P.pivotChart=28]="pivotChart"})(gg||
(gg={}));Object(d.b)("ChartCategory",gg);class Xg{constructor(P,Ta){this.source=P;this.eventId=Ta}}Object(d.a)(Xg,"MacroRecorderEventData",null,[]);class Ff{constructor(P,Ta,Hb){this.parentName=P;this.$=Ta;this.request=Hb}a_h(P){var Ta;if(void 0===P||null===P||void 0===P.RequestBody||null===P.RequestBody)return null;const Hb=JSON.parse(P.RequestBody);if(void 0!==P.ActiveChartId&&null!==P.ActiveChartId){Hb.ActiveChartId=P.ActiveChartId;const lc=yg.h(this.$).ha.Sa.$b;if(null===(Ta=null===lc||void 0===
lc?void 0:lc.floatingObject)||void 0===Ta?0:Ta.Vc)Hb.ActiveChartType=gg[lc.floatingObject.Vc.ChartCategory]}void 0!==P.SheetMultiRange&&null!==P.SheetMultiRange&&(Hb.SheetName=P.SheetMultiRange.SheetName);return Hb}o_h(P){if(void 0===P||null===P||void 0===P.Result||null===P.Result)return null;P=P.Result;return void 0===P.ResponseBody||null===P.ResponseBody||P.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(P.ResponseBody.join(""))}ypi(P){return!!P&&!(void 0===P.eventId||null===P.eventId)&&
0<P.eventId.length}jk(P){return()=>{if(this.$.Qba){const Ta=this.AWg(this.request);if(this.ypi(Ta)){const Hb=this.a_h(this.request),lc=this.o_h(P);if(Hb&&!Rh.a.isEmpty(Hb)&&lc&&!Rh.a.isEmpty(lc))return n.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new X(Ta,Hb,lc);n.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Hb?"(not null)":"(null)"}; responseInfo: ${lc?"(not null)":"(null)"}`}`)}}return new X(null,
null,null)}}AWg(P){const Ta=this.zpi(P.SolutionId),Hb=Ff.IZh(P);if(Hb&&Ta)return n.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Hb,["request.SolutionId"]:P.SolutionId})}`),new Xg(P.SolutionId,Hb);P=JSON.stringify({["recorderEventId"]:Hb,["isRecorderAwareAddin"]:Ta,["request.SolutionId"]:P.SolutionId});n.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${P}`);return null}zpi(P){if(!P)return!1;P=P.toLowerCase();return Ff.B4h().contains(P)}static B4h(){Ff.rAa||
(Ff.rAa=new r.a(Q.a.Yj()),Ff.rAa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Ff.rAa.add("fa000000005"),Ff.rAa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Ff.rAa.add("fa000000014"),Ff.rAa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return Ff.rAa}static IZh(P){let Ta=null;var Hb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Hb.test(P.RequestBody))Ta=Hb.exec(P.RequestBody)[1];else{P=P.RequestHeaders;if(!P)return Ta;Hb=pf.a.jJi.toLowerCase();for(let lc=0;lc<P.length;lc++)if(P[lc].Name.toLowerCase()===
Hb){Ta=P[lc].Value;break}}return Ta}}Ff.rAa=null;Object(d.a)(Ff,"DdaRichApiRequestRecorder",null,[]);class pi extends Rf.a{constructor(P,Ta,Hb,lc,xc,cd,id,od){super(10,0,Ta,od);this.Nmb=Hb;this.ejb=lc;this.V3=xc;this.bGa=cd;this.request=id;this.jOd=new Ff("10",P,id)}get bEc(){return this.bGa}get Wt(){return this.Nmb}get Eaa(){return this.ejb}i3(P){return super.i3(P)||this.fZg(P)}jk(){return this.jOd.jk(this.nd)}Gfb(){const P={OperationType:3};P.RichApiRequest=this.request;return P}fZg(P){return(Ta,
Hb,lc)=>Qf(P,this.request,Tf.b(Ta,this.Nmb),Tf.a(Hb,this.ejb),lc,this.V3)}}Object(d.a)(pi,"DdaRichApiRequestBatchOperation",Rf.a,[]);class Di extends Hh.a{constructor(P,Ta,Hb,lc){super(576,0,Hb,lc);this.jOd=new Ff("576",P,Ta)}jk(){return this.jOd.jk(this.nd)}}Object(d.a)(Di,"DdaRichApiRequestOperation",Hh.a,[]);class Pi{constructor(P,Ta){this.AI=(Hb,lc)=>{this.yQ.GKa(kf.a.internalError,lc)};this.$=P;this.yQ=Ta}ddaAddBinding(P,Ta,Hb,lc,xc,cd,id){this.gK((od,Fd,Rd)=>{var Re=this.$.pa.ya,We=this.Mja();
od=Tf.b(od,cd);Fd=Tf.a(Fd,this.AI);const lf=Re.Na(9);lf.controlId=P;lf.bindingId=Ta;lf.bindingType=Hb;lf.currentSheetName=We;lf.formula=lc;lf.options=xc;return Dg.g(Re,"DdaAddBinding",lf,od,Fd,Rd,id,0)},id,563)}ddaReleaseBinding(P,Ta,Hb,lc){this.gK((xc,cd,id)=>{var od=this.$.pa.ya;xc=Tf.b(xc,Hb);cd=Tf.a(cd,this.AI);const Fd=od.Na(9);Fd.controlId=P;Fd.bindingId=Ta;return Dg.g(od,"DdaReleaseBinding",Fd,xc,cd,id,lc,0)},lc,564)}ddaGetBinding(P,Ta,Hb,lc){this.gK((xc,cd,id)=>{var od=this.$.pa.ya;xc=Tf.b(xc,
Hb);cd=Tf.a(cd,this.AI);const Fd=od.Na(1);Fd.controlId=P;Fd.bindingId=Ta;return Dg.g(od,"DdaGetBinding",Fd,xc,cd,id,lc,0)},lc,565,16)}ddaGetAllBindings(P,Ta,Hb){this.gK((lc,xc,cd)=>{var id=this.$.pa.ya;lc=Tf.b(lc,Ta);xc=Tf.a(xc,this.AI);const od=id.Na(1);od.controlId=P;return Dg.g(id,"DdaGetAllBindings",od,lc,xc,cd,Hb,0)},Hb,566,16)}ddaGetBindingData(P,Ta,Hb,lc,xc,cd,id,od,Fd,Rd,Re){this.gK((We,lf,rg)=>{var fg=this.$.pa.ya,$f=this.Mja();We=Tf.b(We,Rd);lf=Tf.a(lf,this.AI);const bg=fg.Na(1);bg.controlId=
P;bg.bindingId=Ta;bg.coerceType=Hb;bg.valueFormat=lc;bg.filterType=xc;bg.startRow=cd;bg.startCol=id;bg.rowCount=od;bg.colCount=Fd;bg.currentSheetName=$f;return Dg.g(fg,"DdaGetBindingData",bg,We,lf,rg,Re,0)},Re,567,16)}ddaSetBindingData(P,Ta,Hb,lc,xc,cd,id){this.gK((od,Fd,Rd)=>{var Re=this.$.pa.ya,We=this.Mja();od=Tf.b(od,cd);Fd=Tf.a(Fd,this.AI);const lf=Re.Na(9);lf.controlId=P;lf.bindingId=Ta;lf.startRow=Hb;lf.startCol=lc;lf.currentSheetName=We;lf.bindingData=xc;return Dg.g(Re,"DdaSetBindingData",
lf,od,Fd,Rd,id,0)},id,568)}ddaGetSelectedData(P,Ta,Hb,lc,xc,cd,id){this.gK((od,Fd,Rd)=>{var Re=this.$.pa.ya,We=this.Mja();od=Tf.b(od,cd);Fd=Tf.a(Fd,this.AI);const lf=Re.Na(1);lf.controlId=P;lf.coerceType=Ta;lf.valueFormat=Hb;lf.filterType=lc;lf.currentSheetName=We;lf.formula=xc;return Dg.g(Re,"DdaGetSelectedData",lf,od,Fd,Rd,id,0)},id,569,16)}ddaSetSelectedData(P,Ta,Hb,lc,xc){this.gK((cd,id,od)=>{var Fd=this.$.pa.ya,Rd=this.Mja();cd=Tf.b(cd,lc);id=Tf.a(id,this.AI);const Re=Fd.Na(9);Re.controlId=P;
Re.currentSheetName=Rd;Re.formula=Ta;Re.bindingData=Hb;return Dg.g(Fd,"DdaSetSelectedData",Re,cd,id,od,xc,0)},xc,570)}ddaLoadSettings(P,Ta,Hb){this.gK((lc,xc,cd)=>{var id=this.$.pa.ya;lc=Tf.b(lc,Ta);xc=Tf.a(xc,this.AI);const od=id.Na(1);od.controlId=P;return Dg.g(id,"DdaLoadSettings",od,lc,xc,cd,Hb,0)},Hb,501,16)}ddaSaveSettings(P,Ta,Hb,lc,xc){this.gK((cd,id,od)=>{var Fd=this.$.pa.ya;cd=Tf.b(cd,lc);id=Tf.a(id,this.AI);const Rd=Fd.Na(9);Rd.controlId=P;Rd.settings=Ta;Rd.overwriteIfStale=Hb;return Dg.g(Fd,
"DdaSaveSettings",Rd,cd,id,od,xc,0)},xc,571)}ddaAddRowsColumns(P,Ta,Hb,lc,xc,cd){this.gK((id,od,Fd)=>{var Rd=this.$.pa.ya,Re=this.Mja();id=Tf.b(id,xc);od=Tf.a(od,this.AI);const We=Rd.Na(9);We.controlId=P;We.bindingId=Ta;We.isRow=Hb;We.currentSheetName=Re;We.bindingData=lc;return Dg.g(Rd,"DdaAddRowsColumns",We,id,od,Fd,cd,0)},cd,572)}ddaDeleteAllDataValues(P,Ta,Hb,lc){this.gK((xc,cd,id)=>{var od=this.$.pa.ya,Fd=this.Mja();xc=Tf.b(xc,Hb);cd=Tf.a(cd,this.AI);const Rd=od.Na(9);Rd.controlId=P;Rd.bindingId=
Ta;Rd.currentSheetName=Fd;return Dg.g(od,"DdaDeleteAllDataValues",Rd,xc,cd,id,lc,0)},lc,573)}ddaClearBindingFormats(P,Ta,Hb,lc){this.gK((xc,cd,id)=>{var od=this.$.pa.ya,Fd=this.Mja();xc=Tf.b(xc,Hb);cd=Tf.a(cd,this.AI);const Rd=od.Na(9);Rd.controlId=P;Rd.bindingId=Ta;Rd.currentSheetName=Fd;return Dg.g(od,"DdaClearBindingFormats",Rd,xc,cd,id,lc,0)},lc,574)}ddaSetBindingFormats(P,Ta,Hb,lc,xc,cd){this.gK((id,od,Fd)=>{var Rd=this.$.pa.ya,Re=this.Mja();id=Tf.b(id,xc);od=Tf.a(od,this.AI);const We=Rd.Na(9);
We.controlId=P;We.bindingId=Ta;We.currentSheetName=Re;We.bindingData=Hb;We.isSetFormats=lc;return Dg.g(Rd,"DdaSetBindingFormats",We,id,od,Fd,cd,0)},cd,575)}parseRange(P,Ta,Hb){this.gK((lc,xc,cd)=>{const id=this.$.pa.ya.Wb();return Dg.v(this.$.pa.ya,P,-1,Tf.b(lc,Ta),Tf.a(xc,this.AI),cd,Hb,id)},Hb,162,16)}parseRangeForGoto(P,Ta,Hb,lc){this.gK((xc,cd,id)=>{const od=this.$.pa.ya.Wb();return Dg.w(this.$.pa.ya,P,Ta,Tf.b(xc,Hb),Tf.a(cd,this.AI),id,lc,od)},lc,562,16)}executeRichApiRequest(P,Ta,Hb){z.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(P.RequestFlags&=8191);if(z.EwaSettings.ma(256))this.bCh(this.$.pa.ya.Wb(),Ta,()=>{this.yQ.GKa(kf.a.internalError,Hb)},Hb,P);else{let lc=Cd.DdaFacade.hhd(P);!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.uy||lc&16?(lc|=64,this.$.userOperationManager.kD(new Di(this.$,P,(xc,cd,id)=>Qf(this.$.pa.ya,P,Tf.b(xc,Ta),Tf.a(cd,this.AI),id,Hb),lc))):(this.yQ.GKa(kf.a.aFc,Hb),n.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}Mja(){return this.$.ea.isNamedObjectViewMode?
this.$.oa.sheetName:this.$.activeItemName}gK(P,Ta,Hb,lc=0){!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.uy||lc&16?this.$.userOperationManager.kD(new Hh.a(Hb,0,P,lc|64)):(this.yQ.GKa(kf.a.aFc,Ta),n.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}bCh(P,Ta,Hb,lc,xc){let cd=Cd.DdaFacade.hhd(xc);if(!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.uy||cd&16){var id=this.$.Jb.Ac("UserAction",
"Rich Api request");this.$.userOperationManager.Ic(new pi(this.$,P,Ta,Hb,lc,id,xc,cd|64),null)}else this.yQ.GKa(kf.a.aFc,lc),n.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(d.a)(Pi,"DdaWebServiceHelper",null,[]);class Ei{constructor(P,Ta,Hb,lc){this.FDh=P;this.fileSize=Ta;this.YGj=lc}}Object(d.a)(Ei,"DocumentFile",null,[]);class dg{}dg.generalException="GeneralException";dg.XOg="ApiNotFound";dg.AEd="OperationCancelled";dg.invalidArgument="InvalidArgument";Object(d.a)(dg,
"ErrorCodes",null,[]);class Og{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}Object(d.a)(Og,"WacApiDelegates",null,[]);var ch=a(614);class Zf extends Og{constructor(P,Ta){super();this.hlf=(Hb,lc)=>{Hb=Zf.$7g(Hb,lc);if(!ch.a(this.$,Hb))return!0;Hb=this.$.shortcutKeyManager.u6e(Hb);return!!Hb&&
0<Hb.length};this.addinId=P;this.$=Ta}replaceShortcuts(P){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,P,this.hlf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(P){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(P,this.hlf)}static Bbh(P,Ta){const Hb=document.createEvent("KeyboardEvent");if(Qc.a.RF)Hb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(P&8),!!(P&32),!!(P&4),!!(P&256));else{const lc=
[];P&4&&lc.push("Shift");P&8&&lc.push("Control");P&32&&lc.push("Alt");Hb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,lc.join(" "),!1,"en-US")}P=new Sys.UI.DomEvent(Hb);P.keyCode=Ta;return P}static $7g(P,Ta){if(Qc.a.If)switch(Ta){case 189:Ta=173;break;case 187:Ta=61;break;case 186:Ta=59}return Zf.Bbh(P,Ta)}}Object(d.a)(Zf,"ExcelWacApiDelegates",Og,[]);class hg{constructor(P){this.tJa={};this.yDi=P}mGg(P,Ta){this.zec(P)||(this.tJa[P]={});if(this.Fki(P))return n.ULS.sendTraceTag(537163157,344,
50,`App ${P} has reach the limit of number of cached files.`),kf.a.hEi;this.tJa[P][Ta.FDh.toString()]=Ta;return kf.a.success}rRh(P,Ta){let Hb=null;this.zec(P)&&(Hb=this.tJa[P][Ta.toString()]);Hb||n.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${P}, fileHandler:${Ta}] doesn't exist`);return Hb}zec(P){return P in this.tJa}Vcj(P,Ta){if(this.zec(P)){const Hb=this.tJa[P];delete Hb[Ta.toString()];1>Object.keys(Hb).length&&delete this.tJa[P];return Ta.toString()in Hb?kf.a.internalError:kf.a.success}return kf.a.internalError}Fki(P){return this.zec(P)?
Object.keys(this.tJa[P]).length>=this.yDi:!1}static getInstance(P){return P.da.za(200)||P.da.Ga(200,new hg(hg.zDi))}static qHi(){return++hg.wYg}}hg.cDi=4194304;hg.zDi=1;hg.wYg=0;Object(d.a)(hg,"GetFileApiHelper",null,[]);class ih{constructor(P){this.FA=P}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.FA)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){switch(P){case 1:return this.WHi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){P=this.invokeMethod(P,
Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}WHi(){this.notifyActionHandlerReady();return null}}Object(d.a)(ih,"AddinInternalService",null,[]);class wh{constructor(P,Ta){this.qJ=Ta;this.FA=P}getAppRuntimeState(){return this.qJ.getAppRuntimeState(this.FA)?2:1}setAppRuntimeState(P){switch(P){case 2:P=!0;break;case 1:P=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.invalidArgument,ef.a.ga(1760));}this.qJ.setAppRuntimeState(this.FA,P)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P,Ta){switch(P){case 2:return this.xMh();case 1:return this.Osj(Ta)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,
Ta){P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}xMh(){return this.getAppRuntimeState()}Osj(P){P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"int");this.setAppRuntimeState(P);return null}}Object(d.a)(wh,"AppRuntimeService",null,[]);var Bh=a(966);class Xh{constructor(P,Ta,Hb,lc){this.yx=P;this.R1=Hb;this.az=lc.Xh.getOsfControl(Ta)}disable(){try{if(!ef.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.vGe();
if(!this.Ekf())return this.wGe();this.R1.DTj(this.yx)}catch(P){return n.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",P.message||"Unknown"),this.tGe()}return null}enable(){try{if(!ef.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.vGe();if(!this.Ekf())return this.wGe();this.R1.Uaj(this.yx)}catch(P){return n.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
P.message||"Unknown"),this.tGe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,
Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){switch(P){case 1:return this.fDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){switch(P){case 3:return this.Nkh();case 2:return this.Cph()}P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}Nkh(){return this.disable()}Cph(){return this.enable()}fDa(){this._OnAccess();return null}vGe(){return Bh.a(eg.a.notImplemented,
ef.a.ga(1761))}wGe(){return Bh.a(eg.a.sharedRuntimeNotAvailable,ef.a.ga(1765))}tGe(){return Bh.a(eg.a.generalException,ef.a.ga(1756))}Ekf(){const P=this.az.getSharedRuntimeId();return!!P&&0<P.length}}Object(d.a)(Xh,"BeforeDocumentCloseNotification",null,[]);class $i{constructor(){this.Ike=this.Oee=this.yA=!1}get enabled(){return this.yA}set enabled(P){this.yA=P}get nativeRuntime(){return this.Oee}set nativeRuntime(P){this.Oee=P}get streamingEnabled(){return this.Ike}set streamingEnabled(P){this.Ike=
P}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(P){switch(P){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P,Ta){switch(P){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokeMethodAsync(P,Ta){P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}}Object(d.a)($i,"CustomFunctionEngineStatus",null,[]);class aj{constructor(P,Ta,Hb){this.fwg=P;this.gwg=Ta;this.$zg=Hb}get status(){const P=new $i;P.enabled=this.fwg;P.streamingEnabled=this.gwg;P.nativeRuntime=!1;return P}register(P){return OfficeExtension.WacRuntime.Utility.createPromise(this.$zg(P))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(P){switch(P){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){switch(P){case 1:return this.Ibj(Ta)}P=this.invokeMethod(P,
Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}Ibj(P){const Ta=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"string");P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,1,"string");return this.register(Ta,P)}}Object(d.a)(aj,"CustomFunctionManager",null,[]);var bj=a(943);class cj{constructor(P,Ta,Hb,lc){this.L5d="";this.NTb=0;this.pP=P;this._id=Ta;this.FA=Hb;this.qJ=lc}get id(){return this._id}_RegisterStateChange(){this.NTb||this.pP.execute(P=>
{this.L5d=P.hna(this._id,Ta=>{this.qJ.JFh(this.FA,this._id,JSON.stringify(Ta))})});this.NTb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.NTb--;this.NTb||this.pP.execute(P=>{P.NKd(this._id,this.L5d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(P){switch(P){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){switch(P){case 6:return this.Hpg();case 7:return this.Jpg()}P=
this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}Hpg(){return this._RegisterStateChange()}Jpg(){return this._UnregisterStateChange()}}Object(d.a)(cj,"LicenseFeature",null,[]);class dj{constructor(P,Ta){this.pP=Hc.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.FA=P;this.qJ=Ta;this.Ryg=this.qJ.Xh.getOsfControl(this.FA)}getFeatureTier(P,Ta){return OfficeExtension.WacRuntime.Utility.createPromise(Hb=>{const lc=1===Ta?1:2===
Ta?2:0;this.pP.execute(xc=>{xc.getFeatureTier(P,lc).then(cd=>{Hb(this.FVh(cd))},()=>{Hb(Ta)})})})}getLicenseFeature(P){P=new cj(this.pP,P,this.FA,this.qJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}isFeatureEnabled(P,Ta){return OfficeExtension.WacRuntime.Utility.createPromise(Hb=>{this.pP.execute(lc=>{lc.isFeatureEnabled(P,Ta).then(xc=>{Hb(xc)},()=>{Hb(Ta)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(P=>{this.pP.execute(Ta=>{Ta=
Ta.isFreemiumUpsellEnabled();P(Ta)})})}launchUpsellExperience(P){if(this.Ryg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.pP.execute(Ta=>{Ta.launchUpsellExperience(P)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.NUc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P,Ta){switch(P){case 6:return this.Ipg(Ta)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){switch(P){case 2:return this.kSh(Ta);case 5:return this.EVh(Ta);
case 1:return this.rli(Ta);case 3:return this.bmi();case 4:return this.Nvi(Ta)}P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}kSh(P){const Ta=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"string");P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,1,"int");return this.getFeatureTier(Ta,P)}EVh(P){P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"string");return this.getLicenseFeature(P)}rli(P){const Ta=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,
0,"string");P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,1,"boolean");return this.isFeatureEnabled(Ta,P)}bmi(){return this.isFreemiumUpsellEnabled()}Nvi(P){P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"string");return this.launchUpsellExperience(P)}Ipg(P){P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"string");this._TestFireStateChangedEvent(P);return null}FVh(P){switch(P){case 1:return 1;case 2:return 2;default:return 0}}}Object(d.a)(dj,"License",
null,[]);var jj=a(153);const kj=(P,Ta,Hb)=>lc=>(xc,cd)=>{Vf.TaskExtensions.Aa(ug.GetServiceTaskFactory.create(Ta.da,279,Ta.la,1),id=>{id=id.result;let od=!1;var Fd=Hb.Xh.getOsfControl(P);let Rd=null;Fd&&(Rd=Fd.getStoreType(),(Fd=Fd.getManifest())&&Fd.getSharedRuntimeForCustomFunctions("Workbook")&&(od=!0));Vf.TaskExtensions.Aa(id.tef(P,Rd,lc,od),Re=>{jj.b(Re)?Re.result?xc(null):cd(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.invalidArgument,Td.a.instance.ga(1760))):cd(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,
Td.a.instance.ga(1756)))},Ta.la,3)},Ta.la,3)};class Xi{constructor(P){if(!P)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Gxd=P}areShortcutsInUse(P){return OfficeExtension.WacRuntime.Utility.createPromise((Ta,Hb)=>{this.Gxd.checkShortcutsInUse(P).then(lc=>{Ta(lc)}).catch(lc=>{Hb(lc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((P,Ta)=>{this.Gxd.getShortcuts().then(Hb=>{P(Hb)}).catch(Hb=>{Ta(Hb)})})}replaceShortcuts(P){return OfficeExtension.WacRuntime.Utility.createPromise((Ta,
Hb)=>{this.Gxd.replaceShortcuts(P).then(()=>{Ta(null)}).catch(lc=>{Hb(lc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokeMethodAsync(P,Ta){switch(P){case 3:return this.EQg(Ta);case 1:return this.L0h();case 2:return this.uij(Ta)}P=this.invokeMethod(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}EQg(P){P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"Array<string>");return this.areShortcutsInUse(P)}L0h(){return this.getShortcuts()}uij(P){P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"any");return this.replaceShortcuts(P)}}Object(d.a)(Xi,"ActionService",
null,[]);var ej=a(518);class fj{constructor(){this.Jra=null}z0h(){this.Jra||(this.Jra=ej.a.kr(Hc.a.instance.Ub("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Jra}getSharedFilePickerResponse(P){return OfficeExtension.WacRuntime.Utility.createPromise((Ta,Hb)=>{try{const lc=this.z0h();lh.Task.WAA.call(null,lc).continueWith(()=>{const xc=lc.result;if(xc){let cd={};({At:cd}=Ef.d(P)).returnValue?xc.Rfd(cd).then(id=>{id&&0<id.length?Ta(id):Hb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(id=>{Hb(id)}):Hb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Hb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(lc){Hb(lc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);
}invokePropertyGetAsync(P){P=this.invokePropertyGet(P);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}invokePropertySet(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokePropertySetAsync(P,Ta){this.invokePropertySet(P,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(P){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(P);}invokeMethodAsync(P,Ta){switch(P){case 1:return this.y0h(Ta)}P=this.invokeMethod(P,
Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(P)}y0h(P){P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(P,0,"string");return this.getSharedFilePickerResponse(P)}}Object(d.a)(fj,"SharedFilePicker",null,[]);class gj{createInstance(P,Ta){switch(P){case "Microsoft.Office.ActionService":return new Xi(Ta);case "Microsoft.Office.SharedFilePicker":return new fj}return null}}Object(d.a)(gj,"WacApiHost",null,[]);class hj{constructor(P,Ta,Hb,lc,xc){this.sUc=null;this.WRb=
P;this.FA=Ta;this.qJ=Hb;this.jb=lc;this.WDg=xc}hostName(){return"ExcelOnline"}appId(){return this.WRb}createInstance(P){switch(P){case "Microsoft.Authentication.AuthenticationService":return Hc.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.FA,this.qJ.Xh);case "Microsoft.Authentication.TokenParameters":return new R;case "Microsoft.ExcelServices.CustomFunctionManager":P=this.jb.ma(121);var Ta=this.jb.ma(122);return new aj(P,Ta,kj(this.WRb,
this.jb,this.qJ));case "Microsoft.AppRuntime.AppRuntimeService":return new wh(this.FA,this.qJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return P=Af.a(this.jb),new Xh(this.WRb,this.FA,P,this.qJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return P=Af.a(this.jb),new bj.DynamicRibbon(this.WRb,this.FA,this.qJ,P,P.zn(this.FA).wl);case "Microsoft.Office.Licensing.License":return new dj(this.FA,this.qJ);case "Microsoft.InternalService.AddinInternalService":return new ih(this.FA);
default:if(this.sUc||(this.sUc=new gj),Ta=this.sUc.createInstance(P,this.WDg))return Ta}n.ULS.sendTraceTag(537163155,0,10,`Typename: ${P} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,eg.a.generalException);}}Object(d.a)(hj,"RichApiHost",null,[]);var lj=a(381),ij=a(28),mj=a(118),Yi=a(35),nj=a(99),oj=a(285),pj=a(44),qj=a(250),rj=a(6),sj=a(69),tj=a(200);class xf{constructor(P,Ta,Hb,lc){this.htmlSanitizationHelper=
this.rangePicker=null;this.$=P;this.je=Ta;this.htmlSanitizationHelper=lc;this.ye=new Sf(P.ea);this.oA=new Pi(P,this.ye);this.Xvf=Hb;this.w$b=new Map}get yQ(){return this.ye}dispose(){this.$=this.w$b=null}nc(){return!1}Kc(){return!1}executeCommand(P,Ta,Hb){P=Ta.command;switch(P){case 451041795:this.ye.rf(Hb[Lg.a.og],Hb[Lg.a.V3]);break;case 974713501:this.$6h(Hb[Lg.a.og],Hb[Lg.a.V3]);break;case 1237877382:this.ye.xv(Hb[Lg.a.V3]);break;default:return $h.a(P)}return lh.Task.Ta(!0)}wc(P,Ta,Hb){if(P=!!Hb)switch(Ta.command){case 974713501:case 1237877382:case 451041795:break;
default:P=!1}return P}$6h(P,Ta){var Hb,lc;const xc=P.DdaMethod;"undefined"===typeof xc.DispatchId?this.ye.rf(kf.a.internalError,Ta):xf.xki(P)||this.$.qd&1?(xc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Pf(this.$,this,P,Ta,this.htmlSanitizationHelper)).start(this.je,P.DdaMethod.ControlId):xc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.$_h(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.mxj(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(P,this.lfd(P.DdaMethod.ControlId),0,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.cNh(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.$sj(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.bNh(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Ucj(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.bMh(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Gvd(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(P.DdaAddRowsColumns.IsRow=!0,this.qpe(P,Ta)):xc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(P.DdaAddRowsColumns.IsRow=!1,this.qpe(P,Ta)):xc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.wih(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.c2g(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(P.DdaSetBindingFormats.IsSetFormats=!0,this.L1f(P,Ta)):xc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(P.DdaSetBindingFormats.IsSetFormats=!1,this.L1f(P,Ta)):xc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(P,P.DdaBindingsMethod.ItemName,P.DdaBindingsMethod.FailOnCollision?2:1,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.oSh(Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.Ezd(P,Ta):xc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.oRh(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.pRh(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Wcj(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(P.DdaMethod.ControlId,P),this.ye.xv(Ta)):
xc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?z.EwaSettings.ma(23)?this.ye.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ta):this.DEi(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?z.EwaSettings.ma(23)?this.ye.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ta):this.zEi(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(P,Ta):xc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(P,Ta):this.ye.rf(kf.a.EEd,Ta),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&xc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(P=this.je.FZ(P.DdaMethod.ControlId),Ta="",P&&(Ta=Cd.DdaFacade.getSolutionId(P,this.$),z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Ta=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta,P.OwnerAddinStoreType||P.PrimaryMarketplace.MarketplaceType,null===
(Hb=P.AssetMarketplace)||void 0===Hb?void 0:Hb.SolutionId,null,null,P.PrimaryMarketplace.MarketplaceRef):(Hb=P.PrimaryMarketplace.MarketplaceType,Hb===OSF.StoreType.InMemory?P.OwnerAddinSolutionId&&P.AssetMarketplace&&(Hb=P.AssetMarketplace.MarketplaceType):Hb===OSF.StoreType.WopiCatalog&&(Hb=OSF.StoreType.OMEX),Ta=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta,Hb,null===(lc=P.AssetMarketplace)||void 0===lc?void 0:lc.SolutionId,null,null,P.PrimaryMarketplace.MarketplaceRef))),n.ULS.sendTraceTag(537163224,
344,50,`DDA method Id: ${xc.DispatchId}, AppID: ${Ta}`))):this.ye.rf(kf.a.yMe,Ta)}cNh(P,Ta){P.DdaGetBindingData.CoerceType=xf.e4b(P.DdaGetBindingData.CoerceType);P.DdaGetBindingData.FilterType=xf.zWe(P.DdaGetBindingData.FilterType);P.DdaGetBindingData.ValueFormat=xf.Ujg(P.DdaGetBindingData.ValueFormat);if(this.Pjc(P.DdaGetBindingData.CoerceType,Ta)){if(P.DdaGetBindingData){const Hb=P.DdaGetBindingData;0===Hb.FilterType&&(Hb.FilterType=2);Hb.StartCol|=0;Hb.StartRow|=0;Hb.ColCount=void 0===Hb.ColCount?
-1:Hb.ColCount;Hb.RowCount=void 0===Hb.RowCount?-1:Hb.RowCount}this.oA.ddaGetBindingData(P.DdaMethod.ControlId,P.DdaGetBindingData.BindingId,P.DdaGetBindingData.CoerceType,P.DdaGetBindingData.ValueFormat,P.DdaGetBindingData.FilterType,P.DdaGetBindingData.StartRow,P.DdaGetBindingData.StartCol,P.DdaGetBindingData.RowCount,P.DdaGetBindingData.ColCount,Hb=>{if(Kf.a(Hb)||!Hb.Result)this.ye.JH(Hb,Ta);else{const lc=this.ye.kQ();lc.Data=xf.Mxe(Hb.Result);Ta(lc)}},Ta)}}$sj(P,Ta){P.DdaSetBindingData.CoerceType=
xf.e4b(P.DdaSetBindingData.CoerceType);if(this.Pjc(P.DdaSetBindingData.CoerceType,Ta)){var Hb=xf.p_c(P.DdaSetBindingData.CoerceType,P.DdaSetBindingData.Data);xf.Pgc(Hb)?this.ye.rf(kf.a.MCc,Ta):(1===Hb.CoerceType&&(Hb.CellFormat||(Hb.CellFormat=P.DdaSetBindingData.CellFormat),Hb.TableOptions||(Hb.TableOptions=P.DdaSetBindingData.TableOptions)),P.DdaSetBindingData&&(P.DdaSetBindingData.StartCol|=0,P.DdaSetBindingData.StartRow|=0),this.oA.ddaSetBindingData(P.DdaMethod.ControlId,P.DdaSetBindingData.BindingId,
P.DdaSetBindingData.StartRow,P.DdaSetBindingData.StartCol,Hb,lc=>{Kf.a(lc)?this.ye.JH(lc,Ta):this.ye.xv(Ta)},Ta))}}$_h(P,Ta){P.DdaGetBindingData.CoerceType=xf.e4b(P.DdaGetBindingData.CoerceType);P.DdaGetBindingData.ValueFormat=xf.Ujg(P.DdaGetBindingData.ValueFormat);P.DdaGetBindingData.FilterType=xf.zWe(P.DdaGetBindingData.FilterType);if(this.Pjc(P.DdaGetBindingData.CoerceType,Ta)){var Hb=this.lfd(P.DdaMethod.ControlId);Hb?this.oA.ddaGetSelectedData(P.DdaMethod.ControlId,P.DdaGetBindingData.CoerceType,
P.DdaGetBindingData.ValueFormat,P.DdaGetBindingData.FilterType,Hb,lc=>{if(Kf.a(lc))this.ye.JH(lc,Ta);else{const xc=this.ye.kQ();xc.Data=xf.Mxe(lc.Result);Ta(xc)}},Ta):this.ye.rf(kf.a.d6e,Ta)}}oRh(P,Ta){const Hb=P[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],lc=P[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],xc=P.DdaMethod.ControlId,cd=hg.getInstance(this.$);if(0>=lc)n.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.ye.rf(kf.a.ghi,
Ta);else if(lc>hg.cDi)n.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.ye.rf(kf.a.Z0e,Ta);else{var id=null;switch(Hb){case 1:id="Compressed";break;case 0:id="Text";break;case 2:id="Pdf";break;default:n.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Hb} is not supported.`);this.ye.rf(kf.a.nWe,Ta);return}if("Text"===id)n.ULS.sendTraceTag(537163218,344,15,`Requested file type ${id} is not supported.`),this.ye.rf(kf.a.nWe,Ta);else{z.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?
(P=new Sys.StringBuilder,P.append(Fg.a(this.$,id)),"Pdf"===id&&vh.a.Zk(P,pf.a.xOf,"WholeWorkbook"),P=P.toString()):P=Fg.a(this.$,id);var od=null,Fd=new XMLHttpRequest;Fd.onreadystatechange=()=>{if(4===Fd.readyState)if(200===Fd.status){var Rd=Fd.response;if(Rd){od=new Uint8Array(Rd);Rd=this.ye.kQ();var Re=od.length,We=hg.qHi(),lf={},rg=0;for(let fg=0;fg<Re;fg+=lc){const $f=[],bg=fg+lc<Re?fg+lc:Re;for(let jg=0,Pg=fg;Pg<bg;jg++,Pg++)$f[jg]=od[Pg];lf[(rg++).toString()]=$f}lf=new Ei(We,Re,lc,lf);lf=cd.mGg(xc,
lf);lf!==kf.a.success?this.ye.rf(lf,Ta):(Rd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=We,Rd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Re,n.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${id}, the file size is ${Re}`),Ta(Rd))}else n.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${id}.`),this.ye.rf(kf.a.internalError,Ta)}else 500===Fd.status?this.ye.rf(kf.a.LYe(parseInt(Fd.statusText,
10)),Ta):(n.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${id}.`),this.ye.rf(kf.a.YGi,Ta))};Fd.open("GET",P,!0);Fd.responseType="arraybuffer";Fd.setRequestHeader("If-Modified-Since","0");Fd.send(null)}}}pRh(P,Ta){var Hb=P[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],lc=P[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];P=P.DdaMethod.ControlId;(Hb=hg.getInstance(this.$).rRh(P,Hb))?(Hb=Hb.YGj,0>lc||lc>=Object.keys(Hb).length?this.ye.rf(kf.a.Sbi,
Ta):(lc=Hb[lc.toString()],Hb=this.ye.kQ(),Hb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=lc,Hb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=lc.length,Ta(Hb))):this.ye.rf(kf.a.internalError,Ta)}Wcj(P,Ta){var Hb=P[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];P=P.DdaMethod.ControlId;Hb=hg.getInstance(this.$).Vcj(P,Hb);Hb===kf.a.success?this.ye.xv(Ta):this.ye.rf(Hb,Ta)}mxj(P,Ta){P.DdaSetBindingData.CoerceType=xf.e4b(P.DdaSetBindingData.CoerceType);if(this.Pjc(P.DdaSetBindingData.CoerceType,
Ta)){var Hb=this.lfd(P.DdaMethod.ControlId);if(Hb){var lc=xf.p_c(P.DdaSetBindingData.CoerceType,P.DdaSetBindingData.Data),xc=yg.h(this.$).ha;1===lc.CoerceType&&(!lc.Data&&xc.ra.Q5&&(lc.Headers||(lc.Headers=[]),lc.Headers.length||lc.Headers.push([]),lc.Headers[0].length||lc.Headers[0].push("")),xf.Pgc(lc)||(lc.CellFormat||(lc.CellFormat=P.DdaSetBindingData.CellFormat),lc.TableOptions||(lc.TableOptions=P.DdaSetBindingData.TableOptions)));if(xf.Pgc(lc))this.ye.rf(kf.a.MCc,Ta);else{var cd=xc.ra.$c.clone(),
id=xc.ra.activeCell.clone();this.oA.ddaSetSelectedData(P.DdaMethod.ControlId,Hb,lc,od=>{var Fd;if(Kf.a(od))this.ye.JH(od,Ta);else{od=cd.clone();const Rd=lc.Headers?lc.Headers[0].length:lc.Data[0].length;1!==lc.CoerceType||lc.Data?1===lc.CoerceType&&(null===(Fd=lc.TableOptions)||void 0===Fd?0:Fd.length)&&0==lc.TableOptions[0]?(od.top+=1,od.bottom=od.top+lc.Data.length-1):od.bottom=od.top+lc.Data.length-(1===lc.CoerceType?0:1):od.bottom=od.top+1;od.right=od.left+Rd-1;Fd=od.contains(id)?id:od.topLeft;
xc.updateSelection(od,Fd,0);this.ye.xv(Ta)}},Ta)}}else this.ye.rf(kf.a.mAe,Ta)}}addBinding(P,Ta,Hb,lc){Ta?this.oA.ddaAddBinding(P.DdaMethod.ControlId,P.DdaBindingsMethod.BindingId,P.DdaBindingsMethod.BindingType,Ta,Hb,xc=>{if(Kf.a(xc))this.ye.JH(xc,lc);else{const cd=this.ye.kQ();cd.Bindings=Array(1);cd.Bindings[0]=this.je.L1b(xc.Result);lc(cd)}},lc):this.ye.rf(kf.a.sqj,lc)}bNh(P,Ta){this.oA.ddaGetBinding(P.DdaMethod.ControlId,P.DdaBindingsMethod.BindingId,Hb=>{if(Kf.a(Hb)||!Hb.Result)this.ye.JH(Hb,
Ta);else{const lc=this.ye.kQ();lc.Bindings=Array(1);lc.Bindings[0]=this.je.L1b(Hb.Result);Ta(lc)}},Ta)}oSh(P){const Ta=this.ye.kQ(),Hb={};Hb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ta[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Hb;P(Ta)}Ucj(P,Ta){this.oA.ddaReleaseBinding(P.DdaMethod.ControlId,P.DdaBindingsMethod.BindingId,Hb=>{Kf.a(Hb)?this.ye.JH(Hb,Ta):this.ye.xv(Ta)},Ta)}bMh(P,Ta){this.oA.ddaGetAllBindings(P.DdaMethod.ControlId,Hb=>
{if(Kf.a(Hb))this.ye.JH(Hb,Ta);else{const lc=this.ye.kQ();if(Hb.Result){Hb=Hb.Result;lc.Bindings=Array(Hb.length);for(let xc=0;xc<Hb.length;xc++)lc.Bindings[xc]=this.je.L1b(Hb[xc])}else lc.Bindings=null;Ta(lc)}},Ta)}Gvd(P,Ta){this.oA.ddaLoadSettings(P.DdaMethod.ControlId,Hb=>{if(Kf.a(Hb))this.ye.JH(Hb,Ta);else{const lc=this.ye.kQ();lc.Properties=Hb.Result;Ta(lc)}},Ta)}saveSettings(P,Ta){const Hb={Settings:[]};for(let lc=0;lc<P.DdaSettingsMethod.Properties.length;lc++){const xc={};xc.Name=P.DdaSettingsMethod.Properties[lc][0];
xc.Value=P.DdaSettingsMethod.Properties[lc][1];Hb.Settings[lc]=xc}this.oA.ddaSaveSettings(P.DdaMethod.ControlId,Hb,P.DdaSettingsMethod.OverwriteIfStale,lc=>{Kf.a(lc)?this.ye.JH(lc,Ta):this.ye.xv(Ta)},Ta)}qpe(P,Ta){const Hb=xf.p_c(1,P.DdaAddRowsColumns.Data);xf.Pgc(Hb)?this.ye.rf(kf.a.MCc,Ta):this.oA.ddaAddRowsColumns(P.DdaMethod.ControlId,P.DdaAddRowsColumns.BindingId,P.DdaAddRowsColumns.IsRow,Hb,lc=>{Kf.a(lc)?this.ye.JH(lc,Ta):this.ye.xv(Ta)},Ta)}wih(P,Ta){this.oA.ddaDeleteAllDataValues(P.DdaMethod.ControlId,
P.DdaBindingsMethod.BindingId,Hb=>{Kf.a(Hb)?this.ye.JH(Hb,Ta):this.ye.xv(Ta)},Ta)}c2g(P,Ta){this.oA.ddaClearBindingFormats(P.DdaMethod.ControlId,P.DdaClearBindingFormats.BindingId,Hb=>{Kf.a(Hb)?this.ye.JH(Hb,Ta):this.ye.xv(Ta)},Ta)}L1f(P,Ta){const Hb={},lc=P.DdaSetBindingFormats.IsSetFormats;lc?Hb.CellFormat=P.DdaSetBindingFormats.CellFormat:Hb.TableOptions=P.DdaSetBindingFormats.TableOptions;this.oA.ddaSetBindingFormats(P.DdaMethod.ControlId,P.DdaSetBindingFormats.BindingId,Hb,lc,xc=>{Kf.a(xc)?this.ye.JH(xc,
Ta):this.ye.xv(Ta)},Ta)}executeRichApiRequest(P,Ta){var Hb;const lc=P.ArrayData,xc={},cd=yg.h(this.$).ha;if(lc){if("WacPartition"===lc[0]){this.GBh(P,Ta);return}const We=Object(N.a)(Cd.DdaFacade,Af.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===lc[0]){var id=We.zn(P.DdaMethod.ControlId);id&&(id.Fic=!0,id.RNf())}xc.HttpMethod=lc[1];xc.PathAndQuery=lc[2];xc.RequestHeaders=xf.w2e(lc[3]);xc.RequestBody=lc[4];xc.AppPermission=lc[5];id=lc[6];xc.RequestFlags=id;var od=0;if(Gh.i(this.$.oa))switch(cd.Oe){case 1:od=
2;break;case 2:od=3;break;case 128:od=4;break;default:od=1}var Fd=null;cd.Sa.bB&&(Fd=cd.Sa.bB.nj);xc.SheetMultiRange=Eh.r(cd.ra.selectedRanges,this.$);xc.ActiveCell=Eh.v(cd.ra.activeCell,this.$);xc.ActiveChartId=Fd;xc.SelectionState=od;od=this.je.FZ(P.DdaMethod.ControlId);xc.InstanceId=od?od.InstanceId:"";if(od&&od.PrimaryMarketplace){let lf;if(z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1))if(od.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)lf=
od.PrimaryMarketplace.SolutionId,Fd=od.PrimaryMarketplace.MarketplaceType;else{if(!od.OwnerAddinSolutionId){n.ULS.sendTraceTag(512325018,344,15,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.ye.rf(kf.a.EMa,Ta);return}if(!od.OwnerAddinStoreType){n.ULS.sendTraceTag(512325017,344,15,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.ye.rf(kf.a.EMa,Ta);return}lf=od.OwnerAddinSolutionId;Fd=od.OwnerAddinStoreType}else if(lf=Cd.DdaFacade.getSolutionId(od,this.$),
Fd=od.PrimaryMarketplace.MarketplaceType,Fd===OSF.StoreType.InMemory){if(!od.OwnerAddinSolutionId){this.ye.rf(kf.a.EMa,Ta);return}if(od.AssetMarketplace)Fd=od.AssetMarketplace.MarketplaceType;else{this.ye.rf(kf.a.EMa,Ta);return}}else Fd===OSF.StoreType.WopiCatalog&&(Fd=OSF.StoreType.OMEX);let rg=Telemetry.PrivacyRules.GetPrivacyCompliantId(lf,Fd,null===(Hb=od.AssetMarketplace)||void 0===Hb?void 0:Hb.SolutionId,null,null,od.PrimaryMarketplace.MarketplaceRef);xc.CompliantSolutionId=rg;xc.SolutionId=
lf;xc.MarketplaceType=Fd;xc.SolutionVersion=od.PrimaryMarketplace.SolutionVersion;xc.StoreLocation=od.PrimaryMarketplace.MarketplaceRef}else xc.SolutionId=xc.MarketplaceType="",xc.CompliantSolutionId="";xc.IsEventsEnabled=void 0===We||null===We||We.jj.X0b(xc.InstanceId);xc.RequestGuid=Tg.a.create().toString();Hb=xc.RequestBody.length;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Hb>this.$.va.ExcelRichApiMaxAllowedRequestPayloadSize){this.ye.rf(kf.a.Njj,Ta);n.ULS.sendTraceTag(537163213,
0,50,`Request payload size:${Hb} exceeded the limit`);return}z.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&id&4096&&(Hb=new mg(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Hb,hf,lc),xc.RequestBody=lc[4])}const Rd=xf.H5e(xc.RequestHeaders);xf.yFd++;const Re=ij.a.Qa.zb;z.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&xc&&xc.RequestBody&&n.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${xc.RequestBody.length}`);
this.oA.executeRichApiRequest(xc,We=>{var lf;this.S0f(Re,!0,We.ServerCorrelationId);let rg=null,fg=null;var $f=We.ServerCorrelationId;if(null===(lf=null===We||void 0===We?void 0:We.Errors)||void 0===lf?0:lf[0])rg=We.Errors[0].MessageIdName,fg=We.Errors[0].Description,z.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&sj.a(this.$).hd.sM(We.Errors[0].MessageId);if(Kf.a(We)||!We.Result)this.r9a($f,Rd,"Server error",rg,fg),this.ye.JH(We,Ta);else{let jg=null;if(z.EwaSettings.ma(256))if((lf=
We.Result)&&lf.length){for(let Qg=0;Qg<lf.length;Qg++)if(lf[Qg].RequestGuid===xc.RequestGuid){jg=lf[Qg];break}jg||this.ye.JH(We,Ta)}else jg=We.Result;else jg=We.Result;if(!rg&&jg&&jg.ResponseBody&&jg.ResponseBody[0])if(We=jg.ResponseBody[0],We.startsWith('{"Error":')){1<jg.ResponseBody.length&&(We=We.substring(0,We.indexOf("}")+1),We+="}");try{var bg=y.a.li(We);bg.Error&&this.r9a($f,Rd,"Pipeline error",bg.Error.Code,bg.Error.Message)}catch(Qg){this.r9a($f,Rd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.r9a($f,
Rd);else this.r9a($f,Rd,"Server error",rg,fg);const Pg=($f=jg.SheetMultiRange)?$f.SheetName:null;bg=jg.ActiveChartId;const Ng=jg.SelectionState;We=5===Ng&&!!$f||6===Ng||7===Ng||8===Ng;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.rb.uy&&We)this.ye.rf(kf.a.aFc,Ta),n.ULS.sendTraceTag(537163211,0,50,`${Ng.toString()} is not allowed`);else if(5===Ng&&$f){if(this.$.xa&&Pg)if(this.$.xa.Rk(Pg))this.jVc(Pg);else{let Qg=null;Qg=()=>{this.$.xa.Rk(Pg)&&
(n.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.jVc(Pg),this.$.xa.PJb(Qg))};this.$.xa.mob(Qg);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Ih=null;Ih=()=>{this.$.xa.Rk(Pg)&&(this.jVc(Pg),this.$.xa.rna(Ih))};this.$.xa.eha(Ih)}}}else if(6===Ng||7===Ng||8===Ng||9===Ng){if($f){const Qg=Eh.g($f.Ranges);if(Pg&&Eh.cb(Qg,!0))if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&
!this.$.xa.Rk(Pg)){let Ih=null;Ih=()=>{this.jig(cd,Qg,Pg,Ng);this.$.xa.rna(Ih)};this.$.xa.eha(Ih)}else this.jig(cd,Qg,Pg,Ng)}7===Ng?(bg="38.{"+tj.e(bg)+"}",uh.a(this.$).Lna(0,bg,!0)):8===Ng&&uh.a(this.$).Lna(2,bg,!0);9===Ng&&(this.$.va.ApiCallToSetPageLayout=!0)}jg.PostProcessActions?($f=y.a.li(jg.PostProcessActions),this.k3i($f).then(()=>{this.ydb(jg,Ta);this.icd(P.DdaMethod.ControlId,xc);return Promise.resolve(null)},Qg=>{this.ydb(jg,Ta,Qg);return Promise.reject(Qg)})):this.ydb(jg,Ta)}},We=>{this.S0f(Re,
!1,null);this.r9a(null,Rd,"Web service error");Ta(We)})}icd(P,Ta){const Hb=Object(N.a)(Cd.DdaFacade,Af.a(this.$));(null===Hb||void 0===Hb?0:Hb.iOd)&&Hb.zn(P)&&xf.cBj(Ta.RequestHeaders)&&(n.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${P}; SolutionId: ${Ta.SolutionId}.`),Hb.iOd.Iqh(P))}GBh(P,Ta){var Hb=this.je.FZ(P.DdaMethod.ControlId);const lc=Cd.DdaFacade.getSolutionId(Hb,this.$);var xc=null;xc=Cd.DdaFacade.Cva(Hb,this.$);
xc=new Zf(xc,this.$);xc=new hj(lc,P.DdaMethod.ControlId,this.je,this.$,xc);const cd={ResponseHeaders:[]};cd.ResponseBody=Array(1);Hb=xf.w2e(P.ArrayData[3]);const id=xf.H5e(Hb);Hb=new wf(this.$.va.CreateWorkbookMaxAllowedBase64Size,this.Xvf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(xc,Pe,Hb,P.ArrayData).then(od=>{if(!od)return this.wwd(!1,"The rich api executor call failed",id),n.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),cd.ResponseStatusCode=500,this.ydb(cd,
Ta),null;this.wwd(!0,"The rich api executor call succeeded",id);cd.ResponseStatusCode=od[0];cd.ResponseBody[0]=od[2];this.ydb(cd,Ta);return null},od=>{cd.ResponseStatusCode=400;cd.ResponseBody[0]=od.toString();this.wwd(!1,"The rich api executor call failed",id);n.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${lc}`);this.ydb(cd,Ta);return null})}S0f(P,Ta,Hb){xf.yFd--;P=mj.a(ij.a.Qa,P);n.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${P}, requests pending:${xf.yFd}, request result:${Ta?
"success":"false"}, server correlationid: ${Hb}.`)}ydb(P,Ta,Hb=null){const lc=Array(3);lc[0]=P.ResponseStatusCode;lc[1]=xf.p1h(P.ResponseHeaders);const xc=[];var cd=!1;if(Hb&&P.ResponseBody){const id=y.a.li(P.ResponseBody.join(""));id.Error||(cd={},cd.Error=Hb,cd.TraceIds=id.TraceIds,cd.ProcessedResults={},cd.ProcessedResults.Results=id.Results,xc[0]=y.a.hc(cd),cd=!0)}lc[2]=cd?xc:P.ResponseBody;P=this.ye.kQ();P.Data=lc;Ta(P)}Ezd(P,Ta){(new Nf(this.$,this.ye,this.oA)).Ezd(P,Ta)}DEi(P,Ta){n.ULS.sendTraceTag(537163206,
0,50,"MessageParent API called!");const Hb=P[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],lc=P[be.a.hXc],xc=P[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];P=this.$.da.za(232).p2a.EEi(P.DdaMethod.ControlId,Hb,lc,xc);P===kf.a.success?this.ye.xv(Ta):(n.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.ye.rf(P,Ta))}zEi(P,Ta){n.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Hb=P[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],lc=P[be.a.hXc],xc=P[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];
this.$.da.za(232).p2a.krj(P.DdaMethod.ControlId,Hb,lc,xc);this.ye.xv(Ta)}getAccessToken(P,Ta){n.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Hb=(xc,cd)=>{var id;if(xc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)xc=this.ye.kQ(),xc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=cd.accessToken,Ta(xc);else{cd=this.je.FZ(P.DdaMethod.ControlId);let od=null!==cd.OwnerAddinStoreType?cd.OwnerAddinStoreType:cd.PrimaryMarketplace.MarketplaceType;n.ULS.sendTraceTag(537163202,
0,10,`${({["errorCode"]:xc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Cd.DdaFacade.getSolutionId(cd,this.$),od,null===(id=cd.AssetMarketplace)||void 0===id?void 0:id.SolutionId,null,null,cd.PrimaryMarketplace.MarketplaceRef),["storeType"]:od})}.`);this.ye.rf(xc,Ta)}},lc=!z.EwaSettings.ma(23);Vf.TaskExtensions.Aa(ug.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),xc=>{const cd=this.je.Xh,id=Yc.getInstance();Wb.AppsForOfficeSingleSignOnManager.getInstance(cd,xc.result,
id).getAccessToken(P.DdaMethod.ControlId,lc,P,Hb)},this.$.la)}getAuthContext(P,Ta){Vf.TaskExtensions.Aa(ug.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),()=>{var Hb=this.je.Xh.getOsfControl(P.DdaMethod.ControlId);if(Hb.isFirstParty()){Hb=Hb.getManifest();var lc=Hb.getMarketplaceID(),xc=Hb.getWebApplicationId(),cd=Hb.getWebApplicationMsaId();Hc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(lc).then(id=>{const od=this.ye.kQ(),Fd={};Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=
xc;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=cd||xc;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=id.upn;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=id.userId;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=id.authority;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Kd.a.LMh(id.authorityType);Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=id.isAnonymous;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
id.tenantId;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=id.supportsAuthToken;od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Fd;Ta(od)},id=>{const od=this.ye.kQ(),Fd={},Rd=new Kd.a;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=xc;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=cd||xc;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Rd.upn;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Rd.userId;
Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Rd.authority;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Rd.authorityType;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Rd.isAnonymous;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Rd.tenantId;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=id;Fd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Rd.supportsAuthToken;od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Fd;od.Error=1;Ta(od)})}},this.$.la)}lki(P){const Ta=yg.h(this.$).ha;return 16===Ta.Oe&&!!Ta.Sa.$b&&!!Ta.Sa.$b.floatingObject&&Fh.a.equals(Ta.Sa.$b.floatingObject.id,P,!0)}lfd(P){const Ta=yg.h(this.$).ha;return Ta.ra.Og?1===Ta.Oe||this.lki(P)?Ta.yia:null:null}Pjc(P,Ta){return 1!==P&&2!==P&&3!==P?(this.ye.rf(kf.a.xDe,Ta),!1):!0}wwd(P,Ta,Hb){const lc={};lc.a=this.$.va.UserSessionId;lc.b=P;lc.c=Ta;lc.d=null;lc.e=Hb;Uh.b().Qe(37,lc)}r9a(P,Ta,Hb=null,lc=null,xc=null){const cd={};P&&(cd.ServerCorrelationId=
P);void 0!==Ta&&null!==Ta&&(cd.Source=Ta);Hb&&(cd.ErrorType=Hb);lc&&(cd.MessageId=lc);xc&&(cd.StatusDescription=xc);z.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&lc&&"ExternalDataRefreshFailed"===lc&&(cd.StatusDescription="");n.ULS.sendTraceTag(50688452,0,50,y.a.hc(cd))}k3i(P){let Ta=new Promise(Hb=>{Hb(null)});for(let Hb=0;Hb<P.length;Hb++)Ta=this.j3i(Ta,P[Hb]);return Ta}j3i(P,Ta){if(!Ta)return n.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),P.then(()=>Promise.reject(xf.l4a(dg.generalException,
Td.a.instance.ga(1756),null)));switch(Ta.actionType){case 1:case 2:P=P.then(()=>{const Hb=Object(N.a)(Cd.DdaFacade,Af.a(this.$));if(Hb.zn(Ta.controlId))switch(Hb.jj.p6h(Ta),Ta.messageType){case 14:case 100:Hb.hOd.r1b(Ta);break;case 11:case 12:Hb.Hmj.Dpb(Ta);break;case 51:case 52:Hb.Fmj.Dpb(Ta);break;case 2101:case 2102:Hb.Gmj.Dpb(Ta);break;case 2E3:Hb.Imj.r1b(Ta);break;case 2201:this.$.z5&&Hb.iOd.wRg(Ta);break;case 2203:Hb.Jmj.xRg(Ta);break;case 2700:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
Hb.gOd.r1b(Ta)}else n.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Ta.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:P=P.then(()=>{this.a6h(Ta);return Promise.resolve(null)});break;case 15:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(P=P.then(()=>{this.H7h(Ta);return Promise.resolve(null)}));break;case 4:P=P.then(()=>{if(z.EwaSettings.ma(104)){var Hb=yg.h(this.$).ha.ra.activeCell;Hb.top!==Ta.row+1&&Hb.left!==Ta.column+1&&(Hb=Eh.v(Eg.Range.Qc(Ta.row+
1,Ta.column+1),this.$),yg.h(this.$).Bg(Hb,null,null,null,3,"DdaMethodHandler.ShowCard"));gi.a(this.$,243,242,0,lc=>{lc.Beb(Ta.row+1,Ta.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:P=P.then(()=>{Object(N.a)(Cd.DdaFacade,Af.a(this.$)).jj.xOe(Ta.controlId,Ta.isEnableEvents);return Promise.resolve(null)});break;case 5:P=P.then(()=>this.Afh(Ta));break;case 6:P=P.then(()=>this.pZi(Ta));break;case 8:P=P.then(()=>{z.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&
Object(N.a)(Cd.DdaFacade,Af.a(this.$)).b2g();const Hb=new qj.a(rj.a.Vj,5,null);pj.a(this.$).Js(Hb);return Promise.resolve(null)});break;case 9:P=P.then(()=>this.dtj(Ta));break;case 10:P=P.then(()=>this.b2j(Ta));break;case 11:P=P.then(()=>this.a2j());break;case 12:P=P.then(()=>this.Y1j());break;case 13:P=P.then(()=>this.Z1j(Ta));break;case 14:P=P.then(()=>this.$1j(Ta));break;case 16:P=P.then(()=>Promise.resolve(Ta));break;case 17:P=P.then(()=>this.rpj(Ta,Object(N.a)(Cd.DdaFacade,Af.a(this.$))));break;
case 18:yg.h(this.$).focus();break;case 19:this.P8e(Ta.entryType,!1,Ta.options);break;case 20:this.P8e(Ta.entryType,!0,Ta.options);break;default:P=P.then(()=>Promise.reject(xf.l4a(dg.XOg,Td.a.instance.ga(1757),null)))}return P}H7h(P){var Ta=Object(N.a)(Cd.DdaFacade,Af.a(this.$)).zn(P.controlId);if(Ta&&!(0===P.operationType^!Ta.Uda)){yg.h(this.$).njc=!0;switch(P.operationType){case 0:var Hb=new oj.a(document.createElement("input"));Hb.text=P.range;Ta.Yei(yg.h(this.$).Hf.Wdh(Hb,new lj.a(this.$)));Ta.Uda.startEdit(!0);
break;case 1:Ta.GTf();this.rangePicker=null;break;case 2:Ta.Uda.zig(P.range);break;case 3:Ta.Uda.zig(P.startingRange);Ta=P.expandSelection;Hb=P.getNextDataRegionCell;let lc=0;switch(P.keyboardDirectionValue){case 2:lc=38;P=Ta&&Hb?105288353:Ta?-31900117:Hb?542791952:137938150;break;case 3:lc=40;P=Ta&&Hb?-1297307319:Ta?-1603798598:Hb?1713663844:-798660877;break;case 0:lc=37;P=Ta&&Hb?-403586027:Ta?2039316657:Hb?-2012742350:-1470715894;break;case 1:lc=39;P=Ta&&Hb?784916030:Ta?589730764:Hb?1324884057:
-1231471547;break;default:P=1461300262}Ta=this.N5b("keydown",lc,Ta,Hb);yg.h(this.$).TKb(Ta,new wg.a(P,1,0,8,null))}yg.h(this.$).njc=!1}}N5b(P,Ta,Hb,lc){const xc=document.createEvent("KeyboardEvent");if(Qc.a.RF)xc.initKeyboardEvent(P,!1,!1,window.self,"A",0,lc,!1,Hb,!1);else{let cd="";Hb&&(cd+="Shift");lc&&(cd+=0<cd.length?" Control":"Control");xc.initKeyboardEvent(P,!1,!1,window.self,"A",0,cd,!1,"en-US")}P=new Sys.UI.DomEvent(xc);P.keyCode=Ta;return P}a6h(P){switch(P.operationType){case 1:Vf.TaskExtensions.Aa(ug.GetServiceTaskFactory.create(this.$.da,
153,this.$.la,1),Ta=>{Ta.result.cNd()},this.$.la,3);break;case 2:if(P=Object(N.a)(Cd.DdaFacade,Af.a(this.$)).zn(P.controlId))P.Fic=!0,P.RNf()}}Afh(P){const Ta=P.fileBase64;return Ta&&Ta.length>this.$.va.CreateWorkbookMaxAllowedBase64Size?Promise.reject(xf.l4a(dg.invalidArgument,Td.a.instance.ga(1760),"Application.CreateWorkbook")):(new Promise((Hb,lc)=>{const xc=new Zd.StandardDialog;xc.Rb=4;xc.Zl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,cd=>{2!==
cd&&0!==cd||lc(xf.l4a(dg.AEd,Td.a.instance.ga(1759),"Application.CreateWorkbook"));cd=new pe("blank","agave",Ta?"streamBase64":"streamEmpty",Ta);this.Xvf.create(Hb,lc,cd).G1a()})})).then(Hb=>{this.w$b.set(P.fakeFileId,Hb);return Promise.resolve(null)},Hb=>Hb?Promise.reject(Hb):Promise.reject(xf.l4a(dg.generalException,Td.a.instance.ga(1756),"Application.CreateWorkbook")))}pZi(P){return new Promise((Ta,Hb)=>{if(this.w$b.has(P.fakeFileId)){const lc=this.w$b.get(P.fakeFileId);Hb=new Zd.StandardDialog;
Hb.Rb=4;Hb.Zl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,xc=>{1===xc&&Zh.HelperMethods.lf(lc,void 0,void 0,"DdaMethodHandler.fileUrl");Ta(null)})}else Hb(xf.l4a(dg.generalException,Td.a.instance.ga(1756),"Document.Open"))})}dtj(P){return new Promise(Ta=>{Object(N.a)(Cd.DdaFacade,Af.a(this.$)).wYf=P.runtimeCalculationMode;const Hb=this.$.da.za(268);Hb&&Hb.GAd(3===P.runtimeCalculationMode);Ta(null)})}b2j(P){Vg.a.YBb(this.$)&&this.$.da.za(331).zdb(0,
P.urlStr,!0,!0,null);return Promise.resolve(null)}a2j(){Vg.a.YBb(this.$)&&this.$.da.za(331).zdb(1,null,!0,!0,null);return Promise.resolve(null)}Y1j(){Vg.a.YBb(this.$)&&this.$.da.za(331).uOe();return Promise.resolve(null)}Z1j(P){Vg.a.YBb(this.$)&&this.$.da.za(331).zdb(5,P.urlStr,!0,!0,null);return Promise.resolve(null)}$1j(P){if(Vg.a.YBb(this.$)){const Ta=this.$.da.za(331);for(const Hb of Ta.Daa)Hb.IsActive&&Hb.HostEditUrl&&Hb.UrlStr===P.hostEditUrlStr&&Zh.HelperMethods.lf(Hb.HostEditUrl,"_blank")}return Promise.resolve(null)}rpj(P,
Ta){const Hb=ag.a.XW;P=y.a.li(P.payload);const lc={};"eventId"in P&&"payload"in P&&(lc.eventId=P.eventId,lc.payload=P.payload);Ta.cN(2201,Hb,y.a.hc(lc));return Promise.resolve(null)}P8e(P,Ta,Hb){const lc=this.$.da.za(5);lc&&(P=this.GNh(P))&&(Ta?lc.removeEntry(P):lc.cWc(P,Hb))}GNh(P){switch(P){case 0:return 64;case 1:if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}jVc(P){P=Object(N.a)(nj.a,this.$.xa.getItemByName(P));(null===P||void 0===P?0:P.visible)&&P.activate(!0)}jig(P,
Ta,Hb,lc){var xc=P.ra.Bs;const cd=xc<Ta.length&&Ta[xc].contains(P.ra.activeCell);P=cd?P.ra.activeCell:Ta[0].topLeft;xc=cd?xc:0;yg.h(this.$).P4(Ta,xc,Hb,null,P,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===lc)}static get Zgh(){xf.fqa||(xf.fqa={},xf.fqa[Microsoft.Office.WebExtension.CoercionType.Table]=1,xf.fqa[Microsoft.Office.WebExtension.CoercionType.Text]=2,xf.fqa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,xf.fqa[Microsoft.Office.WebExtension.CoercionType.Html]=
4,xf.fqa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return xf.fqa}static get bhh(){xf.yib||(xf.yib={},xf.yib[Microsoft.Office.WebExtension.FilterType.All]=1,xf.yib[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return xf.yib}static get chh(){xf.zib||(xf.zib={},xf.zib[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,xf.zib[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return xf.zib}static w2e(P){if(!P||!P.length)return null;const Ta=Array(P.length/2);for(let Hb=
0;Hb<P.length/2;Hb++)Ta[Hb]={},Ta[Hb].Name=P[2*Hb],Ta[Hb].Value=P[2*Hb+1];return Ta}static p1h(P){if(!P||!P.length)return null;const Ta=Array(2*P.length);for(let Hb=0;Hb<P.length;Hb++)Ta[2*Hb]=P[Hb].Name,Ta[2*Hb+1]=P[Hb].Value;return Ta}static xcd(P){if(!P||!P.length)return null;const Ta=Array(P.length);for(let Hb=0,lc=P.length;Hb<lc;Hb++){const xc=P[Hb].length;if(xc){Ta[Hb]=Array(xc);for(let cd=0;cd<xc;cd++)Ta[Hb][cd]=null==P[Hb][cd]?null:P[Hb][cd].toString()}else return null}return Ta}static e4b(P){return"string"===
typeof P?Yi.a.wq(xf.Zgh,P,0):P}static zWe(P){return"string"===typeof P?Yi.a.wq(xf.bhh,P,0):P}static Ujg(P){return"string"===typeof P?Yi.a.wq(xf.chh,P,0):P}static xki(P){switch(P.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static p_c(P,Ta){const Hb={};Hb.CoerceType=P;1===Hb.CoerceType?(Hb.Data=xf.xcd(Ta.Rows),Hb.Headers=xf.xcd(Ta.Headers)):Hb.Data=xf.xcd(Ta);return Hb}static Mxe(P){return 1===P.CoerceType?{["Headers"]:P.Headers,["Rows"]:P.Data}:
P.Data}static Pgc(P){return 1===P.CoerceType?!P.Data&&!P.Headers:!P.Data}static H5e(P){let Ta="Unknown";if(!P)return Ta;for(let Hb=0;Hb<P.length;Hb++)if(P[Hb].Name.toLowerCase()===pf.a.Kmj){Ta=P[Hb].Value;break}return Ta}static cBj(P){if(!P)return!1;const Ta=pf.a.kJi.toLowerCase();for(let Hb=0;Hb<P.length;Hb++)if(P[Hb].Name.toLowerCase()===Ta)return!0;return!1}static l4a(P,Ta,Hb){const lc={};lc.Code=P;lc.Message=Ta;lc.Location=Hb;lc.ActionIndex=0;return lc}}xf.fqa=null;xf.yib=null;xf.zib=null;xf.yFd=
0;Object(d.a)(xf,"DdaMethodHandler",null,[223,2]);class Zi extends Bd.a{constructor(P){super(P)}ld(){const P=ug.GetServiceTaskFactory.create(this.$.da,106,this.la,this.Ya),Ta=ug.GetServiceTaskFactory.create(this.$.da,165,this.la,this.Ya),Hb=Gi(this.la,this.Ya),lc=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")?ug.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):lh.Task.Ta(null);
Vf.TaskExtensions.Aa(Vf.TaskExtensions.Ed([P,Ta,Hb,lc],this.la),()=>{const cd=P.result,id=Hc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Yc([new xf(this.$,cd,id,lc.result)])},this.la,3);const xc=Hc.a.instance;Vf.TaskExtensions.Aa(ug.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.Ya),()=>{xc.register(pb,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").xc().Fc(()=>new pb)},this.$.la)}static ka(P){Bd.a.Nd(82,new Zi(P))}}
Object(d.a)(Zi,"DdaCommandHandlerFactory",Bd.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.Oi("");c.a.Oi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(b.a)();
Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(e.a)();(()=>{f.a.Fa(P=>{Tb.ka(P)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(Bc.a)();Object(Wc.a)();Type.registerNamespace("CommandUI.AddInCommands");(()=>{f.a.Fa(P=>{z.EwaSettings.ma(53)&&Ch.ka(P)})})();(()=>{f.a.Fa(P=>{z.EwaSettings.ma(121)&&ph.ka(P)})})();f.a.Fa(Xc.ka);f.a.Fa(fi.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");
(()=>{f.a.Fa(P=>{Ph.ka(P);Ci.ka(P);oi.ka(P)})})();f.a.Fa(Zi.ka)},1464:function(u,E,a){u=a(0);var c=a(187),b=a(96);class e{constructor(){this.uNe=this.displayName=this.asb=this.So=this.KB=null;this.isUpgraded=!1}Fkf(d,h){return this.KB.getStoreType().toLowerCase()===d.toLowerCase()&&this.KB.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(u.a)(e,"AddinCommandsResourceItem",null,[]);a.d(E,"a",function(){return f});class f{constructor(){this.cGc=null;this.RKc=0;this.wMc=!1;this.fb=new b.a;this.$vg=
new c.a}fJg(d){this.fb.addHandler("AddinCommandsLoadingMessageChanged",d)}Eej(d){this.fb.removeHandler("AddinCommandsLoadingMessageChanged",d)}get LZa(){return this.cGc}Zdb(d){d!==this.cGc&&(this.cGc=d,this.fb.raiseEvent("AddinCommandsLoadingMessageChanged"))}Zsj(){this.RKc++;this.LZa||this.Zdb(CommonUIStrings.l_LoadingAddInsTitle)}SQd(){this.RKc--;this.Jvd()&&(this.wMc?this.LZa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Zdb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Zdb(null))}E2f(d=
!1){this.wMc=!0;this.Zdb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}OBe(){this.wMc=!1;this.Jvd()?this.Zdb(null):this.Zdb(CommonUIStrings.l_LoadingAddInsTitle)}Jvd(){return 0>=this.RKc}get E6a(){return this.$vg}ija(d,h,m=0){for(let l of this.E6a)if(l.Fkf(d,h)&&(!l.So||l.So.iLh===m))return l;return null}Xoe(d,h,m,l){const w=new e;w.KB=d;w.So=h;w.asb=m;w.displayName=l;this.E6a.add(w)}hHg(d,h,m,l){const w=new e;w.KB=d;w.So=h;w.asb=null;w.uNe=
m;w.displayName=l;this.E6a.add(w)}cdj(d,h){let m=0;for(let l of this.E6a)l.KB.getStoreType()===d&&l.KB.getSolutionId()===h?this.E6a.removeAt(m):m++}static getInstance(){f.Ma||(f.Ma=new f);return f.Ma}}f.Ma=null;Object(u.a)(f,"AddinCommandsResourceManager",null,[])},730:function(u,E,a){a.d(E,"a",function(){return b});u=a(0);var c=a(35);class b{static get BEi(){return b.kee||(b.kee={["-2002156328"]:b.xDe,["-1954750170"]:b.d6e,["317650254"]:b.R3g,["-1005263101"]:b.$gi,["1353664579"]:b.Eqj,["159671765"]:b.ahi,
["1446690022"]:b.Z0e,["1150069548"]:b.MCc,["-1409306331"]:b.mAe,["338507772"]:b.yJe,["-457159301"]:b.e_i,["-1037701970"]:b.Agh,["-1893322318"]:b.fhi,["965579896"]:b.Cgh,["93287890"]:b.Bgh,["358088857"]:b.Otj,["-1223650923"]:b.yJe,["2007306190"]:b.P_g,["1549955423"]:b.Uwe,["-1275974171"]:b.ehi,["382101082"]:b.sZi,["-898776235"]:b.iGi,["335464256"]:b.$Fi,["1677378049"]:b.dhi,["-261992848"]:b.wTj,["-980820954"]:b.Uwe,["-931375837"]:b.rZi,["929186550"]:b.goh,["-982144310"]:b.f6i,["-785741187"]:b.Ygi,
["2125217573"]:b.hhi,["299124955"]:b.Zgi,["1669853884"]:b.Zmj,["-1515932330"]:b.S3g,["314621024"]:b.HHh,["-300049690"]:b.T_g,["14766835"]:b.Qyj,["-1251992761"]:b.yMe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.pGa,["49173765"]:b.pGa,["-907155566"]:b.pGa,["-1201603824"]:b.pGa,
["1541165282"]:b.pGa,["-1347753427"]:b.pGa,["134912532"]:b.pGa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static LYe(e){return c.a.wq(b.BEi,e.toString(),b.internalError)}}b.success=0;b.xDe=1E3;b.d6e=1001;b.R3g=1002;b.$gi=1003;b.Eqj=1004;b.ahi=1005;b.Z0e=1008;b.nWe=1009;b.invalidSheetName=1014;b.MCc=2E3;b.mAe=2001;b.yJe=2002;b.e_i=2003;b.Agh=2004;b.fhi=2005;b.Cgh=2007;b.Bgh=2008;b.Otj=2009;b.P_g=2014;b.sqj=3E3;b.Uwe=3002;b.ehi=3004;b.sZi=3005;b.iGi=3006;b.$Fi=3007;b.dhi=3008;b.wTj=3009;b.rZi=
3010;b.Qyj=4002;b.EEd=5E3;b.internalError=5001;b.yMe=5002;b.EMa=5004;b.xUj=5007;b.Sbi=5008;b.invalidOrTimedOutSession=5012;b.aFc=5016;b.pGa=5102;b.Njj=5103;b.responsePayloadSizeLimitExceeded=5104;b.l_g=7001;b.F9f=7002;b.goh=8E3;b.f6i=8001;b.Ygi=8010;b.hhi=8011;b.Zgi=8012;b.Zmj=8020;b.S3g=8021;b.HHh=8022;b.T_g=8023;b.hEi=11E3;b.YGi=11001;b.ghi=11002;b.kee=null;Object(u.a)(b,"DdaErrorIds",null,[])},731:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{}c.generalException="GeneralException";
c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.NUc="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.AEd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.AUj="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.eNg="AddinIsAlreadyRequestingToken";c.qlj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.L7g=
"ControlIdNotFound";c.fmj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(u.a)(c,"ErrorCodes",null,[])},734:function(u,E,a){a.r(E);var c=a(0),b=a(7),e=a(15),f=a(1306),d=a(84),h=a(96);class m{constructor(Da,Na,sb){this._id=Da;this.Wpg=Na;this.dsg=sb;this.aff=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get dNg(){return this.Wpg}get t4g(){return this.dsg}execute(Da,
Na,sb){sb=sb||{};sb.commandMode=this.aff;Na.invokeAppCommand(this.dNg,this.t4g,sb,()=>{Da.RSi(this.id)})}}Object(c.a)(m,"AddinNativeActionBase",null,[201]);class l extends m{constructor(Da,Na){super(1,Da,Na);this.aff=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(l,"AddinTakeSnapshotAction",m,[]);class w{q9g(Da){return new m(3,Da,this.RLh().getNativeActionName(3))}RLh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(w,"AddinNativeActionManager",null,[180]);var n=
a(146);class y{invokeAppCommand(Da,Na,sb,Kb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Da,Na,sb,Kb)}static getInstance(){y.Ma||(y.Ma=new y);return y.Ma}}y.Ma=null;Object(c.a)(y,"OSFAddinCommandsRuntimeManager",null,[181]);var t=a(4),r=a(180),v=a(27);class B extends n.a{constructor(Da,Na,sb){super();this.N9=null;this.PTc="WACDialogTitleText";this.rfa="0";this.JDa="15px";this.tsg="0px";this.qfa="calc(100% - 30px)";this.ssg="100%";this.Ohe=0;this.fb=new h.a;this.Ypg=new w;this.Rb=5;this.Fe=
this.RDa=sb;this.gJc=Da;this.U7d=Na;this.wJc=!!t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}qLg(Da){this.fb.addHandler("OnDialogClosedEventKey",Da)}Lvj(){this.ZEa=null}Vz(){super.Vz();this.Wk.style.width="100%";this.Wk.style.height=this.Hec?this.qfa:this.ssg;this.Wk.style.marginTop=this.Hec?this.JDa:this.tsg;this.Wk.style.padding=this.rfa}VI(){super.VI();this.wb.style.width=String.format("{0}px",this.gJc*window.innerWidth/100);this.wb.style.height=
String.format("{0}px",this.U7d*window.innerHeight/100);this.wb.style.minWidth="0px";this.wJc&&t.AFrameworkApplication.isRtl&&100===this.gJc&&(this.wb.style.right="0px",this.wb.style.marginRight="0px");this.N9=document.getElementById(this.mi(this.PTc));this.N9.style.position="absolute";this.N9.style.whiteSpace="nowrap";this.N9.style.textOverflow="ellipsis";t.AFrameworkApplication.isRtl?(this.N9.style.right="14px",this.N9.style.left="44px"):(this.N9.style.right="44px",this.N9.style.left="14px")}Ov(Da){super.Ov(Da);
this.N9&&this.N9.setAttribute("title",Da)}get Fia(){return this.Wk}iNd(){this.wb.style.width=String.format("{0}px",this.gJc*window.innerWidth/100);this.wb.style.height=String.format("{0}px",this.U7d*window.innerHeight/100);this.wb.style.overflowY="hidden";this.wb.style.overflowX="hidden";this.wb.style.marginTop="";this.wb.style.top="";v.a.s5&&t.AFrameworkApplication.isRtl?(this.wb.style.right="",this.wb.style.marginRight=""):(this.wb.style.left="",this.wb.style.marginLeft="")}hide(){this.Ypg.q9g(this.RDa).execute(this,
y.getInstance(),{});this.Ohe=window.setTimeout(()=>{this.fb.raiseEvent("OnDialogClosedEventKey",this.RDa);r.a.prototype.hide.call(this)},500)}RSi(Da){3===Da&&(window.clearTimeout(this.Ohe),this.fb.raiseEvent("OnDialogClosedEventKey",this.RDa),super.hide())}}Object(c.a)(B,"AppsForOfficeDialog",n.a,[144,145]);class A{constructor(){this.dialog=this.Fe=null}}Object(c.a)(A,"DialogInfo",null,[]);class z{}z.url="url";z.height="height";z.width="width";z.g8c="displayInIframe";z.gfc="hideTitle";Object(c.a)(z,
"DialogSettings",null,[]);class x{constructor(){this.height=this.width=0;this.Fe=this.controlId=this.pageUrl=null;this.gfc=this.g8c=!1}}Object(c.a)(x,"DisplayDialogParams",null,[]);class D extends Sys.EventArgs{constructor(Da,Na,sb=null,Kb="",Yb=""){super();this.controlId=Da;this.messageType=Na;this.messageContent=sb;this.messageOrigin=Kb;this.targetOrigin=Yb}}Object(c.a)(D,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class J extends Sys.EventArgs{constructor(Da,Na,sb=null,Kb="",Yb=""){super();this.controlId=
Da;this.messageType=Na;this.messageContent=sb;this.messageOrigin=Kb;this.targetOrigin=Yb}}Object(c.a)(J,"OnMessageParentEventArgs",Sys.EventArgs,[]);var L=a(41),T=a(30),O=a(170),G=a(98);class C{constructor(Da){this.fb=new h.a;this.Im=Da}yLg(Da){this.fb.addHandler("OnMessageParentEventKey",Da)}xLg(Da){this.fb.addHandler("OnMessageDialogEventKey",Da)}showDialog(Da,Na,sb,Kb){if(C.C8.mb(Na))e.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{const ec=L.b(Da),Vc=ec[z.url];if(this.Im.getOsfControl(Na).checkAppDomains(Vc)){var Yb=new x;Yb.width=ec[z.width];Yb.height=ec[z.height];Yb.pageUrl=Vc;Yb.g8c=ec[z.g8c];Yb.gfc=ec[z.gfc];Yb.controlId=Na;Yb.Fe=O.a.create().toString();var vc=new A;vc.Fe=Yb.Fe;var ad=this.Im.getOsfControl(Yb.controlId).getManifest().getDefaultDisplayName(),ld=this.Im.getOsfControl(Yb.controlId).getStoreType().toLowerCase();Da=null;var md=t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);Da=(4===t.AFrameworkApplication.sa.Pa.Gj&&"hardcodedpreinstall"===ld||md&&"sdxcatalog"===ld)&&Yb.gfc?this.createAndShowAppsForOfficeDialog(Yb.width,Yb.height,Yb.Fe,!0,ad):this.createAndShowAppsForOfficeDialog(Yb.width,Yb.height,Yb.Fe,!1,ad);var Qd=this.Im.getOsfControl(Yb.controlId),ce=Qd.getManifest();md={};md.id=Yb.Fe;md.solutionId=Qd.getSolutionId();md.version=Qd.getVersion();md.storeType=ld;md.storeId=Qd.getStoreId();md.assetId=Qd.getAssetId();md.assetStoreId=Qd.getAssetStoreId();md.ownerAddinSolutionId=
Qd.getOwnerAddinSolutionId();md.ownerAddinStoreType=Qd.getOwnerAddinStoreType();md.appDomains=ce.getAppDomains();md.dialogUrl=Vc;md.osfControlType=1;md.agaveName=ad;md.div=Da.Fia;e.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(md.solutionId,md.ownerAddinStoreType||md.storeType,md.assetId,null,null,md.storeId),T.a.mw(Yb.pageUrl));this.Im.insertDialogControl(md);Da.qLg(Object(d.a)(this,this.YMi,"onDialogClosed"));vc.dialog=
Da;C.C8.ia(Yb.controlId,vc);Kb&&Kb(md);sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(ec){e.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",ec.message),sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}EEi(Da,Na,sb,Kb){t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===Kb&&(Kb=sb);try{const Yb=this.TKa(Da);Yb&&this.fb.raiseEvent("OnMessageParentEventKey",new J(Yb,OSF.DialogMessageType.DialogMessageReceived,Na,sb,Kb))}catch(Yb){return e.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Yb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}$Ha(Da,Na){if(C.C8.mb(Da))try{const sb=C.C8.na(Da);sb.dialog&&sb.dialog.hide();this.Im.purgeDialogControl(sb.Fe);
C.C8.remove(Da);Na(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(sb){e.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",sb.message),Na(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else e.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Na(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}krj(Da,Na,sb,Kb){t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===Kb&&(Kb=sb);if(C.C8.mb(Da)&&(Da=C.C8.na(Da),Da.dialog))try{this.fb.raiseEvent("OnMessageDialogEventKey",new D(Da.Fe,OSF.DialogMessageType.DialogParentMessageReceived,Na,sb,Kb))}catch(Yb){e.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Yb.message)}}TKa(Da){let Na=null;for(let sb of C.C8)if(sb.value.Fe===Da){Na=sb.key;break}return Na}YMi(Da,Na){if(Da=this.TKa(Na))this.Im.purgeDialogControl(Na),C.C8.remove(Da),this.fb.raiseEvent("OnMessageParentEventKey",
new J(Da,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(Da,Na,sb,Kb,Yb){Da=new B(Da,Na,sb);Yb=Kb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Yb);Kb&&(Da.Hec=!1,Da.It=!1);Da.initializeAndShow(Yb,null,null);Da.Lvj();return Da}static k4h(){return C.C8}static getInstance(Da){C.Ma||(C.Ma=new C(Da));return C.Ma}}C.Ma=null;C.C8=new G.a;Object(c.a)(C,"AppsForOfficeDialogManager",null,[134]);var H=a(844),I=a(1318),M=a(1395),Q=a(933),U=a(718),N=a(172),
W=a(1319),X=a(119),sa=a(82),da=a(87),S=a(639),oa=a(553),K=a(682),ea=a(83),ya=a(416),ha=a(157),La=a(187),Ia=a(38),ra=a(5),pa=a(861),ba=a(1235),fa=a(78);class Ka{constructor(){this.command=0;this.properties=null}}Object(c.a)(Ka,"DdaRequestInfo",null,[]);var aa=a(730),ja=a(76);class Va extends fa.a{constructor(Da,Na){super();this.requests=[];this.disposed=this.c3b=!1;this.jg=()=>{if(!this.disposed){this.grid.Vb.em(this.jg);this.c3b=!1;const sb=this.requests;this.requests=[];for(let Kb of sb)this.ddaFacade.yK(Kb.command,
Kb.properties)}};this.ddaFacade=Da;this.grid=Na}nih(Da,Na){this.disposed||(this.c3b||(this.grid.Vb.Rm(this.jg),this.c3b=!0),this.requests.push(Object(b.a)(new Ka,{command:Da,properties:Na})))}dispose(){if(!this.disposed){this.disposed=!0;this.c3b&&this.grid.Vb.em(this.jg);var Da=this.requests;this.requests=null;for(let Na of Da)(Da=Na.properties?Na.properties[ja.a.V3]:null)&&this.ddaFacade.rf(aa.a.EMa,Da);this.ddaFacade=this.grid=null;super.dispose()}}static w4g(Da,Na){var sb=!1;974713501===Da&&(Na=
(Da=Na?Na[ja.a.og]:null)?Da.DdaMethod:null)&&Na.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(sb=Da.ArrayData,sb=!!sb&&64===(sb[6]&64));return sb}}Object(c.a)(Va,"DdaCellEditDelayRequestHandler",fa.a,[]);var bb=a(765);class wa extends bb.a{constructor(Da,Na,sb,Kb,Yb,vc,ad){super(Da,Na,sb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Kb;this.messageContent=Yb;this.messageOrigin=vc;this.targetOrigin=ad}}Object(c.a)(wa,"DialogMessageReceivedEventArgs",
bb.a,[]);class ka extends bb.a{constructor(Da,Na,sb,Kb,Yb,vc,ad){super(Da,Na,sb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Kb;this.messageContent=Yb;this.messageOrigin=vc;this.targetOrigin=ad}}Object(c.a)(ka,"DialogParentMessageReceivedEventArgs",bb.a,[]);var ta=a(1),qa=a(21);class rb{constructor(Da){this.Xh=this.kYc=null;this.HSi=(Na,sb)=>{this.handlers.mb(sb.controlId)&&(Na=new wa(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,sb.controlId,
null,sb.messageType,sb.messageContent,sb.messageOrigin,sb.targetOrigin),this.handlers.na(sb.controlId)(Na),sb.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(sb.controlId))};this.GSi=(Na,sb)=>{this.Fmc.mb(sb.controlId)&&(Na=new ka(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,sb.controlId,null,sb.messageType,sb.messageContent,sb.messageOrigin,sb.targetOrigin),this.Fmc.na(sb.controlId)(Na))};this.handlers=new G.a;this.Fmc=new G.a;this.Lg=Da;this.p2a.yLg(this.HSi);
this.p2a.xLg(this.GSi)}get p2a(){this.kYc||(this.kYc=C.getInstance(this.contextActivationMgr));return this.kYc}get contextActivationMgr(){!this.Xh&&this.Lg&&(this.Xh=this.Lg.Xh);return this.Xh}addHandler(Da,Na,sb,Kb){if(ta.EwaSettings.ma(23))this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,sb);else{e.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Yb=vc=>{vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(Da,
Na),this.Lg.xv(sb)):(e.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Lg.rf(vc,sb))};this.handlers.mb(Da)?Yb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Da,Kb,Yb)}}$Gg(Da,Na,sb){ta.EwaSettings.ma(23)?this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,sb):(e.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.Fmc.ia(Da,Na),this.Lg.xv(sb))}removeHandler(Da,
Na){ta.EwaSettings.ma(23)?this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Na):this.handlers.mb(Da)?(e.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.p2a.$Ha(Da,sb=>{this.handlers.remove(Da);sb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Lg.xv(Na):(e.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Lg.rf(sb,Na))})):this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Na)}Ydj(Da,Na){ta.EwaSettings.ma(23)?this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Na):(e.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Fmc.remove(Da),this.Lg.xv(Na))}showDialog(Da,Na,sb){try{ta.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&qa.h(this.Lg.$).eb&&qa.h(this.Lg.$).Uo(!0),this.p2a.showDialog(Na,Da,sb,Kb=>{this.Lg.qHg(this.tXg(Kb))})}catch(Kb){e.ULS.sendTraceTag(537170496,0,10,
`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Kb.message}`),sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}tXg(Da){const Na={};Na.InstanceId=Da.id;Na.WebExtensionType=Da.osfControlType===OSF.OsfControlTarget.InContent?0:1;Na.PrimaryMarketplace={};Na.PrimaryMarketplace.SolutionId=Da.solutionId;Na.PrimaryMarketplace.SolutionVersion=Da.version;Na.PrimaryMarketplace.MarketplaceRef=Da.storeId;Na.PrimaryMarketplace.MarketplaceType=Da.storeType;ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)&&(Na.OwnerAddinSolutionId=Da.ownerAddinSolutionId,Na.OwnerAddinStoreType=Da.ownerAddinStoreType);return Na}static ka(Da){if(!Da.$.da.za(232)){const Na=new rb(Da);Da.$.da.Ga(232,Na)}}}Object(c.a)(rb,"DialogMessageReceivedEventManager",null,[765]);class Za{constructor(Da,Na){this.cB=null;this.Gfa=Da;this.xCg=Na}M_b(Da){Da&&(this.cB||(this.cB=[]),this.cB.push(Da))}uuc(Da){this.cB&&Array.remove(this.cB,Da)}get eventId(){return this.Gfa}get targetId(){return this.xCg}get h9h(){return 0<this.cB.length}aDi(Da){return this.eventId!==
Da.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Da.ddaBinding.Name:!0}H2b(Da){this.cB&&Array.forEach(this.cB,Na=>{Na(Da)})}kna(){this.cB=[]}}Object(c.a)(Za,"DdaEventRegistration",null,[]);class gb{constructor(Da){this.kF=null;this.Pwa=!1;this.Pc=()=>{this.kF.forEach(Na=>{Na.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Na.H2b(new bb.a(Na.eventId,"",null))})};this.Lg=
Da}invokeDdaMethod(Da,Na){const sb={};sb[ja.a.og]=Da;sb[ja.a.V3]=Na;this.Lg.yK(974713501,sb)}registerDdaEventAsync(Da,Na,sb,Kb,Yb){gb.tAb(Da)?(gb.npd(Da)&&this.Ild(),this.kF||(this.kF=[]),Na=this.evb(Da,sb),Na||(Na=new Za(Da,sb),this.kF.push(Na)),Na.M_b(Kb),this.Lg.xv(Yb)):this.Lg.rf(-1,Yb)}unregisterDdaEventAsync(Da,Na,sb,Kb,Yb){gb.tAb(Da)?((Da=this.evb(Da,sb))&&Da.uuc(Kb),this.Lg.xv(Yb)):this.Lg.rf(-1,Yb)}Ild(){this.Pwa||(qa.h(this.Lg.$).ha.KE(this.Pc),this.Pwa=!0)}evb(Da,Na){if(!this.kF)return null;
for(let sb=0;sb<this.kF.length;sb++){const Kb=this.kF[sb];if(Kb.eventId===Da&&Kb.targetId===Na)return Kb}return null}static tAb(Da){return Da===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static npd(Da){return Da===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(gb,"EmbeddingPage",null,[738]);var mb=a(178);class Ga extends bb.a{constructor(Da,Na,sb,Kb,Yb,vc,ad,ld){super(Da,Na,sb);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=vc-Kb.Reference.FirstColumn;
this.columnCount=ld;Da=Math.max(Yb,Kb.Reference.FirstRow);Yb=Math.min(Yb+ad-1,Kb.Reference.LastRow);Da>Yb?this.startRow=this.rowCount=void 0:(this.startRow=Da-Kb.Reference.FirstRow,this.rowCount=Yb-Da+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(Ga,"DdaBindingSelectionEventArgs",bb.a,[]);var ib=a(199),cc=a(24),ic=a(42),xb=a(50),Vb=a(417),wb=a(33),cb=a(37),lb=a(564),Y=a(109),Oa=
a(53),Wa=a(91),Ca=a(12),Ra=a(11),la=a(103);class ua{}ua.nxh="ewa-wx-disabled-div";ua.mxh="ewa-wx-container-div";ua.BRe="ewa-ptp-nov2-flex";Object(c.a)(ua,"CssClassNames",null,[]);const xa=ua.nxh,fb=ua.mxh;class Jb extends mb.a{constructor(Da,Na,sb,Kb=!1){super();this.Cdb=0;this.kF=null;this.Pwa=!1;this.ksc=null;this.DU=0;this.K6b=this.mWa=this.KIc=this.Y4d=null;this.Dbe=!1;this.OPc=this.Uda=this.l2d=null;this.Pc=()=>{this.enabled&&(this.urj(),this.ksc=ic.d(qa.h(this.$).ha.ra.selectedRanges))};this.Y8e=
Yb=>{Yb.controlId===this.Hd.InstanceId&&Array.forEach(this.kF,vc=>{vc.aDi(Yb)&&vc.H2b(Yb)})};this.byf=Yb=>{if((Yb=Object(ea.a)(327,Yb))&&!Yb.Ds())if(!this.Hd||OSF.OsfControl.isFirstPartyStoreString(this.Hd.PrimaryMarketplace.MarketplaceType)||this.$.X2){Yb.pf=this.Hd;Yb.wj=this.Lg;this.l2d=Yb;this.Xxc(Yb.VGa);const vc=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&wb.a.fd(this.$)&&Ra.HelperMethods.Gw(this.Hd)&&this.Hd.Preload&&!this.Hd.TaskpaneVisible;vc?Yb.RCd():
ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Yb.RCd(),(this.Hd.SharedRuntime&&1===this.Hd.SharedRuntime.LifeTime||this.Hd.SharedRuntimeId)&&!this.Hd.TaskpaneVisible&&Yb.wg(!1)):((this.Hd.SharedRuntime&&1===this.Hd.SharedRuntime.LifeTime||this.Hd.SharedRuntimeId)&&!this.Hd.TaskpaneVisible&&Yb.wg(!1),Yb.RCd());this.N6a||(wb.a.fd(this.$)?vc||Yb.X6():Vb.a(this.$).result.nG(Yb,!0));this.$.da.za(77).XTf(this.byf);this.r$=Object(ea.a)(364,Yb)}else e.ULS.sendTraceTag(537170464,
0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Yb,vc)=>{3===vc.control.floatingObject.type&&vc.control.floatingObject.wl.InstanceId===this.y1.WebExtensionId&&(this.r$=Object(ea.a)(364,vc.control),this.Xxc(vc.control.Jd.firstChild),la.a(this.$).muc(this.onFloatingObjectControlAdded))};this.jb=Da.$;this.Lg=Da;this.Hd=sb;this.Hd.InstanceId=sb.SrcLocationOverrideResourceId?Da.j4a(sb.InstanceId,sb.SrcLocationOverrideResourceId):sb.InstanceId;this.hi=Na;this.y1={};this.y1.WebExtensionId=
sb.InstanceId;this.EJf="osfControl_"+sb.InstanceId;this.X7c="disabled_"+sb.InstanceId;this.y1.BindingData=sb.BindingData;this.N6a=this.Lg.N6a(sb.InstanceId);this.Hgc=this.Lg.Hgc(sb.InstanceId);this.$fe=sb.WebExtensionOsfControlType;this.SMf=Kb}get controlId(){return this.Hd.InstanceId}Yei(Da){this.Uda||(this.Uda=Da)}GTf(){this.Uda&&(this.Uda.dispose(),this.Uda=null)}get controlType(){return this.Hd.WebExtensionType}get ownerAddinSolutionId(){return this.Hd.OwnerAddinSolutionId}get $(){return this.jb}get enabled(){return!this.DU}get Dy(){return this.OPc}get pU(){return this.Hd.SrcLocationOverrideResourceId?
this.Lg.j4a(this.Hd.PrimaryMarketplace.SolutionId,this.Hd.SrcLocationOverrideResourceId):this.Hd.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Hd.SrcLocationOverrideResourceId}get wl(){return this.Hd}get r$(){return this.Y4d}set r$(Da){this.Y4d=Da}get osfControlType(){return this.$fe}get Yta(){return this.KIc}set Yta(Da){this.KIc=Da}get J6b(){return this.mWa}set J6b(Da){this.mWa=Da}get focusOnIframeWhenLoaded(){return this.Hd.FocusOnIframeWhenLoaded}get Fic(){return this.Dbe}set Fic(Da){this.Dbe=
Da}$md(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Hd.PrimaryMarketplace.MarketplaceType)&&ta.EwaSettings.ma(184)){const Na=xb.GetServiceTaskFactory.Oa(this.$.da,5,4,0);cb.TaskExtensions.Aa(Na,()=>{Na.result.ng(36,null)},this.la,3);return this}if(1===this.Hd.WebExtensionType)cb.TaskExtensions.Aa(Vb.a(this.$),Na=>{Na.result.usb(this.$.da,77,5,this.byf,1)},this.la,3);else{var Da=this.GWe();const Na=la.a(this.$);Da||(Da={Type:3},Da.Id=this.y1.WebExtensionId,Da.WebExtensionData=this.Hd,Da.ContentHtml=
"<div/>",Da.Version=0,Da.AbsoluteLeft=0,Da.AbsoluteTop=0,Da.AbsoluteRight=0,Da.AbsoluteBottom=0,Da.Width=0,Da.Height=0,Da.ZOrder=0,Da.OriginDeltaX=0,Da.OriginDeltaY=0,Da=new ib.a(Da),Na.v5b(Da,null),Da=Na.Sq(Da.Mg()));Da?(this.Xxc(Da.Jd.firstChild),this.r$=Object(ea.a)(364,Da)):Na.C_b(this.onFloatingObjectControlAdded)}return this}kdf(Da){this.Xxc(Da);return this}xoc(){this.SMf||this.Lg.Xh.purgeOsfControl(this.controlId,!1);this.zfg(!0);const Da=this.GWe();Da&&la.a(this.$).deleteFloatingObject(Da);
this.Lg.jj.Hdj(this.controlId);this.Lg.jj.xOe(this.controlId,!0);this.OPc=null}cDd(Da){this.y1=Da}invokeDdaMethod(Da,Na){if(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var sb={};sb[ja.a.og]=Da;sb[ja.a.V3]=Na;this.Lg.yK(974713501,sb)}else this.Lg.rf(aa.a.EMa,Na)}abj(Da,Na,sb,Kb){if(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Jb.Nmh(Da)||void 0!==Na&&null!==Na&&void 0!==this.G3a(Na)&&null!==this.G3a(Na))if(e.ULS.sendTraceTag(36444195,
0,50,`eventId: ${Da}, targetId: ${Na}`),Jb.Jgf(Da)&&this.dai(),Jb.npd(Da)&&this.Ild(),Jb.Hgf(Da))ta.EwaSettings.ma(23)?this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Kb):this.Lg.$.da.za(232).addHandler(this.controlId,sb,Kb,Na);else if(Jb.Igf(Da))ta.EwaSettings.ma(23)?this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Kb):this.Lg.$.da.za(232).$Gg(this.controlId,sb,Kb);else{Jb.Ggf(Da)&&this.$8e(-1777565636,Kb);this.kF||(this.kF=[]);var Yb=this.evb(Da,
Na);Yb||(Yb=new Za(Da,Na),this.kF.push(Yb));Yb.kna();Yb.M_b(sb);this.Lg.xv(Kb);Da===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.mWa&&(this.K6b=sb)}else this.Lg.rf(3002,Kb);else this.Lg.rf(-1,Kb)}GTj(Da,Na,sb,Kb){Jb.Hgf(Da)?ta.EwaSettings.ma(23)?this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Kb):this.Lg.$.da.za(232).removeHandler(this.controlId,Kb):Jb.Igf(Da)?ta.EwaSettings.ma(23)?this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Kb):this.Lg.$.da.za(232).Ydj(this.controlId,
Kb):(Jb.Ggf(Da)&&this.$8e(1592314317,Kb),Na=this.evb(Da,Na),this.enabled?(Na&&(Na.uuc(sb),Na.h9h||Array.remove(this.kF,Na),this.kF.length?Jb.Jgf(Da)&&this.Afg(!1):this.zfg(!1)),this.Lg.xv(Kb)):this.Lg.rf(-1,Kb))}ka(Da){Ca.DOMElementExtensions.getElementById(Da,this.EJf)||Da.appendChild(Ca.DOMElementExtensions.uf(this.Dy))}showHide(Da){Ca.DOMElementExtensions.setVisible(this.Dy,Da)}resize(Da,Na){Ca.DOMElementExtensions.Vv(this.Dy,Da);Ca.DOMElementExtensions.gJ(this.Dy,Na)}uLe(Da){if(!this.DU&&!Ca.DOMElementExtensions.getElementById(this.Dy,
this.X7c)&&this.Dy){const Na=document.createElement("div");Na.id=this.X7c;Na.className=xa;Na.style.backgroundImage="url("+Oa.a.current.fo(103)+")";Na.style.opacity=Da?"1":"0";Na.style.backgroundRepeat="no-repeat";Na.style.backgroundPosition="center";this.Dy.insertBefore(Na,this.Dy.firstChild)}this.DU++}zph(){0<this.DU&&this.DU--;this.DU||(Ca.DOMElementExtensions.uf(Ca.DOMElementExtensions.getElementById(this.Dy,this.X7c)),this.Pwa&&!ic.Q(this.ksc,qa.h(this.$).ha.ra.selectedRanges)&&this.Pc(null,null))}G3a(Da){if(!this.y1||
!this.y1.BindingData)return null;for(let Na=0;Na<this.y1.BindingData.length;Na++)if(this.y1.BindingData[Na].Name===Da)return this.y1.BindingData[Na];return null}getDefaultIconUrl(){const Da=this.A4e();return Da?Da.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Hd.TaskpaneTitle)return this.Hd.TaskpaneTitle;const Da=this.A4e();return Da?Da.getDefaultDisplayName():null}RNf(){if(this.mWa&&this.K6b){const Da=new bb.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.mWa);
this.K6b(Da);this.K6b=this.mWa=null}}wg(Da){this.l2d&&this.l2d.wg(Da)}Atj(){this.$.ea.isNamedObjectViewMode&&this.Voi()&&(this.$.da.za(34).ztj(this.Dy),this.showHide(!1));if(this.Lg.q1j){if(!this.SMf){const Da={};Da.div=this.Dy;Da.id=this.Hd.InstanceId;Da.solutionId=this.Hd.PrimaryMarketplace.SolutionId;Da.version=this.Hd.PrimaryMarketplace.SolutionVersion;Da.storeId=this.Hd.PrimaryMarketplace.MarketplaceRef;Da.storeType=this.Hd.PrimaryMarketplace.MarketplaceType;Da.ownerAddinSolutionId=this.Hd.OwnerAddinSolutionId;
Da.ownerAddinStoreType=this.Hd.OwnerAddinStoreType;ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?this.Hd.AssetMarketplace?(Da.assetId=this.Hd.AssetMarketplace.SolutionId,Da.assetStoreId=this.Hd.AssetMarketplace.MarketplaceRef):(Da.assetId=null,Da.assetStoreId=null):this.Hd.AssetMarketplace&&(Da.assetId=this.Hd.AssetMarketplace.SolutionId,Da.assetStoreId=this.Hd.AssetMarketplace.MarketplaceRef);Da.settings=this.Hd.OsfPropertyBag;ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?
Da.reason=this.N6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Hgc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Da.reason=this.N6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Da.osfControlType=0===this.Hd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Da.isForUILessAction=4===
this.Hd.WebExtensionOsfControlType;Da.sourceLocationOverrideResourceId=this.Hd.SrcLocationOverrideResourceId;Da.focusOnIframeWhenLoaded=this.Hd.FocusOnIframeWhenLoaded;lb.a(this.Hd)&&(Da.featureGates=t.AFrameworkApplication.fa.T1e(Da.solutionId));Da.hostInfoFlags=0;this.Yta&&(Da.hostInfoFlags|=2);Ra.HelperMethods.Gw(this.Hd)&&(Da.hostInfoFlags|=1);this.$.X2||(e.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Da.hostInfoFlags|=4);ta.EwaSettings.ma(628)&&(Da.hostInfoFlags|=
8);ta.EwaSettings.ma(53)&&ta.EwaSettings.ma(93)&&!this.KIc&&(Da.virtualOsfControlActivationCallback=()=>{this.Lg.hEd(this.Hd)});Da.sharedRuntimeId=this.Hd.SharedRuntime?this.Hd.SharedRuntime.Resid:this.Hd.SharedRuntimeId;!Ra.HelperMethods.Gw(this.Hd)||this.Hd.Preload||lb.a(this.Hd)||this.Lg.Xh.getOsfControl(a(734).DdaFacade.getSolutionId(this.Hd,this.$))||(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Lg.hEd(this.Hd):this.Lg.hEd(this.Hd));
Da.initialDisplayMode=this.Hd.TaskpaneVisible?2:1;ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Da.titleOverride=this.wl.TaskpaneTitle);this.Lg.Xh.insertOsfControl(Da)}this.DU=0}else this.uLe(!0)}zfg(Da){this.Afg(Da);this.pTj()}dai(){this.Cdb||this.hi.M_b(this.Y8e);this.Cdb++}Afg(Da){0<this.Cdb&&(Da?this.Cdb=0:this.Cdb--,this.Cdb||this.hi.uuc(this.Y8e))}Ild(){if(!this.Pwa){const Da=qa.h(this.$).ha;this.ksc=ic.d(qa.h(this.$).ha.ra.selectedRanges);Da.KE(this.Pc);this.Pwa=
!0}}pTj(){this.Pwa&&(qa.h(this.$).ha.FI(this.Pc),this.Pwa=!1)}tqj(Da){var Na=new cc.Range(Da.Reference.FirstRow+1,Da.Reference.FirstColumn+1,Da.Reference.LastRow+1,Da.Reference.LastColumn+1,!1,!1);1===Da.BindingType&&(Da.HasHeaders&&--Na.top,Da.HasTotals&&(Na.bottom+=1));var sb=qa.h(this.$).ha.ra.selectedRanges;Da=Na.Gzb(this.ksc);sb=Na.Gzb(sb);return(Na=Na.Ke(qa.h(this.$).ha.ra.activeRange))&&(Y.e(Da)&&!Y.e(sb)||!Y.e(Da)&&!Y.e(sb)&&!ic.Q(Da,sb))?Na:null}urj(){Array.forEach(this.kF,Da=>{if(Da.eventId!==
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Da.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Lg.jj.X0b(this.controlId))if(Da.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Da.H2b(new bb.a(Da.eventId,this.controlId,null));else if(Da.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Na=this.G3a(Da.targetId);if((null===Na||void 0===Na?0:Na.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.Cb.oa.sheetName:this.$.xa.oa.name)===
Na.Reference.SheetName){const sb=this.tqj(Na);sb&&Da.H2b(new Ga(Da.eventId,this.controlId,this.Lg.L1b(Na),Na,sb.top-1,sb.left-1,sb.height,sb.width))}}})}evb(Da,Na){if(!this.kF)return null;for(let sb=0;sb<this.kF.length;sb++){const Kb=this.kF[sb];if(Kb.eventId===Da&&Kb.targetId===Na)return Kb}return null}GWe(){const Da=la.a(this.$).XU;for(let Na=Da.length-1;0<=Na;--Na){const sb=Da[Na];if(3===sb.floatingObject.type&&sb.floatingObject.wl.InstanceId===this.y1.WebExtensionId)return sb}return null}Voi(){for(let Da=
0;Da<this.$.Cb.count;Da++)if(this.$.Cb.getItem(Da).imageId===this.y1.WebExtensionId)return!0;return!1}Xxc(Da){this.OPc=Da;this.Dy.id=this.EJf;this.Dy.className=fb;this.Dy.dir=this.$.isChromeRtl?"rtl":"ltr";this.Atj()}A4e(){if(!this.enabled)return null;const Da=lb.a(this.wl)?"":this.wl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.wl.PrimaryMarketplace.SolutionId,Da)}$8e(Da,Na){if(ta.EwaSettings.ma(23))this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Na);else try{if(e.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.$fe)this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Na);else{const sb={};sb[U.a.Cob]=this.controlId;const Kb=new Wa.a(Da,0,this.$.isEditMode?2:1,0,null);this.$.Ja.Kb(Kb,sb);this.Lg.xv(Na)}}catch(sb){e.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${sb.message}.`),this.Lg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Na)}}static Nmh(Da){return Da===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Da===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Jgf(Da){return Da===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Da===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Da===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static npd(Da){return Da===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Da===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Hgf(Da){return Da===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Igf(Da){return Da===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Ggf(Da){return Da===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(Jb,"OsfControl",mb.a,[764]);class Ob{constructor(){this.OZa={}}add(Da){this.OZa[Da]=!0}remove(Da){delete this.OZa[Da]}clear(){for(const Da of Object.keys(this.OZa))delete this.OZa[Da]}n$e(){return 0<Object.keys(this.OZa).length}QLh(){return Object.keys(this.OZa)}}Object(c.a)(Ob,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,
[]);var eb=a(58);class Ma{constructor(Da,Na,sb){this.ySf=this.xSf=0;this.NMb=this.qbb=null;this.eLi=()=>{var Kb=qa.h(this.$).ha.Sa.bB;if(this.Xod(Kb)&&(Kb=this.qwb(Kb))){var Yb={};Yb.chartId=Kb;Yb.worksheetId=this.Nja();Yb=eb.a.hc(Yb);this.lja(51,Kb,Yb);this.lja(51,this.Nja(),Yb)}};this.fLi=()=>{if(this.qbb){var Kb={};Kb.chartId=this.qbb;Kb.worksheetId=this.NMb;Kb=eb.a.hc(Kb);this.lja(52,this.qbb,Kb);this.lja(52,this.NMb,Kb)}Kb=qa.h(this.$).ha.Sa.bB;this.Xod(Kb)?(this.qbb=this.qwb(Kb),this.NMb=this.Nja()):
this.NMb=this.qbb=null};this.$=Da;this.jj=Na;this.hi=sb}Dpb(Da){51===Da.messageType?this.xSf=this.gHa(Da.actionType,this.xSf,this.eLi):52===Da.messageType&&(this.ySf=this.gHa(Da.actionType,this.ySf,this.fLi))}gHa(Da,Na,sb){if(1===Da)Na||qa.h(this.$).ha.Sa.AWc(sb),Na++,this.lxj();else if(2===Da){if(1>Na)return Na;1===Na&&qa.h(this.$).ha.Sa.wLd(sb);Na--}return Na}lja(Da,Na,sb){Na&&this.jj.n_(Da,Na)&&this.hi.cN(Da,Na,sb)}qwb(Da){return Da&&Da.floatingObject?(Da=Da.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===Da.length?Da[0]:null:null}Nja(){const Da=this.$.xa.oa;return Da&&0===Da.tG?Da.sheetId:null}lxj(){const Da=qa.h(this.$).ha.Sa.bB;this.Xod(Da)&&(this.qbb=this.qwb(Da),this.NMb=this.Nja())}Xod(Da){return!!Da&&!!Da.floatingObject&&0===Da.floatingObject.type}}Object(c.a)(Ma,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var va=a(738),Pa=a(193),Ha=a(610),tb=a(99),Ya=a(347),V=a(55);class za extends fa.a{constructor(Da,Na,sb){super();this.DU=this.yAa=0;this.Pc=(Kb,Yb)=>{if(this.enabled&&!(this.zif()||
null!==Yb&&void 0!==Yb&&Yb.Plf)&&(Kb=Object(ea.a)(tb.a,this.$.xa.oa))&&0===Kb.tG){const vc=Kb.sheetId,ad=this.R0e();let ld=null,md=null;this.jj.Dlf()&&(ld=this.grid.Bb.Bj(this.grid.ha.ra.activeCell),md=vc in this.xkc?this.xkc[vc]:null);this.bve(vc,ad)&&cb.TaskExtensions.Aa(V.Task.Ta(!0),()=>{this.C8h(vc,ad);this.n8h(vc,ad,ld,md)},this.la);this.tMe(vc,ad,ld)}};this.$=Da;this.jj=Na;this.hi=sb;this.grid=qa.h(Da);this.fOa={};this.xkc={}}get enabled(){return!this.DU&&0<this.yAa}r1b(Da){Object(ea.a)(Ya.a,
this.$.xa);1===Da.actionType?(this.yAa||this.grid.ha.KE(this.Pc),this.yAa++):2!==Da.actionType||1>this.yAa||(1===this.yAa&&this.grid.ha.FI(this.Pc),this.yAa--)}Gxc(Da){Da?this.DU++:(0<this.DU&&this.DU--,this.DU||this.Pc(null,new Ha.a(!1)))}R0e(){return this.grid.ha.ra.selectedRanges}bve(Da,Na){return ta.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!Da&&Pa.e(this.fOa)||Da in this.fOa)&&!ic.Q(this.fOa[Da],Na):Da in this.fOa&&!ic.Q(this.fOa[Da],
Na)}tMe(Da,Na,sb){this.fOa[Da]=ic.d(Na);this.xkc[Da]=sb}zif(){return this.grid.eb||this.grid.si}cXe(Da,Na){this.jj.n_(14,Da)&&this.hi.cN(14,Da,Na);this.jj.n_(14,va.a.XW)&&this.hi.cN(14,va.a.XW,Na)}C8h(Da,Na){const sb={};sb.worksheetId=Da;sb.address=this.Ihd(Na);Na=eb.a.hc(sb);this.cXe(Da,Na)}n8h(Da,Na,sb,Kb){if(this.jj.Dlf()){var Yb="";let vc="";Kb&&(Yb=Kb.nj);sb&&(vc=sb.nj);Kb?sb?(Na=sb.usedRange.Gzb(Na),Yb!==vc&&this.dac(Yb,"",Da),this.dac(vc,this.Ihd(Na),Da)):this.dac(Yb,"",Da):sb&&(Yb=sb.usedRange.Gzb(Na),
this.dac(vc,this.Ihd(Yb),Da))}}dac(Da,Na,sb){if(this.jj.n_(100,Da)){const Kb={};Kb.address=Na;Kb.worksheetId=sb;this.hi.cN(100,Da,eb.a.hc(Kb))}}Ihd(Da){return ic.i(Da,",",this.$,!1)}dispose(){0<this.yAa&&this.grid.ha.FI(this.Pc);this.xkc=this.fOa=null;this.yAa=0;this.hi=this.jj=this.$=this.grid=null}}Object(c.a)(za,"RichApiEventSelectionChangedHandler",fa.a,[]);var yb=a(343);class jc extends za{constructor(Da,Na,sb){super(Da,Na,sb);this.Knf=this.Lnf=null}R0e(){return yb.a.Fsb(this.grid.ha.rangePicker.gL)}bve(Da,
Na){return this.Lnf!==Da||!ic.Q(this.Knf,Na)}tMe(Da,Na){this.Lnf=Da;this.Knf=ic.d(Na)}zif(){return!this.grid.eb&&!this.grid.si}cXe(Da,Na){this.jj.n_(2700,va.a.XW)&&this.hi.cN(2700,va.a.XW,Na)}}Object(c.a)(jc,"RichApiEventPickedRangesChangedHandler",za,[]);class Cc{constructor(Da,Na,sb){this.bRa=this.aRa=0;this.FHa=this.Lha=null;this.yBf=()=>{var Kb=qa.h(this.$).ha.Sa.bB;if(0<this.bRa&&this.Lha&&this.FHa){var Yb={};Yb.shapeId=this.Lha;Yb.worksheetId=this.FHa;Yb=eb.a.hc(Yb);this.fireEvent(2102,this.Lha,
Yb)}this.Kqi(Kb)?(this.Lha=this.RRj(Kb),this.FHa=this.Nja(),this.Lha&&this.FHa)?0<this.aRa&&(Kb={},Kb.shapeId=this.Lha,Kb.worksheetId=this.FHa,Kb=eb.a.hc(Kb),this.fireEvent(2101,this.Lha,Kb)):e.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Lha}', or worksheet id: '${this.FHa}' from a Floating object or gridview.`):this.FHa=this.Lha=null};this.$=Da;this.jj=Na;this.hi=sb}Dpb(Da){const Na=qa.h(this.$).ha;1===Da.actionType?(this.aRa||this.bRa||Na.Sa.AWc(this.yBf),
2101===Da.messageType?this.aRa++:2102===Da.messageType&&this.bRa++):2===Da.actionType&&(2101===Da.messageType?this.aRa=0<this.aRa?this.aRa-1:0:2102===Da.messageType&&(this.bRa=0<this.bRa?this.bRa-1:0),this.aRa||this.bRa||Na.Sa.wLd(this.yBf))}Kqi(Da){return!!Da&&!!Da.floatingObject&&(0===Da.floatingObject.type||7===Da.floatingObject.type||1===Da.floatingObject.type||3===Da.floatingObject.type||5===Da.floatingObject.type)}RRj(Da){if(!Da||!Da.floatingObject)return null;Da=Da.floatingObject.id;var Na=
Da.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Na=Na&&1===Na.length?Na[0]:null;return Na?Na:(e.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${Da}', but we failed.`),null)}Nja(){const Da=this.$.xa.oa;return Da&&0===Da.tG?Da.sheetId:null}fireEvent(Da,Na,sb){Na&&this.jj.n_(Da,Na)&&this.hi.cN(Da,Na,sb)}}Object(c.a)(Cc,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Sa{constructor(Da,Na,sb){this.BSf=this.ASf=this.CSf=this.zSf=
0;this.AYi=(Kb,Yb)=>{Kb=Object(ea.a)(tb.a,Yb.oa);this.w8a(Kb)&&(Yb={},Yb.worksheetId=Kb.sheetId,Yb=eb.a.hc(Yb),this.lja(11,Kb.sheetId,Yb))};this.DYi=(Kb,Yb)=>{Kb=Object(ea.a)(tb.a,Yb.RD);this.w8a(Kb)&&(Yb={},Yb.worksheetId=Kb.sheetId,Yb=eb.a.hc(Yb),this.lja(12,Kb.sheetId,Yb))};this.BYi=(Kb,Yb)=>{Kb=Object(ea.a)(tb.a,Yb.oa);this.w8a(Kb)&&(Yb={},Yb.worksheetId=Kb.sheetId,Kb=eb.a.hc(Yb),this.lja(11,null,Kb,!0))};this.CYi=(Kb,Yb)=>{Kb=Object(ea.a)(tb.a,Yb.RD);this.w8a(Kb)&&(Yb={},Yb.worksheetId=Kb.sheetId,
Kb=eb.a.hc(Yb),this.lja(12,null,Kb,!0))};this.$=Da;this.jj=Na;this.hi=sb}Dpb(Da){11===Da.messageType?Da.targetId===va.a.XW?this.zRg(Da.actionType):this.yRg(Da.actionType):12===Da.messageType&&(Da.targetId===va.a.XW?this.ARg(Da.actionType):this.BRg(Da.actionType))}yRg(Da){this.zSf=this.gHa(Da,this.zSf,this.AYi)}BRg(Da){this.CSf=this.gHa(Da,this.CSf,this.DYi)}zRg(Da){this.ASf=this.gHa(Da,this.ASf,this.BYi)}ARg(Da){this.BSf=this.gHa(Da,this.BSf,this.CYi)}gHa(Da,Na,sb){1===Da?Na=this.VYc(Na,sb):2===Da&&
(Na=this.I7c(Na,sb));return Na}VYc(Da,Na){Da||this.$.xa.Vf(Na);Da++;return Da}I7c(Da,Na){if(1>Da)return Da;1===Da&&this.$.xa.Dg(Na);Da--;return Da}w8a(Da){return!!Da&&0===Da.tG}lja(Da,Na,sb,Kb=!1){Na=Kb?va.a.XW:Na;this.jj.n_(Da,Na)&&this.hi.cN(Da,Na,sb)}}Object(c.a)(Sa,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var na=a(239),jb=a(14),Ib=a(224);class dc extends Sys.EventArgs{constructor(Da,Na,sb,Kb){super();this.sheet=Da;this.M_g=Na;this.offsetX=sb;this.offsetY=Kb}}Object(c.a)(dc,"ClickInActiveCellEventArgs",
Sys.EventArgs,[]);class ob{constructor(Da,Na,sb){this.V3b=null;this.$sd=!1;this.onPointerDown=Kb=>{let Yb;3===Kb.tb?({P0a:Yb}=this.gridView.vbc(Kb.clientPoint),this.$sd=!!Yb&&this.gridView.ha.ra.AMe(Yb)):this.$sd=!1;this.V3b=Kb.clientPoint;return!1};this.gd=Kb=>{if(this.gridView.inRangePicker||this.gridView.si||this.$sd||Kb.shiftKey||Kb.ctrlKey||Kb.Ca.button!==Sys.UI.MouseButton.leftButton||!this.V3b||!Kb.clientPoint||Kb.clientPoint.x!==this.V3b.x||Kb.clientPoint.y!==this.V3b.y)return!1;const Yb=
({P0a:Kb}=this.gridView.vbc(Kb.clientPoint)).returnValue,vc=Object(ea.a)(tb.a,this.$.xa.oa);if(Yb&&vc&&0===vc.tG){if(!this.gridView.ha.ra.x4.contains(Kb))return!1;Kb=new dc(vc,Kb,Ra.HelperMethods.TFd(Yb.x),Ra.HelperMethods.TFd(Yb.y));this.EYi(Kb)}return!1};this.$=Da;this.gridView=qa.h(Da);this.jj=Na;this.hi=sb;this.ycj()}dispose(){this.bUj()}ycj(){for(const Da of this.gridView.Mn){const Na=Da.domElement;na.a.instance.ta(jb.a.pointerDown,Na,this.onPointerDown);Ib.a.instance.ta(jb.a.click,Na,this.gd)}}bUj(){for(const Da of this.gridView.Mn){const Na=
Da.domElement;na.a.instance.Ba(jb.a.pointerDown,Na,this.onPointerDown);Ib.a.instance.Ba(jb.a.click,Na,this.gd)}}EYi(Da){var Na=Da.sheet;if(this.w8a(Na)){var sb={};sb.worksheetId=Na.sheetId;sb.address=Da.M_g.toString();sb.offsetX=Da.offsetX;sb.offsetY=Da.offsetY;Da=Na.sheetId;this.jj.n_(21,Da)&&(Na=eb.a.hc(sb),this.hi.cN(21,Da,Na));Da=va.a.XW;this.jj.n_(21,Da)&&(sb=eb.a.hc(sb),this.hi.cN(21,Da,sb))}}w8a(Da){return!!Da&&0===Da.tG}}Object(c.a)(ob,"RichApiEventSingleClickedHandler",null,[]);class Fa{constructor(Da,
Na,sb){this.gJb=0;this.hbb=this.nbb=null;this.GIf=()=>{const Kb=qa.h(this.$).ha.Sa.bB;if(Kb)if(this.rmf(Kb)){const Yb=this.Nja();this.jcd(Yb);this.nbb=Kb.floatingObject.id;this.hbb=Yb}else this.nbb&&(this.jcd(this.hbb),this.hbb=this.nbb=null);else this.nbb&&(this.jcd(this.hbb),this.hbb=this.nbb=null)};this.$=Da;this.jj=Na;this.hi=sb}r1b(Da){2E3===Da.messageType&&(1===Da.actionType?(this.gJb||qa.h(this.$).ha.Sa.AWc(this.GIf),this.gJb++,this.Htj()):2===Da.actionType&&this.gJb&&(1===this.gJb&&qa.h(this.$).ha.Sa.wLd(this.GIf),
this.gJb--))}jcd(Da){var Na;const sb={};sb.worksheetId=Da;sb.revisionLoad=!1;if(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(ta.EwaSettings.ma(703)||ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const Kb=qa.h(this.$).ha.Sa.bB;(null===(Na=null===Kb||void 0===Kb?void 0:Kb.floatingObject)||void 0===Na?0:Na.Vc)?sb.selectedVisualId=Kb.floatingObject.Vc.VisualID:sb.selectedVisualId=null}Na=
eb.a.hc(sb);Da&&this.jj.n_(2E3,Da)&&this.hi.cN(2E3,Da,Na)}Nja(){const Da=this.$.xa.oa;return Da&&0===Da.tG?Da.sheetId:null}Htj(){const Da=qa.h(this.$).ha.Sa.bB;this.rmf(Da)&&(this.nbb=Da.floatingObject.id,this.hbb=this.Nja())}rmf(Da){return!!Da&&Da.xtd()}}Object(c.a)(Fa,"RichApiEventVisualSelectionChangedHandler",null,[]);class Ab{constructor(Da,Na,sb){this.hJb=0;this.xlg=!0;this.tac=0;this.Wrd=!0;this.sBe=()=>{const Kb=document.hasFocus();if(this.xlg!==Kb){if(Kb){const Yb=eb.a.hc({});this.hi.cN(2203,
va.a.XW,Yb)}this.xlg=Kb}};this.tBe=Kb=>{(0<Kb.timeRemaining()||Kb.didTimeout)&&this.sBe();window.requestIdleCallback(this.tBe)};this.$=Da;this.jj=Na;this.hi=sb;window.requestIdleCallback||(this.Wrd=!1)}xRg(Da){1===Da.actionType?(this.hJb||this.RRg(),this.hJb++):2!==Da.actionType||1>this.hJb||(1===this.hJb&&this.yjh(),this.hJb--)}RRg(){if(this.jj.n_(2203,va.a.XW))if(this.Wrd){const Da={};Da.timeout=this.$.va.CheckFocusTimeout;this.tac=window.requestIdleCallback(this.tBe,Da)}else this.tac=window.setInterval(this.sBe,
this.$.va.CheckFocusTimeInterval)}yjh(){this.Wrd?window.cancelIdleCallback(this.tac):window.clearInterval(this.tac)}}Object(c.a)(Ab,"RichApiEventWorkbookActivatedHandler",null,[]);var $b;(function(Da){Da[Da.none=0]="none";Da[Da.registerEvent=1]="registerEvent";Da[Da.unregisterEvent=2]="unregisterEvent";Da[Da.customFunction=3]="customFunction";Da[Da.showCard=4]="showCard";Da[Da.createWorkbook=5]="createWorkbook";Da[Da.openWorkbook=6]="openWorkbook";Da[Da.enableEvents=7]="enableEvents";Da[Da.closeWorkbook=
8]="closeWorkbook";Da[Da.setCalculationMode=9]="setCalculationMode";Da[Da.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Da[Da.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";Da[Da.workbookLinksEnableContent=12]="workbookLinksEnableContent";Da[Da.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Da[Da.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Da[Da.rangePicker=15]="rangePicker";Da[Da.enableRichApiRecording=16]="enableRichApiRecording";Da[Da.recordAction=
17]="recordAction";Da[Da.focus=18]="focus";Da[Da.businessBarShow=19]="businessBarShow";Da[Da.businessBarHide=20]="businessBarHide"})($b||($b={}));Object(c.b)("PostProcessActionType",$b);var Cb=a(249);class Rb{constructor(Da,Na,sb){this.FJf=null;this.hcd=(Kb,Yb)=>{const vc=va.a.XW,ad={};ad.eventId=Kb;ad.payload=Yb;this.jj.n_(2201,vc)&&this.hi.cN(2201,vc,eb.a.hc(ad))};this.$=Da;this.jj=Na;this.hi=sb;this.zei()}wRg(Da){1===Da.actionType?(this.$.Qba=!0,Object(ea.a)(a(734).DdaFacade,Cb.a(this.$)).icd(!0)):
2===Da.actionType&&(this.$.Qba=!1);this.FJf=Da.controlId;e.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${$b[Da.actionType]}; controlId: ${this.FJf}; this.ewaControl.IsMacroRecorderListening: ${this.$.Qba}.`)}Iqh(Da){Object(ea.a)(a(734).DdaFacade,Cb.a(this.$)).fXe(Da,this.$.Qba)}zei(){this.$.GV&&cb.TaskExtensions.Aa(xb.GetServiceTaskFactory.Oa(this.$.da,297,298,1),Da=>{(Da=Da.result)&&Da.init(this.hcd)},this.$.la,3)}}Object(c.a)(Rb,"RichApiMacroRecorderEventHandler",
null,[]);class uc{}Object(c.a)(uc,"SessionRecreationInfo",null,[]);class nb{constructor(Da,Na,sb){this.$=Da;this.jj=Na;this.runtimeCalculationMode=sb}RGi(){return ta.EwaSettings.ma(257)?this.jj.s9h()||0!==this.runtimeCalculationMode:!1}FWg(){var Da={};Da.eventRegistrationInfos=this.jj.aSh();Da.runtimeCalculationMode=this.runtimeCalculationMode;Da=Object(b.a)(new uc,{runtimeState:Da});const Na={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Na.RequestBody=JSON.stringify(Da);
Na.RequestFlags=1;return Na}}Object(c.a)(nb,"RichApiRuntimeStateHandler",null,[]);class Fb{constructor(Da,Na,sb,Kb,Yb,vc,ad,ld,md){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=Da;this.processUtcTime=Na;this.dequeueUtcTime=sb;this.inQueueDurationInMS=Kb;this.executionDurationInMS=Yb;this.operationCount=vc;this.ServerCorrelationId=
ad;this.UserOperationName=ld;this.IsDocumentHidden=md}}Object(c.a)(Fb,"UserOperationQueueItemsStatisticsData",null,[]);var Jc=a(329),Fc=a(31),zb=a(19),hb=a(293),Pb=a(49),ud=a(594),Ub=a(64),Ac=a(59),Ic=a(71);class dd extends Jc.a{constructor(Da,Na,sb){super(sb,Da);this.rwa=this.hashCode=null;this.V4b=!1;this.an=(Kb,Yb)=>{Yb.ed.hash===this.hashCode&&this.rwa&&Object(ea.a)(a(734).DdaFacade,this.$.da.za(35)).AEj(this.rwa.InstanceId)};this.tf=(Kb,Yb)=>{switch(Yb.ed.block.state){case 1:case 3:case 5:this.eea(Yb)}};
this.Hj=()=>{this.uIb(!0)};this.Mo=(Kb,Yb)=>{this.isVisible&&this.KUa(Yb.RD);this.clearCache()};this.te=(Kb,Yb)=>{this.NTa(Yb.oa,!!Yb.RD)};this.bO=()=>{this.$.ea.Ima()};this.kVa=Na;this.domElement.classList.add(Fc.a.V9b);this.domElement.classList.add(zb.a.Bo);sb.tabIndex=0;this.NTa(this.$.oa,!1);this.Gc.ka("mousedown",this.bO);this.Gc.ka("contextmenu",Kb=>{Ic.g(Kb)});this.$.xa.HJ(this.Mo);this.$.Cb.HJ(this.Mo);this.$.Cb.Vf(this.te);this.$.xa.Vf(this.te);this.Ea.mt(this.tf);this.Ea.hH(this.an);this.Ea.hw(this.Hj);
this.jv(this.iza)}get Ea(){return this.kVa}dispose(){this.$&&(this.$.xa.nL(this.Mo),this.$.Cb.nL(this.Mo),this.$.Cb.Dg(this.te),this.$.xa.Dg(this.te));this.kVa&&(this.kVa.er(this.tf),this.kVa.EI(this.an),this.kVa.gx(this.Hj));this.Ky(this.iza);this.clearCache();da.a.Ia(this.kVa);this.kVa=null;Ca.DOMElementExtensions.uf(this.domElement);super.dispose()}ztj(Da){Ca.DOMElementExtensions.uf(Ca.DOMElementExtensions.getElementById(this.domElement,Da.id));this.domElement.appendChild(Da)}pnd(){if(this.rwa&&
!this.V4b){var Da=Object(ea.a)(a(734).DdaFacade,Cb.a(this.$)).zn(this.rwa.InstanceId);Da&&(Da.resize(this.rwa.Width,this.rwa.Height),Da.ka(this.domElement),Da.showHide(!0),this.V4b=!0)}}y8a(){return!0}eea(Da){this.rwa=Da.ed.block.ke;this.V4b=!1;this.pnd()}KUa(Da){this.$.ea.j5&&Da&&(Da.Wu||(Da.Wu=new hb.a),Da.Wu.ei=new Pb.a(this.domElement.scrollLeft,this.domElement.scrollTop),Da.Wu.NHb=20)}clearCache(){this.Ea.hRa(this.hashCode);this.rwa=this.hashCode=null;this.V4b=!1}NTa(Da,Na){if(this.isVisible=
!!Da&&Ub.o(Da))this.hashCode=this.Ea.gsa(Da,Ac.a.a7b,this.hashCode),this.lyc(Na)}static hHa(Da){if(!Da.da.za(34)){const Na=Da.vf;Da.da.Ga(34,new dd(Da,new ud.a(Da,Da.ea,Da.pa.Nk,3,0),Na.appendChild(Na.ownerDocument.createElement("div"))))}}}Object(c.a)(dd,"WebExtensionView",Jc.a,[760,225,2]);var Ud=a(226),Hd=a(371),me=a(436),xe=a(188),Ke=a(60),vd=a(116),Qe=a(47),bc=a(46),Zc=a(153),gd=a(110),Sc=a(63),Gd=a(28),Vd=a(29),Ed=a(282),Od=a(22),se=a(13),Le=a(281),Id=a(737),fe=a(51),Yd=a(147),Ce=a(864);const ye=
Da=>{Yd.a.sendOtelEvent(Object.assign(new Ce.a,{otelEvent:Da}))},Ae=Da=>{Yd.a.sendOtelCustomerContent(Object.assign(new Ce.a,{otelEvent:Da}))};var He=a(200),gf=a(863),Xe=a(25),$a=a(223);a.d(E,"DdaFacade",function(){return ac});class ac extends Ia.a{constructor(Da,Na){super();this.hi=this.Im=this.ea=null;this.Af=[];this.FJa=null;this.disposed=this.initialized=this.iRb=this.dJe=!1;this.SCa=null;this.Aqc=[];this.YIe=[];this.hQa=[];this.e2a=null;this.KFd=new S.a(oa.a.Yj());this.f0b=new K.a(oa.a.Yj());
this.vHb=[];this.YKf=[];this.e7b=350;this.Yxa=this.mfa=null;this.xUc=!1;this.wie=this.vie=this.uie=this.sie=this.nie=this.tie=this.oie=this.rie=this.mie=this.qie=null;this.zf=()=>{this.SCa=this.ea.Io.WebExtensions;for(var sb=this.Af.length-1;0<=sb;--sb){var Kb=this.Af[sb],Yb;if(Yb=!this.CFh(Kb.controlId))Yb=Kb,Yb=ta.EwaSettings.ma(121)?!Yb.Yta:!0;Yb&&(Kb.xoc(),this.Af.splice(sb,1))}if(this.SCa)for(let vc=0,ad=this.SCa.length;vc<ad;vc++)sb=this.SCa[vc],(Kb=this.zn(sb.WebExtensionId))&&Kb.cDd(sb)};
this.ypc=sb=>{this.raiseEvent("csc",sb.getID())};this.oDd=(sb,Kb,Yb)=>{if(Kb===OSF.AgaveHostAction.KeyboardShortcuts){var vc=Object(ea.a)(Object,Yb);Kb={};Kb.keyCode=vc.keyCode;Kb.type="keydown";Kb.ctrlKey=vc.ctrlKey;Kb.shiftKey=vc.shiftKey;Kb.altKey=vc.altKey;Kb.metaKey=vc.metaKey;vc=this.zn(sb);sb=vc.r$;Kb.srcElement=Object(ya.a)(327,sb)?sb.VGa:qa.h(this.$).mc;sb=new Sys.UI.DomEvent(Kb);vc=ac.Cva(vc.wl,this.$);Kb={};Kb.focusedAddinId=vc;vc=new Wa.a(1461300262,1,this.$.Hc,6,null);qa.h(this.$).TKb(sb,
vc,Kb)}else if(Kb===OSF.AgaveHostAction.Select)this.L8e(!0);else if(Kb===OSF.AgaveHostAction.UnSelect)this.L8e(!1);else if(Kb===OSF.AgaveHostAction.CancelDialog)this.yK(-684355545,null);else if(Kb===OSF.AgaveHostAction.InsertAgave)sb={},Yb&&(sb[U.a.ssa]=Yb,sb[ja.a.og]=ac.Jsb(Yb),this.yK(-741808261,sb));else if(Kb===OSF.AgaveHostAction.InsertDevManifest)sb={},Yb&&(sb[U.a.ssa]=Yb,sb[ja.a.og]=ac.Jsb(Yb),this.yK(-741808261,sb));else if(Kb===OSF.AgaveHostAction.InsertDevManifestError)sb=Object(ea.a)(Object,
Yb),sb={[U.a.gXc]:this.Im.getDevManifestInvalidUrlErrorString(sb.manifestUrl)},this.yK(-2025863019,sb);else if(Kb===OSF.AgaveHostAction.NotifyHostError)sb={[U.a.gXc]:this.Im.getManifestInvaildErrorString()},this.yK(-2025863019,sb);else if(Kb===OSF.AgaveHostAction.RefreshAddinCommands)ta.EwaSettings.ma(53)&&this.yK(Xe.a.refreshAddinCommands,null);else if(Kb===OSF.AgaveHostAction.CtrlF6Exit||Kb===OSF.AgaveHostAction.CtrlF6ExitShift){if(vc=this.$.da.za(15)){(sb=this.zn(sb).r$)&&sb.uAc();v.a.If&&document.activeElement.blur();
var ad={keyCode:117,type:"keydown",ctrlKey:!0};ad.shiftKey=Kb===OSF.AgaveHostAction.CtrlF6ExitShift;ad.srcElement=Object(ya.a)(327,sb)?sb.VGa:qa.h(this.$).mc;sb=new Sys.UI.DomEvent(ad);vc.Ama(sb)}}else if(Kb===OSF.AgaveHostAction.PageIsReady){if((sb=this.zn(sb).r$)&&sb.VZa===OSF.OsfControlTarget.TaskPane&&(sb=this.$.da.za(183))&&this.Af){Kb=wb.a.fd(this.$);for(vc of this.Af)ac.WMa(vc.pU)&&(Kb?sb.kg(!0,!1):sb.setFocusOnToolbarFirstElement())}}else if(Kb===OSF.AgaveHostAction.TabExit){Kb=this.zn(sb);
const Qd=Kb.r$;if(Qd)if(Qd.VZa===OSF.OsfControlTarget.InContent)Qd.onf();else{if(Qd.VZa===OSF.OsfControlTarget.TaskPane)if(wb.a.fd(this.$))v.a.If&&document.activeElement.blur(),N.UISurfaces.dj().then(ce=>{const ec=Object(ya.a)(327,Qd)?Qd:null;ec?ec.isResizable?ce.focusResizeHandle():ce.focusTabbedTaskPaneArea():ce.focusTabbedTaskPaneArea();return null});else if(Kb=this.$.da.za(183))v.a.If&&document.activeElement.blur(),(sb=document.getElementById(this.$.Eb+ra.a.znc))&&Ca.DOMElementExtensions.isVisible(sb)?
Ca.DOMElementExtensions.setFocus(sb):Kb.setFocusOnToolbarFirstElement()}else Kb&&4===Kb.osfControlType&&this.Im.notifyAgave(sb,OSF.AgaveHostAction.TabIn)}else if(Kb===OSF.AgaveHostAction.TabExitShift)(Kb=this.zn(sb),vc=Kb.r$)?vc.VZa===OSF.OsfControlTarget.InContent?vc.pnf():vc.VZa===OSF.OsfControlTarget.TaskPane&&(sb=Object(ya.a)(327,vc)?vc:null)&&(v.a.If&&document.activeElement.blur(),sb.L2f()):Kb&&4===Kb.osfControlType&&this.Im.notifyAgave(sb,OSF.AgaveHostAction.TabIn);else if(Kb===OSF.AgaveHostAction.EscExit||
Kb===OSF.AgaveHostAction.ExitNoFocusable||Kb===OSF.AgaveHostAction.ExitNoFocusableShift)if(vc=this.zn(sb).r$)vc.uAc();else{if(Kb===OSF.AgaveHostAction.EscExit){Kb=null;for(ad of C.k4h())if(ad.value.Fe===sb){ad.value.dialog.hide();Kb=ad.key;break}Kb&&(sb=this.zn(Kb))&&4!==sb.osfControlType&&this.Xh.notifyAgave(Kb,OSF.AgaveHostAction.TabIn)}}else if(Kb===OSF.AgaveHostAction.InstallCustomFunctions)if(ta.EwaSettings.ma(121)){Sc.a(this.$).kYe(()=>!1);var ld=this.$.da;cb.TaskExtensions.Aa(xb.GetServiceTaskFactory.Oa(ld,
278,279,1),Qd=>{Qd=Qd.result;ld.za(278)||ld.Ga(278,Qd);const ce=Yb.osfControl.getStoreType();Qd.qef(Yb.osfControl.getSolutionId(),ce,ac.rQh(Yb.osfControl),Yb).Fna()},this.la,3)}else e.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Kb===OSF.AgaveHostAction.UninstallCustomFunctions)if(ta.EwaSettings.ma(121)){Sc.a(this.$).kYe(()=>!1);var md=this.$.da;cb.TaskExtensions.Aa(xb.GetServiceTaskFactory.Oa(md,278,279,
1),Qd=>{Qd=Qd.result;md.za(278)||md.Ga(278,Qd);Qd.Cfg(Yb.solutionId,Yb.storeType).Fna()},this.la,3)}else e.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Kb===OSF.AgaveHostAction.SendTelemetryEvent?ye(Yb):Kb===OSF.AgaveHostAction.SendCustomerContent?Ae(Yb):Kb===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.pvi(Yb):Kb===OSF.AgaveHostAction.RefreshRibbonGallery?ta.EwaSettings.getBooleanFeatureGate($a.a.dB,
!1)?(sb=this.$.da.za(519))&&sb.SLa(Yb):(sb=this.$.da.za(352))&&sb.SLa(Yb):Kb===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.eej(Yb.solutionId),wb.a.fd(this.$)||(sb=this.$.da.za(183))&&sb.kA(),ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&t.AFrameworkApplication.ub.ae(Xe.a.TSf,2,Yb.solutionId)):Kb===OSF.AgaveHostAction.GetOriginalControlId&&(sb=new I.a(this.$.Eb,Yb.ownerAddinSolutionId,new pa.a,!0),Yb.originalControlId=sb?sb.qJe(Yb.controlId):
Yb.controlId)};this.vrj=(sb,Kb)=>{const Yb=Array(2);Yb[0]=Kb;Yb[1]=null;this.hi.LFh(sb,JSON.stringify(Yb))};this.iYi=()=>{this.$.oa&&Ub.o(this.$.oa)&&this.$.da.za(34).pnd()};this.dd=()=>{this.jpf()};this.DR=(sb,Kb)=>{var Yb,vc;1===Kb.Kr&&(sb=Kb.Rf)&&(Kb=new Fb(gd.toTimestamp(sb.enqueueUtcTime),gd.toTimestamp(sb.processUtcTime),gd.toTimestamp(sb.dequeueUtcTime),gd.getElapsedMilliseconds(sb.enqueueUtcTime,sb.processUtcTime),gd.getElapsedMilliseconds(sb.processUtcTime,sb.dequeueUtcTime),sb.operationCount,
(null===(vc=null===(Yb=sb.operation)||void 0===Yb?void 0:Yb.nd)||void 0===vc?0:vc.ServerCorrelationId)?sb.operation.nd.ServerCorrelationId:null,sb.operation?Enum.toString(me.a,sb.operation.operationName):null,Id.a.xD(gd.getElapsedMilliseconds(sb.enqueueUtcTime,Gd.a.Qa.zb))),Yb=Sys.Serialization.JavaScriptSerializer.serialize(Kb),e.ULS.sendTraceTag(50872916,0,50,Yb))};this.Tc=(sb,Kb)=>{!this.ea.Zb&&Ud.a(Kb)?(Array.forEach(this.Af,this.nAf),this.Af.length=0,this.iRb=!1):(Kb.WH&&(e.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),this.vXf()),this.rL(),ta.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.iRb=!1))};this.Oo=()=>{ta.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(e.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.vXf());this.rL();ta.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.iRb=
!1)};this.nAf=sb=>{sb.xoc();this.raiseEvent("cd",sb.controlId)};this.jb=Da;this.yXc=Na;this.initialize();rb.ka(this);this.wYf=0;(Da=(Da=!(v.a.Dp||v.a.v5))&&(!ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!v.a.If))&&OfficeExt.ShortcutKeyDispatchManager.init();this.awg={}}get d1b(){return this.mfa||(this.mfa=new W.a(this.$.qu))}xWc(Da){this.addHandler("cd",Da)}gfj(Da){this.removeHandler("cd",Da)}QJg(Da){this.addHandler("csc",Da)}ifj(Da){this.removeHandler("csc",
Da)}NJg(Da){this.addHandler("ca",Da)}ffj(Da){this.removeHandler("ca",Da)}OJg(Da){this.addHandler("ci",Da)}PJg(Da){this.addHandler("ekros",Da)}hfj(Da){this.removeHandler("ekros",Da)}nFd(Da,Na){try{return JSON.parse(Da)[Na].toLowerCase()}catch(sb){return""}}cAj(Da){const Na=this.nFd(Da,"AudienceGroup"),sb=this.nFd(Da,"SessionOrigin");try{const Kb=parseInt(this.nFd(Da,"Ring"),10);if("automation"!==Na&&"bluechicken"!==sb&&-2<=Kb)return!0}catch(Kb){if("automation"!==Na&&"bluechicken"!==sb)return!0}return!1}get Xh(){if(!this.Im){const Da=
{},Na=!(this.$.qd&1),sb=Oa.a.current.hL,Kb=this.$.workbookContext,Yb=X.a.HL+X.a.r4b;Da.pageBaseUrl=sb.LayoutsContentUrlPrefix;Da.appName=OSF.AppName.ExcelWebApp;Da.appVersion="16";Da.appSettings=this.nUh();Da.singleSignOnSettings=H.AppsForOfficeSingleSignOnManager.R0h();Da.clientMode=Na?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Da.appUILocale=this.$.va.UICultureTag;Da.dataLocale=this.$.va.DataCultureTag;Da.docUrl=Kb.ClientUrl;Da.hostControl=this;Da.formFactor=OSF.FormFactor.Default;Da.lcid=
this.$.GG.toString();Da.localizedScriptsUrl=X.a.HL+X.a.p3c;Da.localizedImagesUrl=Yb;Da.localizedStylesUrl=X.a.HL+X.a.rEe;Da.localizedResourcesUrl=Yb;Da.osfOmexBaseUrl=sb.OsfOmexBaseUrl;Da.firstPartyManifestCDNUrl=sb.FirstPartyAddInManifestCDN;Da.sdxAssetsToPrefetchMapping=t.AFrameworkApplication.fa.Xa("SdxAssetsToPrefetchMapping");Da.sdxCdnUrl=sb.SdxCdnUrl;Da.sdxDmsUrl=sb.SdxDmsUrl;Da.devCatalogUrl=sb.DevCatalogUrl;Da.controlStatusChanged=this.ypc;Da.notifyHost=this.oDd;Da.allowExternalMarketplace=
this.$.ea.Wg.get(27)&&ac.c5b;Da.enableAddinCommands=ta.EwaSettings.ma(53);Da.enableBlackForestRedirect=ta.EwaSettings.ma(88);Da.enableMyOrg=this.$.ea.Wg.get(33);Da.enableMyApps=this.$.ea.Wg.get(34);Da.enableDevCatalog=ta.EwaSettings.ma(44);Da.enablePrivateCatalog=this.WAj();Da.enableTaskpaneUpgradeToAppCommand=ta.EwaSettings.ma(93);Da.showSignOutFromPrivateCatalogMessage=this.$.ea.Wg.get(36);Da.enableUploadFileDevCatalog=ta.EwaSettings.ma(53)&&!ta.EwaSettings.ma(280);Da.userNameHashCode=T.a.mw(t.AFrameworkApplication.userName);
Da.envCode=this.$.va.OfficeAddinTelemetryDataSourceCode.toString();Da.enableSingleSignOnForAddin=!ta.EwaSettings.ma(23)&&t.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Da.enableDisplayBlockedMinorError=ta.EwaSettings.ma(181);Da.hideAppsExtensionUrl=t.AFrameworkApplication.hideAppsExtensionUrl;Da.enableAnonymousUseLegacyCatalogService=ta.EwaSettings.ma(171);Da.enableInsertDialogAccessibilityFix=ta.EwaSettings.ma(178);Da.disableAppsForOfficeThirdParty=ta.EwaSettings.ma(184);Da.enableFirstPartySSO=
ta.EwaSettings.ma(196);Da.wacSessionId=this.$.va.UserSessionId;Da.disableLogging=!this.$.va.AriaLoggingIsEnabled;Da.enableFirstPartySDXErrorMessages=ta.EwaSettings.ma(209);Da.enableRichApiCellEditDelay=ta.EwaSettings.ma(188);Da.isHostDocumentDomain=ta.EwaSettings.ma(224);Da.loggableUserId=t.AFrameworkApplication.fa.Xa("LoggableUserId");Da.sessionStartInfoJson=t.AFrameworkApplication.fa.Xa("SessionStartInfoJson");Da.wopiHostOriginFromPostMessage=t.AFrameworkApplication.wopiHostOriginFromPostMessage;
Da.wopiHostOriginFromWacPropBag=t.AFrameworkApplication.fa.Xa("PostMessageOrigin");Da.wacIsEmbedded=t.AFrameworkApplication.fa.qa("IsEmbedded");Da.accessibilityAllowFocusAddinTaskpane=t.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");Da.enableRemoveAppCommandsAddin=t.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");Da.isHostFrameTrustCheckEnabledForAddIns=t.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");Da.isHostFrameTrusted=t.AFrameworkApplication.isHostFrameTrusted;
Da.agaveAddinUploadEnabled=ta.EwaSettings.ma(46);Da.hostAllowedOfficeStore=t.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");Da.hostAllowedSdxEmbedding=t.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");Da.hostInstallAddIns=t.AFrameworkApplication.fa.Xa("HostInstallAddIns");Da.hostInstallAddInsIsEnabled=t.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");Da.approvedAddIns=t.AFrameworkApplication.fa.Xa("ApprovedAddIns");Da.addinEnforceHttpsIsEnabled=this.cAj(Da.sessionStartInfoJson);
Da.hostFeatureGateFlag=0;Da.isUpnCheckEnabled=t.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");Da.wacUpn=t.AFrameworkApplication.fa.Xa("UserPrincipalName");Da.isReactRibbonEnabled=wb.a.isReactRibbonEnabled();Da.enableSetFocusOnTaskpaneOnUserAction=ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Da.isSafariWithIndexedDBDisabled=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&v.a.BNa;Da.isIndexedDBDisabled=
ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&v.a.BNa||ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&v.a.If;Da.enableCustomShortcuts=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");Da.changeGetModifierKeyStringOutputOrder=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Da.officeJsUrl=t.AFrameworkApplication.xL("OfficeJs/excel.js",5);Da.enableOfficeJsUrlParam=ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",
!1);this.Im=new OSF.ContextActivationManager(Da);this.Im.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Im.setWSA(t.AFrameworkApplication.Tn);this.Im&&"undefined"!==typeof this.Im.hostCheckReadyHandler&&t.AFrameworkApplication.LKg(Object(d.a)(this.Im,this.Im.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const vc=sa.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Im.setOAuthManager(vc)}catch(vc){}}return this.Im}get q1j(){return this.xUc}get jj(){return this.qie}get Ana(){return this.mie}get hOd(){return this.rie}get gOd(){return this.oie}get Hmj(){return this.tie}get Fmj(){return this.nie}get Gmj(){return this.sie}get Imj(){return this.uie}get Jmj(){return this.vie}get iOd(){return this.wie}get vV(){return this.awg}get $(){return this.jb}L1b(Da){const Na=
{};Na.Name=Da.Name;Na.BindingType=Da.BindingType;Na.HasHeaders=Da.HasHeaders;Da.IsValidRef&&(Na.ColCount=Da.Reference.LastColumn-Da.Reference.FirstColumn+1,Na.RowCount=Da.Reference.LastRow-Da.Reference.FirstRow+1);return Na}Bof(Da,Na){const sb=this.IVg(Na);if(t.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")){let Kb=null;ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==sb.assetId&&
"undefined"!==typeof sb.assetId&&null!==Na&&"LaunchAddinDialogFromTellMe"===Na[0]&&(Kb="{98143890-AC66-440E-A448-ED8771A02D52}");this.Im.launchInsertDialog(Da,Kb,sb)}else this.Im.launchInsertDialog(Da,null,sb)}sda(Da,Na){if(t.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.rOf(Da,Na,OSF.StoreTypeEnum.MarketPlace);else{const sb={};sb.callbackFunc=Da;sb.storeType=OSF.StoreTypeEnum.MarketPlace;sb.fromInsertDialog=!1;sb.refresh=Na;this.Im.queryEntitlementDetails(sb)}}rOf(Da,
Na,sb){const Kb={};Kb.callbackFunc=Da;Kb.storeType=sb;Kb.fromInsertDialog=!1;Kb.refresh=Na;this.Im.queryEntitlementDetails(Kb)}invokeDdaMethod(Da,Na){const sb=this.zn(Da.DdaMethod.ControlId);sb?sb.invokeDdaMethod(Da,Na):this.rf(aa.a.internalError,Na)}registerDdaEventAsync(Da,Na,sb,Kb,Yb){(Na=this.zn(Na))?ac.tAb(Da)?Na.abj(Da,sb,Kb,Yb):this.rf(aa.a.EEd,Yb):this.rf(aa.a.internalError,Yb)}unregisterDdaEventAsync(Da,Na,sb,Kb,Yb){(Na=this.zn(Na))?ac.tAb(Da)?Na.GTj(Da,sb,Kb,Yb):this.rf(aa.a.EEd,Yb):this.rf(aa.a.internalError,
Yb)}dispose(){this.disposed||(this.$.Jl(this.dd),this.ea.uk(this.Tc),this.ea.VR(this.Oo),this.ea.Mv(this.zf),this.yXc.detach(this),this.$.userOperationManager.ko(this.DR),this.Aqc=this.Af=this.hi=this.yXc=this.jb=null,this.FJa&&(this.FJa.dispose(),this.FJa=null),da.a.Ia(this.hOd),da.a.Ia(this.gOd),this.e2a&&(this.e2a.dispose(),this.e2a=null),super.dispose(),this.disposed=!0,e.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}ofd(Da){return(Da=this.zn(Da))?Da.getDefaultIconUrl():null}Gxc(Da){if(this.dJe!==
Da){this.dJe=Da;for(let Na=0,sb=this.Af.length;Na<sb;Na++){const Kb=this.Af[Na];Da?Kb.uLe(!1):Kb.zph()}this.hOd.Gxc(Da);this.gOd.Gxc(Da)}}MQh(Da){return(Da=this.zn(Da))?Da.getDefaultDisplayName():null}rf(Da,Na,sb=!0){const Kb={};Kb[ja.a.og]=Da;Kb[ja.a.V3]=Na;this.yK(451041795,Kb,sb)}xv(Da){const Na={};Na[ja.a.V3]=Da;this.yK(1237877382,Na)}yK(Da,Na,sb=!0){const Kb=new Wa.a(Da,0,this.$.Hc,0,null),Yb=Na?Na[ja.a.V3]:null;this.e2a&&qa.h(this.$).eb&&Va.w4g(Da,Na)?this.e2a.nih(Da,Na):(Da=this.$.Ja.Kb(Kb,
Na),sb&&cb.TaskExtensions.Aa(Da,vc=>{Zc.a(vc)?this.rf(aa.a.internalError,Yb,!1):vc.result||(qa.h(this.$).eb?this.rf(aa.a.EMa,Yb,!1):this.rf(aa.a.internalError,Yb,!1))},this.la,8))}X6g(Da){return!!this.kja(Na=>ac.getSolutionId(Na.wl,this.$)===ac.getSolutionId(Da,this.$)&&Na.wl.PrimaryMarketplace.MarketplaceType===Da.PrimaryMarketplace.MarketplaceType&&Na.wl.PrimaryMarketplace.MarketplaceRef===Da.PrimaryMarketplace.MarketplaceRef&&Na.wl.PrimaryMarketplace.SolutionVersion===Da.PrimaryMarketplace.SolutionVersion)}zn(Da){return this.kja(Na=>
Na.controlId.startsWith(Da))}pFh(Da){return this.kja(Na=>Na.Yta===Da)}HWe(Da){return this.kja(Na=>Na.pU===Da&&!!Na.Yta)}WWe(Da,Na,sb,Kb){return this.kja(Yb=>Yb.pU===Da&&Yb.wl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Na.toLowerCase()&&Yb.wl.PrimaryMarketplace.MarketplaceType.toLowerCase()===sb.toLowerCase()&&!!Yb.wl.SharedRuntime&&!!Yb.wl.SharedRuntime.Resid&&!!Kb&&!!Kb.Resid&&Yb.wl.SharedRuntime.Resid.toLowerCase()===Kb.Resid.toLowerCase())}lRg(Da,Na){if(Da=this.zn(Da))Da.ka(Na),Da.showHide(!0)}AEj(Da){(Da=
this.zn(Da))&&Da.showHide(!1)}HIa(Da){var Na;if(1!==Da.WebExtensionType||this.$.qd&8388608&&Da.TaskpaneVisible||this.$.qd&8388608&&!Da.TaskpaneVisible&&Ra.HelperMethods.Gw(Da)){let sb=null;Ra.HelperMethods.Gw(Da)&&(sb=ac.Cva(Da,this.$),Da.TaskpaneWidth||(Da.TaskpaneWidth=this.e7b));const Kb=(new Jb(this,this.hi,Da)).$md();e.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da.PrimaryMarketplace.SolutionId,ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)?Da.OwnerAddinStoreType||Da.PrimaryMarketplace.MarketplaceType:Da.PrimaryMarketplace.MarketplaceType,null===(Na=Da.AssetMarketplace)||void 0===Na?void 0:Na.SolutionId,null,null,Da.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Da.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ra.HelperMethods.Gw(Da)}`);sb&&(Kb.Yta=sb);this.Af.push(Kb);this.Yxa=null;this.N6a(Da.InstanceId)||(Da=String.format("{0}|{1}|{2}|{3}|{4}",Da.PrimaryMarketplace.SolutionId,Da.PrimaryMarketplace.SolutionVersion,
Da.PrimaryMarketplace.MarketplaceRef,Da.PrimaryMarketplace.MarketplaceType,Da.WebExtensionType),this.raiseEvent("ci",Da))}}hGj(Da,Na){Da.TaskpaneWidth=this.e7b;Da.TaskpaneVisible=!0;const sb={};sb.SolutionId=Da.PrimaryMarketplace.SolutionId;sb.TargetType=Da.WebExtensionType;sb.Version=Da.PrimaryMarketplace.SolutionVersion;sb.StoreType=Da.PrimaryMarketplace.MarketplaceType;sb.StoreId=Da.PrimaryMarketplace.MarketplaceRef;ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)?Da.AssetMarketplace?(sb.AssetId=Da.AssetMarketplace.SolutionId,sb.AssetStoreId=Da.AssetMarketplace.MarketplaceRef):(sb.AssetId=null,sb.AssetStoreId=null):(sb.AssetId=Da.PrimaryMarketplace.SolutionId,sb.AssetStoreId=Da.PrimaryMarketplace.MarketplaceRef);sb.Width=Da.TaskpaneWidth;const Kb=new Jb(this,this.hi,Da,!0);Kb.$md();this.Af.push(Kb);const Yb=()=>{this.jRa(Kb.controlId);this.Xh.purgeOsfControl(Kb.controlId,!1);Na()};let vc=null;vc=Qe.a.instance.ZC(()=>{Kb.Dy&&(da.a.Ia(vc),vc=null,this.Xh.insertBlankControlWithErrorUX(this.VHb(Kb,
sb),Yb))},100,bc.a.ahh)}V$g(Da){if(Da&&Da.length){var Na=[];Da.forEach(sb=>{if(sb.ContainsCustomFunctions){const Kb=ac.Cva(sb,this.$);this.KFd.contains(Kb)||(this.KFd.add(Kb),this.YKf.push(sb));this.X6g(sb)||Na.push(sb)}});Na.length&&this.lGe(Na)}}kIe(Da,Na){this.zn(Da.InstanceId)||(Na=Na(),Da=(new Jb(this,this.hi,Da)).kdf(Na),this.Af.push(Da),this.Yxa=null)}UDj(Da){ac.Y1a.mb(Da)&&ac.Y1a.na(Da).initializeAndShowWithTitle()}o$h(Da){ac.Y1a.mb(Da)&&ac.Y1a.na(Da).hide()}EXh(Da){var Na=null;let sb,Kb,
Yb=null;sb=ac.rjd(Da,!0);if(!sb)return e.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),V.Task.Ta(null);(Kb=this.Im.getOsfControl(ac.getSolutionId(sb,this.$)))&&(Na=Kb.getManifest())&&(Yb=Na.getSharedRuntimeForCustomFunctions("Workbook"));if(Na=Yb&&1===Yb.LifeTime?this.WWe(sb.PrimaryMarketplace.SolutionId,sb.PrimaryMarketplace.MarketplaceRef,sb.PrimaryMarketplace.MarketplaceType,Yb):this.pFh(Da))return V.Task.Ta(Na.controlId);const vc=
new ha.a;Ra.HelperMethods.Sjc(Yb)&&(sb.SharedRuntime=Yb);Da=Kb?Kb.getNotificationParams():[];if(!Da.length)return this.PGe(sb);this.f7f(Da,()=>{cb.TaskExtensions.Aa(vc.task,()=>{this.PGe(sb)},this.la,3)},()=>{});return vc.task}OLh(Da){Da=ac.rjd(Da,!1);if(!Da)return e.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let Na=null;var sb=this.Im.getOsfControl(ac.getSolutionId(Da,this.$));sb&&(sb=sb.getManifest())&&(Na=sb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
return Ra.HelperMethods.Sjc(Na)&&(Da=this.WWe(Da.PrimaryMarketplace.SolutionId,Da.PrimaryMarketplace.MarketplaceRef,Da.PrimaryMarketplace.MarketplaceType,Na))?Da.controlId:null}p9g(Da,Na){var sb=ac.rjd(Da,!1);if(sb){var Kb=null,Yb=this.Im.getOsfControl(ac.getSolutionId(sb,this.$));Yb&&(Yb=Yb.getManifest())&&(Kb=Yb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Ra.HelperMethods.Sjc(Kb)){sb.SharedRuntime=Kb;var vc=sb.PrimaryMarketplace.SolutionId;Yb=sb.PrimaryMarketplace.SolutionVersion;
var ad=OSF.OsfManifestManager.getCachedManifest(vc,Yb);if(ad)if(this.f0b.mb(Da))Kb=this.f0b.na(Da),cb.TaskExtensions.Aa(Kb,Qd=>{(Qd=Qd.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Qd,Na,this.hi.HLb)},this.la,3);else{var ld={};ld.solutionId=vc;ld.version=Yb;ld.storeType=sb.PrimaryMarketplace.MarketplaceType;ld.storeId=sb.PrimaryMarketplace.MarketplaceRef;ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?sb.AssetMarketplace?(ld.assetId=
sb.AssetMarketplace.SolutionId,ld.assetStoreId=sb.AssetMarketplace.MarketplaceRef):(ld.assetId=null,ld.assetStoreId=null):(ld.assetId=vc,ld.assetStoreId=null);ld.targetType=OSF.OsfControlTarget.TaskPane;var md=new ha.a;sb=cb.TaskExtensions.Sj();sb=new ba.a(this.$,this,ld,sb);Kb=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(vc,Kb.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(ad,Kb,Yb);sb.createUILessSandbox(ld,ad,(Qd,ce)=>{Qd&&!ce?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Qd,
Na,this.hi.HLb),md.setResult(Qd)):md.setResult(null);this.f0b.remove(Da)});this.f0b.ia(Da,md.task)}}}else e.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}hBe(Da){(Da=this.HWe(Da))&&(Da.wl.SharedRuntime||this.sJb(Da.controlId))}sJb(Da){(Da=this.HWe(Da))&&this.jRa(Da.controlId)}jmh(Da,Na){if(!this.Af||!Da||!Na)return!1;if(Da.toLowerCase()===Na.toLowerCase())return!0;let sb=null,Kb=null;for(let Yb=0,vc=this.Af.length;Yb<vc;Yb++){const ad=this.Af[Yb];
if(ad.ownerAddinSolutionId&&(ad.controlId===Da&&(sb=ad.ownerAddinSolutionId.toLowerCase()),ad.controlId===Na&&(Kb=ad.ownerAddinSolutionId.toLowerCase()),sb&&Kb))break}return sb&&sb===Kb?!0:!1}qHg(Da){this.zn(Da.InstanceId)||(Da=new Jb(this,this.hi,Da),this.Af.push(Da),this.Yxa=null)}wTf(Da){if(this.Af&&0<=Da&&Da<this.Af.length){const Na=this.Af[Da],sb=Na.Dy;this.Af.splice(Da,1);this.nAf(Na);Ca.DOMElementExtensions.uf(sb)}}jRa(Da){if(this.Af)for(let Na=0,sb=this.Af.length;Na<sb;Na++)if(this.Af[Na].controlId===
Da){this.wTf(Na);break}}eej(Da){if(this.Af){Da=Da.toLowerCase();for(let Na=0,sb=this.Af.length;Na<sb;Na++)if(Da===this.Af[Na].ownerAddinSolutionId.toLowerCase()){this.wTf(Na);break}}}QRg(Da){Da.Pi&&(this.zn(Da.floatingObject.wl.InstanceId)||(this.Hgc(Da.floatingObject.wl.InstanceId)||this.Aqc.push(Da.floatingObject.wl.InstanceId),this.HIa(Da.floatingObject.wl)),this.ea.isNamedObjectViewMode&&this.lRg(Da.floatingObject.wl.InstanceId,Da.Jd))}Jaa(Da){if(this.Af)for(let Na=0,sb=this.Af.length;Na<sb;Na++)if(1===
this.Af[Na].controlType&&Od.a.equals(this.Af[Na].pU,Da,!0))return this.Af[Na].controlId;return null}REh(Da){const Na=[];if(this.Af)for(let sb=0,Kb=this.Af.length;sb<Kb;sb++)Od.a.equals(this.Af[sb].pU,Da,!0)&&Na.push(this.Af[sb].controlId);return Na}wFh(Da,Na){if(!Na||!Da)return null;if(this.Af)for(let sb=0,Kb=this.Af.length;sb<Kb;sb++)if(1===this.Af[sb].controlType&&Od.a.equals(this.Af[sb].pU,Da,!0)&&this.Af[sb].wl.SharedRuntime&&Od.a.equals(this.Af[sb].wl.SharedRuntime.Resid,Na.Resid,!0))return this.Af[sb].controlId;
return null}j4a(Da,Na=null){return Da?Na?`${Da}.${Na}`:Da:""}kBe(Da,Na,sb){if(this.Yxa===Da)return!0;this.Yxa=Da;let Kb=null,Yb=!1;if(!Kb&&this.Af)for(let vc=0,ad=this.Af.length;vc<ad;vc++)if(1===this.Af[vc].controlType&&Od.a.equals(this.Af[vc].pU,Da,!0)){let ld=!1,md=!1;Na?(ld=!0,md=!!this.Af[vc].wl.SharedRuntime&&Od.a.equals(this.Af[vc].wl.SharedRuntime.Resid,Na.Resid,!0)):sb&&(ld=!0,md=Od.a.equals(this.Af[vc].wl.SharedRuntimeId,sb,!0));if(!ld||md){md&&this.Af[vc].wg(!0);Kb=this.Af[vc].controlId;
Yb=!0;this.Yxa=null;break}}Kb&&this.raiseEvent("ca",Kb);return Yb}setAppRuntimeState(Da,Na){var sb;if(Da){const Kb=this.zn(Da);if(Kb&&Ra.HelperMethods.Gw(Kb.wl))Kb.wg(Na),Na&&(this.raiseEvent("ca",Da),(null===(sb=Kb.Dy)||void 0===sb?0:sb.firstChild)&&(Da=Kb.Dy.firstChild.title)&&0<Da.length&&this.d1b.nrj(Da));else throw e.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(se.a.instance.ga(2244));}else throw e.ULS.sendTraceTag(537170564,0,15,
"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(se.a.instance.ga(2245));}getAppRuntimeState(Da){if(Da)if((Da=this.zn(Da))&&Ra.HelperMethods.Gw(Da.wl))Da=Da.wl.TaskpaneVisible;else throw e.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(se.a.instance.ga(2244));else throw e.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(se.a.instance.ga(2245));return Da}G3a(Da,Na){return(Da=
this.zn(Da))?Da.G3a(Na):null}N6a(Da){return this.mBe(this.Aqc,Da)}Hgc(Da){return this.mBe(this.YIe,Da)}toe(Da){this.YIe.push(Da)}FZ(Da){return(Da=this.zn(Da))?Da.wl:null}IAd(Da){this.raiseEvent("ekros",Da,this)}hEd(Da){if(Da){var Na=this.zn(Da.InstanceId);Na&&(Da.SharedRuntime||Da.SharedRuntimeId||(this.jRa(Na.controlId),this.Xh.purgeOsfControl(Na.controlId,!1)),Na={},Na.SolutionId=Da.PrimaryMarketplace.SolutionId,Na.TargetType=Da.WebExtensionType,Na.Version=Da.PrimaryMarketplace.SolutionVersion,
Na.StoreType=Da.PrimaryMarketplace.MarketplaceType,Na.StoreId=Da.PrimaryMarketplace.MarketplaceRef,ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Da.AssetMarketplace?(Na.AssetId=Da.AssetMarketplace.SolutionId,Na.AssetStoreId=Da.AssetMarketplace.MarketplaceRef):(Na.AssetId=null,Na.AssetStoreId=null):(Na.AssetId=Da.PrimaryMarketplace.SolutionId,Na.AssetStoreId=Da.PrimaryMarketplace.MarketplaceRef),Na.Width=Da.TaskpaneWidth,Na.SharedRuntimeId=Da.SharedRuntimeId,
this.$dg(Na))}}Tia(){this.hi.Tia()}cN(Da,Na,sb){this.hi.cN(Da,Na,sb)}fXe(Da,Na){Na=ac.Fdh(Na);Da=this.FZ(Da);this.hi.cac(Da.InstanceId,2202,va.a.XW,Na)}icd(Da){for(let Na=0,sb=this.Af.length;Na<sb;Na++)this.fXe(this.Af[Na].controlId,Da)}HFh(Da,Na){Na=ac.V9g(Na);this.hi.cac(Da,65539,"",Na)}JFh(Da,Na,sb){this.hi.cac(Da,1,Na,sb)}GFh(Da,Na){this.hi.KFh(Da,Na)}m9g(Da,Na){return[[2,1E3,"",JSON.stringify([Da,Na]),0,!1]]}Oii(){return!!this.Ana&&this.Ana.n$e()}b2g(){this.Ana&&this.Ana.clear()}IFh(){if(this.Ana&&
this.Ana.n$e()){var Da=this.Ana.QLh();for(const Na of Da){Da=this.REh(Na);for(const sb of Da)this.hi.cac(sb,65540,"","{}")}}}Uaj(Da){this.Ana.add(Da)}DTj(Da){this.Ana.remove(Da)}kja(Da){if(!this.Af)return null;for(const Na of this.Af)if(Da(Na))return Na;return null}PGe(Da){const Na=new ha.a,sb=ac.Cva(Da,this.$);if(Ra.HelperMethods.Gw(Da))e.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.VKf(Da,Kb=>{Kb?(Da.InstanceId=Kb.InstanceId,Da.WebExtensionOsfControlType=
3,Da.TaskpaneVisible=!1,this.HIa(Da),Na.setResult(Da.InstanceId)):(e.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da.PrimaryMarketplace.SolutionId,Da.PrimaryMarketplace.MarketplaceType,null,null,null,Da.PrimaryMarketplace.MarketplaceRef)} failed`),Na.setException(Error.create("Null insert data")))});else{ac.Y1a.ia(Da.InstanceId,new M.a);const Kb=ac.Y1a.na(Da.InstanceId).Fia;this.U$g(Da,Kb,sb);this.VKf(Da,null);Na.setResult(Da.InstanceId)}return Na.task}U$g(Da,
Na,sb){this.zn(Da.InstanceId)||(Da=new Jb(this,this.hi,Da),Da.Yta=sb,Da.kdf(Na),this.Af.push(Da),this.Yxa=null)}VKf(Da,Na){const sb=ac.Cva(Da,this.$);if(!this.KFd.contains(sb))this.vHb.push(Da),1<=this.vHb.length&&this.WKf(Da,Na);else if(Na)for(const Kb of this.YKf)if(ac.Cva(Kb,this.$)===sb){Na(Kb,0);break}}WKf(Da,Na){let sb=null;const Kb={};Kb.SolutionId=ac.getSolutionId(Da,this.$);Kb.TargetType=Da.WebExtensionType;Kb.Version=Da.PrimaryMarketplace.SolutionVersion;Kb.StoreType=Da.PrimaryMarketplace.MarketplaceType;
Kb.StoreId=Da.PrimaryMarketplace.MarketplaceRef;ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Da.AssetMarketplace?(Kb.AssetId=Da.AssetMarketplace.SolutionId,Kb.AssetStoreId=Da.AssetMarketplace.MarketplaceRef):(Kb.AssetId=null,Kb.AssetStoreId=null):(Kb.AssetId=Da.PrimaryMarketplace.SolutionId,Kb.AssetStoreId=Da.PrimaryMarketplace.MarketplaceRef);Kb.Width=Da.TaskpaneWidth;Kb.ContainsCustomFunctions=!0;Ra.HelperMethods.Gw(Da)&&(Kb.SharedRuntimeId=Da.SharedRuntime.Resid);
const Yb=this.$.pa.ya;Da=this.$.pa.ya.Wb();const vc=Yb.Na(9,Da);vc.sharedInfo=Kb;const ad=md=>{md=vd.a.Pe(md.data);e.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Vd.a.sc(md)}`)},ld=md=>{md&&!Ed.a(md)||e.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Kb.SolutionId,Kb.StoreType,Kb.AssetId,null,null,Kb.StoreId)} finish with errors: ${Vd.a.sc(md.Errors)}`);
this.vHb.shift();0<this.vHb.length&&this.WKf(this.vHb[0],Na)};if(Na){const md=Qd=>{const ce=Qd.Result;(sb=ce?ce.AgaveData:null)||Na(null,Qd.Errors?Qd.Errors[0].ErrorCause:5001);Na(sb,0)};Da=(Qd,ce,ec)=>Ke.g(Yb,"InsertAgaveTaskpane",vc,Le.b(Qd,ld,md),Le.a(ce,ad),ec,null,0)}else Da=(md,Qd,ce)=>Ke.g(Yb,"InsertAgaveTaskpane",vc,Le.b(md,ld),Le.a(Qd,ad),ce,null,0);Hd.a(this.$.userOperationManager,Da,md=>new xe.a(519,0,md,64),null)}WAj(){return this.$.ie.get(35)}dLd(Da){Da=this.zn(Da);(null===Da||void 0===
Da?0:Da.Uda)&&Da.GTf()}aIi(Da){var Na=this.kja(sb=>ac.WMa(sb.pU));Na&&(Na=this.Xh.getOsfControl(Na.controlId))&&Na.notifyAgave(OSF.AgaveHostAction.SendMessage,Da)}Aji(){return!!this.kja(Da=>1===Da.controlType&&ac.WMa(Da.pU))}zji(){const Da=this.kja(Na=>ac.WMa(Na.pU));return Da?Da.Dy?Ca.DOMElementExtensions.isVisible(Da.Dy):!1:!1}zuj(){const Da=this.kja(Na=>ac.WMa(Na.pU));Da&&(Da.wg(!0),this.raiseEvent("ca",Da.controlId))}initialize(){const {DdaEventDispatch:Da}=a(1365),Na=void 0===this.$||null===
this.$||ta.EwaSettings.ma(257);void 0!==this.$&&null!==this.$||e.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Na&&e.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(dd.hHa(this.$),this.ea=this.$.ea,this.hi=new Da(this.$),this.$.ml(this.dd),this.ea.Uj(this.Tc),this.ea.uM(this.Oo),this.ea.ku(this.zf),this.$.userOperationManager.ur(this.DR),this.jpf(),this.qSi(),this.Odi(),this.$.da.Ga(35,
this),this.yXc.ka(this),Na&&e.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.qie=new va.a,Na&&e.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.tie=new Sa(this.$,this.jj,this.hi),new ob(this.$,this.jj,this.hi),this.rie=new za(this.$,this.jj,this.hi),this.oie=new jc(this.$,this.jj,this.hi),this.nie=new Ma(this.$,this.jj,this.hi),this.sie=new Cc(this.$,this.jj,this.hi),this.uie=new Fa(this.$,this.jj,this.hi),this.vie=
new Ab(this.$,this.jj,this.hi),this.$.GV&&(this.wie=new Rb(this.$,this.jj,this.hi)),ta.EwaSettings.ma(188)&&(this.e2a=new Va(this,qa.h(this.$))),ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.mie=new Ob),this.initialized=!0,e.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}CFh(Da){if(!this.SCa)return null;for(let Na=0,sb=this.SCa.length;Na<sb;Na++)if(Da.startsWith(this.SCa[Na].WebExtensionId))return this.SCa[Na];return null}jpf(){var Da,
Na=this.ea;if(Na.Zb&&!this.iRb){if(Na.workbookContext){if(this.xUc=this.$.ea.Wg.get(22),null===(Da=Na.workbookContext.WebExtensions)||void 0===Da?0:Da.length){Da=Na.workbookContext.WebExtensions;Na=!1;for(let sb=Da.length-1;0<=sb;sb--){if(!this.ea.isNamedObjectViewMode){this.Aqc.push(Da[sb].InstanceId);if(1!==Da[sb].WebExtensionType){Da.splice(sb,1);continue}if(Ra.HelperMethods.Gw(Da[sb])&&0!==Da[sb].SharedRuntime.State)1===Da[sb].SharedRuntime.State?Da[sb].TaskpaneVisible=!1:2===Da[sb].SharedRuntime.State?
Da[sb].TaskpaneVisible=!0:e.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Da[sb].ContainsCustomFunctions&&!Da[sb].TaskpaneVisible&&!lb.a(Da[sb])){Da.splice(sb,1);continue}}const Kb=OSF.OsfControl.isFirstPartyStoreString(Da[sb].PrimaryMarketplace.MarketplaceType);if(ta.EwaSettings.ma(184)&&!Kb&&(Da.splice(sb,1),!Na)){Na=!0;const Yb=xb.GetServiceTaskFactory.Oa(this.$.da,5,4,3);cb.TaskExtensions.Aa(Yb,()=>{Yb.result.ng(36,null)},this.la,3)}ta.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&
Da[sb].PrimaryMarketplace&&ac.WMa(Da[sb].PrimaryMarketplace.SolutionId)&&(e.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Da.splice(sb,1))}this.lGe(Da)}}else this.xUc=!1;this.iRb=!0}}L8e(Da){const Na=qa.h(this.$),sb=Na.ha.Sa.$b;if(sb&&Da){Da=!1;if(this.Af)for(const Kb of this.Af)if(ac.WMa(Kb.pU)||ac.Gmi(Kb.pU)){Da=!0;break}Da||Na.ha.Sa.xH(sb)}}qSi(){this.Xh&&this.ea.isNamedObjectViewMode&&this.$.oa&&Ub.o(this.$.oa)&&(this.$.da.za(34).aR?this.$.da.za(34).pnd():
this.$.da.za(34).jv(this.iYi))}lGe(Da){let Na=null;Na=sb=>{const Kb=sb.WebExtensionData,Yb=sb.IsTaskPane,vc=sb.RecordHandler,ad=()=>{this.hQa.shift();0<this.hQa.length&&Na(this.hQa[0])};if(this.Jaa(Kb.PrimaryMarketplace.SolutionId))ad();else{Yb&&(Kb.WebExtensionOsfControlType=1);var ld=lb.a(Kb);if(!Yb||Kb.TaskpaneVisible||ld||Kb.SharedRuntime&&0!==Kb.SharedRuntime.State||Kb.ContainsCustomFunctions){var md=new Jb(this,this.hi,Kb,!Yb);e.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Kb.PrimaryMarketplace.SolutionId,
Kb.PrimaryMarketplace.MarketplaceType,null,null,null,Kb.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Kb.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ra.HelperMethods.Gw(Kb)}`);md.$md();Ra.HelperMethods.Gw(Kb)&&(md.Yta=ac.Cva(Kb,this.$),Kb.TaskpaneWidth=this.e7b);ld&&(Kb.WebExtensionToolTip="");Yb&&Kb.TaskpaneVisible&&!ld&&(Kb.TaskpaneWidth=this.e7b);this.Af.push(md);var Qd=this.Yxa=null;Qd=Qe.a.instance.ZC(()=>{md.Dy&&(da.a.Ia(Qd),Qd=null,vc&&vc(sb,md),ad())},100,bc.a.$gh)}else ad()}};
for(let sb=0;sb<Da.length;sb++)if(!this.zn(Da[sb].InstanceId))if(1!==Da[sb].WebExtensionType)this.HIa(Da[sb]);else if(!ta.EwaSettings.ma(53))this.xnb(Da[sb],Na);else if(this.$.qd&8388608||Da[sb].TaskpaneVisible){const Kb={};ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)&&(Kb.solutionId=Da[sb].PrimaryMarketplace.SolutionId,Kb.version=Da[sb].PrimaryMarketplace.SolutionVersion);Kb.marketplaceId=Da[sb].PrimaryMarketplace.SolutionId;Kb.marketplaceVersion=Da[sb].PrimaryMarketplace.SolutionVersion;
Kb.storeType=Da[sb].PrimaryMarketplace.MarketplaceType;Kb.storeId=Da[sb].PrimaryMarketplace.MarketplaceRef;Kb.targetData=Da[sb];this.Xh.isAddinCommandsAsync(Kb,(Yb,vc,ad)=>{if(Yb){var ld=ad.targetData;if(vc){if(ta.EwaSettings.ma(87))if(Kb.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Yb=Kb.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),vc=Kb.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Yb||vc)&&Ra.HelperMethods.Gw(ld)&&this.xnb(ld,
Na);else if(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.l7h(ad,Na);else{let md=!1;this.sda(Qd=>{if(!Qd.errorCode){if(Qd.value)for(const ce of Qd.value){if(md)break;md=He.e(ce[1])===He.e(ld.PrimaryMarketplace.SolutionId)}md?Ra.HelperMethods.Gw(ld)&&this.xnb(ld,Na):(Qd={},ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Qd.SolutionId=ad.solutionId,Qd.Version=ad.version):(Qd.SolutionId=ad.marketplaceId,
Qd.Version=ad.marketplaceVersion),Qd.StoreType=ld.PrimaryMarketplace.MarketplaceType,Qd.StoreId=ad.storeId,ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Qd.AssetId=null,Qd.AssetStoreId=null):(Qd.AssetId=ad.marketplaceId,Qd.AssetStoreId=ad.storeId),Qd.Width=ld.TaskpaneWidth,Qd.TargetType=ld.WebExtensionType,ld.TaskpaneVisible=!0,this.dne(Qd,ld,Na))}},!0)}}else this.xnb(ld,Na)}else Yb=ad.targetData,e.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Yb.PrimaryMarketplace.SolutionId,
Yb.PrimaryMarketplace.MarketplaceType,null,null,null,Yb.PrimaryMarketplace.MarketplaceRef)} from ${Yb.PrimaryMarketplace.MarketplaceType} during document loading`)})}}l7h(Da,Na){let sb=!1;this.sda(Kb=>{const Yb=Da.targetData;if(!Kb.errorCode){if(Kb.value)for(const vc of Kb.value){if(sb)break;sb=He.e(vc[1])===He.e(Yb.PrimaryMarketplace.SolutionId)}sb?Ra.HelperMethods.Gw(Yb)&&this.xnb(Yb,Na):(Kb={},ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Kb.SolutionId=
Da.solutionId,Kb.Version=Da.version):(Kb.SolutionId=Da.marketplaceId,Kb.Version=Da.marketplaceVersion),Kb.StoreType=Yb.PrimaryMarketplace.MarketplaceType,Kb.StoreId=Da.storeId,ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Kb.AssetId=null,Kb.AssetStoreId=null):(Kb.AssetId=Da.marketplaceId,Kb.AssetStoreId=Da.storeId),Kb.TargetType=Yb.WebExtensionType,Kb.Width=Yb.TaskpaneWidth,Yb.TaskpaneVisible=!0,this.dne(Kb,Yb,Na))}},!0)}xnb(Da,Na){const sb={};sb.WebExtensionData=
Da;sb.IsTaskPane=!0;this.hQa.push(sb);1===this.hQa.length&&Na(sb)}dne(Da,Na,sb){const Kb={};Kb.ActivationInfo=Da;Kb.WebExtensionData=Na;Kb.IsTaskPane=!1;Kb.RecordHandler=(Yb,vc)=>{const ad=Yb.ActivationInfo;this.Xh.insertBlankControlWithErrorUX(this.VHb(vc,ad),()=>{this.jRa(vc.controlId);this.Xh.purgeOsfControl(vc.controlId,!1);this.$dg(ad)})};this.hQa.push(Kb);1===this.hQa.length&&sb(Kb)}$dg(Da){var Na={};Na.solutionId=Da.SolutionId;Na.version=Da.Version;Na.storeType=Da.StoreType;Na.storeId=Da.StoreId;
Na.assetId=Da.AssetId;Na.assetStoreId=Da.AssetStoreId;Na.targetType=Da.TargetType;Na.sharedRuntimeId=Da.SharedRuntimeId;Da=new La.a;Da.add(Na);Na={};Na[U.a.yob]=Da;Na[U.a.wM]=3;Da=new Wa.a(Xe.a.RCb,0,this.$.Hc,0,null);this.$.Ja.Kb(Da,Na)}VHb(Da,Na){const sb={};sb.div=Da.Dy;sb.id=Da.controlId;sb.solutionId=Na.SolutionId;sb.version=Na.Version;sb.storeId=Na.StoreId;sb.storeType=Na.StoreType;sb.osfControlType=OSF.OsfControlTarget.TaskPane;return sb}vXf(){if(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const sb=
[];for(var Da=0;Da<this.Af.length;Da++){var Na=this.Af[Da];0!==Na.osfControlType&&3!==Na.osfControlType&&4!==Na.osfControlType||sb.push(Na)}Da=!1;for(Na=0;Na<sb.length;Na++){const Kb=sb[Na];this.jRa(Kb.controlId);!Da&&Kb&&Kb.wl&&(Da=Ra.HelperMethods.Gw(Kb.wl))}Da&&this.yK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}ta.EwaSettings.ma(396)&&cb.TaskExtensions.Aa(xb.GetServiceTaskFactory.Oa(this.$.da,278,279,3),sb=>{sb&&(sb=sb.result)&&(this.$.da.za(278)||this.$.da.Ga(278,sb),sb.uef().Fna())},
this.la,3)}rL(){var Da=new nb(this.$,this.jj,this.wYf);void 0===this.$||null===this.$?e.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):ta.EwaSettings.ma(257)&&e.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.jj||null===this.jj));if(Da.RGi()){const Na=()=>{},sb=Yb=>{Yb=vd.a.Pe(Yb.data);e.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Vd.a.sc(Yb)}.`)},
Kb=Da.FWg();Da=ac.hhd(Kb);Da|=64;this.$.userOperationManager.kD(new xe.a(507,0,(Yb,vc,ad)=>Ke.g(this.$.pa.ya,"ExecuteRichApiRequest",this.GWg(Kb),Le.b(Yb,Na),Le.a(vc,sb),ad,null,0),Da))}}GWg(Da){const Na=this.$.pa.ya.Na(1);Na.request=Da;return Na}mBe(Da,Na){if(Da)for(let sb=0;sb<Da.length;sb++)if(Od.a.equals(Da[sb],Na,!0))return!0;return!1}IVg(Da){const Na={};Na.navigationMode=OSF.OsfNavigationMode.DefaultMode;Na.assetId=null;Na.category=null;if(!Da||3>Da.length)return Na;if(Da[0]){const sb=parseInt(Da[0],
10);isNaN(parseInt(sb,10))||(Na.navigationMode=sb)}Da[1]&&(Na.assetId=Da[1]);Da[2]&&(Na.category=Da[2]);return Na}Odi(){if(ta.EwaSettings.ma(61)){var Da=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Da&&"*"!==Da.trim()){this.FJa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new gb(this),Da,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.ie.get(2));try{this.FJa.init()}catch(Na){try{this.FJa.dispose()}catch(sb){}this.FJa=null;e.ULS.sendTraceTag(537170510,
0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Na.message)}Da={};Da.a=this.$.va.UserSessionId;fe.b().Qe(39,Da)}}}f7f(Da,Na,sb){const Kb=ac.VUg(Da[0]),Yb=Kb.Hha,vc=Kb.Hia;Kb.Hha=()=>{Yb&&Yb();const ad=Kb.yMa!==OSF.InfoType.Error?Na:null;Da.shift();Da.length?this.f7f(Da,ad,sb):ad&&ad()};Kb.Hia=()=>{vc&&vc();sb&&Kb.yMa!==OSF.InfoType.Error&&sb()};Q.a.dUd(Kb)}nUh(){const Da={};Da.AddinRibbonControlsOverriddenByApi=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
Da.AddinActionDefinitionHybridMode=ta.EwaSettings.ma(631).toString();Da.UseActionIdForUILessCommand=ta.EwaSettings.ma(634).toString();Da.AllowStorageAccessByUserActivationOnIFrame=ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Da.RequirementSetRibbonApiOnePointTwo=ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Da.flightingTreatmentVariables=t.AFrameworkApplication.fa.kac;
Da.ShortcutInfoArrayInUserPreferenceData=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return Da}static get c5b(){return ac.Z6d}static set c5b(Da){ac.Z6d=Da}static getSolutionId(Da){let Na=Da.PrimaryMarketplace.SolutionId;ta.EwaSettings.ma(289)&&Da.OwnerAddinSolutionId&&(Na=Da.OwnerAddinSolutionId);return Na}static hhd(Da){let Na=0;ta.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Da.RequestFlags&1&&256!==
(Da.RequestFlags&256)||(Na=16):Na=Da.RequestFlags&1?0:16;return Na}static Cva(Da,Na){Na=ac.getSolutionId(Da,Na);return ac.V0e(Na,Da.PrimaryMarketplace.SolutionVersion,Da.PrimaryMarketplace.MarketplaceType,Da.PrimaryMarketplace.MarketplaceRef)}static Fdh(Da){return JSON.stringify({["recording"]:Da})}static V9g(Da){const Na={};Na.visibility=Da?"Visible":"Hidden";return JSON.stringify(Na)}static rQh(Da){let Na=Da.getSolutionId(),sb=Da.getVersion(),Kb=Da.getStoreType();Da=Da.getStoreId();return ac.V0e(Na,
sb,Kb,Da)}static V0e(Da,Na,sb,Kb){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",Da,Na,ac.n1h(sb).toString(),Kb)}static rjd(Da,Na){var sb=Da.split("|");if(7>sb.length)return e.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==sb[0])return e.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${sb[0]}'.`),null;let Kb=sb[1];const Yb=sb[2],vc=ac.o1h(sb[3]),ad=sb[4];sb=
sb[5];Kb&&Kb.length||(Kb=sb);sb={};sb.InstanceId=String.format("{{{0}}}",O.a.create().toString());sb.WebExtensionOsfControlType=4;sb.WebExtensionType=1;sb.PrimaryMarketplace={};sb.PrimaryMarketplace.SolutionId=Kb;sb.PrimaryMarketplace.SolutionVersion=Yb;sb.PrimaryMarketplace.MarketplaceRef=ad;sb.PrimaryMarketplace.MarketplaceType=vc;sb.ContainsCustomFunctions=Na?!0:!1;Na&&(sb.OsfPropertyBag=[["customFunctionAddinId",Da]]);return sb}static o1h(Da){Da=parseInt(Da,10);return Da===OSF.StoreTypeEnum.MarketPlace?
OSF.StoreType.OMEX:Da===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Da===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:Da===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Da===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Da===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Da===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Da===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Da===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Da===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:Da===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static n1h(Da){return Da===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Da===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Da===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Da===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Da===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Da===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Da===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
Da===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:Da===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Da===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Da===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}static Jsb(Da){const Na={};Na.Version=Da.version;Na.AssetId=Da.assetId;ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Na.AssetStoreId=Da.assetStoreId:Na.AssetStoreId=null!==Da.assetStoreId?
Da.assetStoreId.toString():null;Na.StoreType=Da.storeType;Na.Height=Da.height;Na.SolutionId=Da.solutionId;Na.StoreId=Da.storeId;Na.TargetType=Da.targetType;Na.Width=1===Na.TargetType?0:Da.width;Na.SharedRuntimeId=Da.sharedRuntimeId;return Na}static tAb(Da){return Da===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Da===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Da===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Da===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Da===
OSF.DDA.EventDispId.dispidRichApiMessageEvent||Da===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||Da===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||Da===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static VUg(Da){return Object(b.a)(new gf.a,{yMa:Da.infoType,id:Da.id,title:Da.title,description:Da.description,buttonText:Da.buttonTxt,Hha:Da.buttonCallback,hfc:Da.highPriority,Hia:Da.dismissCallback,errorCode:Da.errorCode,rcf:Da.iframeNotificationUrl})}static WMa(Da){let Na=
"FA000000014"===Da;Na||(Na="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Da);return Na}static Gmi(Da){return"FA000000005"===Da}}ac.Y1a=new G.a;ac.Z6d=!0;Object(c.a)(ac,"DdaFacade",Ia.a,[307,736,678,737,738,2])},738:function(u,E,a){a.d(E,"a",function(){return e});u=a(0);var c=a(15),b=a(111);class e{constructor(){this.AKd=0;this.IW={};this.zta={}}JXh(f,d){return this.IW[e.s_c(f,d)]}xOe(f,d){d||void 0!==this.zta[f]&&null!==this.zta[f]?d&&void 0!==this.zta[f]&&null!==this.zta[f]&&delete this.zta[f]:
this.zta[f]=1}X0b(f){return void 0===this.zta[f]||null===this.zta[f]}p6h(f){const d=e.s_c(f.messageType,f.targetId);1===f.actionType?this.L7h(f.controlId,f.messageType,d):2===f.actionType&&this.v8h(f.controlId,f.messageType,d)}Hdj(f){if(f){var d=Object.keys(this.IW);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.IW[h],d[f]&&(delete d[f],Object.keys(d).length||delete this.IW[h])}}n_(f,d){f=e.s_c(f,d);f=this.IW[f];return!!f&&0<Object.keys(f).length}s9h(){return!b.a.isEmpty(this.IW)}Dlf(){return 0<
this.AKd}aSh(){const f=[],d=this.IW;for(let l in d){var h=l,m=d[l];for(let w in m){m=w;const n={};n.eventType=parseInt(h.split("#")[0],10);n.targetId=h.split("#")[1];n.addinId=m;f.push(n)}}return f}L7h(f,d,h){if(this.IW[h])h=this.IW[h],h[f]=h[f]?h[f]+1:1;else{let m={};m[f]=1;this.IW[h]=m}100===d&&this.AKd++}v8h(f,d,h){if(this.IW[h]){const m=this.IW[h];if(f){const l=m[f];1===l?(delete m[f],Object.keys(m).length||delete this.IW[h]):m[f]=l-1;100===d&&this.AKd--}else c.ULS.sendTraceTag(537170459,0,50,
`The OsfControl[${f}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static s_c(f,d){return String.format("{0}#{1}",f,d)}}e.XW="Workbook";Object(u.a)(e,"RichApiEventRegistration",null,[])},765:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{constructor(b,e,f,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=e;this.ddaBinding=
f;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(u.a)(c,"DdaEventArgs",null,[])},813:function(u,E,a){u=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(u.a)(c,"AddInDataTransferObject",null,[]);a.d(E,"a",function(){return b});class b{constructor(e,f,d){this.JRb=e;this.Spg=f;this.Tpg=d}get kt(){return this.JRb}get MGg(){return this.Spg}get NGg(){return this.Tpg}static g4a(e){return(e=e.dW)?Object.assign(new c,{tabs:e.kt.toArray(),
id:e.MGg,title:e.NGg}):null}}Object(u.a)(b,"OneLineRibbonExtensibility",null,[])},844:function(u,E,a){a.r(E);u=a(0);var c=a(187),b=a(15),e=a(98);class f{constructor(){this.startTime=0;this.callback=null}}Object(u.a)(f,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(u.a)(d,"AccessTokenInformation",null,[261]);var h=a(961);class m{constructor(){this.token=null;this.expiresOn=0;this.uha=this.authChallenge=null}}Object(u.a)(m,"CachedTokenInfo",null,[]);class l{constructor(){this.mSb=
new c.a;this.l$=this.k$=!1;this.Ooa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Rre=null}get callbacks(){return this.mSb}}Object(u.a)(l,"SSORequestInfo",null,[]);class w extends l{constructor(){super();this.errorCode=0}}Object(u.a)(w,"SSOFailedRequestInfo",l,[]);var n=a(4);class y{constructor(L,T,O,G){this.oT=new c.a;this.WG=new c.a;this.Qpa=null;this.Ulb=new c.a;this.Uce=Promise.resolve(null);this.dke=!1;this.bXb=T;this.Esg=L;this.Hke=O;this.Xpg=G}WBj(L){if(this.Qpa&&this.Qpa.authChallenge===
L.authChallenge){if(Date.now()/1E3+y.oDi>this.Qpa.expiresOn)return this.Qpa=null,!1;L=new h.a;L.token=this.Qpa.token;L.expiresOn=this.Qpa.expiresOn;L.uha=this.Qpa.uha;L.uUa=!0;L.Jxb=0;this.byb(L);return!0}return!1}AAj(L){for(let T=0;T<this.WG.count;T++)if(this.WG.na(T).authChallenge===L.authChallenge&&this.WG.na(T).Ooa===L.Ooa){let O;(O=this.WG.na(T)).retryCount=O.retryCount+1;L.retryCount=this.WG.na(T).retryCount;if(this.WG.na(T).retryCount<y.NDi||!this.WG.na(T).k$&&L.k$||!this.WG.na(T).l$&&L.l$){if(!this.WG.na(T).k$&&
L.k$||!this.WG.na(T).l$&&L.l$)L.retryCount=0;this.WG.removeAt(T);break}L=new h.a;L.errorCode=this.WG.na(T).errorCode;this.byb(L);return!0}return!1}FIg(L,T){for(let O=0;O<this.WG.count;O++)if(this.WG.na(O).Ooa===L.Ooa&&this.WG.na(O).authChallenge===L.authChallenge)return;this.WG.add(Object.assign(new w,{k$:L.k$,l$:L.l$,authChallenge:L.authChallenge,Ooa:L.Ooa,errorCode:T,retryCount:L.retryCount}))}get resource(){return this.bXb}fed(L,T,O,G,C,H){const {AppsForOfficeSingleSignOnManager:I}=a(844);""===
O&&(O=null);if(this.dke)I.l6(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var M=null;for(let Q of this.oT)if(Q.k$===L&&Q.l$===T&&Q.authChallenge===O&&Q.Ooa===C){M=Q;break}M||(M=Object.assign(new l,{k$:L,l$:T,authChallenge:O,Rre:G,Ooa:C,retryCount:0,startTime:I.Bw()}),this.oT.add(M));M.retryCount=0;M.callbacks.add(H);this.Uce=this.Uce.then(()=>{var {AppsForOfficeSingleSignOnManager:Q}=a(844);if(0<this.oT.count){var U=this.oT.na(0);if(this.WBj(U)||this.AAj(U))return null;
for(let W=0;W<this.Ulb.count;)this.Ulb.na(W)+y.wNj<Q.Bw()?this.Ulb.removeAt(W):W++;if(this.Ulb.count>=y.JDi||this.oT.count>=y.kDi)return U=new h.a,U.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.byb(U),null;let N=null;n.AFrameworkApplication.sa&&(Q=n.AFrameworkApplication.sa.iE)&&(N=Q.Ac("ComponentAttach",this.Esg+y.dCg));return U.Ooa.DEg(this.resource,U.k$,U.l$,U.authChallenge,this.Xpg,U.Rre).then(W=>{N&&N.stop();this.byb(W)},()=>{N&&N.stop();const W=new h.a;W.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.byb(W)})}return null})}}byb(L){const {AppsForOfficeSingleSignOnManager:T}=a(844);try{if(this.oT.count){var O=this.oT.na(0);this.oT.removeAt(0);var G=null;L.errorCode||(G=new d,G.accessToken=L.token);L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||
this.FIg(O,L.errorCode);var C={};null!=L.Jxb&&(C.getTokenSilentTime=L.Jxb.toString());null!=L.Wid&&(C.getTokenPopupTime=L.Wid.toString());null!=L.tgd&&(C.getIDTokenTime=L.tgd.toString());null!=L.uUa&&(C.tokenCached=L.uUa.toString());L.$Xd&&(C.detailedError=L.$Xd);L.uha&&(C.authLibrary=L.uha);O.retryCount&&(C.retryCount=O.retryCount);for(var H of O.callbacks)T.l6(H,L.errorCode,G,C);null!=L.uUa&&L.uUa||this.Ulb.add(O.startTime);if(!L.errorCode)for(null!=L.expiresOn&&(this.Qpa=Object.assign(new m,{token:L.token,
expiresOn:L.expiresOn,authChallenge:O.authChallenge,uha:L.uha})),this.WG.clear(),H=0;H<this.oT.count;)if(this.oT.na(H).authChallenge===O.authChallenge){for(let I of this.oT.na(H).callbacks)T.l6(I,L.errorCode,G,C);this.oT.removeAt(H)}else H++}}catch(I){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",I.message)}}shutdown(){this.dke=!0;this.oT.clear()}}y.wNj=6E4;y.JDi=6;y.kDi=6;y.NDi=3;y.oDi=300;y.dCg="GetAccessToken";Object(u.a)(y,"SSOCallbackManager",null,[]);
var t=a(718),r=a(729),v=a(120),B=a(80),A=a(27),z=a(30),x=a(147),D=a(344);a.d(E,"AppsForOfficeSingleSignOnManager",function(){return J});class J{constructor(L,T,O=null){this.aGc=new e.a;const G=new c.a;T&&G.add(T.TBi);O&&G.addRange(O);this.Im=L;this.eDg=G}ged(L,T,O,G,C,H,I,M,Q,U){U=Object.assign(new f,{startTime:J.Bw(),callback:U});try{const X=!!O&&""!==O;var N=U.startTime;const sa=this.getOsfControl(L);let da=sa.getStoreType()||"",S=sa.getOwnerAddinStoreType()||"",oa=sa.getSolutionId()||"";const K=
sa.getVersion()||"";da=da.toLowerCase();S=S.toLowerCase();oa=oa.toLowerCase();var W=B.a.sgd(T)||"";const ea=B.a.sgd(sa.getIframeUrl())||"",ya=W.toLowerCase()===ea.toLowerCase();W=da;"inmemory"===da&&(W=S);const ha=Telemetry.PrivacyRules.GetPrivacyCompliantId(oa,W,sa.getAssetId(),null,null,sa.getStoreId()),La={["callInstanceId"]:N.toString(),["controlSolutionId"]:ha,["controlVersion"]:K,["storeType"]:da,["ownerStoreType"]:S,["allowConsentPrompt"]:G.toString(),["forMSGraphAccess"]:C.toString(),["allowSignInPrompt"]:H.toString(),
["hasAddinAuthChallenge"]:X.toString(),["securityOriginEqualsSourceLocation"]:ya.toString(),["singleSignOnEnabled"]:I.toString(),["accountTypeFilter"]:M||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",La);x.a.sendTelemetryEvent(Object.assign(new D.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:v.a.Wj(La)}));N=!0;const Ia=n.AFrameworkApplication.fa.Xa("HostAuthType");switch(M){case "aad":N="aad"===Ia;break;case "msa":N="msa"===Ia;break;default:N=!M||"noFilter"===M}if(N){M=
null;if(I)for(let ra of this.eDg)if(ra.bli(oa)){M=ra;break}M?this.isSSOAddin(L)?(I=!0,"omex"===W&&(I=!1),"spapp"===W||"spcatalog"===W?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),J.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):C&&!I?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),J.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,
null)):(C&&"exchange"===W&&(G=!1),this.fed(L,T,O,W,G,H,Q,M,U))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),J.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):J.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else J.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(X){this.xlc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
X.message),J.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(L,T,O,G){this.ged(L,O[t.a.hXc]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,T,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,G)}fed(L,T,O,G,C,H,I,M,Q){this.aGc.mb(L)?G=this.aGc.na(L):(G=new y(L,this.getWebApplicationResource(L).split(",")[0],G,this.getDefaultDisplayName(L)),this.aGc.add(L,G));const U=G.resource;L=J.m_h(U,this.getWebApplicationId(L));const N=OfficeExt.WACUtils.getHostSecure(T);L&&N?L.toLowerCase()===N.toLowerCase()?G.fed(C,H,O,I,M,Q):(J.DOa('SSO Resource "'+U+'" cannot be used from "'+T+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,
344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),J.l6(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(L||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),N||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),J.l6(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}xlc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(L){return this.Im.getOsfControl(L)}isSSOAddin(L){return this.getOsfControl(L).getManifest().isSSOAddin()}getWebApplicationId(L){return this.getOsfControl(L).getManifest().getWebApplicationId()}getWebApplicationResource(L){return this.getOsfControl(L).getManifest().getWebApplicationResource()}getDefaultDisplayName(L){return this.getOsfControl(L).getManifest().getDefaultDisplayName()}static R0h(){try{const L=
{};A.a.Rxa&&r.a.Uyb&&(L.UiHostSupportsAuthTokenAddinList=J.oXe);L.UiHostSupportsAuthToken=r.a.Uyb;return L}catch(L){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",L.message)}return null}static getInstance(L,T,O=null){J.Ma||(J.Ma=new J(L,O));return J.Ma}static DOa(L){window.console.warn&&window.console.warn(L)}static m_h(L,T){if(!L)return"";T||(T="");let O=L.toLowerCase();var G=T.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(G)||
(J.DOa('SSO App Id "'+T+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));O.endsWith(G)||(J.DOa('SSO Resource "'+L+'" does not end with App Id "'+T+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!O.startsWith("https://")&&!O.startsWith("api://"))return J.DOa('SSO Resource "'+L+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(T=0;T<L.length;T++){G=L.charAt(T);const C=z.a.charCodeAt(L,T);if(33>C||126<C||"&"===G||"?"===G||"#"===G||"%"===G||"\\"===G)return J.DOa('SSO Resource "'+L+'" contains an invalid character "'+G+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+G+"' in resource URI."),""}if(0<=L.indexOf("::"))return J.DOa('SSO Resource "'+L+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
L.length)return J.DOa('SSO Resource "'+L+'" is '+L.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+L.length+"."),"";O.startsWith("api://")&&(O="https://"+O.substring(6,O.length));return 8===O.length?"":OfficeExt.WACUtils.getHostSecure(O)||""}static l6(L,T,O,G){var C=L.startTime;let H=0;0<C&&(H=J.Bw()-C);C={["callInstanceId"]:C.toString(),["callDuration"]:H.toString(),["errorCode"]:T.toString()};if(G)for(let I in G)C[I]=
G[I];b.ULS.sendTraceTag(51401116,344,50,"{0}",C);x.a.sendTelemetryEvent(Object.assign(new D.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:v.a.Wj(C)}));L.callback(T,O)}static Bw(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(L){}return Date.now()}}J.oXe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");J.Ma=null;Object(u.a)(J,
"AppsForOfficeSingleSignOnManager",null,[241])},861:function(u,E,a){a.d(E,"a",function(){return b});u=a(0);var c=a(13);class b{constructor(){this.IUe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.HUe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1628),c.a.instance.ga(1632)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1629),c.a.instance.ga(1633)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1630),c.a.instance.ga(1634)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1631),c.a.instance.ga(1635)]};this.c$b=null}get lia(){return"SourceControlId"}get rN(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}jWh(){if(!this.c$b){this.c$b={};for(const e of Object.keys(this.IUe))this.c$b[e]=this.IUe[e];for(const e of Object.keys(this.HUe))this.c$b[e]=this.HUe[e][0]}}}Object(u.a)(b,"AddinCommandsStringProvider",null,[761])},863:function(u,E,a){a.d(E,"a",function(){return c});
u=a(0);class c{constructor(){this.yMa=0;this.Hha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.hfc=!1;this.rcf=this.Hia=null}}Object(u.a)(c,"AddInCommandsNotificationParameters",null,[])},933:function(u,E,a){u=a(0);var c=a(15),b=a(84),e=a(152),f=a(14),d=a(86);class h extends Sys.UI.Control{constructor(G,C,H,I){super(document.createElement("div"));this.WS=this.US=this.Xv=this.QG=this.YG=this.Lpa=this.lra=null;this.Fjb=this.Aqa=!1;this.content=this.Wp=null;this.z1=0;
this.Ewe=null;this.XT=0;this.pHf=null;this.cle=G;this.mge=C;this.zP=H;this.PJ=I;this.mg=C.ownerDocument;this.Gec=this.It=this.Yjb=!1}get hW(){this.lra||(this.lra=this.mg.createElement("div"),this.lra.id=this.mi("WACCalloutOuter"),this.lra.className="WACCalloutOuter",this.lra.setAttribute(d.a.Ld,d.a.n_a),this.lra.style.width=this.z1+"px");return this.lra}get Spb(){if(!this.Lpa){this.Lpa=this.mg.createElement("div");this.Lpa.id=this.mi("WACCalloutBeakContainer");this.Lpa.className="WACCalloutBeakContainer";
var G="CalloutBeakTopFilled_32x16x32";if(5===this.XT||6===this.XT||4===this.XT)G="CalloutBeakBottomFilled_32x16x32";G=e.createClusteredImage(32,16,G,"WACCalloutBeak",!0,"");this.Lpa.appendChild(G)}return this.Lpa}set Spb(G){this.Lpa=G}get cNa(){return this.Yjb}get title(){return this.Wp}set title(G){this.Wp!==G&&(this.Wp=G,this.US&&(this.US.innerText=this.Wp))}get It(){return this.Aqa}set It(G){this.Aqa!==G&&(this.Aqa=G,this.YG&&(this.YG.contains(this.Xv)&&!this.Aqa?this.YG.removeChild(this.Xv):!this.YG.contains(this.Xv)&&
this.Aqa&&this.noe()))}get Gec(){return this.Fjb}set Gec(G){this.Fjb!==G&&(this.Fjb=G,this.YG&&(this.YG.contains(this.US)&&!this.Fjb?this.YG.removeChild(this.US):!this.YG.contains(this.US)&&this.Fjb&&this.Fpe()))}show(){this.Yjb||(this.lah(),this.uo(),this.mge.appendChild(this.hW),this.hW.style.display="Block",this.xxj(),this.Yjb=!0,this.pHf&&this.pHf())}dismiss(){this.Yjb&&(this.m2a(),this.mge.removeChild(this.hW),this.Yjb=!1,this.PJ&&this.PJ())}dispose(){this.dismiss();this.US=this.Xv=this.QG=this.Lpa=
this.YG=this.lra=null;Sys.Component.prototype.dispose.call(this)}mi(G){return this.get_element().id+G}lah(){this.YG=this.mg.createElement("div");this.YG.id=this.mi("WACCalloutHeader");this.YG.className="WACCalloutHeader";this.It&&this.noe();this.Gec&&this.Fpe();this.QG=this.mg.createElement("div");this.QG.id=this.mi("WACCalloutContent");this.QG.className="WACCalloutContent";this.QG.style.width=190<this.z1?this.z1-26+"px":"164px";this.QG.appendChild(this.content);this.hW.appendChild(this.Spb);this.hW.appendChild(this.YG);
this.hW.appendChild(this.QG)}noe(){this.Xv=this.mg.createElement("a");this.Xv.className="WACCalloutCloseAnchor";this.Xv.id=this.mi("WACCalloutCloseAnchor");this.Xv.href="#";this.YG.appendChild(this.Xv);const G=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Xv.appendChild(G)}Fpe(){this.US=this.mg.createElement("div");this.US.className="WACCalloutTitle UIFontBold";this.US.style.width=190<this.z1?this.z1-30+"px":"160px";this.US.id=
this.mi("WACCalloutTitle");this.US.innerText=this.title;this.YG.contains(this.Xv)?this.YG.insertBefore(this.US,this.Xv):this.YG.appendChild(this.US)}xxj(){var G=this.cle;let C;if(1===this.XT){var H=this.Ewe.y+16;C=-16}else 2===this.XT||3===this.XT||0===this.XT?(H=G.y+G.height+15,C=-15):(H=G.y-this.hW.clientHeight-15-2,C=this.hW.clientHeight-1);this.hW.style.top=H+"px";this.Spb.style.top=C+"px";1===this.XT?(G=this.Ewe.x-16,this.hW.style.left="50%",this.hW.style.marginLeft=-this.z1/2+"px",H=Sys.UI.DomElement.getBounds(this.hW),
this.Spb.style.left=G-H.x+"px"):(H=G.x+this.cle.width/2,2===this.XT||5===this.XT?(G=20,H-=36):0===this.XT||4===this.XT?(G=this.z1/2-16,H-=this.z1/2):(G=this.z1-20-32,H=H-this.z1+36),this.hW.style.left=H+"px",this.Spb.style.left=G+"px")}uo(){this.It&&!this.WS&&(this.WS=Object(b.a)(this,this.N$,"closeHandler"),this.zP.ta(f.a.click,this.Xv,this.WS,null))}m2a(){this.It&&this.WS&&(this.zP.Ba(f.a.click,this.Xv,this.WS),this.WS=null)}N$(){this.dismiss();return!0}}Object(u.a)(h,"Callout",Sys.UI.Control,[234]);
class m extends h{constructor(G,C,H,I,M,Q=null){super(G,H,M.qX,Q);this.uee=0;this.z1=this.oWh(I);this.OYa=C;this.ef=M;this.xOj=7;this.zl=this.OYa.ownerDocument.createElement("div");this.zl.className="ModalCalloutControlOverlay";this.zl.tabIndex=0;this.OYa.insertBefore(this.zl,this.OYa.firstChild)}show(){this.cNa||(this.ef.Wrc(),this.ef.VP(!1),this.zl.style.zIndex=String(this.ef.C2),super.show(),this.Lj(),this.uee=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.xOj))}dismiss(){this.cNa&&
(this.ef.YM(!1),this.gk(),this.OYa&&this.OYa.contains(this.zl)&&this.OYa.removeChild(this.zl),super.dismiss(),window.clearTimeout(this.uee))}Lj(){this.ef.qsa(Object(b.a)(this,this.dismiss,"dismiss"));this.ef.Uy.ta(f.a.click,this.zl,Object(b.a)(this,this.gd,"onClick"))}gk(){this.ef.Acb(Object(b.a)(this,this.dismiss,"dismiss"));this.ef.Uy.Ba(f.a.click,this.zl,Object(b.a)(this,this.gd,"onClick"))}gd(){this.dismiss();return!0}oWh(G){let C=0;switch(G){case 0:C=190;break;case 1:C=250;break;case 2:C=300;
break;case 3:C=360}return C}}Object(u.a)(m,"ModalCallout",h,[]);var l=a(462),w=a(172);class n extends m{constructor(G,C,H,I,M,Q=null){super(G,C,H,I,M,Q);this.RVb=null}show(){if(!this.cNa){const G=Object.assign(new l.a,{onShow:()=>{m.prototype.show.call(this)}});w.UISurfaces.OH().then(C=>{const H=C.externalNotification();this.RVb=C.addNotification(H,G);return null},C=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",C);return null})}}dismiss(){this.cNa&&this.RVb&&(w.UISurfaces.OH().then(G=>
{G.removeNotification(this.RVb);return this.RVb=null},G=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null}),super.dismiss())}}Object(u.a)(n,"ReactManagedModalCallout",m,[]);var y=a(4);class t{static Zbh(G,C,H){return y.AFrameworkApplication.sa.Pa.fR?new n(G,C,H,3,y.AFrameworkApplication.sa,null):new m(G,C,H,3,y.AFrameworkApplication.sa,null)}}Object(u.a)(t,"ModalCalloutControlFactory",null,[]);var r=a(54),v=a(859),B=a(581),A=a(860),z=a(134),x=a(56),D=a(40),
J=a(82),L=a(813),T=a(693);a.d(E,"a",function(){return O});class O{static get d1b(){return O.mfa||(O.mfa=J.a.instance.Kh("Common.Utils.IAriaNotifier"))}static sGe(G,C,H,I){O.wJ&&O.wJ.cNa&&O.wJ.dismiss();O.wJ=t.Zbh(C,G,G);O.wJ.content=H;T.b(I)||(O.wJ.title=I,O.wJ.Gec=!0);G=new Sys.UI.Bounds(0,0,x.a.Edc(),x.a.Ddc());O.wJ.XT=O.cOh(G,C,O.wJ.z1);O.wJ.show();O.d1b&&O.d1b.sendNotification(H.innerText,!0)}static L4c(G,C,H,I=null){w.UISurfaces.OH().then(M=>{let Q=null;O.Rlb&&(M.removeNotification(O.Rlb),O.Rlb=
null);const U=M.callout(Object.assign(new v.a,{target:G,title:C,content:H,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new A.a,{onDismiss:()=>{M.removeNotification(Q)},directionalHint:null!=I?I:null})})),N=Object.assign(new l.a,{expirationOptions:Object.assign(new B.a,{displayTimeoutSeconds:7,onExpire:()=>{M.removeNotification(O.Rlb)}})});Q=O.Rlb=M.addNotification(U,N);return null},M=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
M);return null})}static bUd(G,C=null){O.wJ&&O.wJ.cNa&&O.wJ.dismiss();const H=new z.StandardDialog;H.qTa=!1;H.Rb=0;H.fA(r.a.avi,CommonUIStrings.l_DialogError,T.b(G)?O.d1e():G,C)}static dUd(G){O.wJ&&O.wJ.cNa&&O.wJ.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",G.errorCode));const C=T.b(G.description)?O.d1e():G.description,H=new z.StandardDialog;let I=null;G.Hha?(H.Rb=1,H.oc(1,G.buttonText),H.Q0(1)):H.Rb=0;I=M=>{1===M?G.Hha():G.Hia&&G.Hia()};
H.qTa=!1;0===G.yMa?H.fA(G.errorCode,G.title?G.title:CommonUIStrings.l_DialogError,C,I):1===G.yMa?H.kX(G.title?G.title:CommonUIStrings.l_DialogWarning,C,I):H.CBa(G.title?G.title:CommonUIStrings.l_DialogInfo,C,I)}static cOh(G,C,H){let I=4;const M=G.x+G.width-C.x-C.width;C.x-G.x+C.width/2<=H/2?I=5:M+C.width/2<=H/2&&(I=6);return I}static EDj(G,C,H,I=!1){(C=L.a.g4a(C))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(C,M=>{M&&(I||O.L4c(M,
H,G,5))})}static FDj(G,C,H=!1){O.EDj(C.startedNode?C.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,G),C,C.startedNode?C.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,G),H)}static DDj(G,C,H,I){if(O.Xig)G=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,H,I,CommonUIStrings.l_InsertionDialogRefresh)),O.L4c(C,G,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{C=
D.a.vp(C);var M=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Q=document.createElement("span");Q.innerText=M[0];var U=document.createElement("span");U.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,H,I,CommonUIStrings.l_InsertionDialogRefresh);U.className="UIFontBold";H=document.createElement("span");H.innerText=M[1];I=document.createElement("div");Sys.UI.DomElement.addCssClass(I,"ModalCalloutControl");I.appendChild(Q);I.appendChild(U);I.appendChild(H);
O.sGe(G,C,I,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static XEj(G,C){var H=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,I=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;O.Xig?O.L4c(C,H,I):(C=D.a.vp(C),O.sGe(G,C,O.lXg(I),H))}static lXg(G){const C=document.createElement("div");Sys.UI.DomElement.addCssClass(C,"ModalCalloutControl");C.innerText=G;return C}static d1e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get Xig(){return y.AFrameworkApplication.sa.Pa.Qi&&
y.AFrameworkApplication.sa.Pa.fR}}O.wJ=null;O.Rlb=null;O.mfa=null;Object(u.a)(O,"AddInCommandsNotificationFactory",null,[])},943:function(u,E,a){a.r(E);u=a(0);var c=a(15),b=a(1464),e=a(147),f=a(120),d=a(718),h=a(731),m=a(344);class l{constructor(r,v,B,A){this.yA=!1;this._id=r;this.yx=v;this.R1=B;this.Hd=A}get enabled(){return this.yA}set enabled(r){const {DynamicRibbon:v}=a(943);var B=this.Hd.OwnerAddinStoreType;const A=this.Hd.PrimaryMarketplace.MarketplaceRef,z=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:
null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yx,B,null,null,null,A);B={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,B,z,null,null,A),["ownerAddinStoreType"]:B,["ribbonControlType"]:"Button",["toggle"]:r};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:v.nBc+"ControlUpdate",dataFields:f.a.Wj(B)}));this.yA=r;this.R1.yK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.yx,["PrivacyCompliantSolutionId"]:x,
["SourceControlId"]:this.id,["MethodData"]:this.yA})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(r){switch(r){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokePropertyGetAsync(r){r=this.invokePropertyGet(r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}invokePropertySet(r,
v){switch(r){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokePropertySetAsync(r,v){this.invokePropertySet(r,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(r,v){switch(r){case 5:return this.guj(v);case 1:return this.fDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokeMethodAsync(r,v){r=this.invokeMethod(r,
v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}guj(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"boolean");this.setEnabled(r);return null}fDa(){this._OnAccess();return null}}Object(u.a)(l,"RibbonButton",null,[]);class w{constructor(r,v,B,A){this._id=r;this.yx=v;this.R1=B;this.Hd=A}get id(){return this._id}setVisibility(r){const {DynamicRibbon:v}=a(943),B=this.Hd.OwnerAddinStoreType;var A=this.Hd.PrimaryMarketplace.MarketplaceRef;const z=this.Hd.AssetMarketplace?
this.Hd.AssetMarketplace.SolutionId:null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yx,B,z,null,null,A);A={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,B,z,null,null,A),["ownerAddinStoreType"]:B,["ribbonControlType"]:"Tab",["toggle"]:r};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:v.nBc+"ControlUpdate",dataFields:f.a.Wj(A)}));this.R1.yK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.yx,
["PrivacyCompliantSolutionId"]:x,["StoreType"]:B,["SourceControlId"]:this.id,["MethodData"]:r})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(r){switch(r){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokePropertyGetAsync(r){r=this.invokePropertyGet(r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}invokePropertySet(r){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);
}invokePropertySetAsync(r,v){this.invokePropertySet(r,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(r,v){switch(r){case 3:return this.ayj(v);case 1:return this.fDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokeMethodAsync(r,v){r=this.invokeMethod(r,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}ayj(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"boolean");this.setVisibility(r);
return null}fDa(){this._OnAccess();return null}}Object(u.a)(w,"RibbonTab",null,[]);var n=a(966),y=a(185);a.d(E,"DynamicRibbon",function(){return t});class t{constructor(r,v,B,A,z){this.yx=r;this.qJ=B;this.R1=A;this.Hd=z;this.kib=this.qJ.Xh;this.az=this.kib.getOsfControl(v);this.Txg=this.az.getManifest()}get buttons(){return null}executeRequestCreate(r){try{var v=this.Hd.OwnerAddinStoreType;const A=this.Hd.PrimaryMarketplace.MarketplaceRef,z=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:
null;var B=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yx,v,z,null,null,A);const x={["addinSolutionId"]:B,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,v,z,null,null,A),["ownerAddinStoreType"]:this.Hd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:t.nBc+"ExecuteRequestCreate",dataFields:f.a.Wj(x)}));const D=y.a.li(r);r={};v={};v[d.a.zJa]=this.az;v[d.a.AJa]=D;v[d.a.S8c]=this.Hd;r[d.a.$tb]=
3;r[d.a.e4]=this.yx;r[d.a.G8b]=B;r[d.a.d4]=v;this.R1.yK(-1014260128,r);let J=t.abc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,J)}catch(A){B=t.abc("ExecuteRequestCreate",!1,A.toString()),c.ULS.sendTraceTag(538572825,0,50,B)}return null}executeRequestUpdate(r){try{var v=this.Hd.OwnerAddinStoreType;const A=this.Hd.PrimaryMarketplace.MarketplaceRef,z=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:null;var B=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yx,v,z,null,
null,A);const x={["addinSolutionId"]:B,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,v,z,null,null,A),["ownerAddinStoreType"]:this.Hd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:t.nBc+"ExecuteRequestUpdate",dataFields:f.a.Wj(x)}));const D=y.a.li(r);r={};v={};v[d.a.zJa]=this.az;v[d.a.AJa]=D;v[d.a.S8c]=this.Hd;r[d.a.$tb]=3;r[d.a.e4]=this.yx;r[d.a.G8b]=B;r[d.a.d4]=v;this.R1.yK(-1014260128,
r);let J=t.abc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,J)}catch(A){B=t.abc("ExecuteRequestUpdate",!1,A.toString()),c.ULS.sendTraceTag(538572823,0,50,B)}return null}getButton(r){let v=null;if(!this.Ugf())return this.uGe();if(r&&0<r.length){if(!this.yBe(r))return this.NGe(r);v=new l(r,this.yx,this.R1,this.Hd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}getTab(r){let v=null;if(!this.Ugf())return this.uGe();if(this.az.getOwnerAddinControlRecreated())return this.lbh();
if(r&&0<r.length){if(!this.yBe(r))return this.NGe(r);v=new w(r,this.yx,this.R1,this.Hd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(r){switch(r){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokePropertyGetAsync(r){r=this.invokePropertyGet(r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}invokePropertySet(r){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);
}invokePropertySetAsync(r,v){this.invokePropertySet(r,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(r){switch(r){case 1:return this.fDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokeMethodAsync(r,v){switch(r){case 7:return this.XBh(v);case 6:return this.YBh(v);case 3:return this.JNh(v);case 5:return this.N1h(v)}r=this.invokeMethod(r,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}XBh(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,
0,"string");return this.executeRequestCreate(r)}YBh(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return this.executeRequestUpdate(r)}JNh(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return this.getButton(r)}N1h(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return this.getTab(r)}fDa(){this._OnAccess();return null}NGe(r){return n.a(h.a.L7g,y.a.ga(1762)+r)}uGe(){return n.a(h.a.fmj,y.a.ga(1758))}lbh(){return n.a(h.a.hostRestartNeeded,
y.a.ga(1763))}Ugf(){var r=this.az.getSharedRuntimeId();r=!!r&&0<r.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",r));return r}yBe(r){const v=this.Txg.getRibbonExtensionControlMap();return r in v||this.W0g(r)}W0g(r){var v=this.sFh();if(v){v=v.uNe;for(const B of v.tabs){if(B.id===r)return!0;for(const A of B.groups)for(const z of A.controls){if(z.id===r)return!0;if("Menu"===z.type){v=z;for(const x of v.items)if(x.id===r)return!0}}}}return!1}sFh(){return b.a.getInstance().ija(this.Hd.PrimaryMarketplace.MarketplaceType,
this.Hd.PrimaryMarketplace.SolutionId,1)}static abc(r,v,B){const A={};A.methodName="DynamicRibbon."+r;A.result=v?"Succeeded":"Failed";A.message=B;return y.a.hc(A)}}t.nBc="Office.Online.Extensibility.Ribbon.";Object(u.a)(t,"DynamicRibbon",null,[])},953:function(u,E,a){a.d(E,"a",function(){return b});var c=a(954);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},960:function(u,E,a){a.d(E,"a",function(){return c});
const c=(b,e)=>{let f=!1;b&&(b=e.osfControl,(e=b.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},961:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.uha=this.uUa=this.tgd=this.Wid=this.Jxb=this.$Xd=null}}Object(u.a)(c,"AppsForOfficeOauthResult",null,[])},966:function(u,E,a){a.d(E,"a",function(){return c});const c=(b,e)=>OfficeExtension.WacRuntime.Utility.createPromise((f,
d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,e))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/8b070eda7a7a838ae47d1c984d6ff62c/EwaDSEsNext.agave.js.map