'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{1122:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1123:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1124:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".ewa-svg-icon{height:100%;width:100%}")}},1125:function(u,E,a){function c(l,w){this.ID=l;this.type=w}function b(l,w){this.value=l;this.contextId=w}function e(l,w,n,y,t,r,v,B){this.type=l;this.startTime=null==n||void 0==n.value?new b(n,null):n;this.endTime=null==y||void 0==y.value?new b(y,null):y;null!=t&&void 0!=t.value||new b(t,null);null!=r&&void 0!=r.value||new b(r,null);this.operationType=B}function f(l){this.ID=
l}function d(){this.Qe=[];this.Pob=[];this.PXc=0;this.duration=this.startTime=null;this.N8b={};this.jyd=this.Pyd=this.oZc=-1}function h(l){var w;return(null!=document.body.style.msTransform?w=l.style.msTransform:null!=document.body.style.webkitTransform?w=l.style.webkitTransform:null!=document.body.style.mozTransform?w=l.style.r4j:null!=document.body.style.oTransform?w=l.style.t4j:null!=document.body.style.transform&&(w=l.style.transform),w)?(w=w.replace("rotate(",""),w=w.replace("deg)",""),parseFloat(w)):
0}a.d(E,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);e.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),H4j:new b(0,null),V3j:new b(0,null),operationType:0};u=Array(1);u[0]=new b(0,0);new f(0,[new e(5,0,0,0,null,1,1,0)]);new f(1,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0)]);new f(2,[new e(1,3,0,167,null,0,1,1),new e(2,3,0,167,null,0,1,1)]);new f(3,[new e(3,3,0,167,null,0,1,1),new e(4,3,0,167,null,0,1,1)]);new f(4,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,167,null,1,1,0)]);new f(5,[new e(5,2,0,167,null,
0,1,0)]);new f(6,[new e(1,3,0,100,null,0,1,1),new e(2,3,0,100,null,0,1,1)]);new f(7,[new e(3,3,0,100,null,0,1,1),new e(4,3,0,100,null,0,1,1)]);new f(8,[new e(5,2,0,100,null,1,1,0)]);new f(9,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,1,1,0)]);new f(10,[new e(5,2,0,100,null,0,1,0)]);new f(11,[new e(1,3,0,267,null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(12,[new e(3,3,0,267,null,0,1,1),new e(4,3,0,267,null,0,1,1)]);new f(13,[new e(5,2,0,267,null,1,1,0)]);new f(14,[new e(5,2,0,0,null,0,2,0),new e(5,
2,0,267,null,1,1,0)]);new f(15,[new e(5,2,0,267,null,0,1,0)]);new f(16,[new e(6,3,0,267,null,0,1,1),new e(7,3,0,267,null,0,1,1)]);new f(17,[new e(1,3,0,750,null,0,1,1),new e(2,3,0,750,null,0,1,1)]);new f(18,[new e(3,3,0,750,null,0,1,1),new e(4,3,0,750,null,0,1,1)]);new f(19,[new e(5,2,0,750,null,1,1,0)]);new f(20,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,750,null,1,1,0)]);new f(21,[new e(6,3,0,1E3,null,0,1,1),new e(7,3,0,1E3,null,0,1,1)]);new f(22,[new e(1,3,0,367,null,0,1,1),new e(2,3,0,367,null,0,
1,1)]);new f(23,[new e(3,3,0,367,null,0,1,1),new e(4,3,0,367,null,0,1,1)]);new f(24,[new e(5,2,0,367,null,1,1,0)]);new f(25,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,367,null,1,1,0)]);new f(26,[new e(5,2,0,367,null,0,1,0)]);new f(27,[new e(6,2,0,u[0],null,0,1,1),new e(7,2,0,u[0],null,0,1,1)]);new f(28,[new e(5,2,0,0,null,1,1,0),new e(5,2,0,50,null,0,1,0)]);new f(29,[new e(1,3,0,433,null,0,1,1),new e(2,3,0,433,null,0,1,1)]);new f(30,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0),new e(2,3,0,0,
null,40,1,1),new e(2,3,0,100,null,0,1,1)]);new f(31,[new e(2,0,0,0,null,32,1,1),new e(2,0,0,100,null,32,1,1),new e(2,3,101,350,null,0,1,1),new e(3,0,0,0,null,0,2,1),new e(3,0,0,100,null,0,2,1),new e(3,3,101,350,null,0,1,1),new e(5,0,0,0,null,0,2,0),new e(5,0,0,100,null,1,1,0)]);new f(32,[new e(2,3,0,267,null,32,1,1),new e(3,3,0,267,null,0,2,1),new e(5,2,0,0,null,1,0,0),new e(5,2,0,267,null,0,2,0)]);new f(33,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,0,2,0),new e(5,2,101,267,null,1,1,0)]);new f(34,
[new e(1,10,0,300,null,0,1,1),new e(2,10,0,300,null,0,1,1)]);new f(35,[new e(3,10,0,300,null,0,1,1),new e(4,10,0,300,null,0,1,1)]);new f(36,[new e(1,8,0,750,null,0,1,1),new e(2,8,0,750,null,0,1,1)]);new f(37,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,200,null,0,2,0),new e(5,3,201,500,null,1,1,0)]);new f(38,[new e(1,2,0,0,null,0,2,1),new e(2,2,0,0,null,0,2,1),new e(1,2,0,200,null,0,2,1),new e(2,2,0,200,null,0,2,1),new e(1,3,201,267,null,0,1,1),new e(2,3,201,267,null,0,1,1)]);new f(39,[new e(1,3,0,267,
null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(40,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,267,null,1,1,0)]);new f(41,[new e(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(l){window.setTimeout(l,16)}}();d.prototype={Qe:null,SOg:5,Pob:null,PXc:0,startTime:null,
duration:null,N8b:null,oZc:-1,Pyd:-1,jyd:-1};d.prototype.Start=function(){this.startTime=new Date;this.N8b={}};d.prototype.GetRecentAnimationStats=function(){var l,w=[],n=0;for(l=m.PXc;l<m.SOg;l++)null!=m.Pob[l]&&(w[n]=m.Pob[l],n++);for(l=0;l<m.PXc;l++)null!=m.Pob[l]&&(w[n]=m.Pob[l],n++);return w};d.prototype.GetAnimationSqmStats=function(){var l=[];return l[0]=0>m.oZc?0:m.oZc,l[1]=0>m.Pyd?0:m.Pyd,l[2]=0>m.jyd?0:m.jyd,l};var m=new d},1126:function(u,E,a){a.d(E,"a",function(){return h});u=a(0);E=a(38);
var c=a(213),b=a(359),e=a(186),f=a(42),d=a(537);class h extends E.a{constructor(m){super();this.mT=[];this.tf=(w,n)=>{var y,t=n.ed.block;w=!1;if(t.Qk&&t.state&1&&(y=this.view.Bf(n.ed.block.pe.BlockCachePosition.PaneType).KG(n.ed.hash))){t=this.HId(t.ke);if(y=y.qf)for(let r=this.mT.length-1;0<=r;r--)y.contains(this.mT[r].bottomRight)&&(this.mT.splice(r,1),w=!0);if(t)for(let r=0,v=t.length;r<v;r++)this.rangeList.push(e.a.IQ(t[r])),w=!0;w&&(n=this.view.Mqc(n.ed.block.pe.BlockCachePosition.PaneType).KG(n.ed.hash),
this.raiseEvent(h.IId,new d.a(n)))}};this.an=()=>{this.nJb()};this.Mo=()=>{this.mT=[]};this.rme=m;var l=m.Ea;l.mt(this.tf);l.cha(this.tf);l.s_b(this.tf);l.hH(this.an);m.$.xa.HJ(this.Mo);m.$.Cb.HJ(this.Mo);for(const w of m.Mn)for(let n of w)for(let y of n)l=m.Ea.Dl(y.hashCode),this.tf(this,new b.a(new c.a(l,y.hashCode),null))}get rangeList(){return this.mT}get view(){return this.rme}dispose(){this.view&&(this.view.Ea.er(this.tf),this.view.Ea.EI(this.an),this.view.Ea.qcb(this.tf),this.view.Ea.IJb(this.tf),
this.view.$.xa.nL(this.Mo),this.view.$.Cb.nL(this.Mo));this.mT=this.rme=null;super.dispose()}l_b(m){m=this.HId(m);const l=this.view.IH;if(m&&0<m.length&&l)for(let w=0,n=m.length;w<n;w++)l.contains(this.mT[w])||this.mT.push(e.a.IQ(m[w]))}nJb(){const m=this.view.IH;if(this.mT.length&&m)for(let l=this.mT.length-1;0<=l;l--)m.contains(this.mT[l])||this.mT.splice(l,1)}m5e(m){return this.E4e(m)}E4e(m){m=f.I(m,this.mT,!0);return 0<m.length?m[0]:null}}h.IId="lrc";Object(u.a)(h,"LoadedRangeCollection",E.a,
[])},1127:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1141:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(38);class f extends e.a{constructor(na){super();na.da.Ga(376,this)}CMg(na){this.addHandler("TAF",na)}uhj(na){this.removeHandler("TAF",na)}I7i(){this.raiseEvent("TAF")}}Object(u.a)(f,"GridHighlightBehaviorEventManager",e.a,[517,2]);class d extends b.a{constructor(na){super();this.$=na;this.Fb()}create(){this.ob(this.$.da.za(376)||new f(this.$))}static ka(na){na.da.Ga(377,new d(na))}}Object(u.a)(d,"GridHighlightBehaviorEventManagerFactory",b.a,
[]);var h=a(50),m=a(37),l=a(27),w=a(78),n=a(15),y=a(239),t=a(14),r=a(156),v=a(5),B=a(113),A=a(12);class z extends Sys.EventArgs{constructor(na,jb){super();this.start=na;this.v6a=jb}}Object(u.a)(z,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var x=a(33);class D extends e.a{constructor(na){super();this.mmc=[3];this.zqa=void 0;this.gridView=na;this.tCc=x.a.eR(this.gridView.$);this.vB=x.a.vB(this.gridView.$)}get coloredReferencesManager(){const na=this.gridView.$.da.za(281);na||n.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return na}get kB(){if(this.zqa)return this.zqa;const na=this.gridView.$.da.za(464);na||n.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
na.kB||n.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.zqa=na.kB}dLg(na){this.addHandler("mrek",na)}ex(na,jb,Ib){for(const dc of this.gridView.Mn)y.a.instance.ta(t.a.Jj,dc.domElement,na);y.a.instance.ta(t.a.Qf,document.documentElement,jb);this.gridView.fc.U8b(!0);Ib&&y.a.instance.ta(t.a.Fy,this.gridView.zj,jb)}I_d(na,jb,Ib){for(const dc of this.gridView.Mn)y.a.instance.Ba(t.a.Jj,dc.domElement,na);y.a.instance.Ba(t.a.Qf,
document.documentElement,jb);this.gridView.fc.U8b(!1);Ib&&y.a.instance.Ba(t.a.Fy,this.gridView.zj,jb)}Abj(na,jb){for(const Ib of this.gridView.Mn)r.a.instance.ta(t.a.Zf,Ib.domElement,na);r.a.instance.ta(t.a.xe,document.documentElement,jb)}PTj(na,jb){for(const Ib of this.gridView.Mn)r.a.instance.Ba(t.a.Zf,Ib.domElement,na);r.a.instance.Ba(t.a.xe,document.documentElement,jb)}TGe(na,jb,Ib,dc){const ob=document.createElement("div");ob.className=jb;for(const Fa of Ib)ob.classList.add(Fa);na.appendChild(ob);
y.a.instance.ta(t.a.pointerDown,ob,dc);return ob}Z5e(na){na=na.Gb.parentNode;if(!na)return n.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;na=parseInt(na.getAttribute(v.a.v6a),10);return isNaN(na)?(n.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.qb.Bv(3,1,na)}wMb(na,jb,Ib=!0){na=Ib&&(this.vB?!!this.kB&&
this.kB.xni(na):!!this.coloredReferencesManager&&this.coloredReferencesManager.wni(na));for(const dc of jb)A.DOMElementExtensions.setVisible(dc,na)}dbc(){return this.gridView.Ul?B.a(this.gridView.$):this.gridView.Vb}QQf(){if(this.vB){var na=this.dbc();na&&this.kB?this.tCc?na.$B(null):this.kB.bgb(na,null):(n.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.Xg(this.mmc),this.gridView.qb.Ti(null,
this.mmc))}else this.l$i()}l$i(){const na=this.dbc();na&&this.coloredReferencesManager?this.tCc?na.$B(null):this.coloredReferencesManager.$B(na,null):(n.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.Xg(this.mmc),this.gridView.qb.Ti(null,this.mmc))}aPf(na,jb){this.raiseEvent("mrek",new z(na,jb))}}Object(u.a)(D,"BehaviorHelperMethods",e.a,[]);var J=a(87),L=a(40);e=a(94);
class T extends e.a{constructor(na,jb=null){super(na,jb)}PZa(){}}Object(u.a)(T,"HighlightFlyweightBehavior",e.a,[]);var O=a(19),G=a(463),C=a(76),H=a(11),I=a(117),M=a(224),Q=a(45);e=a(238);var U=a(8),N=a(68),W=a(1),X=a(34);class sa extends e.a{constructor(na,jb,Ib){super(document.createElement("div"));this.x6b=null;this.WQb=!1;this.onPointerDown=dc=>{dc=X.a(this.$)?X.a(this.$).Vd(dc):dc;this.WQb=!1;if(3===(C.a.Db=dc.tb)){const ob=dc.Ca.rawEvent,Fa=ob.srcElement||ob.target;A.DOMElementExtensions.yf(this.domElement,
Fa)&&A.DOMElementExtensions.yf(ob.currentTarget,Fa)&&(this.WQb=!0,this.x6b=dc.clientPoint)}return!1};this.Pf=dc=>{dc=X.a(this.$)?X.a(this.$).Vd(dc):dc;this.raiseEvent("GrPointerUp",dc);return this.WQb=!1};this.Gh=dc=>{dc=X.a(this.$)?X.a(this.$).Vd(dc):dc;3===dc.tb&&this.WQb&&this.n9h(dc.clientPoint)&&(this.raiseEvent("GrDrag"),this.WQb=!1);return!1};this.gd=dc=>{X.a(this.$)&&X.a(this.$).Vd(dc);return!0};this.$=Ib;Ib=!W.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(Ib?
N.a.hUe:N.a.gUe);this.domElement.classList.add(N.a.Z9b);na.appendChild(this.domElement);A.DOMElementExtensions.setVisible(this.domElement,!1);this.JLa=document.createElement("div");this.JLa.classList.add(N.a.Y9b);this.JLa.style.borderColor=jb;this.domElement.appendChild(this.JLa);y.a.instance.ta(t.a.pointerDown,this.domElement,this.onPointerDown);y.a.instance.ta(t.a.Qf,this.domElement,this.Pf);r.a.instance.ta(t.a.xe,this.domElement,this.Pf);y.a.instance.ta(t.a.Jj,this.domElement,this.Gh);r.a.instance.ta(t.a.Zf,
this.domElement,this.Gh);M.a.instance.ta(t.a.click,this.domElement,this.gd)}Bqe(na){this.addHandler("GrDrag",na)}zUf(na){this.removeHandler("GrDrag",na)}Aqe(na){this.addHandler("GrContxt",na)}yUf(na){this.removeHandler("GrContxt",na)}Cqe(na){this.addHandler("GrPointerUp",na)}AUf(na){this.removeHandler("GrPointerUp",na)}dispose(){Q.a.kna(this.domElement);super.dispose()}Rhg(na){this.domElement.parentNode.removeChild(this.domElement);na.appendChild(this.domElement)}G1f(){this.domElement.classList.remove(N.a.Z9b);
this.JLa.classList.remove(N.a.Y9b);this.JLa.classList.add(N.a.iUe)}fgg(){this.JLa.classList.remove(N.a.iUe);this.JLa.classList.add(N.a.Y9b);this.domElement.classList.add(N.a.Z9b)}n9h(na){return!!this.x6b&&(3<Math.abs(na.x-this.x6b.x)||3<Math.abs(na.y-this.x6b.y))}static rwb(na){return W.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(na=X.a(na.$)?X.a(na.$).zoom:U.a.a0,Math.round(9/Math.max(na,1))):9}}sa.Txd=0;Object(u.a)(sa,"TouchGrippie",e.a,[]);class da extends T{constructor(na,
jb,Ib,dc){super(jb);this.dtd=this.oYc=this.dpb=!1;this.Bqb=null;this.Oba=this.Zsd=!1;this.Ww=()=>{this.dpb&&this.Zsd?this.noa():this.Y4()};this.vCf=Fa=>{3===Fa.tb&&(this.Zsd=!0,this.noa());return!1};this.wCf=Fa=>{if(3===Fa.tb){if(!Fa.Gb||this.lli(Fa))return!1;this.Zsd=!1;this.Y4()}return!1};this.Cg=()=>{this.Oba&&this.M_d();this.noa();this.dtd=!1};this.Mp=()=>{this.Y4();this.dtd=!0};this.wza=(Fa,Ab)=>{Ab.a5===this.a5&&(Ab.visible?this.dtd||this.noa():this.Y4())};this.iIf=()=>{this.xCf(this.dP.domElement,
!1)};this.Nyf=()=>{this.xCf(this.EM.domElement,!0)};this.Uoc=(Fa,Ab)=>{this.ha.iAa(Ab)};this.Voc=(Fa,Ab)=>{this.ha.iAa(G.b(Ab))};this.YFb=()=>{3===C.a.Db?this.noa():this.Y4();this.Oba&&1===C.a.Db&&this.M_d()};this.jIf=()=>{this.Vsj()};this.xNe=()=>{this.Y4()};this.Ln=()=>{this.ha.Sa.$b&&this.Y4()};this.Byf=()=>{this.Y4()};this.oCf=(Fa,Ab)=>{this.M_d();3===Ab.tb?this.noa():this.Y4()};this.Usc=()=>{this.dpb&&(this.Y4(),this.noa())};const ob=Ib.$;this.zq=Ib;this.ha=Ib.ha;this.sba=na;this.vqj=jb;this.paneType=
dc;na=this.domElement.currentStyle;jb="#000000";na&&(jb=na.borderTopColor);this.dP=new sa(this.bcd(),jb,ob);this.EM=new sa(this.bcd(),jb,ob);this.tjf=ob.ea.isNamedObjectViewMode&&1===ob.workbookContext.NovMode;this.dP.Bqe(this.iIf);this.dP.Aqe(this.Uoc);this.dP.Cqe(this.Voc);this.EM.Bqe(this.Nyf);this.EM.Aqe(this.Uoc);this.EM.Cqe(this.Voc);for(const Fa of this.gridView.Mn)r.a.instance.ta(t.a.Ef,Fa.domElement,this.wCf),r.a.instance.ta(t.a.xe,Fa.domElement,this.vCf);Ib.view.nt(this.Ww);Ib.Vb.Yk(this.xNe);
Ib.qb.uob(this.wza);Ib.rWc(this.Byf);ob.PA(this.Usc);Ib.jv(this.Usc);this.ha.FY(this.Cg);this.ha.S2(this.Mp);Ib.AC(this.Ln);this.ha.x_b(this.oCf);C.a.Lqe(this.YFb);m.TaskExtensions.Aa(h.GetServiceTaskFactory.Oa(ob.da,376,377,0),Fa=>{Fa.result.CMg(this.jIf)},ob.la,3)}get gridView(){return this.zq}dispose(){J.a.qc([this.dP,this.EM]);this.dP.zUf(this.iIf);this.dP.yUf(this.Uoc);this.dP.AUf(this.Voc);this.EM.zUf(this.Nyf);this.EM.yUf(this.Uoc);this.EM.AUf(this.Voc);for(var na of this.gridView.Mn)r.a.instance.Ba(t.a.Ef,
na.domElement,this.wCf),r.a.instance.Ba(t.a.xe,na.domElement,this.vCf);this.gridView.view.gr(this.Ww);this.gridView.Vb.Hk(this.xNe);this.gridView.qb.XJb(this.wza);this.gridView.mLd(this.Byf);this.gridView.$.YD(this.Usc);this.gridView.Ky(this.Usc);this.ha.JW(this.Cg);this.ha.t7(this.Mp);this.gridView.ZD(this.Ln);this.ha.huc(this.oCf);C.a.IUf(this.YFb);this.Oba&&n.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(na=this.gridView.$.da.za(376))&&na.uhj(this.jIf);
super.dispose()}bTa(){if(!this.sba.range||!this.sba.range.equals(this.udb))return!1;const na=!this.gridView.sNa();return this.gridView.eb&&na&&(this.udb.isRow||this.udb.hf)?!1:this.Oba?!0:3===C.a.Db}Y4(){this.dpb&&(this.dP.set_visible(!1),this.EM.set_visible(!1),this.dpb=!1)}noa(){if(this.bTa()){this.uXj();var na=A.DOMElementExtensions.getBoundingClientRect(this.Bqb);na||n.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.tjf,this.oYc,this.gridView.zj,this.gridView.ib.tj);var jb=A.DOMElementExtensions.getBoundingClientRect(this.vqj),Ib=new Sys.UI.Bounds(jb.x-na.x,jb.y-na.y,jb.width,jb.height),dc=this.udb,ob=dc.topLeft,Fa=dc.bottomRight,Ab=dc.isRow||dc.hf;if(dc.hf){var $b=this.cFh();dc=Ib.x-2*sa.rwb(this.gridView);var Cb=$b;var Rb=Ib.x+jb.width}else dc.isRow?(dc=Rb=this.bFh(),Cb=Ib.y-2*sa.rwb(this.gridView),$b=Ib.y+jb.height):(Cb=Ib.y,$b=Ib.y+jb.height,this.gridView.rtl?
(dc=Ib.x+jb.width,Rb=Ib.x):(dc=Ib.x,Rb=Ib.x+jb.width));jb=sa.Txd+(Ab?0:sa.rwb(this.gridView));this.dP.style.left=H.HelperMethods.uc(dc-jb);this.dP.style.top=H.HelperMethods.uc(Cb-jb);this.EM.style.left=H.HelperMethods.uc(Rb-jb);this.EM.style.top=H.HelperMethods.uc($b-jb);this.dP.set_visible(this.Rhf(Cb,dc,ob,Ab,na));this.EM.set_visible(this.Rhf($b,Rb,Fa,Ab,na));this.dpb=!0}}Rhf(na,jb,Ib,dc,ob){const Fa=A.DOMElementExtensions.getBoundingClientRect(this.gridView.Bf(this.paneType).domElement);ob=new Sys.UI.Bounds(Fa.x-
ob.x-3,Fa.y-ob.y-3,Fa.width+6,Fa.height+6);return(this.gridView.ib.Ni(Ib)===this.paneType||dc)&&L.a.BN(ob,new Sys.UI.Point(jb,na))}uXj(){if(this.tjf!==this.oYc){this.Bqb=null;const na=this.bcd();this.dP.Rhg(na);this.EM.Rhg(na)}}cFh(){return(this.gridView.view.visibleArea.height+this.gridView.ib.height+sa.Txd-sa.rwb(this.gridView))/2}bFh(){return(this.gridView.view.visibleArea.width+this.gridView.ib.width+sa.Txd-sa.rwb(this.gridView))/2}vGf(){this.noa()}lli(na){return A.DOMElementExtensions.URa(na.Gb,
O.a.Bo)&&(this.nmi(na)||this.omi(na))}omi(na){if(this.gridView.rtl)na=na.clientPoint.x;else{const jb=A.DOMElementExtensions.getBoundingClientRect(na.Gb);na=na.clientPoint.x-(jb.x+jb.width-I.a.Mu)}return 0<na&&na<=I.a.Mu}nmi(na){const jb=A.DOMElementExtensions.getBoundingClientRect(na.Gb);na=na.clientPoint.y-(jb.y+jb.height-I.a.Mu);return 0<na&&na<=I.a.Mu}xCf(na,jb){this.Oba&&n.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.G0c(na,jb,this.Oba);
this.Y4()}Vsj(){this.Oba||(n.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Oba=!0,this.dP.G1f(),this.EM.G1f(),this.gridView.ha.sourceRange=this.gridView.ha.ra.$c,this.noa())}M_d(){this.Oba&&(n.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Oba=!1,this.dP.fgg(),this.EM.fgg())}bcd(){this.Bqb||(this.oYc=!1,this.Bqb=this.gridView.zj);return this.Bqb}}Object(u.a)(da,"SelectionTouchGrippiesBehaviorBase",T,[]);class S extends da{constructor(na,
jb,Ib,dc){super(na,jb,Ib,dc)}get a5(){return 19}get udb(){return this.gridView.ha.ra.activeRange}bTa(){const na=this.gridView.si||this.gridView.eb;return!this.gridView.ha.ra.Og&&!na&&super.bTa()}}Object(u.a)(S,"DiscontinuousSelectionTouchGrippiesBehavior",da,[]);var oa=a(174);class K extends T{constructor(na){super(na);const jb=document.createElement("div");jb.className=N.a.wAh;na.appendChild(jb)}}Object(u.a)(K,"SelectionBorderBehavior",T,[]);class ea{}ea.bAh="ewr-selection-draghandle";ea.gAh="ewr-selection-draghandle-grab";
ea.rAh="ewr-selection-draghandle-top-ie";ea.sAh="ewr-selection-draghandle-top-ie-enhanced";ea.pAh="ewr-selection-draghandle-top";ea.qAh="ewr-selection-draghandle-top-enhanced";ea.eAh="ewr-selection-draghandle-bottom-ie";ea.fAh="ewr-selection-draghandle-bottom-ie-enhanced";ea.cAh="ewr-selection-draghandle-bottom";ea.dAh="ewr-selection-draghandle-bottom-enhanced";ea.jAh="ewr-selection-draghandle-left-ie";ea.kAh="ewr-selection-draghandle-left-ie-enhanced";ea.hAh="ewr-selection-draghandle-left";ea.iAh=
"ewr-selection-draghandle-left-enhanced";ea.nAh="ewr-selection-draghandle-right-ie";ea.oAh="ewr-selection-draghandle-right-ie-enhanced";ea.lAh="ewr-selection-draghandle-right";ea.mAh="ewr-selection-draghandle-right-enhanced";ea.pUe="ewr-selection-dragtooltip";ea.qUe="ewr-selection-dragtooltip-updated";ea.DAh="ewr_selection_rearrangeleft";ea.EAh="ewr_selection_rearrangeright";ea.FAh="ewr_selection_rearrangetop";ea.CAh="ewr_selection_rearrangebottom";ea.selecting="selecting";ea.GAh="ewr-selection-resizemarqueehandle";
ea.JAh="ewr-selection-resizemarqueehandle-topleft";ea.KAh="ewr-selection-resizemarqueehandle-topright";ea.HAh="ewr-selection-resizemarqueehandle-bottomleft";ea.IAh="ewr-selection-resizemarqueehandle-bottomright";ea.Szh="ewr-marquee-thick";ea.Wzh="ewr-resizemarqueehandle-thick";Object(u.a)(ea,"CssClassNames",null,[]);var ya=a(249),ha=a(21);class La extends K{constructor(na,jb,Ib,dc){super(na);this.PTa=!1;this.xne=this.yne=null;this.bsa=0;this.Zh=W.EwaSettings.getBooleanFeatureGate(oa.a.u8b,!1);this.Jki=
W.EwaSettings.getBooleanFeatureGate(oa.a.gnh,!1);this.sEc=this.ofc=this.dF=0;this.Yw=this.hb=this.sourceRange=this.ana=null;this.Pf=ob=>{ob=X.a(this.$).Vd(ob);return this.xDd(ob)};this.onPointerDown=ob=>{ob=X.a(this.$).Vd(ob);if(2===ob.tb&&ob.ho===Sys.UI.MouseButton.leftButton&&!this.PTa){var Fa=this.idc(ob);if(!Fa)return n.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.hb=Fa.clone();this.sourceRange=this.hb.clone();this.ana=this.hb;
if(Fa=this.AWh(ob))this.nh=5,this.sEc=Fa.top-this.sourceRange.top,this.ofc=Fa.left-this.sourceRange.left,ha.h(this.$).Hf.gm(this.Zh?La.yJa:La.D8c),this.Epc(ob),this.PTa=!0,ya.b(this.$,!0)}return!1};this.Gh=ob=>{ob=X.a(this.$).Vd(ob);if(this.Zh&&this.Hpc(ob))return!0;if(ob=this.ha.io(ob.clientPoint,ob.Gb,5,void 0,void 0,!0)){ob=this.Oha(ob);if(this.hb.equals(ob))return!0;this.hb=ob;if(!this.Xy())return n.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.Zub(!0),!1}return!0};this.dd=(ob,Fa)=>{Fa.FN||(W.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")?this.iBa(this.$.isEditMode&&this.koa()):this.iBa(this.$.isEditMode))};this.ls=[];this.$=jb;this.ha=ha.h(this.$).ha;this.paneType=Ib;this.vo=dc;jb=W.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");jb=this.Jki?jb?[ea.qAh,ea.dAh,ea.iAh,ea.mAh]:[ea.sAh,ea.fAh,ea.kAh,ea.oAh]:jb?[ea.pAh,ea.cAh,ea.hAh,ea.lAh]:[ea.rAh,ea.eAh,ea.jAh,ea.nAh];for(const ob of jb)jb=
this.vo.TGe(na,ob,this.Zh?[ea.gAh]:[ea.bAh],this.onPointerDown),this.ls.push(jb);this.$.ml(this.dd);W.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.iBa(this.$.isEditMode)}get qb(){return ha.h(this.$).qb}get nh(){return this.ha.selectionType}set nh(na){this.ha.selectionType=na}dispose(){this.ls.forEach(na=>{y.a.instance.Ba(t.a.pointerDown,na,this.onPointerDown)});this.ls.length=0;this.ana=this.sourceRange=this.hb=null;n.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.bsa}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.Jl(this.dd),1===this.bsa&&(n.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.wt(this.xne,this.yne,!1)));super.dispose()}xDd(na){if(5!==this.nh)return!1;(na=this.uza(na))||this.Zub(!1);ya.b(this.$,!1);return na}ex(na,jb){n.ULS.shipAssertTag(537159377,0,!this.bsa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.bsa+=1;this.xne=na;this.yne=jb;this.vo.ex(na,
jb,this.fCc())}Oha(na){if(!na||!this.hb)return n.ULS.shipAssertTag(537159376,0,!!na,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),n.ULS.shipAssertTag(537159375,0,!!this.hb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const jb=this.hb.clone();1!==this.dF&&(jb.left=Math.max(na.left-this.ofc,1),jb.right=jb.left+this.sourceRange.width-1);2!==this.dF&&(jb.top=Math.max(na.top-this.sEc,1),jb.bottom=jb.top+this.sourceRange.height-1);return this.QZa(jb)}wt(na,
jb,Ib=!0,dc=!0){n.ULS.shipAssertTag(537159374,0,1===this.bsa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.bsa;this.Zh||ha.h(this.$).Hf.gm(v.a.QQ);this.vo.I_d(na,jb,this.fCc());Ib&&this.I1c(dc);this.dF=0;this.PTa=!1}QZa(na){var jb=ha.h(this.$);let Ib=na;if(jb.ib.U4){if(!jb.Sb(na.topLeft)){jb=jb.kk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",jb.IH,this.ana.top!==na.top?1:2);try{jb.Sk=this.ana.top<na.top||this.ana.left<na.left,jb.Gs(na.topLeft),
Ib=jb.$$cu().range}finally{jb&&jb.dispose()}}Ib.right=Ib.left+na.width-1;Ib.bottom=Ib.top+na.height-1}return this.ana=Ib}iBa(na){this.ls.forEach(jb=>{A.DOMElementExtensions.setVisible(jb,na)})}AWh(na){const jb=na.Gb;na=na.clientPoint;if(!jb||!na)return n.ULS.shipAssertTag(537159373,0,!!jb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),n.ULS.shipAssertTag(537159372,0,!!na,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;na.y+=jb===this.ls[La.xJa]?
2:jb===this.ls[La.G8c]?-2:0;na.x+=jb===this.ls[La.H8c]?2:jb===this.ls[La.wJa]?-2:0;return this.ha.io(na,jb,5,void 0,void 0,!0)}}La.D8c="move";La.y1a="copy";La.yJa="grabbing";La.xJa=0;La.G8c=1;La.H8c=2;La.wJa=3;Object(u.a)(La,"DragSelectionClickBehaviorBase",K,[]);class Ia extends La{constructor(na,jb,Ib,dc,ob,Fa){super(na,jb,Ib,ob);this.Za=this.oG=null;this.B9e=()=>{this.Zub(!0)};W.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.iBa(this.koa()&&this.$.isEditMode);
this.gridView=ha.h(this.$);this.VF=dc;this.coloredReferencesManager=this.$.da.za(281);n.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.vB=x.a.vB(this.$))na=this.$.da.za(464),n.ULS.shipAssertTag(512312961,0,!!na,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.kB=na.kB;
for(const Ab of this.ls)y.a.instance.ta(t.a.pW,Ab,this.VF.Ubf),y.a.instance.ta(t.a.Fy,Ab,this.VF.Vbf);this.PZa(Fa)}PZa(na){this.vo.wMb(na,this.ls);this.VF.KAa()}Epc(na){n.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.wMa=!0;this.Za.TE(!1);this.nh=5;this.VF.aNe(na.Gb);this.Za.textBox.removeSelection();this.Za.I_b(this.B9e);this.ex(this.Gh,this.Pf);this.dF=this.sourceRange.isRow?1:this.sourceRange.hf?2:0}uza(){const na=
this.rG();this.nh=-1;this.wt(this.Gh,this.Pf);return na}I1c(){this.gridView.wMa=!1;this.VF.bNe(this.ls[0]);this.Za.textBox.setCaretPositionToEnd();this.Za.suc(this.B9e);this.vo.QQf()}Zub(na){n.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");na&&this.wt(this.Gh,this.Pf)}idc(na){this.Za=this.vo.dbc();this.oG=this.vo.Z5e(na);return this.Za&&this.oG&&this.oG.range?this.oG.range:(n.ULS.shipAssertTag(537159388,
0,!!this.Za,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),n.ULS.shipAssertTag(537159387,0,!!this.oG,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),n.ULS.shipAssertTag(537159386,0,!!this.oG.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}rG(){return this.oG?this.vB?this.kB.vEb(this.Za,this.oG,this.hb):this.coloredReferencesManager.vEb(this.Za,this.oG,this.hb):(n.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}Xy(){return this.rG()}fCc(){return!0}Hpc(){return!1}koa(){return!0}}Object(u.a)(Ia,"DragMarqueeClickBehavior",La,[]);var ra=a(85),pa=a(107),ba=a(170),fa=a(416),Ka=a(13),aa=a(225),ja=a(24),Va=a(761),bb=a(42),wa=a(188),ka=a(706),ta=a(116),qa=a(29),rb=a(281),Za=a(60);const gb=(na,jb,Ib,dc,ob,Fa,Ab,$b=null)=>{$b=na.Na(41,$b);$b.sourceRange=jb;$b.destinationRange=Ib;return Za.g(na,"RearrangeRowColumn",$b,dc,ob,Fa,Ab,0)},mb=(na,jb,Ib,dc,ob,Fa,Ab=null)=>{Ab=na.Na(1,Ab);Ab.moveRange=jb;return Za.g(na,
"MoveLineItems",Ab,Ib,dc,ob,Fa,0)};class Ga{constructor(na,jb){this.destinationRange=this.sourceRange=null;this.sourceRange=na;this.destinationRange=jb}}Object(u.a)(Ga,"MacroRecorderTableRowColumnRearrangedPayload",null,[137]);var ib=a(44);class cc extends La{constructor(na,jb,Ib,dc,ob){super(na,jb,Ib,ob);this.Lia=Ka.a.instance.ga(2263);this.Ttb=Ka.a.instance.ga(2264);this.hoa=Ka.a.instance.ga(2265);this.SMb=Ka.a.instance.ga(2266);this.gA=this.Ph=null;this.Xq=this.hf=this.isRow=this.Yq=!1;this.TI=
this.yH=null;this.$n=this.lCb=0;this.onKeyDown=Fa=>{if(this.Zh){if(this.k5(Fa)||Fa.Ca.keyCode===ra.a.y8)return this.t5||(pa.KeyInputManager.instance.ta(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.t5=!0),!this.Cu&&this.k5(Fa)&&(ha.h(this.$).Hf.gm(cc.y1a),this.Cu=!0),this.Du||Fa.Ca.keyCode!==ra.a.y8||(ha.h(this.$).Hf.gm(La.yJa),this.Du=!0,2===this.$n?(this.Mx(!1),this.dF=0,this.Ph=this.Xq?[11]:[12],this.Yq=this.Xq,this.ZQa(),this.hJ()):3===this.$n?(this.t3(!1),this.dF=this.isRow?1:
2,this.sO(),this.Xy()):1===this.$n&&(this.Wha(!1),this.sO(),this.Xy())),!0}else if(!this.Cu&&(Fa.Ca.keyCode===ra.a.w1||l.a.isMac&&Fa.Ca.keyCode===ra.a.Zea))return pa.KeyInputManager.instance.ta(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),ha.h(this.$).Hf.gm(cc.y1a),this.Cu=!0;return!1};this.onKeyUp=Fa=>{if(this.Zh){if(this.k5(Fa)||Fa.Ca.keyCode===ra.a.y8)return this.lCb=this.k5(Fa)?0:1,this.Cp&&ha.h(this.$).Hf.gm(La.yJa),Fa.Ca.keyCode===ra.a.y8&&(2===this.$n?(this.t3(!1),this.dF=0,this.sO(!0),
this.Xy(!0)):3===this.$n?(this.Mx(!1),this.dF=this.isRow?1:2,this.Ph=this.isRow?[11]:[12],this.ZQa(!0),this.hJ(!0)):1===this.$n&&(this.Mx(!1),this.Ph=this.Xq?[11]:[12],this.wAa(!0),this.hJ(!0))),this.cpa(this.lCb),!0}else if(Fa.Ca.keyCode===ra.a.w1||l.a.isMac&&Fa.Ca.keyCode===ra.a.Zea)return this.cpa(),this.Cp&&ha.h(this.$).Hf.gm(La.D8c),!0;return!1};this.dL=Fa=>{Fa=X.a(this.$).Vd(Fa);5===this.nh?this.xDd(Fa):(this.Cp=!1,this.qb.Xg(this.Ph),!this.$.Yp([this.hb],!1)||this.qJd()||this.VAb()||(this.ha.sourceRange=
this.sourceRange.clone(),this.Zh?this.NHd():this.Sub(),this.ty()?this.hb.top>this.sourceRange.top&&(Fa=this.hb.height,this.hb.top-=Fa,this.hb.bottom-=Fa):this.hb.left>this.sourceRange.left&&(Fa=this.hb.width,this.hb.left-=Fa,this.hb.right-=Fa),this.rG()));this.wt(this.cL,this.dL);this.tableRange=null;this.nh=-1;this.Zh&&(this.gA=null,this.$n=0);return!0};this.O6=()=>{this.Cp=!1;this.$n=0;this.qb.Xg(this.Ph);if(!this.$.Yp([this.hb],!1))return this.wt(this.N6,this.O6),this.nh=-1,!0;if(!(this.ha.ra.$c.equals(this.hb)||
this.Gba(this.hb)||this.Gba(this.sourceRange)||this.VAb()||(this.rG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[v.a.oaa]:this.Cu,[v.a.v8b]:!0,[v.a.x8b]:this.Yq,[v.a.IU]:this.ha.sourceRange,[v.a.HU]:this.ha.ra.$c,[v.a.vJa]:this.Du}),this.Cu))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Yq)){var Fa=this.hb.height;this.hb.top-=Fa;this.hb.bottom-=Fa}else this.hb.left>this.sourceRange.left&&(this.hf||this.hb.top===this.sourceRange.top&&
!this.Yq)&&(Fa=this.hb.width,this.hb.left-=Fa,this.hb.right-=Fa);this.rG()}this.wt(this.N6,this.O6);this.gA=this.tableRange=null;this.nh=-1;this.Yq=!1;return!0};this.cL=Fa=>{var Ab=W.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ab&&(Fa=X.a(this.$).Vd(Fa));var $b=Fa.clientPoint;Ab||(Fa=X.a(this.$).Vd(Fa));this.Zh&&(this.Yw=Fa);if(Fa=this.ha.io($b,Fa.Gb,5,void 0,void 0,!0)){if(this.tableRange.contains(Fa.topLeft)){Ab=ha.h(this.$);const Rb=Ab.fg(Fa);var Cb=Ab.Bf(this.paneType);
$b=ka.a.Us(Cb.view.ei,this.domElement.parentNode,$b,Ab.rtl);Cb=!1;let uc=2;this.ty()&&$b.y-Rb.topLeft.y>Rb.height/2?(Cb=!0,uc=1):!this.ty()&&$b.x-Rb.topLeft.x>Rb.width/2&&(Cb=!0);if(Cb){Ab=Ab.kk("DragSelectionClickBehavior.OnPointerMoveRearrange",Ab.IH,uc);try{Ab.Gs(Fa),Ab.$$mn(),Fa=Ab.$$cu().range}finally{Ab&&Ab.dispose()}}this.hb=this.l3(Fa);this.ha.sourceRange=this.hb;this.qb.Ti(this.hb,this.Ph);this.qb.Sn(this.Ph);this.qb.Xg(this.mB());if(6!==this.nh){for(Fa=1;4>=Fa;Fa++)Ab=this.Rg[Fa.toString()],
Ab.parentNode.removeChild(Ab),this.qb.Bv(this.ty()?11:12,Fa).xf.appendChild(Ab);this.nh=6}}else if(this.hb=this.Oha(Fa),this.Zh)this.Vxb(!1);else if(this.qb.Ti(this.hb,this.mB()),this.qb.Sn(this.mB()),this.qb.Xg(this.Ph),5!==this.nh){for(Fa=1;4>=Fa;Fa++)Ab=this.Rg[Fa.toString()],Ab.parentNode.removeChild(Ab),this.qb.Bv(this.Zaa(),Fa).xf.appendChild(Ab);this.nh=5}this.Sy()}return!0};this.N6=Fa=>{var Ab=W.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ab&&(Fa=X.a(this.$).Vd(Fa));
var $b=Fa.clientPoint;Ab||(Fa=X.a(this.$).Vd(Fa));this.Yw=Fa;if(Ab=this.ha.io($b,Fa.Gb,5,void 0,void 0,!0)){if(this.kyb(Ab))return this.hb=this.Oha(Ab),this.Uxb(!1),!0;var Cb=ha.h(this.$),Rb=Cb.fg(Ab),uc=Cb.Bf(this.paneType);$b=ka.a.Us(uc.view.ei,this.domElement.parentNode,$b,Cb.rtl);uc=!1;let nb=2;this.Yq=!1;if(this.isRow||this.hf){this.isRow&&$b.y-Rb.topLeft.y>Rb.height/2?(uc=!0,nb=1):this.hf&&$b.x-Rb.topLeft.x>Rb.width/2&&(uc=!0);if(uc){Fa=Cb.kk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
Cb.IH,nb);try{Fa.Gs(Ab),Fa.$$mn(),Ab=Fa.$$cu().range}finally{Fa&&Fa.dispose()}}this.hb=this.Oha(Ab)}else{$b.x-Rb.topLeft.x===Rb.width?(this.Yq=!1,uc=!0):$b.y-Rb.topLeft.y>Rb.height/2&&(this.Yq=uc=!0,nb=1);this.gA&&(this.Yq=this.Xq);if(uc){Cb=Cb.kk("DragSelectionClickBehavior.OnPointerMoveDragInsert",Cb.IH,nb);try{Cb.Gs(Ab),Cb.$$mn(),Ab=Cb.$$cu().range}finally{Cb&&Cb.dispose()}}this.qb.Xg(this.Ph);this.Ph=this.Yq?[11]:[12];for(Cb=1;4>=Cb;Cb++)(Rb=this.Rg[Cb.toString()])&&Rb.parentNode.removeChild(Rb),
this.Rg[Cb.toString()]=null;this.dA(Fa.clientPoint,Fa.Gb,this.Yq?11:12,!0);this.hb=this.l3(Ab)}this.ha.sourceRange=this.hb;this.qb.Ti(this.hb,this.Ph);this.qb.Sn(this.Ph);this.qb.Xg(this.mB());if(6!==this.nh){for(Fa=1;4>=Fa;Fa++)Ab=this.Rg[Fa.toString()],Ab.parentNode.removeChild(Ab),this.qb.Bv(this.isRow||this.Yq?11:12,Fa).xf.appendChild(Ab);this.nh=6}this.Sy()}return!0};this.Cg=()=>{this.domElement.classList.remove(ea.selecting)};this.Mp=()=>{this.domElement.classList.add(ea.selecting)};this.Pc=
()=>{if(this.$.isEditMode){const Fa=this.koa();this.iBa(Fa)}};this.Ema=()=>{this.Zh?this.Cp&&5<=this.nh&&(this.tableRange?this.Du?this.Mx(!0):this.Wha(!0):this.Du?this.isRow||this.hf?this.Mx(!0):this.t3(!0):this.isRow||this.hf?this.t3(!0):this.Mx(!0)):this.Cp&&5<=this.nh&&(this.tableRange?(this.qb.Xg(this.Ph),this.wt(this.cL,this.dL)):(this.qb.Xg(this.mB()),this.wt(this.Gh,this.Pf)))};this.tableManager=dc;W.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.iBa(this.koa()&&
this.$.isEditMode);this.tableRange=null;this.Rg={};this.t5=this.Du=this.Cu=this.Cp=!1;this.ha.S2(this.Mp);this.ha.FY(this.Cg);this.ha.X_b(this.Ema);this.ha.KE(this.Pc);this.Ogb=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.t7(this.Mp),this.ha.JW(this.Cg),this.ha.WJb(this.Ema),this.ha.FI(this.Pc));if(this.Rg)for(let na=1;4>=na;na++)A.DOMElementExtensions.uf(this.Rg[na.toString()]);this.Rg=this.Ph=null;this.Cu&&this.cpa();this.Zh&&this.Du&&this.cpa(1);
super.dispose()}Epc(na){this.Zh&&(this.Yw=na,this.gA=null,this.Xq=this.isRow=this.hf=this.Yq=!1,pa.KeyInputManager.instance.ta(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown));this.Cp=!0;this.tableRange=this.a0c(this.tableManager.Cn(this.sourceRange.topLeft));ha.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.gA=this.tableRange,this.$n=1,this.Ph=(this.Xq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:
[12],this.nh=6,this.ex(this.cL,this.dL),this.yH=this.Lia,this.TI=this.hoa,this.dA(na.clientPoint,na.Gb,this.Xq?11:12,!0,!0),this.hJ(!0)):(this.Ph=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.ex(this.cL,this.dL),this.dA(na.clientPoint,na.Gb,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.hf=this.sourceRange.hf,this.isRow||this.hf?(this.$n=3,this.dF=this.isRow?1:2,this.nh=
6,this.Ph=this.isRow?[11]:[12],this.ex(this.N6,this.O6),this.yH=this.Lia,this.TI=this.hoa,this.dA(na.clientPoint,na.Gb,this.isRow?11:12,!0,!0),this.hJ(!0)):(this.$n=2,this.dF=0,this.ex(this.Gh,this.Pf),this.yH=this.Ttb,this.TI=this.SMb,this.dA(na.clientPoint,na.Gb,this.Zaa(),!1,!0),this.Xy(!0))):(this.ex(this.Gh,this.Pf),pa.KeyInputManager.instance.ta(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.dF=this.sourceRange.isRow?1:this.sourceRange.hf?2:0,this.dA(na.clientPoint,na.Gb,this.Zaa(),
!1),this.Xy()))}uza(){this.Cp=!1;this.Zh&&(this.$n=0);this.qb.Xg(this.mB());if(!this.$.Yp([this.hb],!1))return this.wt(this.Gh,this.Pf),this.nh=-1,!0;if(this.ha.ra.$c.equals(this.hb)||this.Gba(this.hb)||this.Gba(this.sourceRange))this.nh=-1;else{this.rG();this.ha.sourceRange=this.sourceRange.clone();const na=this.ha.sourceRange,jb=this.ha.ra.$c;this.Zh?this.$.Xc(-694765314,2,30,{[v.a.oaa]:this.Cu,[v.a.IU]:na,[v.a.HU]:jb,[v.a.vJa]:this.Du}):this.$.Xc(-694765314,2,30,{[v.a.oaa]:this.Cu,[v.a.IU]:na,
[v.a.HU]:jb})}!this.Zh&&this.tableRange||this.wt(this.Gh,this.Pf);return!0}I1c(na){na&&(pa.KeyInputManager.instance.Ba(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.Zh&&ha.h(this.$).Hf.gm(v.a.QQ),this.Cp=!1);for(na=1;4>=na;na++){const jb=this.Rg[na.toString()];jb&&jb.parentNode.removeChild(jb);this.Rg[na.toString()]=null}this.Ph=null}Hpc(na){const jb=this.ha.io(na.clientPoint,na.Gb,5,void 0,void 0,!0);this.Yw=na;return this.kyb(jb)?(this.hb=this.l3(jb),this.Uxb(!0),!0):this.Lkd(jb)?
(this.hb=this.Oha(jb),this.Vxb(!0),!0):!1}kyb(na){return!!this.gA&&1!==this.$n&&!!na&&this.gA.contains(na.topLeft)}Lkd(na){return!!this.gA&&1===this.$n&&!!na&&!this.gA.contains(na.topLeft)}Uxb(na){this.tableRange=this.gA;this.$n=1;const jb=!this.Du;na?(this.Mx(!1),this.Ph=this.Xq?[11]:[12],this.wAa(jb),this.hJ(jb)):(this.t3(!1),this.sO(jb),this.Xy(jb))}Vxb(na){this.tableRange=null;this.$n=2;const jb=!this.Du;na?(this.Mx(!1),this.Ph=this.Xq?[11]:[12],this.Yq=this.Xq,this.ZQa(jb),this.hJ(jb)):(this.Wha(!1),
this.sO(jb),this.Xy(jb))}idc(){return this.ha.ra.$c}rG(){this.ha.updateSelection(this.hb,this.hb.topLeft,0);return!0}Xy(na=!1){this.qb.Ti(this.hb,this.mB());this.qb.Sn(this.mB());this.Sy(na);return!0}hJ(na=!1){this.qb.Ti(this.hb,this.Ph);this.qb.Sn(this.Ph);this.Sy(na)}Zub(){n.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}fCc(){return!1}koa(){if(!ha.h(this.$).ha.ra.Og)return!1;const na=ha.h(this.$).getRangeInformation(this.ha.ra.$c);
for(const jb of na)if(Object(fa.a)(aa.PivotTableRange,jb))return!1;return!0}a0c(na){if(na&&na.contains(this.sourceRange)&&!na.equals(this.sourceRange)){if(na.pba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===na.top){const jb=new ja.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,this.sourceRange.right,!1,!1);if(!jb.equals(na))return this.sourceRange=jb,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),na}this.Zh?this.Xq=na.left===this.sourceRange.left&&
na.right===this.sourceRange.right:this.isRow=na.left===this.sourceRange.left&&na.right===this.sourceRange.right;if(na.top===this.sourceRange.top&&na.bottom===this.sourceRange.bottom||this.ty())return na}return null}l3(na){const jb=na.clone();this.ty()?jb.left=Math.max(na.left-this.ofc,1):jb.top=Math.max(na.top-this.sEc,1);jb.right=jb.left+this.sourceRange.width-1;jb.bottom=jb.top+this.sourceRange.height-1;return this.QZa(jb)}VAb(){const na=this.hb.topLeft.Bd(this.sourceRange);return na||this.Zh&&
!this.tableRange?na:this.ty()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+1}qJd(){if(this.ty()&&this.hb.left!==this.tableRange.left||!this.ty()&&this.hb.top!==this.tableRange.top){const na=qa.a.Zc(1,1,0,915,0,2065438552,"RearrangeInvalidDest");ib.a(this.$).Pr([na]);return!0}return!1}NHd(){const na=this.$.Jb.Ac("UserAction","RearrangeRowColumnClientSide"),jb={["CopyPasteTargetType"]:1,["OperationId"]:ba.a.create().toString(),["Stopwatch"]:na,["DragDropIsShiftKeyDown"]:this.Du,
["EncounteredDeploymentErrors"]:!1},Ib=this.Cu?2:1,dc=this.$.da.za(254);(new Promise((ob,Fa)=>{this.Sub(Ab=>{Ab.Errors&&0<Ab.Errors.length?Fa(new Va.a(22,Ab.Errors)):ob(!0)},Ab=>{Ab=ta.a.Pe(Ab.data);Fa(new Va.a(22,Ab))})})).then(()=>{n.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="1"');dc&&dc.Mqf(jb,Ib,this.sourceRange,this.hb);return Promise.resolve(!0)},ob=>{n.ULS.sendTraceTag(537159382,0,10,`DragSelectionClickBehavior.RearrangeRowColumn: ${ob?
copyPasteInfra.getStringifiedError(ob):"null"}, copyPasteTargetType="${1}"`);return dc?dc.CFf(ob,jb,Ib,this.sourceRange,this.hb):Promise.reject(ob)})}Sub(na=null,jb=null){const Ib={};this.ty()?(Ib.FirstRow=this.hb.top-1,Ib.FirstColumn=0,Ib.DeltaColumn=0,Ib.DeltaRow=this.hb.bottom-this.hb.top+1):(Ib.FirstRow=0,Ib.FirstColumn=this.hb.left-1,Ib.DeltaColumn=this.hb.right-this.hb.left+1,Ib.DeltaRow=0);Ib.LastRow=U.a.Lz;Ib.LastColumn=U.a.Qw;Ib.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Cb.getItemByName(this.$.Cb.oa.name).sheetName;
const dc=bb.v(this.sourceRange,this.$);this.$.userOperationManager.Ic(new wa.a(514,0,(ob,Fa,Ab)=>gb(this.$.pa.ya,dc,Ib,na?rb.b(ob,na):ob,jb?rb.a(Fa,jb):Fa,Ab,null),64,()=>new Ga(dc,Ib)),null)}Gba(na){na=ha.h(this.$).getRangeInformation(na);for(let jb=0,Ib=na.length;jb<Ib;++jb)if(Object(fa.a)(aa.PivotTableRange,na[jb]))return na=qa.a.Zc(1,0,0,900,0,2105176604,"InsDelCellsPivotTable"),ib.a(this.$).Pr([na]),!0;return!1}dA(na,jb,Ib,dc,ob=!1){var Fa=A.DOMElementExtensions.getBoundingClientRect(jb);let Ab=
jb===this.ls[La.xJa]||jb===this.ls[La.G8c];if(this.Zh){var $b=jb===this.ls[La.H8c]||jb===this.ls[La.wJa];this.isRow&&$b||this.hf&&Ab?$b="100px":(Ab=this.isRow||Ab,$b=(Ab?ob?cc.dZd:cc.jZd:ob?cc.cZd:cc.gZd)+"px");jb=Ab?jb===this.ls[La.xJa]?"top":"bottom":jb===this.ls[La.wJa]?"right":"left";na=100*(Ab?na.x-Fa.x:na.y-Fa.y)/(Ab?Fa.width:Fa.height);for(Fa=1;4>=Fa;Fa++){dc=document.createElement("div");var Cb=document.createElement("div");const Rb=document.createElement("div");dc.appendChild(Cb);dc.appendChild(Rb);
ob&&(Cb=document.createElement("div"),dc.appendChild(Cb),Rb.style.fontWeight="bold");dc.className=ea.qUe;this.Rg[Fa.toString()]=dc;this.qb.Bv(Ib,Fa).xf.appendChild(dc);dc=this.Rg[Fa.toString()];dc.style[jb]=$b;dc.style[Ab?"left":"top"]=na+"%"}}else for(ob=(Ab?-cc.iZd:-cc.fZd)+"px",$b=Ab?jb===this.ls[La.xJa]?"top":"bottom":jb===this.ls[La.wJa]||dc?"right":"left",jb=100*(Ab?dc?0:na.x-Fa.x:na.y-Fa.y)/(Ab?Fa.width:Fa.height),na=1;4>=na;na++)Fa=document.createElement("div"),Fa.className=ea.pUe,this.Rg[na.toString()]=
Fa,this.qb.Bv(Ib,na).xf.appendChild(Fa),Fa=this.Rg[na.toString()],Fa.style[$b]=ob,Fa.style[Ab?"left":"top"]=jb+"%"}Sy(na=!1){const jb=this.hb.toString();if(this.Zh)for(var Ib=1;4>=Ib;Ib++)if(this.Ogb){const dc=this.Rg[Ib.toString()];dc&&dc.childNodes&&0<dc.childNodes.length&&(dc.childNodes[0].innerText=jb,dc.childNodes[1].innerText=this.yH,na&&(dc.childNodes[2].innerText=this.TI))}else this.Rg[Ib.toString()].childNodes[0].innerText=jb,this.Rg[Ib.toString()].childNodes[1].innerText=this.yH,na&&(this.Rg[Ib.toString()].childNodes[2].innerText=
this.TI);else for(na=1;4>=na;na++)if(this.Ogb){if(Ib=this.Rg[na.toString()])Ib.innerText=jb}else this.Rg[na.toString()].innerText=jb}cpa(na=0){0===na?this.Cu=!1:1===na&&(this.Du=!1);this.Zh&&(this.Cu||this.Du)||(pa.KeyInputManager.instance.Ba(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.t5=!1)}Mx(na){this.qb.Xg(this.mB());this.wt(this.Gh,this.Pf,void 0,na)}t3(na){this.qb.Xg(this.Ph);this.wt(this.N6,this.O6,void 0,na)}Wha(na){this.qb.Xg(this.Ph);this.wt(this.cL,this.dL,void 0,na)}sO(na=
!1){this.nh=5;this.ex(this.Gh,this.Pf);this.yH=this.Ttb;this.TI=this.SMb;this.dA(this.Yw.clientPoint,this.Yw.Gb,this.Zaa(),!1,na)}ZQa(na=!1){this.nh=6;this.ex(this.N6,this.O6);this.yH=this.Lia;this.TI=this.hoa;this.dA(this.Yw.clientPoint,this.Yw.Gb,this.isRow||this.Xq?11:12,!0,na)}wAa(na=!1){this.nh=6;this.ex(this.cL,this.dL);this.yH=this.Lia;this.TI=this.hoa;this.dA(this.Yw.clientPoint,this.Yw.Gb,this.ty()?11:12,!0,na)}k5(na){return na.Ca.keyCode===ra.a.w1||l.a.isMac&&na.Ca.keyCode===ra.a.Zea}ty(){return!this.Zh&&
this.isRow||this.Zh&&this.Xq}Zaa(){return this.Zh?48:6}mB(){return this.Zh?cc.F8c:cc.I8c}}cc.fZd=50;cc.iZd=25;cc.gZd=-85;cc.jZd=-40;cc.cZd=-120;cc.dZd=-50;cc.y1a="copy";cc.I8c=[6];cc.F8c=[48];Object(u.a)(cc,"DragSelectionClickBehavior",La,[]);var ic=a(82);class xb extends La{constructor(na,jb,Ib,dc,ob){super(na,jb,Ib,ob);this.Ph=null;this.hf=this.isRow=!1;this.Cg=()=>{this.domElement.classList.remove(ea.selecting)};this.Mp=()=>{this.domElement.classList.add(ea.selecting)};this.Pc=()=>{if(this.$.isEditMode){const Fa=
this.koa();this.iBa(Fa)}};this.tableManager=dc;W.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.iBa(this.koa()&&this.$.isEditMode);this.Rg={};this.Cp=!1;this.ha.S2(this.Mp);this.ha.FY(this.Cg);this.ha.KE(this.Pc);this.Ogb=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.t7(this.Mp),this.ha.JW(this.Cg),this.ha.FI(this.Pc),W.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ha.WJb(this.Ema));
if(this.Rg)for(let na=1;4>=na;na++)A.DOMElementExtensions.uf(this.Rg[na.toString()]);this.Rg=this.Ph=null;super.dispose()}I1c(na){na&&(this.Zh&&ha.h(this.$).Hf.gm(v.a.QQ),pa.KeyInputManager.instance.Ba(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.Cp=!1);for(na=1;4>=na;na++){const jb=this.Rg[na.toString()];jb&&jb.parentNode.removeChild(jb);this.Rg[na.toString()]=null}this.Ph=null}idc(){return this.ha.ra.$c}rG(){this.ha.updateSelection(this.hb,this.hb.topLeft,0);return!0}Xy(na=!1){this.qb.Ti(this.hb,
this.mB());this.qb.Sn(this.mB());this.Sy(na);return!0}hJ(na=!1){this.qb.Ti(this.hb,this.Ph);this.qb.Sn(this.Ph);this.Sy(na)}Zub(){n.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}fCc(){return!1}dA(na,jb,Ib,dc,ob=!1){var Fa=A.DOMElementExtensions.getBoundingClientRect(jb);let Ab=jb===this.ls[La.xJa]||jb===this.ls[La.G8c];if(this.Zh){var $b=jb===this.ls[La.H8c]||jb===this.ls[La.wJa];this.isRow&&$b||this.hf&&
Ab?$b="100px":(Ab=this.isRow||Ab,$b=(Ab?ob?xb.dZd:xb.jZd:ob?xb.cZd:xb.gZd)+"px");jb=Ab?jb===this.ls[La.xJa]?"top":"bottom":jb===this.ls[La.wJa]?"right":"left";na=100*(Ab?na.x-Fa.x:na.y-Fa.y)/(Ab?Fa.width:Fa.height);for(Fa=1;4>=Fa;Fa++){dc=document.createElement("div");var Cb=document.createElement("div");const Rb=document.createElement("div");dc.appendChild(Cb);dc.appendChild(Rb);ob&&(Cb=document.createElement("div"),dc.appendChild(Cb),Rb.style.fontWeight="bold");dc.className=ea.qUe;this.Rg[Fa.toString()]=
dc;this.qb.Bv(Ib,Fa).xf.appendChild(dc);dc=this.Rg[Fa.toString()];dc.style[jb]=$b;dc.style[Ab?"left":"top"]=na+"%"}}else for(ob=(Ab?-xb.iZd:-xb.fZd)+"px",$b=Ab?jb===this.ls[La.xJa]?"top":"bottom":jb===this.ls[La.wJa]||dc?"right":"left",jb=100*(Ab?dc?0:na.x-Fa.x:na.y-Fa.y)/(Ab?Fa.width:Fa.height),na=1;4>=na;na++)Fa=document.createElement("div"),Fa.className=ea.pUe,this.Rg[na.toString()]=Fa,this.qb.Bv(Ib,na).xf.appendChild(Fa),Fa=this.Rg[na.toString()],Fa.style[$b]=ob,Fa.style[Ab?"left":"top"]=jb+"%"}Khg(na,
jb,Ib){const dc=ha.h(this.$),ob=dc.fg(na);var Fa=dc.Bf(this.paneType);Ib=ka.a.Us(Fa.view.ei,this.domElement.parentNode,Ib,dc.rtl);Fa=!1;let Ab=2;jb&&Ib.y-ob.topLeft.y>ob.height/2?(Fa=!0,Ab=1):!jb&&Ib.x-ob.topLeft.x>ob.width/2&&(Fa=!0);if(Fa){jb=dc.kk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",dc.IH,Ab);try{jb.Gs(na),jb.$$mn(),jb.$$cu()}finally{jb&&jb.dispose()}}}Wha(na){this.qb.Xg(this.Ph);this.wt(this.cL,this.dL,void 0,na)}Mx(na){this.qb.Xg(this.mB());this.wt(this.Gh,this.Pf,
void 0,na)}Zaa(){return this.Zh?48:6}mB(){return this.Zh?xb.F8c:xb.I8c}k5(na){return na.Ca.keyCode===ra.a.w1||l.a.isMac&&na.Ca.keyCode===ra.a.Zea}Gba(na){na=ha.h(this.$).getRangeInformation(na);for(let jb=0,Ib=na.length;jb<Ib;++jb)if(Object(fa.a)(aa.PivotTableRange,na[jb]))return na=qa.a.Zc(1,0,901,900,0,2105176604,"InsDelCellsPivotTable"),ib.a(this.$).Pr([na]),!0;return!1}}xb.fZd=50;xb.iZd=25;xb.gZd=-85;xb.jZd=-40;xb.cZd=-120;xb.dZd=-50;xb.I8c=[6];xb.F8c=[48];Object(u.a)(xb,"DragSelectionClickBehaviorTemporary",
La,[]);class Vb extends xb{constructor(na,jb,Ib,dc,ob){super(na,jb,Ib,dc,ob);this.gA=null;this.Xq=this.Yq=!1;this.lCb=0;this.TI=this.yH=null;this.$n=0;this.Lia=Ka.a.instance.ga(2263);this.Ttb=Ka.a.instance.ga(2264);this.hoa=Ka.a.instance.ga(2265);this.SMb=Ka.a.instance.ga(2266);this.onKeyDown=Fa=>{if(this.Zh){if(this.k5(Fa)||Fa.Ca.keyCode===ra.a.y8)return this.t5||(pa.KeyInputManager.instance.ta(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.t5=!0),!this.Cu&&this.k5(Fa)&&(ha.h(this.$).Hf.gm(La.y1a),
this.Cu=!0),this.Du||Fa.Ca.keyCode!==ra.a.y8||(ha.h(this.$).Hf.gm(La.yJa),this.Du=!0,2===this.$n?(this.Mx(!1),this.dF=0,this.Ph=this.Xq?[11]:[12],this.Yq=this.Xq,this.ZQa(),this.hJ()):3===this.$n?(this.t3(!1),this.dF=this.isRow?1:2,this.sO(),this.Xy()):1===this.$n&&(this.Wha(!1),this.sO(),this.Xy())),!0}else if(!this.Cu&&(Fa.Ca.keyCode===ra.a.w1||l.a.isMac&&Fa.Ca.keyCode===ra.a.Zea))return pa.KeyInputManager.instance.ta(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),ha.h(this.$).Hf.gm(La.y1a),
this.Cu=!0;return!1};this.onKeyUp=Fa=>{if(this.Zh){if(this.k5(Fa)||Fa.Ca.keyCode===ra.a.y8)return this.lCb=this.k5(Fa)?0:1,this.Cp&&ha.h(this.$).Hf.gm(La.yJa),Fa.Ca.keyCode===ra.a.y8&&(2===this.$n?(this.t3(!1),this.dF=0,this.sO(!0),this.Xy(!0)):3===this.$n?(this.Mx(!1),this.dF=this.isRow?1:2,this.Ph=this.isRow?[11]:[12],this.ZQa(!0),this.hJ(!0)):1===this.$n&&(this.Mx(!1),this.Ph=this.Xq?[11]:[12],this.wAa(!0),this.hJ(!0))),this.cpa(this.lCb),!0}else if(Fa.Ca.keyCode===ra.a.w1||l.a.isMac&&Fa.Ca.keyCode===
ra.a.Zea)return this.cpa(),this.Cp&&ha.h(this.$).Hf.gm(La.D8c),!0;return!1};this.dL=Fa=>{Fa=X.a(this.$).Vd(Fa);5===this.nh?this.xDd(Fa):(this.Cp=!1,this.qb.Xg(this.Ph),!this.$.Yp([this.hb],!1)||this.qJd()||this.VAb()||(this.ha.sourceRange=this.sourceRange.clone(),this.Zh?this.NHd():this.Sub(),this.ty()?this.hb.top>this.sourceRange.top&&(Fa=this.hb.height,this.hb.top-=Fa,this.hb.bottom-=Fa):this.hb.left>this.sourceRange.left&&(Fa=this.hb.width,this.hb.left-=Fa,this.hb.right-=Fa),this.rG()),this.Wvd());
this.wt(this.cL,this.dL);this.tableRange=null;this.nh=-1;this.Zh&&(this.gA=null,this.$n=0);return!0};this.O6=()=>{this.Cp=!1;this.$n=0;this.qb.Xg(this.Ph);if(!this.$.Yp([this.hb],!1))return this.wt(this.N6,this.O6),this.nh=-1,!0;if(!(this.ha.ra.$c.equals(this.hb)||this.Gba(this.hb)||this.Gba(this.sourceRange)||this.VAb()||(this.rG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[v.a.oaa]:this.Cu,[v.a.v8b]:!0,[v.a.x8b]:this.Yq,[v.a.IU]:this.ha.sourceRange,[v.a.HU]:this.ha.ra.$c,
[v.a.vJa]:this.Du}),this.Cu))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Yq)){var Fa=this.hb.height;this.hb.top-=Fa;this.hb.bottom-=Fa}else this.hb.left>this.sourceRange.left&&(this.hf||this.hb.top===this.sourceRange.top&&!this.Yq)&&(Fa=this.hb.width,this.hb.left-=Fa,this.hb.right-=Fa);this.rG()}this.wt(this.N6,this.O6);this.gA=this.tableRange=null;this.nh=-1;this.Yq=!1;this.Wvd();return!0};this.cL=Fa=>{const Ab=W.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
Ab&&(Fa=X.a(this.$).Vd(Fa));var $b=Fa.clientPoint;Ab||(Fa=X.a(this.$).Vd(Fa));this.Zh&&(this.Yw=Fa);if(Fa=this.ha.io($b,Fa.Gb,5,void 0,void 0,!0)){if(this.tableRange.contains(Fa.topLeft)){if(this.Khg(Fa,this.ty(),$b),this.hb=this.l3(Fa),this.ha.sourceRange=this.hb,this.qb.Ti(this.hb,this.Ph),this.qb.Sn(this.Ph),this.qb.Xg(this.mB()),6!==this.nh){for($b=1;4>=$b;$b++)Fa=this.Rg[$b.toString()],Fa.parentNode.removeChild(Fa),this.qb.Bv(this.ty()?11:12,$b).xf.appendChild(Fa);this.nh=6}}else if(this.hb=
this.Oha(Fa),this.Zh)this.Vxb(!1);else if(this.qb.Ti(this.hb,this.mB()),this.qb.Sn(this.mB()),this.qb.Xg(this.Ph),5!==this.nh){for($b=1;4>=$b;$b++)Fa=this.Rg[$b.toString()],Fa.parentNode.removeChild(Fa),this.qb.Bv(this.Zaa(),$b).xf.appendChild(Fa);this.nh=5}this.Sy()}return!0};this.N6=Fa=>{var Ab=W.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ab&&(Fa=X.a(this.$).Vd(Fa));var $b=Fa.clientPoint;Ab||(Fa=X.a(this.$).Vd(Fa));this.Yw=Fa;if(Ab=this.ha.io($b,Fa.Gb,5,
void 0,void 0,!0)){if(this.kyb(Ab))return this.hb=this.Oha(Ab),this.Uxb(!1),!0;var Cb=ha.h(this.$),Rb=Cb.fg(Ab),uc=Cb.Bf(this.paneType);$b=ka.a.Us(uc.view.ei,this.domElement.parentNode,$b,Cb.rtl);uc=!1;let nb=2;this.Yq=!1;if(this.isRow||this.hf){this.isRow&&$b.y-Rb.topLeft.y>Rb.height/2?(uc=!0,nb=1):this.hf&&$b.x-Rb.topLeft.x>Rb.width/2&&(uc=!0);if(uc){Fa=Cb.kk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Cb.IH,nb);try{Fa.Gs(Ab),Fa.$$mn(),Ab=Fa.$$cu().range}finally{Fa&&Fa.dispose()}}this.hb=
this.Oha(Ab)}else{$b.x-Rb.topLeft.x===Rb.width?(this.Yq=!1,uc=!0):$b.y-Rb.topLeft.y>Rb.height/2&&(this.Yq=uc=!0,nb=1);this.gA&&(this.Yq=this.Xq);if(uc){Cb=Cb.kk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Cb.IH,nb);try{Cb.Gs(Ab),Cb.$$mn(),Ab=Cb.$$cu().range}finally{Cb&&Cb.dispose()}}this.qb.Xg(this.Ph);this.Ph=this.Yq?[11]:[12];for(Cb=1;4>=Cb;Cb++)(Rb=this.Rg[Cb.toString()])&&Rb.parentNode.removeChild(Rb),this.Rg[Cb.toString()]=null;this.dA(Fa.clientPoint,Fa.Gb,this.Yq?11:
12,!0);this.hb=this.l3(Ab)}this.ha.sourceRange=this.hb;this.qb.Ti(this.hb,this.Ph);this.qb.Sn(this.Ph);this.qb.Xg(this.mB());if(6!==this.nh){for(Fa=1;4>=Fa;Fa++)Ab=this.Rg[Fa.toString()],Ab.parentNode.removeChild(Ab),this.qb.Bv(this.isRow||this.Yq?11:12,Fa).xf.appendChild(Ab);this.nh=6}this.Sy()}return!0};this.Ema=()=>{this.Zh?this.Cp&&5<=this.nh&&(this.tableRange?this.Du?this.Mx(!0):this.Wha(!0):this.Du?this.isRow||this.hf?this.Mx(!0):this.t3(!0):this.isRow||this.hf?this.t3(!0):this.Mx(!0)):this.Cp&&
5<=this.nh&&(this.tableRange?(this.qb.Xg(this.Ph),this.wt(this.cL,this.dL)):(this.qb.Xg(this.mB()),this.wt(this.Gh,this.Pf)))};this.tableRange=null;this.t5=this.Cu=this.Du=!1;this.ha.X_b(this.Ema)}dispose(){W.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.WJb(this.Ema);this.Cu&&this.cpa();this.Zh&&this.Du&&this.cpa(1);super.dispose()}Epc(na){this.Zh&&(this.Yw=na,this.gA=null,this.Xq=this.isRow=this.hf=this.Yq=!1,pa.KeyInputManager.instance.ta(t.a.Pb,
this.domElement.ownerDocument.body,this.onKeyDown));this.Cp=!0;this.tableRange=this.a0c(this.tableManager.Cn(this.sourceRange.topLeft));ha.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.gA=this.tableRange,this.$n=1,this.Ph=(this.Xq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.ex(this.cL,this.dL),this.yH=this.Lia,this.TI=this.hoa,this.dA(na.clientPoint,na.Gb,this.Xq?11:12,!0,!0),this.hJ(!0)):
(this.Ph=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.ex(this.cL,this.dL),this.dA(na.clientPoint,na.Gb,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.hf=this.sourceRange.hf,this.isRow||this.hf?(this.$n=3,this.dF=this.isRow?1:2,this.nh=6,this.Ph=this.isRow?[11]:[12],this.ex(this.N6,this.O6),this.yH=this.Lia,this.TI=this.hoa,this.dA(na.clientPoint,na.Gb,this.isRow?11:12,
!0,!0),this.hJ(!0)):(this.$n=2,this.dF=0,this.ex(this.Gh,this.Pf),this.yH=this.Ttb,this.TI=this.SMb,this.dA(na.clientPoint,na.Gb,this.Zaa(),!1,!0),this.Xy(!0))):(this.ex(this.Gh,this.Pf),pa.KeyInputManager.instance.ta(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.dF=this.sourceRange.isRow?1:this.sourceRange.hf?2:0,this.dA(na.clientPoint,na.Gb,this.Zaa(),!1),this.Xy()))}uza(){this.Cp=!1;this.Zh&&(this.$n=0);this.qb.Xg(this.mB());if(!this.$.Yp([this.hb],!1))return this.wt(this.Gh,this.Pf),
this.nh=-1,!0;if(this.ha.ra.$c.equals(this.hb)||this.Gba(this.hb)||this.Gba(this.sourceRange))this.nh=-1;else{this.rG();this.ha.sourceRange=this.sourceRange.clone();const na=this.ha.sourceRange,jb=this.ha.ra.$c;this.Zh?this.$.Xc(-694765314,2,30,{[v.a.oaa]:this.Cu,[v.a.IU]:na,[v.a.HU]:jb,[v.a.vJa]:this.Du}):this.$.Xc(-694765314,2,30,{[v.a.oaa]:this.Cu,[v.a.IU]:na,[v.a.HU]:jb})}!this.Zh&&this.tableRange||this.wt(this.Gh,this.Pf);this.Wvd();return!0}Hpc(na){const jb=this.ha.io(na.clientPoint,na.Gb,5,
void 0,void 0,!0);this.Yw=na;return this.kyb(jb)?(this.hb=this.l3(jb),this.Uxb(!0),!0):this.Lkd(jb)?(this.hb=this.Oha(jb),this.Vxb(!0),!0):!1}Sy(na=!1){const jb=this.hb.toString();if(this.Zh)for(var Ib=1;4>=Ib;Ib++)if(this.Ogb){const dc=this.Rg[Ib.toString()];dc&&dc.childNodes&&0<dc.childNodes.length&&(dc.childNodes[0].innerText=jb,dc.childNodes[1].innerText=this.yH,na&&(dc.childNodes[2].innerText=this.TI))}else this.Rg[Ib.toString()].childNodes[0].innerText=jb,this.Rg[Ib.toString()].childNodes[1].innerText=
this.yH,na&&(this.Rg[Ib.toString()].childNodes[2].innerText=this.TI);else for(na=1;4>=na;na++)if(this.Ogb){if(Ib=this.Rg[na.toString()])Ib.innerText=jb}else this.Rg[na.toString()].innerText=jb}kyb(na){return!!this.gA&&1!==this.$n&&!!na&&this.gA.contains(na.topLeft)}Lkd(na){return!!this.gA&&1===this.$n&&!!na&&!this.gA.contains(na.topLeft)}Uxb(na){this.tableRange=this.gA;this.$n=1;const jb=!this.Du;na?(this.Mx(!1),this.Ph=this.Xq?[11]:[12],this.wAa(jb),this.hJ(jb)):(this.t3(!1),this.sO(jb),this.Xy(jb))}Vxb(na){this.tableRange=
null;this.$n=2;const jb=!this.Du;na?(this.Mx(!1),this.Ph=this.Xq?[11]:[12],this.Yq=this.Xq,this.ZQa(jb),this.hJ(jb)):(this.Wha(!1),this.sO(jb),this.Xy(jb))}koa(){if(!ha.h(this.$).ha.ra.Og)return!1;const na=ha.h(this.$).getRangeInformation(this.ha.ra.$c);for(const jb of na)if(Object(fa.a)(aa.PivotTableRange,jb))return!1;return!0}a0c(na){if(na&&na.contains(this.sourceRange)&&!na.equals(this.sourceRange)){if(na.pba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===na.top){const jb=
new ja.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,this.sourceRange.right,!1,!1);if(!jb.equals(na))return this.sourceRange=jb,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),na}this.Zh?this.Xq=na.left===this.sourceRange.left&&na.right===this.sourceRange.right:this.isRow=na.left===this.sourceRange.left&&na.right===this.sourceRange.right;if(na.top===this.sourceRange.top&&na.bottom===this.sourceRange.bottom||this.ty())return na}return null}l3(na){const jb=na.clone();
this.ty()?jb.left=Math.max(na.left-this.ofc,1):jb.top=Math.max(na.top-this.sEc,1);jb.right=jb.left+this.sourceRange.width-1;jb.bottom=jb.top+this.sourceRange.height-1;return this.QZa(jb)}VAb(){const na=this.hb.topLeft.Bd(this.sourceRange);return na||this.Zh&&!this.tableRange?na:this.ty()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+1}qJd(){if(this.ty()&&this.hb.left!==this.tableRange.left||!this.ty()&&this.hb.top!==this.tableRange.top){const na=qa.a.Zc(1,1,0,915,0,
2065438552,"RearrangeInvalidDest");ib.a(this.$).Pr([na]);return!0}return!1}NHd(){const na=this.$.Jb.Ac("UserAction","RearrangeRowColumnClientSide"),jb={["CopyPasteTargetType"]:1,["OperationId"]:ba.a.create().toString(),["Stopwatch"]:na,["DragDropIsShiftKeyDown"]:this.Du,["EncounteredDeploymentErrors"]:!1},Ib=this.Cu?2:1,dc=this.$.da.za(254);(new Promise((ob,Fa)=>{this.Sub(Ab=>{Ab.Errors&&0<Ab.Errors.length?Fa(new Va.a(22,Ab.Errors)):ob(!0)},Ab=>{Ab=ta.a.Pe(Ab.data);Fa(new Va.a(22,Ab))})})).then(()=>
{n.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');dc&&dc.Mqf(jb,Ib,this.sourceRange,this.hb);return Promise.resolve(!0)},ob=>{n.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${ob?copyPasteInfra.getStringifiedError(ob):"null"}, copyPasteTargetType="${1}"`);return dc?dc.CFf(ob,jb,Ib,this.sourceRange,this.hb):Promise.reject(ob)})}Sub(na=null,jb=null){const Ib={};this.ty()?
(Ib.FirstRow=this.hb.top-1,Ib.FirstColumn=0,Ib.DeltaColumn=0,Ib.DeltaRow=this.hb.bottom-this.hb.top+1):(Ib.FirstRow=0,Ib.FirstColumn=this.hb.left-1,Ib.DeltaColumn=this.hb.right-this.hb.left+1,Ib.DeltaRow=0);Ib.LastRow=U.a.Lz;Ib.LastColumn=U.a.Qw;Ib.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Cb.getItemByName(this.$.Cb.oa.name).sheetName;const dc=bb.v(this.sourceRange,this.$);this.$.userOperationManager.Ic(new wa.a(514,0,(ob,Fa,Ab)=>gb(this.$.pa.ya,dc,Ib,na?rb.b(ob,na):ob,jb?rb.a(Fa,jb):Fa,Ab,
null),64,()=>new Ga(dc,Ib)),null)}cpa(na=0){0===na?this.Cu=!1:1===na&&(this.Du=!1);this.Zh&&(this.Cu||this.Du)||(pa.KeyInputManager.instance.Ba(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.t5=!1)}sO(na=!1){this.nh=5;this.ex(this.Gh,this.Pf);this.yH=this.Ttb;this.TI=this.SMb;this.dA(this.Yw.clientPoint,this.Yw.Gb,this.Zaa(),!1,na)}ZQa(na=!1){this.nh=6;this.ex(this.N6,this.O6);this.yH=this.Lia;this.TI=this.hoa;this.dA(this.Yw.clientPoint,this.Yw.Gb,this.isRow||this.Xq?11:12,!0,na)}wAa(na=
!1){this.nh=6;this.ex(this.cL,this.dL);this.yH=this.Lia;this.TI=this.hoa;this.dA(this.Yw.clientPoint,this.Yw.Gb,this.ty()?11:12,!0,na)}ty(){return!this.Zh&&this.isRow||this.Zh&&this.Xq}t3(na){this.qb.Xg(this.Ph);this.wt(this.N6,this.O6,void 0,na)}Wvd(){const na=ic.a.instance.Ub("Common.ISystemInitiatedFeedback");na&&na.execute(jb=>{jb.logActivity("DragDrop",null)})}}Object(u.a)(Vb,"DragSelectionClickBehaviorCellRangeAndTable",xb,[]);var wb=a(319),cb=a(142);class lb extends xb{constructor(na,jb,Ib,
dc,ob){super(na,jb,Ib,dc,ob);this.Ema=()=>{this.Cp&&this.Wha(!0);5===this.nh&&this.Mx(!0)};this.dL=Fa=>{X.a(this.$).Vd(Fa);this.Cp=!1;this.qb.Xg(this.Ph);this.ha.sourceRange=this.sourceRange.clone();this.flf?this.$.Xc(927125067,C.a.Db,30,null):this.Y6a?(this.rG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[v.a.oaa]:!0,[v.a.IU]:this.ha.sourceRange,[v.a.HU]:this.ha.ra.$c,[v.a.vJa]:!1}),ha.h(this.$).Hf.gm(v.a.QQ),this.Y6a=!1):this.w5i();this.wt(this.cL,this.dL);this.nh=-1;
return!0};this.cL=Fa=>{Fa=X.a(this.$).Vd(Fa);const Ab=Fa.clientPoint;this.Yw=Fa;let $b=this.ha.io(Ab,Fa.Gb,5,void 0,void 0,!0);if($b){if(!this.Krd($b))return this.e6h(Fa),!0;this.Khg($b,this.isRow,Ab);if(this.isRow||this.hf)this.hb=this.l3($b);this.ha.sourceRange=this.hb;this.qb.Ti(this.hb,this.Ph);this.qb.Sn(this.Ph);this.qb.Xg(this.mB());this.Sy()}return!0};this.onKeyDown=Fa=>this.k5(Fa)?(this.t5||(pa.KeyInputManager.instance.ta(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.t5=!0),
this.Y6a||(ha.h(this.$).Hf.gm(La.y1a),this.Y6a=!0),!0):!1;this.onKeyUp=Fa=>{this.k5(Fa)&&(pa.KeyInputManager.instance.Ba(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.t5=!1,this.Cp?ha.h(this.$).Hf.gm(La.yJa):ha.h(this.$).Hf.gm(v.a.QQ),this.Y6a=!1);return!0};this.hEf=Fa=>{Fa.Errors&&0<Fa.Errors.length?(n.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${qa.a.sc(Fa.Errors)}]`),this.hb.left=this.sourceRange.left,this.hb.right=
this.sourceRange.right,this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1?(this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.hb.top||(this.hb.top-=this.sourceRange.height),this.hb.bottom=this.hb.top+this.sourceRange.height-1):this.sourceRange.left<=this.hb.left&&this.sourceRange.right>=this.hb.left-1?(this.hb.left=this.sourceRange.left,this.hb.right=
this.sourceRange.right):(this.sourceRange.left>this.hb.left||(this.hb.left-=this.sourceRange.width),this.hb.right=this.hb.left+this.sourceRange.width-1);this.rG();this.nh=-1};this.gEf=Fa=>{Fa=ta.a.Pe(Fa.data);n.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${qa.a.sc(Fa)}]`)};this.ha.X_b(this.Ema);this.Y6a=this.t5=!1}dispose(){W.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.WJb(this.Ema);
super.dispose()}Epc(na){this.Yw=na;this.isRow=this.hf=!1;this.Cp=!0;pa.KeyInputManager.instance.ta(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown);(this.jc=this.tableManager.aka(this.sourceRange))||n.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.flf=(new cb.a(this.$.xa)).ki;ha.h(this.$);ha.h(this.$).Hf.gm(La.yJa);this.Krd(this.hb)?(this.isRow=this.bqi(),this.hf=this.Qji(),this.isRow||
this.hf?(this.L7a=!1,this.wAa(na),this.hb=this.l3(this.hb),this.hJ()):(this.L7a=!0,this.sO(na),this.Xy())):(this.L7a=!0,this.sO(na),this.Xy())}uza(){return this.flf?(this.$.Xc(927125067,C.a.Db,30,null),this.Mx(!0),this.L7a=!1,this.nh=-1,!0):this.Y6a?(this.rG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[v.a.oaa]:!0,[v.a.IU]:this.ha.sourceRange,[v.a.HU]:this.ha.ra.$c,[v.a.vJa]:!1}),ha.h(this.$).Hf.gm(v.a.QQ),this.Mx(!0),this.Cp=this.L7a=!1,this.nh=-1,!0):5===this.nh?(this.Mx(!0),
this.L7a=!1,this.aEj(),this.nh=-1,!0):!1}Hpc(na){const jb=this.ha.io(na.clientPoint,na.Gb,5,void 0,void 0,!0);this.Yw=na;return this.L7a?!1:this.Krd(jb)?(this.f6h(na),!0):!1}Sy(){let na=new ja.Range(this.hb.top,this.hb.left,this.hb.bottom,this.hb.right,!1,!0);6===this.nh&&(this.isRow?(--na.top,na.bottom=na.top+this.hb.height-1):(--na.left,na.right=na.left+this.hb.width-1));for(let jb=1;4>=jb;jb++)if(this.Ogb){const Ib=this.Rg[jb.toString()];Ib&&Ib.childNodes&&0<Ib.childNodes.length&&(Ib.childNodes[0].innerText=
na.toString())}else this.Rg[jb.toString()].childNodes[0].innerText=na.toString()}koa(){if(!ha.h(this.$).ha.ra.Og)return!1;var na=ha.h(this.$).getRangeInformation(this.ha.ra.$c);for(var jb of na)if(Object(fa.a)(aa.PivotTableRange,jb)&&(na=this.tableManager.aka(jb)))return jb=!na.isOlap||!na.RNa(!0),n.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",na),na.isActionable&&jb;return!1}l3(na){na=na.clone();this.isRow?
(na.left=this.sourceRange.left,na.right=this.jc.right,na.bottom=na.top+this.sourceRange.height-1):this.hf?(na.top=this.sourceRange.top,na.bottom=this.jc.vL.bottom,na.right=na.left+this.sourceRange.width-1):n.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.QZa(na)}w5i(){const na={},jb=bb.v(this.sourceRange,this.$);ha.h(this.$).getRangeInformation(this.hb);if(this.isRow){jb.FirstColumn=na.FirstColumn=this.hb.left-
1;jb.LastColumn=na.LastColumn=this.hb.right-1;if(this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1){n.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.hb.top?na.LastRow=na.FirstRow=this.hb.top-1:(na.FirstRow=this.hb.top-this.sourceRange.height-1,na.LastRow=na.FirstRow+this.sourceRange.height-1)}else{na.FirstRow=this.hb.top;na.LastRow=this.hb.bottom-1;if(this.sourceRange.left<=this.hb.left&&
this.sourceRange.right>=this.hb.left-1){n.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}na.LastColumn=this.sourceRange.left>this.hb.left?na.FirstColumn=this.hb.left-1:na.FirstColumn=this.hb.left-this.sourceRange.width-1}const Ib={};Ib.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Cb.getItemByName(this.$.Cb.oa.name).sheetName;Ib.Ranges=Array(2);Ib.Ranges[0]=jb;Ib.Ranges[1]=na;this.TBh(Ib)}TBh(na){this.$.userOperationManager.Ic(new wa.a(265,
0,(jb,Ib,dc)=>mb(this.$.pa.ya,na,this.hEf?rb.b(jb,this.hEf):jb,this.gEf?rb.a(Ib,this.gEf):Ib,dc,null),64),null)}Krd(na){return null!==this.jc&&(null===this.jc.vL||na.left>=this.jc.vL.left)&&(null===this.jc.cF||na.right<=this.jc.cF.right)&&(null===this.jc.cF||na.top>=this.jc.cF.top)&&(null===this.jc.vL||na.bottom<=this.jc.vL.bottom)}bqi(){return null!==this.jc&&null!==this.jc.vL&&this.jc.vL.top<=this.hb.top&&this.jc.vL.left<=this.hb.left&&this.jc.vL.right>=this.hb.left}Qji(){return null!==this.jc&&
null!==this.jc.cF&&this.jc.cF.top===this.hb.top&&this.jc.cF.left<=this.hb.left&&this.jc.cF.right>=this.hb.right}wAa(na){this.nh=6;this.Ph=this.isRow?[11]:[12];this.ex(this.cL,this.dL);this.dA(na.clientPoint,na.Gb,this.isRow?11:12,!0,!1)}sO(na){this.nh=5;this.ex(this.Gh,this.Pf);this.dA(na.clientPoint,na.Gb,this.Zaa(),!1,!1)}f6h(na){this.Mx(!1);this.wAa(na);this.hb=this.l3(this.hb);this.hJ()}e6h(na){this.Wha(!1);this.sO(na);this.Xy()}aEj(){if(!this.Gba(this.hb)){var na=qa.a.Zc(1,0,903,902,0,2069074184,
"PivotTableInvalidMove");na.HelpTopicId=wb.a.THj;na.HelpDescription=Ka.a.instance.ga(910);ib.a(this.$).Pr([na])}}}Object(u.a)(lb,"DragSelectionClickBehaviorPivotTableRange",xb,[]);var Y=a(372);class Oa extends K{constructor(na,jb){super(na);this.Cg=()=>{this.domElement.classList.remove(ea.selecting);Y.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Mp=()=>{this.domElement.classList.add(ea.selecting)};this.onPointerDown=Ib=>{2===Ib.tb&&Ib.ho===Sys.UI.MouseButton.leftButton&&
(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=this.gridView.ha.ra.$c,Y.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.Nca=()=>{this.gridView.$.Xc(1983983164,2,30,null);return!0};this.dd=()=>{A.DOMElementExtensions.setVisible(this.Haa,this.gridView.$.isEditMode)};this.V6=()=>{A.DOMElementExtensions.setVisible(this.Haa,!1)};this.U6=()=>{A.DOMElementExtensions.setVisible(this.Haa,!0)};this.qCf=()=>{A.DOMElementExtensions.setVisible(this.Haa,!1)};this.pCf=
()=>{A.DOMElementExtensions.setVisible(this.Haa,!0)};this.HFb=(Ib,dc)=>{A.DOMElementExtensions.setVisible(this.Haa,!dc.Bne)};this.gridView=jb;jb=document.createElement("div");jb.className=N.a.vAh;this.Haa=jb;this.dd(null,null);na.appendChild(jb);y.a.instance.ta(t.a.pointerDown,this.Haa,this.onPointerDown);M.a.instance.ta(t.a.Ek,this.Haa,this.Nca);this.gridView.ha.S2(this.Mp);this.gridView.ha.FY(this.Cg);this.gridView.$.ml(this.dd);this.gridView.$.rb.e0b(this.V6);this.gridView.$.rb.d0b(this.U6);this.gridView.fqe(this.HFb);
this.gridView.fc.Yk(this.qCf);this.gridView.fc.Rm(this.pCf)}dispose(){y.a.instance.Ba(t.a.pointerDown,this.Haa,this.onPointerDown);M.a.instance.Ba(t.a.Ek,this.Haa,this.Nca);this.gridView.$&&(this.gridView.ha.t7(this.Mp),this.gridView.ha.JW(this.Cg),this.gridView.$.Jl(this.dd),this.gridView.$.rb.Juc(this.V6),this.gridView.$.rb.Iuc(this.U6),this.gridView.hUf(this.HFb),this.gridView.fc.Hk(this.qCf),this.gridView.fc.em(this.pCf));super.dispose()}}Object(u.a)(Oa,"FillHandleClickBehavior",K,[]);class Wa extends T{constructor(na,
jb){super(na);this.EVi=Ib=>{const dc=H.HelperMethods.Eo(Ib);var ob=this.twa.S1d(Ib.clientPoint);if(!ob)return!1;var Fa=ob.fe,Ab=this.twa.Ea.Pwb(Fa.hashCode).Kva(ob.iJ);if(!Ab)return!1;Ib=Fa.$i.domElement;ob=H.HelperMethods.ipe(H.HelperMethods.ixb(Fa.domElement,Ib),ob.iJ);Fa=0;Ab=this.twa.Sb(Ab.getRange());for(let Cb=0,Rb=Wa.GAe.length;Cb<Rb;++Cb){const uc=Wa.GAe[Cb];if((128===uc||64===uc)&&this.twa.$.isEditMode)continue;var $b=Ab.fLa(uc);if(!$b||!$b.G6a||"none"===$b.G6a.style.display)continue;$b=
$b.G6a;const nb=H.HelperMethods.ixb($b,Ib);$b=new Sys.UI.Bounds(nb.x,nb.y,$b.offsetWidth,$b.offsetHeight);if(L.a.BN($b,ob)){Fa=uc;break}}return 0!==Fa?(Ab.invoke(Fa,dc),!0):!1};this.dvg=jb;M.a.instance.ta(t.a.click,na,this.EVi)}get twa(){return this.dvg}}Wa.GAe=[1,2,32,256,128,64];Object(u.a)(Wa,"IPadSelectionClickThroughBehavior",T,[]);var Ca=a(22);class Ra{constructor(na){this.Ubf=jb=>{this.hDc(jb.Gb,1);return!0};this.Vbf=jb=>{this.hDc(jb.Gb,-1);return!0};this.Cg=()=>{this.zqd=!1};this.Mp=()=>{this.zqd=
!0};this.gridView=na;this.f6a=0;this.zqd=this.bic=!1;this.a6=Number.NaN;this.gridView.ha.S2(this.Mp);this.gridView.ha.FY(this.Cg);this.gridView.ha.X_b(this.Cg)}dispose(){this.gridView.ha.t7(this.Mp);this.gridView.ha.JW(this.Cg);this.gridView.ha.WJb(this.Cg)}KAa(){this.f6a=0;this.bic=!1;this.a6=Number.NaN}aNe(na){this.bic=!0;this.hDc(na,1)}bNe(na){this.bic=!1;this.hDc(na,-1)}hDc(na,jb){if(na)if(na.parentNode)if(this.zqd)isNaN(this.a6)||(this.vDc(this.a6,!1),this.a6=Number.NaN);else if(na=parseInt(na.parentNode.getAttribute(v.a.v6a),
10),isNaN(na))n.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.a6)&&na!==this.a6){if(this.bic)return;this.vDc(this.a6,!1)}if(isNaN(this.a6)||na!==this.a6)this.a6=na,this.f6a=0;!this.f6a&&0<jb&&this.vDc(na,!0);this.f6a=Math.max(this.f6a+jb,0);!this.f6a&&0>jb&&(this.vDc(na,!1),this.a6=Number.NaN)}else n.ULS.shipAssertTag(537159367,0,!!na.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");
else n.ULS.shipAssertTag(537159368,0,!!na,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}vDc(na,jb){for(let dc=1;4>=dc;dc++){var Ib=this.gridView.qb.Bv(3,dc,na).xf;A.DOMElementExtensions.toggleCssClass(Ib,ea.Szh,jb);for(Ib=Ib.firstChild;Ib;Ib=Ib.nextSibling)Ca.a.contains(Ib.className,"resizemarqueehandle",!0)&&A.DOMElementExtensions.toggleCssClass(Ib,ea.Wzh,jb)}}}Object(u.a)(Ra,"MarqueeHoveringManager",null,[]);var la=a(177),ua=a(83),xa=a(822),fb=a(1237);class Jb extends T{constructor(na,
jb){super(na);this.Fpc=()=>{if(!this.zu)return n.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.zu.uPf(this.TH,!1);this.zu.SOe(this.TH,!1);if(3===this.zu.model.state)return!0;this.zu.Rbf(!0);return!0};this.f0=()=>{if(!this.zu)return!1;this.zu.B7i();this.zu.pNd(this.TH,!1);if(3===this.zu.model.state)return!0;this.zu.Rbf(!1);return!0};this.onPointerDown=Ib=>this.zu?2===Ib.tb&&Ib.ho===Sys.UI.MouseButton.leftButton?!0:!1:!1;
this.cGb=()=>{if(!this.zu)return!1;this.zu.pNd(this.TH,!0);this.zu.uPf(this.TH,!0);this.zu.SOe(this.TH,!0);this.zu.BLb(!0);return!0};this.onDoubleClick=Ib=>{if(Ib.Ca)return Ib.Ca.stopPropagation(),!0;n.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.zu=Object(ua.a)(fb.a,jb.metadata);this.DF=document.createElement("div");this.DF.id=`${na.id}-${v.a.wAe}`;this.DF.className=xa.a.D_g;this.TH=document.createElement("div");
this.TH.id=`${na.id}-${v.a.S0c}`;this.TH.className=xa.a.S0c;this.DF.appendChild(this.TH);na.appendChild(this.DF);n.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");y.a.instance.ta(t.a.pW,this.DF,this.Fpc);y.a.instance.ta(t.a.Fy,this.DF,this.f0);y.a.instance.ta(t.a.pointerDown,this.DF,this.onPointerDown);la.a.instance.ta(t.a.click,this.DF,this.cGb);la.a.instance.ta(t.a.Ek,this.DF,this.onDoubleClick);
A.DOMElementExtensions.setVisible(this.DF,jb.isVisible)}dispose(){y.a.instance.Ba(t.a.pW,this.DF,this.Fpc);y.a.instance.Ba(t.a.Fy,this.DF,this.f0);y.a.instance.Ba(t.a.pointerDown,this.DF,this.onPointerDown);la.a.instance.Ba(t.a.click,this.DF,this.cGb);la.a.instance.Ba(t.a.Ek,this.DF,this.onDoubleClick);A.DOMElementExtensions.uf(this.TH);this.TH=null;A.DOMElementExtensions.uf(this.DF);this.zu=this.DF=null;super.dispose()}PZa(na){this.zu=Object(ua.a)(fb.a,na.metadata);na.isVisible!==na.gya&&(this.zu.byj(na.isVisible?
1:0),A.DOMElementExtensions.setVisible(this.DF,na.isVisible))}}Object(u.a)(Jb,"RangeCatchUpActivityHighlightBehavior",T,[]);class Ob extends da{constructor(na,jb,Ib,dc){super(na,jb,Ib,dc)}get a5(){return 16}get udb(){return this.gridView.ha.rangePicker.med(!1)}bTa(){return(this.gridView.inRangePicker||this.gridView.si)&&super.bTa()}}Object(u.a)(Ob,"RangePickerTouchGrippiesBehavior",da,[]);class eb extends T{constructor(na,jb){super(na);const Ib=document.createElement("div"),dc=document.createElement("div");
Ib.className=jb?ea.DAh:ea.FAh;dc.className=jb?ea.EAh:ea.CAh;na.appendChild(Ib);na.appendChild(dc)}}Object(u.a)(eb,"RearrangeHighlightBehavior",T,[]);var Ma;(function(na){na[na.topLeft=0]="topLeft";na[na.topRight=1]="topRight";na[na.bottomLeft=2]="bottomLeft";na[na.bottomRight=3]="bottomRight";na[na.error=4]="error"})(Ma||(Ma={}));Object(u.b)("Corner",Ma);class va extends T{constructor(na,jb,Ib,dc,ob){super(na);this.Za=this.oG=null;this.O3=0;this.hb=this.sourceRange=null;this.PTa=!1;this.onPointerDown=
Fa=>{Fa=X.a(this.$).Vd(Fa);if(this.g6f(Fa)&&!this.PTa){this.arf();this.Za=this.vo.dbc();this.oG=this.vo.Z5e(Fa);if(!this.Za||!this.oG||!this.oG.range)return n.ULS.shipAssertTag(537159361,0,!!this.Za,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),n.ULS.shipAssertTag(537159360,0,!!this.oG,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),n.ULS.shipAssertTag(537159331,0,!!this.oG.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),
!1;this.hb=this.oG.range.clone();this.sourceRange=this.hb.clone();this.O3=this.R1e(Fa);if(4===this.O3)return n.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Ab=this.K3e(Fa,!0);if(!Ab)return n.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.GHe(Ab))return n.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),
!1;this.gridView.wMa=!0;this.Za.TE(!1);this.VF.aNe(Fa.Gb);this.vo.aPf(!0,this.sba.jU);this.Za.textBox.removeSelection();this.Za.I_b(this.C9e);this.oSf();this.PTa=!0;ya.b(this.$,!0)}return!0};this.Gh=Fa=>{Fa=X.a(this.$).Vd(Fa);Fa=this.K3e(Fa,!1);if(!Fa)return!0;Fa=this.GHe(Fa);if(!Fa)return n.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.Z$b(!0),!1;if(this.hb.equals(Fa))return!0;this.hb=Fa;Fa=this.Xy();Fa||(n.ULS.shipAssertTag(537159326,0,
!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Z$b(!0));return Fa};this.Pf=Fa=>{X.a(this.$).Vd(Fa);Fa=this.rG();n.ULS.shipAssertTag(537159325,0,Fa,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.Z$b(!Fa);return Fa};this.C9e=()=>{this.Z$b(!0)};this.gridView=jb;this.$=jb.$;this.sL=[];this.ha=this.gridView.ha;this.VF=Ib;this.vo=dc;this.sba=ob;this.coloredReferencesManager=this.$.da.za(281);n.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,
"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.vB=x.a.vB(this.$))jb=this.$.da.za(464),n.ULS.shipAssertTag(510255176,0,!!jb,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.kB=jb.kB;for(const Fa of this.BXf())jb=this.vo.TGe(na,Fa,this.Sre(),this.onPointerDown),this.sL.push(jb);for(const Fa of this.sL)y.a.instance.ta(t.a.pW,Fa,this.VF.Ubf),
y.a.instance.ta(t.a.Fy,Fa,this.VF.Vbf);this.PZa(ob)}dispose(){this.sL.forEach(na=>{y.a.instance.Ba(t.a.pointerDown,na,this.onPointerDown)});this.sL.length=0;super.dispose()}PZa(na){this.sba=na;this.ase(na);this.vo.wMb(na,this.sL,this.OTd());this.VF.KAa()}K3e(na,jb){const Ib=na.Gb;na=na.clientPoint;if(!Ib||!na)return n.ULS.shipAssertTag(537159324,0,!!Ib,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),n.ULS.shipAssertTag(537159323,0,!!na,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),
null;jb&&(na=this.avf(na));jb=this.ha.io(na,Ib,0,!0,!1,!0);jb||(na=this.avf(na),jb=this.ha.io(na,Ib,0,!0,!1,!0));return jb}avf(na){na.y+=0===this.O3||1===this.O3?2:-2;na.x+=0===this.O3||2===this.O3?2:-2;return na}GHe(na){if(!na||!this.sourceRange)return n.ULS.shipAssertTag(537159322,0,!!na,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),n.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.O3)return new ja.Range(na.top,
na.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.O3)return new ja.Range(na.top,this.sourceRange.left,this.sourceRange.bottom,na.right,!0,!1);if(2===this.O3)return new ja.Range(this.sourceRange.top,na.left,na.bottom,this.sourceRange.right,!0,!1);if(3===this.O3)return new ja.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,na.right,!0,!1);n.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${Ma[this.O3]}`);
return null}rG(){return this.vB?this.kB.vEb(this.Za,this.oG,this.hb):this.coloredReferencesManager.vEb(this.Za,this.oG,this.hb)}Xy(){return this.rG()}Z$b(na){na&&n.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.VF.bNe(this.sL[0]);this.vo.aPf(!1,this.sba.jU);this.Za.textBox.setCaretPositionToEnd();this.Za.suc(this.C9e);this.$fg();this.PTa=this.gridView.wMa=!1;ya.b(this.$,!1);this.vo.QQf()}}
Object(u.a)(va,"ResizeMarqueeBehaviorBase",T,[]);class Pa extends va{constructor(na,jb,Ib,dc,ob){super(na,jb,Ib,dc,ob)}BXf(){return[ea.JAh,ea.KAh,ea.HAh,ea.IAh]}Sre(){return[ea.GAh]}R1e(na){na=na.Gb;if(na===this.sL[0])return 0;if(na===this.sL[1])return 1;if(na===this.sL[2])return 2;if(na===this.sL[3])return 3;n.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}oSf(){this.vo.ex(this.Gh,this.Pf,!0)}$fg(){this.vo.I_d(this.Gh,
this.Pf,!0)}g6f(na){return 2===(C.a.Db=na.tb)&&na.ho===Sys.UI.MouseButton.leftButton}OTd(){return!0}arf(){n.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}ase(na){for(const jb of this.sL)jb.style.backgroundColor=na.xf.style.borderColor}}Object(u.a)(Pa,"ResizeMarqueeMouseBehavior",va,[]);class Ha extends va{constructor(na,jb,Ib,dc,ob){super(na,jb,Ib,dc,ob);this.YFb=()=>{const Fa=3===C.a.Db;this.pud&&!Fa?this.vo.wMb(this.sba,
this.sL,!1):!this.pud&&Fa&&this.vo.wMb(this.sba,this.sL,!0);this.pud=Fa};this.JUi=(Fa,Ab)=>{Ab.v6a===this.sba.jU&&this.vo.wMb(this.sba,this.sL,!Ab.start&&this.OTd())};C.a.Lqe(this.YFb);this.pud=3===C.a.Db;this.vo.dLg(this.JUi)}dispose(){C.a.IUf(this.YFb);super.dispose()}BXf(){return[N.a.Lzh,N.a.Kzh]}Sre(){const na=!W.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[na?N.a.hUe:N.a.gUe,N.a.Z9b,na?N.a.Jzh:N.a.Y9b]}R1e(na){na=na.Gb;if(na===this.sL[0])return 0;if(na===this.sL[1])return 3;
n.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}oSf(){l.a.Jw?this.vo.ex(this.Gh,this.Pf,!1):this.vo.Abj(this.Gh,this.Pf)}$fg(){l.a.Jw?this.vo.I_d(this.Gh,this.Pf,!1):this.vo.PTj(this.Gh,this.Pf)}g6f(na){return 3===(C.a.Db=na.tb)}OTd(){return 3===C.a.Db}arf(){n.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}ase(){}}Object(u.a)(Ha,"ResizeMarqueeTouchBehavior",
va,[]);class tb extends T{constructor(na,jb){super(na);tb.psb(na,O.a.aAh+" "+N.a.Zua,null===jb||void 0===jb?void 0:jb.horizontal);tb.psb(na,O.a.$zh+" "+N.a.Zua,null===jb||void 0===jb?void 0:jb.vertical);tb.psb(na,O.a.Xzh+" "+N.a.Zua,null===jb||void 0===jb?void 0:jb.horizontal);tb.psb(na,O.a.Zzh+" "+N.a.Zua,null===jb||void 0===jb?void 0:jb.vertical);tb.psb(na,N.a.Yzh)}static psb(na,jb,Ib){const dc=document.createElement("div");dc.className=jb;Ib&&(dc.style.backgroundImage=`url("${Ib}")`);na.appendChild(dc)}}
Object(u.a)(tb,"SelectionCutCopyBehavior",T,[]);class Ya extends T{constructor(na){super(na);appChrome.renderSpinner(na)}}Object(u.a)(Ya,"SelectionPasteBehavior",T,[]);class V extends T{constructor(na,jb){super(na);V.Gsb(na,O.a.BAh+" "+N.a.Zua,null===jb||void 0===jb?void 0:jb.horizontal);V.Gsb(na,O.a.AAh+" "+N.a.Zua,null===jb||void 0===jb?void 0:jb.vertical);V.Gsb(na,O.a.xAh+" "+N.a.Zua,null===jb||void 0===jb?void 0:jb.horizontal);V.Gsb(na,O.a.zAh+" "+N.a.Zua,null===jb||void 0===jb?void 0:jb.vertical);
V.Gsb(na,N.a.yAh)}static Gsb(na,jb,Ib){const dc=document.createElement("div");dc.className=jb;Ib&&(dc.style.backgroundImage=`url("${Ib}")`);na.appendChild(dc)}}Object(u.a)(V,"SelectionRangePickerBehavior",T,[]);class za extends da{constructor(na,jb,Ib,dc){super(na,jb,Ib,dc)}get a5(){return 0}get udb(){return this.gridView.ha.ra.$c}bTa(){const na=this.gridView.si||this.gridView.eb;return this.gridView.ha.ra.Og&&!na&&super.bTa()}}Object(u.a)(za,"SelectionTouchGrippiesBehavior",da,[]);var yb=a(53);class jc extends w.a{constructor(na,
jb){super();this.Apb=(Ib,dc)=>{Ib=dc.a5;const ob=this.gridView;dc=dc.Z$h;const Fa=dc.xf,Ab=dc.x$;l.a.Yg&&Ab.push(new Wa(Fa,ob));switch(Ib){case 24:dc.x$.push(new Jb(Fa,dc));break;case 0:dc.x$.push(new Oa(Fa,ob));l.a.Dp||(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?(Ab.push(new Vb(Fa,this.gridView.$,dc.paneType,this.tableManager,this.vo)),W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&Ab.push(new lb(Fa,
this.gridView.$,dc.paneType,this.tableManager,this.vo))):Ab.push(new cc(Fa,this.gridView.$,dc.paneType,this.tableManager,this.vo)));Ab.push(new za(dc,Fa,ob,dc.paneType));break;case 3:Ab.push(new K(Fa));l.a.Dp||(Ab.push(new Ia(Fa,this.gridView.$,dc.paneType,this.VF,this.vo,dc)),Ab.push(new Pa(Fa,this.gridView,this.VF,this.vo,dc)),Ab.push(new Ha(Fa,this.gridView,this.VF,this.vo,dc)));break;case 4:case 5:Ab.push(new tb(Fa,this.lte));break;case 30:Ab.push(new Ya(Fa));break;case 16:Ab.push(new V(Fa,this.lte));
Ab.push(new Ob(dc,Fa,ob,dc.paneType));break;case 11:case 12:Ab.push(new eb(Fa,11===Ib));break;case 17:Ab.push(new K(Fa));break;case 19:Ab.push(new K(Fa)),Ab.push(new S(dc,Fa,ob,dc.paneType))}dc.J1b=!0};this.$=na;this.gridView=ha.h(na);this.tableManager=jb;this.VF=new Ra(this.gridView);this.vo=new D(this.gridView);this.gridView.qb&&(this.gridView.qb.AKg(this.Apb),this.gridView.qb.update(!1));na.da.Ga(64,this)}get lte(){W.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.kte&&
(this.kte={vertical:yb.a.current.fo(105),horizontal:yb.a.current.fo(106)});return this.kte}dispose(){this.gridView.qb.Lfj(this.Apb);this.VF&&(this.VF.dispose(),this.VF=null);super.dispose()}}Object(u.a)(jc,"GridHighlightsBehaviorManager",w.a,[]);class Cc extends b.a{constructor(na){super();this.$=na;this.Fb()}create(){m.TaskExtensions.Aa(h.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Ya),na=>{this.ob(this.$.da.za(64)||new jc(this.$,na.result))},this.la,3)}static ka(na){na.da.Ga(149,new Cc(na))}}
Object(u.a)(Cc,"GridHighlightsBehaviorManagerFactory",b.a,[]);a.d(E,"a",function(){return Sa});const Sa=()=>{c.a.Fa(Cc.ka);c.a.Fa(d.ka)}},1149:function(u,E,a){var c=a(9);u=a(0);var b=a(692),e=a(50),f=a(37),d=a(183),h=a(55);class m{constructor(Sa){this.unh=Sa}nc(){return!1}executeCommand(Sa,na){Sa=na.command;na=null;switch(Sa){case 1243860697:this.unh.dPj();break;default:na=d.a(Sa)}return na||h.Task.Ta(!0)}wc(Sa,na){return 1243860697===na.command}Kc(){return!1}}Object(u.a)(m,"SheetDropdownMenuCommandHandler",
null,[223]);class l extends b.a{constructor(Sa){super(Sa)}ld(){this.$.ky(Sa=>{Sa.Ufc().then(()=>{f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,32,33,this.Ya),na=>{this.Yc([new m(na.result.Jzj)])},this.$.la)})})}static ka(Sa){b.a.Nd(392,new l(Sa))}}Object(u.a)(l,"SheetDropdownMenuCommandHandlerFactory",b.a,[]);var w=a(222),n=a(5),y=a(74),t=a(33),r=a(1),v=a(15),B=a(27),A=a(177),z=a(14),x=a(87),D=a(45),J=a(239),L=a(156),T=a(107),O=a(40),G=a(416),C=a(83),H=a(13),I=a(35);class M{constructor(){this.HLe=
new I.a(!0);this.hJc=0}get Y7c(){return this.hJc}get navigationButtonsDisabled(){return!!(this.Y7c&1)}get operationButtonsDisabled(){return!!(this.Y7c&2)}SPg(Sa,na){this.HLe.add(Sa,na);this.FS()}FS(){this.hJc=0;I.a.forEach(this.HLe.Eu,Sa=>{this.hJc=this.Y7c|Sa.value})}}Object(u.a)(M,"SheetTabBarDisabledStateManager",null,[]);var Q=a(238),U=a(31);class N{}N.Xwh="ewa-stb-uir";N.LRe="ewa-stb-drag";N.Hwh="ewa-stb-navarea";N.Iwh="ewa-stb-navarea-dimensions";N.Kwh="ewa-stb-navbutton";N.rU="cui-disabled";
N.Jwh="ewa-stb-navareaextra";N.via="cui-img-container";N.Bwh="ewa-stb-contentarea";N.MRe="ewa-stb-left-scrollable";N.XRe="ewa-stb-right-scrollable";N.Vwh="ewa-stb-tabarea";N.Uwh="ewa-stb-sheettabmoveindicator";N.ZRe="ewa-stb-tabs";N.RLj="tab-active";N.ZLj="tab-inactive";N.YLj="tab-hover";N.Wwh="ewa-stb-tabs-ghost";N.TLj="tab-anchor-text";N.dark="dark";N.light="light";N.SLj="tab-active-text";N.WLj="tab-content-container";N.aMj="tab-text";N.Nwh="ewa-stb-nsv-inactive";N.Owh="ewa-stb-nsv-inactive-svg";
N.Lwh="ewa-stb-nsv-active";N.Mwh="ewa-stb-nsv-active-svg";N.xvh="ewa_nsv_margin";N.Cwh="ewa-stb-disable-scrollbar";N.Uvi="leave-size-fixed-on-tab-hover-old";N.Tvi="leave-size-fixed-on-tab-hover";N.QRe="ewa-stb-locked-sheet";N.RRe="ewa-stb-locked-sheet-svg-16px";N.Dwh="ewa-stb-dropdown-menu-button";N.Krh="ewa-active-sheet-menu-item";Object(u.a)(N,"CssClassNames",null,[]);var W=a(732),X=a(19),sa=a(259),da=a(101),S=a(188),oa=a(247),K=a(46),ea=a(286),ya=a(53),ha=a(12),La=a(71),Ia=a(318),ra=a(11),pa=a(99),
ba=a(347),fa=a(21),Ka=a(191),aa=a(372),ja=a(369),Va=a(44),bb=a(224),wa=a(85);class ka extends Q.a{constructor(Sa,na,jb=!1){super(Sa);this.kbb=this.Vsa=null;this.$=na;this.UX=jb}get disabled(){return this.UX}dispose(){this.kbb=this.Vsa=this.$=null;super.dispose()}AS(Sa){this.UX=Sa;this.domElement.setAttribute(n.a.Isa,Sa.toString());ha.DOMElementExtensions.toggleCssClass(this.domElement,W.a.rU,Sa)}}Object(u.a)(ka,"SheetBarButton",Q.a,[]);var ta=a(708);class qa extends ka{constructor(Sa,na,jb,Ib=!1){super(document.createElement("a"),
na,Ib);this.gd=dc=>{this.disabled||this.$.Xc(-1935155518,dc.tb,30,null);return!0};this.eGb=dc=>{dc="mouseover"===dc.type||"focus"===dc.type;const ob=aa.a(this.$)?this.kbb:this.Vsa;ra.HelperMethods.RYd(ob,this.Iha,this.Iha+n.a.wfc,dc&&!fa.h(this.$).inRangePicker)};this.rh=()=>{this.AS(!0)};this.jg=()=>{this.AS(!1)};this.Iha=r.EwaSettings.ma(496)?X.a.Y$c:X.a.HSe;this.Vsa=jb.pb(this.domElement,H.a.instance.ga(509),0,this.Iha,H.a.instance.ga(510),ta.a.m3c,Ib);Sa.appendChild(this.domElement);this.Gc.ka("contextmenu",
dc=>{La.g(dc)});r.EwaSettings.ma(496)||(this.Gc.ka("mouseover",this.eGb),this.Gc.ka("mouseout",this.eGb));bb.a.instance.ta(z.a.click,this.domElement,this.gd);this.yla=T.KeyInputManager.instance.Ls(this.domElement,this.gd,wa.a.Lh,wa.a.AX);fa.h(this.$).fc.Yk(this.rh);fa.h(this.$).fc.Rm(this.jg)}dispose(){bb.a.instance.Ba(z.a.click,this.domElement,this.gd);T.KeyInputManager.instance.Tv(this.domElement,this.yla);fa.h(this.$)&&fa.h(this.$).fc&&(fa.h(this.$).fc.Hk(this.rh),fa.h(this.$).fc.em(this.jg));
super.dispose()}AS(Sa){const na=qa.d6f(this.$);super.AS(Sa||na)}static d6f(Sa){return!Sa.isEditMode||!Sa.xa.count}}Object(u.a)(qa,"InsertSheetButton",ka,[]);class rb extends ka{constructor(Sa,na,jb){super(document.createElement("a"),na);this.gd=Ib=>{this.$.Xc(-684145703,Ib.tb,0,null);return!0};this.eGb=Ib=>{ra.HelperMethods.RYd(this.uye,this.Iha,this.Iha+n.a.wfc,("mouseover"===Ib.type||"focus"===Ib.type)&&!fa.h(this.$).inRangePicker)};this.$=na;this.Iha=r.EwaSettings.ma(496)?X.a.Y$c:X.a.HSe;this.uye=
jb.pb(this.domElement,H.a.instance.ga(511),0,this.Iha,H.a.instance.ga(512),ta.a.m3c);Sa.appendChild(this.domElement);this.Gc.ka("contextmenu",Ib=>{La.g(Ib)});this.Gc.ka("mouseover",this.eGb);this.Gc.ka("mouseout",this.eGb);bb.a.instance.ta(z.a.click,this.domElement,this.gd);this.yla=T.KeyInputManager.instance.Ls(this.domElement,this.gd,wa.a.Lh,wa.a.AX)}dispose(){bb.a.instance.Ba(z.a.click,this.domElement,this.gd);T.KeyInputManager.instance.Tv(this.domElement,this.yla);this.uye=null;super.dispose()}}
Object(u.a)(rb,"InsertTemplateButton",ka,[]);class Za{constructor(Sa,na){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Sa;this.newSheetIndex=na}getSheetName(){return this.sheetName}}Object(u.a)(Za,"MacroRecorderSheetReorderedPayload",null,[137]);var gb=a(91);class mb extends Q.a{constructor(Sa,na){super(document.createElement("div"));this.ER=()=>{v.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.IVf(!1,"OnSheetsChanged")};this.qNi=()=>{this.Lj()};this.pNi=()=>{this.gk()};
this.$=Sa;this.vMj=na;this.SU=!1;this.hPb=0}dispose(){this.gk();super.dispose()}dPj(){this.IVf(!0,"TogglerSheetDropdownMenu")}IVf(Sa,na){v.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${na}, toggle: ${Sa}, toggleStateId: ${this.hPb}`);Sa&&(this.hPb+=1);const jb=this.$.Jb.Ac("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${na}, toggle: ${Sa}, toggleStateId: ${this.hPb}, sheetCount: ${this.$.xa.count}`);Sa=this.oeh();appChrome.renderSheetDropdownMenu(this.domElement,
this.vMj,Sa,this.hPb,this.qNi,this.pNi,()=>{jb.stop()},aa.a(this.$))}oeh(){const Sa=this.$.xa,na=[];for(let Ib=0;Ib<Sa.count;Ib++){var jb=Object(C.a)(pa.a,Sa.getItem(Ib));0===jb.TB&&(jb=this.neh(jb),na.push(jb))}return na}neh(Sa){const na={};na.key=Sa.name;na.text=Sa.name;na.onClick=this.peh(Sa);Sa.active&&(na.className=aa.a(this.$)?"ewa-active-sheet-menu-item-present-mode":N.Krh);return na}peh(Sa){return()=>{const na=new gb.a(-1876836819,0,this.$.Hc,30,null);this.$.Ja.Kb(na,{[n.a.SSd]:Sa.name})}}Lj(){if(!this.SU){const Sa=
this.$.xa;Sa.Vf(this.ER);Sa.uWc(this.ER);Sa.EY(this.ER);Sa.eha(this.ER);Sa.EGa(this.ER);Sa.Iqe(this.ER);Sa.CZa(this.ER);this.SU=!0}}gk(){if(this.SU){const Sa=this.$.xa;Sa.Dg(this.ER);Sa.oLd(this.ER);Sa.s7(this.ER);Sa.rna(this.ER);Sa.nRa(this.ER);Sa.GUf(this.ER);Sa.OJb(this.ER);this.SU=!1}}}Object(u.a)(mb,"SheetDropdownMenu",Q.a,[593,2]);var Ga=a(351);class ib extends ka{constructor(Sa,na,jb){super(document.createElement("a"),Sa,!0);this.ig=()=>{this.AS(!1);this.$.ea.jo(this.ig)};this.gd=Ib=>{this.gdg(Ib.tb);
return!0};this.onKeyDown=Ib=>13===Ib.Ca.keyCode||32===Ib.Ca.keyCode?(this.gdg(Ib.tb),!0):!1;this.Vsa=na.pb(this.domElement,H.a.instance.ga(513),0,X.a.Awh,H.a.instance.ga(513),ta.a.G5h,this.disabled);this.domElement.classList.add(N.Dwh);jb.appendChild(this.domElement);this.xph();this.ibj()}dispose(){this.KTj();super.dispose()}AS(Sa){super.AS(Sa||!this.$.ea.Yka)}xph(){const Sa=this.$.ea;r.EwaSettings.isChangeGateEnabled("OfficeVSO:7308390_FixSheetDropdownMenuAnchorDisabled")?Sa.sg?this.AS(!1):Sa.Ak(this.ig):
Sa.Ak(this.ig)}gdg(Sa){this.disabled||(v.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${Ga.a[Sa]}`),this.$.Ja.Kb(new gb.a(1243860697,Sa,this.$.Hc,30,null)))}ibj(){bb.a.instance.ta(z.a.click,this.domElement,this.gd);T.KeyInputManager.instance.ta(z.a.Pb,this.domElement,this.onKeyDown)}KTj(){bb.a.instance.Ba(z.a.click,this.domElement,this.gd);T.KeyInputManager.instance.Ba(z.a.Pb,this.domElement,this.onKeyDown)}}Object(u.a)(ib,"SheetDropdownMenuAnchor",ka,[]);var cc=
a(60);const ic=(Sa,na,jb,Ib,dc,ob,Fa,Ab=null)=>{Ab=Sa.Na(9,Ab);Ab.sheetName=na;Ab.newSheetIndex=jb;return cc.g(Sa,"ReorderSheets",Ab,Ib,dc,ob,Fa,0)};var xb=a(172),Vb=a(128),wb=a(187),cb=a(132),lb=a(59),Y=a(208),Oa=a(198),Wa=a(166),Ca=a(133);class Ra{constructor(Sa,na,jb){this.ym=na;this.Mw=jb;this.sheet=Sa;this.altText=H.a.instance.ga(1988)}JK(){return this.sheet.active}tqd(){return this.sheet.isLockPausedInSession}jta(){return this.ym?X.a.PRe:this.JK()?X.a.ORe:X.a.NRe}Doa(){return this.sheet.ki?
ta.a.hOf:ta.a.xTj}vXd(){return 16}Vha(){return null}kta(){return this.ym?this.Mw?N.RRe:N.QRe:null}aZd(){return null}Ts(){return null}wmd(){return 0}XXc(){return!0}}Object(u.a)(Ra,"LockPausedSheetIconDataSource",null,[605]);class la{constructor(Sa,na,jb){this.ym=na;this.Mw=jb;this.sheet=Sa;this.altText=H.a.instance.ga(1987)}JK(){return this.sheet.active}tqd(){return this.sheet.ki}jta(){return this.ym?X.a.PRe:this.JK()?X.a.ORe:X.a.NRe}Doa(){return ta.a.hOf}vXd(){return 16}Vha(){return null}kta(){return this.ym?
this.Mw?N.RRe:N.QRe:null}aZd(){return null}Ts(){return null}wmd(){return 0}XXc(){return!0}}Object(u.a)(la,"LockedSheetIconDataSource",null,[605]);class ua{constructor(Sa,na,jb,Ib){this.sheet=Sa;this.altText=H.a.instance.ga(1899);this.rPj=na;this.$6f=jb;this.Mw=Ib}JK(){return this.sheet.active}tqd(){return this.sheet.Gd.Gv}Vha(){return this.Mw?this.JK()?N.Mwh:N.Owh:this.JK()?N.Lwh:N.Nwh}jta(){return!this.JK()&&this.$6f()?X.a.zyh:X.a.yyh}Doa(){return!this.JK()&&this.$6f()?ta.a.Tzj:ta.a.Szj}vXd(){return 14}kta(){return N.xvh}aZd(){return this.sheet.Gd.Fnb}Ts(){return this.rPj}wmd(){return 8}XXc(){return!1}}
Object(u.a)(ua,"NamedSeetViewSheetIconDataSource",null,[605]);var xa=a(157),fb=a(127);class Jb{constructor(Sa,na){this.Uqa=this.T1=this.SBa=this.Fl=null;this.Tjf=!1;this.SSc=this.Doa=this.kta=this.Vha=this.jta=null;this.dO=()=>{this.dataSource.JK()&&f.TaskExtensions.Aa(this.nDb,()=>{dialogControls.renderToolTip(this.dataSource.Ts(),"SheetIconTooltip",this.dataSource.aZd(),this.YI,10,!1,!1,1)},this.$.la,3)};this.cO=()=>{this.dataSource.JK()&&this.clearToolTip()};this.$=Sa;this.dataSource=na;this.Mw=
t.a.bsd()}get Gc(){return this.T1||(this.T1=fb.a.instance.Zd(this.YI))}get nDb(){if(this.Uqa)return this.Uqa;const Sa=new xa.a;this.$.ky(na=>{f.TaskExtensions.Aa(na.yvd(),()=>{Sa.setResult(!0)},this.$.la,3)});return this.Uqa=Sa.task}get YI(){return this.SSc}uhg(){if(this.YI&&(this.Fl||this.SBa)){if(this.Mw){var Sa=this.dataSource.Doa();this.Doa!==Sa&&(this.SBa&&this.SBa.parentNode.removeChild(this.SBa),this.fef(),this.Doa=Sa)}else Sa=this.dataSource.jta(),this.jta!==Sa&&(this.qMd(this.Fl,this.jta,
Sa),this.jta=Sa);Sa=this.dataSource.Vha();this.Vha!==Sa&&(this.Mw?this.jij(this.SBa,this.Vha,Sa):this.qMd(this.Fl,this.Vha,Sa),this.Vha=Sa);Sa=this.dataSource.kta();this.kta!==Sa&&(this.qMd(this.YI,this.kta,Sa),this.kta=Sa);this.dataSource.Ts()&&!this.dataSource.JK()&&this.clearToolTip()}}BEj(Sa,na,jb){this.ffi(Sa,na,jb);ha.DOMElementExtensions.setVisible(this.YI,this.dataSource.tqd())}clearToolTip(){f.TaskExtensions.Aa(this.nDb,()=>{dialogControls.clearToolTip(this.dataSource.Ts())},this.$.la,3)}ffi(Sa,
na,jb){this.YI&&this.Tjf!==Sa&&(this.YI.parentNode.removeChild(this.YI),this.kta=this.Vha=this.Doa=this.jta=this.SSc=null,this.dataSource.Ts()&&(this.Gc.detach("mouseover",!0),this.Gc.detach("mouseout",!0)));this.YI||(this.SSc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.YI,W.a.via),Sys.UI.DomElement.addCssClass(this.YI,X.a.qv),r.EwaSettings.ma(496)?Sa===this.dataSource.XXc()?na.appendChild(this.YI):na.insertBefore(this.YI,jb):Sa?na.insertBefore(this.YI,jb):na.appendChild(this.YI),
this.Mw?this.fef():(this.Fl=document.createElement("img"),this.Fl.tabIndex=-1,this.Fl.alt=this.dataSource.altText,this.YI.appendChild(this.Fl),this.Fl.src=ya.a.we(this.dataSource.wmd())),this.dataSource.Ts()&&(this.Gc.ka("mouseover",this.dO,!0),this.Gc.ka("mouseout",this.cO,!0)),this.Tjf=Sa)}jij(Sa,na,jb){Sa&&(Sys.UI.DomElement.removeCssClass(Sa,na),Sys.UI.DomElement.addCssClass(Sa,jb))}qMd(Sa,na,jb){na&&Sys.UI.DomElement.removeCssClass(Sa,na);jb&&Sys.UI.DomElement.addCssClass(Sa,jb)}dispose(){x.a.Ia(this.T1)}fef(){const Sa=
this.$.da.za(388);Sa?(this.SBa=Sa.fka(this.dataSource.Doa(),this.dataSource.vXd()))?this.YI.appendChild(this.SBa):v.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.Doa()} was not found.`):v.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(u.a)(Jb,"SheetIcon",null,[2]);var Ob=a(352),eb=a(94),Ma=a(153);class va extends eb.a{constructor(Sa,na){super(Sa.domElement);this.onKeyDown=jb=>
{121===jb.keyCode&&jb.shiftKey&&!this.goa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.goa.anchor),La.g(jb))};this.Nca=jb=>{if(!this.$.isEditMode||this.goa.disabled)return!0;this.rename(!1,jb.tb);return!0};this.$l=jb=>this.goa.disabled?!0:this.showContextMenu(jb.clientPoint,jb.tb,jb.Gb);this.Nje=Sa;this.$=na;bb.a.instance.ta(z.a.Ek,Sa.domElement,this.Nca);Ob.a.instance.ta(Sa.domElement,this.$l);this.Gc.ka("keydown",this.onKeyDown)}get goa(){return this.Nje}dispose(){this.goa&&(bb.a.instance.Ba(z.a.Ek,
this.goa.domElement,this.Nca),Ob.a.instance.Ba(this.goa.domElement,this.$l),this.Nje=null);this.$=null;super.dispose()}showContextMenu(Sa,na,jb){this.goa.activate(na,t.a.Osd());na=new gb.a(-1075099431,na,this.$.Hc,30,null);let Ib;return!Ma.a(Ib=this.$.Ja.Kb(na,{[n.a.E5f]:Sa,[va.Kzj]:this.goa.sheet,[n.a.F5f]:jb}))&&(6!==Ib.status||Ib.result)}rename(Sa,na){this.$.Xc(817296323,na,Sa?19:0,null)}}va.Kzj="Sheet";Object(u.a)(va,"SheetOpsSheetClickHelper",eb.a,[]);var Pa=a(41);class Ha extends ka{constructor(Sa,
na,jb,Ib,dc,ob,Fa){super(document.createElement("li"),Sa);this.L2c=this.K2c=this.D5f=this.C5f=0;this.k6c=.5;this.SU=this.QSd=!1;this.color=this.UIc=this.eF=this.GEb=this.$O=null;this.Ric=this.Lif=!1;this.B6b="#BEBBB8";this.qGc=null;this.onKeyDown=Ab=>13!==Ab.Ca.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.Qz=Ab=>32!==Ab.Ca.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.dO=()=>{this.disabled||(this.pS.cWi(this),this.pS.QF||this.Zna(!0,void 0,"OnMouseOver"))};this.cO=()=>{this.disabled||
this.Zna(!1,void 0,"OnMouseOut")};this.dGb=()=>{this.pS.QF||(this.eJj(),this.sheet.X0||fa.h(this.$).uKb(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.K6=()=>{this.HOe(!1);return!1};this.gd=Ab=>{if(this.disabled)return!0;const $b=fa.h(this.$);this.sheet.active||3!==Ab.tb?this.ym?this.activateSheet(Ab.tb):t.a.Osd()&&$b.focus():(!t.a.PNa(this.$)&&!this.WBb||$b.eb||$b.si||$b.Btb(),this.activateSheet(Ab.tb));return 3!==Ab.tb};this.onPointerDown=Ab=>{if(this.disabled)return!0;this.HOe(!0);
fa.h(this.$).inRangePicker&&v.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var $b=3===Ab.tb;if(2===Ab.tb||$b&&this.Kxa)this.ym?(this.Zna(!0,!$b,"OnPointerDown"),$b=h.Task.delay($b?this.D5f:this.C5f).jp(()=>!0)):$b=this.activateSheet(Ab.tb),this.oBb&&(this.Ric=!0,this.pS.Tuc=f.TaskExtensions.Aa($b,()=>{this.Ric&&this.pS.eWi(this,Ab)},this.la,11));return!1};this.Pf=Ab=>{if(this.disabled||!this.oBb&&r.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;
const $b=this.pS.QF&&!t.a.djf();this.Ric=!1;this.ym&&this.Zna(2===Ab.tb,void 0,"OnPointerUp");this.pS.Tuc&&(f.TaskExtensions.Aa(this.pS.Tuc,()=>{this.pS.dWi(this)},this.la,11),this.pS.Tuc=null);return $b};this.hO=()=>{this.Ric=!1;this.QSd||this.Zna(!1,void 0,"OnTouchMove");return!1};this.xCe=new va(this,Sa);this.ym=ob;this.Mw=Fa;this.WBb=t.a.WBb(Sa);this.opd=r.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!this.Mw;this.ym?(this.C5f=Sa.va.SheetDragReorderDelayInMilliseconds,
this.D5f=Sa.va.SheetDragReorderDelayInMillisecondsForTouch,this.K2c=18,this.L2c=20):(this.K2c=19,this.L2c=22);this.$=Sa;this.JXb=Ib;this.pS=dc;this.oBb=dc.Gse();this.zeh();this.u9g();this.Yld=Sa.Jb.Pg("UserAction",this.name);this.sqd=!1;ha.DOMElementExtensions.Nu(this.domElement,n.a.cs,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.eF);this.eoa=new wb.a;Sa=new la(this.sheet,this.ym,this.Mw);this.eoa.add(new Jb(this.$,Sa));this.$.ea.OMb&&(Sa=new Ra(this.sheet,this.ym,
this.Mw),this.eoa.add(new Jb(this.$,Sa)));this.opd||(Sa=new ua(this.sheet,this.pS.yyc,()=>this.color?Ha.$Td(this.color):!1,this.Mw),this.GEb=new Jb(this.$,Sa),this.eoa.add(this.GEb));this.Kxa=this.pS.Kxa;this.Cgb();this.xcj();this.Cxe=new ea.a(this.domElement,1);na.insertBefore(this.domElement,jb);aa.a(this.$)&&this.pig(!0)}get $hh(){return this.UIc||(this.UIc=Oa.a.rp("#F5F5F5"))}get name(){return this.$O.innerText}set name(Sa){this.$O&&(this.$O.innerText=Sa,this.VCc(),this.qig())}get sheet(){return this.JXb}get anchor(){return this.qGc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Sa){this.anchor.tabIndex=
Sa}ZSh(){return ha.DOMElementExtensions.Gf(this.anchor)?this.anchor:null}dispose(){if(this.SU){J.a.instance.Ba(z.a.pointerDown,this.domElement,this.onPointerDown);T.KeyInputManager.instance.Ba(z.a.Pb,this.domElement,this.onKeyDown);T.KeyInputManager.instance.Ba(z.a.Gp,this.domElement,this.Qz);bb.a.instance.Ba(z.a.click,this.domElement,this.gd);J.a.instance.Ba(z.a.pW,this.domElement,this.dGb);J.a.instance.Ba(z.a.Fy,this.domElement,this.K6);if(this.oBb||r.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))J.a.instance.Ba(z.a.Qf,
this.domElement,this.Pf),this.Kxa&&(L.a.instance.Ba(z.a.xe,this.domElement,this.Pf),L.a.instance.Ba(z.a.Zf,this.domElement,this.hO));this.SU=!1;this.B6b="#BEBBB8"}x.a.qc([this.xCe,this.Cxe]);this.$O=this.eF=this.qGc=this.pS=this.Cxe=this.xCe=null;if(this.eoa){for(let Sa of this.eoa)Sa.dispose();this.eoa=null}this.color=this.JXb=null;super.dispose()}AS(Sa){Sa&&this.Zna(!1,!1);super.AS(Sa)}HUd(Sa){if(lb.a.zg.fR){this.OLe();var na=e.GetServiceTaskFactory.Oa(this.$.da,322,323,1);f.TaskExtensions.Aa(na,
jb=>{xb.UISurfaces.OH().then(Ib=>{const dc=jb.result;dc.Svj(Ib);dc.show(Sa);return null},Ib=>{v.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Ib}`);return null})},this.la,3)}}mpe(){if(this.sheet.active&&this.$.vr){var Sa=this.$.vr,na=fa.h(this.$),jb=na.Dj;if(this.sheet.Gd.Gv){if(!this.GEb){var Ib=new ua(this.sheet,this.pS.yyc,()=>this.color?Ha.$Td(this.color):!1,this.Mw);this.GEb=new Jb(this.$,Ib);this.eoa.add(this.GEb)}jb&&na.sgb(1);
Sa.classList.add(X.a.lUe);Sa=Ha.Wgd(n.a.Fvf);na=Ha.Wgd(n.a.Bzd);jb=Ha.Wgd(n.a.wvf);Ib=this.sheet.Gd.MTd;this.sheet.Gd.MTd=!1;"true"===jb&&Ib&&this.$.ea.PTd?(Vb.a.Pv(n.a.wvf,"false",Vb.a.WV),this.$.ea.PTd=!1,this.HUd(3)):"true"===Sa&&"true"===na&&"true"===jb?this.$.ea.QTd&&this.$.ea.jNb&&(this.sheet.Gd.gI?(Sa=1,Vb.a.Pv(n.a.Bzd,"false",Vb.a.WV),this.$.ea.jNb=!1):Sa=0,Vb.a.Pv(n.a.Fvf,"false",Vb.a.WV),this.$.ea.QTd=!1,this.HUd(Sa)):this.sheet.Gd.gI&&"true"===na&&"true"===jb&&this.$.ea.jNb&&(Vb.a.Pv(n.a.Bzd,
"false",Vb.a.WV),this.$.ea.jNb=!1,this.HUd(2))}else this.OLe(),jb&&na.sgb(0),Sa.classList.remove(X.a.lUe)}}OLe(){const Sa=this.$.da.za(322);Sa&&Sa.dismiss()}Cgb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.J7a()?N.RLj:N.ZLj;r.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.$O.parentNode.classList.add(N.Tvi):this.$O.parentNode.classList.add(N.Uvi);this.qig();this.opd&&this.mpe();this.CEj();this.xig();this.VCc();this.opd||this.mpe()}bWi(){this.QSd=
!0;this.Zna(!0,!0,"OnSheetReorderStarted")}aWi(){this.QSd=!1;this.Zna(!1,void 0,"OnSheetReorderEnded")}activate(Sa=0,na=!1){this.v3b()||(this.sheet.activate(),na&&fa.h(this.$).focus(),Sa={["InputMethod"]:Ga.a[Sa],["AppMode"]:this.$.Hc,["Location"]:"canvas"},Ca.b(this.$).ud(cb.a.Gzj,Sa))}pig(Sa){this.B6b=Sa?"#797775":"#BEBBB8";this.k6c=Sa?-.5:.5;this.UIc=Sa?Oa.a.rp("#3B3A39"):Oa.a.rp("#F5F5F5");this.xig()}Ksj(Sa){this.oBb=Sa}bCd(Sa){Sa.D3c();this.QAe(Sa)}QAe(Sa){Sa.j1a();this.sheet.activate()}WEg(Sa){Sa=
new gb.a(-1876836819,Sa,this.$.Hc,30,null);return this.$.Ja.Kb(Sa,{[n.a.SSd]:this.sheet.name})}qig(){this.$O.parentNode.setAttribute("sheet-title",this.$O.innerText)}VCc(){const Sa=this.CMh();this.anchor.setAttribute(n.a.kv,Sa);this.anchor.setAttribute(n.a.rha,this.sheet.active.toString())}CMh(){const Sa=this.sheet.Gd.Gv,na=this.sheet.Gd.Fnb,jb=this.sheet.ki,Ib=this.sheet.isLockPausedInSession;return Sa&&jb?String.format(H.a.instance.nb(20),this.name,na):Sa&&Ib?String.format(H.a.instance.nb(22),this.name,
na):Sa?String.format(H.a.instance.nb(19),this.name,na):jb?String.format(H.a.instance.nb(18),this.name):Ib?String.format(H.a.instance.nb(21),this.name):this.name}activateSheet(Sa=0){if(t.a.Osd()){if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.v3b())return h.Task.Ta(!1);Wa.a.current.hS="ActivateSheet";this.sheet.activate();return h.Task.Ta(!0)}return this.WEg(Sa)}xig(){const Sa=this.sheet.tabColor;this.color=Sa?Oa.a.rp(Sa):this.$hh;this.Lif=Ha.$Td(this.color);
this.Zna(!1,void 0,"UpdateTabColor")}Zna(Sa,na=!1,jb=null){if(this.sheet){jb=this.sheet.active;var Ib=this.J7a(),dc=!!this.sheet.tabColor,ob=Oa.a.BG(jb||Ib?Y.a.white:this.color);this.eF.style.background="";jb||Ib?(dc?r.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.hMa?this.Jxj():this.ym?this.Ixj():this.Hxj():this.ym||(this.eF.style.backgroundColor=ob),this.eF.style.height=this.K2c.toString()+"px"):(this.eF.style.filter="",this.eF.style.backgroundColor=
ob,this.eF.style.height=this.L2c.toString()+"px");this.$O.className=jb?N.SLj:Ib?N.dark:this.Lif?N.light:N.dark;for(let Fa of this.eoa)Fa.uhg();this.ym&&(Sa&&!dc&&(this.eF.style.backgroundColor="#E1DFDD"),ha.DOMElementExtensions.toggleCssClass(this.domElement,N.YLj,Sa),na?(dc||(this.eF.style.backgroundColor=this.B6b),this.domElement.style.backgroundColor=this.B6b):(dc||(this.eF.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.$O.style.fontWeight=jb||Ib||!this.ym&&Sa?this.ym?
"600":"bold":""}else v.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${jb}`)}Ixj(){const Sa=this.eF.style,na=Oa.a.BG(Ha.b1c(this.color,this.k6c));Sa.background=na}Hxj(){const Sa=this.eF.style,na=Oa.a.BG(Ha.b1c(this.color,1)),jb=Oa.a.BG(Ha.b1c(this.color,this.k6c));Sa.background=`$linear-gradient(${na}, ${jb})`}Jxj(){this.eF.style.background="transparent"}u9g(){this.qGc=document.createElement("a");
this.anchor.removeAttribute("Href");this.anchor.className=N.TLj;ha.DOMElementExtensions.Nu(this.anchor,n.a.npb,null,null);this.tabIndex=-1}zeh(){this.eF=document.createElement("span");this.eF.className=N.WLj;this.$O=document.createElement("span");this.$O.className=N.aMj;this.$O.dir=this.sheet.rtlName?"rtl":"ltr";this.eF.appendChild(this.$O)}CEj(){const Sa=this.$.EJ;for(let na of this.eoa)na.BEj(Sa,this.eF,this.$O)}J7a(){return fa.h(this.$).J7a(this.sheet)}eJj(){this.Yld.start();this.sqd=!0}HOe(Sa){this.sqd&&
(this.Yld.stop(),v.ULS.sendTraceTag(537153686,0,50,Pa.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.Yld.zc,["Has been clicked"]:Sa})),this.sqd=!1)}xcj(){J.a.instance.ta(z.a.pointerDown,this.domElement,this.onPointerDown);T.KeyInputManager.instance.ta(z.a.Pb,this.domElement,this.onKeyDown);T.KeyInputManager.instance.ta(z.a.Gp,this.domElement,this.Qz);this.Gc.ka("mouseover",this.dO);this.Gc.ka("mouseout",this.cO);J.a.instance.ta(z.a.pW,this.domElement,
this.dGb);J.a.instance.ta(z.a.Fy,this.domElement,this.K6);if(this.oBb||r.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))J.a.instance.ta(z.a.Qf,this.domElement,this.Pf),this.Kxa&&(L.a.instance.ta(z.a.xe,this.domElement,this.Pf),L.a.instance.ta(z.a.Zf,this.domElement,this.hO));bb.a.instance.ta(z.a.click,this.domElement,this.gd);this.SU=!0}v3b(){const Sa=this.$.da.za(65);return Sa&&Sa.Zka()?(Sa.hwc(),this.QAe(Sa),!0):!1}static Wgd(Sa){let na=Vb.a.get(Sa);na||(Vb.a.Pv(Sa,
"true",Vb.a.WV),na=Vb.a.get(Sa));return na}static b1c(Sa,na){if(1<na||-1>na)return Sa;let jb=Sa.r,Ib=Sa.g;Sa=Sa.b;0<na?(jb=jb*(1-na)+255*na,Ib=Ib*(1-na)+255*na,Sa=Sa*(1-na)+255*na):(jb*=1+na,Ib*=1+na,Sa*=1+na);return Y.a.Qvb(Math.round(jb),Math.round(Ib),Math.round(Sa))}static $Td(Sa){return 128>=(222*Sa.r+707*Sa.g+71*Sa.b)/1E3}}Object(u.a)(Ha,"SheetTabButton",ka,[]);class tb extends ka{constructor(Sa,na,jb){super(document.createElement("a"),na);this.Iha=r.EwaSettings.ma(496)?X.a.Y$c:X.a.Txh;jb.pb(this.domElement,
H.a.instance.ga(713),0,this.Iha,H.a.instance.ga(713),ta.a.m3c,!0);Sa.appendChild(this.domElement);this.Gc.ka("contextmenu",Ib=>{La.g(Ib)})}}Object(u.a)(tb,"WorkbookProtectionButton",ka,[]);var Ya=a(51),V=a(39),za=a(57);class yb extends Q.a{constructor(Sa,na,jb=null,Ib=null){super(na);this.sheetTabActivatePreviousHidden=H.a.instance.ga(722);this.sheetTabActivateNextHidden=H.a.instance.ga(724);this.svgIconProvider=null;this.xh=[];this.ZK=Array(6);this.Mzd=Array(6);this.USa=this.Czb=this.VH=this.Byc=
this.ieb=this.Dyc=this.XSd=this.il=null;this.isRtl=!1;this.MK=this.uv=0;this.p8b=this.Suc=!1;this.Crc=this.Jna=0;this.VM=this.c4=this.qaa=this.z8b=null;this.Qdc=this.pD=0;this.vOb=null;this.sCb=-1;this.mZ=null;this.Bqc=0;this.kAc=-1;this.cna=0;this.mua=new M;this.WMc=!1;this.Tuc=this.Eyc=this.QMb=this.Jje=this.W_=null;this.Nbe=!1;this.Smd=null;this.bzd=!1;this.htmlSanitizationHelper=this.Ije=null;this.KD=(dc,ob)=>{this.iHf(ob.item)};this.zza=(dc,ob)=>{dc=this.$.xa.oa.index;for(let Fa=0,Ab=this.xh.length;Fa<
Ab;Fa++){const $b=this.PQ(Fa);if($b.name===ob.oldName){$b.name=ob.newName;this.t0();Fa===dc&&this.G0(6);break}}};this.mHf=(dc,ob)=>{(dc=this.H3a(ob.item))&&dc.Cgb()};this.nHf=(dc,ob)=>{ob.visible?(this.LSa(!1),this.jHf(ob.item)):this.iHf(ob.item)};this.YN=dc=>{this.QF?(this.mZ=dc,this.WPb()):(this.mZ&&(this.Crc+=this.mZ.clientPoint.x-dc.clientPoint.x),this.mZ=dc,Math.abs(this.Crc)>=this.mnh&&this.WPb());return!0};this.hO=dc=>{dc.Ca.preventDefault();return!1};this.S_f=dc=>{this.O_f(dc,!0)};this.R_f=
dc=>{this.O_f(dc,!1)};this.H6=dc=>{if(this.QF&&(this.Gz||this.glf(dc)))if(this.p8b=this.hhf(dc),this.Gz){let ob;dc=(ob=this.PQ(this.pD+1))?ob.sheet:null;this.reorderSheets(dc,this.pD+1===this.VSd,!0)}else dc=this.bzd?null:this.Smd,this.reorderSheets(dc,this.bzd,!0);this.wQ();return!0};this.Fh=(dc,ob)=>{ob.RD&&this.S0d(ob.RD);this.Fxc(!1);this.t0();ob.oa&&(this.S0d(ob.oa),this.G0(6),this.ea.Ima())};this.Rxf=(dc,ob)=>{this.ODc(ob.item)};this.Sxf=(dc,ob)=>{this.ODc(ob.item)};this.Txf=(dc,ob)=>{this.ODc(ob.item)};
this.BPa=(dc,ob)=>{this.ODc(ob.item)};this.gza=()=>{this.b2c()};this.dd=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.b2c();this.V5c();r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(za.d(this.$)||za.e(this.$))&&(V.PageLoadTrackingInfo.instance.YR(n.a.tBa,["sheetTabBar"]),V.PageLoadTrackingInfo.instance.MW(n.a.tBa,["sheetTabBar"]));this.D5c();this.t0();this.LSa(!0);this.G0(6)};this.hj=()=>{this.isVisible&&(this.t0(),this.G0(6))};this.zf=()=>{Object(G.a)(qa,
this.VH)===da.k(this.$.lg)&&this.D5c();for(const dc of this.xh)dc.Ksj(!da.k(this.$.lg))};this.lHf=(dc,ob)=>{this.$hj(ob.item,ob.isUserOperation)};this.vGb=(dc,ob)=>{this.jHf(ob.item)};this.onKeyDown=dc=>{switch(dc.keyCode){case 9:var ob=this.domElement.querySelectorAll(ha.DOMElementExtensions.Gr);const Fa=ha.DOMElementExtensions.um(ob);ob=ha.DOMElementExtensions.nB(ob);ha.DOMElementExtensions.kBa(dc,Fa,ob);break;case 39:case 37:ha.DOMElementExtensions.T2f(dc,this.domElement.querySelectorAll(ha.DOMElementExtensions.Gr),
39===dc.keyCode?!this.isRtl:this.isRtl)}v.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${dc.keyCode}`)};this.onScroll=()=>{this.il.scrollLeft!==this.Jna&&this.zNj()};this.fO=dc=>{if(dc.ctrlKey||dc.y3)return!1;this.il.scrollLeft+=Math.floor(30*dc.WCa);if(this.Gz&&this.QF){const ob=this.k2e("OnMouseWheel");ob&&this.yXd(0<dc.WCa,ob.x+ob.width/2)}return!0};this.aG=(dc,ob)=>{if(this.mua)this.R9e("PartialInteractivity",ob.pM?3:0);else{this.wQ(!1);this.xRd(ob.pM);for(const Fa of this.Bwe)Fa&&
Fa.AS(ob.pM);for(const Fa of this.xh)Fa&&Fa.AS(ob.pM)}};this.HFb=(dc,ob)=>{dc=0;ob.Bne&&(dc=2|(ob.Lzj?1:0));this.R9e("ComponentRangePicker",dc)};this.$=Sa;this.ea=this.$.ea;this.H8b=(this.Gz=t.a.djf())&&!r.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.ym=r.EwaSettings.ma(496);this.Mw=t.a.bsd();this.dlf=this.ym&&!this.$.Kw;this.Gz&&(this.Nbe=this.ym&&!B.a.Jw);this.AGi=this.$.va.SheetTabNavigateButtonLongKeyPressPeriodMS;this.zGi=this.$.va.SheetTabNavigateButtonIntervalPeriodMS;
this.mnh=this.$.va.SheetTabDragStartPixelThreshold;this.lQa=this.mQa=-1;this.a4c=!1;this.htmlSanitizationHelper=Ib;this.Mw&&(this.svgIconProvider=jb);this.IC=new ea.a(this.domElement,3);this.ym&&this.domElement.classList.add(N.Xwh);this.hch();this.J$g();this.ich();r.EwaSettings.CN()&&document.getElementById(n.a.oba)||this.ndh();this.Fxc(!0);this.dd(null,null);Sa=this.$.xa;Sa.Vf(this.Fh);Sa.uWc(this.gza);Sa.EY(this.KD);Sa.eha(this.vGb);Sa.EGa(this.zza);Sa.Iqe(this.lHf);Sa.CZa(this.nHf);Sa.MKg(this.mHf);
Sa.FWc(this.Rxf);Sa.Fqe(this.Sxf);Sa.Gqe(this.Txf);Sa.Hqe(this.BPa);this.$.ml(this.dd);this.$.PA(this.hj);sa.a(this.$).ai(this);this.$.da.Ga(32,this);r.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.ku(this.zf);this.Cyc=this.Ce.Zd(this.domElement);this.Cyc.ka("keydown",this.onKeyDown);Va.a(this.$).mq()&&this.aG(null,new ja.a(!0));Va.a(this.$).Yf.c$(this.aG);fa.h(this.$).fqe(this.HFb);this.Cyc.ka("mousedown",dc=>{dc.preventDefault()});A.a.instance.ta(z.a.CD,
this.domElement,this.fO);this.WSd=this.Ce.Zd(this.il);this.WSd.ka("scroll",this.onScroll);this.zNj=Ia.a(()=>{this.t0()},200,this.$.la,K.a.Qzj,!0);this.$.sD(n.a.HGj);this.dlf&&(this.Ije=new mb(this.$,this.USa.domElement));r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&V.PageLoadTrackingInfo.instance.x0(n.a.tBa,["sheetTabBar"])}get mc(){return this.domElement}get Gf(){return this.isVisible}get de(){return oa.a.USd}get QF(){return this.WMc}get VSd(){return this.xh.length}get yyc(){return this.Jje}get Kxa(){return this.Nbe}get navigationButtonsDisabled(){return!!this.mua&&
this.mua.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.mua&&this.mua.operationButtonsDisabled}get Lzd(){return this.ym?this.$.EJ?[X.a.H9b,X.a.URe,X.a.WRe,X.a.G9b,X.a.Wua,X.a.Wua]:[X.a.G9b,X.a.WRe,X.a.URe,X.a.H9b,X.a.Wua,X.a.Wua]:this.$.EJ?[X.a.H9b,X.a.TRe,X.a.VRe,X.a.G9b,X.a.Wua,X.a.Wua]:[X.a.G9b,X.a.VRe,X.a.TRe,X.a.H9b,X.a.Wua,X.a.Wua]}get Nzd(){return this.$.EJ?[null,ta.a.pEe,ta.a.nEe]:[null,ta.a.nEe,ta.a.pEe]}get KMf(){return this.$.EJ?[null,ta.a.qEe,ta.a.oEe]:[null,ta.a.oEe,
ta.a.qEe]}get YCb(){if(this.isRtl){if(B.a.RF)return 0;if(B.a.If)return-1*(this.il.scrollWidth-this.il.clientWidth);if(B.a.Jw)return this.il.scrollWidth-this.il.clientWidth;v.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get OKb(){if(this.isRtl){if(B.a.RF)return this.il.scrollWidth-this.il.clientWidth;if(B.a.If||B.a.Jw)return 0;v.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.il.scrollWidth-
this.il.clientWidth}get Bwe(){return this.mua?[this.VH,this.Czb]:[this.VH,this.Czb,this.USa]}get $Lj(){return this.xh.concat(this.USa)}get Jzj(){return this.Ije}pb(Sa,na,jb,Ib,dc,ob,Fa=!1){Sa.removeAttribute("Href");Sa.setAttribute(n.a.Ld,n.a.ot);Sa.className=N.Kwh;Sa.title=na;Sa.tabIndex=0;this.Mw&&ob?jb=this.svgIconProvider.Aba(ob,12,12,Sa,24,24):(na=document.createElement("span"),na.className=this.ym?X.a.e3g:X.a.qv,na.classList.add(W.a.via),na.tabIndex=-1,Sa.appendChild(na),ob=document.createElement("img"),
ob.src=ya.a.we(jb),ob.className=Ib,ob.alt=dc,ob.tabIndex=-1,na.appendChild(ob),jb=ob);Fa&&Sa.classList.add(W.a.rU);return jb}dispose(){if(this.$){var Sa=this.$.xa;Sa.Dg(this.Fh);Sa.oLd(this.gza);Sa.s7(this.KD);Sa.rna(this.vGb);Sa.nRa(this.zza);Sa.GUf(this.lHf);Sa.OJb(this.nHf);Sa.Sfj(this.mHf);Sa.ALd(this.Rxf);Sa.DUf(this.Sxf);Sa.EUf(this.Txf);Sa.FUf(this.BPa);this.$.Jl(this.dd);this.$.YD(this.hj);Va.a(this.$)&&Va.a(this.$).Yf.Jda(this.aG);this.mua&&fa.h(this.$).hUf(this.HFb);A.a.instance.Ba(z.a.CD,
this.domElement,this.fO)}x.a.qc(this.Mzd);this.Mzd=null;if(this.ZK)for(Sa=0;Sa<this.ZK.length;Sa++){const na=ha.DOMElementExtensions.rK(this.ZK[Sa],this.domElement,!1,"a");na&&D.a.kna(na)}x.a.Ia(this.IC);x.a.Ia(this.Cyc);x.a.Ia(this.WSd);this.WSd=this.Cyc=this.Czb=this.VH=this.IC=null;this.$&&this.Gz&&this.wQ(!1);this.qaa=null;this.PQd(null,"Dispose");this.vOb=this.VM=this.z8b=null;this.b2c();this.ieb=this.Dyc=this.XSd=this.il=this.ZK=this.$=this.ea=null;super.dispose()}kg(Sa,na){if(!na){v.ULS.shipAssertTag(537153760,
0,0<this.xh.length,"There is no sheet tab button.");if(!this.xh.length)return!1;Sa=null;for(const jb of this.xh)if(Sa=jb.ZSh())break;if(!Sa)return v.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;ha.DOMElementExtensions.setFocus(Sa)}return!na}mh(Sa){return ha.DOMElementExtensions.yf(this.mc,Sa)}sj(){}Zj(){}reorderSheets(Sa,na,jb){if(this.W_&&this.W_!==Sa){const Ib=this.W_.index;this.Zhj(this.W_,Sa,na);Sa=Sa?Sa.index-1:na?this.$.xa.count-1:0;Ib!==Sa&&(this.jAi(Ib,Sa,jb),
this.aqh(this.W_.name,Sa))}}S3h(Sa){Sa=this.jja(Sa);return-1!==Sa&&this.uv<=Sa&&Sa<=this.MK?this.xh[Sa].domElement:null}bYj(Sa){if(this.Mw){for(var na=0;na<this.ZK.length;na++){const jb=this.ZK[na];if(jb&&this.svgIconProvider){const Ib=jb.parentNode;this.JTf(jb);Ib&&(this.ZK[na]=this.svgIconProvider.Aba(Sa?this.KMf[na]:this.Nzd[na],12,12,Ib,24,24))}}for(na=0;na<this.xh.length;na++)this.xh[na].pig(Sa);this.USa&&this.USa.Vsa&&this.oig(ta.a.H5h,this.USa,Sa);this.VH&&this.VH.Vsa&&this.oig(ta.a.h5g,this.VH,
Sa)}}oig(Sa,na,jb){na.kbb||(na.kbb=this.svgIconProvider.Aba(Sa,12,12,na.Vsa.parentNode,24,24));na.kbb&&(ha.DOMElementExtensions.setVisible(na.Vsa,!jb),ha.DOMElementExtensions.setVisible(na.kbb,jb))}eWi(Sa,na){var jb=fa.h(this.$);const Ib=jb.inRangePicker,dc=ra.HelperMethods.Eo(na);if(jb.eb&&!Ib){const ob=jb.Ul?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let Fa=void 0;r.EwaSettings.M7a&&(Fa=[Object(Ka.a)(jb.fc.textBox.YBa)]);Ka.b(this.$).mCa(dc.rawEvent,ob,Fa);jb.endEdit(!0,
"SheetTabBar.OnSheetTabMouseDown")}jb=this.Kxa&&3===na.tb;!(2===na.tb&&dc.button===Sys.UI.MouseButton.leftButton||jb)||Ib||this.QF||Va.a(this.$).mq()||(jb&&Sa.bWi(),this.sCb=na.clientPoint.x,this.mZ=na,this.kTg(Sa))}cWi(Sa){!this.Gz&&this.QF&&this.QUd(Sa.sheet,!1)}dWi(Sa){this.Gz||(this.QF&&this.reorderSheets(Sa.sheet,!1,!0),this.wQ());this.t0()}Gse(){return this.$.isEditMode&&!da.k(this.$.lg)}t0(){const Sa=ra.HelperMethods.t6(()=>{this.ZVj();this.ym&&this.jxj();this.xRd()});v.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Sa}`)}jxj(){const Sa=this.MK===this.xh.length-1;ha.DOMElementExtensions.toggleCssClass(this.ieb,this.$.EJ?N.XRe:N.MRe,!!this.uv);ha.DOMElementExtensions.toggleCssClass(this.ieb,this.$.EJ?N.MRe:N.XRe,!Sa)}xRd(Sa=!1){const na=!this.uv,jb=this.MK===this.xh.length-1;this.z3f(4,this.sheetTabActivatePreviousHidden,!na);this.z3f(5,this.sheetTabActivateNextHidden,!jb);this.Uxc(0,na||Sa);this.Uxc(1,na||Sa);this.Uxc(2,jb||Sa);this.Uxc(3,
jb||Sa)}z3f(Sa,na,jb){if(Sa=this.ZK[Sa]){ha.DOMElementExtensions.setVisible(Sa,jb);var Ib=this.S3e(Sa);Ib.title="img"===Sa.nodeName?Sa.alt=0<this.xh.length&&jb?na:"":Sa.title=0<this.xh.length&&jb?na:"";Ib.tabIndex=jb?0:-1}}S3e(Sa){return this.Mw?Sa.parentNode:Sa.parentNode.parentNode}Uxc(Sa,na){if(Sa=this.ZK[Sa])Sa=this.S3e(Sa),void 0!==Sa&&null!==Sa&&(!this.xh.length||na?(Sa.classList.add(W.a.rU),Sa.setAttribute(n.a.Isa,"true")):(Sa.classList.remove(W.a.rU),Sa.setAttribute(n.a.Isa,"false")))}LSa(Sa){const na=
this.$.EJ?this.xh.length-1:0;let jb=this.p6e(this.$.EJ?0:this.xh.length-1);jb&&(jb.borderRightWidth=Sa?"1px":"0");this.uv!==this.MK&&(jb=this.p6e(na))&&(jb.borderRightWidth="0")}zpe(Sa,na){this.xh||(this.xh=[]);-1===na?this.xh.push(Sa):this.xh.splice(na,0,Sa)}V5b(Sa,na){let jb=-1,Ib=null;na||(jb=this.aXh(Sa.index),-1!==jb&&(Ib=this.vLa(jb)));Sa=new Ha(this.$,this.il,Ib,Sa,this,this.ym,this.Mw);this.zpe(Sa,jb);ha.DOMElementExtensions.setVisible(Sa.domElement,!0)}QUd(Sa,na){var jb=this.H3a(Sa);if(jb){this.Smd=
Sa;this.bzd=na;Sa=jb.domElement;jb=this.isRtl?Sa.offsetLeft+(this.il.scrollWidth-this.il.clientWidth-this.il.scrollLeft):Sa.offsetLeft-this.il.scrollLeft;if(!this.isRtl&&na||this.isRtl&&!na)jb+=Sa.offsetWidth;this.Byc.style.left=ra.HelperMethods.uc(jb-4);ha.DOMElementExtensions.setVisible(this.Byc,!0)}}ebf(){ha.DOMElementExtensions.setVisible(this.Byc,!1)}G0(Sa){const na=ra.HelperMethods.t6(()=>{switch(Sa){case 0:this.xwc(0);break;case 1:this.xwc(this.uv-1);break;case 2:this.xwc(this.uv+1);break;
case 3:this.scrollIntoView(this.xh.length-1);break;case 4:this.uv&&1<=this.xh.length&&(this.jne(this.uv-1),this.lPd());break;case 5:this.MK!==this.xh.length-1&&1<=this.xh.length&&(this.jne(this.MK+1),this.lPd());break;case 6:this.lPd()}});this.H8b&&this.QF&&this.WPb();v.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Sa}, duration = ${na}`)}jne(Sa){(Sa=this.PQ(Sa))&&Sa.activate()}BFh(Sa){if(0===Sa.TB){const na=this.$.xa;let jb=0;for(let Ib=0,dc=na.count;Ib<dc;Ib++){const ob=
Object(C.a)(pa.a,na.getItem(Ib));if(ob===Sa)return jb;0===ob.TB&&jb++}}return-1}oFh(Sa){const na=this.$.xa;for(let jb=Sa.index+1,Ib=na.count;jb<Ib;jb++)if(Sa=Object(C.a)(pa.a,na.getItem(jb)),0===Sa.TB)return Sa;return null}jja(Sa){for(let na=0;na<this.xh.length;na++){const jb=this.PQ(na);if(!jb)v.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${na}] is null even though index is not out of bounds!`);else if(jb.sheet===Sa)return na}return-1}H3a(Sa){Sa=
this.jja(Sa);return this.PQ(Sa)}jAi(Sa,na,jb){const Ib={};Ib.a=this.$.va.UserSessionId;Ib.b=jb;Ib.c=this.p8b;Ib.d=Sa;Ib.e=na;Ib.f=this.$.xa.count;Ya.b().Qe(2,Ib,jb)}Zhj(Sa,na,jb){const Ib=Object(C.a)(ba.a,this.$.xa);na?(na=na.index,na=Sa.index<na?na-1:na):na=jb?Ib.count-1:0;Ib.reorderSheet(Sa,na,!0)}Y2f(Sa){fa.h(this.$).Hf.gm(Sa)}kTg(Sa){if(!this.Suc){const na=this.domElement.ownerDocument.body;this.Gz?(J.a.instance.ta(z.a.Jj,document.documentElement,this.YN),this.Kxa&&(L.a.instance.ta(z.a.Zf,document.documentElement,
this.YN),L.a.instance.ta(z.a.Zf,this.domElement,this.hO))):(J.a.instance.ta(z.a.Jj,na,this.YN),L.a.instance.ta(z.a.Zf,na,this.YN));J.a.instance.ta(z.a.Qf,document.documentElement,this.H6);L.a.instance.ta(z.a.xe,na,this.H6);this.Suc=!0}this.W_=Sa.sheet;this.p8b=!1;this.Gz?(this.VM=null,this.z8b=Sa,this.qaa=Sa.domElement,this.PQd(ha.DOMElementExtensions.getBoundingClientRect(this.qaa),"BeginSheetTabButtonDrag")):(v.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(N.LRe),this.domElement.style.cursor="",this.Y2f("pointer"))}wQ(Sa=!0){if(this.Suc){this.Y2f(n.a.QQ);const na=this.domElement.ownerDocument.body;this.Gz?(J.a.instance.Ba(z.a.Jj,document.documentElement,this.YN),this.Kxa&&(L.a.instance.Ba(z.a.Zf,document.documentElement,this.YN),L.a.instance.Ba(z.a.Zf,this.domElement,this.hO))):(J.a.instance.Ba(z.a.Jj,na,this.YN),L.a.instance.Ba(z.a.Zf,na,this.YN));J.a.instance.Ba(z.a.Qf,document.documentElement,this.H6);L.a.instance.Ba(z.a.xe,
na,this.H6);this.WMc=this.Suc=!1}this.Crc=0;this.p8b=!1;this.Smd=this.W_=null;this.Gz?(this.qaa&&(this.qaa.style.visibility="visible",this.qaa=null),this.z8b=null,this.PQd(null,"EndSheetTabButtonDrag"),this.VM&&(this.VM.parentNode&&this.VM.parentNode.removeChild(this.VM),this.VM=null),this.kkj(Sa)):(this.domElement.classList.remove(N.LRe),this.ebf())}kkj(Sa){this.HWd(Sa);this.pD=this.sCb=-1}aqh(Sa,na){const jb=this.$.pa,Ib=jb?jb.ya:null;this.$.userOperationManager.Ic(new S.a(557,0,(dc,ob,Fa)=>ic(Ib,
Sa,na,dc,ob,Fa,null),64,()=>new Za(Sa,na)),null)}PQ(Sa){return 0<=Sa&&Sa<this.xh.length?this.xh[Sa]:null}o6e(Sa){return(Sa=this.PQ(Sa))?Sa.sheet:null}vLa(Sa){return(Sa=this.PQ(Sa))?Sa.domElement:null}p6e(Sa){return(Sa=this.vLa(Sa))?Sa.style:null}aXh(Sa){const na=this.$.xa;Sa+=1;let jb=-1;const Ib=this.xh?this.xh.length:0;for(;Sa<na.count;){const dc=Object(C.a)(pa.a,na.getItem(Sa));if(0===dc.TB){for(jb=0;jb<Ib&&this.o6e(jb)!==dc;jb++);break}Sa++}return-1===jb||jb===Ib?-1:jb}iHf(Sa){var na=this.H3a(Sa);
na&&(this.Gz&&this.QF&&(v.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),r.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.wQ()),this.il.removeChild(na.domElement),na=Array.indexOf(this.xh,na),this.xh.splice(na,1),this.t0(),(!this.isRtl&&na===this.xh.length||this.isRtl&&!na)&&this.LSa(!0),this.H8b&&this.QF?Sa===this.W_?(this.wQ(),this.G0(6)):this.WPb():
this.G0(6))}jHf(Sa){const na=Object(C.a)(pa.a,Sa);this.Gz&&this.QF&&(v.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),r.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.wQ());if(0===na.TB){this.LSa(!1);var jb=this.jja(Sa);-1===jb&&(v.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),
this.V5b(na,!1),jb=this.jja(Sa));this.Z9e(jb,!0)}}$hj(Sa,na){const jb=this.H3a(Sa);jb&&(this.Gz&&this.QF&&!na&&(v.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),r.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.wQ()),Sa=this.NLj(Sa,jb),!r.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Gz&&Sa&&na&&Sa.aWi())}NLj(Sa,
na){var jb=Array.indexOf(this.xh,na);const Ib=this.BFh(Object(C.a)(pa.a,Sa));if(-1===Ib||-1===jb)return null;jb!==Ib||this.Gz?(this.LSa(!1),{aGh:this.uv,Wui:this.MK}=yb.Whj(jb,Ib,this.uv,this.MK),na&&na.domElement.parentNode===this.il&&(this.il.removeChild(na.domElement),this.xh.splice(jb,1)),na=this.oFh(Sa),jb=this.jja(na),na=new Ha(this.$,this.il,this.vLa(jb),Object(C.a)(pa.a,Sa),this,this.ym,this.Mw),this.zpe(na,jb),jb=this.jja(Sa),this.Z9e(jb,!1,!this.ym)):na=null;return na}Oqh(){const Sa=this.xh?
this.xh.length:0,na=this.uv,jb=this.MK;for(let Ib=0;Ib<Sa;Ib++){const dc=this.PQ(Ib),ob=Ib>=na;dc&&(dc.tabIndex=ob&&Ib<=jb?0:-1)}}KUj(){const Sa=this.xh?this.xh.length:0;for(let na=0;na<Sa;na++){const jb=this.PQ(na);jb&&jb.Cgb()}}Z9e(Sa,na,jb=!0){na&&Sa<=this.uv&&this.uv++;this.Oqh();this.LSa(!0);this.t0();this.H8b&&this.QF?this.WPb():jb&&this.G0(6)}Fxc(Sa){const na=this.$.EJ;if(Sa||this.isRtl!==na)this.isRtl=na,this.domElement.classList.remove(this.isRtl?X.a.SRe:X.a.YRe),this.domElement.classList.add(this.isRtl?
X.a.YRe:X.a.SRe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.KUj();Sa||this.LSa(!0);for(Sa=0;Sa<this.ZK.length;Sa++)0!==Sa&&3!==Sa&&(!this.ym||4!==Sa&&5!==Sa)&&this.A3f(Sa)}hch(){const Sa=this.XSd=document.createElement("div");Sa.className=N.Hwh;this.ym&&Sa.classList.add(N.Iwh);this.domElement.appendChild(Sa);this.P5b(Sa,1,717,716);this.P5b(Sa,2,719,718);this.dlf&&(this.USa=new ib(this.$,this,Sa));this.ym||this.P5b(Sa,4,723,722)}ich(){const Sa=this.Dyc=document.createElement("div");Sa.className=
N.Jwh;this.domElement.appendChild(Sa);this.ym||this.P5b(Sa,5,725,724);this.D5c()}ndh(){const Sa=document.getElementById(n.a.Hzj),na=document.getElementById(n.a.Izj);Sa&&!na&&v.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Sa.parentNode.id}. progressBar div has child: ${!!Sa.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(n.a.NSd)}`);const jb=t.a.jlf(this.$);if(jb&&Sa&&na)this.domElement.appendChild(Sa),
this.QMb=Sa.firstChild,this.Eyc=document.getElementById(n.a.NSd),na.style.visibility="visible";else{const Ib=document.createElement("div"),dc=document.createElement("div");Ib.className=X.a.Swh;dc.className=X.a.Qwh;r.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&(dc.id=n.a.eeb);dc.style.display="none";const ob=document.createElement("div");ob.className=X.a.Twh;const Fa=document.createElement("div");Fa.className=X.a.Rwh;const Ab=document.createElement("div");Ab.className=
X.a.Pwh;dc.appendChild(ob);dc.appendChild(Fa);dc.appendChild(Ab);Ib.appendChild(dc);this.domElement.appendChild(Ib);this.QMb=dc;this.Eyc=Fa;v.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",jb,Sa,na)}}A3f(Sa){var na=this.ZK[Sa];if(na)if(this.Mw){const jb=na.parentNode;this.JTf(na);na=aa.a(this.$)?this.KMf[Sa]:this.Nzd[Sa];this.ZK[Sa]=
this.svgIconProvider.Aba(na,12,12,jb,24,24)}else na.className=this.Lzd[Sa]}JTf(Sa){(null===Sa||void 0===Sa?0:Sa.parentNode)&&Sa.parentNode.removeChild(Sa)}J$g(){const Sa=this.ieb=document.createElement("div");Sa.className=N.Bwh;this.domElement.appendChild(Sa);this.qeh(Sa)}qeh(Sa){const na=document.createElement("div");na.className=N.Vwh;na.classList.add(N.Cwh);this.$.printingEnabled||na.classList.add(U.a.fUe);Sa.appendChild(na);this.il=document.createElement("ul");ha.DOMElementExtensions.Nu(this.il,
n.a.CYc,null,null);this.il.className=U.a.ZRe;na.appendChild(this.il);this.ach();this.Jje=document.createElement("div");this.yyc.id="SheetIconTooltipContainer";na.appendChild(this.yyc)}ach(){const Sa=document.createElement("div");var na="<div class='"+X.a.h3g+"'>{0}</div>";const jb=ya.a.Sed(X.a.Sxh,0,"55_16_N","");na=String.format(na,jb);r.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&r.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")&&
this.htmlSanitizationHelper?this.htmlSanitizationHelper.dk(Sa,na):Sa.innerHTML=na;Sa.className=N.Uwh;ha.DOMElementExtensions.setVisible(Sa,!1);this.Byc=Sa;this.il.appendChild(Sa)}V5c(){const Sa=this.$.xa;for(let na=0,jb=Sa.count;na<jb;na++){const Ib=Object(C.a)(pa.a,Sa.getItem(na));0===Ib.TB&&(this.V5b(Ib,!0),Ib.active&&Ib.activate())}}b2c(){x.a.qc(this.xh);this.xh=[];this.MK=this.uv=0}P5b(Sa,na,jb,Ib){const dc=document.createElement("a");Sa.appendChild(dc);Sa=this.Nzd[na];this.ZK[na]=this.pb(dc,
H.a.instance.ga(Ib),0,this.Lzd[na],H.a.instance.ga(jb),Sa);if(5===na||4===na)ha.DOMElementExtensions.rK(this.ZK[na],dc,!1,"span").style.marginTop="10px";this.A3f(na);jb=this.Mzd[na]=this.Ce.Zd(dc);J.a.instance.ta(z.a.pointerDown,dc,Fa=>Fa.ctrlKey&&this.HMi(na)?!0:this.pEf(na));J.a.instance.ta(z.a.Qf,dc,()=>this.qEf());L.a.instance.ta(z.a.xe,dc,()=>this.qEf());J.a.instance.ta(z.a.pointerOut,dc,()=>this.U1c());T.KeyInputManager.instance.ta(z.a.Pb,dc,Fa=>13!==Fa.Ca.keyCode&&32!==Fa.Ca.keyCode||this.a4c?
!1:(this.a4c=!0,this.pEf(na)));T.KeyInputManager.instance.ta(z.a.Fd,dc,Fa=>13===Fa.Ca.keyCode||32===Fa.Ca.keyCode?(this.a4c=!1,this.U1c()):!1);const ob=this.Gse();Ib=Fa=>{"mouseup"===Fa.type&&this.Gz&&this.QF||La.g(Fa);dc.classList.contains(W.a.rU)||(ob?this.SSi(Fa,na):this.ym||this.rEf(Fa,na))};jb.ka("mouseover",Ib);jb.ka("mouseout",Ib);jb.ka("focus",Ib);jb.ka("blur",Ib);ob&&jb.ka("mouseup",Ib)}hhf(Sa){let na=!1;const jb=this.$.vf;jb&&(na=O.a.BN(ha.DOMElementExtensions.getBoundingClientRect(jb),
Sa.clientPoint));return na}glf(Sa){return O.a.BN(ha.DOMElementExtensions.getBoundingClientRect(this.domElement),Sa.clientPoint)||this.hhf(Sa)}xFh(Sa){let na=null;const jb=Sa.clientPoint;let Ib=this.uv;if(this.glf(Sa))for(Ib=this.uv;Ib<=this.MK;Ib++)if(na=this.PQ(Ib))if(Sa=ha.DOMElementExtensions.getBoundingClientRect(na.domElement),!this.isRtl&&jb.x<Sa.x+Sa.width||this.isRtl&&jb.x>Sa.x)break;return{returnValue:na,qDj:Ib>this.MK}}WPb(){if(this.Gz){if(!this.VM){v.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.VM=this.qaa.cloneNode(!0);if(!this.rZf(this.VM,this.qaa,!0,"UpdateDragAndDropState"))return;this.qaa.style.visibility="hidden";this.VM.classList.add(N.Wwh);this.VM.style.borderRightWidth="";this.Qdc=this.mZ.clientPoint.x-this.c4.width/2;this.VM.style.left=this.Qdc+"px";this.pD=this.jja(this.W_);0>this.pD&&v.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.H8b&&(this.pD=this.jja(this.W_));var Sa=ha.DOMElementExtensions.getBoundingClientRect(this.il),
na=Sa.x;Sa=Sa.x+Sa.width;let jb=this.mZ.clientPoint.x-this.c4.width/2;jb=Math.min(jb,Sa-this.c4.width);jb=Math.max(jb,na);this.VM.style.transform="translateX("+Math.abs(jb-this.Qdc)*(this.Qdc<jb?1:-1)+"px)";const Ib=this.mZ.clientPoint.x>this.sCb;let dc=this.mZ.clientPoint.x;jb>=Sa-this.c4.width?(dc=Sa-this.c4.width/2,this.iPd()||this.cna||(v.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.Bqc=
this.il.scrollLeft,this.cna=window.requestAnimationFrame(this.S_f))):jb<=na?(dc=na+this.c4.width/2,this.hPd()||this.cna||(v.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.Bqc=this.il.scrollLeft,this.cna=window.requestAnimationFrame(this.R_f))):this.cna&&(v.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.HWd());
this.mZ.clientPoint.x!==this.sCb&&(this.yXd(Ib,dc),this.sCb=this.mZ.clientPoint.x)}else(Sa=({qDj:na}=this.xFh(this.mZ)).returnValue)?this.QUd(Sa.sheet,na):this.ebf();this.WMc=!0}yXd(Sa,na){let jb;for(;({U2b:jb}=this.nnh(na,Sa)).returnValue;)this.vOb=jb,this.NOg(Sa)}NOg(Sa){if(this.vOb){var na=(Sa?1:-1)*this.c4.width;if(Sa&&!this.$.EJ||!Sa&&this.$.EJ){var jb=this.qaa;var Ib=this.pD+1;var dc=!0}else jb=(Ib=this.PQ(this.pD+1))?Ib.domElement:null,Ib=this.pD-1,dc=!1;if(this.rZf(this.vOb,jb,dc,"AnimateSheetSwap")){v.ULS.sendTraceTag(537153738,
0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.pD} and other sheet-index ${Ib}. amount of sheets in the bar: ${this.VSd} isMovingRight: ${Sa}`);0<=this.pD&&this.pD<this.xh.length&&0<=Ib&&Ib<this.xh.length?(Sa=this.xh[Ib],this.xh[Ib]=this.xh[this.pD],this.xh[this.pD]=Sa):(v.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.xh.length}, ghostIndex: ${this.pD}, swappedSheetIndex: ${Ib}`),this.wQ());this.pD=
Ib;var ob=this.vOb;ob.style.transform="translateX("+na+"px)";window.requestAnimationFrame(()=>{ob.style.transform="translateX(0px)"})}}}rZf(Sa,na,jb,Ib){const dc=ob=>ob?`Node ID: ${ob.id} , Node class: ${ob.className}, Node name: ${ob.nodeName},`:null;try{return this.il.insertBefore(Sa,na),!0}catch(ob){return Sa=this.H3a(this.W_),v.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
Sa?Sa!==this.z8b?"Changed":"NoChange":"Removed",Ib,dc(na),dc(na.parentNode),dc(this.il),jb,this.pD,this.VSd,ob),this.wQ(),!1}}nnh(Sa,na){var jb=this.$.EJ===na?this.PQ(this.pD-1):this.PQ(this.pD+1);if(!jb)return{returnValue:!1,U2b:null};jb=jb.domElement;const Ib=ha.DOMElementExtensions.getBoundingClientRect(jb);return this.c4?na?{returnValue:Sa+this.c4.width/2>=Ib.x+.5*Ib.width,U2b:jb}:{returnValue:Sa-this.c4.width/2<=Ib.x+.5*Ib.width,U2b:jb}:(v.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.wQ(),{returnValue:!1,U2b:jb})}O_f(Sa,na){let jb;jb=na?this.S_f:this.R_f;if(-1===this.kAc)this.kAc=Sa,this.cna=window.requestAnimationFrame(jb);else{Sa=Math.floor((Sa-this.kAc)/1E3*300);var Ib=this.OKb>this.YCb?1:-1;this.scrollLeft(Math.abs(this.il.scrollLeft-(na?this.Bqc+Sa*Ib:this.Bqc-Sa*Ib))*(na?-1:1));if(Sa=this.k2e("ScrollStep"))this.yXd(na,Sa.x+Sa.width/2),na&&!this.iPd()||!na&&!this.hPd()?this.cna=window.requestAnimationFrame(jb):(v.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.HWd())}}iPd(){const Sa=this.OKb>this.YCb;return Sa&&this.Jna>=this.OKb||!Sa&&this.Jna<=this.OKb}hPd(){const Sa=this.OKb>this.YCb;return Sa&&this.Jna<=this.YCb||!Sa&&this.Jna>=this.YCb}HWd(Sa=!0){this.il&&(this.Jna=this.il.scrollLeft);window.cancelAnimationFrame(this.cna);this.cna=0;this.kAc=-1;Sa&&this.t0()}PQd(Sa,na){Sa||v.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${na}`);this.c4=Sa}HMi(Sa){return 2===Sa?(this.G0(3),
!0):1===Sa?(this.G0(0),!0):!1}pEf(Sa){v.ULS.shipAssertTag(537153732,0,-1===this.mQa&&-1===this.lQa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.mQa&&(window.clearTimeout(this.mQa),this.mQa=-1);-1!==this.lQa&&(window.clearInterval(this.lQa),this.lQa=-1);this.G0(Sa);this.mQa=window.setTimeout(()=>{this.uJj(Sa)},this.AGi);return!0}uJj(Sa){this.lQa=window.setInterval(()=>{this.G0(Sa)},this.zGi)}qEf(){this.U1c();
return!this.Gz||!this.QF}U1c(){window.clearTimeout(this.mQa);window.clearInterval(this.lQa);this.lQa=this.mQa=-1;return!0}rEf(Sa,na){const jb=this.Lzd[na];ra.HelperMethods.RYd(this.ZK[na],jb,jb+n.a.wfc,"mouseover"===Sa.type||"focus"===Sa.type)}SSi(Sa,na){const jb=this.$hc(na),Ib=5===na;if("mouseup"===Sa.type){if(Ib||4===na)jb||this.reorderSheets(null,Ib,!1),this.wQ()}else!this.Gz&&this.QF?(jb||this.QUd(this.o6e(Ib?this.MK:this.uv),Ib),this.G0(Ib?2:1)):this.ym||this.rEf(Sa,na)}$hc(Sa){return!!ha.DOMElementExtensions.Tfd(this.ZK[Sa],
"a").title}ODc(Sa){this.S0d(Sa);this.t0()}S0d(Sa){(Sa=this.H3a(Sa))&&Sa.Cgb()}lPd(){var Sa=this.$.xa;if(Sa.oa&&(!za.e(this.$)||Sa.count))if(Sa=this.jja(Sa.oa),-1===Sa)v.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var na=this.vLa(Sa);Sa<this.uv?this.xwc(Sa):Sa>this.uv&&!this.Psd(na)&&this.scrollIntoView(Sa)}}ZVj(){this.uv=0;this.MK=this.xh.length-1;let Sa=!1;for(let na=0;na<this.xh.length;na++){const jb=this.PQ(na);if(!jb)break;
const Ib=this.Psd(jb.domElement);jb.tabIndex=Ib?0:-1;if(!Sa&&Ib)this.uv=na,Sa=!0;else if(Sa&&!Ib){this.MK=na-1;break}}}xwc(Sa){this.$.xa.count&&(this.xh.length||this.V5c(),this.K1f(this.vLa(Math.max(0,Math.min(Sa,this.xh.length-1)))),this.t0())}scrollIntoView(Sa){v.ULS.shipAssertTag(537153697,0,Sa>=this.uv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.xh.length||this.V5c();var na=this.vLa(Math.max(0,Math.min(Sa,
this.xh.length-1))),jb=this.vLa(this.uv);if(!this.Psd(na)){na=ha.DOMElementExtensions.getBoundingClientRect(na);var Ib=ha.DOMElementExtensions.getBoundingClientRect(this.ieb);na=this.isRtl?Ib.x-na.x:na.x+na.width-(Ib.x+Ib.width);for(Ib=0;jb&&Ib<na;){const dc=ha.DOMElementExtensions.getBoundingClientRect(jb);Ib+=dc.width;jb=jb.nextSibling}jb?this.K1f(jb):v.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.uv}, lastVisibleSheetTabIndex = ${this.MK}, scroll to index: ${Sa}`)}this.t0()}}K1f(Sa){const na=
ha.DOMElementExtensions.getBoundingClientRect(this.il);Sa=ha.DOMElementExtensions.getBoundingClientRect(Sa);this.isRtl?this.scrollLeft(Math.floor(na.x+na.width-(Sa.x+Sa.width+.5))):this.scrollLeft(Math.ceil(na.x-Sa.x-.5))}scrollLeft(Sa){(0>Sa&&this.iPd()||0<Sa&&this.hPd())&&v.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const na=this.il.scrollLeft;if(this.isRtl){if(B.a.RF||B.a.If){this.il.scrollLeft=this.Jna=na-Sa;
return}if(B.a.$H){this.il.scrollLeft=this.Jna=na+Sa;return}v.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.il.scrollLeft=this.Jna=na-Sa}Psd(Sa){Sa=ha.DOMElementExtensions.getBoundingClientRect(Sa);const na=ha.DOMElementExtensions.getBoundingClientRect(this.ieb);return Sa&&na?Sa.x>=na.x-1&&Sa.x+Sa.width<=na.x+na.width+1:(v.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}Cch(){const Sa=
this.Dyc;if(qa.d6f(this.$))this.ym?(x.a.Ia(this.VH),this.VH=new qa(Sa,this.$,this,!0)):(x.a.Ia(this.VH),this.VH=null);else if(!this.VH||this.ym)x.a.Ia(this.VH),da.k(this.$.lg)?this.VH=new tb(Sa,this.$,this):this.VH=new qa(Sa,this.$,this)}MHe(Sa,na){var jb=this.$.xa;if(!this.$.isEditMode||!jb.count)x.a.Ia(na),na=null;else if(!na)if(jb=this.ym?this.XSd:this.Dyc,da.k(this.$.lg))na=new tb(jb,this.$,this);else switch(Sa){case 0:na=new qa(jb,this.$,this);break;case 1:na=new rb(jb,this.$,this);break;default:v.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return na}D5c(){r.EwaSettings.ma(420)?(this.VH=this.MHe(0,this.VH),this.Czb=this.MHe(1,this.Czb)):this.Cch()}k2e(Sa){const na=ha.DOMElementExtensions.getBoundingClientRect(this.VM);na||(v.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Sa}: GetBoundingClientRect returned null for the dragged sheet.`),
this.wQ());return na}R9e(Sa,na){this.mua.SPg(Sa,na);this.wQ(!1);this.xRd(this.navigationButtonsDisabled);for(const jb of this.$Lj)jb&&jb.AS(this.navigationButtonsDisabled);for(const jb of this.Bwe)jb&&jb.AS(this.operationButtonsDisabled)}static Whj(Sa,na,jb,Ib){Sa<jb?(na>jb&&jb--,na>Ib&&Ib--):Sa>Ib?(na<jb&&jb++,na<Ib&&Ib++):na<jb&&jb++;return{aGh:jb,Wui:Ib}}}Object(u.a)(yb,"SheetTabBarControl",Q.a,[535,2,36]);class jc extends w.a{constructor(Sa){super();this.$=Sa;this.Fb()}create(){const Sa=this.$.Eb;
if(y.a(this.$.va,1))V.PageLoadTrackingInfo.instance.Mda(n.a.tBa,["sheetTabBar"]);else{var na=document.getElementById(Sa+n.a.a7c);if(na){r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&V.PageLoadTrackingInfo.instance.eBa(n.a.tBa);var jb=r.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&r.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")?e.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):h.Task.Ta(null),
Ib=t.a.bsd()?e.GetServiceTaskFactory.Oa(this.$.da,388,387,this.Ya):h.Task.Ta(null);f.TaskExtensions.Aa(f.TaskExtensions.Ed([Ib,jb],this.$.la),()=>{this.ob(this.$.da.za(32)||new yb(this.$,na,Ib.result,jb.result))},this.$.la,3)}else V.PageLoadTrackingInfo.instance.Mda(n.a.tBa,["sheetTabBar"])}}static ka(Sa){Sa.da.Ga(33,new jc(Sa))}}Object(u.a)(jc,"SheetTabBarFactory",w.a,[]);a.d(E,"a",function(){return Cc});const Cc=()=>{c.a.Fa(Sa=>{jc.ka(Sa);l.ka(Sa)})}},1156:function(u,E,a){var c=a(9),b=a(1);u=a(0);
var e=a(222),f=a(15),d=a(31),h=a(5),m=a(12),l=a(22),w=a(13),n=a(254),y=a(21),t=a(30);class r{constructor(fa){this.cwc=fa||""}static get qOe(){return r.K8d||(r.K8d=new r(""))}static get Owd(){return r.Mde||(r.Mde=r.ydd(2).cwc)}static a4a(fa){fa=t.a.Gg(fa||"");return new r(fa)}static Nac(fa){return r.a4a(w.a.instance.ga(fa))}static ydd(fa){return new r(w.a.instance.Ua(fa))}static BIh(fa,...Ka){return r.AIh(w.a.instance.nb(fa),...Ka)}static AIh(fa,...Ka){const aa=Ka.length,ja=Array(aa);for(let Va=0;Va<
aa;Va++)ja[Va]=(Ka[Va]||r.qOe).cwc;return new r(String.format(fa,ja))}}r.K8d=null;r.Mde=null;Object(u.a)(r,"SafeHtml",null,[575]);const v=(fa,Ka)=>{Ka&&(fa.append(Ka),fa.append(r.Owd))};class B{constructor(fa,Ka,aa,ja=null){this.Ezf=(Va,bb)=>{this.nQf(bb.Wd.command)};this.$=fa;this.htmlSanitizationHelper=ja;this.kfa=document.createElement("div");this.kfa.setAttribute(h.a.Z2,h.a.Bk);this.kfa.className=d.a.Q$c;Ka.insertBefore(this.kfa,aa);this.vga=document.createElement("div");this.vga.setAttribute(h.a.Z2,
h.a.Bk);this.vga.className=d.a.Q$c;Ka.insertBefore(this.vga,this.kfa);this.Oxg=w.a.instance.Ua(2);this.w$=document.createElement("div");this.w$.setAttribute(h.a.Ld,h.a.Hsa);this.w$.setAttribute(h.a.Jsa,h.a.jpb);this.w$.className=d.a.Q$c;Ka.insertBefore(this.w$,this.vga);this.register();this.$.da.Ga(211,this)}get rya(){return this.Oxg}get isActive(){return!0}get activeCell(){return y.h(this.$).Sb(null)}get Mrd(){return b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")}dispose(){this.$&&
this.unregister();m.DOMElementExtensions.uf(this.w$);m.DOMElementExtensions.uf(this.kfa);m.DOMElementExtensions.uf(this.vga);this.vga=this.kfa=this.w$=this.$=null}setEnabled(fa){this.x2f(this.vga,fa)}euj(){this.x2f(this.kfa,!0)}readText(fa){this.FIb(r.a4a(fa),!0)}MQa(fa){this.FIb(r.a4a(fa),!1)}qQf(fa,Ka){if(1>Ka||!fa)f.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var aa=new Sys.StringBuilder;fa=String.format(w.a.instance.nb(34),Ka,fa);v(aa,fa);v(aa,w.a.instance.ga(856));
this.FIb(r.a4a(aa.toString()),!1)}}V9i(fa,Ka,aa){if(1>aa||1>Ka||Ka>aa||!fa)f.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var ja=new Sys.StringBuilder;v(ja,fa);ja.append(String.format(w.a.instance.nb(55),Ka,aa));this.FIb(r.a4a(ja.toString()),!1)}}nQf(fa){fa=this.s_h(fa);this.FIb(fa,!1)}FIb(fa,Ka){if(fa=fa?fa.cwc:null)Ka=Ka?this.vga:this.kfa,l.a.equals(Ka.innerHTML,fa,!1)&&(fa+=r.Owd),this.Mrd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.dk(Ka,fa):Ka.innerHTML=
fa}Sbb(fa,Ka){this.w$.getAttribute(h.a.Jsa)!==Ka&&this.w$.setAttribute(h.a.Jsa,Ka);fa=fa?r.a4a(fa).cwc:"";this.Mrd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.dk(this.w$,fa):this.w$.innerHTML=fa}W9i(fa,Ka,aa,ja){const Va=w.a.instance.nb(54);f.ULS.shipAssertTag(537153949,0,!(void 0===fa||null===fa));f.ULS.shipAssertTag(537153948,0,!(void 0===Ka||null===Ka));f.ULS.shipAssertTag(537153947,0,!(void 0===aa||null===aa));f.ULS.shipAssertTag(537153946,0,!(void 0===ja||null===ja));f.ULS.shipAssertTag(537153945,
0,!(void 0===Va||null===Va));fa=String.format(Va,fa||"",Ka||"",aa||"",ja||"");this.Sbb(fa,h.a.fHa)}OUj(fa){var Ka=this.vga.style;fa?(fa=n.a.k2b(fa.cell,Ka),Ka=fa.XB,Ka.top=Ka.left=Ka.bottom=Ka.right=null,fa.V2()):Ka.cssText=""}s_h(fa){switch(fa){case -1985798686:return r.Nac(12);case -911352779:return r.Nac(11);case 237279923:return r.Nac(13);case -1502853784:return r.ydd(81);case -111689794:return r.ydd(78);case -287251124:return this.Qhd(1329,Ka=>Ka.bold);case -1925065947:return this.Qhd(1330,Ka=>
Ka.italic);case 1764140053:return this.Qhd(1331,Ka=>Ka.underline)}return null}register(){f.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(f.ULS.shipAssertTag(537153943,0,!!this.$.Ja,"Can't register to CommandHandlerManager's event"),this.$.Ja&&this.$.Ja.osa(this.Ezf))}unregister(){this.$&&this.$.Ja.BAa(this.Ezf)}x2f(fa,Ka){const aa=fa===this.kfa;Ka?(fa.setAttribute(h.a.Jsa,h.a.fHa),aa&&fa.setAttribute(h.a.Ld,h.a.Hsa),fa.setAttribute(h.a.Z2,h.a.xr),fa.removeAttribute(h.a.Z2),
this.Mrd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.dk(fa,fa.innerHTML+" "):fa.innerHTML+=" "):(fa.removeAttribute(h.a.Jsa),aa&&fa.removeAttribute(h.a.Ld),fa.setAttribute(h.a.Z2,h.a.Bk))}Qhd(fa,Ka){const aa=this.activeCell;if(!aa)return null;const ja=b.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),Va=[7,8];Ka=Ka(aa)?!0:!1;return r.BIh(ja?Va[+Ka]:Va[+!Ka],r.Nac(fa))}}Object(u.a)(B,"AriaLiveNotifier",null,[543,527,2]);var A=a(50),z=a(37);class x extends e.a{constructor(fa){super();
this.$=fa;this.Fb()}create(){if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")){const fa=A.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya);z.TaskExtensions.Aa(z.TaskExtensions.Ed([fa],this.$.la),()=>{this.ob(this.$.da.za(211)||new B(this.$,this.$.qu,this.$.vf,fa.result))},this.la,3)}else this.ob(this.$.da.za(211)||new B(this.$,this.$.qu,this.$.vf))}static ka(fa){fa.da.Ga(212,
new x(fa))}}Object(u.a)(x,"AriaLiveNotifierFactory",e.a,[]);var D=a(27),J=a(212),L=a(138),T=a(70);class O{constructor(fa,Ka){this.s0=this.FW=this.qO=null;this.vja=Ka;this.Edh(fa);this.T3i();b.EwaSettings.xb()&&fa.da.Ga(244,this)}get isActive(){return!!this.vja&&document.activeElement===this.vja}readText(fa){fa=String.format(w.a.instance.nb(30),fa);this.qO.setAttribute(h.a.kv,fa);this.FW.setAttribute(h.a.kv,fa);this.KLj()}dispose(){this.s0&&this.s0.parentNode&&this.s0.parentNode.removeChild(this.s0);
this.FW=this.qO=this.s0=this.vja=null}Edh(fa){var Ka=fa.Eb+"readoutElementWrapper";const aa=fa.Eb+"readoutElement1",ja=fa.Eb+"readoutElement2";this.s0=document.getElementById(Ka);this.s0||(this.s0=document.createElement(J.a.div),this.s0.id=Ka,this.qO=document.createElement(J.a.label),this.qO.id=aa,this.qO.setAttribute(L.a.contentEditable,T.a.NQb),this.qO.setAttribute(h.a.Ld,h.a.p_a),this.FW=document.createElement(J.a.label),this.FW.id=ja,this.FW.setAttribute(L.a.contentEditable,T.a.NQb),this.FW.setAttribute(h.a.Ld,
h.a.p_a),this.qO.style.width="0px",this.qO.style.height="0px",this.FW.style.width="0px",this.FW.style.height="0px",this.qO.tabIndex=-1,this.FW.tabIndex=-1,this.s0.appendChild(this.qO),this.s0.appendChild(this.FW),fa=fa.Eb+h.a.T4b,Ka=document.getElementById(fa),f.ULS.shipAssertTag(537153942,3,!!Ka,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${fa}`),Ka&&Ka.appendChild(this.s0))}T3i(){this.vja&&this.qO&&this.FW&&(this.vja.setAttribute(h.a.Y2,this.qO.id),
this.vja.setAttribute(h.a.zYc,`${this.qO.id} ${this.FW.id}`))}KLj(){if(this.isActive){let fa="";m.DOMElementExtensions.hasAttribute(this.vja,h.a.Y2)&&(fa=this.vja.getAttribute(h.a.Y2).toString());this.vja.setAttribute(h.a.Y2,fa===this.qO.id?this.FW.id:this.qO.id)}else f.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static l7a(){if(null==O.Bvb)if(b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!D.a.BNa)O.Bvb=
!0,f.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(O.Bvb=!1,D.a.$H||D.a.If)O.Bvb=!0,f.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return O.Bvb}static ka(fa){O.l7a()&&fa.da.Ga(244,new O(fa,y.h(fa).fc.textBox.Le))}}O.Bvb=null;Object(u.a)(O,"FocusBasedReadout",null,[527,2]);class G extends e.a{constructor(fa){super();this.$=fa;this.Fb()}create(){O.l7a()?
y.h(this.$).fc.textBox.cU(()=>{const fa=this.$.da.za(244)||new O(this.$,y.h(this.$).fc.textBox.Le);this.ob(fa)}):this.ob(null)}static ka(fa){fa.da.Ga(315,new G(fa))}}Object(u.a)(G,"FocusBasedReadoutFactory",e.a,[]);var C=a(7),H=a(87),I=a(83);const M=fa=>{switch(fa){case 1:return 1452;case 2:return 1453;case 3:return 1454;case 4:return 1455;case 5:return 1456;case 6:return 1457;case 7:return 1458;case 8:return 1459;case 9:return 1460;case 10:return 1461;case 11:return 1462;case 12:return 1463;case 13:return 1464;
case 14:return 1465;case 15:return 1466;case 16:return 1467;case 17:return 1468;case 18:return 1469;case 19:return 1470;case 20:return 1471;case 21:return 1472;case 22:return 1475;case 23:return 1473;case 24:return 1474;case 25:return 1476;case 26:return 1477;case 27:return 1478;case 28:return 1479;default:return 1480}};var Q=a(24),U=a(42),N=a(211),W=a(47),X=a(46),sa=a(122);class da{static get K8i(){return da.whe||(da.whe=RegExp("([A-Z]+)","g"))}static get J8i(){return da.vhe||(da.vhe=RegExp("([A-Z])",
"g"))}static get j1g(){return da.g6d||(da.g6d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static Fhd(fa){return da.j5e(fa.toString())}static j5e(fa){return da.j1g.test(fa)?fa.replace(da.K8i,"$1 ").replace(da.J8i,' "$1"').trim():fa}static sij(fa){const Ka=fa.lastIndexOf("!");return fa.substring(0,-1<Ka?Ka+1:0)+da.j5e(fa.substring(-1<Ka?Ka+1:0,fa.length))}}da.whe=null;da.vhe=null;da.g6d=null;Object(u.a)(da,"RangeAriaExtensions",
null,[]);class S{constructor(){this.activeItemName=null;this.Qkf=!1;this.tableName=null;this.$0a=0;this.YAc=!1}}Object(u.a)(S,"SelectionReadoutState",null,[]);a(64);var oa=a(76);class K{constructor(fa,Ka,aa,ja,Va){this.gridReadoutNotifier=null;this.Nbb=!1;this.Xsa=this.upb=null;this.vda=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?f.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):y.h(this.$).eb||this.i1b.sq()};
this.FJi=()=>{if(!y.h(this.$).ha.Sa.lrd){var bb,wa=({activeCell:bb}=this.DLh()).returnValue;this.readText(wa,bb)}};this.Lp=()=>{const bb=this.activeCell;this.readText("Editing",bb);b.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||bb&&bb.Dec&&!y.h(this.$).w$e||this.i1b.cancel()};this.Pc=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?f.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.vda(),this.Nbb&&y.h(this.$).inRangePicker&&1===oa.a.Db&&(null===this.upb?this.upb=W.a.instance.create(this.iJd,K.aVc,"readSelectedRanges"):this.upb.sq()))};this.$=Ka;this.ariaLiveNotifier=fa;this.sparklineManager=ja;this.tableManager=aa;this.UD=new S;this.l7a=O.l7a();this.Nbb=b.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.l7a&&(b.EwaSettings.xb()?this.gridReadoutNotifier=Va:this.gridReadoutNotifier=Ka.da.za(244),f.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),K.aVc=700);this.i1b=W.a.instance.create(this.FJi,K.aVc,X.a.Fqj,!1);this.Lj()}get activeCell(){return y.h(this.$).Sb(null)}dispose(){this.$&&this.gk();H.a.Ia(this.i1b);this.sparklineManager=this.$=this.i1b=null}R_e(fa,Ka,aa=!0){if(!fa)return"";var ja=this.$.da;const Va=new Sys.StringBuilder;this.HPg(Va,fa,Ka);if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var bb=this.tableManager.aka(fa.range);(null===
bb||void 0===bb?0:bb.mUd)&&this.Jte(Va,bb);bb=this.tableManager.Cn(fa.range);(null===bb||void 0===bb?0:bb.pba)&&this.Jte(Va,bb)}bb=fa.nba?this.I2e(fa):fa.text;v(Va,bb);bb=this.$.activeItemName;this.UD.activeItemName!==bb&&(v(Va,bb),this.UD.activeItemName=bb);bb=1===Ka.length?U.K(Ka).isSingle?"":w.a.instance.ga(852):String.format(w.a.instance.nb(31),Ka.length);v(Va,bb);for(var wa of Ka)v(Va,da.Fhd(wa)),1===Ka.length&&K.ksi(wa)&&(bb=y.h(this.$).Ea.ps(wa.bottomRight),void 0!==bb&&null!==bb&&bb.text&&
(bb=bb.nba?this.H2e(bb,bb.text):bb.text,v(Va,bb)));wa=fa.cell;wa=this.QXh(wa.cnj,wa.j4g);v(Va,wa);this.qPg(Va,fa);aa&&(fa.Q7a?v(Va,w.a.instance.ga(840)):fa.Hxa&&v(Va,w.a.instance.ga(841)));if(fa.hasAutoFilter||fa.V4)this.IPg(Va,fa.hasAutoFilter?fa.cell.autoFilterType:fa.cell.r1i),aa&&v(Va,w.a.instance.ga(843));N.c(this.$,fa.range)&&v(Va,w.a.instance.ga(847));this.nPg(Va,fa);aa=(aa=ja.za(14))?aa.BMh():"";v(Va,aa);fa.qB&&(aa=y.h(this.$).Ea.ps(fa.range),aa=!!aa&&aa.N$e,K.fAj(fa)?K.oPg(Va,fa):b.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
aa?v(Va,w.a.instance.ga(845)):v(Va,w.a.instance.ga(844)));fa.oV&&(v(Va,w.a.instance.ga(846)),fa.jyb&&v(Va,String.format(w.a.instance.nb(16),fa.Ogh)),v(Va,fa.iconName));fa.hasRichValueIcon&&(wa=this.$.da.za(271),aa="",wa&&fa.cell.Uof&&(wa=wa.FU(fa.cell.Uof))&&wa.DomainId.Id!==K.F1j&&(aa=wa.Name),fa.cell.Bii?(v(Va,String.format(w.a.instance.nb(187),aa)),v(Va,w.a.instance.ga(1803))):(v(Va,String.format(w.a.instance.nb(185),aa)),v(Va,w.a.instance.ga(1802))));this.a9h(fa)&&v(Va,K.uTh(fa));(ja=ja.za(231))&&
v(Va,ja.W2e(Ka,!0));1===Ka.length&&Ka[0].isSingle&&K.eAj(fa,Ka[0],this.$)&&(Ka=this.$.da.za(271))&&v(Va,Ka.MMh());fa.kPb&&fa.lPb&&v(Va,fa.lPb);(Ka=fa.cell.X_g)&&v(Va,Ka);fa.rNa&&fa.DHb&&(fa=fa.MFd)&&(v(Va,w.a.instance.ga(1979)),v(Va,fa));return Va.toString()}Kye(fa){this.Xsa=this.UD;this.UD=Object(C.a)(new S,{activeItemName:this.Xsa.activeItemName,YAc:fa?this.Xsa.YAc:!1,tableName:fa?this.Xsa.tableName:"",$0a:fa?this.Xsa.$0a:-1})}UXf(){this.Xsa&&(this.UD=this.Xsa,this.Xsa=null)}QXh(fa,Ka){return 2===
fa||2===Ka?w.a.instance.ga(874):1===fa||1===Ka?w.a.instance.ga(875):""}I2e(fa){return this.H2e(fa.cell,fa.text)}HPg(fa,Ka,aa){if(aa&&1===aa.length&&aa[0].isSingle){aa="";var ja=this.tableManager.aka(Ka.range);if(ja){aa=ja.pivotTableName;this.YXc(fa,aa);var Va=ja.Chc?w.a.instance.ga(835):"";b.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(Va+=(ja.altText?ja.altText+" . ":"")+(ja.altTextSummary?ja.altTextSummary:""));this.Lte(fa,!0,aa,Va);v(fa,this.tableManager.$pi(ja,
Ka.range)?w.a.instance.ga(837):"");v(fa,this.tableManager.Pji(ja,Ka.range)?w.a.instance.ga(836):"")}else if(ja=this.tableManager.Cn(Ka.range)){aa=(Va=y.h(this.$).Bb.Bj(Ka.range))?Va.name:"";this.YXc(fa,aa);let bb="";Va&&(bb=(Va.cUa?Va.cUa+" . ":"")+(Va.dUa?Va.dUa:""));this.Lte(fa,!1,aa,bb);v(fa,this.tableManager.Thf(ja,Ka.range)?w.a.instance.ga(836):"")}else this.YXc(fa,aa),this.UD.tableName="",this.UD.$0a=-1}}YXc(fa,Ka){Ka!==this.UD.tableName&&this.UD.tableName&&(fa.append(w.a.instance.ga(this.UD.YAc?
834:833)),v(fa," "+this.UD.tableName))}Lte(fa,Ka,aa,ja){aa!==this.UD.tableName&&(fa.append(w.a.instance.ga(Ka?832:831)),v(fa," "+aa),v(fa,ja),this.UD.tableName=aa,this.UD.YAc=Ka,this.UD.$0a=-1)}Jte(fa,Ka){const aa=y.h(this.$).ha.ra.activeCell;if(aa.top!==Ka.top&&aa.left!==this.UD.$0a){fa.append(w.a.instance.ga(836));Ka=new Q.Range(Ka.top,aa.left,Ka.top,aa.left,!0,!0);v(fa,da.Fhd(Ka));if(Ka=y.h(this.$).Sb(Ka))Ka=Ka.nba?this.I2e(Ka):Ka.text,v(fa,Ka);this.UD.$0a=aa.left}}H2e(fa,Ka){const aa=fa.h6a;return fa.Cwa?
String.format(w.a.instance.nb(14),Ka,aa):String.format(w.a.instance.nb(13),Ka,da.sij(aa))}Lj(){f.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var fa=y.h(this.$);f.ULS.shipAssertTag(537153929,0,!!fa,"Can't register to grid's events");fa&&(fa.Vb.Yk(this.Lp),fa.Ea.hw(this.vda),fa.AC(this.vda),this.Nbb&&fa.Vb.Rm(this.jg.bind(this)),fa=fa.ha,f.ULS.shipAssertTag(537153928,0,!!fa,"Can't register to selectionManager's events"),fa&&(fa.iH(this.Pc),fa.gH(this.vda),
fa.Sa.P2(this.vda),this.Nbb&&(this.iJd=this.iJd.bind(this))))}}gk(){if(this.$){var fa=y.h(this.$);fa&&(fa.Vb.Hk(this.Lp),fa.Ea.gx(this.vda),fa.ZD(this.vda),this.Nbb&&fa.Vb.em(this.jg),fa=fa.ha)&&(fa.jG(this.vda),fa.mL(this.vda),fa.Sa.qna(this.vda))}}readText(fa,Ka){this.l7a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(fa):(b.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(fa),
this.Nbb&&!Ka||this.ariaLiveNotifier.OUj(Ka))}jg(){this.upb&&this.upb.cancel()}iJd(){this.readText(this.d0h())}d0h(){let fa="";y.h(this.$).ha.rangePicker.gL.forEach(()=>{fa+=void 0});return fa+=" selected"}DLh(){let fa;fa=null;var Ka=y.h(this.$).ha;if(1!==Ka.Oe&&!Ka.Sa.$b)return f.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${Ka.Oe} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:fa};switch(Ka.Oe){case 2:return{returnValue:this.AOh(Ka),
activeCell:fa};case 64:var aa=Ka.Sa.$b.floatingObject,ja="";if(Ka=Ka.Sa.$b.Xs||Ka.Sa.$b.Jd)ja=(ja=Ka.firstChild)?m.DOMElementExtensions.getTextContent(ja):"";return{returnValue:String.format(w.a.instance.nb(53),K.bbc(aa.altText,aa.altTextDescription,aa.name),ja,aa.altTextDescription),activeCell:fa};case 4:return{returnValue:K.AOg(Ka.Sa.$b.floatingObject),activeCell:fa};case 512:return{returnValue:sa.a.q1e(Ka.Sa.$b.floatingObject.U8c),activeCell:fa};case 8:return aa=Ka.Sa.$b.floatingObject,{returnValue:String.format(w.a.instance.nb(51),
aa?aa.name:""),activeCell:fa};case 1:return fa=this.activeCell,{returnValue:this.R_e(fa,Ka.ra.selectedRanges),activeCell:fa}}return{returnValue:"",activeCell:fa}}AOh(fa){const Ka=new Sys.StringBuilder;Ka.append(K.A0g(fa));const aa=this.$.da.za(231);aa&&v(Ka,aa.W2e(fa.Sa.$b.floatingObject,!1));return Ka.toString()}a9h(fa){fa=fa.Zff();let Ka=!1;this.UD.Qkf!==fa&&(this.UD.Qkf=fa,Ka=!0);return Ka}qPg(fa,Ka){if(Ka.tyb)if(Ka=this.sparklineManager.Z0h(Ka)){var aa=w.a.instance,ja=aa.ga;a:switch(Ka.type){case 0:var Va=
828;break a;case 1:Va=829;break a;default:Va=830}aa=ja.call(aa,Va);v(fa,String.format(w.a.instance.nb(25),aa));Ka=String.format(w.a.instance.nb(24),da.Fhd(Ka.iIj));v(fa,Ka)}else f.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),v(fa,String.format(w.a.instance.nb(25),""))}IPg(fa,Ka){switch(Ka){case 1:case 11:v(fa,w.a.instance.ga(848));break;case 6:v(fa,w.a.instance.ga(848));v(fa,w.a.instance.ga(850));break;case 7:v(fa,w.a.instance.ga(848));v(fa,w.a.instance.ga(851));
break;case 2:v(fa,w.a.instance.ga(849));v(fa,w.a.instance.ga(850));break;case 3:v(fa,w.a.instance.ga(849));v(fa,w.a.instance.ga(851));break;default:v(fa,w.a.instance.ga(849))}}nPg(fa,Ka){var aa;const ja=this.$.da.za(65);Ka=ja?ja.RKa(Ka.range):null;let Va="";const bb=Object(I.a)(537,Ka);if(Ka)Va=!Ka.v7a&&bb&&bb.Jri?String.format(w.a.instance.nb(29),bb.xMj):String.format(w.a.instance.nb(23),Ka.author);else if(null===(aa=null===ja||void 0===ja?void 0:ja.Zm)||void 0===aa?0:aa.BF)Va=String.format(w.a.instance.nb(28),
ja.Zm.RN.author);v(fa,Va)}static AOg(fa){return String.format(w.a.instance.nb(52),K.bbc(fa.altText,fa.altTextDescription,fa.name),fa.altTextDescription)}static uTh(fa){return w.a.instance.ga(fa.Zff()?838:839)}static bbc(fa,Ka,aa){return fa||Ka?fa:aa}static A0g(fa){var Ka=fa.Sa.$b;fa=Ka.floatingObject;const aa=fa.Vc,ja=aa.ChartTitle,Va=fa.altText,bb=fa.altTextDescription,wa=!!(aa.Attributes&4);return(Ka=Ka.getSelectionDescription())?Ka:aa.DataRangeForDisplay?String.format(w.a.instance.nb(wa?49:47),
K.bbc(Va,bb,fa.name),bb,ja,w.a.instance.ga(M(aa.ChartCategory)),aa.DataRangeForDisplay):String.format(w.a.instance.nb(wa?50:48),K.bbc(Va,bb,fa.name),bb,ja,w.a.instance.ga(M(aa.ChartCategory)))}static fAj(fa){return b.EwaSettings.ma(102)&&(fa.d7a||fa.Ahc)}static oPg(fa,Ka){Ka.ITa?Ka.d7a?v(fa,String.format(w.a.instance.nb(26),Ka.ITa.topLeft.toString())):Ka.Ahc&&(Ka=Ka.ITa.zS(),v(fa,String.format(w.a.instance.nb(27),(Ka.LastColumn-Ka.FirstColumn+1).toString(),(Ka.LastRow-Ka.FirstRow+1).toString()))):
f.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static eAj(fa,Ka,aa){return fa.qB||!b.EwaSettings.ma(138)?!1:(fa=aa.da.za(271))?fa.Ygc(Ka):!1}static ksi(fa){return fa.top===fa.bottom&&fa.left+1===fa.right||fa.top+1===fa.bottom&&fa.left===fa.right}}K.F1j=268435712;K.aVc=500;Object(u.a)(K,"SelectionReadoutHandler",null,[538,2]);var ea=a(55),ya=a(695);class ha extends e.a{constructor(fa){super();
this.$=fa;this.Fb()}create(){const fa=this.$.da,Ka=A.GetServiceTaskFactory.Oa(fa,211,212,this.Ya),aa=A.GetServiceTaskFactory.Oa(fa,66,134,this.Ya),ja=A.GetServiceTaskFactory.Oa(fa,240,239,this.Ya);let Va=ea.Task.Ta(null);b.EwaSettings.xb()&&(Va=A.GetServiceTaskFactory.Oa(fa,244,315,this.Ya));z.TaskExtensions.Aa(z.TaskExtensions.Ed([Ka,aa,ja,Va],this.la),()=>{const bb=Object(ya.a)(this.$.da,226,()=>new K(Ka.result,this.$,aa.result,ja.result,Va.result));this.ob(bb)},this.$.la,3)}static ka(fa){fa.da.Ga(227,
new ha(fa))}}Object(u.a)(ha,"SelectionReadoutHandlerFactory",e.a,[]);class La{constructor(fa,Ka){this.$=Ka;this.ariaLiveNotifier=fa}uQf(){const fa=this.DMh();this.ariaLiveNotifier.Sbb(fa,h.a.jpb)}DMh(){const fa=new Sys.StringBuilder;this.$.workbookContext&&v(fa,this.$.workbookContext.WorkbookFileName);v(fa,w.a.instance.ga(854));v(fa,this.FMh());v(fa,this.EMh());v(fa,w.a.instance.ga(855));return fa.toString()}FMh(){return this.$.isEditMode?w.a.instance.ga(859):w.a.instance.ga(860)}EMh(){var fa=this.Q0j();
const Ka=this.$.xa.oa;fa=1!==fa?String.format(w.a.instance.nb(32),fa):w.a.instance.ga(853);fa=new Sys.StringBuilder(fa);Ka&&Ka.sheetName&&(fa.append(r.Owd),fa.append(String.format(w.a.instance.nb(33),Ka.sheetName)));return fa.toString()}Q0j(){let fa=0;for(const Ka of this.$.xa.items)Ka.visible&&fa++;return fa}}Object(u.a)(La,"WorkbookReadout",null,[]);class Ia{constructor(fa,Ka,aa){this.jDf=()=>{this.E2d.uQf();this.ariaLiveNotifier.setEnabled(!0)};this.$=Ka;this.ariaLiveNotifier=fa;this.E2d=new La(fa,
Ka);this.uac=aa.lhd(this.$);this.uac.TKg(this.jDf)}dispose(){this.uac&&this.uac.Zfj(this.jDf);this.uac=this.ariaLiveNotifier=this.$=null}}Object(u.a)(Ia,"EmbeddedWorkbookReadoutHandler",null,[2]);class ra{constructor(fa,Ka){this.cW=()=>{this.Cd||this.hte()};this.Cd=!1;this.oZ=Ka.kZ;this.ariaLiveNotifier=fa;this.E2d=new La(fa,Ka);this.oZ&&this.oZ.aR?this.hte():this.Lj()}dispose(){this.gk();this.ariaLiveNotifier=this.oZ=null;this.Cd=!0}Lj(){if(this.oZ){this.oZ.jv(this.cW);this.oZ.Ea.hw(this.cW);this.oZ.AC(this.cW);
var fa=Object(I.a)(310,this.oZ);fa&&(fa.Vb.Yk(this.cW),fa.ha.iH(this.cW),fa.ha.gH(this.cW),fa.ha.Sa.P2(this.cW))}else f.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}gk(){if(this.oZ){this.oZ.Ea.gx(this.cW);this.oZ.ZD(this.cW);const fa=Object(I.a)(310,this.oZ);fa&&(fa.Vb.Hk(this.cW),fa.ha.jG(this.cW),fa.ha.mL(this.cW),fa.ha.Sa.qna(this.cW))}}hte(){this.E2d.uQf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.euj();this.dispose()}}
Object(u.a)(ra,"WorkbookReadoutHandler",null,[2]);class pa extends e.a{constructor(fa){super();this.$=fa;this.Fb()}create(){const fa=A.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Ya);if(this.$.HK){const Ka=A.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya);z.TaskExtensions.Aa(z.TaskExtensions.Ed([fa,Ka],this.$.la),()=>{const aa=Object(ya.a)(this.$.da,228,()=>new Ia(fa.result,this.$,Ka.result));this.ob(aa)},this.$.la,3)}else z.TaskExtensions.Aa(fa,Ka=>{const aa=Object(ya.a)(this.$.da,228,()=>
new ra(Ka.result,this.$));this.ob(aa)},this.$.la,3)}static ka(fa){fa.da.Ga(229,new pa(fa))}}Object(u.a)(pa,"WorkbookReadoutHandlerFactory",e.a,[]);a.d(E,"a",function(){return ba});const ba=()=>{c.a.Fa(fa=>{x.ka(fa);b.EwaSettings.xb()?G.ka(fa):O.ka(fa);ha.ka(fa);pa.ka(fa)})}},1159:function(u,E,a){var c=a(9);u=a(0);var b=a(692),e=a(50),f=a(37),d=a(15),h=a(4),m=a(31),l=a(5),w=a(24),n=a(76),y=a(58);class t{constructor(gb,mb){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=gb;this.sortType=
mb}cV(){return this.autoFilterOptions}}Object(u.a)(t,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[137]);class r{constructor(gb){this.autoFilterOptions=null;this.autoFilterOptions=gb}cV(){return this.autoFilterOptions}}Object(u.a)(r,"MacroRecorderRangeItemFilteredPayload",null,[137]);var v=a(1129),B=a(42),A=a(371),z=a(188),x=a(60),D=a(162),J=a(211),L=a(47),T=a(46),O=a(12),G=a(282),C=a(1),H=a(183),I=a(22),M=a(281),Q=a(21);class U{constructor(gb,mb){this.tableRange=this.tableRanges=null;this.styleIndex=
0;this.tableRanges=gb;this.tableRange=B.l(gb.Ranges[0],gb.SheetName);this.styleIndex=mb}}Object(u.a)(U,"MacroRecorderTableStyleAppliedPayload",null,[137]);class N extends U{constructor(gb,mb,Ga,ib){super(gb,Ga);this.isCreation=this.hasHeaders=!1;this.hasHeaders=mb;this.isCreation=ib}}Object(u.a)(N,"MacroRecorderRangeFormatedAsTablePayload",U,[]);class W{constructor(gb,mb,Ga){this.description=this.title=this.tableRange=null;this.tableRange=gb;this.title=mb;this.description=Ga}Cn(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}
Object(u.a)(W,"MacroRecorderTableAltTextEditedPayload",null,[137]);class X{constructor(gb,mb){this.newName=this.oldName=null;this.oldName=gb;this.newName=mb}}Object(u.a)(X,"MacroRecorderTableRenamedPayload",null,[137]);class sa{constructor(gb){this.originalRange=null;this.originalRange=gb}}Object(u.a)(sa,"MacroRecorderTableResizedPayload",null,[137]);class da{constructor(gb,mb,Ga){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=gb;this.optionType=mb;this.isPivotTable=Ga}}
Object(u.a)(da,"MacroRecorderTableStyleOptionToggledPayload",null,[137]);var S=a(29),oa=a(44);class K{constructor(gb){this.tableName=null;this.tableName=gb}}Object(u.a)(K,"MacroRecorderTableConvertedToRangePayload",null,[137]);var ea=a(807);class ya{constructor(gb,mb,Ga){this.Grd=!1;this.sharedSheetRange=mb;this.$=gb;this.di=this.$.Jb.Pg("UserAction","ConvertToRangeManager");this.tableName=Ga}Xab(){this.di.start();const gb=this.$.pa.ya.Wb();return ea.i(this.$.pa.ya,this.sharedSheetRange,mb=>{this.showDialog(mb)},
null,null,null,gb)}showDialog(gb){d.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.di.zc} milliseconds`);gb&&!G.a(gb)&&((this.Grd=gb.Result)?(gb=S.a.Zc(3,2,0,738,0,-66108047,"ConvertToRange"),f.TaskExtensions.Aa(oa.a(this.$).vj(gb),mb=>{d.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.di.zc} milliseconds`);0===mb.result&&this.x8g()},this.$.la,11)):this.y8g());this.di.stop();
d.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.di.zc} milliseconds`)}Lxe(){const gb={};gb.IsQueryTable=this.Grd;gb.Range=this.sharedSheetRange;return gb}x8g(){const gb=this.$.pa.ya;d.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.hff(194,(mb,Ga,ib)=>ea.d(gb,this.Lxe(),mb,Ga,ib,null));d.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}y8g(){const gb=this.$.pa.ya;
d.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.hff(193,(mb,Ga,ib)=>ea.c(gb,this.Lxe(),mb,Ga,ib,null),()=>new K(this.tableName));d.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}hff(gb,mb,Ga=null){A.a(this.$.userOperationManager,mb,ib=>new z.a(gb,0,ib,void 0,Ga),null)}}Object(u.a)(ya,"ConvertToRangeManager",null,[]);var ha=a(1128),La=a(946),Ia=a(13);class ra extends La.a{constructor(gb,mb){super(gb);this.BOb=mb}get pc(){return"FormatAsTableDialog"}get cC(){return 215}get Pl(){return Ia.a.instance.ga(732)}jk(){const gb=
B.s(this.aaa.TableRange);return()=>new N(gb,this.hasHeaders,this.BOb,!0)}nH(){const gb=B.s(this.aaa.TableRange),mb=this.aaa.HasTotalRow;return(Ga,ib,cc)=>ea.h(this.$.pa.ya,gb,this.hasHeaders,!1,mb,this.BOb,Ga,ib,cc,null)}}Object(u.a)(ra,"FormatAsTableReactDialog",La.a,[]);La=a(284);var pa=a(89);class ba extends La.a{constructor(gb){super(gb);this.lMj=(mb,Ga)=>{1===mb&&this.SQj(B.D(this.rKf(Ga[ba.GPf])))};this.Wwb=mb=>{mb=this.Cgd(mb);return this.Sdd(mb)};this.gridView=Q.h(gb);this.ra=this.gridView.ha.ra;
this.Cqc=this.gridView.Bb.Bj(this.ra.activeCell).usedRange;gb=this.kN(this.Cqc.toString());this.initializeAndShow(Ia.a.instance.ga(733),this.lMj,gb)}get pc(){return"ResizeTableDialog"}rKf(gb){gb=gb.startsWith("=")?gb.substring(1,gb.length):gb;if(({sheetName:gb,range:mb}=B.Z(gb,this.$.xa)).returnValue&&mb){var mb=B.v(mb,this.$);mb.SheetName=I.a.equals(gb,"",!0)?this.$.oa.name:gb;return mb}return null}kN(gb){return{[ba.sV]:"ResizeTableDialog",[ba.GPf]:gb,["getInputErrorIfInvalid"]:this.Wwb}}Cgd(gb){gb=
this.rKf(gb);if(!gb)return 1;const mb=B.D(gb);return I.a.equals(gb.SheetName,this.$.oa.sheetName,!0)&&this.Cqc.top===mb.top&&this.Cqc.Bd(mb)?0:2}Sdd(gb){let mb="";switch(gb){case 1:mb=Ia.a.instance.ga(75);break;case 2:mb=pa.a.dg(Ia.a.instance.ga(74))}return mb}SQj(gb){this.$.Xc(-1400250766,n.a.Db,8,{["ResizeTableRange"]:gb,["OriginalTableRange"]:this.Cqc})}}ba.sV="id";ba.GPf="range";Object(u.a)(ba,"ResizeTableDialog",La.a,[]);class fa extends La.a{constructor(gb){super(gb);gb=Q.h(this.$);gb=gb.Bb.Bj(gb.ha.ra.activeCell);
I.a.Dh(gb.cUa)?this.JEd="":this.JEd=gb.cUa;I.a.Dh(gb.dUa)?this.IEd="":this.IEd=gb.dUa;gb=this.kN(this.JEd,this.IEd);this.initializeAndShow(Ia.a.instance.ga(742),this.eMj,gb)}get pc(){return"TableAltTextDialog"}eMj(gb,mb){1===gb&&(gb=mb[fa.FOj],mb=mb[fa.$ih],gb===this.JEd&&mb===this.IEd||this.$.Xc(868579142,n.a.Db,8,{["Title"]:gb,["Description"]:mb}))}kN(gb,mb){return{["id"]:"AltTextDialog",["title"]:gb,["description"]:mb}}}fa.sV="id";fa.FOj="title";fa.$ih="description";Object(u.a)(fa,"TableAltTextDialog",
La.a,[]);var Ka=a(771),aa=a(772),ja=a(112),Va=a(69),bb=a(55),wa=a(33),ka=a(145),ta=a(101);class qa{constructor(gb,mb,Ga,ib){this.menuId=null;this.lSa=-1;this.CMi=cc=>{if(!G.a(cc)){const xb=Q.h(this.$);var ic=new w.Range(1,1,1,1,!0,!1);ic=B.v(ic,this.$);null!=cc.Result&&(ka.a("CreateSampleTable.NewSheet"),ic.SheetName=cc.Result.toString());xb.Bg(ic,null,null,null,0,"TableCommandHandler.OnCreateSampleTableDone")}};this.RHf=()=>{this.Cda()};this.vXi=cc=>{if(!(this.ra.KMa()||(!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||
G.a(cc)||this.bNa())&&G.a(cc)&&this.bNa())){cc=this.ra.activeCell;var ic=this.ra.activeRange;const xb=this.tableManager.Kg.usedRange;2===this.lSa&&D.g(this.tableManager.Kg)&&cc.bottom===xb.bottom&&(ic=ic.R5?new w.Range(ic.top-1,ic.left,ic.bottom-1,ic.right,!1,!0):new w.Range(ic.top,ic.left,ic.bottom-1,ic.right,!1,!0),cc=ic.contains(cc)?cc:w.Range.Qc(ic.bottom,cc.left),Q.h(this.$).ha.updateSelection(ic,cc,0,3))}};this.OWi=cc=>{G.a(cc)?(d.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),
this.$.af()):d.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.NWi=()=>{d.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.af()};this.PWi=(cc,ic)=>{ic&&this.BS(ic);G.b(cc,-569193796)&&(Va.a(this.$).hd.sM(-569193796),this.Ivi(cc.Errors[0]))};this.$=gb;this.tableManager=mb;this.namedSheetViewPublic=Ga;this.frame=this.$.frame;this.ha=Q.h(this.$).ha;this.ra=this.ha.ra;this.Cz=C.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.uB=wa.a.uB(this.$);this.tableStyleManager=ib;this.tableStyleManager.ZLg(this.RHf)}nc(gb,mb){switch(mb){case -544558380:return!(this.tableManager&&this.ra.DK()&&!this.bNa()&&D.d(this.tableManager.Kg));case 1544516694:return!(this.tableManager&&(this.ra.DK()?!this.bNa():this.ra.KMa()));case -697806646:case 323142015:return!this.ra.DK();case 341449783:case 2128797448:return C.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.ra.DK()?!this.bNa():
this.ra.KMa())):!(this.tableManager&&this.tableManager.Qsd(this.ra.activeCell));case -123538519:return!(this.ra.DK()&&this.tableStyleManager&&this.tableStyleManager.Rsd());case 756677940:return!(C.EwaSettings.ma(403)&&this.Xhi());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.Yhi());case 844144422:return!this.ra.DK();case -723113214:return!this.ra.DK();case 1371713064:case 875133075:return!wa.a.uB(this.$)||ta.k(this.$.lg)}return!1}executeCommand(gb,mb,Ga){var ib;
gb=f.TaskExtensions.Sj();const cc=this.$.pa.ya;let ic=null,xb=1;const Vb=mb.command,wb=this.$.pa.ya.Wb();let cb=null;if(this.uB)switch(Vb){case -2058042992:case 504133448:case -798968736:case 477776686:J.d(this.$,Ga.TopCellAddress,Vb,null);break;case -1400250766:J.d(this.$,Ga.OriginalTableRange,Vb,null);break;case -123538519:case 323142015:case 868579142:case 753331043:case 756677940:case 341449783:case 1544516694:case 2128797448:const Y=Q.h(this.$);J.d(this.$,Y.ha.ra.activeCell,Vb,null)}switch(Vb){case -2058042992:const Y=
y.a.li(Ga[n.a.og]);C.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&!Y.CriteriaType&&(Y.CriteriaType=0);qa.H1f(this.$,Y);ic=(V,za,yb)=>ea.a(cc,Y,null,null,!1,!1,!1,Ka.a.p5a(ja.a.lHa,aa.a.clearAutoFilter,V),za,yb,null);xb=176;cb=()=>new r(Y);break;case 504133448:case -798968736:case 477776686:const Oa=y.a.li(Ga[n.a.og]),Wa=Ga.TopCellAddress;qa.H1f(this.$,Oa);const Ca=504133448===mb.command?1:-798968736===mb.command?2:3;if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&
Wa){Ga=this.tableManager.Cn(Wa);if(!Ga){var lb=this.$.xa.oa;(null===(ib=B.D(lb.W0))||void 0===ib?0:ib.contains(Wa))?Ga=B.D(lb.W0):d.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(Ga&&!this.$.rYc([Ga],!0,1))break}else if(Ga&&!this.$.Yp([Ga],!0,1))break}ic=(V,za,yb)=>x.H(cc,Oa,Ca,M.b(V,this.PWi),za,yb,Wa,wb);xb=177;cb=()=>new t(Oa,Ca);break;case 341449783:case 2128797448:this.lSa=341449783===Vb?
0:2;({TCa:ic,operationName:xb,jk:cb}=this.toggleTableStyleOption(cc,wb));break;case -712419744:this.Cz?this.Tef(Ga[l.a.event]):this.Tef(null);break;case 875133075:case 1371713064:let Ra=B.r(this.ra.selectedRanges,this.$);if(!Ra)break;const la=this.P_h(Ga);ic=(V,za,yb)=>ea.e(cc,Ra,la,M.b(V,this.CMi),za,yb,null,wb);ib="TestHost"===this.$.va.DocumentHostInfo.HostTier;d.ULS.shipAssertTag(512275419,0,"OneDriveWOPI"===this.$.va.HostName||ib,"TableCommandHandler.CreateSampleTable: command executed for non-consumer audience and missing macro recorder");
xb=1025;break;case 1868184698:if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({aAb:ib,TCa:ic,jk:cb}=this.ueg(null,wb),ib)){xb=206;break}new ha.a(this.$);break;case 844144422:new ba(this.$);break;case 1544516694:case -544558380:if(ib=Ga[n.a.Jc])this.lSa=this.V1h(ib),-1!==this.lSa&&({TCa:ic,operationName:xb,jk:cb}=this.toggleTableStyleOption(cc,wb));break;case 756677940:if(this.bNa()&&this.Ujf()){d.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");
break}const ua=Ga.Text,xa=this.nVh();if(xa){ic=(za,yb,jc)=>ea.j(cc,ua,xa,M.b(za,this.OWi),M.a(yb,this.NWi),jc,wb);xb=217;let V=null;this.tableManager.Kg?V=this.tableManager.Kg.name:this.tableManager.nHd?V=this.tableManager.nHd.name:d.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");V&&(cb=()=>new X(V,ua))}else return d.ULS.sendTraceTag(537151175,0,
10,"TableCommandHandler.RenameTable: Selected Table Range is null"),bb.Task.Ta(!1);break;case 323142015:if(this.bNa())break;return(new ya(this.$,this.ked(),this.tableManager.Kg.name)).Xab();case -1400250766:xb=211;ic=this.$kj(Ga,cc,wb);const fb=B.m(Ga.OriginalTableRange,this.$.xa.oa);cb=()=>new sa(fb);break;case 1872288872:this.tableManager.t7i();break;case -123538519:const Jb=this.U1h(Ga);ib=I.a.contains(Ga[n.a.Jc],l.a.aIb,!0)||I.a.contains(Ga[l.a.uG],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";
d.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${ib} with style index ${Jb.toString()}`);let Ob=this.c6e();Ob&&(ic=(V,za,yb)=>ea.b(cc,Ob,Jb,V,za,yb,null,wb),cb=()=>new U(Ob,Jb),xb=212);break;case 753331043:ib=Ga[n.a.Jc];if(!ib)break;const eb=Number.parseInvariant(ib);if(this.ra.DK()){d.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${eb}`);let V=this.c6e();V&&(ic=(za,yb,
jc)=>ea.h(cc,V,!1,!1,!1,eb,za,yb,jc,null,wb),cb=()=>new N(V,!1,eb,!1),xb=215);break}if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({aAb:Ga,TCa:ic,jk:cb}=this.ueg(eb,wb),Ga)){xb=215;break}d.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${eb}`);new ra(this.$,Number.parseInvariant(ib));break;case 71074531:const Ma=Ga.HasHeader,va=Ga.TableRange;ic=(V,za,yb)=>ea.f(cc,va,Ma,!1,!1,V,za,yb,null);cb=()=>
new v.a(Ma,va);xb=206;break;case -723113214:new fa(this.$);break;case 868579142:d.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");xb=1022;const Pa=Ga.Title,Ha=Ga.Description,tb=this.ked();ic=(V,za,yb)=>ea.g(cc,Pa,Ha,tb,V,za,yb,null);let Ya;this.tableManager.Kg&&(lb=I.a.Dh(this.tableManager.Kg.cUa)?"":this.tableManager.Kg.cUa,Ya=I.a.Dh(this.tableManager.Kg.dUa)?"":this.tableManager.Kg.dUa);cb=Pa==lb?()=>new W(tb,void 0,Ha):Ha==Ya?()=>new W(tb,Pa,void 0):()=>new W(tb,Pa,Ha);break;default:return H.a(Vb)}if(ic){const Y=
Oa=>new z.a(xb,0,Oa,void 0,cb);gb=!this.namedSheetViewPublic||-2058042992!==Vb&&504133448!==Vb&&-798968736!==Vb&&477776686!==Vb?A.a(this.$.userOperationManager,ic,Y,mb):this.namedSheetViewPublic.mTa().continueWith(Oa=>{Oa.result&&A.a(this.$.userOperationManager,ic,Y,mb)})}return gb}toggleTableStyleOption(gb,mb){const Ga=this.ra.KMa();d.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${Ga?"PivotTable":"table"} style option ${this.lSa} was toggled.`);const ib=this.ked();return{TCa:(cc,
ic,xb)=>ea.l(gb,ib,this.lSa,M.b(cc,this.vXi),ic,xb,null,mb),operationName:196,jk:()=>new da(ib,this.lSa,Ga)}}$kj(gb,mb,Ga){const ib=gb.OriginalTableRange,cc=B.m(gb.ResizeTableRange,this.$.xa.oa),ic=()=>{this.tableManager.wbg(ib)},xb=Vb=>{Vb.Errors&&this.tableManager.wbg(ib)};return(Vb,wb,cb)=>ea.k(mb,cc,M.b(Vb,xb),M.a(wb,ic),cb,null,Ga)}U1h(gb){var mb=-1;gb[n.a.Jc]&&(mb=gb[n.a.Jc],mb=I.a.contains(mb,l.a.aIb,!0)?this.tableStyleManager.Vwb(mb):Number.parseInvariant(gb[n.a.Jc]));return mb}P_h(gb){return(gb=
gb[n.a.Jc])?Number.parseInvariant(gb):0}wc(gb,mb){gb=!1;switch(mb.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:case -723113214:case 868579142:gb=!0;break;case 756677940:gb=C.EwaSettings.ma(403);break;case 875133075:case 1371713064:gb=wa.a.uB(this.$)}return gb}Kc(gb,mb,Ga){gb=
!1;switch(mb){case "PopulateTableMoreStylesMenu":this.menuId=Ga.MenuId;this.tableStyleManager.Rsd()||this.tableStyleManager.t5a("formatAsTableMenu");gb=this.tableStyleManager.MLf(mb,Ga);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Ga.MenuId,this.tableStyleManager.Rsd()||this.tableStyleManager.t5a("accessibilityTab"),gb=this.tableStyleManager.MLf(mb,Ga)}return gb}dispose(){this.tableStyleManager.Sgj(this.RHf)}Cda(){(I.a.contains(this.menuId,"Format",!0)||I.a.contains(this.menuId,"Accessible",
!0))&&this.menuId&&this.frame.px(this.menuId)}ked(){return B.v(this.ra.activeCell,this.$)}nVh(){const gb=this.tableManager.iud;return gb?B.v(gb,this.$):null}Tef(gb){if(this.tableManager){var mb=Q.h(this.$),Ga=this.ra.activeCell,ib=this.tableManager.Cn(Ga),cc=null;if(!ib||ib.HBa)for(let ic of mb.eia)for(let xb of ic)mb=xb.Jt,Ga.left>=mb[0]&&Ga.left<=mb[mb.length-1]&&(cc=(mb=xb.rs(Ga).rK())?O.DOMElementExtensions.nk(mb,m.a.rse):null);else{const ic=mb.Sb(w.Range.Qc(ib.top,Ga.left));if(this.Cz){L.a.instance.create(()=>
{ic.invoke(8,gb)},0,T.a.obg,!0,!0);return}cc=ic.fLa(56).G6a}cc&&L.a.instance.create(()=>{O.DOMElementExtensions.zgc(cc,null)},0,T.a.obg,!0,!0)}}V1h(gb){gb=Number.parseInvariant(gb);return-1<gb&&8>=gb?gb:-1}bNa(){return!this.tableManager.Kg}Ujf(){return this.tableManager.nHd?!1:(d.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}Yhi(){const gb=this.ra.DK(),mb=this.ra.Og&&!Q.h(this.$).Bb.I5(this.ra.$c);return gb||mb}Xhi(){return this.ra.DK()||
!this.Ujf()}Y1h(gb){const mb=[];for(const Ga of gb)if(gb=J.b(this.$,Ga),null===gb||void 0===gb?0:gb.length)for(const ib of gb)ib.usedRange&&!mb.includes(ib.usedRange)&&mb.push(ib.usedRange);return mb}c6e(){const gb=this.ra.selectedRanges;let mb=[];if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))mb=this.Y1h(gb);else for(const Ga of gb)Q.h(this.$).Bb.I5(Ga)&&mb.push(Ga);return mb&&mb.length?B.r(mb,this.$):null}BS(gb){wa.a.ola(this.$)&&f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,
430,431,1),mb=>{mb.result.Lea(gb);d.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}Ivi(gb){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,446,447,0),mb=>{mb.result.yeh(this.$,gb)},this.$.la,3)}static H1f(gb,mb){mb.SheetName=gb.oa.name;mb.NamedObjectView=gb.ea.isNamedObjectViewMode}ueg(gb,mb){let Ga,ib;if(!this.ra.Og||1!=this.ra.$c.qH)return{aAb:!1,TCa:Ga,jk:ib};let cc=B.v(this.ra.$c,this.$);cc.LastColumn=cc.FirstColumn+
3-1;cc.LastRow=cc.FirstRow+4-1;const ic=B.D(cc),xb=Q.h(this.$);if(!ic.Jz||!xb.Bb.Ixa(ic))return{aAb:!1,TCa:Ga,jk:ib};h.AFrameworkApplication.Ip("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{aAb:!1,TCa:Ga,jk:ib};if(null==gb)Ga=(Vb,wb,cb)=>ea.f(this.$.pa.ya,cc,!1,!1,!1,Vb,wb,cb,mb),ib=()=>new v.a(!1,cc);else{const Vb=B.s(cc);Ga=(wb,cb,lb)=>ea.h(this.$.pa.ya,Vb,!1,!1,!1,gb,
wb,cb,lb,mb);ib=()=>new N(Vb,!1,gb,!0)}return{aAb:!0,TCa:Ga,jk:ib}}}Object(u.a)(qa,"TableCommandHandler",null,[223]);class rb extends b.a{constructor(gb){super(gb)}dispose(){super.dispose()}ld(){const gb=e.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Ya),mb=e.GetServiceTaskFactory.create(this.$.da,330,this.la,this.Ya),Ga=e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Ya);if(wa.a.uB(this.$)){const ib=e.GetServiceTaskFactory.create(this.$.da,128,this.la,this.Ya);f.TaskExtensions.Aa(bb.Task.jJ(gb,
Ga,mb,ib),()=>{this.Yc([new qa(this.$,gb.result,Ga.result,mb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}else f.TaskExtensions.Aa(bb.Task.jJ(gb,Ga,mb),()=>{this.Yc([new qa(this.$,gb.result,Ga.result,mb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}static ka(gb){b.a.Nd(86,new rb(gb))}}Object(u.a)(rb,"TableCommandHandlerFactory",b.a,[]);a.d(E,"a",function(){return Za});const Za=()=>{c.a.Fa(gb=>
{rb.ka(gb)})}},1164:function(u,E,a){u=a(0);var c=a(84),b=a(552),e=a(15);class f{constructor(){this.SFc={}}NEg(La){this.SFc[La.id.toString()]=La}XHi(La){const Ia=this.SFc;for(let ra in Ia)Ia[ra].notify(La,!1);this.SFc={}}z6i(La,Ia){Ia&&this.NEg(Ia);return this.YFf(La,Ia)}u9c(La){this.XHi(La)}mOe(La,Ia){La.notify(Ia,!0)}}Object(u.a)(f,"AEventEmitter",null,[542]);var d;(function(La){La[La.notStarted=0]="notStarted";La[La.waiting=1]="waiting";La[La.shouldRetry=2]="shouldRetry";La[La.complete=3]="complete"})(d||
(d={}));Object(u.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(La){e.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],["NewState"]:d[La]},"ResultType",this.E5e());this._state=La}}Object(u.a)(h,"AEventResult",null,[603]);class m extends h{constructor(){super();this.dTc=this.Dlb=null;this.state=0;this.bMc=this.sae=!1}get IR(){return this.Dlb}get Aoa(){return this.dTc}get sgi(){return this.sae}E5e(){return"GetMoreInfo Result"}}
Object(u.a)(m,"GetMoreInfoResult",h,[602,603]);var l=a(4),w=a(80),n=a(40),y=a(685),t=a(373),r=a(164),v=a(642),B=a(575),A=a(105),z=a(25);class x{constructor(La,Ia,ra,pa,ba,fa,Ka,aa){this.La=La;this.yh=Ia;this.wqg=ra;this.D1=pa;this.he=ba;this.GKc=fa;this.ivg=Ka;this.oYb=aa}Yaj(){this.h$a.Nb(z.a.openUrlInNewTab,A.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.h$a.Nb(z.a.UPa,A.a.frame,Object(c.a)(this,this.UPa,"openDocumentUrl"));l.AFrameworkApplication.UM?this.Bqf():this.h$a.Ne(z.a.o8b,
A.a.frame,Object(c.a)(this,this.o8b,"documentLoaded"),96)}openUrlInNewTab(La,Ia,ra,pa,ba){ba&&ba.MenuItemId&&(e.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:ba.SourceControlId,["AppType"]:B.a[this.Dca]}),n.a.lf(ba.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}UPa(La,Ia,ra,pa,ba){if(ba&&ba.MenuItemId){const fa=l.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),Ka=l.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");
e.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",fa,Ka);if(fa&&Ka){e.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:ba.SourceControlId,["AppType"]:B.a[this.Dca]});La=ba.MenuItemId.toString();const aa={};aa[t.a.QQa]="1";aa[t.a.documentUrl]=La;aa[t.a.reason]=v.a.open;e.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");l.AFrameworkApplication.jV().execute(ja=>{ja.Pj(r.a.tua,aa)})}else this.openUrlInNewTab(La,
Ia,ra,pa,ba)}return 32}o8b(){this.Bqf();return 32}AOa(La,Ia,ra=""){if(Ia&&Ia.LF){const pa=y.a[Ia.status];Ia=Ia.LF.getTime();const ba=this.Bw()-Ia;e.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:La,["RequestStatus"]:pa,["ElapsedMs"]:ba,["StartTime"]:Ia,["Notes"]:ra})}else e.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:La})}Bqf(){var La=l.AFrameworkApplication.fa.qa("QPGVCI"),Ia=w.a.iy(document.URL,
"wdNewAndOpenCt",La);if(Ia){Ia=parseInt(Ia);var ra=w.a.iy(document.URL,"wdPreviousSession",La);La=w.a.iy(document.URL,"wdPreviousCorrelation",La);var pa=l.AFrameworkApplication.fa.qa("NAOPLP");if(l.AFrameworkApplication.UM){var ba=l.AFrameworkApplication.UM.getTime();!Ia||Ia>ba?e.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:Ia,["DocumentLoadedTime"]:ba,["SessionId"]:ra,["Correlation"]:La}):e.ULS.sendTraceTag(5849683,202,
pa?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:ba-Ia,["ClickTimestamp"]:Ia,["SessionId"]:ra,["Correlation"]:La})}else e.ULS.sendTraceTag(5849681,202,pa?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:Ia,["SessionId"]:ra,["Correlation"]:La})}}get h$a(){return this.La.value}get MEb(){return this.yh.value}get Tvf(){return this.wqg.value}get Dca(){return this.D1.value}get jnc(){return this.he.value}get Bw(){return this.GKc}get Z_(){return this.ivg.value}get supportsGetMoreInfoForPersonalStorage(){return this.oYb.value}static get instance(){return x.Ma||
(x.Ma=x.eN())}static eN(){return new x(new b.a(()=>l.AFrameworkApplication.ub),new b.a(()=>l.AFrameworkApplication.Dd),new b.a(()=>l.AFrameworkApplication.sa),new b.a(()=>l.AFrameworkApplication.sa.Pa.Gj),new b.a(()=>l.AFrameworkApplication.Gi),()=>(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.sa.Pa.Z_),new b.a(()=>l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}x.Ma=null;Object(u.a)(x,"NewAndOpenCommonHelpers",null,[541]);var D=a(106);class J{constructor(La,Ia,ra){this.AXb=
this.Xi=null;this.qRc=0;this.YAg=La;this.he=Ia;this.P7d=ra}MNg(){this.qRc=this.bdb+1}tNd(La){this.Xi&&(this.he.np(this.Xi),this.Xi=null);La&&(this.qRc=0)}oJj(La){const Ia=this.uOj;0<=Ia?(this.MNg(),this.tNd(!1),this.Xi=new D.a(4,1,Ia,La,107),this.he.Eg(this.Xi)):(this.tNd(!0),e.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.P7d}))}get bdb(){return this.qRc}get uOj(){return this.bdb>=this.i1f.length?-1:this.i1f[this.bdb]}get i1f(){if(!this.AXb){const La=(this.YAg.value||"0").split(",");
this.AXb=[];for(let Ia=0;Ia<La.length;Ia++){const ra=parseInt(La[Ia]);isNaN(ra)?e.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.P7d,["Entry"]:La[Ia]}):Array.add(this.AXb,ra)}}return this.AXb}}Object(u.a)(J,"RetryHelper",null,[]);var L=a(41),T=a(30);class O extends f{constructor(La,Ia){super();this.k2=La;this.emb=new J(Ia,this.qEb.jnc,"GetMoreInfo");this.$o=new m}iCi(){this.Jxd("Document opened")}Rbh(La){return()=>{this.Jxd(La,!0)}}YFf(La,Ia=
null){e.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:La});3===this.$o.state?(Ia&&this.mOe(Ia,this.$o),e.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:La})):this.Jxd(La);return this.$o}Jxd(La,Ia=!1){this.emb.tNd(!Ia);1===this.$o.state?e.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:La,["RetryIndex"]:this.emb.bdb}):(e.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",
{["Trigger"]:La,["RetryIndex"]:this.emb.bdb}),this.$o.state=1,Ia=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.qEb.Z_,l.AFrameworkApplication.Ii),this.qEb.MEb.Zga(Ia,1,null,null,[O.Hge,O.Gke],!1,5,this.Uah(),this.Tah(La),null))}Uah(){return La=>{var Ia=!1;let ra=!1;var pa=!1,ba;l.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody")&&(La.data.ue?({At:ba}=L.d(La.data.ue)).returnValue?ba?(pa=!0,this.$o.dTc=ba.StorageServiceDisplayName,this.$o.Dlb=O.omf(ba.PersonalFileStorageUrl)?ba.PersonalFileStorageUrl:
"",""===this.$o.IR&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Xa("FileSource")&&(this.$o.Dlb=w.a.Eda(l.AFrameworkApplication.breadcrumbFolderUrl)),Ia=""===this.$o.IR&&""!==this.$o.Aoa):e.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));pa||((ba=La.data.responseHeaders)?(this.$o.dTc=(ba[O.Gke]||"").toString(),Ia=(ba[O.Hge]||"").toString(),this.$o.Dlb=O.omf(Ia)?Ia:"",""===this.$o.IR&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Xa("FileSource")?(this.$o.Dlb=w.a.Eda(l.AFrameworkApplication.breadcrumbFolderUrl),Ia=""===this.$o.IR&&""!==this.$o.Aoa):Ia=""===Ia&&""!==this.$o.Aoa):(e.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),ra=!0));pa=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.emb.bdb,ra,Ia,pa);this.qEb.AOa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",La.data,pa);this.A1f(3,Ia,ra)}}Tah(La){return Ia=>{this.qEb.AOa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",Ia.data,"Failure");this.A1f(2);this.emb.oJj(this.Rbh(La))}}A1f(La,Ia=!1,ra=!1){this.$o.state=La;this.$o.sae=
Ia;this.$o.bMc=ra;this.u9c(this.$o)}get qEb(){return this.k2.value}static get instance(){return O.Ma||(O.Ma=O.eN())}static eN(){return new O(new b.a(()=>x.instance),new b.a(()=>l.AFrameworkApplication.yWh))}static omf(La){if(!La)return e.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(T.a.ul(La).startsWith("https://"))return!0;e.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}O.Hge="PersonalFileStorageUrl";O.Gke=
"StorageServiceDisplayName";O.Ma=null;Object(u.a)(O,"GetMoreInfoActor",f,[]);var G=a(102),C=a(96);class H{constructor(La,Ia,ra,pa,ba){this.Qvg=6E4;this.Mcf="inactive";this.pne="active";this.fT=!0;this.he=La;this.Oug=Ia;this.GKc=ra;this.BYb=pa;this.fb=new C.a;ba&&this.gJj();this.vce=this.g3e()}goe(La){this.fb.addHandler(this.pne,La)}kHg(La){this.fb.addHandler(this.Mcf,La)}gJj(){const La=new D.a(5,2,this.Qvg,Object(c.a)(this,this.Abi,"inactiveLoop"),108);this.Bbi.Eg(La)}Abi(){const La=this.g3e(),Ia=
this.Bw()-La;Ia>this.FBc&&this.fT&&(e.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:Ia}),this.fT=!1,this.fb.raiseEvent(this.Mcf));La-this.vce>this.FBc&&(this.fT=!0,this.fb.raiseEvent(this.pne));this.vce=La}get Bbi(){return this.he.value}get g3e(){return this.Oug}get Bw(){return this.GKc}get FBc(){return this.BYb.value}static get instance(){return H.Ma||(H.Ma=H.eN())}static eN(){return new H(new b.a(()=>G.a.instance),()=>l.AFrameworkApplication.Kud.getTime(),()=>
(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.FBc),!0)}}H.Ma=null;Object(u.a)(H,"InactivityManager",null,[]);var I=a(83),M=a(904);class Q extends h{constructor(){super();this.Eee=this.Gee=this.Fee=null;this.state=this.yle=0;this.bMc=!1}get lzd(){return this.Fee}get evf(){return this.Gee}get kzd(){return this.Eee}get AOj(){return this.yle}E5e(){return"MruActor Result"}}Object(u.a)(Q,"MruResult",h,[604,603]);var U=a(240);class N{constructor(La,Ia,ra){this.task=null;this.$fc=La;this.LDi=Ia;
this.taskManager=ra;this.retryCount=this.Fzb=0;this.AQc=this.zCb=null}Doi(La,Ia){return La===U.a.Vcd||20===Ia||18===Ia||3===Ia}Spi(La){return 3===La||5===La||6===La||7===La||9===La||10===La||11===La||12===La||13===La||14===La||15===La||16===La||23===La||26===La||27===La||28===La}get psc(){return this.AQc}reset(){this.Fzb=this.retryCount=0;this.AQc=this.zCb=null;this.task&&(this.taskManager.np(this.task),this.task=null)}zfi(La,Ia,ra,pa){this.AQc=String.format("{0}_{1}",ra,pa);if(this.retryCount>=this.LDi)return e.ULS.sendTraceTag(562656907,
202,50,"Max retries exceeded"),!1;if(this.Doi(ra,pa))return e.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Spi(pa)&&1<=this.Fzb)return this.zCb=ra,!1;Ia=Math.max(Ia,this.$fc*Math.pow(2,this.Fzb));if(26===pa)Ia=Math.max(Ia,3E4);else if(27===pa||28===pa)Ia=Math.max(Ia,6E4);9===pa||412===ra&&(null==this.zCb||412!==this.zCb)?Ia=500:this.Fzb+=1;this.zCb=ra;this.retryCount+=1;this.task&&this.taskManager.np(this.task);e.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",
Ia);this.task=new D.a(2,1,Ia,La,107);this.taskManager.Eg(this.task);return!0}}Object(u.a)(N,"RetryManager",null,[]);var W=a(97),X=a(136),sa=a(137);class da{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(u.a)(da,"WriteOptions",null,[]);var S=a(556),oa=a(189);class K extends f{constructor(La,Ia,ra,pa,ba,fa,Ka){super();this.k2=La;this.Fxg=Ia;this.wra=new N(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.LD.jnc);this.Wra=new N(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.LD.jnc);this.Wzg=ra;this.Kme=pa;this.fEg={};this.jT=new Q;this.Kug=ba;this.MVb="";this.Zv=fa;this.N8d=Ka}get $Ec(){return this.fEg}Pcj(){this.LD.h$a.Nb(z.a.renameMostRecentlyUsedFileEntry,
A.a.frame,Object(c.a)(this,this.Lhj,"renameMruEntry"))}Lhj(){return this.M2d("Rename")}qCi(){this.htf("File Opened")}rCi(){this.htf("IntervalUpdate")}htf(La){e.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:La});this.M2d(La)}D4(La){(La=T.a.D4(La))&&La.startsWith(".")&&(La=La.substring(1,La.length));return La}j_e(){switch(this.LD.Dca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}B3h(La){var Ia=
this.Kug();if(!Ia)return null;const ra=new da;ra.documentUrl=this.N8d.value?encodeURI(Ia):Ia;ra.mruItemId=this.MVb;ra.app=this.j_e();if(Ia=this.Zv())ra.folderName=Ia.breadcrumbFolderName,Ia=Ia.tn,ra.documentName=T.a.Rq(Ia),ra.documentExt=this.D4(Ia);La&&(ra.documentName?ra.documentName.length?255<=ra.documentName.length?La.set("DocumentNameLength","Long"):2084<=ra.documentName.length&&La.set("DocumentNameLength","VeryLong"):La.set("DocumentNameLength","0"):La.set("DocumentNameLength","Null"));return JSON.stringify(ra)}M2d(La,
Ia=!1){if(4===this.LD.Dca&&!l.AFrameworkApplication.sua)return 2;var ra=X.a.fs();ra&&(ra.set("Trigger",La),ra.set("IsRetry",Ia?"true":"false"),ra.set("MruIdSent",this.MVb?"true":"false"),ra.set("URLEncoded",this.N8d.value?"true":"false"));W.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",ra);La=this.B3h(ra);if(!La)return Ia=!l.AFrameworkApplication.webEditingEnabled,ra&&(ra.set("WebEditingIsEnabled",l.AFrameworkApplication.webEditingEnabled?"true":"false"),ra.set("ProtectedFile",l.AFrameworkApplication.zsc?
"true":"false")),W.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Ia,!1,Object.assign(new oa.a,{extendedProperties:ra})),2;this.Wra&&!Ia&&this.Wra.reset();ra=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.LD.Z_,this.localeName);this.Kme?this.$Ec["X-FileId"]=l.AFrameworkApplication.Ii:ra+=String.format("&{0}",l.AFrameworkApplication.Ii);l.AFrameworkApplication.Qb&&(this.$Ec["X-Office-AudienceGroup"]=Object(I.a)(String,l.AFrameworkApplication.Qb.AudienceGroup)||"");this.$Ec["X-Timeout"]=
15E3;return this.LD.MEb.Pm(ra,2,La,this.$Ec,!0,5,Object(c.a)(this,this.n2j,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.Bfh,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}n2j(La){this.H9e(La.data)}H9e(La){const Ia=X.a.fs();this.Wra&&(Ia&&this.Wra.psc&&(Ia.set("LastError",this.Wra.psc),Ia.set("NumRetries",this.Wra.retryCount.toString())),this.Wra.reset());const ra=M.c(La.ue);ra&&ra.diagnostics_data&&(this.MVb=ra.diagnostics_data.mru_id);La=
+La.C3-+La.LF;Ia&&Ia.set("RequestDuration",La.toString());W.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new oa.a,{extendedProperties:Ia}))}Bfh(La){if(La.data.httpStatus===U.a.Lsb)this.H9e(La.data);else{var Ia=La.data.httpStatus===U.a.THb,ra=X.a.fs();this.U9e(this.Wra,La,this.ofh(),ra);ra&&(ra.set("StatusCode",La.data.httpStatus.toString()),Ia||this.KVc(La.data,ra));W.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",La.data.httpStatus),Ia,!1,Object.assign(new oa.a,
{extendedProperties:ra}))}}ofh(){return()=>{this.M2d("Retry",!0)}}EWh(){this.jmc("Polling")}DWh(){this.jmc("Retry",!0)}kCi(){this.jmc("Open")}jCi(){this.jmc("Activity")}jmc(La,Ia=!1){e.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:La});const ra=X.a.fs();ra&&(ra.set("Trigger",La),ra.set("IsRetry",Ia?"true":"false"));W.Health.instance.recordKpiUsage("GetMru",0,"smartfio",ra);this.wra&&!Ia&&this.wra.reset();this.Vah(Object(c.a)(this,this.GWh,"getMruV2FromServerSuccessCallback"),
Object(c.a)(this,this.CWh,"getMruFromServerFailureCallback"))}KVc(La,Ia){La&&La.responseHeaders&&(La=La.responseHeaders["X-CorrelationId"])&&Ia.set("ServerCorrelationId",La)}$yi(La,Ia){La&&(Ia&&Ia.set("RequestDuration",(+La.C3-+La.LF).toString()),W.Health.instance.recordKpiSuccess("GetMru",Object.assign(new oa.a,{extendedProperties:Ia})))}GWh(La){this.HWh(La)}HWh(La){var Ia="";let ra=null,pa=null,ba=null;const fa=M.c(La.data.ue);fa&&(ra=fa.places?fa.places.items:[],pa=fa.documents?fa.documents.items:
[],(ba=M.a(fa,!1))&&(Ia=L.c(ba)));l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Pa.w_&&sa.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Ia,!0));Ia=X.a.fs();this.wra&&(Ia&&this.wra.psc&&(Ia.set("LastError",this.wra.psc),Ia.set("NumRetries",this.wra.retryCount.toString())),this.wra.reset());ba||ra||pa?(this.LD.AOa("MruActor.GetMruV2FromServerSuccessCallback",La.data,"Success"),this.BDc(3,ba,ra,pa),this.$yi(La.data,Ia)):(this.LD.AOa("MruActor.GetMruV2FromServerSuccessCallback",
La.data,"Failure: Invalid JSON"),Ia&&this.KVc(La.data,Ia),W.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new oa.a,{extendedProperties:Ia})),this.BDc(3,null,null,null,!0));this.u9c(this.jT)}U9e(La,Ia,ra,pa){let ba=0,fa=0;const Ka=M.c(Ia.data.ue);Ka&&(null!=Ka.response_code&&(ba=Ka.response_code,pa&&pa.set("MruResponseCode",ba.toString()),9===ba&&(this.MVb="")),Ka.error_data&&null!=Ka.error_data.retry_after_ms&&(fa=Ka.error_data.retry_after_ms,pa&&pa.set("ExpectedRetryAfter",
fa.toString())));La&&(Ia=La.zfi(ra,fa,Ia.data.httpStatus,ba),pa&&(pa.set("CurrentRetryCount",La.retryCount.toString()),pa.set("RetryScheduled",Ia?"true":"false")))}CWh(La){this.FWh(La)}FWh(La){const Ia=La.data.httpStatus===U.a.THb,ra=X.a.fs();ra&&(ra.set("StatusCode",La.data.httpStatus.toString()),Ia||this.KVc(La.data,ra));this.LD.AOa("MruActor.GetMruFromServerFailureCallback",La.data,"Failure");this.BDc(2);this.U9e(this.wra,La,Object(c.a)(this,this.DWh,"getMruFromServerRetryTask"),ra);W.Health.instance.recordKpiFailure("GetMru",
String.format("RequestFailed_{0}",La.data.httpStatus),Ia,!1,Object.assign(new oa.a,{extendedProperties:ra}));this.u9c(this.jT);l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Pa.w_&&sa.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}BDc(La,Ia=null,ra=null,pa=null,ba=!1){if(3!==this.jT.state||3===La)this.jT.Fee=Ia,this.jT.Gee=ra,this.jT.Eee=pa,this.jT.state=La,this.jT.bMc=ba,this.jT.yle=this.LD.Bw()}YFf(La,
Ia){e.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:La,["ResultState"]:this.jT.state});Ia&&3===this.jT.state&&this.mOe(Ia,this.jT);return this.jT}Vah(La,Ia){this.BDc(1);let ra;const pa={};ra=String.format(this.LD.Z_+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.j_e(),this.localeName);this.Wzg.value||(ra+="&entity=docs");l.AFrameworkApplication.Qb&&(pa["X-Office-AudienceGroup"]=Object(I.a)(String,l.AFrameworkApplication.Qb.AudienceGroup)||"");this.Kme?
pa["X-FileId"]=l.AFrameworkApplication.Ii:ra+=String.format("&{0}",l.AFrameworkApplication.Ii);this.LD.MEb.Pm(ra,1,null,pa,!0,5,La,Ia,null)}get LD(){return this.k2.value}get localeName(){return this.Fxg.value}static get instance(){return K.Ma||(K.Ma=K.eN())}static eN(){return new K(new b.a(()=>x.instance),new b.a(()=>S.a.qK(l.AFrameworkApplication.lcid).name),new b.a(()=>l.AFrameworkApplication.sa.Pa.Hv),l.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),()=>l.AFrameworkApplication.sa.Pa.Ox,
()=>l.AFrameworkApplication.sm,new b.a(()=>l.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")))}}K.Ma=null;Object(u.a)(K,"MruActor",f,[]);class ea{constructor(){this.fnb=this.Fhe=this.gb=null;this.Lm=!1}get name(){return"Common.App.NewAndOpen.Core"}Wh(La){this.gb=La;La.register(541,"Common.INewAndOpenCommonHelpers").xc().Fc(()=>x.instance);La.register(542,"Common.IEventEmitter<Common.IGetMoreInfoResult>").xc().Fc(()=>O.instance);La.register(542,"Common.IEventEmitter<Common.IMruResult>").xc().Fc(()=>
K.instance)}init(){l.AFrameworkApplication.fa.Dv(()=>{this.rzb()})}rzb(){this.gb.resolve("Common.INewAndOpenCommonHelpers");this.gb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.gb.resolve("Common.IEventEmitter<Common.IMruResult>");var La=!1;x.instance.Yaj();l.AFrameworkApplication.cma&&(La=!0);l.AFrameworkApplication.pQf&&(K.instance.kCi(),0<l.AFrameworkApplication.fvf&&this.Koe(),this.Zyj(),La=!0);l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&La&&O.instance.iCi();
l.AFrameworkApplication.aXj&&(La=K.instance,La.Pcj(),La.qCi(),G.a.instance.Eg(this.bXj))}Zyj(){H.instance.goe(Object(c.a)(K.instance,K.instance.jCi,"makeGetMruRequestActivityTrigger"));H.instance.goe(Object(c.a)(this,this.Koe,"addGetMruFromServerTask"));H.instance.kHg(Object(c.a)(this,this.Fih,"deleteGetMruFromServerTask"))}Fih(){G.a.instance.np(this.gvf)}Koe(){G.a.instance.Eg(this.gvf)}get gvf(){return this.Fhe||(this.Fhe=new D.a(5,2,l.AFrameworkApplication.fvf,Object(c.a)(K.instance,K.instance.EWh,
"getMruFromServerTask"),109))}get bXj(){return this.fnb||(this.fnb=new D.a(2,2,6E4*l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(K.instance,K.instance.rCi,"makeUpdateMruTask"),197))}dispose(){this.Lm||(this.Lm=!0,this.fnb&&(G.a.instance.np(this.fnb),this.fnb=null))}}Object(u.a)(ea,"CorePackageManager",null,[4,5,2]);var ya=a(248);a.d(E,"a",function(){return ha});const ha=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");
ya.a.instance.Fi(new ea)}},1168:function(u,E,a){u=a(0);var c=a(4),b=a(222),e=a(15),f=a(84),d=a(54),h=a(195);class m{constructor(){this.wje=this.hSc=!1;const Ga=c.AFrameworkApplication.zk;0>=Ga||(this.zk=Ga,e.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.zk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Cha}),h.a.instance.XWc(Object(f.a)(this,this.KPa,"onSessionExpiredDetected")),h.a.instance.VWc(Object(f.a)(this,this.UGf,
"onSessionExpiringDetected")))}KPa(){h.a.instance.TLd(Object(f.a)(this,this.KPa,"onSessionExpiredDetected"));e.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.a8h()}UGf(){h.a.instance.SLd(Object(f.a)(this,this.UGf,"onSessionExpiringDetected"));this.wje||this.hSc||(e.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.wje=!0,this.QFj())}a8h(){this.hSc||(c.AFrameworkApplication.lG(d.a.hxc),this.hSc=!0,this.PFj())}}Object(u.a)(m,"ASessionExpirationManager",
null,[]);var l=a(87),w=a(38),n=a(29),y=a(13),t=a(44),r=a(250),v=a(6),B=a(81),A=a(253),z=a(69);class x extends m{constructor(Ga){super();this.Ra=new w.a;this.BH=this.Zmb=!1;this.$=Ga}fre(Ga){this.Ra.addHandler("SessionExpired",Ga)}rob(Ga){this.Ra.addHandler("TokenRefreshed",Ga)}yuc(Ga){this.Ra.removeHandler("TokenRefreshed",Ga)}get accessTokenExpiringMessage(){const Ga=(new Date(this.zk)).format(this.$.va.ShortTimeFormat);return String.format(y.a.instance.nb(78),Ga)}get tokenExpired(){return this.Zmb}get meb(){return!1}get aca(){return!1}get YJd(){return!1}get Y5(){return!1}Eec(){return h.a.instance.iR(c.AFrameworkApplication.zk)}dispose(){l.a.Ia(this.Ra);
this.$=null}QFj(){this.$.isEditMode&&this.eec(!1)}PFj(){this.Zmb=!0;this.eec(!0);this.Ra.raiseEvent("SessionExpired")}eec(Ga){e.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${Ga}, GotDeploymentOrTimedOutError ${this.$.ea.O4}`);const ib=this.$.rb.kp;Ga&&ib&&ib.isVisible&&1299163859===ib.error.MessageId&&this.$.rb.kp.rv();const cc=this.Zc(Ga);t.a(this.$).Js(new r.a(v.a.ey,5,()=>{const ic=z.a(this.$),xb=ic.hd.activityState;xb[B.a.E2]=this.$.kqb(this.$.isEditMode);
xb[B.a.rM]=B.a.e$a;xb[A.a.Jq]=v.a.accessTokenExpiringWarning;ic.hd.rr([cc])}))}Zc(Ga){return Ga?n.a.pIe():this.keh()}keh(){const Ga=n.a.Zc(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");Ga.Description=this.accessTokenExpiringMessage;return Ga}}Object(u.a)(x,"EwaAccessTokenExpirationManager",m,[520,521,2]);var D=a(7),J=a(170),L=a(80),T=a(640),O=a(28);class G{constructor(Ga,ib){this.$Ib=!1;this.correlationID=Ga;this.e6c=ib;this.SBc=!1;this.creationTime=O.a.Qa.zb}}Object(u.a)(G,"RefreshAccessTokenContext",
null,[]);var C=a(58),H=a(60),I=a(171),M=a(46),Q=a(110),U=a(118),N=a(1),W=a(22),X=a(143),sa=a(36),da=a(115);class S{}Object(u.a)(S,"Error",null,[]);class oa{}Object(u.a)(oa,"NamedResult",null,[]);class K extends oa{}Object(u.a)(K,"ErrorInfo",oa,[]);class ea{constructor(Ga,ib){this.EYb=Ga;this.UG=ib}get tokens(){return this.EYb}get errors(){return this.UG}}Object(u.a)(ea,"TokenRefreshArgs",null,[514]);class ya{constructor(Ga,ib){this.documentVisibilityObserver=null;this.Ra=new w.a;this.Kx=null;this.bfb=
this.Xlb=!1;this.vtc=null;this.fJb=!1;this.Kwd=!0;this.Gce=this.dce=this.BH=this.Zmb=!1;this.XS=null;this.I9e=()=>{if(this.$.ea.Zb)this.g$e(!1);else if(this.Kwd){this.Kwd=!1;const cc=z.a(this.$);e.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${cc.fi?cc.fi.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.Lcg()}]`)}};this.Tc=(cc,ic)=>{this.context&&(cc=this.$.ea,ic.WH&&this.context.$Ib&&
!this.context.SBc?(this.context.SBc=!0,ic={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},ic.IsUserActive=cc.Re.Hr,ic.RefreshAccessTokenCorrelationID=this.context.correlationID,ic=C.a.hc(ic),e.ULS.sendTraceTag(537170708,0,50,ic)):!this.Xlb||cc.Zb||this.context.e6c||(ic={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.Kx&&(this.Kx.cancel(),ic.Aborted=!0,ic.ResetStopRefreshRetriesUntilTokenExpired=!0,
this.bfb=!1),ic.TimeUntilTokenExpirationInMin=this.Lcg(),ic.RefreshAccessTokenCorrelationID=this.context.correlationID,ic=C.a.hc(ic),e.ULS.sendTraceTag(572019856,0,50,ic)))};this.tza=()=>{if(this.context&&this.context.$Ib&&!this.context.SBc){var cc={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};cc.CreatedForExpired=this.context.e6c;cc.RefreshAccessTokenCorrelationID=this.context.correlationID;cc.OpenWorkbookErrors=n.a.sc(this.$.ea.cG);cc.ExecutionContextErrors=n.a.sc(z.a(this.$).hd.errors);
cc.accesstokenTTL=c.AFrameworkApplication.zk;cc=C.a.hc(cc);e.ULS.sendTraceTag(537170707,0,15,cc)}};this.f$e=()=>{this.bfb=!1;this.g$e(!0)};this.kEd=()=>{this.fJb&&(this.$.ea.Re.EAa(this.kEd),this.fJb=!1);this.n$f()};this.$=Ga;this.VYd=ib;this.VJd=Ga.Jb.Pg("WebServiceCall","refreshToken");h.a.instance.XWc(this.f$e);h.a.instance.VWc(this.I9e);ib=this.$.ea;ib.Uj(this.Tc);ib.P_b(this.tza);this.REi=this.$.va.MinTokenLifetimeForRegularExpirationPromptInMin;this.I5f=this.$.va.ShortAccessTokenExpirationPromptSeconds;
this.zRf=this.$.va.RefreshAccessTokenDurationLimitInSec;this.Aig(Ga.ea.UJf,c.AFrameworkApplication.zk);Ga=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.zk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Cha,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.A2d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.C2d});e.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${Ga}`);this.$.da.$a(291,cc=>{this.documentVisibilityObserver=
cc})}fre(Ga){this.Ra.addHandler("SessionExpired",Ga)}rob(Ga){this.Ra.addHandler("TokenRefreshed",Ga)}yuc(Ga){this.Ra.removeHandler("TokenRefreshed",Ga)}get tokenExpired(){return this.Zmb}get aca(){return this.dce}get Y5(){return this.Gce}get context(){return this.XS}get meb(){return this.Y5?!1:this.$.ea.Re.Hr?1>da.a.y6:6>da.a.z6}get YJd(){return this.Xlb}Eec(){return h.a.instance.iR(c.AFrameworkApplication.zk)}dispose(){h.a.instance.TLd(this.f$e);h.a.instance.SLd(this.I9e);const Ga=this.$.ea;Ga&&
(Ga.uk(this.Tc),Ga.Auc(this.tza));l.a.Ia(this.Ra);this.documentVisibilityObserver=this.$=null}Lcg(){return this.Eec()?0:(c.AFrameworkApplication.zk-(new Date).getTime())/6E4}Aig(Ga,ib){if(0<ib&&!this.Eec()){const cc=c.AFrameworkApplication.fa.rd("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.tY),ic=(ib-Ga.getTime())/6E4;e.ULS.shipAssertTag(537170713,0,0<=ic,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${ib}] creationTime [${Ga.getTime()}] tokenLifetimeInMin [${ic}]`);
ic<this.REi?(e.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.I5f}] tokenLifetimeInMin [${ic}]`),c.AFrameworkApplication.tY=this.I5f):c.AFrameworkApplication.tY!==cc&&(e.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${cc}] tokenLifetimeInMin [${ic}]`),c.AFrameworkApplication.tY=cc)}}D9g(Ga){return!this.context||
this.context.$Ib||this.context.e6c!==Ga?(Ga=new G(J.a.create().toString(),Ga),this.context&&!this.context.SBc&&e.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${Ga.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.$Ib}] `),this.XS=Ga,!0):!1}lkj(Ga){Ga&&this.BH&&!this.aca&&this.$.ea.Re.Hr&&!this.Y5&&(this.BH=!1)}g$e(Ga){this.lkj(Ga);if(!(this.Xlb||this.bfb&&!Ga||this.BH)&&
this.meb){this.Xlb=!0;var ib=this.context?this.context.creationTime:null,cc=this.D9g(Ga);this.Kwd=!0;var ic=this.$.ea,xb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};xb.newContextCreated=cc;xb.IsUserActive=ic.Re.Hr;xb.IsSessionActive=ic.Zb;xb.ContainsChangesWorkbookOperations=this.$.userOperationManager.xta();xb.isSessionExpired=Ga;xb.stopRefreshRetriesUntilTokenExpired=this.bfb;xb.FailedToRefreshExpiredToken=this.BH;xb.numOfFailuresWhileUserIsActive=da.a.y6;xb.numOfFailuresWhileUserIsInActive=
da.a.z6;xb.numOfFailuresWhileOffline=da.a.Yya;xb.RefreshAccessTokenCorrelationID=this.context.correlationID;cc&&ib&&(xb.TimeInMinFromPreviosContextCreation=Math.round(U.b(O.a.Qa,ib)/60));ib=C.a.hc(xb);e.ULS.sendTraceTag(40416199,0,50,ib);this.VJd.start();this.dce=ic.Re.Hr;this.Kx=new T.a;this.uwi(Ga);var Vb=this.VYd.Gaj(!Ga,this.Kx?this.Kx.token:null);Vb.continueWith(()=>{this.j2g();const wb=this.VYd.O5i(Vb);this.VJd.stop();const cb=this.Eec();if(!wb||N.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
cb){const lb=Vb.result.errors;wb&&cb&&this.sGg(lb);this.J7h(lb,Ga)}else this.bfb=!1,this.K7h(Vb.result.tokens,Ga);this.Xlb=!1},8)}}sGg(Ga){const ib=[Object(D.a)(new S,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];Ga.add(Object(D.a)(new K,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ib}))}uwi(Ga){Ga&&(this.$.ea.Re.Hr?this.n$f():(this.$.ea.Re.fha(this.kEd),this.fJb=!0))}n$f(){this.vtc=I.AsyncMethodContext.Er(()=>{this.Faj()},1E3*this.zRf,M.a.oaj,this.vtc)}j2g(){this.vtc&&
this.vtc.cancel();this.fJb&&(this.$.ea.Re.EAa(this.kEd),this.fJb=!1);this.Kx=null}Faj(){e.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.zRf}]`);this.Kx.cancel()}J7h(Ga,ib){this.bfb=!0;ib&&(this.BH||(this.Zmb=this.BH=!0),this.VYd.eBb(Ga)&&(this.Gce=!0));const cc=!ib||this.meb&&!da.a.Uyc?40380379:39982555;ib=this.RGe(ib);ib.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ib.FailedToRefreshExpiredToken=
this.BH;ib.LastErrorIsPermanent=this.Y5;if(0<Ga.count){var ic=Ga.na(0);ib.errorName=ic.Name;0<ic.Errors.length&&(ib.ErrorId=ic.Errors[0].Id,ic=ic.Errors[0].Details,ib.ErrorDetails=this.Mmh(ic.toString())?"PiiScrubbed":ic)}ib=C.a.hc(ib);e.ULS.sendTraceTag(cc,0,15,ib);this.Ra.raiseEvent("TokenRefreshed",new ea(null,Ga))}Mmh(Ga){return W.a.contains(Ga,"makes the internet safe for businesses",!0)}RGe(Ga){const ib={},cc=this.$.ea;ib.Name="";ib.IsUserActive=cc.Re.Hr;ib.IsSessionActive=cc.Zb;ib.GotDeploymentOrTimedOutError=
cc.O4;ib.TimeInSecFromLastStatefulSuccessfulRequest=cc.j1;ib.TimeFromLastUserActivityInMs=cc.Re.Cfb;ib.calledFromSessionExpiredFlow=Ga;ib.RefreshTokenDurationInMS=this.VJd.zc;ib.numOfFailuresWhileUserIsActive=da.a.y6;ib.numOfFailuresWhileUserIsInActive=da.a.z6;ib.numOfFailuresWhileOffline=da.a.Yya;ib.RefreshAccessTokenCorrelationID=this.context.correlationID;ib.accessTokenTTL=c.AFrameworkApplication.zk;ib.ContainsChangesWorkbookOperations=this.$.userOperationManager.xta();ib.IsDocumentHidden=this.documentVisibilityObserver?
this.documentVisibilityObserver.ti.toString():"Unknown";ib.TimeFromFirstOpenInHr=Math.floor(U.b(O.a.Qa,Q.toUtc(cc.UJf))/3600);return ib}K7h(Ga,ib){this.BH=!1;this.EYj();this.Aig(new Date,c.AFrameworkApplication.zk);const cc=this.$.ea,ic=!ib&&cc.Re.Hr,xb=!this.$.isEditMode&&cc.Tbb;ib=this.RGe(ib);ib.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ib.shouldTriggerSilentReloadAfterExpiring=ic;ib.WopiTokenTaskItemPriority=c.AFrameworkApplication.C2d;ib.isDirtyViewSession=xb;ib=C.a.hc(ib);
e.ULS.sendTraceTag(39982556,0,15,ib);this.Ra.raiseEvent("TokenRefreshed",new ea(Ga,null));xb?cc.Re.Hr&&(e.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),cc.bdd()):cc.Re.Hr?ic&&(Ga=z.a(this.$).hd.activityState,Ga[da.a.Vfb]=!0,Ga[X.a.xY]=!0,Ga[sa.a.Zr]=this.$.isEditMode,t.a(this.$).Js(new r.a(v.a.Tna,2,null))):cc.Zb&&H.j(this.$.pa.ya,!0,!1,!1,null,null,null,null,
null)}EYj(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=L.a.HT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.JP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=L.a.HT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.uY,c.AFrameworkApplication.zk.toString()),this.$.ea.rqc()):e.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");
this.$.va.AccessToken=c.AFrameworkApplication.accessToken;this.$.va.AccessTokenValidTo=c.AFrameworkApplication.zk;void 0!==this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion=L.a.HT(this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.JP,c.AFrameworkApplication.accessToken),this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion=L.a.HT(this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion,
c.AFrameworkApplication.uY,c.AFrameworkApplication.zk.toString()));void 0!==this.$.va.EmbedConfiguratorUrl&&null!==this.$.va.EmbedConfiguratorUrl&&(this.$.va.EmbedConfiguratorUrl=L.a.HT(this.$.va.EmbedConfiguratorUrl,c.AFrameworkApplication.JP,c.AFrameworkApplication.accessToken),this.$.va.EmbedConfiguratorUrl=L.a.HT(this.$.va.EmbedConfiguratorUrl,c.AFrameworkApplication.uY,c.AFrameworkApplication.zk.toString()));this.context.$Ib=!0}}Object(u.a)(ya,"EwaAccessTokenExpirationRefreshManager",null,[520,
521,2]);var ha=a(187),La=a(157),Ia=a(83),ra=a(416);class pa{}pa.IZb="ActivityDuration";pa.error="Error";pa.u$c="Errors";pa.failed="Failed";pa.OFh="FirstActivity";pa.initialized="Initialized";pa.Hui="LastActivity";pa.cYf="RetryOverride";pa.Kjj="RequestGroups";pa.requests="Requests";pa.RXf="Responses";pa.ixc="SessionDuration";pa.status="Status";pa.success="Success";pa.successful="Successful";pa.tokens="Tokens";Object(u.a)(pa,"SessionExpirationStrings",null,[]);var ba=a(106);class fa{constructor(Ga){this.Zo=
{};this.NX={};this.szg={};this.vqf=15;this.Zbe=!1;this.bBg=new Date;this.kVb=new Date;this.he=Ga;this.uYb=new ba.a(2,2,6E4*this.vqf,Object(f.a)(this,this.Alg,"writeMeasures"),135,"SL",!1);this.he.Eg(this.uYb);this.Aei()}Alg(){e.ULS.sendTraceTag(41964821,217,50,e.ULS.hc({["Aggregate"]:this.NX,["Current"]:this.Zo}))}Aei(){this.NX[pa.Kjj]=0;this.NX[pa.requests]=0;this.NX[pa.RXf]=0;this.NX[pa.status]=pa.initialized;this.NX[pa.OFh]=new Date;this.NX[pa.ixc]=0;this.NX[pa.IZb]=0;this.NX[pa.ixc]=0;this.Zo[pa.ixc]=
0;this.NX[pa.IZb]=0;this.Zo[pa.IZb]=0}Omd(Ga,ib){var cc=Ga[ib];cc=cc?cc:0;cc++;Ga[ib]=cc;this.mRd(Ga)}mRd(Ga){const ib=new Date;Ga[pa.IZb]=+ib-+this.kVb;this.kVb=ib;Ga[pa.ixc]=+this.kVb-+this.bBg;Ga[pa.Hui]=this.kVb}T0(Ga,ib){this.Zo[Ga]=ib;this.mRd(this.Zo)}LQd(Ga,ib){this.Zo[Ga]=ib;this.mRd(this.Zo)}incrementCounter(Ga){this.Omd(this.Zo,Ga);this.Omd(this.NX,Ga);this.Omd(this.szg,Ga)}flush(){this.Zbe||(this.NX[pa.status]=this.Zo[pa.status],this.Alg(this.uYb),this.he.xna(this.uYb,6E4*this.vqf))}stop(){e.ULS.sendTraceTag(41964822,
217,100,"Stopping logger. Flushing one last time");this.flush();this.Zbe=!0;this.he.np(this.uYb)}}Object(u.a)(fa,"SessionLogger",null,[532]);var Ka=a(97),aa=a(641),ja=a(30),Va=a(373),bb=a(164),wa=a(937),ka=a(189),ta=a(165);class qa{constructor(Ga,ib,cc,ic=null,xb=!1,Vb=null,wb=!1,cb=!1){this.H9=0;this.w2=this.Xi=null;this.EYb=new ha.a;this.UG=new ha.a;this.yk=null;this.kXa=!1;this.anb=this.bnb=null;this.he=Ga;this.Wge=ib;this.Wge.execute(lb=>{lb.dm(bb.a.Uld,Object(f.a)(this,this.WQi,"onHostResponseReceived"))});
this.bH=cc;this.zle=new wa.a("WebServiceCall","TokenRefresh");this.kh=ic||new fa(Ga);this.XAg=xb;this.tT=Vb?Vb:aa.SessionStatusManager.instance;this.M8d=wb;this.GTb=cb}WQi(Ga){if(Ga.MessageId!==bb.a.Uld)ta.a(39408099,306,15,"Unexpected message.");else{var ib=new ha.a,cc=new ha.a;this.kh.incrementCounter(pa.RXf);var ic=Ga.Values[Va.a.o1f];if(!ic||0>=ic.length)ta.a(40122317,306,15,"Found no tokens in the dictionary"),ic=Ga.Values;ta.a(40122318,306,100,"The Tokens array contains {0} tokens",ic.length);
this.kh.T0("Correlation",Ga.CorrelationId);var xb="";for(let cb=0;cb<ic.length;cb++){this.kh.LQd(pa.tokens,ic.length);var Vb=ic[cb],wb=Vb;if(!wb||!wb.Name)continue;this.kh.incrementCounter(wb.Name);const lb=Vb;if(lb&&lb.Value)ta.a(39408128,306,100,"Received token with name: {0}",lb.Name),ib.add(lb),this.EYb.add(lb),this.GTb||this.kh.T0(pa.status,pa.success),this.M8d&&this.tT&&this.tT.Mkj();else if(Vb=this.X_h(Vb),ta.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
wb.Name,JSON.stringify(Vb),this.w2),cc.add(Vb),this.GTb||(this.UG.add(Vb),xb=JSON.stringify(Vb),this.kh.T0(pa.error,JSON.stringify(Vb)),this.kh.T0(pa.status,pa.failed)),this.M8d)for(const Y of Vb.Errors)wb=this.TRh(Y),this.tT&&this.tT.MIg(wb)}this.GTb?(0<cc.count?this.anb?this.anb(new ea(ib,cc)):ta.a(512267295,306,15,"Received errors but the promise has completed"):this.bnb?this.bnb(new ea(ib,cc)):ta.a(512267294,306,15,"Received valid tokens but the promise has completed"),ta.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
ib.count,cc.count,Ga.CorrelationId,this.w2)):(0<cc.count&&""!==xb?(ic=Object.assign(new ka.a,{extendedProperties:new Map}),ic.extendedProperties.set("Errors",xb),ic.extendedProperties.set("RetryCount",this.H9.toString()),ic.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),ic.extendedProperties.set("IsTokenExpiring",this.kXa.toString()),Ka.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ic)):Ka.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),ta.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ib.count,cc.count,Ga.CorrelationId,this.w2),0<cc.count&&!this.eBb(cc)?(Ga=this.bH.F5e(cc),Ga!==this.bH.cdb&&(this.kh.LQd(pa.cYf,Ga),this.he.xna(this.Xi,Ga))):(this.kh.flush(),this.Xi&&(ta.a(39408131,306,100,"Deleting task {0} from task manager",this.Xi.name),this.he.np(this.Xi)),this.yk&&!this.yk.task.isCompleted?this.yk.setResult(new ea(ib,cc)):ta.a(512267293,306,15,"Received results but the task has completed")))}}X_h(Ga){if(!Ga)return null;
const ib=Object.assign(new K,{Name:Ga.Name,Errors:[]});for(const cc of Ga.Errors)Ga=new S,Ga.Id=cc.Id,Ga.Details=ja.a.Yhd(cc.Details,500),ib.Errors.push(Ga);return ib}requestTokensOnce(){this.ZWf()}ZWf(){c.AFrameworkApplication.pya("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.H9>=this.bH.Ptf?(ta.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.w2),this.XGe(this.yk,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):
(Ka.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.z0f())}z0f(){const Ga={};Ga[Va.a.o1f]=this.bH.tokens;const ib=J.a.create().toString();ta.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.bH.tokens),this.H9+1,ib,this.w2);this.Wge.execute(cc=>{cc.Pj(bb.a.yte,Ga,ib)});this.H9++;this.kh.incrementCounter(pa.requests)}XGe(Ga,ib,cc){const ic=new ha.a;for(let xb=0;xb<this.bH.tokens.length;xb++){const Vb=Object.assign(new K,
{Name:this.bH.tokens[xb],Errors:[Object.assign(new S,{Id:ib,Details:cc})]});ic.add(Vb);this.UG.add(Vb)}this.he.np(this.Xi);this.kh.T0(pa.u$c,JSON.stringify(this.UG));this.kh.T0(pa.status,pa.failed);Ga&&!Ga.task.isCompleted&&Ga.setResult(new ea(new ha.a,this.UG))}Gaj(Ga,ib=null){c.AFrameworkApplication.pya("258ec738;j5j99381");c.AFrameworkApplication.pya("85gid169;g470d326");this.zle.start();this.kXa=Ga;this.w2=J.a.create().toString();ta.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",
this.w2,this.kXa);this.H9=0;this.UG.clear();this.EYb.clear();const cc=new La.a;this.yk=cc;ib&&ib.R(()=>{const ic=!!cc&&!cc.task.isCompleted;ta.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.w2,this.kXa,ic);ic&&this.XGe(cc,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.GTb?this.$Wf(this.bH.Ptf).then(ic=>{this.yk&&!this.yk.task.isCompleted&&this.yk.setResult(ic);this.anb=this.bnb=null;this.kh.T0(pa.u$c,JSON.stringify(this.UG));
this.kh.T0(pa.status,pa.success);this.kh.flush()}).catch(ic=>{this.yk&&!this.yk.task.isCompleted&&this.yk.setResult(Object(Ia.a)(514,ic));this.anb=this.bnb=null;this.kh.T0(pa.u$c,JSON.stringify(this.UG));this.kh.T0(pa.status,pa.failed);this.kh.flush()}):(this.Xi=new ba.a(this.bH.priority,2,this.bH.cdb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,bb.a.yte,!0),this.XAg&&this.ZWf(),this.he.Eg(this.Xi));return this.yk.task}$Wf(Ga){const ib=this,cc=new Promise((cb,lb)=>{ib.bnb=cb;ib.anb=
lb;Ka.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);ib.z0f()}),ic=this,xb=new Promise((cb,lb)=>{window.setTimeout(()=>{lb(ic.bHe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},ic.bH.cdb)});let Vb=Ga;const wb=this;return new Promise((cb,lb)=>{Vb--;Promise.race([cc,xb]).then(Y=>{Ka.Health.instance.recordKpiSuccess("WACTokenRefresh",null);cb(Y)}).catch(Y=>{var Oa=wb.bH.cdb;if(Object(ra.a)(514,Y)&&(Y=Object(Ia.a)(514,Y),0<Y.errors.count)){wb.Iyi(Y.errors);
wb.rr(Y.errors);if(wb.eBb(Y.errors)){lb(Y);return}const Wa=wb.bH.F5e(Y.errors);Wa!==wb.bH.cdb?(wb.kh.LQd(pa.cYf,Wa),Oa=Wa):wb.dsi(Y.errors)&&(Oa=0)}Vb?window.setTimeout(()=>{wb.$Wf(Vb).then(cb).catch(lb)},Oa):(Oa=wb.bHe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),wb.rr(Oa.errors),lb(Oa),ta.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",wb.w2))})})}rr(Ga){for(let ib of Ga)this.UG.add(ib)}dsi(Ga){if(!Ga.count)return!1;
Ga=Ga.na(Ga.count-1);return Ga.Errors.length?"TIMEOUT"==Ga.Errors[0].Id:!1}bHe(Ga,ib){const cc=new ha.a;for(let ic=0;ic<this.bH.tokens.length;ic++){const xb=this.rah(this.bH.tokens[ic],Ga,ib);cc.add(xb)}return new ea(new ha.a,cc)}rah(Ga,ib,cc){return Object.assign(new K,{Name:Ga,Errors:[Object.assign(new S,{Id:ib,Details:cc})]})}Iyi(Ga){if(Ga.count){Ga=Ga.na(Ga.count-1);Ga=JSON.stringify(Ga);var ib=Object.assign(new ka.a,{extendedProperties:new Map});ib.extendedProperties.set("Errors",Ga);ib.extendedProperties.set("RetryCount",
this.H9.toString());ib.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());ib.extendedProperties.set("IsTokenExpiring",this.kXa.toString());Ka.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ib);this.kh.T0(pa.error,Ga);this.kh.T0(pa.status,pa.failed)}}O5i(Ga){this.zle.stop();const ib=this.V8h(Ga.result.errors);e.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!ib,this.w2,this.kXa,this.H9,this.UG.count,0<Ga.result.errors.count?Ga.result.errors.na(0).Name:"",0<Ga.result.errors.count&&0<Ga.result.errors.na(0).Errors.length?Ga.result.errors.na(0).Errors[0].Id:"",0<Ga.result.errors.count&&0<Ga.result.errors.na(0).Errors.length?Ga.result.errors.na(0).Errors[0].Details:"");return ib?!1:this.N5i(Ga.result.tokens)}eBb(Ga){return this.bH.eBb(Ga)}N5i(Ga){for(let ib=0;ib<Ga.count;ib++){const cc=Ga.na(ib);if(cc.Name===Va.a.accessToken){const ic=(new Date).getTime();
cc.Expiry>c.AFrameworkApplication.zk?(e.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:cc.Expiry,["NowGetTime"]:ic,["BootTime"]:c.AFrameworkApplication.Cha},"PreviousAccessTokenTtl",c.AFrameworkApplication.zk),c.AFrameworkApplication.accessToken=cc.Value,c.AFrameworkApplication.zk=Math.floor(cc.Expiry),c.AFrameworkApplication.B2d=ic,c.AFrameworkApplication.ZYa=Math.floor(cc.Expiry)):e.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:cc.Expiry,["NowGetTime"]:ic,["BootTime"]:c.AFrameworkApplication.Cha},"PreviousAccessTokenTtl",c.AFrameworkApplication.zk)}}return!0}V8h(Ga){let ib=!1;for(let cc=0;cc<Ga.count;cc++){ib=!0;const ic=Ga.na(cc);e.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",ic.Name,JSON.stringify(ic.Errors),this.w2)}return ib}TRh(Ga){let ib=d.a.hxc;Ga=parseInt(Ga.Id);if(isNaN(Ga))ib=d.a.J1j;else{switch(Ga){case 401:ib=d.a.M1j;break;case 403:ib=d.a.H1j;
break;case 500:ib=d.a.I1j;break;case 503:ib=d.a.L1j}ib===d.a.hxc&&(ib=500<Ga?d.a.K1j:d.a.G1j)}return ib}}Object(u.a)(qa,"TokenRefreshManager",null,[515]);class rb{constructor(){this.cdb=c.AFrameworkApplication.P1j;this.Ptf=c.AFrameworkApplication.N1j;this.tokens=c.AFrameworkApplication.I4h();this.priority=c.AFrameworkApplication.C2d;this.hie=this.Iwj();this.CUc=c.AFrameworkApplication.H4h()}eBb(Ga){Ga=JSON.stringify(Ga);if(this.CUc&&0<this.CUc.length)for(const ib of this.CUc)if(0<ib.length&&0<=Ga.indexOf(ib))return!0;
return!1}F5e(Ga){try{if(Ga)for(let ib of Ga)if(ib.Errors)for(const cc of ib.Errors)if(cc.Id in this.hie)return Number.parseInvariant(this.hie[cc.Id].toString())}catch(ib){e.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",ib.toString())}return this.cdb}Iwj(){const Ga={};try{if(!c.AFrameworkApplication.Pdc()||0>=c.AFrameworkApplication.Pdc().length||""===c.AFrameworkApplication.Pdc()[0])return Ga;for(const ib of c.AFrameworkApplication.Pdc())0<ib.length&&
(Ga[ib]=c.AFrameworkApplication.O1j)}catch(ib){e.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",ib.toString())}return Ga}}Object(u.a)(rb,"TokenRefreshPolicy",null,[516]);class Za extends b.a{constructor(Ga){super();this.$=Ga;this.Fb()}create(){c.AFrameworkApplication.MN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.ob(this.wah()):
this.ob(this.$.da.za(38)||this.$.da.Ga(38,new x(this.$)))}wah(){var Ga=this.$.da.za(38);if(Ga)return Ga;Ga=new qa(c.AFrameworkApplication.Gi,c.AFrameworkApplication.jV(),new rb);return this.$.da.Ga(38,new ya(this.$,Ga))}static ka(Ga){Ga.da.Ga(39,new Za(Ga))}}Object(u.a)(Za,"AccessTokenExpirationManagerFactory",b.a,[]);var gb=a(9);a.d(E,"a",function(){return mb});const mb=()=>{gb.a.Fa(Za.ka)}},1199:function(u,E,a){u=a(0);var c=a(84),b=a(146);class e extends b.a{constructor(z){super(!1,!1,!0);this.CRb=
z}start(){const z={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.CRb.Zld}};this.initializeAndShow("",Object(c.a)(this,this.Llj,"resultHandler"),z)}Llj(z,x){1===z&&(this.CRb.Zld=x.tooltipPersistenceEnabled)}}Object(u.a)(e,"AccessibilitySettingsDialog",b.a,[]);var f=a(105),d=a(25);class h{constructor(z,x){this.La=z;this.CRb=x}Hg(){this.La.Nb(d.a.mDj,f.a.frame,Object(c.a)(this,this.nDj,"showAccessibilitySettingsDialogHandler"))}nDj(){(new e(this.CRb)).start();
return 32}}Object(u.a)(h,"AccessibilitySettingsDialogActor",null,[371]);var m=a(157),l=a(4);const w=z=>{const x=new m.a;l.AFrameworkApplication.Dd.Pm(n(z),1,null,null,!0,2,D=>{200===D.data.httpStatus?x.setResult("true"===D.data.ue.toLowerCase()):x.setResult(!1)},()=>{x.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return x.task},n=z=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",z,l.AFrameworkApplication.Ii);
var y=a(137);class t{constructor(){this.VWa=null}get Zld(){return!!this.VWa}set Zld(z){z!==this.VWa&&(this.VWa=z,y.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(z),this.Ckf()&&l.AFrameworkApplication.Dd.Pm(n("saveHoverableRibbonTooltipIsEnabled"),2,z.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}Ywi(){const z=new m.a;if(this.VWa)z.setResult(this.VWa);else if(this.Ckf()){const x=w("getHoverableRibbonTooltipIsEnabled");x.continueWith(()=>
{this.VWa=x.result;y.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(x.result);z.setResult(x.result)},8)}else z.setResult(!1)}Ckf(){const z=l.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),x=l.AFrameworkApplication.fa.qa("IsAnonymousUser");return z&&!x}}Object(u.a)(t,"AccessibilitySettingsInfo",null,[369]);var r=a(248),v=a(165);class B{constructor(){this.gb=null}get name(){return"Common.App.AccessibilitySettings"}Wh(z){this.gb=z;this.gb.register(t,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Fc(()=>
new t).xc();this.gb.register(h,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Fc(()=>new h(l.AFrameworkApplication.ub,this.gb.Kh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).xc()}init(){const z=this.gb.Kh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),x=this.gb.Kh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");z&&x?(x.Hg(),z.Ywi()):v.a(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){r.a.instance.Fi(new B)}}Object(u.a)(B,"AccessibilitySettingsPackage",null,[4,5]);a.d(E,"a",function(){return A});const A=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");B.main()}},1200:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(87),d=a(27),h=a(416),m=a(1126),l=a(521),w=a(186),n=a(225),y=a(24),t=a(64),r=a(42),v=a(162),
B=a(211),A=a(47),z=a(46),x=a(12),D=a(71),J=a(127),L=a(1),T=a(11),O=a(21),G=a(343),C=a(239),H=a(14),I=a(156),M=a(94),Q=a(5),U=a(249),N=a(76),W=a(44),X=a(34);class sa extends M.a{constructor(ja,Va,bb,wa){super(ja);this.xbg=[6];this.rbg=[26];this.ds=null;this.SAb=this.Mjc=!1;this.Cs=this.mba=null;this.w5=!1;this.onPointerDown=ka=>{if(1!==this.$.Ja.LH())return!0;ka=X.a(this.$).Vd(ka);if(this.wB)return!0;var ta=W.a(this.$).wqd||W.a(this.$).mq();if(this.qsd||ta)return this.Qcb(),!0;this.Cs=this.im;this.MKd();
this.Dld();ta=2===ka.tb&&ka.ho===Sys.UI.MouseButton.leftButton;const qa=3===ka.tb;if(ta||qa)ka=this.ha.io(ka.clientPoint,ka.Gb,5,void 0,void 0,!0),ka||(ka=this.Cs),this.SAb=ta,this.Mjc=qa,this.Cs=this.B7e(ka),this.Dld(),ta?this.Obj():qa&&this.Gcj(),U.b(this.$,!0);return!0};this.Gh=ka=>{ka=X.a(this.$).Vd(ka);if(!this.wB)return!1;let ta=this.SAb?this.ha.io(ka.clientPoint,ka.Gb,5,void 0,void 0,!0):this.ha.io(ka.clientPoint,ka.Gb,5,!0,!1,!0);this.w5&&!ta&&(ta=this.ha.$ob(ka.clientPoint,ka.Gb,5));ta&&
(ka=this.B7e(this.QZa(ta)),this.c2b(ka.bottomRight),this.Cs.equals(ka)||(this.Cs=ka,this.uJb(!1),this.MKd(!1),this.Dld(!1),this.S$h(),this.qb.update(!1)),this.GVj(this.Cs));return!0};this.Pf=ka=>{X.a(this.$).Vd(ka);if(!this.wB)return!1;this.resizeTable();this.Qcb();return!0};this.GGb=ka=>{X.a(this.$).Vd(ka);if(!this.wB)return e.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Qcb();return!0};this.f0=ka=>{X.a(this.$).Vd(ka);
this.Qcb();return!0};this.Wyf=()=>{this.wB&&this.Qcb()};this.gridView=Va;this.$=Va.$;this.tableManager=wa;this.ha=Va.ha;this.qb=Va.qb;this.parentElement=ja;this.bXg();d.a.Dp||d.a.v5||C.a.instance.ta(H.a.pointerDown,this.mba,this.onPointerDown);this.im=bb;this.iNc=this.qsd=!1;this.tableManager.uJg(this.Wyf);this.w5=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7030316_NewTableResizeExperience")}get wB(){return this.SAb||this.Mjc}get Clf(){return this.iNc}dispose(){this.Qcb();this.tableManager.Nej(this.Wyf);
this.Clf||d.a.Dp||d.a.v5||C.a.instance.Ba(H.a.pointerDown,this.mba,this.onPointerDown);if(this.wB){U.b(this.$,!1);try{this.Uv()}catch(ja){e.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ja}`)}}this.parentElement&&this.parentElement.contains(this.mba)&&this.parentElement.removeChild(this.mba);this.mba=this.parentElement=null;super.dispose()}B7e(ja){const Va=ja.bottom-this.im.topLeft.bottom-1;return 0<=ja.right-this.im.topLeft.right+
1&&0<=Va&&ja.bottom>=this.im.top&&ja.right>=this.im.left?new y.Range(this.im.top,this.im.left,ja.bottom,ja.right,!1,!1):this.Cs}Dld(ja=!0){this.Nxc([this.Cs],6,ja);this.qb.Sn(this.xbg)}uJb(ja=!0){this.qb.Xg(this.xbg);this.Nxc([null],6,ja)}MKd(ja=!0){this.qb.Xg(this.rbg);this.Nxc([null],26,ja)}S$h(){const ja=this.kMj();0<ja.length&&(this.Nxc(ja,26,!1),this.qb.Sn(this.rbg))}kMj(){const ja=[];this.im.contains(this.Cs)&&(this.im.right!==this.Cs.right&&ja.push(new y.Range(this.im.top,this.Cs.right+1,this.Cs.bottom,
this.im.right,!1,!1)),this.im.bottom!==this.Cs.bottom&&ja.push(new y.Range(this.Cs.bottom+1,this.im.left,this.im.bottom,this.im.right,!1,!1)));return ja}resizeTable(){if(!this.Cs.equals(this.im)){const ja=new y.Range(this.im.top,this.im.left,this.Cs.bottom,this.Cs.right,!1,!1);this.YQj(ja);this.qsd=!0}}onKeyDown(ja){X.a(this.$).Vd(ja);return!0}M$a(){this.Clf&&(d.a.Dp||d.a.v5||(C.a.instance.ta(H.a.pointerDown,this.mba,this.onPointerDown),this.mba.classList.remove("ewr-table-resize-default-cursor"),
this.iNc=this.mba.disabled=!1),this.iNc=!1)}bXg(){const ja=document.createElement("div");ja.className="ewr-table-resize-handle";const Va=document.createElement("div");Va.className="ewr-table-resize-fillhandle-higher";const bb=document.createElement("div");bb.className="ewr-table-resize-fillhandle-broader";ja.appendChild(Va);ja.appendChild(bb);this.mba=ja;this.parentElement.appendChild(this.mba)}c2b(ja){const Va=this.w5?2:5;let bb=60;const wa=this.Cs.contains(ja);let ka=ja.top,ta=ja.bottom,qa=ja.left,
rb=ja.right,Za=null;if(wa){if(this.gridView.IK(this.im.topLeft)&&!this.im.HBa)return;this.w5?ja.bottom<this.Cs.bottom?(ka=Math.max(1,ta-Va,this.im.top),bb=16):(qa=Math.max(1,rb-Va,this.im.left),bb=4):(ka=Math.max(1,ta-Va,this.im.top),qa=Math.max(1,rb-Va,this.im.left));ta=ka;rb=qa;Za=new y.Range(ka,qa,ka,qa,!1,!1)}else this.w5?ja.right>=this.im.right?(rb+=Va,bb=8):ja.bottom>=this.im.bottom&&(ta+=Va,bb=32):(ta+=Va,rb+=Va),ka=ta,qa=rb,Za=new y.Range(ta,rb,ta,rb,!1,!1),bb=16;this.gridView.IK(Za)||(this.ds?
this.ds.Ep||(this.ds=A.a.instance.create(()=>{this.gridView.Ht(Za,bb,"TableResizeBehavior.BringRangeIntoView")},40,z.a.vbg)):this.ds=A.a.instance.create(()=>{this.gridView.Ht(Za,bb,"TableResizeBehavior.BringRangeIntoView")},40,z.a.vbg))}QZa(ja){let Va=ja;if(this.gridView.ib.U4){if(!this.gridView.Sb(ja.topLeft)){const bb=this.gridView.kk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.IH,this.Cs.top!==ja.top?1:2);try{bb.Sk=this.Cs.top<ja.top||this.Cs.left<ja.left,bb.Gs(ja.topLeft),Va=bb.$$cu().range}finally{bb&&
bb.dispose()}}Va.right=Va.left+ja.width-1;Va.bottom=Va.top+ja.height-1}return Va}Nxc(ja,Va,bb=!0){const wa=[];for(const ka of ja)wa.push(new G.a(ka,t.d(this.$.oa)));this.qb.lx(wa,[Va],!0,void 0,bb)}Obj(){this.w5&&C.a.instance.ta(H.a.Jj,document.documentElement,this.Gh);for(const ja of this.gridView.Mn)C.a.instance.ta(H.a.Jj,ja.domElement,this.Gh);C.a.instance.ta(H.a.Qf,document.documentElement,this.Pf);this.ALe()}Gcj(){this.w5&&I.a.instance.ta(H.a.Zf,document.documentElement,this.Gh);for(const ja of this.gridView.Mn)I.a.instance.ta(H.a.Zf,
ja.domElement,this.Gh);I.a.instance.ta(H.a.xe,document.documentElement,this.GGb);this.ALe()}Uv(){this.SAb&&this.TTj();this.Mjc&&this.dUj()}TTj(){this.w5&&C.a.instance.Ba(H.a.Jj,document.documentElement,this.Gh);for(const ja of this.gridView.Mn)C.a.instance.Ba(H.a.Jj,ja.domElement,this.Gh);C.a.instance.Ba(H.a.Qf,document.documentElement,this.Pf);this.xRf()}dUj(){this.w5&&I.a.instance.Ba(H.a.Zf,document.documentElement,this.Gh);for(const ja of this.gridView.Mn)I.a.instance.Ba(H.a.Zf,ja.domElement,this.Gh);
I.a.instance.Ba(H.a.xe,document.documentElement,this.GGb);this.xRf()}ALe(){this.w5||C.a.instance.ta(H.a.Fy,document.documentElement,this.f0);this.gridView.fc.U8b(!0)}xRf(){this.w5||C.a.instance.Ba(H.a.Fy,document.documentElement,this.f0);this.gridView.fc.U8b(!1)}YQj(ja){this.$.Xc(-1400250766,N.a.Db,30,{["ResizeTableRange"]:ja,["OriginalTableRange"]:this.im})}GVj(ja){if(!this.im.contains(ja)){ja=this.jMj();for(const Va of ja)if(this.tableManager.Qsd(Va)){this.gridView.Hf.gm(Q.a.LHi);return}}this.gridView.rtl?
this.gridView.Hf.gm(Q.a.TGi):this.gridView.Hf.gm(Q.a.WIi)}Qcb(){if(this.wB){U.b(this.$,!1);try{this.Uv()}catch(ja){e.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ja}`)}}this.ds&&(this.ds.cancel(),this.ds.dispose());this.Mjc=this.SAb=!1;this.uJb();this.MKd();U.b(this.$,!1);this.gridView.Hf.gm(Q.a.QQ)}jMj(){const ja=[];this.im.right!==this.Cs.right&&ja.push(new y.Range(this.im.top,this.im.right+1,this.Cs.bottom,this.Cs.right,!1,!1));
this.im.bottom!==this.Cs.bottom&&ja.push(new y.Range(this.im.bottom+1,this.im.left,this.Cs.bottom,this.im.right,!1,!1));return ja}static createInstance(ja,Va,bb,wa){if(!Va)return null;const ka=ja.qb;ka.lx(bb,[27],!0);ka.Sn(sa.fMj);bb=ka.Bv(27,ja.ib.Ni(Va.bottomRight),sa.kRh(Va,bb)).xf;return new sa(bb,ja,Va,wa)}static kRh(ja,Va){var bb;for(let wa=0;wa<Va.length;wa++)if((null===(bb=Va[wa])||void 0===bb?0:bb.range)&&Va[wa].range.equals(ja))return wa;return 0}}sa.fMj=[27];Object(u.a)(sa,"TableResizeBehavior",
M.a,[]);var da=a(7);M=a(238);class S{}S.hxh="ewa-ttrd-buttonarea";Object(u.a)(S,"CssClassNames",null,[]);var oa=a(49),K=a(132),ea=a(91),ya=a(22),ha=a(13),La=a(254),Ia=a(133),ra=a(262);class pa extends M.a{constructor(ja){super(document.createElement("div"));this.dVc=this.Bpd=this.mKf=this.SQ=!1;this.ELb=null;this.Rh=()=>{B.c(this.$,this.gridView.ha.ra.activeCell)?(this.LMa=!0,this.lsb(!1)):(this.m_=this.LMa=!1,this.lgg())};this.Rt=()=>{this.LMa?this.lsb(!0):this.m_=!1};this.$yf=()=>{this.dVc=!0;this.LMa&&
(this.m_=!1)};this.onContentReady=()=>{this.$.isEditMode?B.c(this.$,this.gridView.ha.ra.activeCell)&&(this.LMa=!0,this.lsb(!1)):this.m_=!1};this.fza=()=>{this.dVc=!1;this.LMa?this.lsb(!1):this.m_=!1};this.tf=(Va,bb)=>{this.LMa&&(Va=this.gridView.Mqc(bb.ed.block.pe.BlockCachePosition.PaneType).KG(bb.ed.hash))&&(Va.YLd(this.maf),Va.dXc(this.maf))};this.maf=()=>{this.DVf()};this.$=ja;this.gridView=O.h(this.$);this.parentElement=this.domElement;this.parentElement.className=S.hxh;this.ELa=this.gridView.zj;
this.LMa=!0;this.iei();this.uRg();this.lsb(!1);e.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get m_(){return this.Bpd}set m_(ja){this.Bpd!==ja&&(this.Bpd=this.isVisible=ja)}get PBb(){return!!(this.$.qd&16)}get kni(){const ja=this.gridView.ha.ra.activeCell;return ja.right===ja.maxColumns}get Anb(){const ja=this.gridView.Sb(null);return ja&&this.gridView.H5(ja.range)?this.dwa(ja):(ja&&e.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),
null)}dispose(){this.$&&this.ujh();this.$=this.gridView=this.parentElement=this.ELa=null;super.dispose()}dPh(ja){const Va=this.N2h(this.gridView.Sb(null).range);return Va?`=SUBTOTAL(${ja},${Va})`:null}N2h(ja){var Va=O.h(this.$).Bb.Bj(ja);if(!Va)return null;Va=v.a(Va,!1);Va.right=Va.left=ja.left;return Va.toString()}iei(){pa.yM={};pa.yM["100"]=ha.a.instance.ga(1101);pa.yM["101"]=ha.a.instance.ga(1104);pa.yM["102"]=ha.a.instance.ga(1103);pa.yM["103"]=ha.a.instance.ga(1108);pa.yM["104"]=ha.a.instance.ga(1105);
pa.yM["105"]=ha.a.instance.ga(1106);pa.yM["109"]=ha.a.instance.ga(1102);pa.yM["107"]=ha.a.instance.ga(1109);pa.yM["110"]=ha.a.instance.ga(1111);pa.yM["111"]=ha.a.instance.ga(1162)}I_i(){var ja=this.gridView.Sb(null);if(ja&&(ja=ja.qB?ja.formulaBarText:null))if("=SUBTOTAL("===ja.substring(0,10)){if(ja=ja.substring(10,13),ja in pa.yM)return ja}else return"111";return"100"}uRg(){this.gridView.Ea.mt(this.tf);this.gridView.ha.gH(this.Rh);this.gridView.jv(this.onContentReady);this.gridView.fc.Yk(this.$yf);
this.gridView.fc.Rm(this.fza)}ujh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.mL(this.Rh),this.gridView.Ea.er(this.tf)),this.gridView.Ky(this.onContentReady),this.gridView.fc&&(this.gridView.fc.Hk(this.$yf),this.gridView.fc.em(this.fza)),this.lgg())}lsb(ja){this.RVj(ja);this.PBb&&(this.MKj(),this.Anb?(this.mKf||this.ERg(),this.dVc?this.m_=!1:(this.m_=!0,this.DVf())):(e.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.m_=!1))}DVf(){appChrome.renderTableTotalRowOptions(this.parentElement,pa.yM,pa.yM[this.I_i()].toString(),Math.round(X.a(this.$).zi(17)),ja=>{e.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${ja}`);let Va={["SelectedOption"]:pa.yM[ja],["FunctionKeyCode"]:ja,["Location"]:"canvas"};Ia.b(this.$).ud(K.a.oMj,Va,null,!0);if("111"===ja)return this.Dhi(),!0;if("100"!==ja){this.ELb=this.dPh(ja);if(!this.ELb)return e.ULS.sendTraceTag(537151197,0,50,
"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.ySa(this.ELb)}else this.ySa("");x.DOMElementExtensions.setFocus(this.gridView.Vb.textBox.domElement);return!0})}Dhi(){e.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const ja=new ea.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ja.Kb(ja)}dwa(ja){if(!ja)return null;var Va=this.gridView.fc.textBox.domElement;var bb=0<x.DOMElementExtensions.getHeight(Va)&&
0<x.DOMElementExtensions.getWidth(Va)&&0<=Va.offsetTop&&0<=Va.offsetLeft;if(bb)Va=x.DOMElementExtensions.dwa(Va,this.gridView.zj);else{Va=this.gridView.getCellBounds(ja.cell);var wa=x.DOMElementExtensions.getBoundingClientRect(this.gridView.zj);Va=new Sys.UI.Bounds(Va.x-wa.x,Va.y-wa.y,Va.width,Va.height)}if(Va)if(bb)2<Va.height&&2<Va.height&&(Va.x+=1,Va.y+=1,Va.height-=2,Va.width-=2);else if(bb=O.h(this.$).oK(ja.cell))bb=bb.width,wa=ya.a.equals(La.a.zwb(ja.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&
wa&&(Va.x=Va.x+Va.width-bb),ja.sla&&this.gridView.rtl===wa&&(Va.width=bb);else return null;return Va}RVj(ja){var Va=this.Anb;if(Va){var bb=17>=Va.height?Va.y:Va.y+Va.height-17-2;Va=this.kni?this.gridView.rtl?Va.x:Va.x+Va.width-(17<Va.height?17:Va.height):this.gridView.rtl?Va.x-(17<Va.height?17:Va.height):Va.x+Va.width;var wa=X.a(this.$).cka(new Sys.UI.Point(Va,bb));this.parentElement.style.top=T.HelperMethods.uc(wa.y);this.parentElement.style.left=T.HelperMethods.uc(wa.x);X.a(this.$).$vj(this.parentElement);
ja&&(this.m_=this.gridView.Ujc(new oa.a(Va,bb)))}else this.m_=!1}ERg(){this.ELa.insertBefore(this.parentElement,this.ELa.firstChild);this.mKf=!0}MKj(){this.SQ||(this.gridView.view.nt(this.Rt),this.SQ=!0)}lgg(){this.SQ&&this.gridView.view&&(this.gridView.view.gr(this.Rt),this.SQ=!1)}ySa(ja){const Va=this.gridView.Vb,bb=this.gridView.Sb(null);bb&&(ja=Object(da.a)(new ra.a,{Text:ja}),this.gridView.setCell(ja,bb.range,0,127,null),Va.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}pa.nMj="TableTotalRowDropDownIconButtonId";
pa.yM=null;Object(u.a)(pa,"TableTotalRowOptions",M.a,[2]);class ba extends m.a{constructor(ja){super(O.h(ja));this.Fqb=this.g1=this.aBc=this.Dqb=null;this.qte=!1;this.uce=null;this.YSb=0;this.D6b=null;this.t1b=()=>{const Va={},bb=this.Jhd();for(let ka in bb){const ta=bb[ka];if(!ta)continue;const qa=this.S1h(ta);if(qa){if(qa in this.oGa){var wa=this.oGa[qa];if(wa.wB){wa.im.equals(ta)||(wa.im=ta);delete this.oGa[qa];Va[qa]=wa;continue}}(wa=sa.createInstance(O.h(this.$),ta,this.aMh(),this))?Va[qa]=wa:
e.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${ta.Ew(!1)}`)}}this.D3b(null,null);this.GRb=Va};this.D3b=()=>{const Va=this.oGa;for(let ka in Va){var bb=ka,wa=Va[ka];wa&&(wa.dispose(),delete this.oGa[bb])}this.GRb={}};this.KPf=()=>{this.D3b(null,null);this.t1b(null,null)};this.onFocus=()=>{this.uce=O.h(this.$).ha.ra.activeCell};this.yR=()=>{this.$.isEditMode&&this.Rh(null,null)};this.Rh=()=>{!this.qte&&B.c(this.$,this.gridView.ha.ra.activeCell)&&
this.hxi()};this.ZV=()=>{this.vzb(1);this.$.ea.jo(this.ZV)};this.OHb=()=>{this.qte=!0;this.aBc=new pa(this.$)};this.$=ja;this.gridView=O.h(this.$);this.$.da.Ga(66,this);this.GRb={};this.t1b(null,null);this.$.xa&&this.$.xa.Vf(this.KPf);this.jre(this.t1b);this.$.ea.DY(this.yR);this.gridView.ha.gH(this.Rh);this.$.isEditMode&&this.Rh(null,null)}jre(ja){this.addHandler(m.a.IId,ja)}SUf(ja){this.removeHandler(m.a.IId,ja)}uJg(ja){this.addHandler("tce",ja)}Nej(ja){this.removeHandler("tce",ja)}get oGa(){return this.GRb}get iud(){return this.uce}get YIa(){return this.YSb}get Kg(){const ja=
O.h(this.$);return ja.Bb.Bj(ja.ha.ra.activeCell,!1)}get nHd(){return this.iud?O.h(this.$).Bb.Bj(this.iud,!1):null}Qsd(ja){return!!this.E4e(ja)}Cn(ja){return this.wZh(this.m5e(ja))}hwb(ja){return this.m5e(ja)}Dcj(ja){ja?(this.Fqb?this.Fqb!==ja&&(f.a.Ia(this.g1),this.g1=null,this.Fqb=ja):this.Fqb=ja,this.g1||(this.g1=J.a.instance.Zd(this.Fqb)),this.g1.Pi("focusin")||this.g1.ka("focusin",this.onFocus)):e.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}Thf(ja,
Va){return ja?ja.pba&&ja.top===Va.top:(e.ULS.shipAssertTag(537151244,0,!!ja,"autofilterRange can't be null"),!1)}aka(ja){ja=this.Dqb?r.I(ja,this.Dqb):this.view.getRangeInformation(ja);return 0<ja.length&&Object(h.a)(n.PivotTableRange,ja[0])?ja[0]:null}Pji(ja,Va){return ja?!ja.Chc&&!!ja.cF&&ja.cF.Bd(Va):(e.ULS.shipAssertTag(537151243,0,!!ja,"Pivot table can't be null"),!1)}$pi(ja,Va){return ja?!ja.Chc&&!!ja.vL&&ja.vL.Bd(Va):(e.ULS.shipAssertTag(537151242,0,!!ja,"Pivot table can't be null"),!1)}l_b(ja){super.l_b(ja);
if((ja=T.HelperMethods.P4e(ja))&&0<ja.length){this.Dqb=Array(ja.length);for(let Va=0;Va<ja.length;Va++)this.Dqb[Va]=w.a.IQ(ja[Va])}}nJb(){super.nJb();this.Dqb=null}$8g(ja,Va){return this.bGe(ja,Va).returnValue}bGe(ja,Va){var bb=!1;if(!ja||!Va)return{returnValue:!1,NY:bb};ja=ja.clone();ja.right+=1;ja.left=ja.right;return!ja.Jz||ja.top<Va.ib.aj&&(bb=ja.clone(),bb.bottom>=Va.ib.aj&&(bb.bottom=Va.ib.aj-1),!({NY:bb}=this.aGe(bb,Va)).returnValue)||ja.bottom>=Va.ib.aj&&(bb=ja.clone(),bb.top<=Va.ib.aj&&(bb.top=
Va.ib.aj),!({NY:bb}=this.aGe(bb,Va)).returnValue)?{returnValue:!1,NY:bb}:{returnValue:!0,NY:bb}}wbg(ja){(ja=this.Cn(ja.topLeft))&&ja.toString()in this.oGa&&(this.oGa[ja.toString()].qsd=!1)}t7i(){this.raiseEvent("tce")}Yh(ja,Va){if(!this.aBc)return!1;switch(Va){case -569786022:case 541421805:if(this.aBc.m_){const bb=document.getElementById(pa.nMj);bb&&A.a.instance.create(()=>{x.DOMElementExtensions.zgc(bb,null)},0,z.a.gMj,!0,!0)}return!0;default:return!1}}dispose(){this.D3b(null,null);this.SUf(this.t1b);
this.$.xa.Dg(this.KPf);this.$.Il(this.D3b);this.GRb=null;this.$.ea&&this.$.ea.w0(this.yR);this.gridView.ha.mL(this.Rh);this.aBc=null;L.EwaSettings.ma(403)&&this.g1&&(f.a.Ia(this.g1),this.g1=null);super.dispose()}o8h(ja,Va,bb,wa){const ka=this.gridView.Bb.Bj(new y.Range(Va,bb,Va,bb,!1,!1));if(this.D6b=ka){var ta=ka.usedRange,qa=ja.ctrlKey||d.a.isMac&&D.b(ja),rb=!ja.shiftKey&&qa;ja=ja.shiftKey&&!qa;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(O.h(this.$).ha.selectionType=
3);switch(wa){case 0:this.YSb=0;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Va=this.a6c(ja,ta.top,bb,ta.bottom,bb),this.QRd(Va,rb,ja)):this.RRd(ta.top,bb,ta.bottom,bb,v.d(ka),v.g(ka),rb);break;case 1:this.YSb=1;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Va=this.a6c(ja,Va,ta.left,Va,ta.right),this.QRd(Va,rb,ja)):this.RRd(Va,ta.left,Va,ta.right,!1,!1,rb);break;case 2:this.YSb=2;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(Va=this.a6c(ja,ta.top,ta.left,ta.bottom,ta.right),this.QRd(Va,rb,ja)):this.RRd(ta.top,ta.left,ta.bottom,ta.right,v.d(ka),v.g(ka),rb);break;default:e.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${wa.toString()}`);return}L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(O.h(this.$).ha.selectionType=3);e.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else e.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}DAj(ja){const Va=this.D6b.usedRange;return this.Zjf(ja)||1!==this.YIa&&this.Zjf(new y.Range(Va.top,ja.left,Va.bottom,ja.right,!1,!1))?!0:!1}HId(ja){return ja.Autofilters}aGe(ja,Va){let bb;bb=!1;const wa=Va.ib.Ni(ja),ka=Va.Bf(wa).vi;if(!ka)return e.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${wa}`),{returnValue:!1,NY:bb};if(!ka.Ke(ja))return{returnValue:!0,
NY:bb};ja=Va.kk("TableManager.CouldExpandImpl",ja,2);try{for(;ja.$$mn();){if(ja.$$cu().text||ja.Zn.O$e)return bb=!0,{returnValue:!1,NY:bb};if(ja.$$cu().aI)return{returnValue:!1,NY:bb}}}finally{ja&&ja.dispose()}return{returnValue:!0,NY:bb}}wZh(ja){if(!ja)return null;const Va=new l.AutofilterRange(ja.top,ja.left,ja.bottom,ja.right,null,null,null,ja.id,ja.pba);Va.HBa=ja.HBa;const bb=this.gridView.Bb.Bj(ja,!0);if(!bb)return null;for(let wa=0,ka=this.rangeList.length;wa<ka;wa++){const ta=this.rangeList[wa],
qa=this.gridView.Bb.Bj(ta,!0);qa&&qa.name===bb.name&&ta!==ja&&this.epi(ta)&&(Va.union(ta),ta.HBa&&(Va.HBa=!0))}return Va}epi(ja){return!!O.h(this.$).Bb.Bj(ja)}aMh(){const ja=[];for(const Va of this.rangeList){const bb=new G.a(this.Cn(Va.topLeft),t.d(this.$.oa));ja.push(bb)}return ja}Jhd(){const ja={};for(const Va of this.rangeList){if(!Va)continue;const bb=this.Cn(Va.topLeft);bb&&(ja[bb.toString()]=this.Cn(Va.topLeft))}return ja}hxi(){this.$.ea.sg?this.vzb(0):this.$.ea.Ak(this.ZV)}vzb(ja){this.$.ky(Va=>
{Va.Taa(ja).then(this.OHb)})}S1h(ja){const Va=this.gridView.Bb.Bj(ja);return Va?Va.name:ja.toString()}RRd(ja,Va,bb,wa,ka,ta,qa){const rb=ja+(ka?1:0),Za=bb-(ta?1:0),gb=this.gridView.inRangePicker||this.gridView.si;let mb=!1;const Ga=new y.Range(rb,Va,Za,wa,!1,!1);if(ka||ta){ka=gb?G.a.Fsb(this.gridView.ha.rangePicker.gL):this.gridView.ha.ra.selectedRanges;for(const ib of ka){mb=this.Krb(ib,rb,Va,Za,wa);ka=this.Krb(ib,ja,Va,bb,wa);if(gb&&mb)break;if(!gb&&(mb||ka)){this.gridView.ha.updateSelection(ib,
ib.topLeft,0,1);if(qa&&ka)return;break}}}mb&&(Ga.top=ja,Ga.bottom=bb);ja=Ga.topLeft;qa?this.gridView.ha.updateSelection(Ga,ja,0,1):gb?this.gridView.ha.mx([Ga],0,ja,0):this.gridView.ha.updateSelection(Ga,ja,0,3)}QRd(ja,Va,bb){ja&&(bb=bb?O.h(this.$).ha.ra.activeCell:ja.topLeft,Va?this.gridView.ha.updateSelection(ja,bb,0,1):this.gridView.ha.mx([ja],0,bb,0))}a6c(ja,Va,bb,wa,ka){const ta=v.d(this.D6b),qa=v.g(this.D6b),rb=Va+(1!==this.YIa&&ta?1:0),Za=wa-(1!==this.YIa&&qa?1:0),gb=this.gridView.inRangePicker||
this.gridView.si;if(ja){var mb=L.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&gb&&!G.a.Fsb(this.gridView.ha.rangePicker.gL).length?new y.Range(rb,bb,Za,ka,!1,!1):gb?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.ra.activeCell;mb=new y.Range(mb.top<rb?mb.top:rb,mb.left<bb?mb.left:bb,mb.bottom>Za?mb.bottom:Za,mb.right>ka?mb.right:ka,!1,!1)}else mb=new y.Range(rb,bb,Za,ka,!1,!1);if(1!==this.YIa&&(ta||qa)&&(!ja||ja&&this.Krb(mb,rb,bb,Za,ka))){ja=gb?G.a.Fsb(this.gridView.ha.rangePicker.gL):
this.gridView.ha.ra.selectedRanges;for(const Ga of ja)if(this.Krb(Ga,rb,bb,Za,ka)){mb.top=Va;mb.bottom=wa;break}}return mb}Zjf(ja){const Va=this.gridView.inRangePicker||this.gridView.si?G.a.Fsb(this.gridView.ha.rangePicker.gL):this.gridView.ha.ra.selectedRanges;for(const bb of Va)if(this.Krb(bb,ja.top,ja.left,ja.bottom,ja.right))return!0;return!1}Krb(ja,Va,bb,wa,ka){return!!ja&&ja.top===Va&&ja.bottom===wa&&ja.left===bb&&ja.right===ka}}Object(u.a)(ba,"TableManager",m.a,[534,2]);class fa extends b.a{constructor(ja){super();
this.tableManager=null;this.$=ja;this.Fb()}create(){this.ob(this.tableManager||(this.tableManager=new ba(this.$)))}}Object(u.a)(fa,"TableManagerFactory",b.a,[]);var Ka=a(1218);a.d(E,"a",function(){return aa});const aa=()=>{c.a.Fa(ja=>{ja.da.Ga(134,new fa(ja));ja.da.Ga(330,new Ka.a(ja))})}},1218:function(u,E,a){u=a(0);var c=a(222),b=a(50),e=a(37),f=a(7),d=a(15),h=a(111),m=a(816),l=a(1463),w=a(723),n=a(1393),y=a(38),t=a(5),r=a(161),v=a(76),B=a(60),A=a(162),z=a(47),x=a(46),D=a(110);a(28);var J=a(193),
L=a(29),T=a(282),O=a(1),G=a(22),C=a(13);a(30);class H{}Object(u.a)(H,"TableStyleElement",null,[]);var I=a(749),M=a(208),Q=a(88),U=a(526);class N{static Brf(oa,K){return N.zbg[oa.Type]-N.zbg[K.Type]}static T4a(oa,K){try{return appChrome.buildTableStyleGalleryIconNew(N.TBa,N.Goa,oa,K)}catch(ea){return null}}static Elf(oa){return oa&&v.a.Jc in oa&&(oa=oa[v.a.Jc])?G.a.wG(oa,t.a.aIb):!1}static Cta(oa){const K=[];let ea=0;for(const ya of oa){K[ea]={};K[ea].backgroundColor="white";K[ea].color="black";for(let ha in ya)switch(oa=
ya[ha],ha){case "background-color":K[ea].backgroundColor=oa;break;case "color":K[ea].color=oa;break;case "font-size":K[ea].fontSize=oa;break;case "border-bottom":K[ea].borderBottom=oa;break;case "border-right":K[ea].borderRight=oa;break;case "border-left":K[ea].borderLeft=oa;break;case "border-top":K[ea].borderTop=oa}ea++}return K}static g5b(oa,K){const ea=[];if(null===oa||void 0===oa?0:oa.TableStyleElementsList){var ya=0===oa.Category;for(let ha=0;ha<N.Goa;ha++)ea.push(...N.aQh(oa,K,ya,ha))}else{if(N.w7c)return N.w7c;
oa={color:"black","background-color":"white"};for(K=0;K<N.Goa;K++)for(ya=0;ya<N.TBa;ya++)ea.push(oa);N.w7c=ea}return ea}static T1h(oa,K){if(!oa.TableStyleElementsList)return"";let ea="";for(const ya of oa.TableStyleElementsList)if(ya.BackgroundColor&&"#000000"!==ya.BackgroundColor)switch(ya.Type){case 0:ea=ya.BackgroundColor;break;case 5:case 7:if(K.dia||K.eS)ea=ya.BackgroundColor;break;case 3:case 4:if(K.firstCol||K.lastCol)ea=ya.BackgroundColor;break;case 2:K.totalRow&&(ea=ya.BackgroundColor);break;
case 1:K.headerRow&&(ea=ya.BackgroundColor)}return ea}static h4b(oa){oa=new M.a(parseInt(String("0x"+oa.substr(1,2)),16),parseInt(String("0x"+oa.substr(3,2)),16),parseInt(String("0x"+oa.substr(5,2)),16));return I.a.iLa(oa)}static X6e(oa,K){if(!oa||!K)return"";K=(K=N.T1h(oa,K))?N.h4b(K)+", ":C.a.instance.ga(2064)+", ";switch(oa.Index){case 0:return K+C.a.instance.ga(1998);case 1:return K+C.a.instance.ga(1999);case 2:return K+C.a.instance.ga(2E3);case 3:return K+C.a.instance.ga(2001);case 4:return K+
C.a.instance.ga(2002);case 5:return K+C.a.instance.ga(2003);case 6:return K+C.a.instance.ga(2004);case 7:return K+C.a.instance.ga(2005);case 8:return K+C.a.instance.ga(2006);case 9:return K+C.a.instance.ga(2007);case 10:return K+C.a.instance.ga(2008);case 11:return K+C.a.instance.ga(2009);case 12:return K+C.a.instance.ga(2010);case 13:return K+C.a.instance.ga(2011);case 14:return K+C.a.instance.ga(2012);case 15:return K+C.a.instance.ga(2013);case 16:return K+C.a.instance.ga(2014);case 17:return K+
C.a.instance.ga(2015);case 18:return K+C.a.instance.ga(2016);case 19:return K+C.a.instance.ga(2017);case 20:return K+C.a.instance.ga(2018);case 21:return K+C.a.instance.ga(2019);case 22:return K+C.a.instance.ga(2020);case 23:return K+C.a.instance.ga(2021);case 24:return K+C.a.instance.ga(2022);case 25:return K+C.a.instance.ga(2023);case 26:return K+C.a.instance.ga(2024);case 27:return K+C.a.instance.ga(2025);case 28:return K+C.a.instance.ga(2026);case 29:return K+C.a.instance.ga(2027);case 30:return K+
C.a.instance.ga(2028);case 31:return K+C.a.instance.ga(2029);case 32:return K+C.a.instance.ga(2030);case 33:return K+C.a.instance.ga(2031);case 34:return K+C.a.instance.ga(2032);case 35:return K+C.a.instance.ga(2033);case 36:return K+C.a.instance.ga(2034);case 37:return K+C.a.instance.ga(2035);case 38:return K+C.a.instance.ga(2036);case 39:return K+C.a.instance.ga(2037);case 40:return K+C.a.instance.ga(2038);case 41:return K+C.a.instance.ga(2039);case 42:return K+C.a.instance.ga(2040);case 43:return K+
C.a.instance.ga(2041);case 44:return K+C.a.instance.ga(2042);case 45:return K+C.a.instance.ga(2043);case 46:return K+C.a.instance.ga(2044);case 47:return K+C.a.instance.ga(2045);case 48:return K+C.a.instance.ga(2046);case 49:return K+C.a.instance.ga(2047);case 50:return K+C.a.instance.ga(2048);case 51:return K+C.a.instance.ga(2049);case 52:return K+C.a.instance.ga(2050);case 53:return K+C.a.instance.ga(2051);case 54:return K+C.a.instance.ga(2052);case 55:return K+C.a.instance.ga(2053);case 56:return K+
C.a.instance.ga(2054);case 57:return K+C.a.instance.ga(2055);case 58:return K+C.a.instance.ga(2056);case 59:return K+C.a.instance.ga(2057);default:return oa.Name?oa.Name:""}}static bXh(oa){return(oa+1)%N.Nai}static Hxb(oa,K,ea=""){return oa||!ea?`${N.icf}, ${oa.Index.toString()}, -version, ${K.toString()}`:`${N.icf}, ${ea}, -version, ${K.toString()}`}static aQh(oa,K,ea,ya){const ha=[];for(let La=0;La<N.TBa;La++)ha.push(N.ifd(oa,K,ea,ya,La));return ha}static ifd(oa,K,ea,ya,ha){oa=oa.TableStyleElementsList;
let La=new H;const Ia={};if(!oa)return Ia;for(var ra of oa)if(0===ra.Type){La=ra;break}ra=!!La.BackgroundColor;let pa="";!ea&&La.TableStyleBorderFromatList&&0<La.TableStyleBorderFromatList.length&&(pa=La.TableStyleBorderFromatList[0].Color);Ia["background-color"]=ra?La.BackgroundColor:"#FFFFFF";La.FontColor||(La.FontColor="#000000");Ia.color=La.FontColor;N.fBe(ya,ha,Ia,La,pa,ea,ra);for(const ba of oa)ba&&0!==ba.Type&&(2!==ba.Type||ra||(ba.BackgroundColor=La.BackgroundColor),N.Hsd(ba,ya,ha,K)&&(ba.BackgroundColor&&
(Ia["background-color"]=ba.BackgroundColor),Ia.color=ba.FontColor||La.FontColor,N.fBe(ya,ha,Ia,ba,pa,ea,ra)));return Ia}static fV(oa,K,ea,ya,ha,La){ea&&(ea.Color&&!ea.Style&&(ea.Style=1),ea.Style&&!ea.Color&&(ea.Color=ha?"#000000":ya?ya:La?"#FFFFFF":"#000000"),K[N.borders[oa]]="1px "+N.QV[ea.Style]+" "+ea.Color)}static Hsd(oa,K,ea,ya){return-1===oa.Type?!1:N.Jsd(oa,K,ea,ya)||N.ori(oa,K,ea,ya)||N.Ksd(oa,K,ea,ya)}static ori(oa,K,ea,ya){return!K&&ya.headerRow||K===N.Goa-1&&ya.totalRow?!1:1===K%2&&5===
oa.Type&&ya.eS&&ya.headerRow||1<K&&!!((K-1)%(oa.BandSize+1))&&6===oa.Type&&ya.eS&&ya.headerRow||!(K%2)&&5===oa.Type&&ya.eS&&!ya.headerRow||!!(K%(oa.BandSize+1))&&6===oa.Type&&ya.eS&&!ya.headerRow||!(ea%2)&&7===oa.Type&&ya.dia||!!(ea%(oa.BandSize+1))&&8===oa.Type&&ya.dia}static Ksd(oa,K,ea,ya){return K===N.Goa-1&&2===oa.Type&&ya.totalRow||ea===N.TBa-1&&K===N.Goa-1&&12===oa.Type&&ya.totalRow&&ya.lastCol||!ea&&K===N.Goa-1&&11===oa.Type&&ya.totalRow&&ya.firstCol||ea===N.TBa-1&&4===oa.Type&&ya.lastCol}static Jsd(oa,
K,ea,ya){return!K&&1===oa.Type&&ya.headerRow||!ea&&3===oa.Type&&ya.firstCol||!ea&&!K&&9===oa.Type&&ya.headerRow&&ya.firstCol||ea===N.TBa-1&&!K&&10===oa.Type&&ya.headerRow&&ya.lastCol}static fBe(oa,K,ea,ya,ha,La,Ia){if(ya.TableStyleBorderFromatList)for(const ra of ya.TableStyleBorderFromatList)if(ra.Style)switch(ra.Position){case 0:oa&&12!==ya.Type&&11!==ya.Type&&2!==ya.Type&&5!==ya.Type&&6!==ya.Type||N.fV(0,ea,ra,ha,La,Ia);break;case 1:oa!==N.Goa-1&&1!==ya.Type&&10!==ya.Type&&9!==ya.Type&&5!==ya.Type&&
6!==ya.Type||N.fV(1,ea,ra,ha,La,Ia);break;case 2:K&&12!==ya.Type&&10!==ya.Type&&7!==ya.Type&&8!==ya.Type&&4!==ya.Type||N.fV(2,ea,ra,ha,La,Ia);break;case 3:K!==N.TBa-1&&9!==ya.Type&&11!==ya.Type&&3!==ya.Type&&7!==ya.Type&&8!==ya.Type||N.fV(3,ea,ra,ha,La,Ia);break;case 5:K!==N.TBa-1&&3!==ya.Type&&4!==ya.Type&&7!==ya.Type&&8!==ya.Type&&N.fV(3,ea,ra,ha,La,Ia);break;case 6:oa!==N.Goa-1&&2!==ya.Type&&1!==ya.Type&&5!==ya.Type&&6!==ya.Type&&N.fV(1,ea,ra,ha,La,Ia)}}static W1h(){const oa=Array(12);oa[0]=0;
oa[7]=1;oa[8]=2;oa[5]=3;oa[6]=4;oa[4]=5;oa[3]=6;oa[1]=7;oa[2]=8;oa[9]=9;oa[10]=10;oa[11]=11;oa[12]=13;return oa}}N.Goa=5;N.TBa=5;N.Nai=5;N.icf="TableStyleIcon";N.QV=[null,Q.a.solid,Q.a.dashed,Q.a.dotted,Q.a.dashed,Q.a.dotted,Q.a.dashed,Q.a.double];N.borders=[U.a.borderTop,U.a.borderBottom,U.a.borderLeft,U.a.borderRight];N.zbg=N.W1h();N.w7c=null;Object(u.a)(N,"TableStyleHelper",null,[]);class W{constructor(oa,K,ea,ya,ha,La){this.headerRow=oa;this.totalRow=K;this.firstCol=ea;this.lastCol=ya;this.eS=
ha;this.dia=La}equals(oa){return oa?this.headerRow===oa.headerRow&&this.totalRow===oa.totalRow&&this.firstCol===oa.firstCol&&this.lastCol===oa.lastCol&&this.dia===oa.dia&&this.eS===oa.eS:!1}}Object(u.a)(W,"TableStyleOptions",null,[]);var X=a(790);class sa extends y.a{constructor(oa,K,ea){super();this.F4i={["height"]:"100%"};this.dJb={};this.NIa=this.Lid=0;this.lastSyncTime=new Date;this.$da=-1;this.nO=null;this.$ma={};this.IL=null;this.$I={};this.eUa={};this.stc=null;this.HBb=this.p7a=this.isInitialized=
this.Sjf=!1;this.rwc=null;this.BAc=this.iOb=this.pYe=!1;this.yQi=(ya,ha,La)=>{let Ia=!1;if(T.a(ya))-315732528!==ya.Errors[0].MessageId&&(d.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${L.a.sc(ya.Errors)}`),this.jCf(null,ha,La));else if(d.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(ya=ya.Result)&&ya.TableStyleItems.length){La=60<ya.TableStyleItems.length;var ra=!1,
pa=!1;if(this.IL)for(var ba=0;60>ba;++ba){const fa=ya.TableStyleItems[ba],Ka=this.IL.TableStyleItems[ba];if(fa.HasStyleViolations!==Ka.HasStyleViolations){Ia=pa=!0;break}for(let aa=0;9>aa&&!(aa>=fa.TableStyleElementsList.length);aa++)if(!G.a.equals(fa.TableStyleElementsList[aa].BackgroundColor,Ka.TableStyleElementsList[aa].BackgroundColor,!1)){Ia=ra=!0;break}}else{this.NIa=0;for(ba of ya.TableStyleItems)ba.TableStyleElementsList&&ba.TableStyleElementsList.sort(N.Brf),this.$I[ba.Name]=ba}if(ra||pa)for(ra=
0;60>ra;++ra)pa=ya.TableStyleItems[ra],this.$I[pa.Name]=pa;if(La&&this.IL)for(d.ULS.sendTraceTag(42821700,0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${ya.TableStyleItems.length-60}`),Ia=!0,La=60;La<ya.TableStyleItems.length;++La)ra=ya.TableStyleItems[La],ra.Name in this.$I||ra.TableStyleElementsList&&ra.TableStyleElementsList.sort(N.Brf),this.$I[ra.Name]=ra;if(X.a(this.$I).length!==ya.TableStyleItems.length)for(Ia=!0,ra=La=60;ra<this.IL.TableStyleItems.length;)La>=
ya.TableStyleItems.length?delete this.$I[this.IL.TableStyleItems[ra].Name]:La>=ya.TableStyleItems.length||!G.a.equals(ya.TableStyleItems[La].Name,this.IL.TableStyleItems[ra].Name,!1)?delete this.$I[this.IL.TableStyleItems[ra].Name]:++La,++ra;this.IL=ya;this.PRf(Ia);Ia&&this.z_c();ha&&("accessibility"===ha?(this.iOb=!1,this.BAc=!0):this.BAc=!1);this.Sjf||(this.Fri()&&this.$.af(),this.Sjf=!0);this.Lid=0;this.HBb||this.pYe?this.BAc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),
this.pYe=!0)}};this.jCf=()=>{d.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.Lid++;5>this.Lid&&z.a.instance.create(()=>{this.t5a("getTableStylesFailed")},1E3,x.a.ybg,!0,!0)};this.QHf=()=>{this.HBb&&(this.HBb=!1,this.rwc&&this.rwc(),z.a.instance.create(()=>{this.t5a("galleryMenuClosed")},1E3,x.a.ybg,!0,!0))};this.$=oa;this.Va=K;this.tableManager=ea;this.$.da.Ga(329,this);this.V_c=this.Cwb();this.$.Ja.DZa(this.QHf)}d$e(oa){const K=this.tableManager.Kg;
if(!K)return!1;oa=oa[v.a.Jc];if(!oa)return!1;switch(Number.parseInvariant(oa)){case 0:return A.d(K);case 1:return A.c(K);case 2:return A.g(K);case 3:return A.e(K);case 4:return A.f(K);case 5:return A.b(K);case 6:return K.hasAutoFilter}return!1}MLf(oa,K){if(h.a.isEmpty(this.$I))return!0;if("PopulateTableMoreStylesMenu"!==oa&&"PopulateTableAccessibleStylesMenu"!==oa)return!1;if("PopulateTableAccessibleStylesMenu"===oa&&!this.BAc)return this.iOb||(this.iOb=!0,this.t5a("accessibilityTab")),!0;this.HBb=
!0;const ea=this.Va.aq("TableStylesMenu"),ya=this.Va.aB("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),ha=this.Va.aB("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),La=this.Va.aB("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Ia=this.Va.aB("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48");let ra=-123538519,pa;if(K.MenuId)if(G.a.contains(K.MenuId,"FormatAsTable",!0))ra=753331043,this.p7a=!0;else{pa=C.a.instance.ga(1997);var ba=N.Hxb(null,1,"-1");
O.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Ia.iu("-1",ra,"QueryTableStyle",0,"-1",ba,void 0,void 0,pa):Ia.iu("-1",ra,"QueryTableStyle",0,"-1",void 0,void 0,void 0,pa);this.p7a=!1}ba=0;const fa=this.$I;for(let Ka in fa){const aa=fa[Ka];if("PopulateTableAccessibleStylesMenu"===oa&&aa.HasStyleViolations)continue;let ja;pa=N.X6e(aa,this.Cwb());ja=N.Hxb(aa,this.NIa);if(aa)switch(aa.Category){case 0:ya.iu(aa.Index.toString(),ra,"QueryTableStyle",0,aa.Index.toString(),
ja,void 0,void 0,pa);ba++;break;case 3:ha.iu(aa.Index.toString(),ra,"QueryTableStyle",0,aa.Index.toString(),ja,void 0,void 0,pa);break;case 2:La.iu(aa.Index.toString(),ra,"QueryTableStyle",0,aa.Index.toString(),ja,void 0,void 0,pa);break;case 1:Ia.iu(aa.Index.toString(),ra,"QueryTableStyle",0,aa.Index.toString(),ja,void 0,void 0,pa)}}0<ba&&this.N2(ea,ya,1965);this.N2(ea,Ia,1966);this.N2(ea,La,1967);this.N2(ea,ha,1968);K.MenuItems=ea.JC();this.isInitialized||(this.isInitialized=!0);return!0}xkd(oa){oa[m.a.On]=
!1;let K=oa[v.a.Jc];if(K&&!h.a.isEmpty(this.$I)){G.a.contains(oa.ParentMenuId,"FormatAsTable",!0)?this.p7a=!0:this.p7a=!1;this.p7a||this.Wgg();N.Elf(oa)&&(K=this.Vwb(K).toString());var ea=this.Cwb();oa[m.a.Alt]="-1"===K?C.a.instance.ga(1997):N.X6e(this.Kid(K),ea);if(K in this.eUa&&ea.equals(this.V_c))this.OLf(oa,K,ea,!0);else{if(!this.stc||this.stc&&!this.stc.Ep)this.$ma={},this.stc=z.a.instance.create(()=>{this.PRf();this.V_c=this.Cwb()},0,x.a.mMj,!0,!0);this.jGd(ea,oa,K)}}}getTableStyleIndexFromName(oa){if(!oa||
h.a.isEmpty(this.$I))return-1;if(oa in this.$I)return this.$I[oa].Index;this.t5a("getTableStyleIndexFromName");return-1}Rsd(){return!!this.IL}Vwb(oa){this.nO||this.z_c();return oa in this.nO?this.nO[oa]:-1}t5a(oa){if(this.$.isEditMode){var K=new Date;if(30<D.getElapsedSeconds(this.lastSyncTime,K)||h.a.isEmpty(this.$I)||this.iOb){let ea=this.$.pa.ya.Wb();this.lastSyncTime=K;oa=this.iOb&&"accessibilityTab"===oa||"galleryMenuClosed"===oa;B.m(this.$.pa.ya,oa,this.yQi,this.jCf,null,oa?"accessibility":
"normal",ea)}}}dispose(){this.nO=this.eUa=this.IL=this.$I=null;this.$.Ja.QJb(this.QHf);super.dispose()}ZLg(oa){this.addHandler("RefreshTableStyleGallery",oa)}Sgj(oa){this.removeHandler("RefreshTableStyleGallery",oa)}z_c(){const oa={};this.tableManager.Kg&&(this.$da=this.getTableStyleIndexFromName(this.tableManager.Kg.$Ac));for(let K=1;7>=K;K++)oa["preview"+K]=this.gWh(K);this.nO=oa}gWh(oa){var K=this.IL.TableStyleItems.length;K=4>=this.$da?this.$da+oa-1:4<this.$da&&this.$da<K-4?4===oa?this.$da:Math.floor(this.$da+
oa-4):this.$da+oa-1;-1===K||K.toString()in this.eUa||(K=oa-3);return K}Wgg(){if(this.tableManager.Kg){let oa=!1;const K=this.getTableStyleIndexFromName(this.tableManager.Kg.$Ac);if(K!==this.$da){if(this.nO){const ea=this.nO;for(let ya in ea)ea[ya]===K&&(oa=!0)}this.$da=K;oa||h.a.isEmpty(this.eUa)||this.z_c()}}}N2(oa,K,ea){const ya=this.Va.Ec();ya.cq="Thin";ya.title=C.a.instance.ga(ea);ya.buttons.push(K);oa.tc.push(ya)}Cwb(){const oa=this.tableManager.Kg;return this.p7a||!oa?new W(!0,!1,!1,!1,!0,!1):
new W(A.d(oa),A.g(oa),A.c(oa),A.e(oa),A.f(oa),A.b(oa))}PRf(oa=!1){const K={},ea={},ya=this.Cwb();if(!h.a.isEmpty(this.$I)&&(this.tableManager.Kg&&this.Wgg(),!ya.equals(this.V_c)||oa||h.a.isEmpty(this.eUa))){this.NIa=N.bXh(this.NIa);oa=this.$I;for(var ha in oa){const La=oa[ha],Ia=N.Hxb(La,this.NIa);K[La.Index.toString()]=N.T4a(N.Cta(N.g5b(La,ya)),Ia);ea[Ia]=K[La.Index.toString()];this.cJb(ea)}ha=N.Hxb(null,this.NIa,"-1");K["-1"]=N.T4a(N.Cta(N.g5b(null,ya)),ha);ea[ha]=K["-1"];this.cJb(ea);J.c(this.eUa,
K,!1)}}Fri(){const oa=r.a(this.$);return oa?oa.Em.cA===t.a.JQa:!1}jGd(oa,K,ea){Number.parseInvariant(ea);"-1"===ea&&G.a.contains(K.ParentMenuId,"FormatAsTable",!0)||this.OLf(K,ea,oa,!1)}OLf(oa,K,ea,ya){const ha=N.Hxb(null,this.NIa,K);N.Elf(oa)?(ha in this.$ma?ea=this.$ma[ha]:(ea=N.Cta(N.g5b(this.Kid(K),ea)),this.$ma[ha]=ea),oa[m.a.GalleryButtonProps]=Object(f.a)(new l.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ha,Alt:oa[m.a.Alt],MenuItemId:K,TableCellStyles:ea,TableStyles:this.F4i})):
(oa[w.a.Icon]=ha,oa[m.a.GalleryButtonProps]=Object(f.a)(new n.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ha,Alt:oa[m.a.Alt],MenuItemId:K}),ya||(ya=[],this.Kid(K),"-1"===K||G.a.contains(oa.ParentMenuId,"FormatAsTable",!0)||(ya=N.g5b(this.IL.TableStyleItems[Number.parseInvariant(K)],ea)),this.eUa[K]=N.T4a(N.Cta(ya),ha)))}cJb(oa){if(this.HBb)this.rwc=()=>{this.cJb(oa)};else{this.rwc=null;var K=[];for(let ya in oa){var ea=ya;ea in this.dJb?K.push(ea):this.dJb[ea]=!0}try{0<K.length&&appChrome.api.unregisterIcons(K),
h.a.isEmpty(oa)||appChrome.api.registerIconProvider(()=>oa)}catch(ya){}}}Kid(oa){oa=Number.parseInvariant(oa);if(-1===oa||!this.IL)return null;if(60<oa)for(let K=60;K<this.IL.TableStyleItems.length;++K){const ea=this.IL.TableStyleItems[K];if(ea.Index===oa)return ea}return this.IL.TableStyleItems[oa]}}Object(u.a)(sa,"TableStyleManager",y.a,[335,2]);var da=a(55);a.d(E,"a",function(){return S});class S extends c.a{constructor(oa){super();this.tableStyleManager=null;this.$=oa;this.Fb()}create(){const oa=
b.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya),K=b.GetServiceTaskFactory.Oa(this.$.da,66,134,this.Ya);e.TaskExtensions.Aa(da.Task.jJ(oa,K),()=>{this.ob(this.tableStyleManager||(this.tableStyleManager=new sa(this.$,oa.result,K.result)))},this.$.la,8)}}Object(u.a)(S,"TableStyleManagerFactory",c.a,[])},1232:function(u,E,a){u=a(0);var c=a(222),b=a(15),e=a(164),f=a(247),d=a(373),h=a(4),m=a(643),l=a(86),w=a(94),n=a(259),y=a(161),t=a(74),r=a(420),v=a(50),B=a(37),A=a(91),z=a(71),x=a(1),D=a(572),
J=a(21),L=a(33);class T extends w.a{constructor(U,N){super(U);this.iT=[];this.pce=null;this.FKb=W=>{let X="forward";W.Values[d.a.direction]?X=W.Values[d.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");W=0;let sa=!0;"backward"===X?(W=this.eud.length-1,sa=!1):"forward"===X?(W=0,sa=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${X}`);this.Zuf(sa,W,!1)};this.iDf=()=>{this.iT=[]};this.CPa=W=>{-411645385===this.$.shortcutKeyManager.us(W,
!0)&&this.Aif()&&(this.$.Ja.Kb(new A.a(-411645385,1,this.$.Hc,6,null),{["event"]:W},W),W.stopPropagation())};this.URi=W=>{this.Ama(W)};this.jb=N;this.zq=J.h(this.jb);this.Gc.ka("keydown",this.URi);this.Gc.ka("keyup",this.CPa);n.a(N).kMg(this.iDf);t.a(N.va,27)&&B.TaskExtensions.Aa(v.GetServiceTaskFactory.Oa(N.da,21,137,1),W=>{W=W.result;W.so(e.a.Abf);W.dm(e.a.Abf,this.FKb)},N.la)}get $(){return this.jb}get eud(){this.iT.length||(this.iT=this.c3e());return this.iT}get Ala(){return this.pce}set Ala(U){this.pce=
U;this.iT=this.c3e()}dispose(){this.$&&n.a(this.$).fhj(this.iDf);this.jb=null;this.iT.length=0;super.dispose()}p5i(U){this.Ama(U)}Zuf(U,N,W=!0,X=null){var sa=this.FLj(U,N,W,X);if(!sa){W=N;var da=U?1:-1,S=this.eud;do{sa=!1;if(t.a(this.$.va,27)){if(W+=da,W>=S.length||0>W)sa=!0}else W=(W+da+S.length)%S.length;if(sa){this.iBi(U,N,X);break}else if(sa=this.fbg(U,N,W,!1,X))break}while(W!==N)}}FLj(U,N,W=!0,X=null){let sa=null;0<=N&&(sa=this.iT[N]);return(null===sa||void 0===sa?0:sa.Gf)&&sa.kg(U,W)?(X&&z.g(X),
b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${sa.de} into a sub region`),sa.sj(),!0):!1}fbg(U,N,W,X,sa=null){W=this.iT[W];if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const da=n.a(this.jb).pB(f.a.qKa),S=n.a(this.jb).pB(f.a.Qxb),oa=this.zq.ha.Sa.p_;if(W===S&&oa||W===da&&!X&&!oa)return!1}if((null===W||void 0===W?0:W.Gf)&&W.kg(U,!1)){sa&&z.g(sa);W.sj();if(U=this.iT[N])U.Zj(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${U.de} to ${W.de}`);
return!0}return!1}iBi(U,N,W=null){W&&z.g(W);if(N=this.iT[N])N.Zj(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${N.de}`);B.TaskExtensions.Aa(v.GetServiceTaskFactory.Oa(this.$.da,21,137,0),X=>{X.result.Pj(e.a.pnb,{[d.a.direction]:U?"forward":"backward"})},this.$.la)}Ama(U){var N=this.$.isEditMode?y.a(this.$):null;if(!this.$.rb.Dxa||T.Nmi(N))if(117===U.keyCode&&(U.ctrlKey||z.b(U))){N=this.V5e(U.target);var W=!U.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${N}`);
if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var X=n.a(this.jb).pB(f.a.KKb);X=this.iT.indexOf(X);h.AFrameworkApplication.sa.Pa.Lw&&this.$.x_&&-1!==X&&N===X&&m.ShyRibbon.MJ(this.$.Jeb,0)}else h.AFrameworkApplication.sa.Pa.Lw&&this.$.x_&&1===N&&m.ShyRibbon.MJ(this.$.Jeb,0);this.Zuf(W,N,!0,U)}else 117!==U.keyCode||T.FVe?-411645385===this.$.shortcutKeyManager.us(U)?this.Aif()&&(this.$.Ja.Kb(new A.a(-411645385,1,this.$.Hc,6,null),{["event"]:U},U),U.stopPropagation()):
1588554917===this.$.shortcutKeyManager.us(U)?0===this.mode?(D.a(this.$)||this.$.Ja.Kb(new A.a(1588554917,1,this.$.Hc,6,null),{["event"]:U},U),U.preventDefault(),U.stopPropagation()):3===this.mode&&(U.preventDefault(),U.stopPropagation()):x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.us(U)?(N=this.V5e(U.target),X=n.a(this.jb).pB(f.a.KKb),W=n.a(this.jb).pB(f.a.qKa),X=this.iT.indexOf(X),W=this.iT.indexOf(W),h.AFrameworkApplication.sa.Pa.Lw&&
this.$.x_&&-1!==X&&N===X&&1===this.$.Jeb&&m.ShyRibbon.MJ(1,0),-1!==W&&N!==W&&this.fbg(!0,N,W,!0,U)):this.w6h(U):(U=r.a.yC.notificationBar.K3(l.a.eSh(),!1),L.a.U7a()?U.image=3:U.image=0,r.a.yC.notificationBar.zC(U),T.FVe=!0)}V5e(U){const N=this.eud;for(let W=0,X=N.length;W<X;++W){const sa=N[W];if(sa&&sa.mh(U))return W}return-1}c3e(){const U=[];for(let N=0,W=this.Ala.length;N<W;N++){const X=n.a(this.$).pB(this.Ala[N]);X&&U.push(X)}return U}Aif(){return 0===this.mode||4===this.mode}static Nmi(U){return U?
U.inKeytipMode:!1}}T.FVe=!1;Object(u.a)(T,"AccessibilityManager",w.a,[574,2]);var O=a(149),G=a(22),C=a(13);class H extends T{constructor(U){super(document.documentElement,U);this.nC=0;this.USg=[f.a.QFe,f.a.EAd,f.a.Pec,f.a.ZYd,f.a.KKb,f.a.B_c,f.a.jdd,f.a.A8e,f.a.JZc,f.a.fBc,f.a.TGj,f.a.Qxb,f.a.O0c,f.a.qKa,f.a.USd,f.a.U0c,f.a.A$f,f.a.bpf,f.a.e_c];this.t0j=[f.a.Pec,f.a.hkg,f.a.gkg,f.a.ikg];this.S4i=[f.a.Pec,f.a.lNf,f.a.mNf,f.a.oNf];this.R_g=[f.a.AYe,f.a.z8e,f.a.hdd,f.a.fdd];this.w4i=[f.a.QFe,f.a.EAd,
f.a.B_c,f.a.jdd,f.a.JZc,f.a.fBc,f.a.Qxb,f.a.O0c,f.a.qKa,f.a.USd,f.a.MMf,f.a.U0c,f.a.e_c];this.G4i=[f.a.Qxb,f.a.FYe];const N=C.a.instance.Ua(253);this.Juj=this.$.shortcutKeyManager.dLa(N);this.mode=0;U.da.Ga(15,this);B.TaskExtensions.Aa(v.GetServiceTaskFactory.Oa(U.da,21,137,1),W=>{W=W.result;W.so(e.a.pnb);W.dm(e.a.pnb,this.FKb)},U.la)}get mode(){return this.nC}set mode(U){this.nC=U;switch(U){case 0:this.Ala=this.USg;break;case 2:this.Ala=this.t0j;break;case 3:this.Ala=this.S4i;break;case 4:this.Ala=
this.R_g;break;case 5:this.Ala=this.w4i;break;case 6:this.Ala=this.G4i;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}Ama(U){this.$.qd&65536&&super.Ama(U)}w6h(U){if(G.a.equals(this.Juj,this.$.shortcutKeyManager.lgd(U),!1)){const N=O.b(this.$);if(null===N||void 0===N?0:N.Gf)z.g(U),N.kg(!0,!1)}}}Object(u.a)(H,"EwaAccessibilityManager",T,[]);class I extends c.a{constructor(U){super();this.$=U;this.Fb()}create(){this.ob(this.$.da.za(15)||new H(this.$))}static ka(U){U.da.Ga(157,
new I(U))}}Object(u.a)(I,"AccessibilityManagerFactory",c.a,[]);var M=a(9);a.d(E,"a",function(){return Q});const Q=()=>{M.a.Fa(I.ka)}},1233:function(u,E,a){var c=a(9);u=a(0);var b=a(15),e=a(222),f=a(37),d=a(53),h=a(1),m=a(290),l=a(212);class w{}w.$Re="ewa-svg-icon";Object(u.a)(w,"CssClassNames",null,[]);var n=a(50),y=a(12),t=a(315),r=a(184);class v{constructor(z,x){this.htmlSanitizationHelper=null;this.ig=()=>{this.gpf();this.$.ea.jo(this.ig)};this.$=z;this.ebg={};this.wXd={};this.htmlSanitizationHelper=
x;(x=this.K2e("excelInitialAppSprite"))?(this.Dpe(x),this.$.ea.sg?this.gpf():z.ea.Ak(this.ig),this.$.da.Ga(388,this)):b.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.wXd=null;this.$.ea.jo(this.ig)}fka(z,x,D=null,J=null){let L;(L=this.wXd[z])||(this.wXd[z]=L=this.i0i(this.ebg[z]));if(!L)return b.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${z} was not found in loaded SVG sprites.`),null;const T=L.cloneNode(!0);if(!T.style){const O=
t.b(L),G=t.b(T),C={};C.iconId=z;C.isOriginalNodeStyleNull=void 0===L.style||null===L.style;C.isOriginalNodeCurrentStyleNull=void 0===L.currentStyle||null===L.currentStyle;C.isClonedNodeCurrentStyleNull=void 0===T.currentStyle||null===T.currentStyle;C.originalNode=O.substring(0,O.indexOf(">")+1);C.clonedNode=G.substring(0,G.indexOf(">")+1);b.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(C)}`)}T.setAttribute("style",`height: ${x}px; width: ${x}px;`);
J&&(z=document.createElement("title"),h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")?this.htmlSanitizationHelper.dk(z,J):z.innerHTML=J,T.insertBefore(z,T.childNodes[0]));if(D)for(const O of D)Sys.UI.DomElement.addCssClass(T,O);return T}Aba(z,x,D,J,L=0,T=0,O=null,G=null){L&&T||(T=y.DOMElementExtensions.getBoundingClientRect(J),L=T.height,T=T.width);if(O=this.fka(z,x,O,G))J.appendChild(O),
(J=y.DOMElementExtensions.LZ(O,"style",null))?O.setAttribute("style",J+` margin: ${(L-x)/2}px ${(T-D)/2}px;`):b.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${z}`);return O}gpf(){f.TaskExtensions.Aa(n.GetServiceTaskFactory.Oa(this.$.da,283,284,0),z=>{z=r.c(z.result.ln.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.Aa(z,()=>{const x=this.K2e("excelUiSlice20Sprite");x?this.Dpe(x):b.ULS.sendTraceTag(537151259,
0,15,"window[excelUiSlice20Sprite].icons returned null.")},this.$.la,3)},this.$.da.la,3)}Dpe(z){for(const x of z)x.type===l.a.uXd&&(this.ebg[x.id]=x)}i0i(z){if(!z)return null;const x=z.viewBox;z=z.children;const D=document.createElementNS(m.a.xXd,l.a.uXd);Sys.UI.DomElement.addCssClass(D,w.$Re);D.setAttribute("focusable","false");D.setAttribute("viewBox",x);this.tIg(D,z);return D}tIg(z,x){for(const J of x){const L=document.createElementNS(m.a.xXd,J.type);for(let T in J){x=T;var D=J[T];"className"===
x?L.setAttribute("class",D):L.setAttribute(x,D)}z.appendChild(L)}}K2e(z){return(z=window[z])?z.icons:null}}Object(u.a)(v,"SvgIconProvider",null,[536,2]);class B extends e.a{constructor(z){super();this.$=z;this.Fb()}create(){var z=[130];if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")){z=d.a.KN(z,4,this.Ya,void 0,void 0,void 0,387);const x=n.GetServiceTaskFactory.Oa(this.$.da,498,499,
0);f.TaskExtensions.Aa(f.TaskExtensions.Ed([z,x],this.$.la),()=>{window.excelInitialAppSprite?this.ob(this.$.da.za(388)||new v(this.$,x.result)):b.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.la,3)}else f.TaskExtensions.Aa(d.a.KN(z,4,this.Ya,void 0,void 0,void 0,387),()=>{window.excelInitialAppSprite?this.ob(this.$.da.za(388)||new v(this.$,null)):b.ULS.sendTraceTag(509694111,0,50,"window.[excelInitialAppSprite] returned null.")},this.la,3)}static ka(z){z.da.Ga(387,
new B(z))}}Object(u.a)(B,"SvgIconProviderFactory",e.a,[]);a.d(E,"a",function(){return A});const A=()=>{c.a.Fa(B.ka)}},1258:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(21),f=a(1126);class d extends f.a{constructor(l,w){super(l);w.Ga(240,this)}Z0h(l){for(const w of this.rangeList)if(l.range.contains(w))return w;return null}HId(l){return l.GridBlockModel&&(l=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(l.GridBlockModel))?l.getSparklineRanges():null}}Object(u.a)(d,"SparklineManager",
f.a,[540]);class h extends b.a{constructor(l){super();this.sparklineManager=null;this.$=l;this.Fb()}create(){this.ob(this.sparklineManager||(this.sparklineManager=new d(e.h(this.$),this.$.da)))}static ka(l){l.da.Ga(239,new h(l))}}Object(u.a)(h,"SparklineManagerFactory",b.a,[]);a.d(E,"a",function(){return m});const m=()=>{c.a.Fa(h.ka)}},1280:function(u,E,a){u=a(0);var c=a(144),b=a(599);class e extends b.a{constructor(){super()}dispose(){c.WacAirSpace.vod()&&c.WacAirSpace.KBc()}animate(h,m,l,w,n){m&&
c.WacAirSpace.zL(h.element,m);c.WacAirSpace.animate(h,w,n);l&&c.WacAirSpace.jdj(h.element,l)}}Object(u.a)(e,"AnimationManager",b.a,[2]);var f=a(100);a.d(E,"a",function(){return d});const d=()=>{f.a.Tl.Ga(141,new e)}},1454:function(u,E,a){a.r(E);u=a(1199);E=a(1164);var c=a(1122),b=a(1123),e=a(1124),f=a(1127);a(1125);var d=a(1232),h=a(1280),m=a(9),l=a(0),w=a(222),n=a(187),y=a(552),t=a(15),r=a(812),v=a(518),B=a(82),A=a(4),z=a(78),x=a(904);class D extends z.a{constructor(C){super();this.bvd=null;this.$=
C;t.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}Vlj(){const C=new n.a,H=v.a.kr(B.a.instance.Ub("Common.IEventEmitter<Common.IMruResult>")),I=new y.a(()=>H.result);this.bvd=new y.a(()=>new r.a(I.value,null));if(!this.bvd)return C;var M=this.bvd.value.WZ("NewAndOpenCoreManager",!1);if(!M||3!==M.state||!M.kzd)return M?t.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${M.state}, mruResult MruDocuments is null: ${!M.kzd}`):t.ULS.sendTraceTag(544289227,
0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;M=M.kzd;const Q=["xlsx","xlsb","xlsm"];for(let N=0;N<M.length;N++){var U=M[N];if(0>Array.indexOf(Q,U.extension))continue;const W=`${U.title}.${U.extension}`,X=x.b(U,A.AFrameworkApplication.isRtl);U=U.url;W&&X&&U?C.add({[D.fileName]:W,[D.friendlyPath]:X,[D.section]:"mru",[D.absoluteUrl]:U}):U||t.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return C}dispose(){super.dispose()}}
D.fileName="FileName";D.friendlyPath="FriendlyPath";D.section="Section";D.absoluteUrl="AbsoluteUrl";Object(l.a)(D,"NewAndOpenCoreManager",z.a,[539,2]);class J extends w.a{constructor(C){super();this.$=C;this.Fb()}create(){this.ob(this.$.da.za(451)||this.$.da.Ga(451,new D(this.$)))}static ka(C){C.da.Ga(164,new J(C))}}Object(l.a)(J,"NewAndOpenCoreFactory",w.a,[]);l=a(1156);w=a(1258);z=a(1233);var L=a(1200),T=a(1159),O=a(1149),G=a(1168);a=a(1141);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(u.a)();Type.registerNamespace("Common.App.AltTextDialog");Object(E.a)();Object(c.a)();Object(b.a)();Object(e.a)();Object(d.a)();m.a.Fa(J.ka);Object(h.a)();Object(l.a)();Object(w.a)();Object(z.a)();Object(f.a)();Object(L.a)();Object(T.a)();Object(O.a)();
Type.registerNamespace("Common.App.SessionExpiration");Object(G.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/d9fd1b63ce69e8ca90a89cb13c5050f8/EwaDSEsNext.acc.js.map