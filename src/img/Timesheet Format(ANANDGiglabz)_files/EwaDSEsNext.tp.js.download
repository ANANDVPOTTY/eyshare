'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[62],{1446:function(u,E,a){a.r(E);var c=a(0),b=a(511),e=a(48),f=a(9),d=a(53),h=a(87),m=a(55),l=a(83),w=a(222),n=a(417),y=a(37),t=a(7),r=a(15),v=a(85),B=a(82),A=a(224),z=a(14),x=a(107),D=a(4),J=a(86),L=a(147),T=a(120),O=a(573),G=a(94),C=a(732),H=a(5),I=a(721),M=a(132),Q=a(371),U=a(188),N=a(283),W=a(33),X=a(247),sa=a(564),da=a(12),S=a(1),oa=a(11),K=a(13),ea=a(21),ya=a(133),ha=a(152),La=a(344),Ia=a(682),ra=a(553),pa=
a(19);const ba=pa.a.T$c;class fa extends G.a{constructor(Ub,Ac,Ic,dd){super(Ub);this.tse='<div id="AgaveTaskPaneHeaderId"><span class="{0}" id="{1}"></span></div><div id="{2}"></div>';this.s0b=null;this.imd=this.Scg=!1;this.S$d=this.wj=this.pf=null;this.vq=0;this.button=null;this.jOf=!1;this.Sdc="Help.GiveFeedback.Url";this.onCloseButtonTabKeyDown=Ud=>{if(void 0!==Ud.Ca&&null!==Ud.Ca&&Ud.Ca.keyCode===v.a.Yy)if(Ud.Ca.shiftKey){if(!W.a.fd(this.$)){Ud=this.$.da.za(183);if(!Ud)return!1;Ud.bRd()}}else this.kg(!0,
!1),Ud.Ca.preventDefault(),Ud.Ca.stopPropagation();return!0};this.ypc=(Ud,Hd)=>{Object.getType(Hd)===String&&Hd.toString()===this.pf.InstanceId&&(Ud=!!this.title,Hd=!this.imd,Ud&&this.rOe(),this.cfg(),W.a.fd(this.$)&&(Ud&&this.Scg||Hd&&this.imd)&&this.d8.updateTaskPane(this.f1,this.ZB))};this.rma=()=>{var Ud;S.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")&&this.wj.dLd(this.pf.InstanceId);const Hd=sa.a(this.pf);if(Hd)if(this.pf.TaskpaneTitle===K.a.instance.ga(981))r.ULS.sendTraceTag(537151139,
9,50,"Chart task pane closed");else if(this.pf.PrimaryMarketplace)if("FA000000005"===this.pf.PrimaryMarketplace.SolutionId){r.ULS.sendTraceTag(537151138,397,50,"Ideas task pane closed");let me="Unknown",xe="Unknown",Ke="Unknown";null===(Ud=this.pf.OsfPropertyBag)||void 0===Ud?void 0:Ud.forEach(vd=>{2===vd.length&&("LaunchMode"===vd[0]?me=vd[1]:"CorrelationId"===vd[0]?xe=vd[1]:"LaunchSelectionMode"===vd[0]&&(Ke=vd[1]))});Ud={["LaunchMode"]:me,["CorrelationId"]:xe,["LaunchSelectionMode"]:Ke,["Location"]:"taskPane"};
ya.b(this.$).ud(M.a.x3g,Ud,void 0,!0);'"Default"'===me?B.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(vd=>{vd.logActivity("Office_Excel_Ideas_InitializeClosePaneFloodgate",null)}):'"RecommendedCharts"'===me?B.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(vd=>{vd.logActivity("Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",null)}):'"RecommendedPivotTables"'===me&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:4724516_AddSurveyForRecommendedPivotTables")?B.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(vd=>
{vd.logActivity("Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",null)}):'"ChartDesigner"'===me&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:5202022_AddSurveyForChartDesigner")&&B.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(vd=>{vd.logActivity("Office_Excel_ChartDesigner_InitializeClosePaneFloodgate",null)})}else W.a.Vhi()&&"FA000000043"===this.pf.PrimaryMarketplace.SolutionId?"Record Actions"===this.pf.TaskpaneTitle&&(this.$.Qba=!1,r.ULS.sendTraceTag(537151137,0,50,
"OnCloseButtonClick: set recording state to false since the recorder task pane is closed.")):this.pf.PrimaryMarketplace.SolutionId===O.a?this.Lqf(!1):S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1)&&"FA000000075"===this.pf.PrimaryMarketplace.SolutionId&&(Ud=this.$.da.za(465))&&Ud.iMe();oa.HelperMethods.Gw(this.pf)?this.wg(!1):(W.a.fd(this.$)?this.d8.hideTaskPane(this.f1):this.raiseEvent("AgavePaneRemovedEventKey"),this.wj.jRa(this.pf.InstanceId),
W.a.fd(this.$)||this.d8.kA());ea.h(this.$).setFocus();if(1===this.pf.WebExtensionOsfControlType&&!Hd){this.pf.TaskpaneVisible=!1;const me=this.$.pa.ya.Wb();Q.a(this.$.userOperationManager,(xe,Ke,vd)=>N.c(this.$.pa.ya,this.pf.InstanceId,!1,xe,Ke,vd,me),xe=>new U.a(547,0,xe,64),null)}return!0};this.IEf=(Ud,Hd)=>{Object.getType(Hd)===String&&Hd.toString()===this.pf.InstanceId&&(W.a.fd(this.$)?this.d8.hideTaskPane(this.f1):this.raiseEvent("AgavePaneRemovedEventKey"))};this.HEf=(Ud,Hd)=>{Object.getType(Hd)===
String&&Hd.toString()===this.pf.InstanceId&&(this.OZd(),W.a.fd(this.$)?this.X6():this.d8.nG(this,!0))};this.onResize=()=>{this.Z9c()};this.$=Ac;this.d8=Ic;S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")&&dd?dd.dk(this.domElement,String.format(this.tse,ba,this.$.Eb+H.a.AXc,this.$.Eb+H.a.zXc)):this.domElement.innerHTML=String.format(this.tse,ba,this.$.Eb+H.a.AXc,this.$.Eb+H.a.zXc);
this.eqg=da.DOMElementExtensions.getElementById(this.domElement,this.$.Eb+H.a.zXc);this.usa=da.DOMElementExtensions.getElementById(this.domElement,this.$.Eb+H.a.AXc);S.EwaSettings.ma(417)&&(this.s0b=da.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId"));Ub=da.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");this.Joa=this.s$g();Ub.appendChild(this.Joa);A.a.instance.ta(z.a.click,this.Joa,this.rma);this.fkc=x.KeyInputManager.instance.Ls(this.Joa,
this.rma,v.a.Lh);W.a.fd(this.$)||x.KeyInputManager.instance.ta(z.a.Pb,this.Joa,this.onCloseButtonTabKeyDown);da.DOMElementExtensions.setVisible(this.usa,!1);this.domElement.style.height="100%";this.domElement.style.width="100%";this.domElement.style.overflowY="hidden";this.Z9c();this.$&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&this.domElement.classList.add(C.a.BRe);this.$.PA(this.onResize)}LP(Ub){this.addHandler("AgavePaneRemovedEventKey",Ub)}WR(Ub){this.removeHandler("AgavePaneRemovedEventKey",
Ub)}gJg(Ub){this.addHandler("AgavePaneReadyKey",Ub)}Fej(Ub){this.removeHandler("AgavePaneReadyKey",Ub)}get VGa(){return this.eqg}get jh(){return 6}get Fk(){return this.pf.TaskpaneIconCssClass||""}get sN(){return this.pf.TaskpaneButtonTooltip||this.pf.WebExtensionToolTip+" "+this.title}get iconUrl(){return this.S$d}get Kp(){return this.pf.TaskpaneWidth}get isResizable(){const Ub=Ac=>{var Ic,dd;return(null===(dd=null===(Ic=this.pf)||void 0===Ic?void 0:Ic.PrimaryMarketplace)||void 0===dd?void 0:dd.SolutionId)===
Ac};return!OSF.OsfControl.isFirstPartyStoreString(this.pf.PrimaryMarketplace.MarketplaceType)&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:4470694_LegacyTaskpaneResizeForThirdParty")||Ub("FA000000043")||Ub("FA000000054")||S.EwaSettings.isChangeGateEnabled("OfficeVSO:6545419_ExcelIdeasResize")&&Ub("FA000000005")||S.EwaSettings.isChangeGateEnabled("OfficeVSO:6197879_DataFromPictureResize")&&Ub("FA000000050")?!0:!1}get de(){return X.a.SNg}get mc(){return this.domElement}get Gf(){return!!this.pf}get title(){return this.wj.MQh(this.pf.InstanceId)}get titleText(){return this.title}get VZa(){return OSF.OsfControlTarget.TaskPane}get instanceId(){return this.pf.InstanceId}get f1(){return"AgaveTaskPane-"+
this.instanceId.replace(RegExp("[{}]","g"),"")}get ZB(){const Ub=this.d8.zva(this.mc,this.titleText,this.Kp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Kp,void 0,this.iconUrl,this.pf.TaskpaneIconId,oa.HelperMethods.Gw(this.pf));if(S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)&&this.pf.SrcLocationOverrideResourceId===this.Sdc){Ub.contentProps.type="OcvFeedbackTaskPaneProps";Ub.hideHeader=
!1;let Ac=JSON.parse(this.pf.OsfPropertyBag[0][1]);Ub.contentProps.feedbackTaskPaneProps={customerUiWrapperFeedbackData:Object.assign(Object.assign({},Ac),{d3j:!0}),taskPaneLocation:Ub.location,taskPaneIdToClose:this.f1}}return Ub}startEdit(){return!0}uAc(){return!0}onf(){this.wj.Xh.notifyAgave(this.pf.InstanceId,OSF.AgaveHostAction.TabIn)}pnf(){this.wj.Xh.notifyAgave(this.pf.InstanceId,OSF.AgaveHostAction.TabInShift)}RCd(){this.wj.xWc(this.IEf);this.wj.NJg(this.HEf);let Ub=this.wj.ofd(this.pf.InstanceId);
this.title&&Ub||this.wj.QJg(this.ypc);this.title&&this.rOe();this.raiseEvent("AgavePaneReadyKey");W.a.fd(this.$)&&(""!==this.Fk?d.a.we(10):d.a.current.fo(102),this.Ygg(),S.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&W.a.fd(this.$)&&oa.HelperMethods.Gw(this.pf)&&this.pf.Preload&&!this.pf.TaskpaneVisible?this.W5b():this.X6())}W5b(){this.d8.W5b(this.f1,this.ZB)}X6(){this.d8.X6(this.f1,this.ZB)}dispose(){var Ub,Ac;this.jOf||(null===(Ac=null===(Ub=this.pf)||void 0===
Ub?void 0:Ub.PrimaryMarketplace)||void 0===Ac?void 0:Ac.SolutionId)!==O.a||this.Lqf(!0);A.a.instance.Ba(z.a.click,this.Joa,this.rma);x.KeyInputManager.instance.Tv(this.Joa,this.fkc);W.a.fd(this.$)||x.KeyInputManager.instance.Ba(z.a.Pb,this.Joa,this.onCloseButtonTabKeyDown);this.wj&&(this.wj.ifj(this.ypc),this.wj.gfj(this.IEf),this.wj.ffj(this.HEf),this.$&&(this.$.YD(this.onResize),this.$=null));this.$=this.pf=null;super.dispose()}Ygg(){this.pf&&this.cfg()}FR(Ub){Ub||this.OZd()}wg(Ub){if(this.pf){const Ac=
this.pf.TaskpaneVisible!==Ub;this.pf.TaskpaneVisible=Ub;W.a.fd(this.$)?Ub||this.d8.hideTaskPane(this.f1):this.d8.kA();oa.HelperMethods.Gw(this.pf)&&Ac&&this.wj.HFh(this.instanceId,Ub)}}lq(){let Ub=!1;this.pf&&this.$.qd&8388608&&(Ub=this.pf.TaskpaneVisible);return Ub}Ds(){return!this.pf||OSF.OsfControl.isFirstPartyStoreString(this.pf.PrimaryMarketplace.MarketplaceType)||this.$.X2?oa.HelperMethods.Gw(this.pf)?this.pf.TaskpaneVisible:!!this.pf:!1}kg(Ub,Ac){return Ac?!1:(this.OZd(),this.wj.Xh.notifyAgave(this.pf.InstanceId,
Ub?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift),!0)}mh(Ub){return da.DOMElementExtensions.yf(this.mc,Ub)}sj(){}Zj(){}TQ(Ub,Ac){var Ic=Ac.querySelectorAll(da.DOMElementExtensions.Gr);Ac=da.DOMElementExtensions.um(Ic);Ic=da.DOMElementExtensions.nB(Ic);let dd=!1;Ac===Ub.Gb&&Ub.Ca.shiftKey?((Ub=document.getElementById(this.$.Eb+H.a.znc))&&da.DOMElementExtensions.isVisible(Ub)?da.DOMElementExtensions.setFocus(Ub):this.kg(!1,!1),dd=!0):Ic!==Ub.Gb||Ub.Ca.shiftKey||(this.L2f(),dd=!0);return dd}L2f(){this.Joa&&
da.DOMElementExtensions.setFocus(this.Joa)}s$g(){const Ub=document.createElement("a");Ub.tabIndex=0;Ub.id="AgaveTaskpaneCloseButtonId";Ub.className=H.a.nfb+(D.AFrameworkApplication.isRtl?H.a.Maa:H.a.Naa);Ub.title=K.a.instance.ga(10);Ub.setAttribute(J.a.Ld,J.a.ot);Ub.style.borderColor="transparent";S.EwaSettings.isChangeGateEnabled("OfficeVSO:4186654_RemoveAgaveTaskpaneCloseBottomMargin")?Ub.style.margin="6px 6px 0px 6px":Ub.style.margin="6px";Ub.style.zIndex="2";Ub.style.position="relative";const Ac=
document.createElement("span");Ac.className="StandardButtonImage clip16x16 StandardButtonImageNoText";Ac.id=Ub.id+"-close";const Ic=ha.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","",!0,K.a.instance.ga(793));Ac.appendChild(Ic);Ub.appendChild(Ac);return Ub}rOe(){this.usa.innerText=this.title;this.usa.style.textOverflow="ellipsis";this.usa.style.whiteSpace="nowrap";this.usa.style.overflowX="hidden";this.pf.TaskpaneTitleCssClass&&(this.usa.className=this.usa.className+" "+this.pf.TaskpaneTitleCssClass);
S.EwaSettings.ma(417)&&(this.s0b.className=this.s0b.className+" "+this.pf.TaskpaneHeaderCssClass);da.DOMElementExtensions.setVisible(this.usa,!0);this.button&&(this.button.h0a.title=this.title);this.Z9c();this.Scg=!0}cfg(){if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")){if(this.Fk&&!W.a.fd(this.$)){if(this.button){var Ub=d.a.we(10),Ac=this.button.Fl;Ac.setAttribute("src",Ub);Ac.setAttribute("class",this.Fk)}return}}else if(this.Fk){this.button&&(Ub=d.a.we(10),
Ac=this.button.Fl,Ac.setAttribute("src",Ub),Ac.setAttribute("class",this.Fk));return}if(Ac=S.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")?this.pf.TaskpaneIconUrl?this.pf.TaskpaneIconUrl:this.wj.ofd(this.pf.InstanceId):this.wj.ofd(this.pf.InstanceId))this.$.z5&&this.pf.PrimaryMarketplace&&this.pf.PrimaryMarketplace.SolutionId===I.a.solutionId&&(Ac=this.tUh(Ac)),W.a.fd(this.$)?this.S$d=Ac:(Ub=this.button.Fl,Ub.setAttribute("src",Ac),Ac=d.a.current.fo(102),Ub.setAttribute("onerror",
"this.onerror = null;this.src = '"+Ac+"';")),this.imd=!0}tUh(Ub){const Ac=I.a.bdc(this.$),Ic=I.a.C4(this.$),dd=I.a.gba(this.$),Ud=I.a.pxb(this.$),Hd=this.pf.SrcLocationOverrideResourceId,me=W.a.fd(this.$);return Hd===Ac?me?Ub.replace("/icon-32.png","/record-tp-20.png"):Ub.replace("/icon-32.png","/record-tp-32.png"):Hd===Ic?me?Ub.replace("/icon-32.png","/code-tp-20.png"):Ub.replace("/icon-32.png","/code-tp-32.png"):Hd===dd?me?Ub.replace("/icon-32.png","/rfb-tp-20.png"):Ub.replace("/icon-32.png","/rfb-tp-32.png"):
Hd===Ud?me?Ub.replace("/icon-32.png","/flowconnector-tp-20.png"):Ub.replace("/icon-32.png","/flowconnector-tp-32.png"):Ub}Z9c(){this.$&&!S.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&(this.VGa.style.height=oa.HelperMethods.uc(this.d8.XO.offsetHeight-this.s0b.offsetHeight))}OZd(){this.wj.IAd(this)}Lqf(Ub){Ub={["PaneClosedTime"]:Date.now(),["IsSessionEnded"]:Ub.toString()};const Ac=new Ia.a(ra.a.Yj());Ac.add("PaneClosedTime",3);Ac.add("IsSessionEnded",1);L.a.sendTelemetryEvent(Object(t.a)(new La.a,
{name:"Office.Excel.Online.Protection.TaskPaneClosed",dataFields:T.a.Wj(Ub,Ac)}));this.jOf=!0}}Object(c.a)(fa,"AgaveTaskPane",G.a,[36,327,368,364]);var Ka=a(50);class aa extends w.a{constructor(Ub){super();this.fFd=[];this.WIf=null;this.cyf=Ac=>{this.ob(Object(l.a)(327,Ac))};this.$=Ub;this.Fb()}create(){const Ub=S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")?Ka.GetServiceTaskFactory.Oa(this.$.da,
498,499,this.Ya):m.Task.Ta(null),Ac=n.a(this.$);y.TaskExtensions.Aa(y.TaskExtensions.Ed([Ac,Ub],this.$.la),()=>{const Ic=new fa(document.createElement("div"),this.$,Ac.result,Ub.result);this.fFd.push(Ic);Ic.gJg(this.cyf);this.Ra.raiseEvent(w.a.FZc,null,Ic)},this.la,3)}dispose(){for(const Ub of this.fFd)Ub.Fej(this.cyf);h.a.qc(this.fFd);h.a.Ia(this.WIf);this.$=this.WIf=null;super.dispose()}}Object(c.a)(aa,"AgaveTaskPaneFactory",w.a,[]);var ja=a(30),Va=a(238),bb=a(209),wa=a(259),ka=a(60),ta=a(47),qa=
a(46),rb=a(324),Za=a(71),gb=a(22),mb=a(285),Ga=a(281);const ib=pa.a.Iyh,cc=`<div class="${pa.a.T$c}"><div title="{0}" class="${pa.a.Svh}">{0}</div></div><div><div class="${pa.a.Nvh}">{1}</div><div class="${pa.a.Pvh} ${pa.a.Bo}" id="parametersSection">&nbsp;</div><div align="bottom" class="${pa.a.Mvh}"><button class="${pa.a.xRe} ${pa.a.Lvh}" id="applyButton" type="submit">{2}</button><button class="${pa.a.xRe}" id="resetButton" type="button">{3}</button></div></div>`,ic=`<div><div class="${pa.a.Qvh}"><label for="{2}" title="{1}">{0}</label></div><div class="${pa.a.Rvh}"><input type="text" maxlength="255" id="{2}"/></div></div>`;
class xb extends Va.a{constructor(Ub,Ac,Ic,dd){super(Ub);this.zRd=this.rWa=this.h1=null;this.vq=0;this.htmlSanitizationHelper=null;this.VGf=()=>{this.rWa=null};this.ewj=()=>{h.a.Ia(this.zRd);this.zRd=null;this.isVisible!==this.kTd&&this.raiseEvent("parameterTaskPaneVilibilityChanged")};this.q5g=(Ud,Hd)=>gb.a.compare(Ud.Name,Hd.Name,!0);this.kyf=Ud=>{Za.g(Ud);if(!this.Esa.domElement.classList.contains(pa.a.F9b)){ea.h(this.$).Uo(!0);var Hd=[];for(Ud=0;Ud<this.h1.length;Ud++){const xe=this.rWa[Ud],Ke=
this.h1[Ud].text;xe.Values=[Ke];Ke&&Hd.push(xe)}if(Hd.length){var me=this.$.pa.ya.Wb();this.Esa.addCssClass(pa.a.F9b);this.$.userOperationManager.Ic(new U.a(142,0,(xe,Ke,vd)=>ka.F(this.$.pa.ya,Hd,!1,0,!1,Ga.b(xe,this.TVi),Ga.a(Ke,this.SVi),vd,null,me)),null)}}};this.EUi=Ud=>{Za.g(Ud);Ud=this.h1;for(let Hd=0,me=Ud.length;Hd<me;Hd++)Ud[Hd].text=""};this.TVi=()=>{this.Esa.removeCssClass(pa.a.F9b)};this.SVi=()=>{this.Esa.removeCssClass(pa.a.F9b)};this.CGb=(Ud,Hd)=>{13===Hd.charCode&&this.kyf(Hd)};this.$=
Ac;this.taskPaneManager=Ic;this.htmlSanitizationHelper=dd;Ac=String.format(cc,this.titleText,K.a.instance.ga(1325),K.a.instance.ga(1326),K.a.instance.ga(1327));this.htmlSanitizationHelper&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.dk(Ub,Ac):Ub.innerHTML=Ac;this.Lab=this.getElementById("parametersSection");this.Esa=new rb.a(this.getElementById("applyButton"));
this.Esa.Gc.ka("click",this.kyf);this.eNd=new rb.a(this.getElementById("resetButton"));this.eNd.Gc.ka("click",this.EUi);this.$.ea.Uj(this.VGf);wa.a(this.$).ai(this)}LP(Ub){this.get_events().addHandler("RemoveParamTpEventKey",Ub)}WR(Ub){this.get_events().removeHandler("RemoveParamTpEventKey",Ub)}ME(Ub){this.addHandler("parameterTaskPaneVilibilityChanged",Ub)}kG(Ub){this.removeHandler("parameterTaskPaneVilibilityChanged",Ub)}get X7b(){this.Fdf();return this.rWa}get mc(){return this.domElement}get Kp(){return 250}get isResizable(){return!1}get Gf(){return this.isVisible}get de(){return X.a.z_i}get jh(){return 2}get Fk(){return ib}get sN(){return K.a.instance.ga(1066)}get kTd(){return!!this.X7b&&
0<this.X7b.length&&!this.$.isEditMode}get titleText(){return K.a.instance.ga(1324)}get ZB(){return this.taskPaneManager.zva(this.mc,this.titleText,this.Kp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1})}wg(Ub){W.a.fd(this.$)&&(Ub?(this.Fdf(),this.taskPaneManager.X6("ParametersTaskPane",this.ZB)):this.taskPaneManager.hideTaskPane("ParametersTaskPane"))}lq(){return this.kTd}Ds(){return this.kTd}FR(){}dispose(){this.$&&this.$.ea.uk(this.VGf);
this.KTf();h.a.qc([this.Esa,this.eNd]);this.rWa=this.Lab=this.$=this.Esa=this.eNd=null;super.dispose()}kg(Ub,Ac){Ac||(this.h1&&0<this.h1.length?this.h1[0]:this.Esa).focus();return!Ac}mh(Ub){return da.DOMElementExtensions.yf(this.mc,Ub)}sj(){}Zj(){}TQ(){return!1}Fdf(){!this.rWa&&this.$.qd&2048&&this.CRg(this.$.workbookContext.TaskPaneParameters,this.$.va.SlicerParameters)}CRg(Ub,Ac){var Ic=[];this.KTf();if(!this.$.isEditMode&&Ub&&0<Ub.length){var dd=this.q5g;if(Ac&&0<Ac.length){var Ud=new bb.a([...Ac]);
Ud.q$.sort(dd)}else Ud=null;for(let me=0,xe=Ub.length;me<xe;me++){var Hd=Ub[me];Ac&&!(0>oa.HelperMethods.jw(Ud,0,Ud.Wja(),Hd,dd))||Hd.IsPivotPageField||Hd.IsSlicer||Ic.push(Hd)}}this.rWa=Ic;if(this.Lab&&(this.isVisible!==0<Ic.length&&(this.zRd=ta.a.instance.create(this.ewj,500,qa.a.A_i,!0,!0)),this.htmlSanitizationHelper&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.gU(this.Lab):
this.Lab.innerHTML="",Ic.length)){Ac="";Ub=[];for(let me=0,xe=Ic.length;me<xe;me++)dd=this.$.Eb+"param"+me,Ub.push(dd),Hd=Ic[me],Ud=Hd.Name?ja.a.Gg(Hd.Name):"",Hd=Hd.Comment?ja.a.c_(Hd.Comment):"",Ac+=String.format(ic,Ud,Hd,dd);this.htmlSanitizationHelper&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.dk(this.Lab,Ac):this.Lab.innerHTML=Ac;Ac=[];
for(let me=0,xe=Ic.length;me<xe;me++)Ic=new mb.a(document.getElementById(Ub[me])),Ac.push(Ic),Ic.RKg(this.CGb);this.h1=Ac}}KTf(){if(this.h1){for(let Ub=0,Ac=this.h1.length;Ub<Ac;Ub++)this.h1[Ub].Xfj(this.CGb);h.a.qc(this.h1);this.h1=null}}static DRg(Ub,Ac,Ic){const dd=Ub.da;let Ud=dd.za(17);if(!Ud){const Hd=document.getElementById(Ub.Eb+H.a.B_i);Hd&&(Ud=dd.Ga(17,new xb(Hd,Ub,Ac,Ic)))}return Ud}}Object(c.a)(xb,"ParametersTaskPane",Va.a,[166,368,36,2]);class Vb extends w.a{constructor(Ub){super();this.$=
Ub;this.Fb()}create(){const Ub=S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?Ka.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):m.Task.Ta(null),Ac=n.a(this.$);y.TaskExtensions.Aa(y.TaskExtensions.Ed([Ac,Ub],this.$.la),()=>{this.ob(xb.DRg(this.$,Ac.result,Ub.result))},this.la,3)}}Object(c.a)(Vb,"ParametersTaskPaneFactory",w.a,[]);var wb=a(692),cb=a(183);class lb{nc(){return!1}executeCommand(Ub,
Ac){Ub=Ac.command;switch(Ub){case 329273335:case 1962240939:case 296943390:case -625072140:return m.Task.Ta(!0);default:return cb.a(Ub)}}wc(Ub,Ac,Ic,dd){if(Ub=!!dd&&2===dd.mz)switch(Ac.command){case 329273335:case 1962240939:case 296943390:case -625072140:break;default:Ub=!1}return Ub}Kc(){return!1}}Object(c.a)(lb,"TaskPaneCommandHandler",null,[223]);class Y extends wb.a{constructor(Ub){super(Ub)}ld(){this.Yc([new lb])}static ka(Ub){wb.a.Nd(115,new Y(Ub))}}Object(c.a)(Y,"TaskPaneCommandHandlerFactory",
wb.a,[]);var Oa=a(1321),Wa=a(172);class Ca{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(c.a)(Ca,"TaskPaneGroupAppProps",null,[]);var Ra=a(27),la=a(38),ua=a(212);class xa{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=
null}}Object(c.a)(xa,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var fb=a(292),Jb=a(18),Ob=a(16),eb=a(127);class Ma{constructor(Ub){this.width=Ub}}Object(c.a)(Ma,"ActiveTaskPaneData",null,[]);class va extends la.a{constructor(Ub,Ac){super();this.isVisible=!1;this.UXd=this.yea=-1;this.xKe=40;this.oh=this.JL=this.animationManager=this.GIc=null;this.zCd=()=>{this.oXf()};this.iBc=new Set;this.iBc.add("FieldListTaskPane");this.iBc.add("PivotTableSettingsTaskPane");this.iBc.add("SlicerSettingsTaskPane");
this.jb=Ac;wa.a(this.$).ai(this);this.iA=Ub;this.T9a=this.gWg();W.a.gj(Ac)||D.AFrameworkApplication.sa.Pa.Ye||(this.iA.style.bottom=this.$.qd&4?oa.HelperMethods.uc(this.$.tea):"0");this.v$b={};this.EOb={};this.m4d={};this.RXd=eb.a.instance.Zd(this.mc);this.RXd.ka("focusin",this.zCd);this.nfi()}get $(){return this.jb}get Sga(){return this.m4d}get TM(){return this.GIc}get isCollapsed(){return!this.TM}dispose(){wa.a(this.$).Xz(this);const Ub=this.v$b;for(let Ac in Ub)({key:Ac,value:Ub[Ac]}).value();
this.EOb=this.m4d=this.v$b=null;this.RXd.dD();this.T9a=this.iA=this.RXd=null;super.dispose()}zva(Ub,Ac,Ic,dd,Ud,Hd,me,xe,Ke=va.gwi,vd=va.fwi,Qe=null,bc=null,Zc=!1){const gd=Object(t.a)(new xa,{getContent:()=>Ub});gd.isSharedRuntime=Zc;return Object(t.a)(new Oa.a,{hideHeader:!0,contentProps:gd,title:Ac,width:Ic,location:2,onOpen:Ud,onClose:Hd,onShow:me,onHide:xe,iconUrl:Qe,iconId:bc,enableResize:dd,minResizeWidth:Ke,maxResizeWidth:vd})}X6(Ub,Ac){Wa.UISurfaces.dj().then(Ic=>{Ub in this.Sga?Ic.setSelectedTaskPane(Ub):
Ic.showTaskPane(Ub,Ac);return null})}W5b(Ub,Ac){Wa.UISurfaces.dj().then(Ic=>{Ic.initializeHiddenSharedRuntimeTaskPane(Ub,Ac);const dd=this.$.domElement;dd.addEventListener("scroll",function Hd(){0!=dd.scrollLeft&&(dd.scrollLeft=0,dd.removeEventListener("scroll",Hd))})})}updateTaskPane(Ub,Ac){Wa.UISurfaces.dj().then(Ic=>{Ic.updateTaskPane(Ub,Ac);return null})}setSelectedTaskPane(Ub){Wa.UISurfaces.dj().then(Ac=>{Ac.setSelectedTaskPane(Ub);return null})}hideTaskPane(Ub){Wa.UISurfaces.dj().then(Ac=>{Ac.hideTaskPane(Ub,
va.zMj);return null})}get mc(){return this.iA}get Gf(){return this.isVisible}get de(){return X.a.fBc}kg(Ub,Ac){return Ac?!1:(this.k0f(),!0)}mh(Ub){return da.DOMElementExtensions.yf(this.mc,Ub)}sj(){this.$.frame.Me.wk(this.de)}Zj(){}gWg(){const Ub=document.createElement(ua.a.div);Ub.style.height="0px";Ub.style.width="0px";Ub.tabIndex=-1;return Ub}CLh(){var Ub=da.DOMElementExtensions.getElementById(this.iA,"tabStripFocusZone");if(Ub){Ub=Ub.getElementsByTagName("button");for(let Ac=0;Ac<Ub.length;Ac++)if(Boolean.parse(Ub[Ac].getAttribute("aria-selected")))return Ub[Ac].getAttribute("aria-controls")}return null}T5g(Ub){return(Ub=
window.getComputedStyle(Ub,null).getPropertyValue("transition-duration"))?parseInt(Ub.endsWith("ms")?parseFloat(Ub):1E3*parseFloat(Ub),10):0}qbj(){const Ub=document.getElementById("tabbedTaskPaneContainer");Ub&&Ub.addEventListener("transitionend",()=>this.GHa(-1))}nfi(){Wa.UISurfaces.dj().then(Ub=>{let Ac;Ub.renderTaskPaneGroups(null,this.iA,(Ac=new Ca,Ac.middleContainer=this.T9a,Ac.onOpen=(Ic,dd)=>{this.isVisible=!0;-1===this.yea&&(this.yea=this.T5g(dd));W.a.gj(this.$)||(this.Sga[Ic]=new Ma(da.DOMElementExtensions.cQ(da.DOMElementExtensions.getElementById(dd,
va.Hbg))))},Ac.onClose=Ic=>{this.isVisible=0<Ub.selectors.getTabbedTaskPaneCount();r.ULS.sendTraceTag(537014371,0,50,`Closing of ${Ic} TaskPane`);if(!this.isVisible)this.ZXe(),W.a.gj(this.$)||D.AFrameworkApplication.sa.Pa.Ye||window.requestAnimationFrame(()=>{this.l0b(this.T9a)});else if(!W.a.gj(this.$)&&this.TM&&this.TM!==Ic){const dd=1<Ub.selectors.getTabbedTaskPaneCount()?this.tdc():0,Ud=1===Ub.selectors.getTabbedTaskPaneCount()?-1*this.tdc():0;this.Zre(Ic,this.TM,dd,Ud)}W.a.gj(this.$)?this.GHa(this.yea):
(D.AFrameworkApplication.sa.Pa.Ye&&0>=this.yea&&this.GHa(this.yea),delete this.Sga[Ic]);delete this.EOb[Ic]},Ac.onShow=(Ic,dd)=>{null!=this.di&&(this.di.stop(),this.di=null);this.GIc=Ic;this.oXf();1!==dd&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.wnj()},0)});W.a.gj(this.$)?window.requestAnimationFrame(()=>{this.GHa(this.yea)}):D.AFrameworkApplication.sa.Pa.Ye&&0>=this.yea?window.requestAnimationFrame(()=>{this.GHa(this.yea)}):window.requestAnimationFrame(()=>{this.Qoj(this.T9a,
this.yea)})},Ac.onHide=(Ic,dd,Ud)=>{const Hd=this.CLh();Hd!==Ic&&(this.di=this.$.Jb.Ac("UserAction","TaskPaneToggle"),r.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${Ic} to ${Hd}`));Ud?W.a.gj(this.$)||this.l0b(this.T9a):!W.a.gj(this.$)&&Hd&&(Ic=1===Object.keys(this.Sga).length?this.tdc():0,this.Zre(this.TM,Hd,this.tdc(),Ic));this.GIc=null;Ud&&1!==dd&&this.ZXe();W.a.gj(this.$)&&window.requestAnimationFrame(()=>{this.GHa(this.yea)})},Ac.setFocusCallback=(Ic,dd)=>{dd&&(this.EOb[Ic]=dd)},Ac.onResizeStart=
()=>{W.a.gj(this.$)||this.pXc(oa.HelperMethods.uc(0))},Ac.onResizeEnd=()=>{W.a.gj(this.$)?this.GHa():(this.l0b(this.T9a),this.Sga[this.TM]=this.Mid(this.TM));r.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.TM} TaskPane`)},Ac));D.AFrameworkApplication.sa.Pa.Ye&&!W.a.gj(this.$)&&this.qbj();return null})}l0b(Ub){this.pXc(this.$.isChromeRtl?Ub.style.left:Ub.style.right)}pXc(Ub){r.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.TM}`);this.$.ikj(Ub)}GHa(Ub=0){-1<Ub?m.Task.delay(Ub+
this.xKe).continueWith(()=>{this.$.hAa(fb.a.RZ("ResetContentAreaMargin"))}):this.$.hAa(fb.a.RZ("ResetContentAreaMargin"))}Zre(Ub,Ac,Ic,dd){Ac=Ac.endsWith(va.SXd)?Ac.substring(0,Ac.length-va.SXd.length):Ac;Ac=this.T7e(Ac);dd=Ac+dd;Ub=this.T7e(Ub);dd<Ub&&this.pXc(oa.HelperMethods.uc(Ac+Ic))}Qoj(Ub,Ac){window.setTimeout(()=>{this.l0b(Ub)},Ac+this.xKe)}tdc(){return-1!==this.UXd?this.UXd:this.UXd=da.DOMElementExtensions.cQ(da.DOMElementExtensions.getElementById(this.iA,"tabStripFocusZone"))}Mid(Ub){return da.DOMElementExtensions.cQ(da.DOMElementExtensions.getElementById(da.DOMElementExtensions.getElementById(this.iA,
Ub+va.SXd),va.Hbg))}T7e(Ub){if(Ub in this.Sga){const Ac=this.Sga[Ub].width;return 0<Ac?Ac:this.Mid(Ub)}return Ub?this.Mid(Ub):0}ZXe(){ea.h(this.$).setFocus()}wnj(){if(this.EOb[this.TM]){const Ub=this.EOb[this.TM];Ub&&Ub(null,null)}else this.iBc.has(this.TM)||this.k0f()}k0f(){Wa.UISurfaces.dj().then(Ub=>{1<Ub.selectors.getTabbedTaskPaneCount()?Ub.focusTabbedTaskPaneArea():(Ub=da.DOMElementExtensions.getElementById(this.mc,"AgaveTaskpaneCloseButtonId"))?Ub.focus():(Ub=da.DOMElementExtensions.um(this.mc.querySelectorAll("button")))&&
Ub.focus();return null})}oXf(){this.$.domElement.scrollLeft=0;Ra.a.BNa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}ME(Ub){this.addHandler(va.Ugb,Ub)}kG(Ub){this.removeHandler(va.Ugb,Ub)}get XO(){return this.iA}get YB(){r.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}usb(Ub,Ac,Ic,dd,Ud){let Hd=Ub.za(Ac);Hd||(Hd=Ob.a(Jb.a,Ic,Ub,Ac),Hd.SetScriptLoadFlavor(Ud));
dd&&Hd.sWc(dd);const me=""+Ac;let xe=null;const Ke=()=>{Hd.create();xe()};this.v$b[me]=xe=()=>{Hd.kuc(Ke);delete this.v$b[me]};Hd.A_b(Ke)}initialize(){r.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}M7f(){}vN(){r.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}nG(){r.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}Epe(){r.ULS.shipAssertTag(537151108,
11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}NWf(){r.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}Ixb(){r.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}Fed(){r.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}aja(){r.ULS.shipAssertTag(537151104,
11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}kA(){r.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){r.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}bRd(){r.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static ka(Ub){const Ac=
va.cXg(Ub.Eb,Ub.isChromeRtl,Ub);va.JRg(Ub,Ac);return new va(Ac,Ub)}static cXg(Ub,Ac,Ic){const dd=document.createElement("div");dd.id=Ub+H.a.gBc;W.a.gj(Ic)?dd.classList.add(pa.a.X0j):(dd.classList.add(Ac?pa.a.Z0j:pa.a.Y0j),D.AFrameworkApplication.sa.Pa.Ye&&dd.classList.add(pa.a.tAa));return dd}static JRg(Ub,Ac){Ub.isMobileMode&&Ac.setAttribute("aria-hidden","true");D.AFrameworkApplication.sa.Pa.Ye?document.getElementById("FarPaneRegion").appendChild(Ac):(W.a.gj(Ub)&&Ac.classList.add(pa.a.rsh),document.getElementById(Ub.Eb+
H.a.Q0a).insertBefore(Ac,Ub.LBa))}}va.gwi=300;va.fwi=950;va.zMj=2;va.SXd="-panel";va.Hbg="ExcelTaskPaneContentWrapper";va.c9f="rtpSizeChanged";va.DDe="rtpCollapsed";va.ZJf="rtpAdded";va.Ugb="rtpVisibility";Object(c.a)(va,"ReactTaskPaneManager",la.a,[366,36,2]);var Pa=a(95),Ha=a(156),tb=a(239),Ya=a(416),V=a(84),za=a(555);class yb extends Sys.EventArgs{constructor(){super()}}Object(c.a)(yb,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var jc=a(45);const Cc=C.a.nvh,Sa=C.a.pvh,na=`<span class='${pa.a.qrb} ${C.a.qvh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;
class jb extends Va.a{constructor(Ub){super(document.createElement("a"));this.Ra=new la.a;this.htmlSanitizationHelper=this.gle=null;this.gd=()=>{this.enabled&&this.Ra.raiseEvent("tpButtonClicked",null,this);return!0};this.htmlSanitizationHelper=Ub}tJg(Ub){this.Ra.addHandler("tpButtonClicked",Ub)}aUf(Ub){this.Ra.removeHandler("tpButtonClicked",Ub)}get h0a(){return this.domElement}get taskPane(){return this.gle}get enabled(){return super.enabled}set enabled(Ub){Ub!==super.enabled&&(this.domElement.classList.toggle(C.a.rU),
this.domElement.classList.toggle(Sa),this.domElement.tabIndex=Ub?0:-1,super.enabled=Ub)}get Fl(){return this.domElement.firstChild.firstChild}dispose(){h.a.qc([this.Ra]);this.Ra=null;this.domElement&&jc.a.kna(this.domElement);super.dispose()}mfi(Ub){const Ac=6===Ub.jh;var Ic=Ac&&!Ub.Fk;Ic=String.format(na,Ub.sN,Ub.Fk,Ic?d.a.current.fo(102):d.a.we(10),C.a.via,Ic?String.format('style="width:24px;{0}:0px"',"left"):"");S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?
this.htmlSanitizationHelper.dk(this.domElement,Ic):this.domElement.innerHTML=Ic;this.domElement.classList.add(Cc);this.domElement.classList.add(Sa);this.domElement.title=Ub.sN;this.domElement.tabIndex=0;da.DOMElementExtensions.Nu(this.domElement,H.a.ot,null,null);this.gle=Ub;Ac&&(Ub=this.taskPane,null===Ub||void 0===Ub?void 0:Ub.Ygg());A.a.instance.ta(z.a.click,this.domElement,this.gd);x.KeyInputManager.instance.Ls(this.domElement,this.gd,v.a.Lh)}}Object(c.a)(jb,"TaskPaneButton",Va.a,[427]);class Ib extends G.a{constructor(Ub,
Ac,Ic,dd){super(Ub);this.animationManager=this.d6=this.Ee=null;this.gM=this.SVa=!1;this.p7d=0;this.jb=null;this.FMc=!1;this.htmlSanitizationHelper=null;this.Rz=()=>{this.vmi||(this.kA(),this.$.af())};this.KBd=(Ud,Hd)=>{this.onButtonClick(Ud,Hd)};this.D6=()=>{this.XCc()};this.$=Ac;this.htmlSanitizationHelper=dd;wa.a(this.$).ai(this);this.$.Cb.Vf(this.D6);this.configuration=Ic;this.baseName=oa.HelperMethods.awa(this.domElement,this.configuration.Jbg||this.configuration.f1);this.u$b={};this.pfb=[];this.hu=
[];this.sqb={};this.hle=document.getElementById(this.baseName+this.configuration.QXd);this.XO||r.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.QXd} not found`);this.BCg=document.getElementById(this.baseName+this.configuration.f1);this.iA||r.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.f1} not found`);this.CCg=document.getElementById(this.baseName+this.configuration.YYd);
this.JL||r.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.YYd} not found`);Ub=String.format(Ib.AMj,this.baseName+this.configuration.sdg,this.baseName+Ib.DOb);S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.dk(this.JL,Ub):this.JL.innerHTML=Ub;this.D5d=document.getElementById(this.baseName+Ib.DOb);
this.qye||r.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ib.DOb} not found`);(this.rqb=document.getElementById(this.baseName+Ib.DOb))||r.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ib.DOb} not found`);this.Xrg=this.rHe(this.configuration.BDe,this.yDe);this.Wrg=this.JGe(this.configuration.zDe,K.a.instance.ga(1293),this.S4h,this.Y0a,!0);this.Rtg=this.rHe(this.configuration.kVe,this.iCh);this.Qtg=this.JGe(this.configuration.iVe,
K.a.instance.ga(1292),this.T4h,this.aKa,!1);da.DOMElementExtensions.setVisible(this.aKa,!1);A.a.instance.ta(z.a.click,this.X0a,Object(V.a)(this,this.soc,"onCollapseIconClicked"));A.a.instance.ta(z.a.click,this.$Ja,Object(V.a)(this,this.Joc,"onExpandIconClicked"));A.a.instance.ta(z.a.click,this.Y0a,Object(V.a)(this,this.soc,"onCollapseIconClicked"));A.a.instance.ta(z.a.click,this.aKa,Object(V.a)(this,this.Joc,"onExpandIconClicked"));x.KeyInputManager.instance.ta(z.a.Pb,this.X0a,Object(V.a)(this,this.Bzf,
"onCollapseIconKeyDown"));x.KeyInputManager.instance.ta(z.a.Pb,this.$Ja,Object(V.a)(this,this.eBf,"onExpandIconKeyDown"))}ME(Ub){this.addHandler(Ib.Ugb,Ub);Ub(this,new yb(this.isVisible,da.DOMElementExtensions.isVisible(this.JL)))}kG(Ub){this.removeHandler(Ib.Ugb,Ub)}get JL(){return this.CCg}get mc(){return this.JL}get Gf(){return this.SVa}set Gf(Ub){this.SVa=Ub}get iA(){return this.BCg}get de(){return X.a.zIi}get XO(){return this.hle}get YB(){return this.hu}get oh(){return this.Ee}get TM(){return null}get Sga(){return null}get isCollapsed(){return this.gM}get w6c(){return this.p7d}get $(){return this.jb}set $(Ub){this.jb=
Ub}get qye(){return this.D5d}get X0a(){return this.Wrg}get $Ja(){return this.Qtg}get Y0a(){return this.Xrg}get aKa(){return this.Rtg}get vmi(){return this.FMc}get T4h(){return this.configuration.ADe}get S4h(){return this.configuration.jVe}usb(Ub,Ac,Ic,dd,Ud){let Hd=Ub.za(Ac);Hd||(Hd=Ob.a(Jb.a,Ic,Ub,Ac),Hd.SetScriptLoadFlavor(Ud));dd&&Hd.sWc(dd);const me=""+Ac;me in this.u$b||Hd.Y_b((vd,Qe)=>{this.L6(Qe)});let xe=null;const Ke=()=>{Hd.create();xe()};this.u$b[me]=xe=()=>{Hd.kuc(Ke);delete this.u$b[me]};
Hd.A_b(Ke)}dispose(){if(this.hu)for(let Ac=0,Ic=this.hu.length;Ac<Ic;Ac++)this.hu[Ac].aUf(this.KBd),this.hu[Ac].dispose();const Ub=this.u$b;for(let Ac in Ub)({key:Ac,value:Ub[Ac]}).value();this.$.ea&&this.$.Cb&&this.$.Cb.Dg(this.D6);this.rqb=this.D5d=this.hle=this.Ee=this.sqb=this.pfb=this.hu=null;A.a.instance.Ba(z.a.click,this.X0a,Object(V.a)(this,this.soc,"onCollapseIconClicked"));A.a.instance.Ba(z.a.click,this.$Ja,Object(V.a)(this,this.Joc,"onExpandIconClicked"));A.a.instance.Ba(z.a.click,this.Y0a,
Object(V.a)(this,this.soc,"onCollapseIconClicked"));A.a.instance.Ba(z.a.click,this.aKa,Object(V.a)(this,this.Joc,"onExpandIconClicked"));x.KeyInputManager.instance.Ba(z.a.Pb,this.X0a,Object(V.a)(this,this.Bzf,"onCollapseIconKeyDown"));x.KeyInputManager.instance.Ba(z.a.Pb,this.$Ja,Object(V.a)(this,this.eBf,"onExpandIconKeyDown"));super.dispose()}kg(Ub,Ac){if(Ac)return!1;this.Ee&&!this.isCollapsed?(Ub=this.oh.taskPane,Ub.Gf&&Ub.kg(!0,!1)||da.DOMElementExtensions.setFocus(this.oh.h0a)):da.DOMElementExtensions.setFocus(this.$Ja);
return!0}mh(Ub){return this.isVisible?da.DOMElementExtensions.yf(this.domElement,Ub)||da.DOMElementExtensions.yf(this.domElement,da.DOMElementExtensions.Twb(Ub)):!1}sj(){}Zj(){this.Ee&&this.Ee.taskPane.Zj()}setFocusOnToolbarFirstElement(){this.isCollapsed?da.DOMElementExtensions.setFocus(this.$Ja):da.DOMElementExtensions.setFocus(this.X0a)}bRd(){for(let Ub=this.hu.length-1;0<=Ub;Ub--)if(this.hu[Ub].isVisible){da.DOMElementExtensions.setFocus(this.hu[Ub].h0a);return}this.setFocusOnToolbarFirstElement()}Ixb(Ub){const Ac=
[];for(let Ic=this.hu.length-1;0<=Ic;Ic--)this.hu[Ic].taskPane.jh===Ub&&Ac.push(this.hu[Ic].taskPane);return Ac}Fed(Ub){const Ac=[];for(let Ic=0;Ic<this.hu.length;Ic++)this.hu[Ic].taskPane.jh===Ub&&Ac.push(this.hu[Ic]);return Ac}Epe(Ub){if(Ub){let Ac;const Ic=Object(l.a)(327,Ub);Ic?(Ac=new jb(this.htmlSanitizationHelper),Ac.domElement.id=this.baseName+"bt_"+Ub.jh.toString()+"_"+Ub.pf.InstanceId,this.rqb.appendChild(Ac.domElement),this.sqb["6"]=Ac,Ic.button=Ac):Ac=this.sqb[Ub.jh.toString()];Ac.mfi(Ub);
Ac.tJg(this.KBd);Ac.isVisible=Ub.lq();Ac.enabled=Ub.Ds();this.pfb.push(Ub);this.hu.push(Ac);Ib.MFi(Ub,this.XO);this.uqh(Ac);this.XCc()}}nG(Ub,Ac){let Ic;for(const dd of this.hu)Ic=dd.taskPane,Ic.jh===Ub.jh&&Ic==Ub&&this.o3b(dd,Ac)}zva(){r.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}X6(){r.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}W5b(){r.ULS.shipAssertTag(512291712,
11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){r.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){r.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){r.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}M7f(Ub,Ac){Ub?(this.FMc=!0,this.SRd(!1)):
(this.FMc=!1,this.SRd(!0),Ac&&(this.kA(),this.$.af()))}vN(Ub){if(!this.pfb.includes(Ub)){let Ic=null;Ic=()=>{this.pej(Ub);Ub.WR(Ic)};Ub.LP(Ic);this.Epe(Ub);var Ac=Object(l.a)(413,Ub);Ac&&(Ac.ME(this.Rz),this.Rz(Ac,Sys.EventArgs.Empty));if(Ac=Object(l.a)(167,Ub))Ac.ME(this.Rz),this.Rz(Ac,Sys.EventArgs.Empty);if(Ac=Object(l.a)(414,Ub))Ac.ME(this.Rz),this.Rz(Ac,Sys.EventArgs.Empty);this.raiseEvent(Ib.ZJf,null,Ub);this.kA()}}o3b(Ub,Ac){if(Ub.taskPane.Ds()&&Ub.taskPane.lq()){if(this.Ee){this.Ee.domElement.classList.remove(Ib.ynb);
this.Ee.taskPane.isVisible=!1;if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Ic=Object(l.a)(327,this.Ee.taskPane);Ic&&Ic.wj.dLd(Ic.pf.InstanceId)}this.d6=this.Ee}this.Ee=Ub;this.Ee.taskPane.isVisible=!0;this.Ee.domElement.classList.add(Ib.ynb);Ac&&this.aja(!1,!1);this.Bgb()}}onButtonClick(Ub){let Ac=!1;if(this.Ee!==Ub){Ac=!0;const Ic=Ub.taskPane.mc;this.animationManager.h4i(Ic);if(this.Ee){if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const dd=
Object(l.a)(327,this.Ee.taskPane);dd&&dd.wj.dLd(dd.pf.InstanceId)}this.Ee.taskPane.isVisible=!1;this.Ee.domElement.classList.remove(Ib.ynb)}this.d6=this.Ee;this.Ee=Ub;this.Ee.domElement.classList.add(Ib.ynb);this.Ee.taskPane.isVisible=!0;this.Bgb();this.animationManager.$Bh(Ic)}this.aja(!(this.isCollapsed||Ac),!1)}Bgb(){const Ub=this.w6c;let Ac=0;this.Ee&&(Ac=this.Ee.taskPane.vq?this.Ee.taskPane.vq:this.Ee.taskPane.Kp);Ac!==Ub&&(this.p7d=Ac,this.isCollapsed||(this.animationManager&&this.Ee?this.animationManager.D0b(this.iA,
Ub,Ac,this.oh.taskPane):this.iA.style.width=oa.HelperMethods.uc(Ac)),this.yRa(),this.raiseEvent(Ib.c9f,null,this))}RM(Ub){const Ac=new jb(this.htmlSanitizationHelper);Ac.isVisible=!1;Ac.domElement.id=this.baseName+"bt_"+Ub.toString();this.rqb.appendChild(Ac.domElement);this.sqb[Ub.toString()]=Ac}XCc(){if(void 0!==this.hu&&null!==this.hu){void 0===this.Ee||null===this.Ee||this.Ee.taskPane.Ds()||(this.Ee.domElement.classList.remove(Ib.ynb),this.Ee.taskPane.isVisible=!1,this.Ee.taskPane.lq()&&(this.d6=
this.Ee),this.Ee=null);var Ub=null;for(let Ac=0;Ac<this.hu.length;Ac++)if(this.pfb[Ac].lq()){const Ic=this.pfb[Ac].Ds();(this.hu[Ac].enabled=Ic)&&!Ub&&(Ub=this.hu[Ac])}void 0!==this.Ee&&null!==this.Ee||!Ub||(void 0!==this.d6&&null!==this.d6&&this.d6.taskPane.Ds()&&this.d6.taskPane.lq()?this.o3b(this.d6,!1):this.o3b(Ub,!1));void 0!==za.a(this.$)&&null!==za.a(this.$)&&za.a(this.$).isVisible&&void 0!==this.Ee&&null!==this.Ee&&1!==this.Ee.taskPane.jh&&(za.a(this.$).isVisible=!1);void 0!==this.Ee&&null!==
this.Ee&&7!==this.Ee.taskPane.jh&&(Ub=this.$.da.za(52),null===Ub||void 0===Ub?0:Ub.isVisible)&&(Ub.isVisible=!1);void 0!==this.Ee&&null!==this.Ee&&8!==this.Ee.taskPane.jh&&(Ub=this.$.da.za(233))&&(Ub.isVisible=!1);void 0!==this.Ee&&null!==this.Ee&&9!==this.Ee.taskPane.jh&&(Ub=this.$.da.za(248))&&(Ub.isVisible=!1);S.EwaSettings.ma(292)&&void 0!==this.Ee&&null!==this.Ee&&12!==this.Ee.taskPane.jh&&(Ub=this.$.da.za(302))&&(Ub.isVisible=!1);S.EwaSettings.ma(476)&&void 0!==this.Ee&&null!==this.Ee&&15!==
this.Ee.taskPane.jh&&(Ub=this.$.da.za(365))&&(Ub.isVisible=!1);W.a.ytd(this.$)&&void 0!==this.Ee&&null!==this.Ee&&13!==this.Ee.taskPane.jh&&(Ub=this.$.da.za(334))&&(Ub.isVisible=!1);void 0!==this.Ee&&null!==this.Ee&&14!==this.Ee.taskPane.jh&&(Ub=this.$.da.za(346))&&(Ub.isVisible=!1);void 0!==this.Ee&&null!==this.Ee&&16!==this.Ee.taskPane.jh&&(Ub=this.$.da.za(371))&&(Ub.isVisible=!1);S.EwaSettings.Uic()&&void 0!==this.Ee&&null!==this.Ee&&17!==this.Ee.taskPane.jh&&(Ub=this.$.da.za(408))&&(Ub.isVisible=
!1);S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&void 0!==this.Ee&&null!==this.Ee&&18!==this.Ee.taskPane.jh&&(Ub=this.$.da.za(415))&&(Ub.isVisible=!1);this.Bgb()}}BEh(Ub,Ac){da.DOMElementExtensions.setVisible(this.Y0a,!Ub);da.DOMElementExtensions.setVisible(this.aKa,Ub);Ub&&this.raiseEvent(Ib.DDe,null,this);this.Bgb();Ac&&da.DOMElementExtensions.setFocus(Ub?this.$Ja:this.X0a)}mec(Ub,Ac){this.$.Xc(Ub,Ac,26,null)}L6(Ub){Ub.HO&&this.vN(Ub.HO)}pej(Ub){if(Ub){const Ac=
this.hu.length;let Ic=!1;for(let dd=0;dd<Ac;dd++){const Ud=this.hu[dd];if(Ud.taskPane===Ub){this.rqb.removeChild(Ud.h0a);delete this.sqb[Ub.jh.toString()];Array.remove(this.pfb,Ub);Array.remove(this.hu,Ud);Ud.aUf(this.KBd);Ud.taskPane.mc.parentNode.removeChild(Ud.taskPane.mc);this.Ee&&this.Ee.taskPane===Ud.taskPane&&(this.Ee=null);this.d6&&this.d6.taskPane===Ud.taskPane&&(this.d6=null);Ic=!0;break}}Ic&&this.XCc()}}uqh(Ub){const Ac=Ub.taskPane.jh,Ic=!!this.Ee&&1===this.Ee.taskPane.jh;(1===Ac||!Ic&&
2===Ac)&&this.o3b(Ub,!1)}static MFi(Ub,Ac){const Ic=Ub.mc;Ic.parentNode&&Ic.parentNode.removeChild(Ic);Ac.appendChild(Ic);Ub.isVisible=!1}JGe(Ub,Ac,Ic,dd,Ud){const Hd=document.createElement("a");Hd.setAttribute(H.a.JY,Ud?H.a.Bk:H.a.xr);Hd.setAttribute(H.a.Ld,H.a.ot);Hd.tabIndex=0;Hd.classList.add(pa.a.qv);Hd.classList.add(Ub);Hd.classList.add(C.a.mvh);Ub=String.format(Ib.F1g,Ac,Ic,d.a.we(10));S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?
this.htmlSanitizationHelper.dk(Hd,Ub):Hd.innerHTML=Ub;dd.appendChild(Hd);return Hd}}Ib.Ugb="tpVisibility";Ib.AMj=`<div id='{0}' class='${C.a.svh}'><div id='{1}' class='${C.a.rvh}'></div></div>`;Ib.F1g="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Ib.DOb="novTaskpaneButtonGroup";Ib.ynb=C.a.ovh;Ib.c9f="tpSizeChanged";Ib.DDe="tpCollapsed";Ib.ZJf="tpAdded";Object(c.a)(Ib,"TaskPaneControl",G.a,[366,36,2]);var dc=a(49),ob=a(368),Fa=a(706);class Ab{constructor(){this.jVe=this.ADe=this.iVe=this.zDe=
this.kVe=this.BDe=this.sdg=this.YYd=this.QXd=this.f1=this.Jbg=null}}Object(c.a)(Ab,"Configuration",null,[]);a(430);var $b=a(295);class Cb extends $b.a{constructor(Ub){super(5,Ub)}}Object(c.a)(Cb,"ResizeAnimationEvent",$b.a,[]);var Rb=a(474),uc=a(585),nb=a(100);class Fb{constructor(Ub,Ac){this.Kbg=null;this.$=Ac;this.taskPane=Ub}SBh(){this.Kbg=da.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Eb+H.a.RAd);const Ub=Fb.W5c(this.taskPane),Ac=Fb.W5c(this.Kbg),Ic=uc.a(nb.a.Tl);Ic.animate(Ub,
H.a.uyc);Ic.animate(Ac,H.a.uyc)}h4i(Ub){Ub.style.opacity="0"}$Bh(Ub){uc.a(nb.a.Tl).animate(Fb.W5c(Ub),H.a.uyc)}D0b(Ub,Ac,Ic,dd){Ac||(dd.isVisible=!0);this.$.yRa(Ic);uc.a(nb.a.Tl).animate(Fb.Ndh(Ub,Ac,Ic),H.a.uyc,null,null,()=>{this.$.JAa();Ic||1===dd.jh||(dd.isVisible=!1);dd.FR(Ic<Ac)})}static Ndh(Ub,Ac,Ic){Ub=new Cb(Ub);Ub.OOg(Ac,Ic);return Ub}static W5c(Ub){Ub=new Rb.a(Ub);Ub.IJ(0,1);return Ub}}Object(c.a)(Fb,"TaskPaneAnimationManager",null,[387]);const Jc=`<div id="{0}" class="${C.a.wvh}" runat="server"></div></div><div id="{1}" class="${C.a.vvh} ${C.a.Bo}" runat="server"></div>`,
Fc=`<button type="button" id="{0}" class="${C.a.tvh}"></button><span><div id="{1}" class="${C.a.uvh}"></div></span>`,zb=C.a.gvh;class hb extends Ib{constructor(Ub,Ac,Ic,dd){super(Ub,Ic,hb.E$g(),dd);this.Sqc=null;this.Usd=!1;this.vS=null;this.GTi=Ud=>{var Hd=!1;if(9===Ud.Ca.keyCode){Hd=this.oh.taskPane.TQ(Ud,this.JL);if(!Hd){Hd=this.$.da.za(52);var me=this.domElement.querySelectorAll(this.oh.taskPane===Hd?Hd.Gr:ob.a.r_i);Hd=da.DOMElementExtensions.um(me);me=da.DOMElementExtensions.nB(me);Hd=da.DOMElementExtensions.kBa(Ud.Ca,
Hd,me)}return Hd}me=Pa.FocusManager.instance().gi;if(null===me||void 0===me?0:me.IN)return Hd;27===Ud.Ca.keyCode&&this.oh.taskPane.wg(!1);return Hd};this.dd=()=>{this.JL.style.bottom=this.iA.style.bottom=this.$.qd&4&&!D.AFrameworkApplication.sa.Pa.Ye?oa.HelperMethods.uc(this.$.tea):"0";this.kA()};this.QFf=Ud=>{Object(Ya.a)(327,this.oh.taskPane)&&(this.oh.taskPane.VGa.firstChild.style[H.a.pointerEvents]="none");this.Usd=!0;this.vS=this.dxb(Ud.clientPoint);Ha.a.instance.ta(z.a.Zf,this.domElement.ownerDocument.body,
this.Npc);Ha.a.instance.ta(z.a.xe,this.domElement.ownerDocument.body,this.Opc);tb.a.instance.ta(z.a.Jj,this.domElement.ownerDocument.body,this.Npc);tb.a.instance.ta(z.a.Qf,this.domElement.ownerDocument.body,this.Opc);return!0};this.Opc=()=>{Object(Ya.a)(327,this.oh.taskPane)&&(this.oh.taskPane.VGa.firstChild.style[H.a.pointerEvents]="");this.Usd=!1;Ha.a.instance.Ba(z.a.Zf,this.domElement.ownerDocument.body,this.Npc);Ha.a.instance.Ba(z.a.xe,this.domElement.ownerDocument.body,this.Opc);tb.a.instance.Ba(z.a.Jj,
this.domElement.ownerDocument.body,this.Npc);tb.a.instance.Ba(z.a.Qf,this.domElement.ownerDocument.body,this.Opc);return!0};this.Npc=Ud=>{this.Usd&&(Ud=this.dxb(Ud.clientPoint),Ud=Fa.a.gE(Ud,this.vS),this.Xse(Ud.x));return!0};this.FUi=Ud=>{void 0!==Ud.Ca&&null!==Ud.Ca&&(9===Ud.Ca.keyCode?Ud.Ca.shiftKey?(Ud=Object(Ya.a)(36,this.oh.taskPane)?this.oh.taskPane:null)&&Ud.kg(!1,!1):this.setFocusOnToolbarFirstElement():37!==Ud.Ca.keyCode&&39!==Ud.Ca.keyCode||this.Xse(37===Ud.Ca.keyCode?-20:20));return!0};
this.$.domElement.classList.add(zb);this.Ibg=Ac;this.initialize();x.KeyInputManager.instance.ta(z.a.Pb,this.domElement,this.GTi);this.FOb=da.DOMElementExtensions.getElementById(Ac.parentNode,this.$.Eb+H.a.znc);this.kBc=da.DOMElementExtensions.getElementById(Ac.parentNode,this.$.Eb+H.a.Mwf);this.FOb.title=K.a.instance.ga(2227);Ha.a.instance.ta(z.a.Ef,this.kBc,this.QFf);tb.a.instance.ta(z.a.pointerDown,this.kBc,this.QFf);x.KeyInputManager.instance.ta(z.a.Pb,this.FOb,this.FUi)}get de(){return X.a.fBc}get yDe(){return this.JL}get iCh(){return this.yDe}Bgb(){super.Bgb();
this.FOb&&(this.oh&&this.oh.taskPane.isResizable?(this.FOb.style.display="block",this.kBc.style.display="block"):(this.FOb.style.display="none",this.kBc.style.display="none"))}get UBc(){const Ub=this.JL;return Ub&&da.DOMElementExtensions.isVisible(Ub)?ob.a.UBc:0}NWf(Ub){Ub&&(this.animationManager=Ub);this.Cjj();this.animationManager=Ub||new Fb(this.iA,this.$);this.animationManager.SBh()}dispose(){this.Sqc&&this.Sqc.kG(this.Rz);za.a(this.$)&&za.a(this.$).kG(this.Rz);const Ub=this.$.da.za(52);Ub&&Ub.kG(this.Rz);
this.$.Jl(this.dd);h.a.qc([this.Sqc]);this.Sqc=null;super.dispose()}initialize(){this.NWf(null);this.RM(0);this.RM(1);this.RM(2);this.RM(7);this.RM(8);this.RM(9);this.RM(10);S.EwaSettings.ma(292)&&this.RM(12);S.EwaSettings.ma(476)&&this.RM(15);S.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.RM(13):W.a.ytd(this.$)&&this.RM(13);this.RM(14);this.RM(16);S.EwaSettings.Uic()&&this.RM(17);S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)&&this.RM(18);this.kA()}kA(){var Ub=0;let Ac=0;for(let Ic=this.YB.length-1;0<=Ic;Ic--){const dd=this.YB[Ic].taskPane.lq(),Ud=this.YB[Ic].taskPane;if(this.YB[Ic].isVisible=dd)Ac++,(1!==Ud.jh&&(S.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Ud.jh)&&14!==Ud.jh&&16!==Ud.jh||Ud.Ds())&&Ub++}Ub=0<Ub;da.DOMElementExtensions.setVisible(this.JL,Ub);this.SRd(Ub);da.DOMElementExtensions.setVisible(this.aKa,Ub&&this.isCollapsed);da.DOMElementExtensions.setVisible(this.Y0a,
Ub&&!this.isCollapsed);da.DOMElementExtensions.setVisible(this.qye,1<Ac);this.XCc()}aja(Ub,Ac){if(this.isCollapsed!==Ub){Ub||(this.Ibg.style.display=D.AFrameworkApplication.sa.Pa.Ye?"flex":"block");var Ic=this.w6c;this.gM=!this.isCollapsed;var dd=Ub?Ic:0;Ic=Ub?0:Ic;this.oh&&(this.animationManager.D0b(this.iA,dd,Ic,this.oh.taskPane),this.yRa());Ub&&(this.Ibg.style.display="none");this.BEh(Ub,Ac)}}SRd(Ub){const Ac=this.isVisible!==Ub;this.Gf=Ub;da.DOMElementExtensions.setVisible(this.domElement,Ub);
Ac&&(D.AFrameworkApplication.sa.Pa.Ye&&da.DOMElementExtensions.toggleCssClass(this.domElement,C.a.Wuh,Ub),this.yRa(),this.raiseEvent(Ib.Ugb,new yb(Ub,Ub),this))}soc(Ub){if(Ub.Gb===this.Y0a&&3!==Ub.tb)return!1;this.mec(296943390,Ub.tb);this.aja(!0,!0);return!0}Joc(Ub){if(Ub.Gb===this.aKa&&3!==Ub.tb)return!1;this.mec(-625072140,Ub.tb);this.aja(!1,!0);return!0}Bzf(Ub){return 13===Ub.Ca.keyCode?(this.mec(296943390,Ub.tb),this.aja(!0,!0),!0):!1}eBf(Ub){return 13===Ub.Ca.keyCode?(this.mec(-625072140,Ub.tb),
this.aja(!1,!0),!0):!1}yRa(){let Ub=0;this.$.qd&262144&&(Ub+=this.UBc,da.DOMElementExtensions.isVisible(this.iA)&&!this.isCollapsed&&(Ub+=this.w6c));this.$.yRa(Ub)}rHe(Ub,Ac){const Ic=document.createElement("div");Ic.classList.add(Ub);Ac.insertBefore(Ic,Ac.firstChild);return Ic}Cjj(){const Ub=this.domElement;let Ac=document.getElementById(this.$.Eb+H.a.Q0a);D.AFrameworkApplication.sa.Pa.Ye&&(Ac=document.getElementById("FarPaneRegion"));Ub.parentNode&&Ub.parentNode!==Ac&&Ub.parentNode.removeChild(Ub);
Ac.appendChild(Ub);this.p8h()}p8h(){const Ub=this.iA,Ac=this.JL,Ic=this.$.ea;Ub.style.right="0";D.AFrameworkApplication.sa.Pa.Ye||(Ub.style.marginRight=oa.HelperMethods.uc(ob.a.UBc));Ub.style.bottom=this.$.qd&4&&!D.AFrameworkApplication.sa.Pa.Ye?oa.HelperMethods.uc(this.$.tea):"0";this.XO.style.bottom="0";Ac.style.right="0";this.$.ml(this.dd);Ic.fI&&this.dd(null,null)}dxb(Ub){const Ac=new dc.a(0,0);return Fa.a.Us(Ac,this.iA,Ub,!1)}Xse(Ub){const Ac=this.iA.offsetWidth;Ub=Ac-Ub;Ub<this.oh.taskPane.Kp?
Ub=this.oh.taskPane.Kp:950<Ub&&(Ub=950);this.oh.taskPane.vq=Ub;const Ic=new Fb(this.iA,this.$);Ic.D0b(this.iA,Ac,Ub,this.oh.taskPane);Object(Ya.a)(327,this.oh.taskPane)||Ic.D0b(this.oh.taskPane.mc,Ac,Ub,this.oh.taskPane);this.$.yRa(this.JL.offsetWidth+Ub);this.$.hAa(fb.a.RZ("AnimateTaskpaneResize"))}static ka(Ub,Ac){let Ic=null;Ub.Jb&&(Ic=Ub.Jb.Pg("ComponentAttach","AttachTaskPanePickerControl"),Ic.start());const dd=hb.eXg(Ub.Eb),Ud=hb.dXg(Ub.Eb,Ac),Hd=hb.fXg(Ub.Eb);dd.appendChild(Hd);dd.appendChild(Ud);
hb.KRg(Ub,dd);Ub=new hb(dd,Ud,Ub,Ac);Ic&&Ic.stop();return Ub}static eXg(Ub){const Ac=document.createElement("div");Ac.id=Ub+H.a.gBc;return Ac}static dXg(Ub,Ac){const Ic=document.createElement("div");Ic.id=Ub+H.a.Lwf;Ic.className=C.a.hvh;let dd=String.format(Jc,Ub+H.a.xIi,Ub+H.a.xR);dd+=String.format(Fc,Ub+H.a.znc,Ub+H.a.Mwf);S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?Ac.dk(Ic,dd):
Ic.innerHTML=dd;D.AFrameworkApplication.sa.Pa.Ye&&da.DOMElementExtensions.toggleCssClass(Ic,C.a.tAa,!0);return Ic}static fXg(Ub){const Ac=document.createElement("div");Ac.id=Ub+H.a.RAd;Ac.className=C.a.dxh;Ac.style.zIndex="100";D.AFrameworkApplication.sa.Pa.Ye&&da.DOMElementExtensions.toggleCssClass(Ac,C.a.tAa,!0);return Ac}static KRg(Ub,Ac){(D.AFrameworkApplication.sa.Pa.Ye?document.getElementById("FarPaneRegion"):document.getElementById(Ub.Eb+H.a.Q0a)).appendChild(Ac)}static E$g(){const Ub=new Ab;
Ub.Jbg=H.a.gBc;Ub.f1=H.a.Lwf;Ub.QXd=H.a.xR;Ub.YYd=H.a.RAd;Ub.sdg=H.a.yIi;Ub.BDe=C.a.jvh;Ub.kVe=C.a.lvh;Ub.zDe=C.a.ivh;Ub.iVe=C.a.kvh;Ub.ADe=C.a.QTe;Ub.jVe=C.a.RTe;return Ub}}Object(c.a)(hb,"TaskPanePickerControl",Ib,[]);class Pb extends w.a{constructor(Ub){super();this.$=Ub;this.Fb()}create(){if(W.a.fd(this.$))this.ob(va.ka(this.$));else if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")){const Ub=
Ka.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya);y.TaskExtensions.Aa(Ub,()=>{this.ob(hb.ka(this.$,Ub.result))},this.la,3)}else this.ob(hb.ka(this.$,null))}static ka(Ub){Ub.da.Ga(50,new Pb(Ub))}}Object(c.a)(Pb,"TaskPaneManagerFactory",w.a,[]);class ud extends e.a{constructor(Ub){super(Ub);this.Qt=()=>{this.$.ea.UR(this.Qt);this.zIe()};this.$=Ub}zIe(){const Ub=this.$.da;Ub.Ga(72,new Vb(this.$));Ub.Ga(77,new aa(this.$));Pb.ka(this.$);Y.ka(this.$)}static main(){f.a.Fa(Ub=>{b.a.Hcf(Ub.domElement.ownerDocument,
d.a.current.fo(97),()=>{Ub.GI()});const Ac=new ud(Ub);Ub.ea.Ev?Ac.zIe():Ub.ea.MT(Ac.Qt)})}}Object(c.a)(ud,"TaskPaneSliceBootstrapper",e.a,[]);Type.registerNamespace("_Ewa");ud.main();Type.registerNamespace("CommandUI.TaskPane")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tp.js.map/3aaec098de8b789ce401af8f9d40a4ce/EwaDSEsNext.tp.js.map