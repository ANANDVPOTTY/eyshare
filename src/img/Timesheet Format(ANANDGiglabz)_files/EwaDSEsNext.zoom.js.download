'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[26],{1131:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1452:function(u,E,a){a.r(E);var c=a(9);u=a(0);var b=a(692),e=a(15),f=a(824),d=a(8),h=a(76),m=a(183),l=a(372),w=a(34),n=a(55);class y{constructor(K){this.$=K}nc(){return!1}executeCommand(K,ea,ya){let ha=!1;K=ea.command;const La=w.a(this.$);11!==ea.$e&&7!==ea.$e&&6!==ea.$e&&2!==ea.$e&&14!==ea.$e&&15!==ea.$e&&16!==ea.$e&&e.ULS.sendTraceTag(537149787,0,15,`ZoomCommandHandler.ExecuteCommand - unsupported zoom origin ${ea.$e}`);const Ia=6===ea.$e;switch(ea.command){case -1365094462:case -1441674458:La.hFc(Math.floor(10*
La.zoom)/10+.1,Ia);ha=!0;break;case 1056010365:case 1664364901:La.hFc(Math.ceil(10*La.zoom)/10-.1,Ia);ha=!0;break;case 346087880:La.hFc(d.a.a0,Ia);ha=!0;break;case -1918142559:case 1517993347:h.a.Jc in ya?(ya=parseFloat(ya[h.a.Jc]),ya!==La.zoom&&La.gFc(ya,1517993347===ea.command),ha=!0):e.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:ea=parseFloat(ya[f.a.Value]);isNaN(ea)||La.gFc(ea/100,!0);ha=!0;break;case 1409187195:La.zoomFitToScreen();
ha=!0;break;case -1836771825:La.zoomFitToScreenUndo(),ha=!0}return ha?n.Task.Ta(!0):m.a(K)}wc(K,ea){switch(ea.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return w.a(this.$).GX();case -1365094462:case 1056010365:case -2096586688:return l.a(this.$);default:return!1}}Kc(){return!1}}Object(u.a)(y,"ZoomCommandHandler",null,[223]);class t extends b.a{constructor(K){super(K)}ld(){this.Yc([new y(this.$)])}static ka(K){b.a.Nd(370,
new t(K))}}Object(u.a)(t,"ZoomCommandHandlerFactory",b.a,[]);E=a(222);var r=a(87),v=a(27),B=a(82),A=a(544),z=a(49),x=a(5),D=a(161),J=a(64),L=a(292),T=a(132),O=a(42),G=a(33),C=a(12),H=a(11),I=a(103),M=a(21),Q=a(308),U=a(133);class N{constructor(K){this.y6a=this.bgc=0;this.i3b=null;this.Bhf=!1;this.$=K;this.Bhf=K.Wjc}gmi(){return M.h(this.$).eb?(e.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.rb.uy?(e.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}POi(K){this.i3b=new Sys.UI.Point(Math.round(K.Bva.center.x),Math.round(K.Bva.center.y));this.bgc=w.a(this.$).zoom;this.y6a=K.Bva.scale;let ea={["InitialZoom"]:this.bgc,["Location"]:"canvas",["InputMethod"]:K.tb};U.b(this.$).ud(T.a.p1i,ea);e.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.i3b.x},${this.i3b.y}), initial zoom ${this.bgc}, initial scale ${this.y6a}`);
this.H9a(K,"onGestureStart");return!0}OOi(K){if(!this.y6a)return e.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.H9a(K,"OnGestureEvent"),!0;if(!isFinite(this.y6a))return e.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.y6a}`),this.H9a(K,"OnGestureEvent"),!0;const ea=K.Bva.scale/this.y6a*this.bgc;w.a(this.$).Llg(ea,this.i3b);e.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${ea}. Current scale ${K.Bva.scale}`);this.H9a(K,"OnGestureEvent");return!0}NOi(K){w.a(this.$).Mlg();e.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.H9a(K,"OnGestureEnd")}MOi(K){e.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.H9a(K,"OnGestureCancel")}H9a(K,ea){var ya,ha,La;this.Bhf&&(e.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${ea},        eventArgs non-null: ${isNullOrUndefined(K)}, gestureData non-null: ${isNullOrUndefined(null===
K||void 0===K?void 0:K.Bva)},        srcEvent non-null: ${isNullOrUndefined(null===(ya=null===K||void 0===K?void 0:K.Bva)||void 0===ya?void 0:ya.srcEvent)}`),null===(La=null===(ha=null===K||void 0===K?void 0:K.Bva)||void 0===ha?void 0:ha.srcEvent)||void 0===La?void 0:La.preventDefault())}}Object(u.a)(N,"PinchToZoomAdapter",null,[416]);var W=a(38);class X extends W.a{constructor(){super()}Jre(K){this.addHandler("ZCIEK",K)}kVf(K){this.removeHandler("ZCIEK",K)}Ire(K){this.addHandler("ZCUIK",K)}jVf(K){this.removeHandler("ZCUIK",
K)}YMg(K){this.addHandler("ZCEK",K)}Jhj(K){this.removeHandler("ZCEK",K)}H8i(){this.raiseEvent("ZCIEK")}G8i(){this.raiseEvent("ZCUIK")}I8i(){this.raiseEvent("ZCEK")}}Object(u.a)(X,"ZoomEventManager",W.a,[415]);var sa=a(22);class da extends W.a{constructor(K){super();this.statusBarManager=null;this.GYe=!1;this.$=K;this.$.da.$a(29,ea=>{this.statusBarManager=ea;ea.GJ(this)})}Lq(K){this.addHandler("Zoom",K)}fr(K){this.removeHandler("Zoom",K)}Oz(){this.Gn("QueryZoomStatus")&&this.raiseEvent("Zoom")}ns(K,
ea){return"QueryZoomStatus"!==K?!1:this.G7h(ea)}Gn(){return w.a(this.$).GX()}dispose(){this.statusBarManager&&(this.statusBarManager.iG(this),this.statusBarManager=null);this.$=null;super.dispose()}W7e(K){K=this.f4h(K);if(!K)return null;K=K.getElementsByClassName("cui-ctl-mediumlabel");return 1!==K.length?(e.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):K[0]}G7h(K){if(!this.$)return!1;const ea=w.a(this.$).mRb,ya=this.W7e("HandleQueryZoomStatusCommand");
ya?sa.a.equals(K.LabelText.toString(),ea,!1)||(ya.innerText="",this.r3f(K,ea)):this.r3f(K,ea);return!0}r3f(K,ea){K.LabelText=ea}f4h(K){var ea=C.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!ea)return ea=(ea=this.$.ea.dc)?ea.inEmbedView:!1,v.a.Dp||ea||e.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${K}`),null;this.GYe||(this.GYe=!0,e.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${K}`));
return ea}}Object(u.a)(da,"ZoomStatusBarManager",W.a,[2,211,212]);class S extends A.a{constructor(K){super(K);this.zoomEventManager=this.cya=this.ICb=null;this.NCb=-1;this.yhf=!1;this.Pc=()=>{this.NCb=-1};e.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.bhb=new da(K);this.q1i()&&(e.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.sRg());this.Qcj()}dispose(){this.bhb&&(r.a.Ia(this.bhb),this.bhb=null);this.zoomEventManager&&(this.$.da.BU(419),
this.zoomEventManager=null);this.yhf&&this.Vjh();super.dispose()}GX(){return!0}Llg(K,ea){K=this.mva(K);if(M.h(this.$).rtl){const ya=Math.round(C.DOMElementExtensions.getBounds(this.$.vf).width*w.a(this.$).zoom);this.ICb=new Sys.UI.Point(ya-ea.x,ea.y)}else this.ICb=ea;this.mBa(K,!1,"ZoomWithPinch")}fFc(){return!0}eFc(K,ea){var ya=v.a.isMac?.07:.15;K=this.zoom+(K?ya:-ya);K=this.mva(K);M.h(this.$).rtl?(ya=Math.round(C.DOMElementExtensions.getBounds(this.$.vf).width*w.a(this.$).zoom),this.cya=new Sys.UI.Point(ya-
ea.x,ea.y)):this.cya=ea;ea=this.zoom;this.mBa(K,!0,"ZoomWithMouse");ea={["InitialZoom"]:ea,["FinalZoom"]:K,["Location"]:"canvas"};U.b(this.$).ud(T.a.M2j,ea)}Mlg(){this.ICb=null}gFc(K,ea){this.mBa(this.mva(K),!1,ea?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}Nlg(K){isNaN(K)?e.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.mBa(this.mva(K),!1,"ZoomToLevelInExcelLive")}Olg(K){this.mBa(this.mva(K),!1,"ZoomWithActionPen")}hFc(K,
ea){this.mBa(this.mva(K),!0,ea?"ZoomWithShortcuts":"ZoomWithButtons")}R5e(K,ea){const ya=M.h(this.$).rtl,[ha,La]=this.phd(ya),[Ia,ra]=this.pjd(K,La);return this.cya?(K=this.Ygd(this.cya,K,ea,La,ha,"ZoomWithMouse"),this.cya=null,K):this.ICb?this.Ygd(this.ICb,K,ea,La,ha,"ZoomWithPinch"):M.h(this.$).ha.Sa.p_?this.L2j(K,ea,La,ha,Ia,ra,M.h(this.$).rtl):this.N2j(K,ea,La,ha,Ia,ra,M.h(this.$).rtl)}P_f(K,ea,ya){if(K){e.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${K.x} ${K.y}) (new top-left) from zoom:${ea} to zoom:${ya}`);
K=new z.a(K.x,K.y);ya=M.h(this.$).rtl;[,ya]=this.phd(ya);const [ha,La]=this.pjd(ea,ya);M.h(this.$).lse(K,ha,La,"ApplicationZoom")}else e.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${ea} to zoom:${ya}`)}zoomFitToScreen(){const K=this.zoom;var ea=M.h(this.$).rtl;const [ya,ha]=this.phd(ea),[La,Ia]=this.pjd(K,ha);var ra=M.h(this.$).ha.Sa.p_;(ea=ra?this.W1e(this.yab,La,Ia,!1):this.$5e(this.yab,ha,ya,La,Ia,ea,!1))?(ea=Math.min(La/(ea.width+100),Ia/(ea.height+100)),ea=this.iGh(ea),this.mBa(ea,
!0,"ZoomWithFitToScreen"),ra?M.h(this.$).ha.Sa.fta(M.h(this.$).ha.Sa.$b,!1):(ra=O.v(M.h(this.$).ha.ra.activeRange,this.$),M.h(this.$).Bg(ra,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.NCb=K,this.yhf||this.pRg()):e.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${ra}`)}zoomFitToScreenUndo(){this.mBa(this.NCb,!1,"ZoomWithFitToScreen")}UTd(){return-1!==this.NCb}pRg(){const K=M.h(this.$);K&&(K.ha.iH(this.Pc),K.AC(this.Pc))}Vjh(){const K=
M.h(this.$);K&&(K.ha.jG(this.Pc),K.ZD(this.Pc))}iGh(K){K=Math.min(K,d.a.YDi);K=Math.max(K,d.a.TEi);return Math.round(100*K)/100}mBa(K,ea,ya){if(this.cFc()){var ha=M.h(this.$).view.visibleArea.toString();K=this.mva(K);var La=J.d(this.$.xa.oa);La||(La=A.a.pwf);M.h(this.$).ji.X7(5,Q.a.bFc,ya);M.h(this.$).ji.Vla(Q.a.bFc,this.$.ea.ze);e.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${K} to sheet ${La} origin ${ya} prevZoom ${this.zoom}`);this.kyj(La,K);this.zoomEventManager.I8i();
this.FQj(ya);this.QQj(ea);this.NCb=-1;l.b(this.$,ya);K=M.h(this.$).view.visibleArea.toString();e.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${ha}, NewGridVisibleArea: ${K}, IsShyRibbonActive: ${this.$.x_}`)}}xPh(K){return(K=H.HelperMethods.oD(this.$.vf,this.$.domElement,K))?K:new Sys.UI.Point(0,0)}phd(K){const ea=this.xPh(K);K=this.hUh(ea,K);return[ea,K]}pjd(K,ea){const ya=C.DOMElementExtensions.getBounds(this.$.vf);return[Math.round((ya.width-ea.x)*K),Math.round((ya.height-
ea.y)*K)]}hUh(K,ea){ea=H.HelperMethods.oD(M.h(this.$).domElement,this.$.domElement,ea);return ea?(K=new Sys.UI.Point(Math.round(ea.x-K.x),Math.round(ea.y-K.y)),K):new Sys.UI.Point(0,0)}N2j(K,ea,ya,ha,La,Ia,ra){return(ra=this.$5e(K,ya,ha,La,Ia,ra))?this.R4e(ra,K,ea,ya,ha,La,Ia):null}$5e(K,ea,ya,ha,La,Ia,ra=!0){var pa=O.F(M.h(this.$).ha.ra.selectedRanges);if(ra&&(pa=pa.Ke(O.F(M.h(this.$).Gdc())),!pa))return e.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),
null;const ba=M.h(this.$).Sb(pa.topLeft);pa=M.h(this.$).Sb(pa.bottomRight);if(!ba||!pa)return e.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;K=ba.cell.XQ===pa.cell.XQ&&ba.cell.WQ===pa.cell.WQ?this.oOh(K,pa,ea,ya,ha,Ia):this.U2h(K,ba,pa,ea,ya,ha,Ia);return K?ra?this.AXe(K,ha,La):K:(e.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}AXe(K,ea,
ya){if(0>K.x||K.x>ea)K.x=0;if(0>K.y||K.y>ya)K.y=0;K.x+K.width>ea&&(K.width=ea-K.x);K.y+K.height>ya&&(K.height=ya-K.y);return K}U2h(K,ea,ya,ha,La,Ia,ra){ea=M.h(this.$).getCellBounds(ea.cell);if(!ea)return null;const pa=M.h(this.$).getCellBounds(ya.cell);if(!pa)return null;let ba=La.x;ra&&(ba=0,ea.x=Math.round(Ia/K)-ea.x-Math.round(ea.width),pa.x=Math.round(Ia/K)-pa.x-Math.round(pa.width));K=new Sys.UI.Bounds(Math.round((ea.x-ha.x)*K)-ba,Math.round((ea.y-ha.y)*K-La.y),Math.round((pa.x+pa.width-ea.x)*
K),Math.round((pa.y+pa.height-ea.y)*K));ya=ya.cell.getRange();e.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${ya.top}, b:${ya.bottom}, r:${ya.right}, l:${ya.left}) in bounds (${K.x}, ${K.y}, ${K.width}, ${K.height})`);return K}oOh(K,ea,ya,ha,La,Ia){const ra=M.h(this.$).getCellBounds(ea.cell);if(!ra)return null;let pa=ha.x;Ia&&(pa=0,ra.x=Math.round(La/K)-ra.x-Math.round(ra.width));K=new Sys.UI.Bounds(Math.round((ra.x-
ya.x)*K)-pa,Math.round((ra.y-ya.y)*K-ha.y),Math.round(ra.width*K),Math.round(ra.height*K));ea=ea.cell.getRange();e.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${ea.top}, l:${ea.left}) in bounds (${K.x}, ${K.y}, ${K.width}, ${K.height})`);return K}L2j(K,ea,ya,ha,La,Ia){const ra=this.W1e(K,La,Ia);return ra?this.R4e(ra,K,ea,ya,ha,La,Ia):null}R4e(K,ea,ya,ha,La,Ia,ra){K=new Sys.UI.Point(this.u5e(Ia,K.x,K.width),this.u5e(ra,K.y,K.height));
return this.Ygd(K,ea,ya,ha,La)}u5e(K,ea,ya){return K===ya?(e.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),K/2):K*ea/(K-ya)}W1e(K,ea,ya,ha=!0){const La=M.h(this.$).ha.Sa.$b.domElement;var Ia=H.HelperMethods.oD(La,M.h(this.$).domElement,M.h(this.$).rtl);if(!Ia)return e.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const ra=M.h(this.$).Lxb();
Ia=new Sys.UI.Point(Math.round((Ia.x-ra.topLeft.x)*K),Math.round((Ia.y-ra.topLeft.y)*K));K=new Sys.UI.Bounds(Ia.x,Ia.y,Math.round(La.offsetWidth*K),Math.round(La.offsetHeight*K));return ha?this.AXe(K,ea,ya):K}Kwf(){this.bhb.Oz()}uIi(K){"ZoomToLevelInExcelLive"===K?this.zoomEventManager.H8i():this.zoomEventManager.G8i()}Qcj(){this.zoomEventManager=this.$.da.Ga(419,new X)}Ygd(K,ea,ya,ha,La,Ia=""){var ra=M.h(this.$).rtl?0:La.x;La="ZoomWithPinch"===Ia||"ZoomWithMouse"===Ia?new Sys.UI.Point(K.x-ra-Math.round(ha.x*
ea),K.y-La.y-Math.round(ha.y*ea)):K;La=new Sys.UI.Point(Math.round(La.x/ea),Math.round(La.y/ea));e.ULS.shipAssertTag(537149770,0,!!ea,"Original zoom level must be different than 0");ra=ya/ea;La=new Sys.UI.Point(Math.round(La.x*(1-1/ra)),Math.round(La.y*(1-1/ra)));"ZoomWithMouse"===Ia||"ZoomWithPinch"===Ia?(La.x+=Math.round((ha.x-M.h(this.$).Nr)*(ra-1)),La.y+=Math.round((ha.y-M.h(this.$).RJ)*(ra-1))):(ra=Math.round(ha.x*(ya-ea)),0<ra&&La.x>ra&&(La.x+=ra),ea=Math.round(ha.y*(ya-ea)),0<ea&&La.y>ea&&
(La.y+=ea));"ZoomWithMouse"===Ia&&(K.x||(La.x=0),K.y||(La.y=0));K=M.h(this.$).Lxb();return new Sys.UI.Point(La.x+K.topLeft.x,La.y+K.topLeft.y)}sRg(){const K=[];B.a.instance.Ub("Common.IGestureInputManager").execute(ea=>{0===ea.GTh()&&ea.ubj(document.body,new N(this.$),K)})}q1i(){return this.cFc()&&(v.a.Bp&&v.a.jxa(67)||this.$.Wjc)}kyj(K,ea){l.a(this.$)?this.setZoomLevel(K,ea,this.R2d,d.a.JMf):this.setZoomLevel(K,ea,this.zoomPerSheetId,this.yab)}setZoomLevel(K,ea,ya,ha){ya.remove(K);ea!==ha&&ya.add(K,
ea)}FQj(K){this.g4f();this.$.hAa(L.a.RZ("TriggerImmediateZoomOperations"));this.OYj();this.uIi(K)}OYj(){this.Upi()?this.$.af():this.bhb.Oz();const K=this.bhb.W7e("UpdateZoomStatusBar");K&&(K.innerText=this.mRb)}Upi(){const K=D.a(this.$);return K?K.Em.cA===(G.a.Jxa(this.$)?x.a.Ysc:this.$.Eb+x.a.vYf):!1}QQj(K){M.h(this.$).K2j(K);this.HNg()}HNg(){const K=I.a(this.$);if(K)for(const ea of M.h(this.$).Ea.nD()){if(!ea){e.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");
continue}if(!ea.Qk)continue;const ya=ea.Mi;if(ya)for(let ha=0;ha<ya.count;ha++)if(2===ya.eg(ha).type){const La=K.Sq(ya.eg(ha).Mg());La?(La.Pea(!1),e.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):e.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else e.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(u.a)(S,
"ZoomManager",A.a,[]);class oa extends E.a{constructor(K){super();this.$=K;this.Fb()}create(){const K=new S(this.$);this.QYj(K);this.$.da.Ga(368,K);this.ob(K)}QYj(K){const ea=w.a(this.$);if(ea){var ya=ea.ujd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");K.bSd(ya);K.lwc(ea.OCc)}else e.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static ka(K){K.da.Ga(369,
new oa(K))}}Object(u.a)(oa,"ZoomManagerFactory",E.a,[]);a=a(1131);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(()=>{c.a.Fa(K=>{oa.ka(K);t.ka(K)})})();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.zoom.js.map/5d4297b4810c238c069e4ad24bfdedb8/EwaDSEsNext.zoom.js.map