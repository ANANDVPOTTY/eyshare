'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1161:function(u,E,a){u=a(0);var c=a(15),b=a(222),e=a(8),f=a(111);a(200);var d=a(187),h=a(83),m=a(176),l=a(184),w=a(64);class n{}n.local="Local";n.sNj="Thread";Object(u.a)(n,"RecalcServiceCreateMode",null,[]);var y=a(162);class t{constructor(aa){this.z6d=null;this.init(aa)}get O$(){return this.z6d}init(aa){this.z6d=new m.a;if(void 0!==aa&&null!==aa&&void 0!==aa.HeadersList&&null!==aa.HeadersList&&0<aa.HeadersList.length)for(const ja of aa.HeadersList)this.O$.ia(ja.Index,
ja.Name)}}Object(u.a)(t,"ColHeadersListData",null,[]);var r=a(1),v=a(33),B=a(99),A=a(22),z=a(21),x=a(173);class D{constructor(aa,ja){this.Pye=aa;this.sheetName=ja;this.axc=!1}}Object(u.a)(D,"CalcBlockInformation",null,[]);class J{constructor(aa,ja,Va,bb,wa){this.type=aa;this.fullName=ja;this.range=Va;this.sheetId=bb;this.attributes=wa;this.bF=null}}Object(u.a)(J,"CalcNamedObject",null,[]);class L{constructor(aa){this.Zig=aa;this.Pje=[];this.rgg=[];this.p0a={};this.PSd=new Map}get Qj(){return this.Pje}k4f(aa,
ja){this.Pje[aa]=ja;this.Zig&&ja.Q7&&this.PSd.set(ja.Q7.sheetName,aa)}getSheetIndex(aa){if(this.Zig){if(this.PSd.has(aa))return this.PSd.get(aa)}else for(let ja=1;ja<this.Qj.length;ja++)if(A.a.equals(this.Qj[ja].Q7.sheetName,aa,!1))return ja;return-1}}Object(u.a)(L,"GridCache",null,[]);var T=a(682),O=a(553);class G{constructor(aa){this.Q7=aa;this.v6=new T.a(O.a.Yj());this.enc=!1}}Object(u.a)(G,"SheetInformation",null,[]);var C=a(936),H;(function(aa){aa[aa.initialization=0]="initialization";aa[aa.contentReady=
1]="contentReady";aa[aa.cellEdit=2]="cellEdit"})(H||(H={}));Object(u.b)("UpdateDataTrigger",H);class I{constructor(aa){this.sJd=null;this.Lvd=this.rJd=this.CDd=!1;this.iHd=0;this.aHd=this.cHd=this.dHd=this.bHd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.hr=this.errorTypeNames=null;this.Pt=this.currentStateId=-1;this.Qta="";this.gaa=null;this.getNameLoc=(ja,Va)=>this.vic()?this.Xe.na(this.currentStateId).Qj[0].v6.mb(Va)?(ja=excelOnlineCalc.location.nameLoc(ja,
Va),excelOnlineCalc.util.success(ja)):excelOnlineCalc.util.success(null):(ja=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ja));this.getContainingTable=ja=>{if(!this.vic())return ja=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ja);const Va=ja.range.col,bb=ja.range.row;var wa=this.Xe.na(this.currentStateId).Qj[0].v6,ka=null;for(let ta of wa)if(wa=ta.value,2===wa.type&&A.a.equals(ja.sheet.index.toString(),wa.sheetId,!0)){const qa=wa.range;Va>=qa.left-1&&Va<=
qa.right-1&&bb<=qa.bottom-1&&bb>=qa.top-1&&(ka=excelOnlineCalc.location.nameScope(this.documentLoc,wa.sheetId),ka=excelOnlineCalc.location.nameLoc(ka,wa.fullName))}return ka?excelOnlineCalc.util.success(ka):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(ja,Va)=>{if(!this.vic()){var bb=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(bb)}bb=ja.name;var wa=this.Xe.na(this.currentStateId).Qj[0].v6;if(wa.mb(bb)){wa=wa.na(bb);const ta=wa.range;if(2!==wa.type)return excelOnlineCalc.util.failure(this.s5c(5));
const qa=wa.bF?wa.bF.O$:null;if(!qa)return excelOnlineCalc.util.success(null);for(var ka of qa)if(A.a.equals(ka.value,Va,!0))return ja=excelOnlineCalc.location.documentLoc(ja.scope.document.path,ja.scope.document.name),ja=excelOnlineCalc.location.sheetIndex(ja,wa.sheetId),ka=excelOnlineCalc.location.gridRange(ta.top-1,ka.key,ta.bottom-ta.top+1,1),ka=excelOnlineCalc.location.sheetGridRange(ja,ka),bb=excelOnlineCalc.location.structRefColumnLoc(bb,ka,!!(wa.attributes&16),!!(wa.attributes&8)),excelOnlineCalc.util.success(bb);
return ta.right-ta.left+1!==qa.count?(bb=excelOnlineCalc.util.unavailable([17,ja,Va]),excelOnlineCalc.util.failure(bb)):excelOnlineCalc.util.failure(this.s5c(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(ja,Va)=>{if(!this.vic())return Va=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Va);var bb=this.Xe.na(this.currentStateId).Qj[0].v6;if(bb.mb(ja.name)){var wa=bb.na(ja.name);if(2!==wa.type)return excelOnlineCalc.util.failure(this.s5c(5));bb=!!(wa.attributes&
16);const ka=!!(wa.attributes&8),ta=bb?1:0,qa=ka?1:0;ja=excelOnlineCalc.location.documentLoc(ja.scope.document.path,ja.scope.document.name);ja=excelOnlineCalc.location.sheetIndex(ja,wa.sheetId);wa=wa.range;let rb={};if(1===Va)rb=excelOnlineCalc.location.gridRange(wa.top-ta-1,wa.left-1,wa.bottom+qa-wa.top+ta+1,wa.right-wa.left+1);else if(2===Va)rb=excelOnlineCalc.location.gridRange(wa.top-1,wa.left-1,wa.bottom-wa.top+1,wa.right-wa.left+1);else if(3===Va)if(bb)rb=excelOnlineCalc.location.gridRange(wa.top-
2,wa.left-1,1,wa.right-wa.left+1);else return excelOnlineCalc.util.success(null);else if(4===Va)if(ka)rb=excelOnlineCalc.location.gridRange(wa.bottom,wa.left-1,1,wa.right-wa.left+1);else return excelOnlineCalc.util.success(null);Va=excelOnlineCalc.location.sheetGridRange(ja,rb);return excelOnlineCalc.util.success(Va)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(ja,Va)=>{if((A.a.equals(ja,this.documentLoc.path,!0)||!ja)&&A.a.equals(Va,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);
ja=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(ja,Va)]);return excelOnlineCalc.util.failure(ja)};this.getSheetIndex=(ja,Va)=>{if(!this.Xe.mb(this.currentStateId)||!this.Xe.na(this.currentStateId).Qj)return Va=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Va);ja=this.Xe.na(this.currentStateId).Qj;for(let bb=1;bb<ja.length;bb++)if(A.a.equals(ja[bb].Q7.sheetName,Va,!0))return excelOnlineCalc.util.success(ja[bb].Q7.sheetId);return excelOnlineCalc.util.success(null)};
this.getSheetName=(ja,Va)=>{if(!this.Xe.mb(this.currentStateId)||!this.Xe.na(this.currentStateId).Qj)return Va=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Va);ja=this.Xe.na(this.currentStateId).Qj;for(let bb=1;bb<ja.length;bb++)if(A.a.equals(ja[bb].Q7.sheetId,Va,!0))return excelOnlineCalc.util.success(ja[bb].Q7.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);
this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.CEf=()=>{this.setNumberFormats()};this.dd=()=>{c.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Xe=new m.a;this.currentStateId=this.Pt=-1;this.Qta="";this.Wsb=null;this.rJd=!1;this.hr&&this.clearCache()};this.v9f=(this.Lc=aa)?aa.va.CalcWebWorkerSmokeTestPingIntervalMS:this.v9f;this.Xe=new m.a;this.Wsb=null;this.documentLoc=
excelOnlineCalc.location.documentLoc("",this.Lc.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Woa();this.kqd=v.a.kqd()}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.FLd(this.CEf);this.Lc&&this.Lc.Jl(this.dd);this.close()}VPb(aa){if(!this.hr)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Lc.da.za(268),!this.instantaneousSupportInformationManager))return c.ULS.sendTraceTag(537170198,
0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==aa&&(this.currentStateId=this.Lc.ea.d9a,this.currentStateId===e.a.qe&&(this.currentStateId=this.Lc.ea.ze));if(1===aa&&this.currentStateId<this.Pt)return c.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Pt} - ignoring update`),!1;this.Ptj();0!==aa&&this.rJd||(this.hyj(),this.nvj(),this.Zvj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Vqe(this.CEf),
this.Lc.ml(this.dd),this.rJd=!0);this.w$i();let ja=!1;0===aa&&(ja=this.fei());if(0!==aa||ja)this.txj()?(this.Wxj(aa),this.Vxj(),this.Pt=this.currentStateId,this.V1g()):c.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==aa&&this.resumeRecalc();return!0}evalFormula(aa,ja,Va,bb){if(!this.hr)return c.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ja=excelOnlineCalc.calc.sheetCellLocation(null!==
Va&&void 0!==Va?Va:w.d(this.Lc.xa.oa),ja.top-1,ja.left-1);aa=this.hr.evalFormula(this.Lc.ea.ze,aa,ja,bb);this.resumeRecalc();return aa}IYg(aa,ja,Va,bb=null){const wa=w.d(this.Lc.xa.oa);let ka=aa.cell.XQ-1,ta=aa.cell.WQ-1;var qa=ka,rb=ta;let Za=null;bb&&(Za=excelOnlineCalc.calc.cellLocation(ka,ta),ka=bb.top-1,ta=bb.left-1,qa=bb.bottom-1,rb=bb.right-1);Va=this.y1d(aa,Va,"SetCell");if(0>Va)return!1;rb=I.daa("CalculateFormula.cell",wa,ka,ta,qa,rb);qa=[];bb=this.njd(wa);ja=excelOnlineCalc.calc.inferredRangeFormulaEdit(rb,
ja,Za,bb);qa.push(ja);aa=(ja=this.N7e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",wa,ka,ta,A.a.Zse(aa.cell.text),Va,ja.top-1,ja.left-1,ja.bottom-1,ja.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",wa,ka,ta,A.a.Zse(aa.cell.text),Va,"","","","");c.ULS.sendTraceTag(537170180,0,50,aa);this.hr.editRangeFormulas(Va,qa);this.resumeRecalc();
return!0}Cub(aa,ja,Va,bb){if(!this.hr)return c.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!Va||!ja)return c.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!Va}, outputColumnRange null: ${!ja}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");c.ULS.shipAssertTag(537170178,0,Va.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const wa=w.d(this.Lc.xa.oa),ka=this.njd(wa);var ta=null;if(aa){ta=[];for(const rb of aa)if(rb.column!==Va.left){aa=rb.row-1;var qa=rb.column-1;aa=I.daa("EvalFormulaRangeOnClone.cell",wa,aa,qa,aa,qa);qa=rb.text;ta.push(excelOnlineCalc.calc.rangeWrite(aa,excelOnlineCalc.calc.valueCellData(qa,qa,rb.$j,null)))}}Va=excelOnlineCalc.calc.cellLocation(Va.top-1,Va.left-1);ja=I.daa("EvalFormulaRangeOnClone.outputColumnRange",wa,ja.top-1,ja.left-1,ja.bottom-1,ja.right-1);bb=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ja,
bb,Va,ka)];ta=this.hr.evalOnClonedModel(ta,bb);this.resumeRecalc();return ta}IIe(aa){let ja=null;try{if(aa)if(this.Qta=z.h(this.Lc).Ea.Fva(aa),this.currentStateId=aa.XTa,this.currentStateId<this.Pt||this.currentStateId===e.a.qe)c.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.Qta} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Pt}`);else{if(this.lei(),!this.OTg())if(ja=this.Lc.Jb.Ac("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.Qta} StateId:${this.currentStateId}`),
this.Wsb=this.Dxb(aa.oa.sheetName),!this.Wsb){const ka=!!(this.Lc.qd&32),ta=this.Xe.mb(this.currentStateId)&&this.Xe.na(this.currentStateId).Qj?this.Xe.na(this.currentStateId).Qj.length:0;c.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${ta}, scratchPad:${ka}, sheetNameLength:${aa.oa.sheetName?aa.oa.sheetName.length:-1} Hash:${aa.oa.hash}`)}else if(z.h(this.Lc).Ea.Dm.y2a(aa.zd)){var Va=aa.sf;if(Va){var bb=Va.getCalcBlockModel();
if(!bb)c.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.GTg(bb)){this.Xe.na(this.currentStateId).p0a[this.Qta]=new D(bb,aa.oa.sheetName);var wa=aa.ke;wa?this.fHg(wa.NamedObjects):c.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else c.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.Qta}`)}}else c.ULS.shipAssertTag(537170177,
0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ja&&ja.stop()}}r5a(aa){if(!this.Xe.na(this.currentStateId).Qj||!this.Xe.na(this.currentStateId).Qj[0])return null;var ja=this.Xe.na(this.currentStateId).Qj[0].v6;if(!ja||!ja.mb(aa.name))return null;aa=ja.na(aa.name);if(!aa||!aa.bF)return null;ja=new d.a;for(let Va of aa.bF.O$)ja.add(Va.value);return ja}JYg(aa,ja,Va){var bb=z.h(this.Lc),wa=bb.Sb(ja);wa=this.y1d(wa,null,"CopyPaste");Va=this.y1d(bb.Sb(aa),Va,
"CopyPaste");if(0>wa||0>Va||wa!==Va)c.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${Va}, targetRevision:${wa}.`);else{Va=[];bb=w.d(this.Lc.xa.oa);var ka=this.njd(bb);aa=I.daa("CalculateFormulaForCopyPaste.srcRange",bb,aa.top-1,aa.left-1,aa.bottom-1,aa.right-1);ja=I.daa("CalculateFormulaForCopyPaste.targetRange",bb,ja.top-1,ja.left-1,ja.bottom-1,ja.right-1);ja=excelOnlineCalc.calc.copyPasteRangePasteEdit(ja,aa,ka);Va.push(ja);
ja=ka?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",bb,wa,ka.row,ka.column,ka.lastRow,ka.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",bb,wa,"","","","");c.ULS.sendTraceTag(537170142,0,50,ja);this.hr.editRangePaste(wa,Va);this.resumeRecalc()}}njd(aa){const ja=this.N7e();let Va=null;ja?Va=I.daa("GetViewport.viewport",aa,ja.top-1,ja.left-
1,ja.bottom-1,ja.right-1):c.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return Va}N7e(){const aa=z.h(this.Lc);let ja=aa.vi;if(z.h(this.Lc).ib.tj){ja=aa.Bf(1).vi;if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!ja)return c.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;ja.dea(1,1);ja.dea(3,1)}return ja}y1d(aa,ja,Va){let bb;
if(!this.hr||!aa)return c.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.hr}, modifiedCell is null:${!aa}, operation:${Va}`),-1;const wa=aa.cell.XQ-1,ka=aa.cell.WQ-1;if(aa.cell.my){if(bb=aa.cell.my.$we,bb===e.a.qe)return c.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${aa.cell.my.zd}, operation:${Va}`),-1}else return c.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${aa.cell.XQ},${aa.cell.WQ}), operation:${Va}`),
-1;if(bb<this.Pt)return c.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${wa},${ka}) - blockRevision:${bb} < lastUpdatedStateId:${this.Pt}, operation:${Va}`),-1;if(bb<this.currentStateId)return c.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${wa},${ka}) - blockRevision:${bb} < currentStateId:${this.currentStateId}, operation:${Va}`),-1;ja&&!this.CDd&&(this.hr.setOnRecalcResults(ja),
this.CDd=!0);return this.lUj()&&!this.VPb(2)?(c.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${Va}`),-1):bb}getFormulaBarText(aa,ja,Va){return ja&&ja.startsWith("'")?ja:aa.cell.formulaBarText||Va.toString()}udh(aa,ja,Va){let bb=null;if(this.Bze()&&this.Xe.na(this.Pt).p0a){const wa=this.Xe.na(this.Pt).p0a[aa];if(null===wa||void 0===wa?0:wa.axc)bb=wa.Pye}Va=this.Uii(bb,ja,Va);ja=this.p5g(bb,ja,Va);c.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${aa} StateId:${this.currentStateId} number of formulas ${ja}`)}Uii(aa,
ja,Va){let bb=!1;const wa=I.L_e(ja);if(aa){const ka=I.L_e(aa);A.a.equals(ka,wa,!1)&&(bb=!0)}bb?this.KHg(aa,this.Pt,Va):this.MHg(ja,Va);return bb}Bze(){let aa=!1;this.hr&&-1!==this.Pt&&(aa=this.hr.stateIdAvailable(this.Pt));return aa&&this.Xe.mb(this.Pt)&&this.Pt<this.currentStateId}p5g(aa,ja,Va){let bb;bb=0;let wa,ka;for(ja.reset();wa=ja.getNextCell();)x.f(wa.formula)&&bb++,(ka=Va?aa.getCell(wa.row,wa.col):null)?this.l5g(ja,wa,ka):this.LHg(ja,wa);if(Va)for(aa.reset();ka=aa.getNextCell();)(wa=ja.getCell(ka.row,
ka.col))||this.kpe(aa,ka);return bb}Zvj(){this.hr.setOnUpdateRequest(()=>{})}Yvj(){this.hr.setOnUnresponsive((aa,ja,Va,bb)=>{this.EXi(aa,ja,Va,bb)})}EXi(aa,ja,Va,bb){c.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${aa}, waitTime:${ja}, timeoutCount:${Va}, hasBeenClosed:${bb}.`);bb&&(this.Okj(),this.Woa())}Okj(){this.dd(null,null);this.Lvd=this.CDd=!1;this.iHd=0;this.aHd=this.cHd=this.dHd=this.bHd=-1}close(){this.hr.close()}clearCache(){this.hr.clearCache()}resumeRecalc(){this.hr.resumeRecalc()}nvj(){this.hr.setA1ReferenceStyle(!0)}w$i(){if(this.instantaneousSupportInformationManager){var aa=
this.instantaneousSupportInformationManager.lgi;const Va=this.instantaneousSupportInformationManager.ogi,bb=this.instantaneousSupportInformationManager.ngi,wa=this.instantaneousSupportInformationManager.mgi;var ja=!1;aa!==this.bHd&&(ja=!0,this.bHd=aa);Va!==this.dHd&&(ja=!0,this.dHd=Va);bb!==this.cHd&&(ja=!0,this.cHd=bb);wa!==this.aHd&&(ja=!0,this.aHd=wa);const ka=[];r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ja=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),ka.push(ja),ja=!0);r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(ja=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),ka.push(ja),ja=!0);r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ja=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),ka.push(ja),ja=!0);ja&&(aa=excelOnlineCalc.calc.recalcServiceConfig(null,aa,null,Va,null,null,null,bb,ka,wa),this.hr.reconfigure(aa))}}Wxj(aa){let ja=
null;if(this.Xe.mb(this.currentStateId))try{this.gaa=[],ja=this.Lc.Jb.Ac("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${H[aa]}`),f.a.forEach(this.Xe.na(this.currentStateId).p0a,(Va,bb)=>{bb.axc||(this.udh(Va,bb.Pye,bb.sheetName),bb.axc=!0)},null),this.hr.updateRanges(this.currentStateId,this.gaa)}finally{ja&&ja.stop()}else c.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}Vxj(){const aa=
[],ja=this.Bze();var Va=ja&&this.Xe.na(this.Pt).Qj&&this.Xe.na(this.Pt).Qj[0]&&this.Xe.na(this.Pt).Qj[0].enc?this.Xe.na(this.Pt).Qj[0].v6:null;this.tEe(Va,this.Xe.na(this.currentStateId).Qj[0].v6,null,this.Pt,aa);this.Xe.na(this.currentStateId).Qj[0].enc=!0;for(let bb=1;bb<this.Xe.na(this.currentStateId).Qj.length;bb++)Va=-1,ja&&this.Xe.na(this.Pt).Qj&&(Va=this.kid(this.Xe.na(this.currentStateId).Qj[bb].Q7.sheetName,this.Pt)),Va=-1!==Va&&this.Xe.na(this.Pt).Qj[Va].enc?this.Xe.na(this.Pt).Qj[Va].v6:
null,this.tEe(Va,this.Xe.na(this.currentStateId).Qj[bb].v6,this.Xe.na(this.currentStateId).Qj[bb].Q7.sheetId,this.Pt,aa),this.Xe.na(this.currentStateId).Qj[bb].enc=!0;this.hr.updateNamedObjects(this.currentStateId,aa)}tEe(aa,ja,Va,bb,wa){if(void 0!==Va&&null!==Va){var ka=excelOnlineCalc.calc.undefinedNamesWrite(Va);wa.push(ka)}if(aa){var ta=!1;ka=[];var qa=[];if(ja)for(let Za of ja){const gb=Za.value;if(aa.mb(Za.key)){var rb=aa.na(Za.key);I.vHi(rb,gb)?ta=!0:(rb=excelOnlineCalc.calc.namedObject(Za.key,
null),ka.push(rb),I.VVc(Za.key,gb,qa))}else I.VVc(Za.key,gb,qa)}for(let Za of aa)ja&&ja.mb(Za.key)||(aa=excelOnlineCalc.calc.namedObject(Za.key,null),ka.push(aa));ta&&(ja=excelOnlineCalc.calc.namedObjectsPromote(Va,bb),wa.push(ja));0<ka.length&&(ja=excelOnlineCalc.calc.namedObjectsWrite(Va,ka),wa.push(ja));0<qa.length&&(Va=excelOnlineCalc.calc.namedObjectsWrite(Va,qa),wa.push(Va))}else if(ja){bb=[];for(qa of ja)I.VVc(qa.key,qa.value,bb);0<bb.length&&(Va=excelOnlineCalc.calc.namedObjectsWrite(Va,bb),
wa.push(Va))}}OTg(){return this.Xe.na(this.currentStateId).p0a[this.Qta]?(c.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.Qta} StateId:${this.currentStateId} previously handled`),!0):!1}GTg(aa){return 1===aa.getColumnNumbers().length&&aa.getColumnNumbers()[0]===I.kyd+1?!1:!0}fei(){let aa=!1;z.h(this.Lc).Ea.Fvb(ja=>{ja.state&1&&this.Lc.ea.ze===ja.pe.Revision&&(this.IIe(ja),aa=!0)});return aa}CGe(aa,ja){var Va=aa.getRowNumbers(),bb=aa.getColumnNumbers();
aa=Va[0]-1;Va=Va[Va.length-1]-1;const wa=bb[0]-1;bb=bb[bb.length-1]-1;ja=this.Dxb(ja);if(!ja){const ka=this.Xe.mb(this.currentStateId)&&this.Xe.na(this.currentStateId).Qj?this.Xe.na(this.currentStateId).Qj.length:0;c.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${ka}`)}return I.daa("CreateBlockRangeLocation",ja,aa,wa,Va,bb)}KHg(aa,ja,Va){if(Va=this.CGe(aa,Va)){var bb=I.I5b(aa.getRowNumbers());aa=I.I5b(aa.getColumnNumbers());
ja=excelOnlineCalc.calc.rangePromote(Va,ja,bb,aa);this.gaa[this.gaa.length]=ja}}MHg(aa,ja){if(ja=this.CGe(aa,ja)){var Va=I.I5b(aa.getRowNumbers());aa=I.I5b(aa.getColumnNumbers());aa=excelOnlineCalc.calc.rangeWrite(ja,null,Va,aa);this.gaa[this.gaa.length]=aa}}l5g(aa,ja,Va){let bb=null,wa=0,ka=0;switch(ja.valueType){case 2:bb=this.kjd(ja);var ta=this.kjd(Va);ta=A.a.equals(ta,bb,!1);break;case 1:null===ja.value&&null===Va.value?ta=!0:(wa=parseFloat(ja.value),ta=parseFloat(Va.value)===wa);break;default:null===
ja.value&&null===Va.value?ta=!0:(ka=parseFloat(ja.value),ta=ka===parseFloat(Va.value))}ta&&ja.valueType===Va.valueType&&ja.ifmt===Va.ifmt&&ja.formulaType===Va.formulaType&&A.a.equals(Va.formula,ja.formula,!1)||(void 0!==ja.formula&&null!==ja.formula||void 0!==ja.value&&null!==ja.value||void 0!==ja.text&&null!==ja.text?this.k_b(aa,ja,bb,wa,ka):this.kpe(aa,ja))}fHg(aa){if(this.Lc.Cb&&this.Lc.Cb.items)for(let ka=0;ka<this.Lc.Cb.count;ka++){var ja=this.Lc.Cb.items[ka];if(2!==ja.type&&3!==ja.type)continue;
var Va=0,bb=ja.name,wa=bb.lastIndexOf("!");if(0<wa){Va=bb.substr(0,wa);"'"===Va.charAt(0)&&(Va=Va.substr(1,Va.length-2));Va=this.kid(Va,this.currentStateId);if(-1===Va){ja=this.Xe.mb(this.currentStateId)&&this.Xe.na(this.currentStateId).Qj?this.Xe.na(this.currentStateId).Qj.length:0;c.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ja}`);continue}bb=bb.substr(wa+1)}Va=this.Xe.na(this.currentStateId).Qj[Va].v6;let ta=ja.usedRange;
2===ja.type&&(ta=y.a(ja));if(Va.mb(bb)){if(wa=Va.na(bb),wa.range=ta,wa.attributes=ja.attributes,2===wa.type&&(bb=I.RWe(ja.name,aa),ja=(Va=r.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?ja.VO:null===bb||void 0===bb?void 0:bb.ColHeadersList,bb||Va))if(!wa.bF)wa.bF=new t(ja);else if(ja)for(const qa of ja.HeadersList)wa.bF.O$.ia(qa.Index,qa.Name)}else if(wa=this.Dxb(ja.sheetName)){wa=new J(ja.type,ja.name,ta,wa,ja.attributes);if(2===wa.type)if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&
ja.VO)wa.bF=new t(ja.VO);else if(ja=I.RWe(ja.name,aa))wa.bF=new t(ja.ColHeadersList);Va.ia(bb,wa)}else ja=this.Xe.mb(this.currentStateId)&&this.Xe.na(this.currentStateId).Qj?this.Xe.na(this.currentStateId).Qj.length:0,c.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ja}`)}}k_b(aa,ja,Va,bb,wa){var ka=aa.getRowNumbers()[ja.row]-1;aa=aa.getColumnNumbers()[ja.col]-1;ka=I.daa("AddRangeUpdateCommand",this.Wsb,ka,aa,ka,aa);aa=null;
let ta=ja.formula||ja.text;const qa=excelOnlineCalc.calc.blankValue;let rb=null;void 0!==ja.text&&null!==ja.text||void 0!==ja.value&&null!==ja.value||(Va="",rb="This cell contains blanks only",0===ja.formulaType&&(ta=""));switch(ja.valueType){case 2:null!==Va&&(0===ja.formulaType&&(aa=excelOnlineCalc.calc.valueCellData(ta,Va,ja.ifmt,rb)),1===ja.formulaType&&(aa=excelOnlineCalc.calc.cellFormulaCellData(ta,Va,ja.ifmt,rb)),2===ja.formulaType&&(aa=excelOnlineCalc.calc.valueCellData("",qa,0,"This cell is a part of an array")));
break;case 1:isNaN(bb)?c.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ja.row},${ja.col}) invalid numeric value`):(0===ja.formulaType&&(aa=excelOnlineCalc.calc.valueCellData(ta,bb,ja.ifmt,null)),1===ja.formulaType&&(aa=excelOnlineCalc.calc.cellFormulaCellData(ta,bb,ja.ifmt,null)),2===ja.formulaType&&(aa=excelOnlineCalc.calc.valueCellData("",qa,0,"This cell is a part of an array")));break;case 3:isNaN(wa)?c.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ja.row},${ja.col}) invalid boolean value`):
(Va=1===wa?!0:!1,0===ja.formulaType&&(aa=excelOnlineCalc.calc.valueCellData(ta,Va,ja.ifmt,null)),1===ja.formulaType&&(aa=excelOnlineCalc.calc.cellFormulaCellData(ta,Va,ja.ifmt,null)),2===ja.formulaType&&(aa=excelOnlineCalc.calc.valueCellData("",qa,0,"This cell is a part of an array")));break;case 4:isNaN(wa)?c.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ja.row},${ja.col}) invalid error value`):(Va=excelOnlineCalc.calc.errorValue(wa),0===ja.formulaType&&(aa=excelOnlineCalc.calc.valueCellData(ta,
Va,ja.ifmt,null)),1===ja.formulaType&&(aa=excelOnlineCalc.calc.cellFormulaCellData(ta,Va,ja.ifmt,null)),2===ja.formulaType&&(aa=excelOnlineCalc.calc.valueCellData("",qa,0,"This cell is a part of an array")));break;default:aa=excelOnlineCalc.calc.valueCellData("",qa,ja.ifmt,null)}aa&&(ja=excelOnlineCalc.calc.rangeWrite(ka,aa,null,null),this.gaa[this.gaa.length]=ja)}LHg(aa,ja){switch(ja.valueType){case 2:this.k_b(aa,ja,this.kjd(ja),null,0);break;case 1:this.k_b(aa,ja,null,parseFloat(ja.value),0);break;
default:this.k_b(aa,ja,null,null,parseFloat(ja.value))}}kpe(aa,ja){var Va=aa.getRowNumbers()[ja.row]-1;aa=aa.getColumnNumbers()[ja.col]-1;Va=I.daa("AddRangeUpdateCommandEmptyCell",this.Wsb,Va,aa,Va,aa);ja=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ja.ifmt,null);ja=excelOnlineCalc.calc.rangeWrite(Va,ja,null,null);this.gaa[this.gaa.length]=ja}Dxb(aa){aa=this.kid(aa,this.currentStateId);return 0<aa?this.Xe.na(this.currentStateId).Qj[aa].Q7.sheetId:null}kid(aa,ja){if(!this.Xe.mb(ja))return c.ULS.sendTraceTag(537170113,
0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${ja} does not exist in GridCache`),-1;const Va=this.Xe.na(ja);return Va.Qj?Va.getSheetIndex(aa):(c.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${ja}`),-1)}txj(){if(!this.Xe.mb(this.currentStateId)||!this.Xe.na(this.currentStateId).Qj.length)return c.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),
!1;const aa=[];for(let ja=1;ja<this.Xe.na(this.currentStateId).Qj.length;ja++){const Va=this.Xe.na(this.currentStateId).Qj[ja];Va&&aa.push(Va.Q7)}this.hr.updateSheetNames(this.currentStateId,aa);this.hr.updateUnusedCells(this.currentStateId,this.Xe.na(this.currentStateId).rgg);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var aa=[];for(const ja of this.instantaneousSupportInformationManager.Zya){const Va=excelOnlineCalc.calc.numberFormat(ja.IfmtIndex,ja.FormatString,
ja.Builtin);aa.push(Va)}this.hr.setNumberFormats(aa,!0)}}Ptj(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Je){var aa=this.jei();if(!this.Lvd||aa)this.H5b(),this.instantaneousSupportInformationManager.Je.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Je.TrueValueString),this.instantaneousSupportInformationManager.Je.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Je.FalseValueString),aa=C.CalcHelper.xHe(this.instantaneousSupportInformationManager,
aa),this.hr.setLocale(aa),this.Lvd=!0}}hyj(){var aa=null;if(void 0!==this.Lc.workbookContext.TimeZoneInformation&&null!==this.Lc.workbookContext.TimeZoneInformation){aa=null;this.Lc.workbookContext.TimeZoneInformation.StandardDate.Month&&(aa=excelOnlineCalc.date.dateTime(this.Lc.workbookContext.TimeZoneInformation.StandardDate.Year,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Month,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Day,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Hour,
this.Lc.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Second,this.Lc.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let ja=null;this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ja=excelOnlineCalc.date.dateTime(this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Month,
this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));aa=excelOnlineCalc.date.tzData(this.Lc.workbookContext.TimeZoneInformation.Bias,aa,this.Lc.workbookContext.TimeZoneInformation.StandardBias,
ja,this.Lc.workbookContext.TimeZoneInformation.DaylightBias)}else c.ULS.sendTraceTag(537170082,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");aa=excelOnlineCalc.calc.workbookProps(this.Lc.workbookContext.F1904,this.Lc.workbookContext.FDateCompatibility,aa);this.hr.setWorkbookProps(aa)}Woa(){r.EwaSettings.ma(301)&&l.c(excelOnlineCalc.worker.runSmokeTest(1/0,this.v9f,!0)).continueWith(bb=>{bb.exception?c.ULS.sendTraceTag(537170079,0,15,`CalcAsyncEngine.TryInitialize: calc smoke test failed: ${bb.exception.toString()}`):
c.ULS.sendTraceTag(537170080,0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")});const aa=r.EwaSettings.ma(646)?n.local:n.sNj,[ja,Va]=v.a.AV(this.Lc)?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.sJd=l.c(excelOnlineCalc.calc.createRecalcService(aa,ja,Va));this.sJd.continueWith(bb=>{bb.exception?c.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${bb.exception.toString()}`):
(c.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.hr=this.sJd.result)?this.VPb(0)?this.Yvj():c.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):c.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}jei(){const aa=this.instantaneousSupportInformationManager.Fja;if(!aa||this.iHd===aa.length)return null;this.iHd=aa.length;return C.CalcHelper.kHe(aa)}H5b(){this.errorTypeNames=
C.CalcHelper.H5b()}lei(){if(!(this.Xe.mb(this.currentStateId)&&0<this.Xe.na(this.currentStateId).Qj.length)){this.Xe.ia(this.currentStateId,new L(this.kqd));this.Xe.na(this.currentStateId).k4f(0,new G(null));var aa=this.Lc.xa;for(let bb=0;bb<aa.count;bb++){var ja=Object(h.a)(B.a,aa.getItem(bb));if(ja){void 0!==ja.sheetId&&null!==ja.sheetId&&void 0!==ja.name&&null!==ja.name&&ja.sheetId.length&&ja.sheetName.length||c.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${bb} Id:${ja.sheetId} Hash:${ja.hash} NameLength:${ja.name?
ja.name.length:-1}`);var Va=void 0;Va=excelOnlineCalc.calc.sheetName(ja.sheetId,ja.name);this.Xe.na(this.currentStateId).k4f(bb+1,new G(Va));Va=ja.usedRange.zS();Va=excelOnlineCalc.calc.rangeLocation(0,0,Va.LastRow,Va.LastColumn);ja=excelOnlineCalc.calc.unusedCellsUpdate(ja.sheetId,Va);this.Xe.na(this.currentStateId).rgg.push(ja)}else c.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${bb}`)}}}V1g(){for(let aa of this.Xe)aa.key<
this.Pt&&this.Xe.remove(aa.key)}kjd(aa){aa=aa.value||aa.text;if(void 0===aa||null===aa)aa="";return aa}lUj(){if(!this.Xe.mb(this.currentStateId))return!1;let aa=!1;f.a.forEach(this.Xe.na(this.currentStateId).p0a,(ja,Va)=>{Va.axc||(aa=!0)},null);return aa}s5c(aa){const ja={};ja.reason=aa;ja.kind=1;return ja}vic(){return this.Xe.mb(this.currentStateId)&&this.Xe.na(this.currentStateId).Qj&&this.Xe.na(this.currentStateId).Qj[0]&&this.Xe.na(this.currentStateId).Qj[0].v6?!0:!1}static v$g(aa){const ja=[];
if(null===aa||void 0===aa?0:aa.O$)for(let Va of aa.O$)aa=excelOnlineCalc.calc.columnData(Va.key,Va.value),ja.push(aa);return ja}static vHi(aa,ja){if(aa.type!==ja.type||aa.attributes!==ja.attributes||!A.a.equals(aa.fullName,ja.fullName,!1)||!aa.range.equals(ja.range))return!1;if(!aa.bF&&!ja.bF)return!0;if(!aa.bF||!ja.bF||aa.bF.O$.count!==ja.bF.O$.count)return!1;for(let Va of aa.bF.O$){let bb;if(!(Va.value&&({value:bb}=ja.bF.O$.Dc(Va.key)).returnValue&&bb&&A.a.equals(Va.value,bb,!1)))return!1}return!0}static VVc(aa,
ja,Va){var bb=I.daa("NamedObject",ja.sheetId,ja.range.top-1,ja.range.left-1,ja.range.bottom-1,ja.range.right-1);if(2===ja.type){const wa=!!(ja.attributes&16),ka=!!(ja.attributes&8);ja=I.v$g(ja.bF);bb=excelOnlineCalc.calc.namedTableData(bb,wa,ka,ja);aa=excelOnlineCalc.calc.namedObject(aa,bb)}else bb=excelOnlineCalc.calc.namedRangeData(bb),aa=excelOnlineCalc.calc.namedObject(aa,bb);Va.push(aa)}static L_e(aa){const ja=Sys.Serialization.JavaScriptSerializer.serialize(aa.getRowNumbers());aa=Sys.Serialization.JavaScriptSerializer.serialize(aa.getColumnNumbers());
return ja+aa}static I5b(aa){let ja=null;if(1<aa.length)for(let Va=1;Va<aa.length;Va++){let bb=0;for(;aa[Va-1]+1+bb<aa[Va];)ja=ja||[],ja.push(aa[Va-1]+bb),bb++}return ja}static RWe(aa,ja){if(!ja)return null;for(let Va=0,bb=ja.length;Va<bb;++Va)if(A.a.equals(aa,ja[Va].Name,!1))return ja[Va];return null}static daa(aa,ja,Va,bb,wa,ka){const ta=(qa,rb,Za,gb)=>{(0>Za||Za>=gb)&&c.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${qa} invalid ${rb}:${Za}`)};void 0!==ja&&
null!==ja||c.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${aa} sheetId is null`);ta(aa,"top",Va,I.Utf);ta(aa,"left",bb,I.kyd);ta(aa,"bottom",wa,I.Utf);ta(aa,"right",ka,I.kyd);return excelOnlineCalc.calc.sheetRangeLocation(ja,Va,bb,wa,ka)}}I.Utf=1048576;I.kyd=16384;Object(u.a)(I,"CalcAsyncEngine",null,[2]);class M{constructor(){this.BK=this.CK=this.MF=this.NF=this.v_=!1}}Object(u.a)(M,"AbsoluteRelativeReferenceInfo",null,[]);var Q=a(979),U=a(24);class N{}N.cMf=
"#";Object(u.a)(N,"Operators",null,[]);var W=a(980);class X{}X.sheet="Sheet";X.sheetRange="SheetRange";X.document="Document";X.Wai="Ident";Object(u.a)(X,"TraverseFormulaQualifierTypes",null,[]);var sa=a(981),da=a(870),S=a(789),oa=a(42),K=a(55),ea=a(66),ya=a(288),ha=a(38);class La extends Sys.EventArgs{constructor(aa){super();this.Pk=aa}}Object(u.a)(La,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);class Ia extends ha.a{constructor(aa){super();this.nu=null;this.Qkg=!1;this.HNd=this.instantaneousSupportInformationManager=
this.oHb=null;this.YAd=new Map;this.hfe=null;this.ipc=ja=>{c.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");ja.FLd(this.ipc);ja.Fja.length?this.Poc(ja,Sys.EventArgs.Empty):(c.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),ja.yqe(this.Poc))};this.Poc=ja=>{c.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");ja.xLd(this.Poc);this.VRj(ja)};this.onContentReady=()=>{this.nu&&
(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Und||K.Task.delay(0).continueWith(()=>{this.nu.VPb(1)},0,null,ea.a.current))};this.Kyf=(ja,Va)=>{this.nu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Und||this.nu.IIe(Va.ed.block))};c.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.Wgc=!1;this.jb=aa;this.zq=z.h(aa);this.wHc=null;this.gridView.jv(this.onContentReady);this.gridView.Ea.tWc(this.Kyf);this.$.da.$a(268,
ja=>{ja.Je?(c.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.ipc(ja,Sys.EventArgs.Empty)):(c.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),ja.Vqe(this.ipc))})}$Jg(aa){this.addHandler(Ia.n9c,aa)}rfj(aa){this.removeHandler(Ia.n9c,aa)}Bwf(aa){this.raiseEvent(Ia.n9c,new La(aa))}get es(){return this.wHc}get gridView(){return this.zq}get $(){return this.jb}get GB(){return this.hfe}get localeInfo(){return this.es?this.es.config.localeInfo:
null}get config(){return this.es.config}dispose(){c.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.$a(268,aa=>{aa.FLd(this.ipc);aa.xLd(this.Poc)});this.gridView&&(this.gridView.Ky(this.onContentReady),this.gridView.Ea&&this.gridView.Ea.ZTf(this.Kyf),this.zq=null);this.wHc=null;r.EwaSettings.isChangeGateEnabled("OfficeVSO:7108565_CalcNotInitializedAfterDisposed")&&(this.Wgc=!1)}KYg(aa,ja,Va,bb=null){return this.nu?this.nu.IYg(aa,ja,Va,bb):!1}evalFormula(aa,ja,Va,bb){return this.nu?
this.nu.evalFormula(aa,ja,Va,bb):Promise.reject("calc engine not initialized")}Cub(aa,ja,Va,bb){return this.nu?this.nu.Cub(aa,ja,Va,bb):Promise.reject("CalcEngine is null")}r5a(aa){return this.nu?(c.ULS.shipAssertTag(537170059,0,2===aa.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table"),this.nu.r5a(aa)):null}lOg(aa,ja){if(!ja||2!==aa.type)return!1;aa=y.a(aa);return aa.right-aa.left+1===ja.count}CVe(aa,ja){if(!this.oHb)return this.Qkg||c.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),
null;var Va=this.Eta(U.Range.Qc(1,1));Va=this.oHb.parseFormula(excelOnlineCalc.parse.parseLocals(1,Va.range),aa);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(Va))return c.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let bb;if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){const wa=null!==ja&&void 0!==ja?ja:this.gridView.ha.ra.activeCell,ka=excelOnlineCalc.location.gridCell(wa.top-
1,wa.left-1),ta=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),qa=excelOnlineCalc.location.sheetIndex(ta,this.$.xa.oa.sheetId),rb=this.Qdh(ka,qa);this.HNd||(this.HNd=excelOnlineCalc.util.createResolver(this.Pdh()));bb=excelOnlineCalc.parse.parseResultHelper.extractReferences(Va,this.es.config.localeInfo,r.EwaSettings.ma(583),rb,this.HNd)}else bb=excelOnlineCalc.parse.parseResultHelper.extractReferences(Va,this.es.config.localeInfo,r.EwaSettings.ma(583));
r.EwaSettings.ma(102)&&this.EXj(bb,aa);return bb}catch(bb){return c.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${bb.message}`),null}}extractLetVariables(aa,ja){if(!this.oHb)return this.Qkg||c.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const Va=this.Eta(U.Range.Qc(1,1));aa=this.oHb.parseFormula(excelOnlineCalc.parse.parseLocals(1,Va.range),aa);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(aa))return c.ULS.sendTraceTag(537170053,
0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(aa,ja,this.es.config.localeInfo)}catch(bb){return c.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${bb.message}`),null}}extractReferences(aa,ja,Va,bb,wa){if(!ja)return c.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!Va)return c.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),
null;wa=this.CVe(aa,wa);if(!wa)return c.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.Nch(wa,ja,Va,aa,bb)}catch(ka){return c.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${ka.message}`),null}}v1h(aa,ja,Va,bb){if(!aa)return c.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!ja||0>=ja.length)return c.ULS.sendTraceTag(537170018,
0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null;aa=this.Eta(aa);if(!this.es||!aa)return null;const wa=this.nwb(aa).returnValue;if(!wa||wa.d7a)return null;Va=excelOnline.utils.getCharIndexInTextFromPoint(Va,bb,r.EwaSettings.ma(583));return 0>Va?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.es.config,Va,ja,aa)}zYg(aa,ja,Va,bb){if(!aa)return c.ULS.sendTraceTag(537170017,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),
null;let wa=null;return this.evalFormula(ja,aa,void 0,excelOnlineCalc.calc.evalFormulaFormatOrigin()).then(ka=>{let ta;const qa=({kind:ta}=this.es.yrh(ka,Va)).returnValue;8!==ta||qa.length&&qa!==C.CalcHelper.unknownError?ka=0:(c.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),ka=excelOnlineCalc.calc.getEvalFailureReason(ka),void 0!==ka&&null!==ka||c.ULS.shipAssertTag(537170015,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),
ka=1);return wa=bb?new Q.a(qa,bb.start,bb.end,ka):new Q.a(qa,-1,-1,ka)},ka=>{c.ULS.sendTraceTag(537170014,0,10,`EvalSession.GetPartialResultValueForFormula - exception: ${ka}`);return Promise.resolve(wa)})}getSubExpressionSpan(aa){return this.es&&aa?excelOnlineCalc.runtime.getSubExpressionSpan(aa):null}getFormulaSubExpressionObject(aa,ja,Va){return this.es&&aa&&ja&&Va?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.es.config,ja,Va,this.Eta(aa)):null}y1h(aa,ja,Va){return this.es&&aa&&ja?
excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.es.config,ja,Va,this.Eta(aa)):null}w1h(aa,ja,Va){return this.es&&aa&&ja?excelOnlineCalc.runtime.getSubExpressionSubspans(this.es.config.localeInfo,ja,Va):null}LVh(){return this.es?this.es.config.localeInfo.listSeparator:null}isFormulaSubExpressionVolatile(aa){return this.es?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.es.config.localeInfo,aa):!1}Eta(aa,ja=!0){return aa&&this.es?this.es.meh(this.es.agh(),aa.top-1,aa.left-
1,ja):null}Mhf(aa,ja){if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:7173486_IsFormulaCellRefactor")){aa=this.gxb(aa);if(!Object(ya.c)(aa))return null;ja=this.GB.parseEdit(ja,aa.value);return excelOnlineCalc.util.isSuccess(ja)?ja.value.kind===da.a.formula:null}aa=this.Ncc(aa);if(void 0===aa||null===aa)return null;aa=this.GB.createFormat(aa.FormatString,aa.Builtin);if(!excelOnlineCalc.util.isSuccess(aa))return null;ja=this.GB.parseEdit(ja,aa.value);return excelOnlineCalc.util.isSuccess(ja)?ja.value.kind===
da.a.formula:null}gxb(aa){if(null==this.GB)return Object(ya.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(ya.a)("Instantaneous manager is null");if(this.YAd.has(aa))return Object(ya.d)(this.YAd.get(aa));if("number"===typeof aa){var ja=this.Ncc(aa);if(null==ja)return Object(ya.a)(`Invalid ifmt=${aa}`);var Va=ja.FormatString;ja=ja.Builtin}else Va=aa,ja=!1;Va=this.GB.createFormat(Va,ja);return excelOnlineCalc.util.isSuccess(Va)?(this.YAd.set(aa,Va.value),
Object(ya.d)(Va.value)):Object(ya.a)("Could not create number format")}getWorksheetFuncId(aa){return this.localeInfo.getWorksheetFuncId(aa)}Nch(aa,ja,Va,bb,wa){const ka={Items:[]};for(let Za=0;Za<aa.length;Za++){var ta=aa[Za];const gb={};gb.Start=ta.span.start;gb.End=ta.span.end;if(wa||ta.kind!==W.a.func)if(wa||ta.kind!==W.a.Iwi){if(!this.Omh(ta,ja,Va))continue;var qa=new M;const mb=this.vZh(ta,ja,qa,bb);if(r.EwaSettings.ma(583)){var rb=this.CVh(ta);const Ga=this.BVh(ta);if(mb||Ga&&0<=rb){let ib=
{};ib.Span=gb;ib.LetNumber=rb;ib.LetName=Ga;ib.Range=mb;ib.IsRangeRef=qa.v_;ib.IsAbsoluteFirstRow=qa.NF;ib.IsAbsoluteFirstColumn=qa.MF;ib.IsAbsoluteSecondRow=qa.CK;ib.IsAbsoluteSecondColumn=qa.BK;ib.IsStructRef=ta.kind===W.a.UWd;ka.Items.push(ib)}}else mb&&(rb={},rb.Span=gb,rb.Range=mb,rb.IsRangeRef=qa.v_,rb.IsAbsoluteFirstRow=qa.NF,rb.IsAbsoluteFirstColumn=qa.MF,rb.IsAbsoluteSecondRow=qa.CK,rb.IsAbsoluteSecondColumn=qa.BK,rb.IsStructRef=ta.kind===W.a.UWd,ka.Items.push(rb))}else ta=ta.ref.value.oper.kind,
qa={},qa.Span=gb,qa.IsString=2===ta,qa.IsBoolean=4===ta,qa.IsNumber=1===ta,ka.Items.push(qa);else gb.End=ta.span.start+ta.ref.name.length,ta={},ta.Span=gb,ta.IsFunction=!0,ta.FunctionId=this.getWorksheetFuncId(bb.substring(gb.Start,gb.End)),ka.Items.push(ta)}ka.Items.sort((Za,gb)=>Za.Span.Start-gb.Span.Start);return ka}CVh(aa){return aa.kind===W.a.Jof?aa.ref.number:-1}BVh(aa){return aa.kind===W.a.Jof?aa.ref.name:null}vZh(aa,ja,Va,bb){if(aa.kind===W.a.range)return Va.v_=!0,this.BFe(aa,ja,Va,bb);if(aa.kind===
W.a.namedRange){Va=aa.ref;(aa=this.$.Cb.getItemByName(Va.name))||(aa=this.$.Cb.getItemByName(ja+"!"+Va.name));if(!(aa&&aa.sheetName&&aa.usedRange&&A.a.equals(aa.sheetName,ja,!0)))return null;ja=2===aa.type?y.a(aa):aa.usedRange;return oa.m(ja,aa)}if(aa.kind===W.a.UWd){let wa=aa.ref,ka;wa.name?(ka=this.$.Cb.getItemByName(wa.name))||(ka=this.$.Cb.getItemByName(ja+"!"+wa.name)):ka=this.gridView.Bb.Bj(this.gridView.ha.ra.activeCell);if(!(ka&&ka.sheetName&&ka.usedRange&&A.a.equals(ka.sheetName,ja,!0)))return null;
Va.v_=!1;return this.BFe(aa,ja,Va,bb)}return null}BFe(aa,ja,Va,bb){aa=aa.ref;if(aa.type){if(aa.type===sa.a.column){var wa=aa.startIndex;aa=aa.endIndex;Va.MF=wa.kind===S.a.abs;Va.BK=aa.kind===S.a.abs;return this.createRange(0,wa.index,e.a.fh,aa.index,ja)}if(aa.type===sa.a.row)return wa=aa.endIndex,Va.NF=aa.startIndex.kind===S.a.abs,Va.CK=wa.kind===S.a.abs,this.createRange(aa.startIndex.index,0,aa.endIndex.index,e.a.qh,ja);if(aa.type===sa.a.cell){wa=aa.row;var ka=aa.col;Va.NF=Va.CK=wa.kind===S.a.abs;
Va.MF=Va.BK=ka.kind===S.a.abs;return this.g3b(aa.span.end,bb)&&(Va=U.Range.Qc(wa.index+1,ka.index+1),Va=this.gridView.Bb.C6e(Va))?oa.n(Va,ja):this.createRange(wa.index,ka.index,wa.index,ka.index,ja)}if(aa.type===sa.a.range){wa=aa.top;ka=aa.left;bb=aa.bottom;aa=aa.right;const ta=Math.min(wa.index,bb.index),qa=Math.min(ka.index,aa.index),rb=Math.max(wa.index,bb.index),Za=Math.max(ka.index,aa.index);Va.NF=wa.kind===S.a.abs;Va.CK=bb.kind===S.a.abs;Va.MF=ka.kind===S.a.abs;Va.BK=aa.kind===S.a.abs;return this.createRange(ta,
qa,rb,Za,ja)}c.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${aa.type}'`);return null}c.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}g3b(aa,ja){return ja.length>=aa&&0<aa&&ja.charAt(aa-1)===N.cMf}FYg(aa,ja,Va){this.nu&&this.nu.JYg(aa,ja,Va)}Ncc(aa){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Zya&&this.instantaneousSupportInformationManager.Zya[aa]&&
this.GB?this.instantaneousSupportInformationManager.Zya[aa]:null}toXLNumber(aa){if(!this.GB)return null;aa=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.GB,aa);return excelOnlineCalc.util.isSuccess(aa)?aa.value:null}EXj(aa,ja){if(aa)for(const Va of aa)Va.ref.type&&Va.ref.type===sa.a.cell&&(aa=Va.ref,Ia.n3i(aa,ja)&&(aa.span.end+=1,Va.span.end+=1))}createRange(aa,ja,Va,bb,wa){const ka={};ka.FirstRow=aa;ka.FirstColumn=ja;ka.LastRow=Va;ka.LastColumn=bb;ka.SheetName=wa;return ka}Omh(aa,ja,
Va){var bb=aa.ref.qualifier;if(!bb)return!0;switch(aa.ref.qualifier.type){case X.sheet:return aa=bb.document,A.a.equals(bb.sheet,ja,!0)&&(!aa||A.a.equals(aa.document,Va,!0));case X.sheetRange:return ja=this.$.xa.getItemByName(ja),Va=this.$.xa.getItemByName(bb.sheet1),bb=this.$.xa.getItemByName(bb.sheet2),!!ja&&!!Va&&!!bb&&(Va.index<=ja.index&&ja.index<=bb.index||bb.index<=ja.index&&ja.index<=Va.index);case X.document:return A.a.equals(bb.document,Va,!0);case X.Wai:return bb=bb.name,A.a.equals(bb,
ja,!0)||A.a.equals(bb,Va,!0);default:return c.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${bb.type}'`),!1}}VRj(aa){this.instantaneousSupportInformationManager=aa;aa.Zya.length&&aa.Fja.length?(this.wHc=new C.CalcHelper(this.gridView.$),this.oHb=this.es.createParser(),this.hfe=this.es.createNumberFormatter(),this.Wgc=!0,c.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.nu||(c.ULS.sendTraceTag(537170006,
0,50,"CalcManager creating calc engine"),this.nu=new I(this.$))):c.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${aa.Zya.length}, functions info count = ${aa.Fja.length}`)}nwb(aa){if(!aa)return{returnValue:null,emptyCell:!1};var ja=this.getSheetName(aa.sheet.index);if(!ja)return c.ULS.sendTraceTag(537169998,0,50,`CalcManager.GetCellFromBlockCache: No sheet index ${aa.sheet.index}`),
{returnValue:null,emptyCell:!1};const Va=Ia.convertToRange(aa);ja=this.gridView.nwb(ja,Va.top,Va.left);return ja?ja.Jmh?{returnValue:ja,emptyCell:!1}:(c.ULS.sendTraceTag(537169996,0,50,`CalcManager.GetCellFromBlockCache: cell ${aa.range.row} ${aa.range.col} is empty`),{returnValue:null,emptyCell:!0}):(c.ULS.sendTraceTag(537169997,0,50,`CalcManager.GetCellFromBlockCache: cellProxy is null for cell ${aa.range.row} ${aa.range.col}`),{returnValue:null,emptyCell:!1})}getSheetName(aa){const ja=this.gridView.$.xa.getItem(aa);
return ja?ja.sheetName:(c.ULS.sendTraceTag(537169995,0,50,`CalcManager.GetSheetName - no sheet in index ${aa}`),null)}Qdh(aa,ja){const Va={allowUnqualifiedCell:!0,wrapCellReferences:!0};Va.config=this.es.config;Va.originGridCell=excelOnlineCalc.util.success(aa);Va.originSheet=excelOnlineCalc.util.success(ja);return Va}Pdh(){const aa={};aa.config=this.es.config;aa.getNameLoc=this.nu.getNameLoc;aa.getContainingTable=this.nu.getContainingTable;aa.getStructRefColumn=this.nu.getStructRefColumn;aa.getStructRefSpecialRef=
this.nu.getStructRefSpecialRef;aa.getDocumentLoc=this.nu.getDocumentLoc;aa.getSheetIndex=this.nu.getSheetIndex;aa.getSheetName=this.nu.getSheetName;aa.getUserDefinedFuncLoc=this.nu.getUserDefinedFuncLoc;aa.getSheetRangeIndexes=this.nu.getSheetRangeIndexes;return aa}static n3i(aa,ja){return ja.length>aa.span.end&&ja.charAt(aa.span.end)===N.cMf}static convertToRange(aa){return U.Range.Qc(aa.range.row+1,aa.range.col+1)}}Ia.n9c="ECRC";Object(u.a)(Ia,"CalcManager",ha.a,[669,2]);var ra=a(37),pa=a(53);class ba extends b.a{constructor(aa){super();
this.$=aa;this.Fb()}create(){if(this.$){c.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var aa=76;var ja="Current"}else aa=79,ja="Stable";c.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${ja} JS was loaded`);ra.TaskExtensions.Aa(pa.a.loadScript(aa,4,this.Ya,void 0,void 0,265),()=>{c.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");
let Va=this.$.da.za(266,!1);Va||(c.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),Va=new Ia(this.$),this.$.da.Ga(266,Va));this.ob(Va)},this.la,3)}else c.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static ka(aa){aa&&aa.da&&aa.da.Ga(265,new ba(aa))}}Object(u.a)(ba,"CalcManagerFactory",b.a,[]);var fa=a(9);a.d(E,"a",function(){return Ka});const Ka=()=>{fa.a.Fa(ba.ka)}},
1206:function(u,E,a){var c=a(9);u=a(0);var b=a(15),e=a(222),f=a(87),d=a(4),h=a(187),m=a(8),l=a(38),w=a(869),n=a(226),y=a(60),t=a(868);class r extends Sys.EventArgs{constructor(){super()}}Object(u.a)(r,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var v=a(47),B=a(46);a(35);var A=a(29),z=a(1),x=a(612);a(22);var D=a(281),J=a(21);a(173);class L{constructor(I){this.data=I}}Object(u.a)(L,"NumberFormatDataHolder",null,[]);var T=a(176);class O extends l.a{constructor(I,M){super();this.Lkc=m.a.qe;this.X_c=
null;this.Xgb=this.wkc=!1;this.Oxf=(Q,U)=>{var N;(Q=J.h(this.$))&&(U=null!==(N=null===U||void 0===U?void 0:U.cell)&&void 0!==N?N:Q.Sb(null))&&this.rCa(U.cell.$j,!0)};this.VOi=Q=>{this.isActive()&&(A.a.Nq(Q.Errors)||!Q.Result?(Q=Q.Errors?Q.Errors.map(U=>JSON.stringify(U)).join(","):"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${Q}`)):(Q=Q.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${Q.Index}, category = ${Q.Category}`),
this.Uvj(Q.Index,Q.Category),this.raiseEvent(O.V0c,new w.a(Q.Index,Q.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.S2b();this.isActive()&&this.ea.dc.allowEdits&&(this.Xgb||this.Jn&&!(this.ea.d9a>this.Lkc)?this.KEc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.Egd=t.a(this.$.pa.ya,this.Jn?this.Jn.Digest:"",this.CPi,
this.BPi,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.i2e())};this.aCf=Q=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${Q.data.status}, HTTP status = ${Q.data.httpStatus}.`);this.bLa=null};this.e0=()=>{this.Xgb=!1;this.ea.$D(this.e0);this.cSa(this.wkc?O.ZSd:O.tAd)};this.Tc=(Q,U)=>{b.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");
n.a(U)&&this.cSa(O.ZSd)};this.zf=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.GAd(0===this.$.workbookContext.CalcMode)};this.dd=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.cSa(O.ZSd);z.EwaSettings.ma(297)&&3!==this.$.workbookContext.CalcMode&&this.GAd(0===this.$.workbookContext.CalcMode)};this.uPi=(Q,U,N)=>{b.ULS.sendTraceTag(537155712,
0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.bLa=null;this.isActive()?Q.StateId===m.a.qe?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.KEc()):!Q.Result||this.ZX&&this.ZX.length?this.cSa(O.tAd):this.IFf(Q,U,N):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.IFf=Q=>{this.ZX=Q.Result;
b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.ZX?this.ZX.length:-1} functions.`);Q=!1;if(this.ZX){for(const U of this.ZX)U&&(this.QYe[U.NameUI.toLocaleUpperCase()]=U.FunctionIndex.toString(),U.NameUI!==U.NameDataStrings&&(this.QYe[U.NameDataStrings.toLocaleUpperCase()]=U.FunctionIndex.toString(),Q=!0),this.QIh.ia(U.FunctionIndex,U.NameUI));this.raiseEvent(O.Hdd,Sys.EventArgs.Empty,this)}Q&&b.ULS.sendTraceTag(537155680,
0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.CPi=Q=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.wkc=!1,this.Lkc=Q.StateId,this.Lkc===m.a.qe)this.wkc=!0,this.KEc();else{if(Q.Result){var U=this.Jn;this.Jn=Q.Result;b.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.Jn.Digest}.`);Q=[];if(U)Q=O.rWh(U.NumberFormats,this.Jn.NumberFormats);
else for(U=0;U<this.Jn.NumberFormats.length;U++)this.Enc.ia(U,this.Jn.NumberFormats[U].NumberFormatCategory);for(const N of Q)this.Enc.ia(N,this.Jn.NumberFormats[N].NumberFormatCategory);this.raiseEvent(O.cBd,new r(Q),this);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StructuredReferencesInRangePicker",!1)&&this.raiseEvent(O.Jpf)}this.cSa(O.tAd)}};this.BPi=Q=>{this.isActive()&&(10===Q.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):
(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${Q.data.status}, HTTP status = ${Q.data.httpStatus}.`),this.wkc=!0,this.KEc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=I;this.$=M;this.Jn=this.bLa=this.Egd=this.ZIb=null;this.Enc=new T.a;this.mwb=new T.a;this.ZX=[];this.QIh=new T.a;this.QYe={};this.ea.Uj(this.Tc);this.$.ml(this.dd);J.h(this.$).ha.bha(this.Oxf);z.EwaSettings.ma(297)&&this.ea.ku(this.zf);
this.cSa(O.Fcf);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}Vqe(I){this.addHandler(O.cBd,I)}FLd(I){this.removeHandler(O.cBd,I)}xJg(I){this.addHandler(O.V0c,I)}Qej(I){this.removeHandler(O.V0c,I)}yqe(I){this.addHandler(O.Hdd,I)}xLd(I){this.removeHandler(O.Hdd,I)}$Kg(I){this.addHandler(O.Jpf,I)}get Je(){return this.Jn?this.Jn.LocaleInformation:null}get Zya(){return this.Jn?this.Jn.NumberFormats:[]}get Fja(){this.ZX&&this.ZX.length||this.i2e();return this.ZX}get lgi(){return this.Jn&&
void 0!==this.Jn.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.Jn.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.Jn.InstantaneousCalcWebWorkerPrecisionSamplingRate:O.Ihh}get ogi(){return this.Jn&&void 0!==this.Jn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.Jn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.Jn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:O.Mhh}get ngi(){return this.Jn&&void 0!==this.Jn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&
null!==this.Jn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.Jn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:O.Lhh}get mgi(){return this.Jn&&void 0!==this.Jn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.Jn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.Jn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:O.Khh}get xef(){return this.Jn?this.Jn.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:O.Jhh}get Und(){return null!==this.X_c?
this.X_c:this.Jn?this.Jn.InstantaneousCalcManualMode:!1}MRj(I){let M;if(!I)return{returnValue:!0,category:"General"};M="";if(!({category:I}=this.rCa(I,!1)).returnValue)return{returnValue:!1,category:M};M=this.c8g(I);return{returnValue:!0,category:M}}c8g(I){let M="";switch(I){case 0:M="General";break;case 1:M="Number";break;case 2:M="Currency";break;case 3:M="Accounting";break;case 4:M="Date";break;case 5:M="Time";break;case 6:M="Percentage";break;case 7:M="Fraction";break;case 8:M="Scientific";break;
case 9:M="Text";break;case 10:M="Special";break;case 11:M="Custom"}return M}rCa(I,M){let Q,U=({value:Q}=this.Enc.Dc(I,0)).returnValue;!U&&0<I&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${I}`),this.kOh(I),M&&(Q=this.jOh(I),U=!0),x.a(I,this.$.GG)&&(Q=6));return{returnValue:U,category:Q}}Rli(I){let M=0;if(({category:M}=this.rCa(I,!0)).returnValue)return 6===M;b.ULS.sendTraceTag(537155733,
0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${I}`);return!1}rHh(I){b.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.bLa=y.o(this.$.pa.ya,{FilterType:0},D.b(this.IFf,I),this.aCf,null,null,null)}lYe(){this.cSa(O.Fcf)}GAd(I){this.X_c=I}kOh(I){if(this.mwb&&this.$){var M;if(!({value:M}=this.mwb.Dc(I)).returnValue||M.isCompleted)b.ULS.sendTraceTag(537155728,
0,50,`Getting number format category for format index: ${I}`),(M=t.c(this.$.pa.ya,I,this.VOi,null,null,null))&&this.mwb.ia(I,M)}else b.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}jOh(I){return 1<=I&&8>=I?1:9<=I&&12>=I?2:13===I||14===I?6:15===I?8:17===I|18===I?7:19===I?4:16===I||20<=I&&29>=I||31===I?11:30===I?9:32<=I&&35>=I?3:0}isActive(){const I=void 0===this.ea||null===this.ea,M=!I&&this.ea.Zb;b.ULS.sendTraceTag(537155727,
0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${M} - sessionStateManager IsNullOrUndefined: ${I}`);return M}Uvj(I,M){this.Enc.ia(I,M)}dispose(){f.a.Ia(this.ZIb);this.ZIb=null;this.S2b();for(let I of this.mwb){const M=I.value;M&&!M.isCompleted&&d.AFrameworkApplication.Dd.Ru(M.lu)}this.mwb=null;this.ea&&(this.ea.uk(this.Tc),this.Xgb&&this.ea.$D(this.e0),this.Xgb=!1,this.ea.Mv(this.zf));this.ea=null;this.$&&J.h(this.$)&&J.h(this.$).ha&&(J.h(this.$).ha.nna(this.Oxf),
this.$.Jl(this.dd));this.$=null;super.dispose()}isFeatureEnabled(I){try{switch(I){case "LocaleLongDateFormat":return z.EwaSettings.ma(194);case "GetLocaleDayNames":return z.EwaSettings.ma(195);case "CalculateTextWidthIgnoreLetterSpacing":return z.EwaSettings.ma(281);case "OfficeVSO:3657744_CalcFixForDateFormat":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");
case "CalcAutocompleteExperiment":return z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcNewFunctions":return z.EwaSettings.ma(244);case "CalcContractChecks":return z.EwaSettings.ma(245);case "CalcSupportDynamicArrays":return z.EwaSettings.ma(246);case "CalcFormatCalculations":return z.EwaSettings.ma(247);case "CalcFormulaCacheAPIChanges":return z.EwaSettings.ma(248);case "CalcStrictFormulaChecking":return z.EwaSettings.ma(249);case "CalcSupportRowReference":return z.EwaSettings.ma(260);
case "CalcParserUsesPledges":return z.EwaSettings.ma(302);case "CalcWebWorker":return!0;case "CalcWebWorkerTest":return z.EwaSettings.ma(301);case "CalcLookupFunctions":return z.EwaSettings.ma(303);case "CalcLogStopWatch":return z.EwaSettings.ma(366);case "CalcPreventSpillingHack":return z.EwaSettings.ma(250);case "CalcDynamicArrayOperators":return z.EwaSettings.ma(102);case "CalcDotOperator":return z.EwaSettings.ma(572);case "CalcLetFunction":return z.EwaSettings.ma(688);default:return I.startsWith("OfficeVSO:")?
z.EwaSettings.isChangeGateEnabled(I):!1}}catch(M){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${I}): feature parsing failed, returning false. Exception: ${M.toString()}.`),!1}}cSa(I){this.isActive()&&this.ea.dc.allowEdits?(f.a.Ia(this.ZIb),this.ZIb=null,this.ZIb=v.a.instance.create(this.refresh,I,B.a.pgi)):b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==
this.ea&&null!==this.ea&&void 0!==this.ea.dc&&null!==this.ea.dc?this.ea.dc.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}i2e(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.bLa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.ZX&&this.ZX.length||(this.bLa=y.o(this.$.pa.ya,{FilterType:0},this.uPi,
this.aCf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}KEc(){this.Xgb||(this.Xgb=!0,this.ea.JE(this.e0))}S2b(){this.Ru(this.Egd);this.Ru(this.bLa);this.bLa=this.Egd=null}Ru(I){I&&!I.isCompleted&&this.$.pa.ya.Zfb(I.lu)}static rWh(I,M){if(!I||!I.length)return[];if(!M||!M.length){M=Array(I.length);for(var Q=0;Q<I.length;++Q)M[Q]=I[Q].IfmtIndex;return M}Q=new T.a;for(const U of I)Q.ia(U.IfmtIndex,
new L(U));I=new h.a;for(const U of M){let N;({value:N}=Q.Dc(U.IfmtIndex)).returnValue&&N.data.FormatString===U.FormatString||I.add(U.IfmtIndex)}return I.toArray()}}O.cBd="isim0";O.V0c="isim1";O.Hdd="isim2";O.Jpf="isim3";O.Fcf=100;O.ZSd=1E3;O.tAd=3E5;O.Ihh=.001;O.Mhh=.1;O.Lhh=.2;O.Khh=.001;O.Jhh=50;Object(u.a)(O,"InstantaneousSupportInformationManager",l.a,[668,2]);var G=a(695);class C extends e.a{constructor(I){super();this.$=I;this.Fb()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");
var I=Object(G.a)(this.$.da,268,()=>new O(this.$.ea,this.$));this.ob(I)}}static ka(I){if(!I)throw Error.argumentNull("ewaControl");I.da.Ga(246,new C(I))}}Object(u.a)(C,"InstantaneousSupportInformationManagerFactory",e.a,[]);a.d(E,"a",function(){return H});const H=()=>{c.a.Fa(C.ka)}},1224:function(u,E,a){function c(M){if(M){var Q=new w(M.IsRangeRef);Q.NF=M.IsAbsoluteFirstRow;Q.MF=M.IsAbsoluteFirstColumn;Q.CK=M.IsAbsoluteSecondRow;Q.BK=M.IsAbsoluteSecondColumn;return Q}}function b(M){var Q;if(M){var U=
new w(0===M.kind);M=null===(Q=null===M||void 0===M?void 0:M.rangeInfo)||void 0===Q?void 0:Q.positionKindInfo;if(!M)return U;U.NF=0===M.firstRow;U.MF=0===M.firstColumn;U.CK=0===M.secondRow;U.BK=0===M.secondColumn;return U}}u=a(0);var e=a(222),f=a(7),d=a(15),h=a(83),m=a(5),l=a(322);class w{constructor(M){this.BK=this.CK=this.MF=this.NF=!1;this.v_=M}}Object(u.a)(w,"MarqueeRangeData",null,[]);class n{constructor(M,Q,U,N=!1){this.jYd=M;this.QOb=Q;this.S7a=N;U?(this.v_=U.v_,this.NF=U.NF,this.MF=U.MF,this.CK=
U.CK,this.BK=U.BK):d.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(u.a)(n,"MarqueeMetadata",null,[]);var y=a(42),t=a(139),r=a(35),v=a(1),B=a(22),A=a(579),z=a(21),x=a(173),D=a(343),J=a(33),L=a(725),T=a(871);const O="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");class G{constructor(M,Q){this.AK=this.kfb=this.rrf=!1;this.e9=null;this.fza=
()=>{this.AK=!1};this.Lc=M;this.gridView=z.h(M);this.calcManager=Q;this.qff=v.EwaSettings.ma(677);this.eR=J.a.eR(M);this.Uka=v.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug");this.Ori=v.EwaSettings.isChangeGateEnabled("OfficeVSO:7144291_logRefactorInPreviewRanges");this.gridView.Vb.Rm(this.fza)}get formulaAssistanceManager(){this.e9||(this.e9=this.Lc.da.za(464));return this.e9}get formulaAssistanceTelemetryManager(){this.mEa||(this.mEa=this.Lc.da.za(491));return this.mEa}$B(M,
Q){M.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");if(this.kfb||M.OF)return!1;const U=void 0===Q||null===Q?M.text:Q;if(this.calcManager&&1<U.length&&x.f(U)){var N=this.$ja(),W=this.z4e(),X=this.Lc.workbookContext.WorkbookFileName;let sa=!1;const da=.01>Math.random()?Object(h.a)(t.a,this.Lc.Jb.Ac("LoadingUIShown","ColoredReferencesManager")):null;try{const S=this.calcManager.extractReferences(U,W,X,!this.qff);if(!S)return d.ULS.sendTraceTag(524039689,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),
!1;W=[];X=[];const oa=[],K=[];let ea=0,ya=0;const ha=new r.a(!1);let La="";for(const ra of S.Items)if(sa=ra.IsStructRef||sa,ra.IsBoolean||ra.IsNumber||ra.IsString){const pa=ra.IsBoolean?"rgba(0, 0, 255, 1)":ra.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)";this.FE(X,U,ea,ra.Span.Start,null);this.FE(X,U,ra.Span.Start,ra.Span.End,pa);ea=ra.Span.End}else if(v.EwaSettings.ma(583)){if(ra.Range||ra.LetName&&0<=ra.LetNumber){let pa=null;if(ra.Range){let fa=y.D(ra.Range);pa=this.NZ(fa,ha,1);W.push(new D.a(fa,
N))}else ra.LetName&&0<=ra.LetNumber&&(pa=La=this.WOh(ra.LetName,ra.LetNumber,ha,La),ya!==ha.count&&M.colors.add(ra.Span.Start+"-"+ra.Span.End,O[(ha.count-1)%O.length]));this.FE(X,U,ea,ra.Span.Start,null);this.FE(X,U,ra.Span.Start,ra.Span.End,pa);ea=ra.Span.End;oa.push(ra.Span);let ba=X.length-1;K.push(new n(ba,X[ba].text,c(ra)));ya=ha.count}}else if(ra.Range){let pa=y.D(ra.Range),ba=this.NZ(pa,ha,1);this.FE(X,U,ea,ra.Span.Start,null);this.FE(X,U,ra.Span.Start,ra.Span.End,ba);W.push(new D.a(pa,N));
ea=ra.Span.End;oa.push(ra.Span);let fa=X.length-1;K.push(new n(fa,X[fa].text,c(ra)))}this.formulaAssistanceTelemetryManager?0<S.Items.length&&this.formulaAssistanceTelemetryManager.Iac.formulaHighlightsCounter++:this.Hlc("ColoredReferencesManager.tryUpdateColoredReferences: FormulaAssistanceTelemetryManager unavailable");this.FE(X,U,ea,U.length,null);this.hyc(M,X,!!Q);const Ia=M.textBox.text;if(!B.a.equals(Ia,U,!1)){d.ULS.shipAssertTag(38114182,0,!1,`ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Ia.length}], originalTextLength [${U.length}]`);
let ra=M.textBox.caretPosition;M.textBox.text=U;M.textBox.caretPosition=ra;return!0}this.Bz(W,ha,K);v.EwaSettings.ma(583)&&0<W.length&&d.ULS.sendTraceTag(524039688,0,50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");v.EwaSettings.ma(583)&&0<M.colors.count&&d.ULS.sendTraceTag(524039687,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.AK=!0}finally{da&&da.MBa(()=>{sa&&d.ULS.sendTraceTag(524039686,0,50,`ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in ${da.zc} ms`)})}}else return this.Bz(null,
null),this.AK&&(this.AK=!1,N=M.textBox.caretPosition,M.textBox.setPlainText(U),M.textBox.caretPosition=Math.min(N,U.length),Q)?!0:!1}bgb(M,Q,U){if(this.kfb||M.OF)return!1;const N=isNullOrUndefined(Q)?M.text:Q;var W=[];const X=new r.a(!1);if(1<N.length&&Object(L.b)(U)){const da=[],S=[],oa=[];var sa=0;const K=this.$ja();for(const ea of U.formulaHighlights){this.FE(da,N,sa,ea.span.start,null);switch(ea.kind){case 0:case 1:case 2:U=y.B(ea.rangeInfo.sharedRange);if(isNullOrUndefined(U)){d.ULS.sendTraceTag(521211937,
0,10,`ColoredReferencesManager.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${ea.kind.toString()},`);this.FE(da,N,ea.span.start,ea.span.end,null);break}sa=this.NZ(U,X,1);this.FE(da,N,ea.span.start,ea.span.end,sa);W.push(new D.a(U,K));S.push({Start:ea.span.start,End:ea.span.end});U=da.length-1;oa.push(new n(U,da[U].text,b(ea)));break;case 3:this.FE(da,N,ea.span.start,ea.span.end,null,"rgba(229, 229, 229, 1)")}sa=ea.span.end}this.FE(da,N,sa,N.length);this.hyc(M,
da,!!Q);Q=M.textBox.text;if(!B.a.equals(Q,N,!1))return d.ULS.shipAssertTag(521211936,0,!1,`ColoredReferencesManager.UpdateFormulaHighlights: The text we created is different from the original text. Setting the original text back. currentTextLength [${Q.length}], originalTextLength [${N.length}]`),Q=M.textBox.caretPosition,M.textBox.text=N,M.textBox.caretPosition=Q,!0;this.Bz(W,X,oa);return this.AK=!0}this.Bz(null,null);return this.AK&&(this.AK=!1,W=M.textBox.caretPosition,M.textBox.setPlainText(N),
M.textBox.caretPosition=Math.min(W,N.length),Q)?!0:!1}vEb(M,Q,U){if(!M||!Q||!U)return d.ULS.shipAssertTag(524039685,0,!!M,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),d.ULS.shipAssertTag(524039684,0,!!Q,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),d.ULS.shipAssertTag(524039683,0,!!U,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;const N=Object(h.a)(n,Q.metadata);if(!N)return d.ULS.shipAssertTag(524039682,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),
!1;var W=N.jYd,X=N.QOb,sa=this.gridView.Bb.Gpd(U)?U.Fwb(N.MF,N.NF):U.oLa(N.MF,N.NF,N.BK,N.CK);if(!sa)return d.ULS.shipAssertTag(524039681,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;const da=X.indexOf("!");-1!==da&&(sa=X.substring(0,da+1)+sa);if(!M.textBox.changeTextInExistingTextPart(W,X,sa))return d.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;N.QOb=sa;W=!0;for(X=1;4>=X;X++)(sa=z.h(this.Lc).qb.Bv(3,X,Q.jU))?
(sa.range=U,sa.metadata=N):(d.ULS.shipAssertTag(524039680,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),W=!1);this.gridView.qb.update(!1,!1);this.gridView.Ul&&(this.gridView.fc.textBox.text=M.text);this.gridView.fc.FQa(new l.a({oAb:!0}));return W}wni(M){if(3!==M.Tq)return d.ULS.shipAssertTag(524039651,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;M=Object(h.a)(n,M.metadata);return M?M.v_&&!M.S7a:(d.ULS.shipAssertTag(524039650,
0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)}RBa(M,Q){d.ULS.sendTraceTag(524039649,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(Q?"suspending":"resuming")+" colored references");Q&&this.AK&&(this.AK=!1,this.Bz(null,null),M.textBox.eCe());this.kfb=Q}dispose(){this.gridView&&this.gridView.Vb&&this.gridView.Vb.em(this.fza)}Syb(M){const Q=this.formulaAssistanceTelemetryManager;Q||this.Hlc("ColoredReferencesManager.highlightPreviewRanges: Failed to log highlightPreviewRanges measurement, FormulaAssistanceTelemetryManager unavailable");
null===Q||void 0===Q?void 0:Q.WB(["highlightPreviewRanges"]);this.eR?this.V$h(M):this.U$h(M);null===Q||void 0===Q?void 0:Q.yw(["highlightPreviewRanges"],!0)}V$h(M){var Q=this.formulaAssistanceManager.S4a(M,T.a);if(isNullOrUndefined(Q))this.Uka&&this.Bz(null,null);else{var U=this.$ja(),N=[],W=new r.a(!1),X=[];Q=Q.formulaHighlights;for(const sa of Q)if(Q=sa.kind,0===Q||2===Q||1===Q)Q=y.B(sa.rangeInfo.sharedRange),Object(L.b)(Q)&&(N.push(new D.a(Q,U)),this.NZ(Q,W,1),X.push(new n(sa.span.start,M.substring(sa.span.start,
sa.span.end),b(sa),!0)));this.Bz(N,W,X)}}U$h(M){const Q=this.$ja();var U=this.z4e();const N=this.Lc.workbookContext.WorkbookFileName,W=[],X=new r.a(!1),sa=[];if(U=this.calcManager.extractReferences(M,U,N,!this.qff)){for(const da of U.Items)da.Range&&(U=y.D(da.Range),W.push(new D.a(U,Q)),this.NZ(U,X,1),sa.push(new n(da.Span.Start,M.substring(da.Span.Start,da.Span.End),c(da),!0)));this.Bz(W,X,sa)}else this.Uka&&this.Bz(null,null)}NZ(M,Q,U){let N=Q.getItem(M.toString());N||(N=O[Q.count%O.length],Q.add(M.toString(),
N));return String.format(N,U)}WOh(M,Q,U,N){M="["+M+", "+Q+"]";Q=U.getItem(M);Q||(Q=U.count%O.length,Q=O[Q],N===String.format(Q,1)&&(U.add("skip-"+M,Q),Q=U.count%O.length,Q=O[Q]),U.add(M,Q));return String.format(Q,1)}FE(M,Q,U,N,W=null,X=null){d.ULS.shipAssertTag(524039648,0,U<=N,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");U<N&&(Q=Q.substring(U,N),M.push(Object(f.a)(new A.a,{text:Q,color:W,backgroundColor:X})))}Bz(M,Q,U=null){M&&M.length?(d.ULS.sendTraceTag(524039647,
0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+M.length),M.reverse(),U.reverse(),this.gridView.qb.lx(M,[3],!0,(N,W)=>{if(N&&N.range&&W){d.ULS.shipAssertTag(524039643,0,Q.mb(N.range.toString()),`ColoredReferencesManager.HighlightRanges: The range '${N.range.toString()}' doesn't exist in the range to color dictionary`);var X=this.NZ(N.range,Q,.1),sa=this.NZ(N.range,Q,1);this.Lc.frame&&this.Lc.frame.tD&&this.Lc.frame.tD.zN||(W.style.background=X);W.style.borderColor=
sa;U&&(W.setAttribute(m.a.v6a,N.jU.toString()),N.metadata=U[N.jU])}else d.ULS.shipAssertTag(524039646,0,!!N,"ColoredReferencesManager.HighlightRanges: state is null"),d.ULS.shipAssertTag(524039645,0,!!N.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),d.ULS.shipAssertTag(524039644,0,!!W,"ColoredReferencesManager.HighlightRanges: div is null")})):(M=this.Lc.Jb.Ac("UserAction","HideRangesHighlightsStopwatch"),this.gridView.qb.Xg([3]),this.gridView.qb.HSa(new D.a(null,this.$ja()),
[3]),M.stop())}hyc(M,Q,U){const N=M.textBox;N.GF=!0;var W=N.selection;const X=W.index;W=X+W.length;N.setTextFromTextParts(Q);Q=N.text.length;N.selectRange(Math.min(X,Q),Math.min(W,Q));U&&M.FQa(new l.a);N.GF=!1}Hlc(M){this.Ori&&!this.rrf&&(d.ULS.sendTraceTag(521211935,0,50,M),this.rrf=!0)}$ja(){return this.Scc().sheetId}z4e(){return this.Scc().sheetName}Scc(){return this.gridView.dr&&this.gridView.dr.dG?this.gridView.dr.dG:this.Lc.oa}}Object(u.a)(G,"ColoredReferencesManager",null,[351,2]);class C extends e.a{constructor(M){super();
this.$=M;this.Fb()}create(){this.$.da.$a(266,M=>{M=v.EwaSettings.nl()||v.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?this.$.da.za(281)||this.$.da.Ga(281,new G(this.$,M)):new G(this.$,M);this.ob(M)})}static ka(M){M.da.Ga(282,new C(M))}}Object(u.a)(C,"ColoredReferencesManagerFactory",e.a,[]);var H=a(9);a.d(E,"a",function(){return I});const I=()=>{H.a.Fa(C.ka)}},1272:function(u,E,a){u=a(0);var c=a(222),b=a(809);class e extends c.a{constructor(h){super();this.$=
h;this.Fb()}create(){this.$.da.$a(266,h=>{h=this.$.da.za(294)||this.$.da.Ga(294,new b.RelativeAndAbsoluteReferencesManager(h));this.ob(h)})}static ka(h){h.da.Ga(295,new e(h))}}Object(u.a)(e,"RelativeAndAbsoluteReferencesManagerFactory",c.a,[]);var f=a(9);a.d(E,"a",function(){return d});const d=()=>{f.a.Fa(e.ka)}},1396:function(u,E,a){a.r(E);u=a(1206);E=a(1161);var c=a(1224);a=a(1272);Type.registerNamespace("_Ewa");Object(u.a)();Object(E.a)();Object(c.a)();Object(a.a)()},789:function(u,E,a){a.d(E,
"a",function(){return c});u=a(0);class c{}c.abs="Abs";c.rel="Rel";Object(u.a)(c,"PositionBaseType",null,[])},809:function(u,E,a){a.r(E);u=a(0);var c=a(7),b=a(15);class e{}Object(u.a)(e,"Reference",null,[]);class f extends e{constructor(){super();this.column=this.row=null}}Object(u.a)(f,"CellReference",e,[]);class d{constructor(){this.end=this.start=0;this.Lv=null}QPg(D,J){for(let L=0;L<this.Lv.length;L++){const T=this.R0b(D,this.Lv[L]);J+=T;L<this.Lv.length-1&&(J+=":")}return J}}Object(u.a)(d,"IReferenceSequence",
null,[]);var h=a(24),m=a(789);class l extends d{constructor(){super();this.Tic=!1}Kcc(){const {RelativeAndAbsoluteReferencesManager:D}=a(809),J=this.Lv[0];return D.gwf(J.row.kind===m.a.abs,J.column.kind===m.a.abs)}R0b(D,J){J=h.Range.Qc(J.row.index+1,J.column.index+1);return this.Tic?J.Fwb(1===D||3===D,1===D||2===D):J.oLa(1===D||3===D,1===D||2===D,!0,!0)}}Object(u.a)(l,"CellReferenceSequence",d,[]);class w extends e{constructor(){super();this.secondColumn=this.firstColumn=null}}Object(u.a)(w,"ColumnReference",
e,[]);class n extends d{constructor(){super()}Kcc(){const D=this.Lv[0];return a(809).RelativeAndAbsoluteReferencesManager.Duf(D.firstColumn,D.secondColumn).kind===m.a.abs?2:3}R0b(D,J){return h.Range.Pvb(J.firstColumn.index+1,J.secondColumn.index+1).oLa(1===D||3===D,!0,1===D||3===D,!0)}}Object(u.a)(n,"ColumnReferenceSequence",d,[]);class y extends e{constructor(){super();this.right=this.left=this.bottom=this.top=null}}Object(u.a)(y,"RangeReference",e,[]);class t extends d{constructor(){super()}Kcc(){const {RelativeAndAbsoluteReferencesManager:D}=
a(809),J=this.Lv[0];return D.gwf(J.top.kind===m.a.abs,J.left.kind===m.a.abs)}R0b(D,J){J=new h.Range(J.top.index+1,J.left.index+1,J.bottom.index+1,J.right.index+1,!1,!1);const L=1===D||3===D;D=1===D||2===D;return J.oLa(L,D,L,D)}}Object(u.a)(t,"RangeReferenceSequence",d,[]);class r extends e{constructor(){super();this.secondRow=this.firstRow=null}}Object(u.a)(r,"RowReference",e,[]);class v extends d{constructor(){super()}Kcc(){const D=this.Lv[0];return a(809).RelativeAndAbsoluteReferencesManager.Duf(D.firstRow,
D.secondRow).kind===m.a.abs?0:1}R0b(D,J){return h.Range.Mac(J.firstRow.index+1,J.secondRow.index+1).oLa(!0,1===D||2===D,!0,1===D||2===D)}}Object(u.a)(v,"RowReferenceSequence",d,[]);var B=a(980),A=a(981),z=a(173);a.d(E,"RelativeAndAbsoluteReferencesManager",function(){return x});class x{constructor(D){this.calcManager=D}$1a(D,J,L){let T,O;T=J;O=L;if(!D||!z.f(D))return{returnValue:D,eAd:T,dAd:O};var G=this.calcManager.CVe(D);if(!G)return b.ULS.sendTraceTag(524039641,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),
{returnValue:null,eAd:T,dAd:O};G=this.j0h(G,D,J,L);let C=0,H="",I=0,M=0;for(;M<G.length;M++)if(this.EMe(G[M],J,L)){C=G[M].Kcc();T=G[M].start;break}for(;M<G.length&&this.EMe(G[M],J,L);M++)H+=D.substring(I,G[M].start),H=G[M].QPg(C,H),I=G[M].end;I&&(O=H.length);H+=D.substring(I,D.length);return{returnValue:H,eAd:T,dAd:O}}j0h(D,J,L,T){const O=[];for(let I=0;I<D.length;I++){var G=D[I];if(G.kind===B.a.range)if(G=G.ref,G.type===A.a.cell){var C=G;G=Object(c.a)(new l,{start:G.span.start,end:G.span.end,Lv:[Object(c.a)(new f,
{column:C.col,row:C.row})],Tic:this.calcManager.g3b(G.span.end,J)});O.push(G)}else if(G.type===A.a.range)this.FMe(G.topLeftSpan,L,T)&&this.FMe(G.bottomRightSpan,L,T)?(C=new y,G.top.index<=G.bottom.index?(C.top=G.top,C.bottom=G.bottom):(C.bottom=G.top,C.top=G.bottom),G.left.index<=G.right.index?(C.left=G.left,C.right=G.right):(C.right=G.left,C.left=G.right),G=Object(c.a)(new t,{start:G.topLeftSpan.start,end:G.bottomRightSpan.end,Lv:[C]}),O.push(G)):(C=Object(c.a)(new l,{start:G.topLeftSpan.start,end:G.topLeftSpan.end,
Lv:[Object(c.a)(new f,{column:G.left,row:G.top})],Tic:this.calcManager.g3b(G.topLeftSpan.end,J)}),G=Object(c.a)(new l,{start:G.bottomRightSpan.start,end:G.bottomRightSpan.end,Lv:[Object(c.a)(new f,{column:G.right,row:G.bottom})],Tic:this.calcManager.g3b(G.topLeftSpan.end,J)}),O.push(C),O.push(G));else if(G.type===A.a.column){C=G;for(G=Object(c.a)(new n,{start:G.span.start,end:G.span.end,Lv:[Object(c.a)(new w,{firstColumn:C.startIndex,secondColumn:C.endIndex})]});G.end<J.length-1&&":"===J.charAt(G.end)&&
I<D.length-1;)if(C=D[I+1].ref,C.type===A.a.column&&C.span.start===G.end+1){var H=C;G.Lv.push(Object(c.a)(new w,{firstColumn:H.startIndex,secondColumn:H.endIndex}));G.end=C.span.end;I++}else break;O.push(G)}else if(G.type===A.a.row){C=G;for(G=Object(c.a)(new v,{start:G.span.start,end:G.span.end,Lv:[Object(c.a)(new r,{firstRow:C.startIndex,secondRow:C.endIndex})]});G.end<J.length-1&&":"===J.charAt(G.end)&&I<D.length-1;)if(C=D[I+1].ref,C.type===A.a.row&&C.span.start===G.end+1)H=C,G.Lv.push(Object(c.a)(new r,
{firstRow:H.startIndex,secondRow:H.endIndex})),G.end=C.span.end,I++;else break;O.push(G)}}return O}EMe(D,J,L){return!(D.start>L||J>D.end)}FMe(D,J,L){return!(D.start>L||J>D.end)}static Duf(D,J){return D.index<=J.index?D:J}static gwf(D,J){return J||D?J&&D?2:!J&&D?3:0:1}}Object(u.a)(x,"RelativeAndAbsoluteReferencesManager",null,[350])},936:function(u,E,a){a.r(E);u=a(0);var c=a(15),b=a(263),e;(function(v){v[v.paren=0]="paren";v[v.lead=1]="lead";v[v.intern=2]="intern";v[v.trail=3]="trail";v[v.undefined=
4]="undefined"})(e||(e={}));Object(u.b)("CurrencyFormatOption",e);var f;(function(v){v[v.none=-1]="none";v[v.mdy=0]="mdy";v[v.dmy=1]="dmy";v[v.ymd=2]="ymd";v[v.myd=3]="myd";v[v.dym=4]="dym";v[v.ydm=5]="ydm"})(f||(f={}));Object(u.b)("DateOrderOption",f);var d=a(8);class h{constructor(v,B){({CalcHelper:v}=a(936));B&&(B.Je||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.Dxg=v.xHe(B,v.kHe(B.Fja));this.Exg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.Exg}get localeData(){return this.Dxg}formatNumber(v){return this.localeInfo.formatNumber(v)}}
Object(u.a)(h,"LocaleHolder",null,[]);var m=a(978),l=a(53),w=a(1),n=a(22),y=a(13),t=a(200);a.d(E,"CalcHelper",function(){return r});class r{constructor(v){this.$=v;(this.py=this.$.da.za(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let B;B=w.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?l.a.current.fo(76):l.a.current.fo(79);this.logger=new m.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.nca=new h(v,this.py);excelOnlineCalc.config.initCalc(this.logger,this.py?A=>this.py.isFeatureEnabled(A):()=>!1,B);this.osg=excelOnlineCalc.config.calcConfig(this.nca.localeInfo)}get config(){return this.osg}agh(){if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.xa)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const v=this.$.xa.oa;
return v?v.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.xa.oa.index}createParser(){const v={};v.config=this.config;return excelOnlineCalc.parse.createParser(v)}createNumberFormatter(){const v=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(B,A)=>excelOnlineCalc.calc.getTime(this.config,B,A,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(v)}meh(v,B,A,z){if(!z)return{range:{row:B,col:A},sheet:{document:this.documentLoc,
index:v}};B=excelOnlineCalc.location.gridCell(B,A);v=excelOnlineCalc.location.sheetIndex(this.documentLoc,v);return excelOnlineCalc.location.sheetGridCell(v,B)}yrh(v,B){let A;A=excelOnlineCalc.calc.getEvalResultKind(v);switch(A){case 4:return{returnValue:v?this.nca.localeInfo.trueName:this.nca.localeInfo.falseName,kind:A};case 1:return{returnValue:w.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.dCc(this.nca.formatNumber(v),B):this.nca.formatNumber(v),
kind:A};case 2:return{returnValue:w.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.dCc(v.toString(),B):v.toString(),kind:A};case 128:return{returnValue:"",kind:A};case 8:switch(v.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.nca.localeInfo.errorNames[v.type],kind:A};default:return{returnValue:r.unknownError,kind:A}}case 32:return{returnValue:w.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.dCc(this.Deh(v,B),B):"##UNSUPPORTED: ARRAY",kind:A};default:return{returnValue:y.a.instance.ga(2214),kind:A}}}dCc(v,B){return v.length<=B?v:v.substring(0,B-3)+"..."}Deh(v,B){let A=this.nca.localeInfo.leftBrace;for(let z=0;z<v.rows;++z){for(let x=0;x<v.cols;++x)A+=v.opers[z][x],x<v.cols-1&&(A+=this.nca.localeInfo.columnSeparator);z<v.rows-1&&(A+=this.nca.localeInfo.rowSeparator)}return this.dCc(A,B-1)+this.nca.localeInfo.rightBrace}static xHe(v,B=null){const A=r.H5b(),z=v.Je.TrueValueString,x=
v.Je.FalseValueString,D=v.Je.DecimalSeparator.toString(),J=v.Je.ListSeparator.toString(),L=v.Je.ColumnSeparator.toString(),T=v.Je.RowSeparator.toString(),O=v.Je.ThousandsDataArray,G=v.Je.ThousandSeparator.toString(),C=v.Je.Lcid,H=v.Je.Country,I=v.Je.DigitsNumber,M=v.Je.ExpSeparatedBySpace,Q=v.Je.FractionSeparator.toString(),U=v.Je.PercentSeparatedBySpace,N=n.a.o_g(Enum.toString(e,v.Je.CurrencyFormat)),W=v.Je.CurrencySymbolLead,X=v.Je.CurrencySeparatedBySpace,sa=v.Je.CurrencySymbolString,da=v.Je.DigitsCurrency,
S=-1===v.Je.DateOrder?"MDY":t.e(Enum.toString(f,v.Je.DateOrder)),oa=v.Je.DateSeparator.toString(),K=v.Je.DateAlternativeSeparator.toString(),ea=v.Je.Year4Digits,ya=v.Je.Month2Digits,ha=v.Je.Day2Digits,La=v.Je.LongDateFormat,Ia=v.Je.TimeSeparator.toString(),ra=v.Je.TimeAltSeparator,pa=v.Je.Hour2Digits,ba=v.Je.Use24HourClock,fa=v.Je.AmPmSeparatedBySpace,Ka=[v.Je.AmString,v.Je.PmString],aa=v.Je.DayNameShortArray,ja=v.Je.DayNameLongArray,Va=v.Je.MonthNameShortArray,bb=v.Je.MonthNameLongArray,wa=v.Je.PictureSpecialArray,
ka=b.a.map(("\x00"+v.Je.PictureSingleString).split(""),ic=>"\x00"===ic?null:ic),ta=v.Je.PictureColorArray,qa=v.Je.PictureDbnumArray,rb=v.Je.RowLetter.toString(),Za=v.Je.ColumnLetter.toString(),gb=v.Je.LeftBrace.toString(),mb=v.Je.RightBrace.toString(),Ga=v.Je.LeftBracket.toString(),ib=v.Je.RightBracket.toString(),cc=r.a1h(v.Je);return excelOnlineCalc.calc.localeData(B,A,z,x,rb,Za,gb,mb,Ga,ib,D,J,L,T,O,G,C,H,I,M,Q,U,N,W,X,sa,da,S,oa,K,ea,ya,ha,La,Ia,ra,pa,ba,fa,Ka,aa,ja,Va,bb,wa,ka,ta,qa,cc,v.Je.SysDateFormatString,
v.Je.SysTimeFormatString)}static kHe(v){const B=[];if(!v)return B;for(const A of v)v=null,A.IsDynamicUdf||(v=excelOnlineCalc.calc.worksheetFunctionName(A.FunctionIndexInServer,A.NameUI)),v&&B.push(v);return B}static H5b(){const v=[],B=Object.keys(d.a.errorNames);for(let A=0;A<B.length;A++){const z=excelOnlineCalc.calc.errorTypeName(A+1,B[A]);z&&v.push(z)}return v}static a1h(v){const B=Array(6);B[1]="#"+v.AllStructRefString;B[3]="#"+v.HeadersStructRefString;B[2]="#"+v.DataStructRefString;B[4]="#"+
v.TotalsStructRefString;B[5]="#"+v.ThisRowStructRefString;return B}}r.unknownError="##ERR##";Object(u.a)(r,"CalcHelper",null,[])},980:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{}c.Iwi="literal";c.operator="operator";c.func="function";c.namedRange="namedRange";c.range="range";c.Jof="letName";c.all="*";c.UWd="structRefRange";Object(u.a)(c,"TraverseFormulaInterestTypes",null,[])},981:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{}c.cell="cell";c.range="range";c.row=
"row";c.column="col";Object(u.a)(c,"TraverseFormulaRefTypes",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.calc.js.map/11279ee2d35afb0e380514c2fa54bb32/EwaDSEsNext.calc.js.map