'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[35],{1283:function(u,E,a){a.r(E);u=a(0);var c=a(15),b=a(97),e=a(78),f=a(11),d=a(222);class h extends d.a{constructor(n){super();this.$=n;this.Fb()}create(){const {RenderingFidelityTracker:n}=a(1283);let y=this.$.da.za(462);y||(y=this.$.da.Ga(462,new n));this.ob(y)}}Object(u.a)(h,"RenderingFidelityTrackerFactory",d.a,[]);var m=a(39),l=a(1);a.d(E,"RenderingFidelityTracker",function(){return w});class w extends e.a{constructor(){super();
this.WEi=3E4;this.Nfb={};this.O1d={};this.bxe={};b.Health.instance.addQosPillar("Fidelity")}static ka(n){n.da.Ga(463,new h(n))}GOg(n,y,t,r){if(!(m.PageLoadTrackingInfo.instance.jwa(new Date)<this.WEi)){var v=f.HelperMethods.t6(()=>{var B=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(y),A=Object.keys(B),z=this.bxe[n];for(var x=0;x<A.length;x++){var D=A[x];this.O1d[D]||(null===z||void 0===z?0:z[D])&&this.Nfb[D]&&(this.Nfb[D]-=z[D])}this.bxe[n]=B;x=l.EwaSettings.isChangeGateEnabled("OfficeVSO:7190709_ThickAndMediumBorder");
for(D=0;D<A.length;D++){z=A[D];if(this.O1d[z])continue;let J=B[z];this.Nfb[z]&&(J+=this.Nfb[z]);if(gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(z,J)){this.O1d[z]=!0;B=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(z);A=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(z);x=x?!("ThickBorder"===z||"MediumBorder"===z):!0;B&&A&&x&&b.Health.instance.recordQosError(B,[A],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+
z+", isHC:"+t+", scaleFactor:"+r+"}");break}else this.Nfb[z]=J}});1<v&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${v}`)}}}Object(u.a)(w,"RenderingFidelityTracker",e.a,[496,2])},1426:function(u,E,a){function c(Ba){var Ea=Ba.replace(/-.*/g,()=>"");Ea=uc.get(Ea);return null!==Ea&&void 0!==Ea?Ea:Ba.startsWith("ooux")?"ooux":"other"}a.r(E);var b=a(0),e=a(15);class f{constructor(){this.WinOrientation=
this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=
this.NavUserAgent=this.NavPlugins=null}}Object(b.a)(f,"BrowserInfo",null,[]);class d{constructor(){this.Version=this.Name=null}}Object(b.a)(d,"PluginInfo",null,[]);var h=a(4),m=a(27);class l{static gzi(){if(h.AFrameworkApplication.fa.qa("LogBrowserInfoIsEnabled")){var Ba=l.hJh();try{const Ea=JSON.stringify(Ba);e.ULS.sendTraceTag(6903563,102,50,Ea)}catch(Ea){e.ULS.sendTraceTag(6903564,102,15,Ea.message)}}else e.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static rYh(){const Ba=
window.navigator.plugins;if(!Ba||!Ba.length)return null;const Ea=[];for(let rc=0;rc<Ba.length;rc++){const wd=Ba[rc].name,Pd=Ba[rc].version;Array.add(Ea,Object.assign(new d,{Name:wd,Version:Pd}))}return Ea}static hJh(){const Ba=new f,Ea=new Sys.StringBuilder;l.Ft(rc=>{Ba.DocElemClientHeight=rc},()=>document.documentElement.clientHeight,Ea);l.Ft(rc=>{Ba.DocElemClientWidth=rc},()=>document.documentElement.clientWidth,Ea);l.Ft(rc=>{Ba.DocElemOffsetHeight=rc},()=>document.documentElement.offsetHeight,
Ea);l.Ft(rc=>{Ba.DocElemOffsetWidth=rc},()=>document.documentElement.offsetWidth,Ea);l.Ft(rc=>{Ba.ScreenAvailHeight=rc},()=>window.screen.availHeight,Ea);l.Ft(rc=>{Ba.ScreenAvailWidth=rc},()=>window.screen.availWidth,Ea);l.Ft(rc=>{Ba.ScreenWidth=rc},()=>window.screen.width,Ea);l.Ft(rc=>{Ba.ScreenHeight=rc},()=>window.screen.height,Ea);l.Ft(rc=>{Ba.ScreenLogicalXdpi=rc},()=>window.screen.logicalXDPI,Ea);l.Ft(rc=>{Ba.ScreenLogicalYdpi=rc},()=>window.screen.logicalYDPI,Ea);l.Ft(rc=>{Ba.ScreenDeviceXdpi=
rc},()=>window.screen.deviceXDPI,Ea);l.Ft(rc=>{Ba.ScreenDeviceYdpi=rc},()=>window.screen.deviceYDPI,Ea);l.Ft(rc=>{Ba.WinInnerHeight=rc},()=>window.self.innerHeight,Ea);l.Ft(rc=>{Ba.WinInnerWidth=rc},()=>window.self.innerWidth,Ea);l.Ft(rc=>{Ba.WinOuterHeight=rc},()=>window.self.outerHeight,Ea);l.Ft(rc=>{Ba.WinOuterWidth=rc},()=>window.self.outerWidth,Ea);l.Ft(rc=>{Ba.WinOrientation=rc},()=>window.self.orientation,Ea);l.Ft(rc=>{Ba.WinDevicePixelRatio=rc},()=>window.self.devicePixelRatio,Ea);l.Ft(rc=>
{Ba.SupportsTouch=rc},()=>m.a.RAc,Ea);l.Ft(rc=>{Ba.NavAppName=rc},()=>window.navigator.appName,Ea);l.Ft(rc=>{Ba.NavAppVersion=rc},()=>window.navigator.appVersion,Ea);l.Ft(rc=>{Ba.NavLanguage=rc},()=>window.navigator.browserLanguage||window.navigator.language,Ea);l.Ft(rc=>{Ba.NavUserAgent=rc},()=>window.navigator.userAgent,Ea);l.Ft(rc=>{Ba.NavPlatform=rc},()=>window.navigator.platform,Ea);l.Ft(rc=>{Ba.NavPlugins=rc},l.rYh,Ea);l.Ft(rc=>{Ba.CalculatedDevicePixelRatio=rc},()=>l.devicePixelRatio,Ea);Ba.Error=
Ea.toString();return Ba}static get devicePixelRatio(){const Ba=window.devicePixelRatio;return isNaN(Ba)?window.screen.deviceXDPI/window.screen.logicalXDPI:Ba}static Ft(Ba,Ea,rc){try{const wd=Ea();Ba(wd)}catch(wd){rc.isEmpty()||rc.append(" | "),rc.append(wd.message||"null")}}}Object(b.a)(l,"BrowserInfoLogger",null,[]);var w=a(248);class n{get name(){return"Common.App.BrowserInfoLogger"}Wh(){}init(){l.gzi()}dispose(){}static main(){w.a.instance.Fi(new n)}}Object(b.a)(n,"BrowserInfoLoggerPackage",null,
[4,5]);var y=a(80);class t{constructor(Ba){this.mGc=Ba}Pgf(Ba){if(!this.mGc)return!0;Ba=y.a.sgd(Ba);if(!Ba)return!1;Ba=Ba.toLowerCase();for(let Ea=0;Ea<this.mGc.length;Ea++)if(Ba.endsWith(this.mGc[Ea]))return!0;return!1}}Object(b.a)(t,"DomainAllowListManager",null,[]);class r{constructor(Ba,Ea){this.haa=null;this.MTc=Ba;this.url=Ea}get X0d(){return y.a.Eda(this.url)}get Yt(){return this.MTc}NYd(){const Ba={},Ea=this.Yt;Ba.a=this.X0d;Ba.b=this.round(Ea.navigationStart);Ba.c=this.round(Ea.unloadEventStart);
Ba.d=this.round(Ea.unloadEventEnd);Ba.e=this.round(Ea.redirectStart);Ba.f=this.round(Ea.redirectEnd);Ba.g=this.round(Ea.fetchStart);Ba.h=this.round(Ea.domainLookupStart);Ba.i=this.round(Ea.domainLookupEnd);Ba.j=this.round(Ea.connectStart);Ba.k=this.round(Ea.connectEnd);Ba.l=void 0!==Ea.secureConnectionStart&&null!==Ea.secureConnectionStart?this.round(Ea.secureConnectionStart):0;Ba.m=this.round(Ea.requestStart);Ba.n=this.round(Ea.responseStart);Ba.o=this.round(Ea.responseEnd);Ba.q=this.round(Ea.domInteractive);
Ba.r=this.round(Ea.domContentLoadedEventStart);Ba.s=this.round(Ea.domContentLoadedEventEnd);Ba.t=this.round(Ea.domComplete);Ba.u=this.round(Ea.loadEventStart);Ba.v=this.round(Ea.loadEventEnd);Ba.w=this.haa;return Ba}round(Ba){return Math.round(1E3*Ba)/1E3}}Object(b.a)(r,"PerformanceTimingEntry",null,[]);const v=(Ba,Ea)=>{const rc={};let wd=null;switch(Ba){case 0:wd="ResourceTiming";Ba=Ea.a;null!=Ba&&(rc.Url=Ba);Ba=Ea.b;null!=Ba&&(rc.InitiatorType=Ba);Ba=null==Ea.c?null:Ea.c.toString();null!=Ba&&(rc.RedirectStart=
Ba);Ba=null==Ea.d?null:Ea.d.toString();null!=Ba&&(rc.RedirectEnd=Ba);Ba=null==Ea.e?null:Ea.e.toString();null!=Ba&&(rc.FetchStart=Ba);Ba=null==Ea.f?null:Ea.f.toString();null!=Ba&&(rc.DomainLookupStart=Ba);Ba=null==Ea.g?null:Ea.g.toString();null!=Ba&&(rc.DomainLookupEnd=Ba);Ba=null==Ea.h?null:Ea.h.toString();null!=Ba&&(rc.ConnectStart=Ba);Ba=null==Ea.i?null:Ea.i.toString();null!=Ba&&(rc.ConnectEnd=Ba);Ba=null==Ea.j?null:Ea.j.toString();null!=Ba&&(rc.SecureConnectionStart=Ba);Ba=null==Ea.k?null:Ea.k.toString();
null!=Ba&&(rc.RequestStart=Ba);Ba=null==Ea.l?null:Ea.l.toString();null!=Ba&&(rc.ResponseStart=Ba);Ba=null==Ea.m?null:Ea.m.toString();null!=Ba&&(rc.ResponseEnd=Ba);Ba=Ea.n;null!=Ba&&(rc.CustomText=Ba);Ba=null==Ea.o?null:Ea.o.toString();null!=Ba&&(rc.DecodedBodySize=Ba);Ba=null==Ea.p?null:Ea.p.toString();null!=Ba&&(rc.EncodedBodySize=Ba);Ea=null==Ea.q?null:Ea.q.toString();null!=Ea&&(rc.TransferSize=Ea);break;case 1:wd="PerformanceTiming",Ba=Ea.a,null!=Ba&&(rc.Url=Ba),Ba=null==Ea.b?null:Ea.b.toString(),
null!=Ba&&(rc.NavigationStart=Ba),Ba=null==Ea.c?null:Ea.c.toString(),null!=Ba&&(rc.UnloadEventStart=Ba),Ba=null==Ea.d?null:Ea.d.toString(),null!=Ba&&(rc.UnloadEventEnd=Ba),Ba=null==Ea.e?null:Ea.e.toString(),null!=Ba&&(rc.RedirectStart=Ba),Ba=null==Ea.f?null:Ea.f.toString(),null!=Ba&&(rc.RedirectEnd=Ba),Ba=null==Ea.g?null:Ea.g.toString(),null!=Ba&&(rc.FetchStart=Ba),Ba=null==Ea.h?null:Ea.h.toString(),null!=Ba&&(rc.DomainLookupStart=Ba),Ba=null==Ea.i?null:Ea.i.toString(),null!=Ba&&(rc.DomainLookupEnd=
Ba),Ba=null==Ea.j?null:Ea.j.toString(),null!=Ba&&(rc.ConnectStart=Ba),Ba=null==Ea.k?null:Ea.k.toString(),null!=Ba&&(rc.ConnectEnd=Ba),Ba=null==Ea.l?null:Ea.l.toString(),null!=Ba&&(rc.SecureConnectionStart=Ba),Ba=null==Ea.m?null:Ea.m.toString(),null!=Ba&&(rc.RequestStart=Ba),Ba=null==Ea.n?null:Ea.n.toString(),null!=Ba&&(rc.ResponseStart=Ba),Ba=null==Ea.o?null:Ea.o.toString(),null!=Ba&&(rc.ResponseEnd=Ba),Ba=null==Ea.p?null:Ea.p.toString(),null!=Ba&&(rc.DomLoading=Ba),Ba=null==Ea.q?null:Ea.q.toString(),
null!=Ba&&(rc.DomInteractive=Ba),Ba=null==Ea.r?null:Ea.r.toString(),null!=Ba&&(rc.DomContentLoadedEventStart=Ba),Ba=null==Ea.s?null:Ea.s.toString(),null!=Ba&&(rc.DomContentLoadedEventEnd=Ba),Ba=null==Ea.t?null:Ea.t.toString(),null!=Ba&&(rc.DomComplete=Ba),Ba=null==Ea.u?null:Ea.u.toString(),null!=Ba&&(rc.LoadEventStart=Ba),Ba=null==Ea.v?null:Ea.v.toString(),null!=Ba&&(rc.LoadEventEnd=Ba),Ea=Ea.w,null!=Ea&&(rc.CustomText=Ea)}rc.Table=wd;return Sys.Serialization.JavaScriptSerializer.serialize(rc)};var B=
a(52),A=a(218),z=a(321);class x{constructor(Ba,Ea=null,rc=null){this.Sg=Ba;this.W0d=this;this.Mug=Ea||(()=>window.location.href);this.mJc=new t(rc)}run(){if(x.WP(window.performance))try{const Pd=this.Mug();if(x.kDg.exec(Pd)&&this.mJc.Pgf(Pd)){var Ba=new r(window.performance.timing,Pd);z.a.instance.D$i(Ba.Yt.fetchStart);z.a.instance.E$i(Ba.Yt.navigationStart);z.a.instance.dEb(B.a.fIh,"connectStart","requestStart");z.a.instance.dEb(B.a.nIh,"requestStart","responseStart");z.a.instance.dEb(B.a.qIh,"responseStart",
"responseEnd");this.W0d.Qe(1,Ba.NYd());this.Sg.sn(B.a.vva,Ba.Yt.fetchStart);this.Sg.sn(B.a.kIh,Ba.Yt.domainLookupStart);this.Sg.sn(B.a.jIh,Ba.Yt.domainLookupEnd);this.Sg.sn(B.a.hIh,Ba.Yt.connectStart);this.Sg.sn(B.a.rIh,Ba.Yt.secureConnectionStart);this.Sg.sn(B.a.gIh,Ba.Yt.connectEnd);this.Sg.sn(B.a.oIh,Ba.Yt.requestStart);this.Sg.sn(B.a.sdd,Ba.Yt.responseStart);this.Sg.sn(B.a.lIh,Ba.Yt.responseEnd-Ba.Yt.responseStart);this.Sg.sn(B.a.pIh,Ba.Yt.responseStart-Ba.Yt.requestStart);var Ea=0,rc=0,wd=0;
({transferSize:Ea,B9c:rc,g7c:wd}=this.eSj(Pd)).returnValue&&(this.Sg.sn(B.a.sIh,Ea),this.Sg.sn(B.a.iIh,wd),this.Sg.sn(B.a.mIh,rc));this.Sg.sn(B.a.rdd,Ba.Yt.navigationStart)}}catch(Pd){e.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Pd)}}eSj(Ba){let Ea,rc,wd;wd=rc=Ea=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Ea,B9c:rc,g7c:wd};Ba=window.performance.getEntriesByName(Ba,"navigation");
if(void 0===Ba||null===Ba||1!==Ba.length)return{returnValue:!1,transferSize:Ea,B9c:rc,g7c:wd};Ba=Ba[0];var Pd=Ba.transferSize;void 0!==Ea&&null!==Ea&&(Ea=Pd);Pd=Ba.decodedBodySize;void 0!==Pd&&null!==Pd&&(wd=Pd);Ba=Ba.encodedBodySize;void 0!==Ba&&null!==Ba&&(rc=Ba);return{returnValue:!0,transferSize:Ea,B9c:rc,g7c:wd}}Qe(Ba,Ea){e.ULS.sendTraceTag(4551815,306,50,v(Ba,Ea))}static get instance(){return x.Ma||(x.Ma=new x(A.a.instance,null,h.AFrameworkApplication.fa.qa("PerfTimingLoggerFilterDomainsIsEnabled")?
h.AFrameworkApplication.fa.Cw("ResourceLoggerDomainAllowList"):null))}static WP(Ba){return!(void 0===Ba||null===Ba)&&!(void 0===Ba.timing||null===Ba.timing)}}x.Ma=null;x.kDg=RegExp("^https?://.*","i");Object(b.a)(x,"PerformanceTimingLogger",null,[511]);var D=a(96),J=a(83);class L{constructor(Ba,Ea){this.haa=null;this.MTc=Ba;this.behavior=Ea;this.url=this.Yt.name}get X0d(){return 2===this.behavior?this.url:y.a.Eda(this.url)}get Yt(){return this.MTc}NYd(){const Ba={},Ea=this.Yt;Ba.a=this.X0d;Ba.b=Ea.initiatorType;
Ba.c=this.round(Ea.redirectStart);Ba.d=this.round(Ea.redirectEnd);Ba.e=this.round(Ea.fetchStart);Ba.f=this.round(Ea.domainLookupStart);Ba.g=this.round(Ea.domainLookupEnd);Ba.h=this.round(Ea.connectStart);Ba.i=this.round(Ea.connectEnd);Ba.j=void 0!==Ea.secureConnectionStart&&null!==Ea.secureConnectionStart?this.round(Ea.secureConnectionStart):0;Ba.k=this.round(Ea.requestStart);Ba.l=this.round(Ea.responseStart);Ba.m=this.round(Ea.responseEnd);Ba.o=this.round(L.k5a(Ea,"decodedBodySize"));Ba.p=this.round(L.k5a(Ea,
"encodedBodySize"));Ba.q=this.round(L.k5a(Ea,"transferSize"));Ba.n=this.haa;return Ba}round(Ba){return Math.round(1E3*Ba)/1E3}static k5a(Ba,Ea){return Ba[Ea]}}Object(b.a)(L,"ResourceTimingEntry",null,[594]);var T=a(97),O=a(136),G=a(41),C=a(111),H=a(189);class I{constructor(Ba,Ea=null,rc=100){this.M4d=Ba;this.fYb=Ea;this.ohb={};this.xrg=rc}uRj(Ba){var Ea=Ba.name.toLowerCase();const rc=y.a.gwa(Ea);this.slj(rc,Ea)&&(rc in this.ohb?e.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
rc):(Ea={},Ea.fetchstart=Ba.fetchStart,Ea.responseend=Ba.responseEnd,Ea.iscached=this.fsi(Ba),Ea.encodedsize=L.k5a(Ba,"encodedBodySize"),Ea.decodedsize=L.k5a(Ba,"decodedBodySize"),this.ohb[rc]=Ea))}slj(Ba,Ea){if(this.M4d)return Array.contains(this.M4d,Ba);if(this.fYb)for(Ba=y.a.hN(Ea),Ea=0;Ea<this.fYb.length;Ea++)if(this.fYb[Ea]&&Ba.endsWith(this.fYb[Ea]))return!0;return!1}fsi(Ba){try{const Ea=L.k5a(Ba,"transferSize");if(void 0!==Ea&&null!==Ea)return!Ea;e.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return Ba.responseEnd-Ba.fetchStart<this.xrg}catch(Ea){e.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Ea.message)}return!1}aaj(){if(C.a.Dh(this.ohb))e.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var Ba=h.AFrameworkApplication.sF?h.AFrameworkApplication.sF.split(";"):[],Ea=Object.assign(new H.a,{extendedProperties:O.a.fs()});Ea.extendedProperties.set("Flights",G.c(Ba));
this.ozi(Ea,this.ohb,T.Health.instance)}}ozi(Ba,Ea,rc){if(Ea){var wd=0,Pd=0,te=0,af=0,Cf=0,Of=0,Ef=0,ig=0,Wf=0,og=0,Xf=0;for(let qg in Ea){var xg=Ea[qg];try{const Yf=Object(J.a)(Object,xg);if(!Yf)continue;const dh=Yf.iscached?Boolean.parse(Yf.iscached.toString()):!1,Bf=Yf.fetchstart?this.parseFloat(Yf.fetchstart.toString()):0,Bg=(Yf.responseend?this.parseFloat(Yf.responseend.toString()):0)-Bf,Hg=Yf.encodedsize?this.parseFloat(Yf.encodedsize.toString()):0,Ig=Yf.decodedsize?this.parseFloat(Yf.decodedsize.toString()):
0;wd+=Bg;af+=Hg;Ef+=Ig;og++;dh?(te+=Bg,Of+=Hg,Wf+=Ig,Xf++):(Pd+=Bg,Cf+=Hg,ig+=Ig)}catch(Yf){e.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Yf.message)}}Ba.extendedProperties.set("StaticResources",G.c(Ea));Ba.extendedProperties.set("TotalResourceDownloadLatency",wd.toString());Ba.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Pd.toString());Ba.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",te.toString());
Ba.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",af.toString());Ba.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Cf.toString());Ba.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Of.toString());Ba.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Ef.toString());Ba.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",ig.toString());Ba.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Wf.toString());
Ba.extendedProperties.set("TotalNumberOfResourcesDownloaded",og.toString());Ba.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Xf.toString());rc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);rc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",Ba)}}parseFloat(Ba){if(!Ba)return 0;Ba=parseFloat(Ba);return isNaN(Ba)?0:Ba}}Object(b.a)(I,"AppStaticResourceManager",null,[]);class M extends Sys.EventArgs{constructor(Ba){super();
this.entries=Ba}}Object(b.a)(M,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var Q=a(106);class U{constructor(Ba,Ea,rc=null,wd=null,Pd=100){this.jNc=!1;this.Xi=null;this.qib=0;this.fb=new D.a;this.thb=null;this.fT=!1;this.xle=0;this.he=Ba;this.E7d=0;this.W0d=this;this.mJc=new t(rc);this.dv=Ea;wd&&(this.thb=new I(null,wd,Pd))}get Ixe(){try{return!(void 0===this.dv||null===this.dv)&&!(void 0===this.dv.getEntriesByType||null===this.dv.getEntriesByType)}catch(Ba){return e.ULS.sendTraceTag(50873240,306,
10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",Ba),!1}}get whh(){return this.E7d}get isActive(){return this.fT}get CYd(){return this.xle}cKg(Ba){this.fb.addHandler(U.h$c,Ba)}tfj(Ba){this.fb.removeHandler(U.h$c,Ba)}Wh(Ba,Ea){const rc=this.CYd!==Ba;this.xle=Ba;this.isActive&&this.he&&rc&&(this.np(),this.Eg());this.E7d=Ea}activate(){!this.isActive&&this.Ixe&&(this.Eg(),this.fT=!0)}deactivate(Ba){this.isActive&&(this.np(),Ba&&this.flush(),this.fT=!1)}flush(){if(this.isActive&&
this.Ixe)try{var Ba=window.performance.getEntriesByType("resource");0<Ba.length-this.qib&&e.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",Ba.length-this.qib);const Ea=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);Ea&&(window.performance.clearResourceTimings(),this.qib=0);const rc=[];for(let wd=this.qib;wd<Ba.length;wd++)this.mJc.Pgf(Ba[wd].name)&&(this.thb&&this.thb.uRj(Ba[wd]),
rc.push(new L(Ba[wd],this.whh)));Ea||(this.qib=Ba.length);this.fb.raiseEvent(U.h$c,new M(rc));for(Ba=0;Ba<rc.length;Ba++)0!==rc[Ba].behavior&&2!==rc[Ba].behavior||this.W0d.Qe(0,rc[Ba].NYd());0<rc.length&&e.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",rc.length)}catch(Ea){e.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Ea)}}Qe(Ba,Ea){e.ULS.sendTraceTag(4310804,306,50,v(Ba,Ea))}C$i(){this.thb.aaj()}Eg(){this.he&&
0<this.CYd&&(this.Xi=new Q.a(3,2,1E3*this.CYd,()=>{this.flush()},5),this.he.Eg(this.Xi),this.jNc=!0)}np(){this.jNc&&(this.he.np(this.Xi),this.Xi=null,this.jNc=!1)}}U.h$c="EntriesAvailable";Object(b.a)(U,"ResourceTimingLogger",null,[492,511]);var N=a(119);class W{constructor(){this.gb=null}get name(){return"Common.ResourceTiming"}init(){this.gb.resolve("Common.NetworkTiming.IResourceTimingLogger");x.instance.run()}dispose(){}Wh(Ba){this.gb=Ba;let Ea=null;if(h.AFrameworkApplication.fa.qa("ResourceLoggerFilterDomainsIsEnabled"))try{Ea=
h.AFrameworkApplication.fa.Cw("ResourceLoggerDomainAllowList")}catch(Pd){e.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const rc=[];rc.push(y.a.hN(N.a.HL).toLowerCase());rc.push(y.a.hN(N.a.deb).toLowerCase());const wd=h.AFrameworkApplication.fa.rd("AppStaticResourceMonitorCacheThresholdInMs",100);Ba.register(492,"Common.NetworkTiming.IResourceTimingLogger").xc().Fc(()=>new U(h.AFrameworkApplication.Gi,window.performance,Ea,rc,wd))}static main(){w.a.instance.Fi(new W)}}
Object(b.a)(W,"ResourceTimingPackage",null,[4,5]);var X=a(84);class sa extends Sys.EventArgs{constructor(Ba,Ea){super();this.vNj=Ba;this.actualValue=Ea}}Object(b.a)(sa,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var da=a(165);class S{constructor(){this.dWa=[];this.c7d=this.BIc=0;this.sfa=null;this.fb=new D.a}init(Ba,Ea,rc){this.sfa=Ba;this.BIc=Ea;this.c7d=rc;this.sfa.Zqe(Object(X.a)(this,this.AMi,"onCpuMeterFrameAvailable"));this.pLg(Object(X.a)(this,this.h9g,"cpuPercentThresholdExceeded"))}AMi(Ba,
Ea){Ea.Wvf&&(Array.enqueue(this.dWa,Ea.Wvf.CP),this.dWa.length>this.c7d&&(Array.dequeue(this.dWa),this.U0g()))}U0g(){var Ba=this.dWa.length;let Ea=0;for(let rc=0;rc<Ba;rc++){const wd=Array.dequeue(this.dWa);Ea+=wd;Array.enqueue(this.dWa,wd)}Ba=Ea/Ba;Ba>this.BIc&&this.fb.raiseEvent("CPTTE",new sa(this.BIc,Ba))}h9g(Ba,Ea){da.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.hah(Ea.vNj,Ea.actualValue))}pLg(Ba){this.fb.addHandler("CPTTE",Ba)}hah(Ba,Ea){const rc={};rc.ThresholdValue=
Ba;rc.ActualValue=Ea;return rc}}Object(b.a)(S,"CpuMeterMonitor",null,[526]);var oa=a(157);class K{constructor(){this.S=this.T=this.M=this.C=0}}Object(b.a)(K,"ProfileInformation",null,[]);var ea=a(14),ya=a(45),ha=a(264);class La{constructor(Ba=0,Ea=0){this.KLc=!1;this.oEa={};this.wVb=Ba;this.FVb=Ea;this.ZTc=0;ya.a.addHandler(window.self,ea.a.UNg,()=>{this.KLc=!0});ya.a.addHandler(window.self,ea.a.VNg,()=>{this.KLc=!1})}vse(Ba,Ea,rc){const wd=La.generateKey(Ea,rc);wd in this.oEa?Ea=this.oEa[wd]:(Ea=
new K,Ea.S=rc?1:0,this.oEa[wd]=Ea,this.ZTc++);Ea.C++;Ea.M=Ba>Ea.M?Ba:Ea.M;Ea.T+=Ba}kH(Ba,Ea){this.vse(Ba,Ea,!1);this.KLc&&this.vse(Ba,Ea,!0)}getData(){if(0<this.FVb&&this.ZTc>this.FVb)return this.cQh();const Ba=0<this.wVb,Ea={},rc=this.oEa;for(let Pd in rc){var wd=Pd;const te=rc[Pd];this.KYf(te);Ba&&te.T>=this.wVb&&(Ea[wd]=te)}return Ba?C.a.Dh(Ea)?null:Ea:this.oEa}cQh(){var Ba=0<this.wVb,Ea=[];const rc=this.oEa;for(let wd in rc){const Pd={key:wd,value:rc[wd]};let te=Pd.value;(!Ba||te.T>=this.wVb)&&
Array.add(Ea,Pd)}if(Ea.length>this.FVb)Ea.sort((wd,Pd)=>Pd.value.T-wd.value.T),Ea=Ea.slice(0,this.FVb);else if(!Ea.length)return null;Ba={};for(const wd of Ea)Ea=wd.value,this.KYf(Ea),Ba[wd.key]=Ea;return Ba}KYf(Ba){Ba.M=ha.a.A7(Ba.M,0);Ba.T=ha.a.A7(Ba.T,0)}reset(){this.oEa={};this.ZTc=0}static generateKey(Ba,Ea){return Ea?Ba+" [it]":Ba}}Object(b.a)(La,"FunctionCallAggregator",null,[513]);class Ia{}Ia.XSg="BatchedOperation";Ia.replication="Replication";Ia.JSj="25";Ia.Aij="9_"+Ia.XSg+"_"+Ia.replication;
Object(b.a)(Ia,"CpuMeterConstants",null,[]);class ra{}Object(b.a)(ra,"CpuMeterFrame",null,[]);class pa extends Sys.EventArgs{constructor(Ba){super();this.Wvf=Ba}}Object(b.a)(pa,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class ba{}Object(b.a)(ba,"MiniTaskItemInfo",null,[]);class fa{}Object(b.a)(fa,"TaskItemInfo",null,[]);var Ka=a(552),aa=a(98);class ja{static l4h(){if(!ja.PRb&&(ja.PRb=new aa.a,h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.Zp("AggregatorIdDisabledList"))){const Ba=
h.AFrameworkApplication.fa.Cw("AggregatorIdDisabledList");for(let Ea=0;Ea<Ba.length;Ea++)ja.PRb.ia(Ba[Ea],!0)}return ja.PRb}}ja.PRb=null;Object(b.a)(ja,"DisabledAggregatorListStore",null,[]);var Va=a(267);class bb{constructor(Ba,Ea,rc,wd,Pd,te=!0,af=null){this.UX=this.Mke=this.bce=!1;this.he=null;if(!Ba)throw Va.a.argument("taskManagerLazy");if(!Pd)throw Va.a.argument("dataAggregator");this.ACg=Ba;this.DPc=Ea;this._id=rc;this.vae=6E4*wd;this.$Sb=Pd;this.$he=te;this.jmb=af;ja.l4h().mb(this._id.toString())&&
(this.UX=!0)}get taskManager(){return this.he||(this.he=this.ACg.value)}track(Ba,Ea=null){this.UX||(this.Rqh(),this.Xoj(),this.$Sb.kH(Ba,Ea))}Xoj(){!this.bce&&0<this.vae&&(this.bce=!0,this.w_f())}w_f(){const Ba=new Q.a(5,1,this.vae,()=>{this.Rqj()},19,this._id.toString());this.taskManager.Eg(Ba)}Rqj(){!this.jmb||this.jmb.oAj()?this.F0f():this.$he&&this.$Sb.reset();this.w_f()}F0f(){const Ba=this.$Sb.getData();if(Ba){const Ea=parseInt(String(Ba.length));if(isNaN(Ea)||0<Ea)this.Ywc(Ba),this.$he&&this.$Sb.reset()}}Ywc(Ba){e.ULS.sendTraceTag(7079840,
335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:Ba})}Rqh(){this.Mke||(this.DPc(()=>{this.F0f()}),this.Mke=!0)}static eN(Ba,Ea,rc,wd,Pd){return new bb(new Ka.a(()=>h.AFrameworkApplication.Gi),h.AFrameworkApplication.lOb,Ba,Ea,rc,wd,Pd)}static r4a(Ba,Ea,rc){return bb.eN(Ba,Ea,rc,!0,null)}}Object(b.a)(bb,"Aggregator",null,[524]);class wa{constructor(Ba=null){this.kn=null;this.reset();this.jmb=Ba}kH(Ba,Ea){if(!this.jmb||this.jmb.oAj())Ea in this.kn||(this.kn[Ea]=[]),this.kn[Ea].push(Ba)}getData(){return C.a.count(this.kn)?
this.kn:null}reset(){this.kn={}}}Object(b.a)(wa,"NamedValuesAggregator",null,[513]);var ka=a(263);class ta{constructor(Ba,Ea,rc,wd,Pd){this.OFa=0;this.yE=null;this.pXb=this.wke=0;this.Lie=!1;this.CWa=0;this.dkb=!1;this.jra=null;this.EUb=0;this.Ffe=new D.a;this.tYb=[];this.aM=Ba;this.AOc=Ea;this.BKc=rc;this.Rde=wd;h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.qa("WrapSetTimeoutForTelemetryIsEnabled")&&this.$td();this.Ttg=Pd;this.CKc=new La(100);this.Pxg=bb.r4a(1,5,new wa)}Zqe(Ba){this.Ffe.addHandler("OnCpuMeterFrameAvailable",
Ba)}ubb(Ba,Ea,rc,wd=null){rc=wd?wd.priority:7;const Pd=this.aM();this.start(Ea,rc);try{Ba()}finally{this.stop(Ea,wd),Ba=this.aM()-Pd,this.Rde.track(Ba,Ea)}}vW(Ba,Ea){const rc=this.aM();try{Ba()}finally{Ba=this.aM()-rc,this.BKc.kH(Ba,Ea),0<this.OFa&&this.CKc.kH(Ba,Ea),this.Rde.track(Ba,Ea)}}bEd(Ba){const Ea=new fa;Ea.TN=Ba.Klc;Ea.TP=Ba.priority;this.xPf(1,Ea)}I9a(Ba){this.EUb|=Ba}start(Ba,Ea){if(!this.OFa){this.CKc.reset();const rc=this.imf(Ba);rc&&this.Zxd(1);this.yE=new fa;this.yE.TN=Ba;this.yE.TP=
Ea;this.yE.ST=(new Date).toISOString();this.yE.STS=ha.a.A7(this.aM(),2);rc?this.yE.UI=1:this.Nni(Ba)?this.yE.UI=2:this.yE.UI=0}this.OFa++}Zxd(Ba){this.CWa|=Ba}O1c(Ba=!0,Ea=0){this.CWa=Ba?0:this.CWa&~Ea}stop(Ba,Ea=null){let rc;this.OFa--;0>=this.OFa&&this.yE&&(rc=this.aM()-this.yE.STS,this.pXb+=rc,this.AOc.kH(rc,Ba),this.imf(Ba)&&this.O1c(!1,1),this.yE.TRT=ha.a.A7(rc,2),Ea&&(this.yE.TQT=ha.a.A7(Ea.i7i,2),this.yE.TDT=ha.a.A7(Ea.Cnf,2)),this.Ttg&&(this.xPf(0,this.yE),this.hjj()),this.OFa=0);0<=Ba.indexOf(Ia.JSj)&&
this.I9a(2);0<=Ba.indexOf(Ia.Aij)&&this.I9a(4);1===(this.CWa&1)&&this.I9a(1);2===(this.CWa&2)&&this.I9a(8)}hjj(){var Ba=this.yE.TRT;if(750<Ba){let rc=this.CKc.getData();if(rc){const wd={};for(let Pd in rc){var Ea=rc[Pd];const te=Pd;te.startsWith("SiOp_")||te.endsWith("[it]")||(wd[te]=Math.round(100*Ea.T/Ba))}rc=wd}Ba=Object.assign(new ba,{B:this.yE.STS,T:Ba,S:rc});this.Pxg.track(Ba,this.yE.TN)}}OHj(){var Ba=this.aM()-this.wke,Ea=ha.a.A7(this.pXb/Ba*100,2);Ba=new ra;Ba.CP=Ea;Ba.II=this.EUb;Ea=this.AOc.getData();
C.a.count(Ea)&&(Ba.LRT=Ea);Ea=this.BKc.getData();C.a.count(Ea)&&(Ba.FP=Ea);this.Ffe.raiseEvent("OnCpuMeterFrameAvailable",new pa(Ba));this.Z9f()}Z9f(){this.AOc.reset();this.BKc.reset();this.pXb=this.OFa=0;this.wke=this.aM();this.EUb=0;this.yE=null}run(){this.Lie?this.OHj():(this.Z9f(),this.Lie=!0);this.jra?this.jra(Object(X.a)(this,this.run,"run"),1E3):window.setTimeout(Object(X.a)(this,this.run,"run"),1E3)}IVc(Ba,Ea,rc){const wd=Array(2);wd[0]=Ea;wd[1]=rc;this.tYb[Ba]||(this.tYb[Ba]=[]);this.tYb[Ba].push(wd)}xPf(Ba,
Ea){Ba=this.tYb[Ba];if(!ka.a.Dh(Ba))for(let wd=0;wd<Ba.length;wd++){var rc=Ba[wd];const Pd=rc[0];rc=rc[1];Pd&&!Pd(Ea)||rc(Ea)}}$td(){if(!this.dkb){const Ba=window.setTimeout;this.jra=(Ea,rc)=>Ba(Ea,rc);this.dkb=!0}}imf(Ba){return Ba.startsWith("key")||Ba.startsWith("input")}Nni(Ba){return Ba.startsWith("click")||Ba.startsWith("mouse")||Ba.startsWith("pointer")}}Object(b.a)(ta,"CpuMeter",null,[66]);class qa{constructor(Ba){this.pib=null;this.yk=new oa.a;this.aM=Ba}initialize(Ba,Ea,rc,wd=!1){this.pib||
(this.pib=new ta(this.aM,Ba,Ea,rc,wd),this.yk.setResult(this.pib));return this.pib}}Object(b.a)(qa,"CpuMeterProvider",null,[525]);class rb{constructor(Ba=1){this.Dx=[];this.hTb=[];this._count=Ba}gFh(){let Ba=0;for(let Ea=0;Ea<this.Dx.length;Ea++)this.Dx[Ea]<this.Dx[Ba]&&(Ba=Ea);return Ba}kH(Ba,Ea){Ba=ha.a.A7(Ba,2);if(this.Dx.length<this._count)Array.add(this.Dx,Ba),Array.add(this.hTb,Ea);else{var rc=this.gFh();Ba>this.Dx[rc]&&(this.Dx[rc]=Ba,this.hTb[rc]=Ea)}}getData(){return this.Dx.length?{["Vals"]:this.Dx,
["Desc"]:this.hTb}:null}reset(){this.Dx=[];this.hTb=[]}}Object(b.a)(rb,"MaxDataAggregator",null,[513]);var Za=a(40),gb=a(82);class mb{get name(){return"Common.App.CpuMeter"}Wh(Ba){Ba.register(qa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").xc().Fc(()=>new qa(Za.a.Ud));Ba.register(S,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").xc().Fc(()=>new S)}init(){const Ba=h.AFrameworkApplication.fa;if(Ba.qa("CpuMeterIsEnabled")){const Ea=gb.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
z.a.instance.vte.continueWith(()=>{mb.Jdi(Ba,Ea)})}}dispose(){}static Jdi(Ba,Ea){const rc=bb.r4a(10,5,new La(Ba.rd("TaskManagerLoggingThreshold",0),Ba.rd("CpuMeterMaximumEntriesToLog",0)));Ea=Ea.initialize(new rb(5),new La,rc,Ba.qa("CPUMeterExposeTaskDetailsIsEnabled"));Ea.run();Ba.qa("CpuMeterMonitorIsEnabled")&&gb.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Ea,Ba.Nva("CpuMeterAverageCpuPercentThreshold",80),Ba.rd("CpuMeterRollingAverageFramesCount",15));da.a(16827671,306,50,
"Initializing CpuMeter")}static main(){w.a.instance.Fi(new mb)}}Object(b.a)(mb,"CpuMeterPackage",null,[4,5]);var Ga=a(940);class ib{get name(){return"Common.App.EventsCachePackage"}Wh(){}init(){Ga.a.instance.init()}dispose(){}static main(){w.a.instance.Fi(new ib)}}Object(b.a)(ib,"EventsCachePackage",null,[4,5]);var cc=a(9),ic=a(222),xb=a(1240),Vb=a(164),wb=a(373),cb=a(203),lb=a(148),Y=a(59),Oa=a(91),Wa=a(1),Ca=a(22),Ra=a(159),la=a(760);class ua extends xb.a{constructor(Ba,Ea,rc){super(Ea,rc);this.Ra=
new D.a;this.iai=wd=>{if(Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Pd=wd.Values.m_Origin;h.AFrameworkApplication.wopiHostOriginFromPostMessage||(h.AFrameworkApplication.wopiHostOriginFromPostMessage=Pd)}switch(wd.MessageId){case Vb.a.Sld:Ra.a(this.$).A9e(wd);break;case Vb.a.Ivd:lb.a.ltas(null);break;case Vb.a.ufc:this.YQi();break;case Vb.a.Vld:this.XQi(wd)}};this.$=Ba;rc!==la.a.m$&&this.tGa(rc);this.Uei();this.eei();Ba=this.iai;this.dm(Vb.a.Sld,Ba);this.dm(Vb.a.Ivd,
Ba);this.dm(Vb.a.ufc,Ba);this.dm(Vb.a.Vld,Ba)}dispose(){this.$=null;super.dispose()}Uei(){this.so(Vb.a.sze);this.so(Vb.a.Sld);this.so(Vb.a.ufc);this.so(Vb.a.Vld);this.BVc(Vb.a.Ivd);this.so(Vb.a.Uld)}eei(){this.Wga(Vb.a.pnb);this.Wga(Vb.a.tua);this.Wga("App_CloseTab");this.Wga(Vb.a.gVa);this.Wga(Vb.a.hVa);this.Wga(Vb.a.Fbf);this.Wga(Vb.a.qfc)}YQi(){const Ba={};Ba.hostMessageReceived=(new Date).getTime();e.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");h.AFrameworkApplication.xsd=
!0;Ba.appUnloadStart=(new Date).getTime();Ba.sendBeaconFlight=h.AFrameworkApplication.fa.qa("SendBeaconOnShuttingDownRequestsEnabled");Ba.sendBeaconSupported=Y.a.aea();Y.a.Ete();Ba.appUnloadEnd=(new Date).getTime();Ba.appMessageSent=(new Date).getTime();this.Pj(Vb.a.jPg,Ba)}XQi(Ba){e.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");Ba.Values&&wb.a.bAd in Ba.Values&&Ca.a.equals(Ba.Values[wb.a.bAd],cb.a.edit,!0)&&!this.$.isEditMode&&(e.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${Ba.Values[wb.a.bAd]}`),
Ba=new Oa.a(-8805455,0,1,0,null),this.$.Ja.Kb(Ba))}}Object(b.a)(ua,"EwaHostMessenger",xb.a,[502,197,2]);class xa extends ic.a{constructor(Ba){super();this.BEe=!1;this.$=Ba;this.Fb()}create(){const Ba=this.$.da,Ea=gb.a.instance;if(!this.BEe){this.BEe=!0;let rc;rc=Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.va.DocumentHostInfo.PostMessageOrigin||la.a.m$:h.AFrameworkApplication.qGd||la.a.m$;Ea.register(ua,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").xc().Fc(()=>
new ua(this.$,window.parent,rc,h.AFrameworkApplication.fa.qa("HostSendReadyToAcceptPostMessage")))}this.ob(Ba.za(21)||Ba.Ga(21,Ea.resolve("Postmessage.IHostPostmessenger")))}}Object(b.a)(xa,"HostMessengerFactory",ic.a,[]);var fb=a(120),Jb=a(147),Ob=a(682),eb=a(553),Ma=a(78),va=a(132),Pa=a(460),Ha=a(46),tb=a(318),Ya=a(351),V=a(354),za=a(494),yb=a(5),jc=a(51),Cc=a(76);class Sa{constructor(Ba,Ea,rc){this.correlations=this.properties=this.operation=null;this.operation=Ba;this.properties=Ea;this.correlations=
rc}static FCh(Ba,Ea,rc){const wd={},Pd=jc.b();switch(Ba.command){case -1537138325:wd.Action=Ea.LabelText;break;case -1104934572:wd.PrevTab=Pd.uj(parseInt(Ea.OldContextCommand,10));wd.NextTab=Pd.uj(parseInt(Ea.NewContextCommand,10));break;case 802602464:wd.Origin=Ea[yb.a.CQ];break;case -1027730316:case -1059615499:wd.MenuType=Ea.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Ea&&(wd.SqmControlId=Ea.SqmControlId);break;
case 1371713064:case 875133075:Cc.a.Jc in Ea&&(wd.SampleTableId=Ea[Cc.a.Jc])}wd.InputMethod=Ya.a[Ba.method];wd.Location=V.a[Ba.$e];wd.Mode=za.a[Ba.mode];wd.ParentName=Ba.tabName;wd.IsSystemInitiated="IsSystemInitiated"in Ea?Ea.IsSystemInitiated:!1;wd.NoReporting="NoReporting"in Ea?Ea.NoReporting:!1;"ControlIdToLog"in Ea&&(wd.ControlId=Ea.ControlIdToLog);"TerminalParentControlIdToLog"in Ea&&(wd.TerminalParentControlId=Ea.TerminalParentControlIdToLog);for(const te of Object.keys(rc))wd[te]=rc[te];return wd}}
Object(b.a)(Sa,"InteractivityRecord",null,[]);class na extends Sa{constructor(Ba,Ea,rc){super(Ba.operation,Ba.properties,Ba.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=Ea;this.timeFromNavigationStart=rc}}Object(b.a)(na,"FirstUserInteractivityRecord",Sa,[]);var jb=a(639);class Ib{constructor(){this.commandSurface=this.triggerMethod=fb.a.hgb}static Xdi(){Ib.J3a||(Ib.J3a=new jb.a(eb.a.Yj()),Ib.J3a.add("InputMethod"),Ib.J3a.add("Location"),Ib.J3a.add("Mode"))}}
Ib.J3a=null;Object(b.a)(Ib,"ExcelUserAction",null,[]);var dc=a(201),ob=a(39),Fa=a(429),Ab=a(190);class $b extends Ma.a{constructor(Ba){super();this.Bef=0;this.xXe=!1;this.sud=Array($b.L9a);this.v6b=0;this.$=Ba;this.LAb=Wa.EwaSettings.ma(78);this.Ilf=Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");this.roi=Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5893585_PageLoadEngagementInfo");fb.a.KXh();this.Eba={};$b.qZb||($b.qZb=new Ob.a(eb.a.Yj()),$b.hdi($b.qZb));
Ib.Xdi();if(Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(Ba=0;Ba<$b.L9a;Ba++)this.sud[Ba]="NA"}dispose(){this.$=this.Eba=null;super.dispose()}YVf(Ba,Ea,rc){if(this.LAb){var wd=jc.b().uj(Ba.command),Pd=JSON.stringify(Ba);wd||e.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${wd}, command: ${Ba.command}, commandInfo: ${Pd}`);Ea=Sa.FCh(Ba,Ea,rc);rc=!!Ea&&(!("IsSystemInitiated"in Ea)||!Ea.IsSystemInitiated);
this.$&&this.$.ea.sg&&rc&&Ga.a.instance.YQf("OtelUserAction",new Fa.a(wd,Ba.tabName,Date.now()));this.lWf(wd,Ea,null,!0,!0)}}ud(Ba,Ea,rc=null,wd=!1){this.LAb&&this.lWf(Ba,Ea,rc,!1,wd)}kWd(Ba){if(this.LAb)if(this.Eba){++this.Bef;this.Eba[Ba]||(this.Eba[Ba]=[]);var Ea=this.Bef.toString();this.Eba[Ba].push(Ea);e.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${Ba}', correlation=${Ea}`)}else e.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Ba}] == null`)}CWd(Ba){if(this.LAb)if(this.Eba&&
this.Eba[Ba]){var Ea=this.Eba[Ba],rc=Ea.pop().toString();Ea.length||delete this.Eba[Ba];e.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${Ba}', correlation=${rc}`)}else e.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Ba}] == null`)}mQ(Ba,Ea,rc=!1){return this.LAb?tb.a(wd=>{this.ud(Ba,wd(),void 0,rc)},$b.xNj,this.la,Ha.a.Pgi,!1,!Ea):null}CMd(){let Ba="";for(let Ea=0;Ea<$b.L9a;Ea++)Ba+=this.sud[(this.v6b+
$b.L9a-Ea-1)%$b.L9a]+",";e.ULS.sendTraceTag(557188890,0,15,`Last operations ${Ba}`)}OWj(Ba){Ba&&(this.sud[this.v6b]=Ba,this.v6b=(this.v6b+1)%$b.L9a)}lzi(Ba,Ea,rc){h.AFrameworkApplication.d9b();const wd=Ba.operation,Pd=Ba.properties;void 0!==rc?Pa.a(this.$,432,433,0,te=>{te.baj(wd,Pd,rc)}):this.SSj(Ba);this.TSj(Ba);this.zZi(Ea,Pd,wd)}SSj(Ba){this.NGj(Ba)||(this.xXe=!0,Ba=new na(Ba,ob.PageLoadTrackingInfo.instance.jwa(new Date),ob.PageLoadTrackingInfo.vs()),Ba=Sys.Serialization.JavaScriptSerializer.serialize(Ba),
e.ULS.sendTraceTag(458261331,0,50,`${Ba}`))}NGj(Ba){const Ea=Ba.properties;Ba=Ba.operation;return this.xXe||void 0===Ba||null===Ba||Ba===va.a.gVc||Ba===va.a.KPd||Ba===va.a.NGd||Y.a.Frd(Ba)||!!Ea&&"IsSystemInitiated"in Ea&&Ea.IsSystemInitiated}TSj(Ba){Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.OWj(Ba.operation);Ba=Sys.Serialization.JavaScriptSerializer.serialize(Ba);e.ULS.sendTraceTag(21542793,0,50,`${Ba}`)}zZi(Ba,Ea,rc){fb.a.tla()&&(Ea?"NoReporting"in
Ea&&Ea.NoReporting||"IsSystemInitiated"in Ea&&Ea.IsSystemInitiated||!Ba&&!this.Ilf||((Ba=fb.a.Wj(Ea,$b.qZb,Ib.J3a))?(Ea=$b.NCh(Ea))?Jb.a.sendUserActionEvent(fb.a.Z5b(rc,null,Ea.triggerMethod,Ea.commandSurface,Ba)):e.ULS.sendTraceTag(537155550,0,50,"user action was null"):e.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):e.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${rc}`))}lWf(Ba,Ea,rc,wd,Pd){const te=
dc.a(this.$);if(this.Ilf){let Cf=null;Ca.a.equals(Ba,va.a.Nwc,!0)&&Ea&&"InputMethod"in Ea&&(Cf=va.a.rYe(Ba,Ea.InputMethod));te.oKb(Cf||Ba,rc)}else Ca.a.equals(Ba,va.a.Nwc,!0)&&Ea&&"InputMethod"in Ea&&(Ba=va.a.rYe(Ba,Ea.InputMethod)),te.oKb(Ba,rc);Ea&&(Ea.IsCommand=wd);let af=void 0;this.roi&&(af="ActionRelativeTime"in Ea?Ea.ActionRelativeTime:ob.PageLoadTrackingInfo.vs());Object(Ab.c)(()=>{const Cf=new Sa(Ba,Ea,this.Eba);this.lzi(Cf,Pd,af)},this.$.la,50)}static NCh(Ba){if(!Ba)return null;const Ea=
new Ib;"InputMethod"in Ba&&(Ea.triggerMethod=Ba.InputMethod);"Location"in Ba&&(Ea.commandSurface=Ba.Location);return Ea}static hdi(Ba){Ba?(Ba.add("Origin",2),Ba.add("InputMethod",2),Ba.add("ButtonType",2),Ba.add("selectedRange",2),Ba.add("SelectedRanges",2),Ba.add("editRange",2),Ba.add("Location",2),Ba.add("Mode",2),Ba.add("CurrentSelectionMode",2),Ba.add("Action",2),Ba.add("type",2),Ba.add("floatingObjectType",2),Ba.add("PrevTab",2),Ba.add("NextTab",2),Ba.add("DialogName",2),Ba.add("dx",3),Ba.add("dy",
3),Ba.add("NumberOfSelectedRanges",3),Ba.add("IsCommand",1),Ba.add("IsInFormulaBarEdit",1),Ba.add("isLink",1),Ba.add("isSheetRef",1),Ba.add("isEmptyText",1),Ba.add("isFormula",1),Ba.add("IsResizingHiddenHeader",1)):e.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}$b.xNj=1E3;$b.L9a=40;$b.qZb=null;Object(b.a)($b,"InteractivityLogger",Ma.a,[13]);var Cb=a(7);class Rb{constructor(){this.appInfoProperties=this.appState=null}}Object(b.a)(Rb,"CurrentAppInfo",null,[]);
const uc=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit active_cell_selection_change_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set(["active_cell_selection_change","cell_text_active_cell_selection_change","formulaBar_active_cell_selection_change"])},{name:"headers",actions:new Set(["header_resize_start","header_resize_autofit"])}].forEach(Ba=>{Ba.actions.forEach(Ea=>{uc.set(Ea,Ba.name)})});class nb{constructor(){this.value=this.key=null}}Object(b.a)(nb,"AppInfoProperty",null,[]);class Fb{constructor(Ba){this.$=Ba}getAppState(){const Ba=ob.PageLoadTrackingInfo.instance.jwa(new Date);
return-1===Ba?"boot":3E4>Ba?"postboot":"steady"}isChangeGateEnabled(Ba){return Wa.EwaSettings.isChangeGateEnabled(Ba)}getBooleanFeatureGate(Ba,Ea){return Wa.EwaSettings.getBooleanFeatureGate(Ba,Ea)}getCurrentAppInfo(){return Object(Cb.a)(new Rb,{appState:this.getAppState(),appInfoProperties:[Object(Cb.a)(new nb,{key:"coauthCount",value:this.$.ea.Xm.length.toString()})]})}sendBeaconTraceTag(Ba,Ea,rc,wd){this.$.sendBeaconTraceTag(Ba,Ea,rc,wd)}getActionBucket(Ba){return c(Ba)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.WDi}`}}
Object(b.a)(Fb,"InteractivityTrackerCallbacks",null,[596]);class Jc{constructor(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=this.callbacks=null}}Object(b.a)(Jc,"InteractivityTrackerOptions",null,[]);class Fc{constructor(Ba){this.Fba=null;Fc.vif?e.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):(this.initialize(Ba),Fc.vif=!0)}initialize(Ba){e.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");
if(this.Fba=interactivity.InteractivityTrackerFactoryGlobal.create()){const Ea=new Jc;Wa.EwaSettings.etd()&&Fc.Qag.push(ea.a.z$);Ea.events=Fc.Qag;Ea.durationThresholdInMs=Fc.durationThresholdInMs;Ea.callbacks=new Fb(Ba);Ea.patchTaskScheduling=Wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);Ba=this.Fba.start(Ea);Ba.started?e.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):e.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+
Ba.failureReason)}else e.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}mCa(Ba,Ea,rc){this.Fba?this.Fba.track(Ba,Ea,rc):e.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Ea}`)}tIe(){return this.Fba?this.Fba.createActionsRetriever():(e.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),
null)}dispose(){this.Fba&&(this.Fba.stop(),this.Fba=null)}}Fc.durationThresholdInMs=100;Fc.Qag="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");Fc.vif=!1;Object(b.a)(Fc,"InteractivityTrackerService",null,[505]);var zb=a(50),hb=a(37),Pb=a(184),ud=a(695);class Ub extends ic.a{constructor(Ba){super();this.$=Ba;this.Fb()}create(){if(Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")){const Ba=zb.GetServiceTaskFactory.Oa(this.$.da,
283,284,this.Ya);hb.TaskExtensions.Aa(Ba,()=>{hb.TaskExtensions.Aa(Pb.c(Ba.result.ln.loadScript("interactivity")),()=>{this.ob(Object(ud.a)(this.$.da,443,()=>new Fc(this.$)))},this.$.la,3)},this.$.la,3)}else this.ob(Object(ud.a)(this.$.da,443,()=>new Fc(this.$)))}static ka(Ba){Ba.da.Ga(444,new Ub(Ba))}}Object(b.a)(Ub,"InteractivityTrackerServiceFactory",ic.a,[]);var Ac=a(87),Ic=a(383),dd=a(8),Ud=a(47),Hd=a(58);class me{constructor(Ba){this.sHj=Ba}getCustomProperties(Ba){const Ea=new Map;if(Ba.hasOwnProperty("startTimeInMs")&&
Ba.hasOwnProperty("totalExecutionTimeInMs")){const rc=Ba.startTimeInMs;Ba=this.sHj.retrieveSlowActionsBetweenTimeRange(rc,rc+Ba.totalExecutionTimeInMs);Ea.set("actions",Hd.a.hc(Ba))}return Ea}}Object(b.a)(me,"CallTreeCustomPropertiesRetriever",null,[601]);class xe{constructor(){this.customProperties=new Map}addCustomProperty(Ba,Ea){this.customProperties.set(Ba,Ea)}getCustomProperties(){return this.customProperties}}Object(b.a)(xe,"CustomPropertiesRetriever",null,[600]);class Ke{isFeatureEnabled(Ba,
Ea){return Wa.EwaSettings.getBooleanFeatureGate(Ba,Ea)}}Object(b.a)(Ke,"ExcelFeatureChecker",null,[599]);class vd{isProfilingEnabled(){return!0}}Object(b.a)(vd,"ExcelProfilingFeatureChecker",null,[598]);class Qe{constructor(Ba,Ea){this.AWi=Ba;this.CWi=Ea}onProfilerEvent(Ba){switch(Ba.eventId){case 1:this.AWi(Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));break;case 0:this.CWi();break;default:e.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${Ba.eventId}`)}}}
Object(b.a)(Qe,"JSCPUProfilerObserver",null,[597]);class bc{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}}Object(b.a)(bc,"JSCPUProfilerInitOptions",null,[]);class Zc{constructor(){this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=
this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=
this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}}Object(b.a)(Zc,"JSCPUProfilingPackageInitOptions",null,[]);class gd{constructor(Ba,Ea){this.interactivityTrackerService=this.f$f=this.SHd=this.vbb=this.THd=this.$Nf=this.aOf=null;this.T5i=new Set([1,0]);e.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");
this.$=Ba;this.interactivityTrackerService=Ea;this.Rei();this.Qei();this.Zti=this.$.va.JsProfilingSampleIntervalInMs;this.profilingIntervalInMs=Wa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.rFe=Wa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.WZi=Wa.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.ProfilerName","");this.BJj()}dispose(){e.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");
Ac.a.Ia(this.f$f);this.SHd=this.$=null;this.THd.clear();this.vbb.clear()}SIj(){const Ba=Math.random()*this.rFe;e.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${Ba}`);this.f$f=Ud.a.instance.create(()=>{this.mhd("ExcelOnlineContinuousSessionProfiler",2).start()},Ba,Ha.a.Ezj,!0)}dJj(){e.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.mhd("ExcelOnlineFullSessionProfiler",3).start()}kJj(Ba){e.ULS.sendTraceTag(537155524,
0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.Wjf(Ba)?this.mhd(Ba,0,1E4).start():e.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")}kKj(Ba){this.Wjf(Ba)?(Ba=this.e5e(Ba))&&Ba.stop():e.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")}RHd(Ba){return this.vbb.has(Ba)}BJj(){Wa.EwaSettings.I5e()||(Wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",
!1)?this.dJj():this.SIj())}createProfiler(Ba,Ea,rc,wd,Pd,te){e.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");const af=new bc;af.samplingIntervalInMs=Ea;af.maximumNumberOfSamplesToTake=rc;af.idleIntervalInMs=wd;af.profilingIntervalInMs=Pd;return this.mdh(Ba,te,af)}Qei(){const Ba=new vd,Ea=new Zc;Ea.ulsInstance=new Ic.a;Ea.deObfuscationEndpoint="ProfilerReporting.ashx";Ea.shouldCompressSerializedCallTrees=!1;Ea.shouldKeepSamplesOutsideOfProfilingInterval=
!1;Ea.shouldSendAllCallTreesFromProfileInASingleRequest=!Wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);Ea.shouldUseSendBeaconForSendingCallTrees=Wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);Ea.callTreeFilteringThresholdInMs=Wa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);Ea.deObfuscationRequestQueryParamsRetriever=this.$$g();
Ea.deObfuscationRequestBodyPropertiesRetriever=this.Z$g();Ea.featureEnabledChecker=new Ke;Ea.useMainEventLoopForProfilerTraceProcessing=!1;Ea.profilerTraceProcessingWebWorkerSourceURL=this.$.va.JSProfilerProcessingWebWorkerJsScriptUrl;Ea.shouldProcessProfileCapturedWhileUserIsIdle=Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");this.SHd=this.aOf.retrievePackage(Ba,Ea).retrieveProfilerFactory()}$$g(){const Ba=new xe;Ba.addCustomProperty(dd.a.BOf,
h.AFrameworkApplication.userType);Ba.addCustomProperty(h.AFrameworkApplication.Jgb,h.AFrameworkApplication.userSessionId);Ba.addCustomProperty(dd.a.lAd,this.$.va.SkipAuthentication?dd.a.lwf:null);Ba.addCustomProperty(dd.a.lId,this.$.va.MachineCluster);return Ba}Z$g(){const Ba=new xe;Ba.addCustomProperty("appName","Excel");Ba.addCustomProperty("buildVersion",h.AFrameworkApplication.buildVersion);Ba.addCustomProperty("shouldUseSourceMaps","true");Ba.addCustomProperty("shouldFilterSensitiveResources",
"true");Ba.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator",this.fDj().toString());return Ba}mdh(Ba,Ea,rc){const wd=new xe;wd.addCustomProperty("ProfilerName",Ba);this.$Nf.set(Ba,wd);Ea=this.SHd.createProfiler(Ea,rc,wd);this.vbb.set(Ba,Ea);Ba=this.ybh(Ba);Ea.subscribeProfilerObserver(Ba,this.T5i);return Ea}e5e(Ba){return this.RHd(Ba)?this.vbb.get(Ba):(e.ULS.shipAssertTag(537155520,0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${Ba}) does not exist`),null)}mhd(Ba,
Ea,rc=null){Ba=this.WZi||Ba;if(this.RHd(Ba))return this.e5e(Ba);const wd=this.Zti;return this.createProfiler(Ba,wd,null!=rc&&0<wd?rc/wd:2E6,2===Ea?this.rFe:null,0===Ea?null:this.profilingIntervalInMs,Ea)}ybh(Ba){var Ea=this.interactivityTrackerService;if(Ea){const rc=Ea.tIe();if(rc){Ea=this.vbb.get(Ba);const wd=new me(rc);Ea.subscribeCallTreeCustomPropertiesRetriever(wd);Ea=new Qe(Pd=>{rc.startCollectingSlowActions(Pd)},Object(X.a)(rc,rc.stopCollectingSlowActions,"stopCollectingSlowActions"));this.THd.set(Ba,
Ea);return Ea}e.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}e.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null}Rei(){this.aOf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.$Nf=new Map;this.THd=new Map;this.vbb=new Map}Wjf(Ba){return!!Ba}fDj(){return!Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6967854_ESNextEnabled")}}
Object(b.a)(gd,"JsSelfProfilerManager",null,[503,2]);class Sc extends ic.a{constructor(Ba){super();this.$=Ba;this.Fb()}create(){e.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");const Ba=zb.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Ya);hb.TaskExtensions.Aa(Ba,()=>{this.$.da.$a(443,Ea=>{this.Abh(Ba.result,Ea)})},this.$.la,3)}Abh(Ba,Ea){hb.TaskExtensions.Aa(Pb.c(Ba.ln.loadScript("officeOnlineCpuProfiling")),()=>{const rc=Object(ud.a)(this.$.da,
437,()=>new gd(this.$,Ea));this.ob(rc)},this.$.la,3)}static ka(Ba){Ba.da.Ga(438,new Sc(Ba))}}Object(b.a)(Sc,"JsSelfProfilerManagerFactory",ic.a,[]);class Gd{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(b.a)(Gd,"ActionData",null,[]);class Vd{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(b.a)(Vd,"BlockedEngagementInfo",null,[]);class Ed extends Gd{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(b.a)(Ed,
"SuccessfulActionData",Gd,[]);class Od{constructor(){this.successfulActions=[]}}Object(b.a)(Od,"SuccessfulEngagementInfo",null,[]);var se=a(44);class Le{constructor(Ba){this.lKa=new Set;this.nOb=null;this.wXe=this.Iag=!1;this.ig=()=>{this.cyi();this.nOb=Ud.a.instance.create(()=>{this.vDb()},Le.bLj,Ha.a.vDb)};this.Bc=()=>{this.vDb()};this.RGb=(Ea,rc)=>{Ea=this.$pb.blockedActions.length;const wd=rc.details?rc.actionName+"_"+rc.details:rc.actionName;rc=Object(Cb.a)(new Gd,{order:Ea+1,name:wd,componentName:rc.componentName,
timeFromNavigationStart:rc.timeFromNavigationStart});this.$pb.blockedActions.push(rc)};this.AId=()=>{this.$.Xc(2009315810,-1,0,null);this.ETd=!1};this.$pb=new Vd;this.$pb.hasBlockedActions=!1;this.gfb=new Od;this.fEh();this.$=Ba;this.$.ea.Ak(this.ig);this.$.ik(this.Bc);this.eLj=0;this.ETd=!1;Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.PFe=new Promise(Ea=>{this.G8g=Ea}))}dispose(){this.$.ea&&this.$.ea.jo(this.ig);this.$.Il(this.Bc);Ac.a.Ia(this.nOb);
this.$=this.nOb=null}baj(Ba,Ea,rc){if(void 0!==Ba&&null!==Ba&&Ea){var wd=this.gfb.successfulActions.length+1,Pd="InputMethod"in Ea?Ea.InputMethod:"",te="IsCommand"in Ea&&Ea.IsCommand;if(this.xsi(Ba,Ea,Pd,te)){Wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerformanceSurveys",!1)&&this.eLj++===Le.mZj?(this.ETd=!0,this.Z0i=Ud.a.instance.create(this.AId,5E3,Ha.a.AId)):this.ETd&&this.Z0i.sq();if(Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const af=
!te&&Ba;this.wXe||af===va.a.Bkg||af===va.a.Ckg||af===va.a.ykg||af===va.a.zkg||(this.wXe=!0,this.G8g(void 0))}wd>Le.Etf||(Ba=Object(Cb.a)(new Ed,{order:wd,name:Ba,componentName:"Location"in Ea?Ea.Location:"",timeFromNavigationStart:rc,inputMethod:Pd,isCommand:te}),this.gfb.successfulActions.push(Ba),1===wd?this.Uyi():wd===Le.Etf&&this.vDb())}}}M$i(Ba){se.a(this.$).Q_b(this.RGb);this.$pb.hasBlockedActions=!0;this.RGb(null,Ba)}cyi(){e.ULS.sendTraceTag(254546634,0,50,`${G.c(this.$pb)}`)}Uyi(){ob.PageLoadTrackingInfo.instance.jwa(new Date)>
Le.sEh?e.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${G.c(this.gfb.successfulActions[0])}`):e.ULS.sendTraceTag(254563592,0,50,`${G.c(this.gfb.successfulActions[0])}`)}vDb(){!this.Iag&&this.gfb.successfulActions.length&&(this.Iag=!0,Ac.a.Ia(this.nOb),this.nOb=null,this.$.sendBeaconTraceTag(254559496,50,!1,G.c(this.gfb)))}fEh(){this.lKa.add(va.a.gVc);this.lKa.add(va.a.KPd);this.lKa.add(va.a.NGd);this.lKa.add(va.a.DMf);this.lKa.add(va.a.FMf);this.lKa.add(va.a.HMf)}xsi(Ba,Ea,
rc,wd){rc=!rc||"unknown"===rc;const Pd="IsSystemInitiated"in Ea&&Ea.IsSystemInitiated;Ea="NoReporting"in Ea&&Ea.NoReporting;const te=this.lKa.has(Ba);Ba=Ca.a.equals(Ba,va.a.Nwc,!0)&&rc;return!Pd&&!Ea&&!te&&!Ba&&!(wd&&rc)}}Le.Etf=10;Le.sEh=6E4;Le.bLj=12E4;Le.mZj=25;Object(b.a)(Le,"PageLoadEngagementInfo",null,[504]);class Id extends ic.a{constructor(Ba){super();this.$=Ba;this.Fb()}create(){this.ob(this.$.da.za(432)||this.$.da.Ga(432,new Le(this.$)))}static ka(Ba){Ba.da.Ga(433,new Id(Ba))}}Object(b.a)(Id,
"PageLoadEngagementInfoFactory",ic.a,[]);var fe=a(54),Yd=a(135),Ce=a(515),ye=a(38),Ae=a(74),He=a(420),gf=a(35),Xe=a(236);class $a extends Sys.EventArgs{constructor(Ba){super();this.QU=Ba}}Object(b.a)($a,"ErrorDataArgs",Sys.EventArgs,[]);var ac=a(644),Da=a(110),Na=a(28);class sb{constructor(Ba,Ea){this.zSb=null;this.S6b=this.Nld=!1;this.Wie=this.Xie=null;this.d6a=this.c6a=0;this.C_f=Ba;this.ige=Ea}get PJf(){return this.ige}get qLb(){return this.Xie}get B_f(){return this.Wie}get Xti(){return this.fze(this.C_f.getTime())}get o_i(){return this.fze(this.B_f.getTime())}get k6f(){return!(this.S6b||
void 0===window.bsqmXLSPageLoadStartTime)}get l2c(){try{return this.zSb||(this.zSb=Da.toUtc(window.bsqmXLSPageLoadStartTime)),this.zSb}catch(Ba){return null}}set l2c(Ba){this.zSb=Ba}bxj(Ba){this.S6b||(this.Xie=Ba,this.Wie=Da.toUtc(this.qLb))}oai(Ba){if(Ba.Values&&(!this.c6a||!this.d6a))try{wb.a.Jbf in Ba.Values&&(this.c6a=parseInt(Ba.Values[wb.a.Jbf].toString(),10));wb.a.Kbf in Ba.Values&&(this.d6a=parseInt(Ba.Values[wb.a.Kbf].toString(),10));const Ea=z.a.instance;0<this.c6a&&(this.tqf(this.c6a,"PageLoadFromHostClick"),
Ea.faj(this.c6a));0<this.d6a&&(this.tqf(this.d6a,"PageLoadFromHostFrameCreation"),Ea.gaj(this.d6a));const rc=Ba.Values[wb.a.rai]||0,wd=Ba.Values[wb.a.pai]||Ba.Values[wb.a.qai]||0;0<wd&&Ea.O$i(wd);Ea.P$i(rc)}catch(Ea){}}Kkj(){this.C_f=this.l2c=Na.a.Qa.zb;this.ige=0;this.Nld=this.S6b=!1}fze(Ba){const Ea=this.l2c.getTime();return Ea>=Ba?0:Ba-Ea+this.PJf}tqf(Ba,Ea){if(Ba){const rc=jc.b();rc.$Nb("UserAction",Ea,Ea,Na.a.WDb(Ba),ac.EcmaDateClock.instance.appStart);rc.mub(Ea,Da.toTimestamp(this.qLb))}}}Object(b.a)(sb,
"PageLoadPerfInfo",null,[]);var Kb=a(71);class Yb{constructor(Ba,Ea,rc){this.USc=Ba.keyCode;this.aMb(Ba.ctrlKey,1);this.aMb(Ba.shiftKey,2);this.aMb(Ba.altKey,4);this.aMb(Kb.b(Ba),8);this.aMb(rc,16);this.USc=this.Web|Ea<<24}get Web(){return this.USc}get keyCode(){return this.Web&65535}aMb(Ba,Ea){Ba&&(this.USc=this.Web|Ea<<16)}}Object(b.a)(Yb,"ShortcutSqmData",null,[]);class vc{constructor(){this.Mwd=null;this.u4g={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.tXf()}p_g(Ba,Ea,rc){0===
rc&&(rc=this.u4g[Ea.toString()]);return vc.j6f(Ba,rc)&&(Ba=new Yb(Ba,rc,m.a.isMac),!gf.a.xg(this.Mwd,Ba.Web.toString()))?(this.Mwd[Ba.Web.toString()]=!0,Ba):null}tXf(){this.Mwd={}}static emi(Ba){return 112<=Ba&&123>=Ba||61440<=Ba&&61451>=Ba}static sni(Ba){return 17!==Ba&&18!==Ba&&16!==Ba&&91!==Ba&&93!==Ba}static j6f(Ba,Ea){let rc=Ba.ctrlKey||Ba.altKey||Kb.b(Ba);Ba=Ba.keyCode;rc=vc.emi(Ba)||rc;rc=vc.sni(Ba)&&rc;return 0!==Ea&&rc}}Object(b.a)(vc,"UnhandledShortcutLogger",null,[]);class ad{constructor(Ba){this.n4b=
[];this.iPg=null;this.sqmManager=Ba}ZZb(Ba){this.n4b.push(Ba)}k6(Ba,Ea,rc){try{if(Ea)Ea.endTime=rc,this.sqmManager.ooe(Ea);else for(let wd=0,Pd=this.n4b.length;wd<Pd;wd++){const te=this.n4b[wd];Ba?(te.endTime=te.startTime,te.SDe=0):te.endTime=rc;this.sqmManager.ooe(te)}}catch(wd){}finally{this.n4b.length=0}}}Object(b.a)(ad,"UserInteractionPerfInfo",null,[]);var ld=a(36),md=a(69),Qd=a(233);class ce extends Ma.a{constructor(Ba,Ea){super();this.Ekd=this.sKb=!1;this.m6f=!0;this.Ra=new ye.a;this.EIc=!1;
this.Bc=()=>{const rc=md.a(this.$).hd.activityState,wd=gf.a.xg(rc,ld.a.Vne);gf.a.xg(rc,ld.a.Inb)||wd||this.upload()};this.$=Ba;this.Iwb=Ea;this.ea=Ba.ea;this.$.ik(this.Bc);this.yfg=new vc;this.cQa=new sb(Y.a.$Od,Ba.va.PageGenerationMetrics.TimeToCompleteFirstFlush);this.gEc=new ad(this)}zWc(Ba){this.Ra.addHandler("EREK",Ba)}vLd(Ba){this.Ra.removeHandler("EREK",Ba)}get $fh(){return this.EIc}get vgi(){return this.$.frame.jR?dd.a.xgi:dd.a.wgi}get workbookContext(){return this.$.workbookContext}get ZT(){ce.Chb||
(ce.Chb=this.ZOe());ce.l_c||(ce.l_c=!0,this.Adf());return ce.Chb}set ZT(Ba){ce.Chb=Ba;ce.Chb||(ce.l_c=!1)}get m3(){return Ae.a(this.$.va,3)}dispose(){this.$fh&&h.AFrameworkApplication.Tn&&h.AFrameworkApplication.Tn.disable();this.$&&this.$.Il(this.Bc);this.$=this.gEc=this.cQa=this.ZT=null;super.dispose()}A9e(Ba){this.cQa.oai(Ba);this.azi()}wQd(Ba){this.setDw(9415,Ba)}ZZb(Ba){this.gEc.ZZb(Ba)}k6(Ba,Ea,rc){this.gEc.k6(Ba,Ea,rc)}kwd(Ba){if(this.m3){const Ea=this.ea.isNamedObjectViewMode&&1===this.workbookContext.NovMode;
Ba=this.$.isEditMode||Ba&&this.ea.workbookContext.Options&512?2:Ea?9:this.ea.dc.inEmbedView?14:1;this.setDw(8721,Ba);this.hGh(Ba);this.EIc=!1}}Hqf(){const Ba=this.cQa;this.m3&&Ba.k6f&&(this.setDw(9450,Ba.PJf),this.setDw(9085,Ba.Xti))}Iqf(Ba){if(!this.sKb){this.sKb=!0;const Ea=this.cQa;let rc=0;this.m3&&Ea.k6f?(Ea.bxj(Ba),this.gEc.iPg=Ea.B_f,this.setDw(9086,Ea.o_i),Ea.S6b=!0,rc=this.cQa.qLb.getTime()):rc=Ba.getTime();hb.TaskExtensions.Aa(this.Iwb.value,wd=>{wd.result.Pj(Vb.a.bPg,{[wb.a.cPg]:rc})},
this.la,3)}}ooe(Ba){this.m3&&Ba&&1!==Ba.rea&&this.aha(8327,Xe.b(Ba),Xe.l(Ba),Xe.a(Ba),2,Ba.SDe,Xe.m(Ba),Xe.d(Ba),Xe.e(Ba))}yMd(Ba,Ea){Ba&&Ba.MessageIdHash&&this.xMd(Ba.MessageIdHash,Ba.MessageIdName,Ba.MessageId,Ba.ErrorCause?Ba.ErrorCause:fe.a.ACc,!1,Ea,Ba,null)}xMd(Ba,Ea,rc,wd,Pd,te,af,Cf){ce.appEncounteredFirstError||(ce.appEncounteredFirstError=!0,Yd.a.get_instance().isCompleted(13)||(Yd.a.get_instance().Vt(13),e.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));
Ba=this.wub(Ba);const Of=!!af,Ef={};Ef.ErrorName=Ea;Ef.ErrorHashCode=Ba.toString();Ef.ErrorId=rc.toString();Ef.ErrorCause=wd.toString();Ef.ErrorType=0===te?"ErrorDialog":"BusinessBar";Ef.BusinessBarEntryName=Cf||"null";Ef.ServerCorrelationId=Of?af.CorrelationId:"null";Ef.WebMethodName=Of?af.WebMethodName:"null";Ef.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Ef.WfeServerId=Of?af.WfeServerId:"null";Ea=Hd.a.hc(Ef);this.Ra.raiseEvent("EREK",new $a(Ef));e.ULS.sendTraceTag(1881314,
0,15,Ea);this.m3&&(O.a.aRf(Ba.toString()),this.aha(9134,Ba,wd,fe.a.z_d),this.ea.Ev||Pd||(this.setDw(10459,Ba),this.kwd(!0),this.Ekd=!0,this.upload(),this.Adf()))}wub(Ba){return 5439488|(Ba>>>16^Ba&65535)&65535}Fwd(Ba,Ea,rc){Ba=this.yfg.p_g(Ba,Ea,rc);this.m3&&Ba&&this.aha(11007,Ba.Web)}upload(){!this.m3||!this.sKb&&!this.Ekd||m.a.If&&h.AFrameworkApplication.Ng?m.a.If&&h.AFrameworkApplication.Ng&&e.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.ZT.rQb(),this.EIc=!0);
h.AFrameworkApplication.Tn=this.ZT=null;this.cQa.Kkj();this.sKb=!1;h.AFrameworkApplication.Tn=this.ZT=this.ZOe();this.yfg.tXf()}azi(){const Ba=this.cQa;if(this.m3&&!Ba.Nld){var Ea=Ba.c6a,rc=Ba.d6a,wd=Ba.qLb.getTime();h.AFrameworkApplication.UM=Ba.qLb;Ea&&this.setDw(10324,Ea>wd?0:wd-Ea);rc&&this.setDw(10325,rc>wd?0:wd-rc);Ba.Nld=!0}}aha(Ba,...Ea){this.m3&&this.ZT.aha(Ba,...Ea)}setDw(Ba,Ea){this.m3&&this.ZT.setDw(Ba,Ea)}ZOe(){He.a.wPe(this.$.va);return h.AFrameworkApplication.Tn}hGh(Ba){let Ea;try{Ea=
Object(J.a)(Object,Hd.a.li(h.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(rc){e.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${rc.message}`);return}if(Ea){let rc=Object(J.a)(String,Ea.ApplicationModeExtended),wd=Object(J.a)(String,Ea.ApplicationMode);rc&&wd&&(rc=rc.toUpperCase(),2!==Ba&&16!==Ba||"VIEW"!==rc&&"UNIFIED"!==rc?1!==Ba||"EDIT"!==rc&&"UNIFIED"!==rc||(rc="VIEW",wd="View"):(rc="EDIT",wd="Edit"),Ea.ApplicationModeExtended=rc,Ea.ApplicationMode=
wd,h.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=Hd.a.hc(Ea))}}Adf(){const Ba=this.$.va;this.ZT.kR=!0;this.ZT.gQb(Ba.BWsaStartTime);this.setDw(59,83);this.sKb=!1;if(this.m3){const Ea=Ba.DocumentHostInfo;this.Ceh();this.setDw(8491,this.$.GG);this.setDw(9236,Ba.RequestedUILcid);this.setDw(8473,Ba.WacHostId);this.setDw(9902,Xe.c(Ea.ClusterId));Wa.EwaSettings.ma(449)?this.ZT.G2f(""):this.ZT.G2f(Ba.FlightHolder?Ba.FlightHolder.FlightId:"");this.wQd(this.ea.dc.inEmbedView?1:0);this.Ekd=!1;
this.setDw(9104,Xe.c(Ea.FileSourceId));this.setDw(10309,this.vgi);this.Yyj();h.AFrameworkApplication.ub.lSf(Ce.a.getInstance(!1))}}Yyj(){z.a.instance.mdi(this.ZT);if(this.m6f){const Ba=z.a.instance;Ba.I$i();Ba.$$i();Ba.Z$i();Ba.Y$i();Ba.U$i();this.m6f=!1}}Ceh(){this.createStream(8327,1,Qd.a.Uhh,Qd.a.g2a);this.createStream(9134,1,3,Qd.a.g2a);this.createStream(11007,1,1,Qd.a.g2a)}createStream(Ba,Ea,rc,wd){this.ZT.createStream(Ba,Ea,rc,wd)}}ce.Chb=null;ce.l_c=!1;ce.appEncounteredFirstError=!1;Object(b.a)(ce,
"SqmManager",Ma.a,[184,486]);var ec=a(737);class Vc{constructor(Ba,Ea=!1){this.entryTypes=null;this.buffered=!1;this.entryTypes=Ba;this.buffered=Ea}}Object(b.a)(Vc,"PerformanceObserverInit",null,[]);class td extends Sys.EventArgs{constructor(Ba){super();this.zPe=Ba}}Object(b.a)(td,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class he extends Sys.EventArgs{constructor(Ba){super();this.igc=Ba}}Object(b.a)(he,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class ne{constructor(Ba){this.Ra=
new ye.a;this.XLc=!1;this.ig=()=>{if(m.a.Bp){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.fBi)).observe(new Vc([dd.a.Pwd])),this.XLc=!0)}catch(Ea){this.XLc=!1,e.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${Ea}`)}this.Ra.raiseEvent("ltpoiek",new he(this.igc))}};this.fBi=Ea=>{this.Ra.raiseEvent("ltoek",new td(Ea))};this.$=Ba;this.$.ea.sg?this.ig(this,Sys.EventArgs.Empty):this.$.ea.Ak(this.ig)}get igc(){return this.XLc}Oqe(Ba){this.Ra.addHandler("ltoek",
Ba)}hgj(Ba){this.Ra.removeHandler("ltoek",Ba)}aLg(Ba){this.Ra.addHandler("ltpoiek",Ba)}igj(Ba){this.Ra.removeHandler("ltpoiek",Ba)}dispose(){this.$.ea.jo(this.ig);Ac.a.Ia(this.Ra);this.$=this.Ra=null}}Object(b.a)(ne,"LongTaskPerformanceObserver",null,[2]);var Te=a(171);class Me{constructor(Ba=0,Ea=0){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=Ba;this.longTaskDuration=Ea}get Swd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:
0}Tsi(Ba){return 100*this.Swd>Ba}HIg(Ba){this.Hpe(Ba.longTaskDuration);this.jWc(Ba.activeSessionDuration)}Hpe(Ba){this.longTaskDuration+=Ba}jWc(Ba){this.activeSessionDuration+=Ba}}Object(b.a)(Me,"LongTaskPerformanceData",null,[]);class Ye{constructor(Ba,Ea,rc,wd,Pd){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=Ba;this.entireSessionData=Ea;this.worstWindowData=rc;this.postBootWindowData=wd;this.maxUsersCount=
Pd}get reportName(){return"LongTaskPerformance"}static get sph(){return new Ye(!1,new Me,new Me,new Me,0)}}Object(b.a)(Ye,"LongTaskPerformanceDataStatistics",null,[280]);class pf extends Sys.EventArgs{constructor(Ba){super();this.Qwd=Ba}}Object(b.a)(pf,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Be=a(461),Ie=a(377);class Hf{constructor(Ba,Ea){this.Ra=new ye.a;this.$Na=this.n6=this.KS=this.De=null;this.qnf=this.XTd=this.Njc=!1;this.EOa=null;this.maxUsersCount=0;this.jpc=(rc,wd)=>{rc=wd.zPe.getEntriesByType(dd.a.Pwd);
for(const Pd of rc)this.De.xD(Pd.duration)||h.AFrameworkApplication.INa||(this.KS.Hpe(Pd.duration),this.Ra.raiseEvent("lttek",new pf(Pd)),rc={},rc.LongTaskDuration=Pd.duration,rc.LongTaskStartTime=Pd.startTime,e.ULS.sendTraceTag(187982418,0,50,JSON.stringify(rc)))};this.ig=()=>{this.XTd=!0;this.nAc()};this.JB=(rc,wd)=>{wd&&(this.maxUsersCount=Math.max(this.maxUsersCount,wd.o1d));this.n6.maxUsersCount=this.maxUsersCount};this.dd=()=>{this.nAc()};this.Bc=()=>{this.V$f()};this.LDf=(rc,wd)=>{wd.igc&&
this.nAc()};this.lrf=()=>{this.KS.jWc(Da.getElapsedMilliseconds(this.$Na,Na.a.Qa.zb));this.ZVd(!0);var rc=!1;this.n6.postBootWindowData.activeSessionDuration?(!this.qnf&&Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(this.qjg&&jc.b().oWf(2),T.Health.instance.recordKpiUsage(Ie.a.longJsTask,0,Be.a.Yti,null),this.qnf=!0),!this.n6.isVetoSession&&this.KS.Tsi(this.mkg)&&(this.n6.isVetoSession=!0,Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(this.qjg&&jc.b().pWf(2,this.dBi),T.Health.instance.recordKpiFailure(Ie.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.n6.worstWindowData.Swd<=this.KS.Swd&&(this.n6.worstWindowData=this.KS),this.n6.entireSessionData.HIg(this.KS)):(this.n6.postBootWindowData=new Me(this.KS.activeSessionDuration,this.KS.longTaskDuration),rc=!0);const wd={};wd.LastWindowScore=this.KS;wd.postBootWindow=rc;wd.CoauthersNumber=this.$.ea.Xm.length;rc=JSON.stringify(wd);e.ULS.sendTraceTag(20779346,0,50,rc);this.KS=
new Me};this.boc=()=>{this.De.ti||h.AFrameworkApplication.INa||this.ZVd(!1)};this.aoc=()=>{this.KS.jWc(Da.getElapsedMilliseconds(this.$Na,Na.a.Qa.zb));this.$Na=null;this.EOa.cancel()};this.$=Ba;this.mkg=Ba.va.LongTaskPerformanceVetoThreshold;this.dBi="PercentageOver_"+this.mkg.toString();this.Rwd=Ba.va.LongTaskPerformanceWindowDurationInMs;this.NN=Ea;this.qjg=Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.$a(291,rc=>{this.De=rc;this.nAc()});this.$.ea.sg?this.ig(this,
Sys.EventArgs.Empty):this.$.ea.Ak(this.ig);this.NN.aLg(this.LDf);this.$.ml(this.dd);this.$.ik(this.Bc)}bLg(Ba){this.Ra.addHandler("lttek",Ba)}jgj(Ba){this.Ra.removeHandler("lttek",Ba)}dispose(){this.XTd=!1;this.V$f();this.$.Jl(this.dd);this.$.Il(this.Bc);this.NN.igj(this.LDf);Ac.a.Ia(this.EOa);this.NN=this.$=this.EOa=null;void 0!==this.De&&null!==this.De&&Ac.a.Ia(this.De)}nAc(){void 0===this.De||null===this.De?e.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):
this.NN.igc?this.Njc?e.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.XTd?(this.Njc=!0,this.n6=Ye.sph,this.KS=new Me,this.$.ea.d$(this.JB),this.maxUsersCount=this.$.ea.Xm.length,this.NN.Oqe(this.jpc),this.De.BGa(this.aoc),this.De.CGa(this.boc),h.AFrameworkApplication.pWc(this.aoc),h.AFrameworkApplication.qWc(this.boc),this.EOa=Ud.a.instance.create(this.lrf,this.Rwd,Ha.a.xqf,!1),dc.a(this.$).CY(this.n6),
this.De.ti||h.AFrameworkApplication.INa||this.ZVd(!0),e.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):e.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):e.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}V$f(){this.Njc&&
(this.Njc=!1,this.$.ea.jo(this.ig),this.NN.hgj(this.jpc),this.$.ea.u7(this.JB),void 0!==this.De&&null!==this.De&&(this.De.scb(this.aoc),this.De.mRa(this.boc)),h.AFrameworkApplication.UTf(this.aoc),h.AFrameworkApplication.VTf(this.boc),this.EOa.cancel(),this.$Na=this.KS=this.n6=null,this.maxUsersCount=0)}ZVd(Ba){Ba||void 0===this.$Na||null===this.$Na?(this.$Na=Na.a.Qa.zb,this.EOa=Te.AsyncMethodContext.Ech(this.lrf,Ba?this.Rwd:this.Rwd-this.KS.activeSessionDuration,Ha.a.xqf,this.EOa)):e.ULS.sendTraceTag(589875356,
0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(b.a)(Hf,"LongTaskPerformanceTracker",null,[2]);class Ne extends ye.a{constructor(Ba,Ea){super();this.statusBarManager=this.De=null;this.MDf=(rc,wd)=>{wd.Qwd&&wd.Qwd.duration>=this.gBi&&(this.yrf++,this.Onf=wd.Qwd.duration)};this.$=Ba;this.$.da.$a(29,rc=>{this.statusBarManager=rc;rc.GJ(this)});this.$.da.$a(291,rc=>{this.De=
rc});this.Onf=this.yrf=0;this.gBi=Ba.va.LongTaskThresholdMs;this.u9a=Ea;this.u9a.bLg(this.MDf)}Lq(Ba){this.addHandler("LTSCEK",Ba)}fr(Ba){this.removeHandler("LTSCEK",Ba)}Oz(){this.Gn("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}ns(Ba,Ea){if("QueryLongTasksCount"!==Ba)return!1;this.D7h(Ea);return!0}Gn(){return Wa.EwaSettings.ma(576)}dispose(){this.statusBarManager&&(this.statusBarManager.iG(this),this.statusBarManager=null);this.u9a.jgj(this.MDf);super.dispose()}D7h(Ba){Ba.Value=`Long Tasks: ${this.yrf} | Last Task Duration: ${Math.round(this.Onf)}ms`}}
Object(b.a)(Ne,"LongTasksStatusBarManager",ye.a,[2,211,212]);var Je=a(11);class Jf{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(b.a)(Jf,"NetworkInfoData",null,[]);class Ue extends ye.a{constructor(Ba){super();this.statusBarManager=null;this.XVc=!1;this.Gwf=()=>{this.raiseEvent("NetworkInformation")};this.$=Ba;Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&(this.Y_=this.b_d("connection")||
this.b_d("mozConnection")||this.b_d("webkitConnection"))&&Wa.EwaSettings.ma(465)&&Ba.da.$a(29,Ea=>{this.statusBarManager=Ea;Ea.GJ(this);this.Y_.addEventListener("change",this.Gwf);this.XVc=!0})}Lq(Ba){this.addHandler("NetworkInformation",Ba)}fr(Ba){this.removeHandler("NetworkInformation",Ba)}$4a(){return this.Y_?Object(Cb.a)(new Jf,{bandwidthMps:this.Y_.downlink,rttMs:this.Y_.rtt,connectionType:this.Y_.type,effectiveConnection:this.Y_.effectiveType,downlinkMaxMps:this.Y_.downlinkMax}):null}ns(Ba,
Ea){if("QueryNetworkInformation"!==Ba)return!1;this.E7h(Ea);return!0}Gn(){return this.XVc}dispose(){this.XVc&&(this.statusBarManager&&(this.statusBarManager.iG(this),this.statusBarManager=null),this.Y_&&this.Y_.removeEventListener("change",this.Gwf));this.$=null;super.dispose()}b_d(Ba){return Je.HelperMethods.Fn(window.navigator,Ba)?window.navigator[Ba]:null}E7h(Ba){Ba.Value="Network: "+this.Y_.downlink.toString()+" Mbps, "+this.Y_.rtt.toString()+" ms"}}Object(b.a)(Ue,"NetworkInformationManager",
ye.a,[211,212]);var ab=a(187),Nb=a(21);class tc{constructor(Ba="",Ea=-1,rc=-1,wd=-1,Pd=!1,te=!0,af=!0,Cf=!1,Of="",Ef=-1){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=Ba;this.startTime=Ea;this.startToNextFrame=rc;this.startToResponseRenderEnd=wd;this.wasHidden=Pd;this.isUserOperation=te;this.isGroupBreaking=
af;this.operationThatLedToLogging=Of;this.startToOperationThatLedToLogging=Ef;this.isPartOfGroup=Cf}}Object(b.a)(tc,"OperationStatisticsData",null,[]);var Nc=a(79);class pd{constructor(){this.operationsGroups=null;this.Gci()}isGroup(Ba,Ea,rc){const wd=new ab.a;wd.addRange(Ba);wd.addRange(Ea);for(let Pd=0;Pd<this.operationsGroups.count;Pd++)if(this.Moi(this.operationsGroups.na(Pd),wd,rc))return e.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${rc}' is part of a group ( operationsList: ${this.wJf(Ba)} , frameOperationsList: ${this.wJf(Ea)})`),
!0;e.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${rc}' is NOT part of a group.`);return!1}Moi(Ba,Ea,rc){let wd=0;for(let Pd=0;Pd<Ea.count;Pd++)if(Ea.na(Pd).isGroupBreaking){if(Ba.count<=wd||!Ca.a.equals(Ea.na(Pd).name,Ba.na(wd),!0))return!1;wd++}return Ba.count>wd&&Ca.a.equals(rc,Ba.na(wd),!0)}wJf(Ba){Ba=Nc.select(Ba,Ea=>Ea.name);return`[${Nc.toArray(Ba).join(", ")}]`}Gci(){this.operationsGroups=new ab.a;let Ba;this.oZa((Ba=new ab.a,Ba.add("Paste"),Ba.add("SelectingRange_unknown"),
Ba));let Ea;this.oZa((Ea=new ab.a,Ea.add("AutoSum"),Ea.add("SelectingRange_unknown"),Ea));let rc;this.oZa((rc=new ab.a,rc.add("ChangeSheetDirection"),rc.add("ActiveItemChanged"),rc));let wd;this.oZa((wd=new ab.a,wd.add("InsertSheet"),wd.add("ActiveItemChanged"),wd.add("SelectingRange_unknown"),wd));let Pd;this.oZa((Pd=new ab.a,Pd.add("DeleteSheet"),Pd.add("DialogButtonClick"),Pd.add("ActiveItemChanged"),Pd.add("SelectingRange_unknown"),Pd));let te;this.oZa((te=new ab.a,te.add("EditBoxEndEdit"),te.add("SetCell"),
te.add("SelectingRange_keyboard"),te.add("MoveDownWithinSelectionOrCommitEdit"),te))}oZa(Ba){this.operationsGroups.add(Ba)}}Object(b.a)(pd,"OperationsGroupDetector",null,[]);var zd=a(25);class Sd{constructor(Ba,Ea,rc,wd){this.framePerformanceTracker=this.fKb=this.j0=this.c1=null;this.Wij=()=>{this.OXc=-1;const Pd=Je.HelperMethods.Tb();this.kYj(Pd);Wa.EwaSettings.ma(365)&&(this.yLb&&(e.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),
this.hQb(this.hF,Pd),this.yLb=!1),this.hic&&(this.hQb(this.MD,Pd),this.yLb||this.hQb(this.hF,Pd)));window.setTimeout(this.Zyi,0)};this.Zyi=()=>{var Pd=[];const te=this.$.va.OperationToPrevOperationThreshold;for(var af=0;af<this.hF.count;af++){var Cf=this.hF.na(af);af<te&&Pd.push(Cf);this.MD.add(Cf)}Nb.h(this.$)&&Nb.h(this.$).Ea?((af=this.sessionStatisticsManager.mfd(0))?(Cf=JSON.stringify(this.BDb),Pd=JSON.stringify(Pd),e.ULS.sendTraceTag(237798547,1,50,`DOM count: (${af.PEi}, ${af.HSg}, ${af.ADi}), long tasks: ${Cf}, operations count: ${this.hF.count}, operations: ${Pd}`)):
e.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.hF.count>te&&e.ULS.sendTraceTag(537153875,1,50,`More than ${te} operations are in the operationsList. count: ${this.hF.count}`),this.hF.clear(),this.BDb.clear()):e.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.jpc=(Pd,te)=>{this.eBi(te.zPe)};this.$=Ba;this.QI=Ea;this.Oh=this.Oh||Na.a.Qa;this.MD=new ab.a;this.hF=new ab.a;this.OXc=this.M8a=-1;this.BDb=new ab.a;this.operationsGroupDetector=
new pd;this.yLb=this.hic=!1;this.cdi();this.Ici();this.Hci();this.sessionStatisticsManager=rc;this.NN=wd;this.NN.Oqe(this.jpc);this.$.da.$a(263,Pd=>{this.framePerformanceTracker=Pd})}oKb(Ba,Ea){var rc=Je.HelperMethods.Tb();const wd=Wa.EwaSettings.ma(365)?this.operationsGroupDetector.isGroup(this.MD,this.hF,Ba):!1;this.hic=this.Ajf(Ba);Wa.EwaSettings.ma(365)?this.hic&&0<this.MD.count&&!wd&&(this.pXj(),this.Phg(Ba,rc),this.PXe()):0<this.MD.count&&this.Ajf(Ba)&&(this.Phg(Ba,rc),this.PXe());this.M8a=
-1;if(Nb.h(this.$)&&Nb.h(this.$).Ea){var Pd=!this.c1.contains(Ba);rc=new tc(Ba,rc,void 0,void 0,void 0,Pd,this.hic,wd);this.hF.add(rc);this.framePerformanceTracker&&this.framePerformanceTracker.sJj(rc.name,Ea);Wa.EwaSettings.ma(365)&&!this.yLb&&this.fKb.contains(Ba)&&(this.yLb=!0);-1===this.OXc&&(this.OXc=window.requestAnimationFrame(this.Wij))}else e.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}Xuc(){this.M8a=Je.HelperMethods.Tb()}cvc(){this.MD.count||this.hF.count?(this.hQb(this.hF,
this.M8a),this.hQb(this.MD,this.M8a)):e.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.M8a}`);this.M8a=-1}Ajf(Ba){return!this.j0.contains(Ba)&&!Ba.includes("Menu")&&!Ba.includes("TellMe")}PXe(){for(let Ba=0;Ba<this.MD.count;Ba++){const Ea=this.MD.na(Ba);this.QI.zEg(Ea);this.Fzi(Ea)}this.MD.clear()}kYj(Ba){for(let Ea=0;Ea<this.hF.count;Ea++)this.hF.na(Ea).startToNextFrame=this.ghd(this.hF.na(Ea).startTime,Ba),this.hF.na(Ea).wasHidden=
ec.a.xD(this.hF.na(Ea).startToNextFrame)}Phg(Ba,Ea){for(let rc=0;rc<this.MD.count;rc++)-1===this.MD.na(rc).startToResponseRenderEnd&&(this.MD.na(rc).operationThatLedToLogging=Ba,this.MD.na(rc).startToOperationThatLedToLogging=this.ghd(this.MD.na(rc).startTime,Ea))}pXj(){var Ba=!1;for(let Ea of this.MD)if(Ea.isPartOfGroup){Ba=!0;break}if(Ba)for(Ba=0;Ba<this.MD.count;Ba++)this.MD.na(Ba).isPartOfGroup=this.MD.na(Ba).isGroupBreaking}hQb(Ba,Ea){for(let rc=0;rc<Ba.count;rc++)Ba.na(rc).startToResponseRenderEnd=
this.ghd(Ba.na(rc).startTime,Ea),Ba.na(rc).wasHidden=ec.a.xD(Ba.na(rc).startToResponseRenderEnd)}Fzi(Ba){Ba=JSON.stringify(Ba);e.ULS.sendTraceTag(2020372336,1,50,`${Ba}`)}ghd(Ba,Ea){return-1===Ba?-1:-1===Ea?-2:Ea-Ba}eBi(Ba){Ba=Ba.getEntriesByType(dd.a.Pwd);for(let Ea=0;Ea<Ba.length;Ea++)if(30>this.BDb.count)if(this.hF.count)this.BDb.add(this.X0i(Ba[Ea]));else{const rc=Ba[Ea];if(null===rc||void 0===rc?0:rc.attribution)void 0!==rc.attribution.containerSrc&&null!==rc.attribution.containerSrc&&(rc.attribution.containerSrc=
""),void 0!==rc.attribution.containerId&&null!==rc.attribution.containerId&&(rc.attribution.containerId=""),void 0!==rc.attribution.containerName&&null!==rc.attribution.containerName&&(rc.attribution.containerName="");e.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{e.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${Ba.length} First long task: ${this.BDb.na(0)}`);break}}X0i(Ba){return`name:${Ba.name}, startTime:${Ba.startTime}, duration:${Ba.duration}`}cdi(){this.c1||
(this.c1=new jb.a(eb.a.Yj()),this.c1.add("ActiveItemChanged"),this.c1.add(jc.b().uj(-1398645260)),this.c1.add(jc.b().uj(722290388)),this.c1.add(jc.b().uj(974713501)),this.c1.add(zd.a.OQ(zd.a.c4b)),this.c1.add(zd.a.OQ(zd.a.b4b)),this.c1.add(zd.a.OQ(zd.a.xrb)),this.c1.add(zd.a.OQ(zd.a.qOf)),this.c1.add(zd.a.OQ(zd.a.zna)))}Ici(){this.j0||(this.j0=new jb.a(eb.a.Yj()),this.j0.add("PromptEditInBrowser"),this.j0.add(jc.b().uj(-1398645260)),this.j0.add(jc.b().uj(722290388)),this.j0.add(jc.b().uj(974713501)),
this.j0.add(zd.a.OQ(zd.a.c4b)),this.j0.add(zd.a.OQ(zd.a.b4b)),this.j0.add(zd.a.OQ(zd.a.xrb)),this.j0.add(zd.a.OQ(zd.a.qOf)),this.j0.add(zd.a.OQ(zd.a.zna)))}Hci(){this.fKb||(this.fKb=new jb.a(eb.a.Yj()),this.fKb.add("SelectingRange_keyboard"),this.fKb.add("SelectingRange_mouse"))}}Object(b.a)(Sd,"OperationStatistics",null,[]);var ke=a(580);class ie{constructor(Ba,Ea){this.messageIdName=null;this.errorCause=0;this.messageIdName=Ba;this.errorCause=Ea}}Object(b.a)(ie,"RequestError",null,[]);class Fe{constructor(Ba,
Ea,rc,wd,Pd,te,af,Cf,Of,Ef,ig,Wf,og,Xf,xg,qg,Yf){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=
0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=Ba;this.isUserTriggeredRequest=Fe.VUh(Ba);this.isFullyLoggedKPIRequest=Fe.QUh(Ba);this.isPromotedUTRRequest=Fe.RUh(Ba);this.requestDuration=Ea;this.totalOperationDuration=rc;this.requestTimeInQueue=wd;this.requestInvokedTime=Pd;this.ecsOperationDuration=te.EcsOperationDuration;this.EcsRequestDuration=te.EcsRequestDuration;this.WfeRequestDuration=
te.WfeRequestDuration;this.TimeFromLastEcsFreeze=te.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=te.DuringLoadOnDemand;this.correlationID=af;this.errors=Fe.P6g(Cf);this.httpStatus=Of;this.requestResourceTiming=Ef;this.communicationErrorRetryCount=ig;this.successfulCall=Wf;this.isDocumentHidden=og;this.coauthorsCount=Xf;this.responseSize=xg;this.networkInfoData=qg;this.responseToCallbackTime=Yf}static P6g(Ba){if(!Ba)return[];const Ea=[];for(const rc of Ba)Ea.push(new ie(rc.MessageIdName,rc.ErrorCause));
return Ea}static VUh(Ba){return!Fe.GHi.contains(Ba)}static eXh(){const Ba=new jb.a(eb.a.Yj());Ba.add("CheckPersistedContentUpdate");Ba.add("GetContentBundle");Ba.add("GetSessionStatus");Ba.add("GetStatusBarAggregates");Ba.add("PollSessionStatus");Ba.add("UpdatePresenceUsers");Ba.add("UploadLatencyTelemetry");return Ba}static QUh(Ba){return Fe.IIh.contains(Ba)}static RUh(Ba){return Fe.Y5i.contains(Ba)}static xTh(){const Ba=new jb.a(eb.a.Yj());Ba.add("SetRichTextCell");Ba.add("Copy");Ba.add("FormatCells");
Ba.add("PasteRange");Ba.add("FindCell");Ba.add("ApplyToRangesV2");Ba.add("ResizeRowsColumns");Ba.add("InsertDeleteCells");Ba.add("FillRange");Ba.add("PasteHtmlContent");Ba.add("ApplyFilter");Ba.add("PasteString");Ba.add("Undo");Ba.add("LineageUpdateView");Ba.add("FindAll");Ba.add("ApplyHyperlink");Ba.add("AutoFit");Ba.add("GetPrintSettings");Ba.add("GetEdgeCell");Ba.add("Paste");Ba.add("MoveAndResizeFloatingObject");Ba.add("FindRange");Ba.add("SetCustomFilter");Ba.add("RenameSheet");Ba.add("ApplyThreadedComment");
Ba.add("SortFilterColumn");Ba.add("InsertCopiedCutCells");Ba.add("InsertSheet");Ba.add("ToggleAutoFilter");Ba.add("ReorderSheets");Ba.add("SetOutlineLevel");Ba.add("RefreshAll");Ba.add("LineageOpenPaneOrChangeFilter");Ba.add("ApplySlicerSelection");Ba.add("GetCardViewCardByCell");Ba.add("AutoSum");Ba.add("LineageClosePane");Ba.add("Sort");Ba.add("ClearAutoFilter");Ba.add("DeleteSheet");Ba.add("Redo");Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(Ba.add("RemovePageBreak"),
Ba.add("InsertPageBreak"),Ba.add("SetPrintArea"),Ba.add("ClearPrintArea"));return Ba}static SUh(){const Ba=new jb.a(eb.a.Yj());Ba.add("DeleteConditionalFormattingRules");Ba.add("GetConditionalFormattingRules");Ba.add("AddConditionalFormattingRule");Ba.add("QuickEditConditionalFormattingRule");Ba.add("GetPrintSettings");Ba.add("UpdatePresenceUsers");Ba.add("GetThemeInfo");Ba.add("InsertCopiedCutCells");Ba.add("PasteRange");Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&
(Ba.add("LineageOpenPaneOrChangeFilter"),Ba.add("LineageUpdateView"),Ba.add("LineageRefreshView"),Ba.add("LineageLoadMore"));return Ba}}Fe.GHi=Fe.eXh();Fe.IIh=Fe.xTh();Fe.Y5i=Fe.SUh();Object(b.a)(Fe,"RequestStatisticsData",null,[]);class qc{constructor(Ba,Ea,rc){this.$=Ba;this.QI=Ea;this.bma=rc}gvc(Ba,Ea,rc,wd,Pd,te,af,Cf,Of,Ef,ig,Wf,og,Xf){Wf=ke.a(Wf);Ba=new Fe(Ba,Ea,rc,wd,Pd,te,af,Cf,Of,Wf,Ef,ig,ec.a.xD(Ea),this.Igd(null),og,this.bma.$4a(),Xf);this.PMd(Ba)}gh(Ba,Ea){Ba="UnknownMethodName";let rc=
-1;void 0!==Ea.context&&null!==Ea.context&&(Ba=Ea.context.methodName,rc=Ea.context.communicationErrorRetryCount);let wd,Pd={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};Ea.nd?(wd=Ea.nd.Errors||[],this.QI.Oij(Ea.nd.EditSessionIsDirty),void 0!==Ea.nd.RequestTelemetryData&&null!==Ea.nd.RequestTelemetryData&&(Pd=Ea.nd.RequestTelemetryData)):wd=[];const te=Ea.duration,af=ke.a(Ea.url);Ea=new Fe(Ba,te,Ea.totalOperationDuration,Ea.pYd,
Ea.LF,Pd,Ea.gQd,wd,Ea.httpStatus,af,rc,!0,ec.a.xD(te),this.Igd(Ea.nd),Ea.responseSize,this.bma.$4a(),Ea.responseToCallbackTime);this.PMd(Ea)}zm(Ba,Ea){Ba="UnknownMethodName";let rc=-1;void 0!==Ea.context&&null!==Ea.context&&(Ba=Ea.context.methodName,rc=Ea.context.communicationErrorRetryCount);const wd=Ea.duration,Pd=ke.a(Ea.url);Ea=new Fe(Ba,wd,Ea.totalOperationDuration,Ea.pYd,Ea.LF,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},
Ea.gQd,Ea.errors||[],Ea.httpStatus,Pd,rc,!1,ec.a.xD(wd),this.Igd(null),-1,this.bma.$4a(),Ea.responseToCallbackTime);this.PMd(Ea)}PMd(Ba){this.QI.ZNg(Ba);if(Wa.EwaSettings.ma(227)){var Ea=Ba.requestName;if(Ea!==dd.a.iwa&&"SetCell"!==Ea&&"FindRange"!==Ea&&"FindAll"!==Ea&&"FindCell"!==Ea)return}Ea=Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===Ba.requestName||null===Ba.requestName)&&Ba.isPromotedUTRRequest;qc.ynh(Ba,Ea);this.QI.AEg(Ba)}Igd(Ba){var Ea;if(null===
(Ea=null===Ba||void 0===Ba?void 0:Ba.CollaborationResult)||void 0===Ea?0:Ea.Users)return Ba.CollaborationResult.Users.length;Ba=this.$.ea.Xm.length;return 0<Ba?Ba:1}static ynh(Ba,Ea){Ea?jc.b().Zwc(388829456,0,15,Ba):(Ea=Sys.Serialization.JavaScriptSerializer.serialize(Ba),e.ULS.sendTraceTag(388829456,0,50,Ea));if(Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==Ba.requestName&&null!==Ba.requestName&&Ba.isFullyLoggedKPIRequest){Ea=new Map;Ea.set("isUserTriggeredRequest",
Ba.isUserTriggeredRequest.toString());Ea.set("requestDuration",Ba.requestDuration.toString());Ea.set("totalOperationDuration",Ba.totalOperationDuration.toString());Ea.set("requestTimeInQueue",Ba.requestTimeInQueue.toString());Ea.set("requestInvokedTime",Ba.requestInvokedTime.toString());Ea.set("ecsOperationDuration",Ba.ecsOperationDuration.toString());Ea.set("ecsRequestDuration",Ba.EcsRequestDuration.toString());Ea.set("wfeRequestDuration",Ba.WfeRequestDuration.toString());Ea.set("timeFromLastEcsFreeze",
Ba.TimeFromLastEcsFreeze.toString());Ea.set("duringLoadOnDemand",Ba.DuringLoadOnDemand.toString());Ea.set("correlationID",Ba.correlationID);Ea.set("errors",Ba.errors.toString());Ea.set("httpStatus",Ba.httpStatus.toString());if(Ba.networkInfoData){var rc=Ba.networkInfoData;Ea.set("networkInfoData_bandwidthMps",void 0===rc.bandwidthMps||null===rc.bandwidthMps?"NA":rc.bandwidthMps.toString());Ea.set("networkInfoData_rttMs",void 0===rc.rttMs||null===rc.rttMs?"NA":rc.rttMs.toString());Ea.set("networkInfoData_effectiveConnection",
void 0===rc.effectiveConnection||null===rc.effectiveConnection?"NA":rc.effectiveConnection)}Ba.requestResourceTiming&&(rc=Ba.requestResourceTiming,Ea.set("requestResourceTiming_fetchStart",void 0===rc.downloadDuration||null===rc.downloadDuration?"NA":rc.downloadDuration.toString()));Ea.set("communicationErrorRetryCount",Ba.communicationErrorRetryCount.toString());Ea.set("successfulCall",Ba.successfulCall.toString());Ea.set("isDocumentHidden",Ba.isDocumentHidden.toString());Ea.set("coauthorsCount",
Ba.coauthorsCount.toString());Ea.set("responseSize",Ba.responseSize.toString());Ea.set("responseToCallbackTime",Ba.responseToCallbackTime.toString());jc.b().dvc(Ba.requestName,Ba.successfulCall,Ea)}}}Object(b.a)(qc,"RequestStatistics",null,[]);var Uc=a(206),ub=a(60),Xb=a(314);class wc{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(b.a)(wc,
"OperationTypeStatisticsData",null,[]);class Tc{constructor(Ba,Ea){this.data=new wc;this.data.operationName=Ba;this.data.isUserOperation=Ea;this.data.totalCount=0;this.o$f=[];this.p$f=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}ud(Ba){this.data.totalCount<Tc.P8c&&(this.o$f.push(Ba.startToNextFrame),this.p$f.push(Ba.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<
Ba.startToNextFrame&&(this.data.longestStartToNextFrame=Ba.startToNextFrame);this.data.longestStartToResponse<Ba.startToResponseRenderEnd&&(this.data.longestStartToResponse=Ba.startToResponseRenderEnd)}Rbd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.K4e(this.o$f),this.data.startToResponsePercentiles=this.K4e(this.p$f))}K4e(Ba){Ba.sort(Je.HelperMethods.FB);let Ea;Ea="("+ec.a.Ova(Ba,25).toString();Ea=Ea+", "+ec.a.Ova(Ba,50).toString();Ea=Ea+", "+ec.a.Ova(Ba,75).toString();
Ea=Ea+", "+ec.a.Ova(Ba,95).toString();return Ea+")"}}Tc.P8c=1E3;Object(b.a)(Tc,"OperationTypeStatistics",null,[]);class sd{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=
this.requestDurationPercentile25=0}}Object(b.a)(sd,"RequestTypeStatisticsData",null,[]);class qb{constructor(Ba){this.data=new sd;this.data.requestName=Ba;this.data.totalCount=0;this.Ncb=[];this.vZd=this.nZd=this.oZd=this.sZd=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=
-1}sjj(Ba){this.data.totalCount<qb.P8c&&this.Ncb.push(Ba.requestDuration);this.data.totalCount++;this.sZd+=Ba.requestDuration;this.oZd+=qb.oed(Ba.ecsOperationDuration);this.nZd+=qb.oed(Ba.EcsRequestDuration);this.vZd+=qb.oed(Ba.WfeRequestDuration);0<Ba.TimeFromLastEcsFreeze&&Ba.TimeFromLastEcsFreeze<qb.wIh&&this.data.callsDuringEcsFreeze++;Ba.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;Ba.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||
null===this.data.longestRequest||this.data.longestRequest.requestDuration<Ba.requestDuration)this.data.longestRequest=Ba}Rbd(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.sZd/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.oZd/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.nZd/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.vZd/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=
0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Ncb.sort(Je.HelperMethods.FB),this.data.requestDurationPercentile25=ec.a.Ova(this.Ncb,25),this.data.requestDurationPercentile50=ec.a.Ova(this.Ncb,50),this.data.requestDurationPercentile75=ec.a.Ova(this.Ncb,75),this.data.requestDurationPercentile95=ec.a.Ova(this.Ncb,95))}static oed(Ba){return 0>Ba?0:Ba}}qb.wIh=3E3;qb.P8c=1E3;Object(b.a)(qb,"RequestTypeStatistics",null,[]);class Sb{constructor(Ba,Ea,rc,wd,Pd,te,af,Cf){this.mode=null;
this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=Ba;this.ocsCapable=Ea;this.endedBySplashScreen=rc;this.dirtySessionOnLastRecordedRequest=wd;this.loadOnDemandCount=Pd;this.maxCoauthorsCount=te;this.everConnectedToOcs=af;Ba=[];for(let Of in Cf)Ea=Cf[Of],Ea.Rbd(),Ba.push(Ea.data);this.requests=Ba}}Object(b.a)(Sb,"SessionStatisticsData",null,[]);class mc{constructor(Ba){this.dirtySessionOnLastRecordedRequest=
this.UVd=!1;this.npf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=Ba;this.rnb={};this.qnb={};this.I6c={}}Bc(){var Ba=this.Cfh();if(Y.a.aea()){var Ea={};Ea.xlendJson=Ba;this.$.Nna(Uc.a.u2j,Ea,!1)}else ub.N(this.$.pa.ya,Ba,null,null,null,null,null);Ba=this.Dfh();Y.a.aea()?(Ea={},Ea.xlenoJson=Ba,this.$.Nna(Uc.a.v2j,Ea,!1)):e.ULS.sendTraceTag(388776782,0,50,Ba);Wa.EwaSettings.ma(69)&&(Ba=this.W$g(),Y.a.aea()?(Ea={},Ea.xlencJson=Ba,this.$.Nna(Uc.a.t2j,Ea,!1)):e.ULS.sendTraceTag(388776770,
0,50,Ba));this.Zjj()}Ojc(){this.everConnectedToOcs=this.$.ea.t8a||this.everConnectedToOcs;T.Health.instance&&T.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}ig(){const Ba=new Xb.a;let Ea="";const rc=!this.$.isAnonymousUser(),wd=Ba.se();if(wd){if(rc){Ba.Rxc("UMI_Linkable","true");return}Ea=Ba.V4a("UMI_Linkable")}rc||e.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${wd}, UMIIsLinkable:${!!Ea}`)}Lcb(){this.UVd=
!0}Oij(Ba){this.dirtySessionOnLastRecordedRequest=Ba}ZNg(Ba){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,Ba.coauthorsCount);T.Health.instance&&T.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}AEg(Ba){if(!(Ba.requestName in this.rnb)){const Ea=new qb(Ba.requestName);this.rnb[Ba.requestName]=Ea}this.rnb[Ba.requestName].sjj(Ba)}zEg(Ba){if(!(Ba.name in this.qnb)){const Ea=new Tc(Ba.name,Ba.isUserOperation);this.qnb[Ba.name]=Ea}this.qnb[Ba.name].ud(Ba)}CY(Ba){this.I6c[Ba.reportName]=
Ba}Zjj(){this.dirtySessionOnLastRecordedRequest=this.UVd=!1;this.npf=this.$.ea.Cvd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.rnb={};this.qnb={};this.I6c={}}Cfh(){const Ba=new Sb(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.UVd,this.dirtySessionOnLastRecordedRequest,this.$.ea.Cvd-this.npf,this.maxCoauthorsCount,this.everConnectedToOcs,this.rnb);return Sys.Serialization.JavaScriptSerializer.serialize(Ba)}Dfh(){var Ba=new ab.a;const Ea=this.qnb;for(let rc in Ea){const wd=
Ea[rc];wd.Rbd();Ba.add(wd.data)}Ba=Ba.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(Ba)}W$g(){return Sys.Serialization.JavaScriptSerializer.serialize(this.I6c)}}Object(b.a)(mc,"SessionStatistics",null,[]);class Lc extends Ma.a{constructor(Ba){super();this.wna=this.Kma=null;this.oJe=Array(1);this.zOc=this.Twd=null;this.gh=(Ea,rc)=>{Wa.EwaSettings.ma(40)&&(this.wna=this.wna||new qc(this.$,this.QI,this.bma),this.wna.gh(Ea,rc))};this.zm=(Ea,rc)=>{Wa.EwaSettings.ma(40)&&(this.wna=this.wna||
new qc(this.$,this.QI,this.bma),this.wna.zm(Ea,rc))};this.Bc=(Ea,rc)=>{Wa.EwaSettings.ma(40)&&this.QI.Bc(Ea,rc)};this.ig=(Ea,rc)=>{Wa.EwaSettings.ma(40)&&this.QI.ig(Ea,rc)};this.Ojc=(Ea,rc)=>{Wa.EwaSettings.ma(40)&&this.QI.Ojc(Ea,rc)};this.$=Ba;Wa.EwaSettings.ma(40)&&(ec.a.Zci(this.$),this.NN=new ne(this.$),this.Pbh(),Wa.EwaSettings.ma(576)&&this.u9a&&(this.Twd=new Ne(this.$,this.u9a)),this.QI=new mc(this.$),this.bma=new Ue(this.$),this.$.ik(this.Bc),this.$.pa.Mq(this.gh),this.$.pa.iw(this.zm),this.$.ea.Eqe(this.Ojc),
Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.Ak(this.ig))}get u9a(){return this.zOc}dispose(){this.$&&Wa.EwaSettings.ma(40)&&(this.$.Il(this.Bc),this.$.pa.Lr(this.gh),this.$.pa.hx(this.zm),this.$.ea.CUf(this.Ojc),Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.jo(this.ig));Ac.a.Ia(this.bma);Ac.a.Ia(this.u9a);this.zOc=null;Ac.a.Ia(this.NN);this.NN=null;Ac.a.Ia(this.Twd);this.$=this.Twd=null;super.dispose()}Lcb(){Wa.EwaSettings.ma(40)&&
this.QI.Lcb()}gvc(Ba,Ea,rc,wd,Pd,te,af,Cf,Of,Ef,ig,Wf,og,Xf){Wa.EwaSettings.ma(40)&&(this.wna=this.wna||new qc(this.$,this.QI,this.bma),this.wna.gvc(Ba,Ea,rc,wd,Pd,te,af,Cf,Of,Ef,ig,Wf,og,Xf))}oKb(Ba,Ea){Wa.EwaSettings.ma(40)&&(this.Kma=this.Kma||new Sd(this.$,this.QI,this,this.NN),this.Kma.oKb(Ba,Ea))}Xuc(){Wa.EwaSettings.ma(40)&&(this.Kma=this.Kma||new Sd(this.$,this.QI,this,this.NN),this.Kma.Xuc())}cvc(){Wa.EwaSettings.ma(40)&&(this.Kma=this.Kma||new Sd(this.$,this.QI,this,this.NN),this.Kma.cvc())}CY(Ba){Wa.EwaSettings.ma(40)&&
this.QI.CY(Ba)}mfd(Ba){return Wa.EwaSettings.ma(40)?this.oJe[Ba]:null}o2f(Ba){Ba&&(this.oJe[Ba.type]=Ba)}$4a(){return this.bma.$4a()}Pbh(){m.a.Bp&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.zOc=new Hf(this.$,this.NN))}}Object(b.a)(Lc,"SessionStatisticsManager",Ma.a,[11]);var rd=a(100),Z=a(1116),db=a(118),Lb=a(127);class hc{constructor(Ba,Ea){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=
!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=Ba;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=
this.dialogPromptedOnUnload=!1;this.wacSessionId=Ea}JYd(){return Hd.a.hc(this)}}Object(b.a)(hc,"AppUnloadInfo",null,[]);var Pc=a(691),Rc=a(121),xd=a(562);class Wd{constructor(Ba){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=Ba.kDe+Ba.qfg;this.dataLossReason=Ba.oze;this.yYg(Ba.n1d)}yYg(Ba){const Ea=new Pc.a(xd.a.vK());let rc=0,wd=0;for(const Pd of Ba)Ea.mb(Pd)||Ea.ia(Pd,0),Ba=Ea.ia(Pd,Ea.na(Pd)+1),Ba>
rc&&(rc=Ba,wd=Pd);rc>this.mostCommonOperationCount&&(this.mostCommonOperationName=Rc.a(wd),this.mostCommonOperationCount=rc)}}Object(b.a)(Wd,"DataLossInfo",null,[]);var ue=a(57);class ve{constructor(Ba){this.WXc="AppUnloadInfo";this.Gm=this.$=this.workbookHashedId=this.iz=null;this.F4d=this.Z7d=!1;this.Re=null;this.Ncf=0;this.Wca=(Ea,rc)=>{this.Ncf=rc.DBc};this.yIf=(Ea,rc)=>{rc.n1d.length&&this.$.wD&&(this.iz.dataLossInfo=new Wd(rc),this.iz.wasDataLostDuringUnload=!0,this.mdb())};this.ig=()=>{this.L0f();
this.$.ea.jo(this.ig)};this.qPa=()=>{this.iz.wasUpdatedOnBeforeUnload=!0;this.iz.inactivityDurationBeforeUnloadSeconds=this.Re.Cfb<ve.QDi?this.Ncf:this.Re.Cfb;this.Lhg()};this.HGb=()=>{this.iz.wasUpdatedOnUnload=!0;this.Lhg();Sys.Application.remove_unload(this.HGb)};this.nWi=()=>{this.iz.lastSilentReopenStartTime=Na.a.Qa.zb;this.iz.lastSilentReopenEndTime=null;this.mdb();this.$.ml(this.yHf)};this.yHf=()=>{this.iz.lastSilentReopenEndTime=Na.a.Qa.zb;this.mdb();this.$.Jl(this.yHf)};this.localStorage=
new Xb.a;this.localStorage.se()&&(this.$=Ba,this.workbookHashedId=ue.a(this.$),this.iz=new hc(this.workbookHashedId,this.$.va.UserSessionId),this.Gm=Lb.a.instance.uH(),this.Gm.ka("beforeunload",this.qPa),this.$.userOperationManager.RMg(this.yIf),Ba.ea.sg?this.L0f():this.$.ea.Ak(this.ig),this.Re=this.$.ea.Re,this.Re.fha(this.Wca),Sys.Application.add_unload(this.HGb),this.$.ea.aXc(this.nWi))}get dialogPromptedOnUnload(){return this.Z7d}set dialogPromptedOnUnload(Ba){this.Z7d=Ba;this.iz?(this.iz.dialogPromptedOnUnload=
Ba,this.mdb()):this.localStorage.se()&&e.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.se()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.F4d}set apiBeforeCloseNotificationEnabledOnUnload(Ba){this.F4d=Ba;this.iz?(this.iz.apiBeforeCloseNotificationEnabledOnUnload=Ba,this.mdb()):this.localStorage.se()&&e.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.se()}`)}dispose(){this.$&&
this.$.userOperationManager&&this.$.userOperationManager.Fhj(this.yIf);this.Re&&(this.Re.EAa(this.Wca),this.Re=null);this.Gm.dD();this.$=this.Gm=null}Lhg(){this.Txj();this.mdb()}Txj(){this.iz.wasOfflineDuringUnload=this.$.Te.C5;this.iz.timeFromLastConnectivity=db.a(Na.a.Qa,this.$.Te.lof);this.iz.timeFromLastDisconnectionStart=db.a(Na.a.Qa,this.$.Te.Kui);this.iz.disconnectionSource=Enum.toString(Z.a,this.$.Te.disconnectionSource);this.iz.hadConnectivityIssuesDuringUnload=this.$.Te.ala;this.iz.timeFromLastStatusCode0=
db.a(Na.a.Qa,this.$.Te.kof)}mdb(){this.iz.timestamp=Date.now();this.localStorage.Rxc(this.WXc,this.iz.JYd())}L0f(){const Ba=this.localStorage.V4a(this.WXc);if(Ba)try{const Ea=Hd.a.li(Ba);this.localStorage.vJb(this.WXc);const rc=this.lCi(Ea);e.ULS.sendTraceTag(574677456,0,50,rc)}catch(Ea){e.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Ea.message}`)}else e.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}lCi(Ba){const Ea=
{};Ea.WACSessionID=Ba.wacSessionId;Ea.wasRefreshed=this.k1g(Ba,this.$.va.MaxAppReloadDurationIndicatingRefresh);Ea.closedWithDialogConfirmation=Ba.dialogPromptedOnUnload;Ea.wasOfflineDuringUnload=Ba.wasOfflineDuringUnload;Ea.TimeFromLastConnectivityMs=Ba.timeFromLastConnectivity;Ea.TimeFromLastDisconnectionStart=Ba.timeFromLastDisconnectionStart;Ea.wasDataLostDuringUnload=Ba.wasDataLostDuringUnload;Ea.DataLossInfo=Ba.dataLossInfo;Ea.flushedOnUnload=Ba.wasUpdatedOnUnload;Ea.flushedOnBeforeUnload=Ba.wasUpdatedOnBeforeUnload;
Ea.InactivityDurationBeforeUnload=Ba.inactivityDurationBeforeUnloadSeconds;Ea.DisconnectionSource=Ba.disconnectionSource;Ea.hadConnectivityIssuesDuringUnload=Ba.hadConnectivityIssuesDuringUnload;Ea.TimeFromLastStatusCode0=Ba.timeFromLastStatusCode0;Ea.LastSilentReopenStartTime=Ba.lastSilentReopenStartTime;Ea.LastSilentReopenEndTime=Ba.lastSilentReopenEndTime;Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(Ea.ApiBeforeCloseNotificationEnabledOnUnload=
Ba.apiBeforeCloseNotificationEnabledOnUnload);return G.c(Ea)}k1g(Ba,Ea){const rc=window.performance.timing.navigationStart-Ba.timestamp;(Ba=this.workbookHashedId===Ba.workbookHashedId&&rc<Ea)&&e.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return Ba}static ka(Ba){Ba.ea.dc.inWebPart||Ba.da.Ga(410,new ve(Ba))}}ve.QDi=10;Object(b.a)(ve,"AppUnloadTelemetryManager",null,[498,2]);var qe=a(170),we=a(109);class Ze{constructor(Ba,Ea){this.stopped=!1;this.chainedCallsTracer=
Ba;this.Arg=Ea}get call(){return this.Arg}O$f(){e.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");this.stopped||(this.stopped=!0,this.chainedCallsTracer.lKj(this))}dispose(){this.O$f()}}Object(b.a)(Ze,"CallMeasureContext",null,[522,2]);class zf{constructor(Ba,Ea){this.Rad=0;this.MUe=this.startTime=Je.HelperMethods.Tb();this._name=Ba;this.vC=Ea}get name(){return this._name}get type(){return this.vC}C7g(){this.MUe=
Je.HelperMethods.Tb()}L$f(){this.Rad+=Je.HelperMethods.Tb()-this.MUe}yUh(){return Je.HelperMethods.Tb()-this.startTime}eKj(){this.L$f();return this.Rad}}Object(b.a)(zf,"MeasuredCall",null,[]);class Ja{constructor(Ba){this.Ysa=[];this.$0c=null;this.KEi=100;this.documentVisibilityObserver=null;this.JEi=Ba}c$f(Ba,Ea){this.jch();this.hKj();Ba=new zf(Ba,Ea);this.Ysa.push(Ba);return new Ze(this,Ba)}jch(){0<this.Ysa.length?e.ULS.shipAssertTag(537151054,1,!!this.$0c,"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):
this.$0c=qe.a.create().toString()}lKj(Ba){const Ea=this.Ysa.pop();if(Ba.call!==Ea)e.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",Ba.call.name,Ea?Ea.name:"null"),this.Ysa=[];else{Ba=Ea.yUh();var rc=Ea.eKj();e.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");var wd=
this.documentVisibilityObserver?this.documentVisibilityObserver.xD(Ba+this.KEi):null;this.Myi(Ea,Ba,rc,wd);this.D7g()}}hKj(){const Ba=this.e3e();Ba&&Ba.L$f()}D7g(){const Ba=this.e3e();Ba&&Ba.C7g()}e3e(){return this.Ysa.length?this.Ysa[this.Ysa.length-1]:null}Myi(Ba,Ea,rc,wd){if(!(Ea<this.JEi)){var Pd=we.f(this.Ysa,te=>te.name).join();e.ULS.sendTraceTag(537151051,0,50,`ChainedCallsTracer: Inclusive duration: ${Ea.toFixed(2)} Exclusive duration: ${rc.toFixed(2)} Chain ID: ${this.$0c} Call ID: ${Ba.name} Type: ${Ba.type} Document hidden: ${wd} Call chain: ${Pd}`)}}static ka(Ba){if(Wa.EwaSettings.ma(670)){var Ea=
new Ja(Ba.va.ChainedCallsTracerMinThresholdToLogInMs);Ba.da.$a(291,rc=>{Ea.documentVisibilityObserver=rc});Ba.da.Ga(425,Ea);ye.a.mtj(Ea)}}}Object(b.a)(Ja,"ChainedCallsTracer",null,[497]);var Eb=a(518);class zc{constructor(Ba){this.De=null;this.JPj=Ea=>{const rc={["TaskName"]:Ea.TN,["TotalRunInMs"]:Ea.TRT,["TotalDelayInMs"]:Ea.TDT,["TotalQueueInMs"]:Ea.TQT,["TaskPriority"]:Ea.TP,["CoauthorsCount"]:this.ea.Xm.length};Ea.TDT>this.yYd||Ea.TRT>this.wYd?e.ULS.sendTraceTag(321938518,0,15,C.a.toJSON(rc)):
(Ea.TDT>this.xYd||Ea.TRT>this.vYd)&&e.ULS.sendTraceTag(321938508,0,50,C.a.toJSON(rc))};this.wEh=Ea=>this.De.xD(Ea.TRT+Ea.TQT+3E3)?!1:Ea.TDT>Math.min(this.xYd,this.yYd)||Ea.TRT>Math.min(this.vYd,this.wYd);this.yYd=Ba.va.TimeToReportOnLongWaitingTaskInMsAsWarning;this.xYd=Ba.va.TimeToReportOnLongWaitingTaskInMsAsMedium;this.wYd=Ba.va.TimeToReportOnLongRunningTaskInMsAsWarning;this.vYd=Ba.va.TimeToReportOnLongRunningTaskInMsAsMedium;this.ea=Ba.ea;Ba.da.$a(291,Ea=>{this.De=Ea});e.ULS.sendTraceTag(537151046,
0,50,`TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = ${this.xYd}, TimeToReportOnLongWaitingTaskInMsAsWarning = ${this.yYd}, TimeToReportOnLongRunningTaskInMsAsMedium = ${this.vYd}, TimeToReportOnLongRunningTaskInMsAsWarning = ${this.wYd}`)}}Object(b.a)(zc,"TaskEventProcessor",null,[]);const bd=Ba=>{e.ULS.sendTraceTag(537151049,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");hb.TaskExtensions.Aa(Eb.a.kr(gb.a.instance.Ub("Common.ICpuMeterProvider")),
Ea=>{e.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");hb.TaskExtensions.Aa(Ea.result.yk.task,rc=>{e.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");const wd=new zc(Ba);rc.result.IVc(0,wd.wEh,wd.JPj)},Ba.la,3)},Ba.la,3)};var yd=a(13);class Nd{constructor(Ba){this.$Je=!1;this.bKe=null;this.Pc=()=>{this.ynj();Nb.h(this.$).ha&&Nb.h(this.$).ha.FI(this.Pc)};
this.Fh=(Ea,rc)=>{rc.oa&&!this.dYd.has(rc.oa.name)&&(this.dYd.add(rc.oa.name),Nb.h(this.$).ha&&(Nb.h(this.$).ha.FI(this.Pc),Nb.h(this.$).ha.KE(this.Pc)))};this.$=Ba;this.ccg=new Set;this.dYd=new Set;this.$.xa&&this.$.xa.oa&&this.dYd.add(this.$.xa.oa.name);Nb.h(this.$).ha.KE(this.Pc);this.$.xa.Vf(this.Fh)}dispose(){this.$=null}ynj(){this.bKe||this.GYg();const Ba=Nb.d(Nb.h(this.$));if(!this.$Je){const Ea=yd.a.instance.Ua(281).split(",");Ba.push(...Ea);this.$Je=!0}for(const Ea of Ba)Ea&&!this.ccg.has(Ea)&&
(this.Wyi(Ea),this.ccg.add(Ea))}Wyi(Ba){this.EZg(Ba)}GYg(){this.bKe=Nd.Q4a("monospace");Nd.Q4a("sans-serif");Nd.Q4a("serif")}EZg(Ba){Nd.Q4a(`${Ba},${"monospace"}`);Nd.Q4a(`${Ba},${"sans-serif"}`);Nd.Q4a(`${Ba},${"serif"}`)}static ka(Ba){if(Wa.EwaSettings.ma(62)){const Ea=new Nd(Ba);Ba.da.Ga(210,Ea)}}static Q4a(Ba){const Ea=document.createElement("div"),rc=document.createElement("div");Ea.style.cssText="position: absolute; overflow: auto; visibility: hidden;";Nd.Exj(rc,Ba);document.body.appendChild(Ea);
Ea.appendChild(rc);Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:7190190_ReduceInnerHTMLUsageForFontTelemetryManager")?rc.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+":rc.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";Ba=rc.offsetWidth+"x"+rc.offsetHeight;document.body.removeChild(rc.parentNode);return Ba}static Exj(Ba,Ea){Ba.style.cssText=
"display: inline; visibility: hidden;";Ba.style.fontSize="100px";Ba.style.fontWeight="normal";Ba.style.fontStyle="normal";Ba.style.letterSpacing="normal";Ba.style.lineHeight="normal";Ba.style.whiteSpace="nowrap";Ba.style.fontFamily=Ea}}Object(b.a)(Nd,"FontTelemetryManager",null,[2]);var je=a(235),le=a(161),bf;(function(Ba){Ba[Ba.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";Ba[Ba.reactSingleLineRibbon=1]="reactSingleLineRibbon";Ba[Ba.reactMultiLineRibbon=2]="reactMultiLineRibbon";Ba[Ba.invalid=
3]="invalid"})(bf||(bf={}));Object(b.b)("RibbonMode",bf);var De=a(104);class sf extends ye.a{constructor(){super();this.hM=!1;this.Bce=this.Ace=null;this.mCd=()=>{this.Chg()};this.CTi=()=>{Ac.a.Ia(this.tZ);Ac.a.Ia(this.Gm)};this.tZ=Lb.a.instance.DIa();this.Gm=Lb.a.instance.uH();this.tZ.ka("visibilitychange",this.mCd);this.Gm.ka("pagehide",this.CTi);this.Chg()}get ti(){return this.hM}get Dnf(){return this.Ace}get skc(){return this.Bce}BGa(Ba){this.addHandler("ekdh",Ba)}scb(Ba){this.removeHandler("ekdh",
Ba)}CGa(Ba){this.addHandler("ekduh",Ba)}mRa(Ba){this.removeHandler("ekduh",Ba)}xD(Ba){return this.ti?!0:this.skc?Da.getElapsedMilliseconds(this.skc,Na.a.Qa.zb)<Ba:!1}dispose(){Ac.a.Ia(this.tZ);Ac.a.Ia(this.Gm);super.dispose()}Chg(){this.hM="hidden"===window.document.visibilityState;this.ti?(this.raiseEvent("ekdh"),this.Ace=Na.a.Qa.zb):(this.raiseEvent("ekduh"),this.Bce=Na.a.Qa.zb)}}Object(b.a)(sf,"DocumentVisibilityObserver",ye.a,[523,2]);class uf{constructor(){this.longFramesOverThresholdOpsPercentage=
this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(b.a)(uf,"FramePerformanceData",null,[]);class Ee{constructor(Ba){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new uf;this.l2FramePerformanceData=new uf;this.l3FramePerformanceData=new uf;this.name=Ba}}Object(b.a)(Ee,"FramePerformanceDataGroup",null,[]);class Lf{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName=
"FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(b.a)(Lf,"FramePerformanceSessionEndsReport",null,[280]);class Mf{constructor(Ba){this.DEd={};this.jha=null;this.ugb=(Ea,rc)=>{Ea.longFramesOverThresholdOps++;Ea.maxLongFrameDuration=Math.max(Ea.maxLongFrameDuration,rc)};this.kf=new Lf;this.Ach();Ba.da.$a(276,()=>{dc.a(Ba).CY(this.kf)})}Ach(){this.jha=new Ee("AllGridOperationsData");this.kf.operationsGroups.push(this.jha);this.vsb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.vsb("DragScroll",["DragScroll"]);this.vsb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.vsb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.vsb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}ljj(Ba,Ea,rc,wd){const Pd=this.tTh(Ba);Pd&&(we.b(this.kf.operationsGroups,te=>Ca.a.equals(te.name,Pd.name,!1))||this.kf.operationsGroups.push(Pd),Pd.count++,this.ADc(Ea,Pd),this.wDc(rc,Pd),this.jha.count++,
this.ADc(Ea,this.jha),this.wDc(rc,this.jha),0<wd&&this.XWj(wd,Pd),0<=Ea&&this.nWj(Ea,Pd))}zXj(){for(const Ba of this.kf.operationsGroups)Mf.rWj(Ba)}vsb(Ba,Ea){Ba=new Ee(Ba);for(const rc of Ea)this.DEd[rc]=Ba}tTh(Ba){return Ba in this.DEd?this.DEd[Ba]:null}nWj(Ba,Ea){30>Ba&&this.U_d(rc=>{rc.l1FramePerformanceData.fpsUnderThresholdOps++},Ea);15>Ba&&this.U_d(rc=>{rc.l2FramePerformanceData.fpsUnderThresholdOps++},Ea);5>Ba&&this.U_d(rc=>{rc.l3FramePerformanceData.fpsUnderThresholdOps++},Ea)}XWj(Ba,Ea){100<=
Ba&&(this.vgb(Ea.l1FramePerformanceData,Ba,this.ugb),this.vgb(this.jha.l1FramePerformanceData,Ba,this.ugb));300<=Ba&&(this.vgb(Ea.l2FramePerformanceData,Ba,this.ugb),this.vgb(this.jha.l2FramePerformanceData,Ba,this.ugb));600<=Ba&&(this.vgb(Ea.l3FramePerformanceData,Ba,this.ugb),this.vgb(this.jha.l3FramePerformanceData,Ba,this.ugb))}U_d(Ba,Ea){Ea&&(Ba(Ea),Ba(this.jha))}vgb(Ba,Ea,rc){Ba&&rc(Ba,Ea)}ADc(Ba,Ea){Ea.minFPS=-1===Ea.minFPS?Ba:Math.min(Ea.minFPS,Ba)}wDc(Ba,Ea){Ea.maxFPS=Math.max(Ea.maxFPS,
Ba)}static rWj(Ba){Mf.u0d(Ba.l1FramePerformanceData,Ba.count);Mf.u0d(Ba.l2FramePerformanceData,Ba.count);Mf.u0d(Ba.l3FramePerformanceData,Ba.count)}static u0d(Ba,Ea){Ba.fpsUnderThresholdOpsPercentage=100*Ba.fpsUnderThresholdOps/Ea;Ba.longFramesOverThresholdOpsPercentage=100*Ba.longFramesOverThresholdOps/Ea}}Object(b.a)(Mf,"FramePerformanceSessionEndsReportManager",null,[]);class tg{constructor(){this.f=null}}Object(b.a)(tg,"FpsDataWrapper",null,[]);class Gg{constructor(Ba=-1,Ea=-1){this.duration=
this.startSecond=0;this.startSecond=Ba;this.duration=Ea}}Object(b.a)(Gg,"LongFrameData",null,[]);var cg=a(346);class Xa{constructor(Ba=null,Ea=0,rc=-1,wd=-1,Pd=0,te=-1,af=0,Cf=-1,Of=-1,Ef=null){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=Ba;this.count=Ea;this.start=rc;this.end=wd;this.Avg=Pd;this.Max=te;this.Min=cg.a.lng;this.longFrameCount=af;this.coauth=Cf||1;this.tfAppInt=Of;this.Props=
Ef;this.LFrame=null}}Object(b.a)(Xa,"OperationFPSData",null,[]);var Bb=a(34),Tb=a(790);class Bc extends Ma.a{constructor(Ba){super();this.Oob=-1;this.rud=0;this.fya=new Date(0);this.QY=null;this.xia={};this.Mua=new ab.a;this.TNd=this.R8a=!1;this.$3a=null;this.uBc=this.m$a=0;this.isSynthetic=!1;this.HYe=()=>{const Ea=new Date;var rc=Ea.getMinutes();const wd=Ea.getSeconds();this.GCb&&Ea.getTime()-this.GCb.getTime()>this.uNj?(this.stop(),this.Ccd(Ea)):(rc!==this.rud&&(this.Ccd(Ea),this.rud=rc),this.R8a&&
(this.De.ti?this.QY[wd]=Bc.N7b:(this.yLe(wd),this.R8a=!1,this.Mua.clear(),this.xia={})),this.QY[wd]!==Bc.N7b&&(this.QY[wd]++,rc=Ea.getTime()-this.fya.getTime(),rc>this.vrf&&this.tzi(this.fya,rc)),this.Oob=window.requestAnimationFrame(this.HYe),this.fya=Ea)};this.aW=()=>{this.R8a=!0};this.gyf=()=>{this.pause()};this.iyf=()=>{this.TNd&&this.resume()};this.Hj=()=>{this.Ea.h5()&&this.fXj()};this.GCb=new Date;this.De=new sf;this.De.BGa(this.aW);h.AFrameworkApplication.pWc(this.gyf);h.AFrameworkApplication.qWc(this.iyf);
this.$=Ba;this.vrf=Ba.va.LongFrameThresholdMs;this.cBi="MoreThan_"+this.vrf.toString()+"_Ms";this.tNj=Ba.va.ThresholdToEndOperationTrackingSeconds;this.uNj=Ba.va.ThresholdToStopFPSTrackingMS;this.Ea=Nb.h(this.$).Ea;h.AFrameworkApplication.Qb&&h.AFrameworkApplication.Qb.IsSynthetic&&(this.isSynthetic=Ca.a.compare(h.AFrameworkApplication.Qb[dd.a.isSynthetic],"True",!0)?!1:!0);this.Ea.hw(this.Hj);this.lNd();this.uzi=this.$.hla&&Wa.EwaSettings.ma(575)}start(){this.TNd=!0;this.resume()}stop(){this.TNd=
!1;this.pause()}dispose(){this.stop();this.De.scb(this.aW);h.AFrameworkApplication.UTf(this.gyf);h.AFrameworkApplication.VTf(this.iyf);Ac.a.Ia(this.De);this.Ea.gx(this.Hj);super.dispose()}sJj(Ba,Ea){const rc=Ba in this.xia?this.xia[Ba]:null;this.GCb=new Date;this.start();const wd=this.GCb.getSeconds(),Pd=wd+this.tNj;rc&&wd<=rc.end?(rc.count++,rc.end=Pd):(rc&&wd>rc.end&&this.Mua.add(rc),this.xia[Ba]=new Xa(Ba,1,wd,Pd,void 0,void 0,void 0,this.$.ea.Xm.length,ob.PageLoadTrackingInfo.instance.jwa(this.GCb),
Ea))}Pah(){this.$3a||(this.Ccd(new Date),this.$3a=new Mf(this.$))}resume(){this.phf()||!this.Ea.oL||this.isSynthetic||(this.R8a=this.De.ti,this.fya=new Date,this.rud=this.fya.getMinutes(),this.lNd(),this.yLe(this.fya.getSeconds()),this.Oob=window.requestAnimationFrame(this.HYe))}phf(){return 0<=this.Oob}pause(){this.phf()&&(this.R8a||(this.zLe((new Date).getSeconds()),e.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.QY.toString()}`)),window.cancelAnimationFrame(this.Oob),this.Oob=-1)}Ccd(Ba){if(Ba.getTime()-
this.fya.getTime()<Bc.HEi&&(this.R8a&&this.zLe(this.fya.getSeconds()),this.Lph(),0<this.Mua.count&&(Ba={},Ba.NonEmptyCellsCount=this.m$a,Ba.TextCellsCount=this.uBc,Ba.xlfpsJson=Object(Cb.a)(new tg,{f:this.Mua.toArray()}),Ba.memoryInfo=this.eEi(),Ba.zoom=Bb.a(this.$)?Bb.a(this.$).zoom:1,Ba.RibbonMode=le.a(this.$)?bf[le.a(this.$).zO]:Bc.invalid,Ba.deviceMemory=navigator.deviceMemory||0,Ba.hardwareConcurrency=navigator.hardwareConcurrency||0,Ba=JSON.stringify(Ba),e.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.QY.toString()}`),
!this.isSynthetic))){if(Y.a.aea()){var Ea={};Ea.xlfpsJson=Ba;this.$.Nna(Uc.a.w2j,Ea,!1)}else e.ULS.sendTraceTag(388781010,0,50,`${Ba}`);if(this.uzi)for(let rc of this.Mua){Ea=1E3>=this.m$a?"0_1000":3E3>=this.m$a?"1000_3000":"3000_inf";const wd=new Map;wd.set("Operation",rc.Op);wd.set("BucketOfRenderedCells",Ea);T.Health.instance.recordKpiUsage(Ie.a.longFrame,0,Be.a.canvas,wd);0<rc.longFrameCount&&T.Health.instance.recordKpiFailure(Ie.a.longFrame,"LongFrame",!1,!0,Object(Cb.a)(new H.a,{extendedProperties:wd}));
3E4<rc.tfAppInt&&(0<rc.longFrameCount?jc.b().mWf(0,this.cBi,wd):jc.b().nWf(0,wd))}e.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${Ba.length}`)}this.reset()}eEi(){const Ba={};if(window.performance){const Ea=window.performance.memory;Ea&&(Ba.jsHeapSizeLimit=Ea.jsHeapSizeLimit,Ba.usedJSHeapSize=Ea.usedJSHeapSize,Ba.totalJSHeapSize=Ea.totalJSHeapSize)}return Ba}reset(){this.Mua.clear();this.xia={};this.lNd()}Lph(){if(this.QY){for(const Ba of Tb.a(this.xia)){const Ea=this.xia[Ba];Ea.end=
Math.min(this.QY.length-1,Ea.end);this.Mua.add(Ea)}this.SYg(this.Mua,this.QY)}}SYg(Ba,Ea){for(let rc of Ba){let wd=Ba=0;if(rc.end<Ea.length){for(let Pd=rc.start;Pd<=rc.end;Pd++){const te=Ea[Pd];0<=te&&(rc.Max=Math.round(Math.max(rc.Max,te)),rc.Min=Math.round(Math.min(rc.Min,te)),Ba+=te,wd++)}0<wd&&(rc.Avg=Math.round(Ba/wd));this.$3a&&this.$3a.ljj(rc.Op,rc.Min,rc.Max,rc.LFrame?rc.LFrame.duration:-1);rc.Props&&(this.cSj(rc),rc.Props=null)}}this.$3a&&this.$3a.zXj()}lNd(){this.QY=[0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}yLe(Ba){Ba++;for(let Ea=0;Ea<Ba;Ea++)this.QY[Ea]=Bc.N7b}zLe(Ba){for(;60>Ba;Ba++)this.QY[Ba]=Bc.N7b}tzi(Ba,Ea){Ba=Ba.getSeconds();var rc=Tb.a(this.xia);if(0<rc.length)for(const wd of rc)if(rc=this.xia[wd],Ba>=rc.start&&Ba<rc.end)rc.LFrame?rc.LFrame.duration<Ea&&(rc.LFrame.startSecond=Ba,rc.LFrame.duration=Ea,rc.longFrameCount++):(rc.LFrame=new Gg(Ba,Ea),rc.longFrameCount++)}fXj(){this.uBc=this.m$a=
0;for(const Ba of Nb.h(this.$).Mn){const Ea=Ba.PCa;for(let rc in Ea){const wd=this.Ea.Dl(Ea[rc].hashCode);if(null===wd||void 0===wd?0:wd.Qk)this.m$a+=wd.ke.NonEmptyCellsCount,this.uBc+=wd.ke.TextValueCellsCount}}}cSj(Ba){const Ea=Ba.Props;if(yb.a.cNb in Ea&&Ea[yb.a.cNb]&&yb.a.ROb in Ea){let rc;(rc=Object(J.a)(je.a,Ea[yb.a.ROb]))&&rc.continueWith(wd=>{De.TextEditorTelemetry.instance.QGg(Ba.Op,Ba.Min,!!Ba.LFrame,Ba.LFrame?Ba.LFrame.duration:0,wd.result)})}}}Bc.N7b=-1;Bc.HEi=6E4;Bc.invalid="Invalid";
Object(b.a)(Bc,"FramePerformanceTracker",Ma.a,[519,2]);class Wc extends ic.a{constructor(Ba){super();this.$=Ba;this.Fb()}create(){let Ba=this.$.da.za(263);Ba||(Ba=this.$.da.Ga(263,new Bc(this.$)));this.ob(Ba)}static ka(Ba){Ba.da.Ga(264,new Wc(Ba))}}Object(b.a)(Wc,"FramePerformanceTrackerFactory",ic.a,[]);var fd=a(1283),Dd=a(937);class de{Pg(Ba,Ea){return new Dd.a(Ba,Ea)}Ac(Ba,Ea){Ba=this.Pg(Ba,Ea);Ba.start();return Ba}}Object(b.a)(de,"DefaultStopwatchBuilder",null,[148]);class ae{constructor(){this.sqa=
new de}Pg(Ba,Ea){return this.sqa.Pg(Ba,Ea)}Ac(Ba,Ea){return this.sqa.Ac(Ba,Ea)}}Object(b.a)(ae,"StopwatchBuilder",null,[148]);var nd=a(416),Ve=a(1030),$e=a(923),k;(function(Ba){Ba[Ba.actions=0]="actions";Ba[Ba.correlationStart=1]="correlationStart";Ba[Ba.reorderSheetOp=2]="reorderSheetOp";Ba[Ba.formatCellOp=3]="formatCellOp";Ba[Ba.copyOp=4]="copyOp";Ba[Ba.pasteOp=5]="pasteOp";Ba[Ba.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";Ba[Ba.instantaneousSetData=7]="instantaneousSetData";Ba[Ba.immediateSetData=
8]="immediateSetData";Ba[Ba.dependentCellsCalc=9]="dependentCellsCalc";Ba[Ba.dependentCellsGraphStat=10]="dependentCellsGraphStat";Ba[Ba.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";Ba[Ba.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";Ba[Ba.gridBlockUpdates=13]="gridBlockUpdates";Ba[Ba.browserAppStart=14]="browserAppStart";Ba[Ba.linkedObjects=15]="linkedObjects";Ba[Ba.longFrames=16]="longFrames";Ba[Ba.task=17]="task";Ba[Ba.conflictInEditing=18]="conflictInEditing";
Ba[Ba.incomingPresenceData=19]="incomingPresenceData";Ba[Ba.editorTableDelay=20]="editorTableDelay";Ba[Ba.presenceStartup=21]="presenceStartup";Ba[Ba.presenceDelete=22]="presenceDelete";Ba[Ba.editorEvent=23]="editorEvent";Ba[Ba.editorTime=24]="editorTime";Ba[Ba.gridScreenReaderOps=25]="gridScreenReaderOps";Ba[Ba.sendPresenceToService=26]="sendPresenceToService";Ba[Ba.IME=27]="IME";Ba[Ba.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";Ba[Ba.customizeStatusBar=29]="customizeStatusBar";Ba[Ba.clientWebRequests=
30]="clientWebRequests";Ba[Ba.showCommentTaskPane=31]="showCommentTaskPane";Ba[Ba.applyThreadedCommentChange=32]="applyThreadedCommentChange";Ba[Ba.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";Ba[Ba.findNextOrPreviousComment=34]="findNextOrPreviousComment";Ba[Ba.goto=35]="goto";Ba[Ba.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";Ba[Ba.richApiInvocation=37]="richApiInvocation";Ba[Ba.fxLibrary=38]="fxLibrary";Ba[Ba.embeddedApiSession=39]="embeddedApiSession";Ba[Ba.numberFormattingCalculator=
40]="numberFormattingCalculator";Ba[Ba.requestDataAfterSend=41]="requestDataAfterSend";Ba[Ba.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";Ba[Ba.copy=43]="copy";Ba[Ba.paste=44]="paste";Ba[Ba.dragDrop=45]="dragDrop";Ba[Ba.clearCopyState=46]="clearCopyState";Ba[Ba.webWorkerRecalcStats=47]="webWorkerRecalcStats";Ba[Ba.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";Ba[Ba.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";Ba[Ba.customSort=50]="customSort";
Ba[Ba.namedSheetViewUserAction=51]="namedSheetViewUserAction";Ba[Ba.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";Ba[Ba.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";Ba[Ba.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";Ba[Ba.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";Ba[Ba.namedSheetViewTempViewSaveDialog=56]="namedSheetViewTempViewSaveDialog";Ba[Ba.temporaryViewStartedDataRestore=57]="temporaryViewStartedDataRestore";
Ba[Ba.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";Ba[Ba.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";Ba[Ba.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(k||(k={}));Object(b.b)("UsageTable",k);var Qb=a(423),sc=a(475),Hc=a(598),kd=a(645),Bd=a(268);class Jd extends Sys.EventArgs{constructor(){super();this.$Gi=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(b.a)(Jd,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class $d{constructor(Ba,
Ea=1){this.GOd=Ea;this.total=Ba}get average(){return this.total/this.GOd}m4g(Ba){return new $d(this.total+Ba.total,this.GOd+Ba.GOd)}static $Vg(Ba,Ea){return`${Ba}_${Ea}`}}Object(b.a)($d,"StopwatchAverage",null,[]);var Aa;(function(Ba){Ba[Ba.longFrame=0]="longFrame";Ba[Ba.longGetRange=1]="longGetRange";Ba[Ba.longJsTask=2]="longJsTask";Ba[Ba.viewportCalculationLoops=3]="viewportCalculationLoops"})(Aa||(Aa={}));Object(b.b)("UtrKpiVeto",Aa);class Db{static v5a(Ba){return Enum.toString(Aa,Ba)}}Db.$Ua=
"UTR";Object(b.a)(Db,"KpiConstants",null,[]);class Zb{}Zb.xjg="UTRVetoName";Zb.pjg="UTRErrorName";Zb.JZj="UTROperationName";Zb.r1d="UTRDuration";Zb.KZj="UTREndedInPhase";Zb.ujg="UTRMessage";Zb.wjg="UtrUnavailabilityType";Zb.operationName="OperationName";Zb.duration="Duration";Zb.message="Message";Object(b.a)(Zb,"UtrAdditionalData",null,[]);class yc{}yc.x0j="VetoLike";yc.Nnh="E2EOperationPerf";yc.Pjj="RequestPerf";yc.YSj="UnavailabilityDurations";Object(b.a)(yc,"UtrTypes",null,[]);class Mc{nKb(Ba,
Ea,rc=null){Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(rc=rc?Object(Cb.a)(new H.a,{extendedProperties:rc}):null,Ba=Db.v5a(Ba),T.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+Ba,Ea,!1,!0,"",rc))}TLb(Ba,Ea,rc,wd,Pd,te){te[Db.$Ua]=yc.x0j;te[Zb.xjg]=Db.v5a(wd);te[Zb.pjg]=Pd;e.ULS.sendTraceTag(Ba,Ea,rc,Hd.a.hc(te));delete te[Db.$Ua];delete te[Zb.xjg];delete te[Zb.pjg]}}Object(b.a)(Mc,"UtrKpiVetoReporter",null,[]);class qd{rKb(Ba,Ea=null){Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
T.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+Db.v5a(Ba),0,"",Ea)}nKb(Ba,Ea,rc=null){Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ba=Db.v5a(Ba),T.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+Ba,Ea,!1,!0,this.I4c(rc)))}ajj(Ba,Ea=null){Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||T.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+Db.v5a(Ba),"",this.I4c(Ea))}$ij(Ba,Ea,rc=null){Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(Ba=Db.v5a(Ba),T.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+Ba,Ea,!1,!0,"",this.I4c(rc)))}I4c(Ba){return Ba?Object(Cb.a)(new H.a,{extendedProperties:Ba}):null}}Object(b.a)(qd,"UtrKpiVetoUsageReporter",null,[]);class Md{Yuc(Ba,Ea,rc=null){Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||T.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+Ba,"",Object(Cb.a)(new H.a,{extendedProperties:rc,durationMs:Ea}))}dvc(Ba,Ea,rc=null){Wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(Ea?T.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+Ba,"",Object(Cb.a)(new H.a,{extendedProperties:rc})):T.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+Ba,"",!1,!1,"",Object(Cb.a)(new H.a,{extendedProperties:rc})))}QLb(Ba,Ea,rc,wd,Pd,te,af,...Cf){af=String.format(af,...Cf);Cf={};Cf[Db.$Ua]=yc.Nnh;Cf[Zb.JZj]=wd;Cf[Zb.KZj]=Pd;Cf[Zb.r1d]=te;Cf[Zb.ujg]=af;e.ULS.sendTraceTag(Ba,Ea,rc,Hd.a.hc(Cf))}SLb(Ba,Ea,rc,wd,Pd,te){this.B4f(te,wd,Pd);e.ULS.sendTraceTag(Ba,Ea,rc,Hd.a.hc(te));
this.Pih(te)}RLb(Ba,Ea,rc,wd,Pd,te,...af){te=String.format(te,...af);af={};this.B4f(af,wd,Pd,te);e.ULS.sendTraceTag(Ba,Ea,rc,Hd.a.hc(af))}Zwc(Ba,Ea,rc,wd){wd[Db.$Ua]=yc.Pjj;e.ULS.sendTraceTag(Ba,Ea,rc,Hd.a.hc(wd));delete wd[Db.$Ua]}B4f(Ba,Ea,rc,wd=null){Ba[Db.$Ua]=yc.YSj;Ba[Zb.wjg]=Ea;Ba[Zb.r1d]=rc;wd&&(Ba[Zb.ujg]=wd)}Pih(Ba){delete Ba[Db.$Ua];delete Ba[Zb.wjg];delete Ba[Zb.r1d]}}Object(b.a)(Md,"UtrOperationPerfReporter",null,[]);class Td extends ye.a{constructor(Ba,Ea=null,rc=null,wd=null,Pd=null,
te=!1){super();this.DBh=[yb.a.oxe,yb.a.cQe,yb.a.dQe,yb.a.Yfc,yb.a.qlc,yb.a.Cpf,yb.a.renderCachedContent,yb.a.renderServerContent,yb.a.a6b,yb.a.woj,yb.a.b_f,yb.a.c_f,yb.a.Vrj];this.cmb=this.PDa=this.uQb=this.Fgb=this.Hde=this.wwe=this.RXa=this.Fke=null;this.MKf=this.mxe=!1;this.tjg=this.sjg=this.vjg=this.YMd=this.Lkg=null;this.SFf=(af,Cf)=>{for(af=0;af<Cf.entries.length;af++){const Wf=Cf.entries[af];Wf.url=y.a.removeParameter(Wf.url,h.AFrameworkApplication.JP);var Of=y.a.Eda(Wf.url);!Wa.EwaSettings.ma(485)&&
this.Fpi(Wf.url,Of)&&(Wf.behavior=1);if("img"===Wf.Yt.initiatorType&&Of.endsWith(Ve.a.qNe)){var Ef=y.a.VZ(Wf.url,Ve.a.pNe),ig=y.a.VZ(Wf.url,Ve.a.rNe);Wf.haa=`${Wf.haa}imageID=${Ef}, imgStateID=${ig}`}Ef=Wf.Yt.transferSize;let og;ig=Wf.Yt.decodedBodySize;void 0!==Ef&&null!==Ef&&void 0!==ig&&null!==ig?og=0===Ef&&0<ig:void 0!==Ef&&null!==Ef&&(og=0===Ef);ob.PageLoadTrackingInfo.instance.THg(Of,Math.round(Wf.Yt.fetchStart),Math.round(Wf.Yt.responseEnd),og,this.jri);Ca.a.contains(Of,yb.a.richTextEditor,
!0)&&(Of=De.TextEditorTelemetry.instance,Of.HE(yb.a.plj,Math.round(Wf.Yt.fetchStart)),Of.HE(yb.a.rlj,Math.round(Wf.Yt.responseEnd)))}};this.aW=()=>{const af=this.a8;for(let Cf in af)af[Cf].h=!0};this.userSessionId=Ba;this.z1a=Ea=Ea||new Hc.a;this.Oh=rc||Na.a.Qa;this.rKj=wd||this;this.De=Pd;this.jri=te;this.VJe=Ea.G9a();this.De&&this.De.BGa(this.aW)}get a8(){return this.Fke||(this.Fke={})}get aJe(){return this.Fgb||this.VJe}get kJe(){return this.PDa||Td.kwf}get JWd(){return this.wwe=this.wwe||{}}get mrc(){return this.RXa||
"undefined"===typeof Stw?this.RXa:this.RXa=Stw.swpc}get srf(){return this.Hde=this.Hde||{}}get CRa(){return this.cmb||(this.cmb=gb.a.instance.Ub("Common.NetworkTiming.IResourceTimingLogger"))}get rjg(){return this.sjg||(this.sjg=new Mc)}get Kgb(){return this.vjg||(this.vjg=new Md)}get jEc(){return this.tjg||(this.tjg=new qd)}mWd(Ba,Ea,rc){this.$Nb(Ba,Ea,rc,Na.a.WDb(Na.a.Qa.zb.getTime()))}$Nb(Ba,Ea,rc,wd,Pd=null){if(this.a8[rc])throw Error.invalidOperation("The specified stopwatchId is already in use.");
this.a8[rc]=this.wIe(Ba,Ea,rc,wd,Pd)}L9c(Ba){this.mub(Ba,Na.a.WDb(Na.a.Qa.zb.getTime()))}mub(Ba,Ea){const rc=this.a8[Ba];rc&&(this.yEe(rc,Ea),this.RUj(rc),delete this.a8[Ba])}ITf(Ba){delete this.a8[Ba]}q$f(Ba,Ea){this.Fgb||this.e$f(Ba,Ea)}$9f(){this.q$f(Td.Kjd,this.Oh.ve)}QOe(Ba,Ea=!1){if(this.Fgb){if(this.PDa===Td.YEd||this.PDa===Td.Kjd){const rc=z.a.instance;rc.userSessionId=this.userSessionId;if(this.PDa===Td.YEd){this.mxe||(this.Jla(Ba.m,Object(X.a)(rc,rc.H$i,"recordContentFetchEnd")),this.mxe=
!0);if(Ea){this.MKf||(this.Jla(Ba.m,Object(X.a)(rc,rc.V$i,"recordPerceivedContentDisplayed")),this.MKf=!0);return}this.Jla(Ba.m,Object(X.a)(rc,rc.G$i,"recordContentDisplayed"))}else this.PDa===Td.Kjd&&(Ea=this.a8[this.uQb])&&this.Jla(Bd.a(Ba,Ea.s),Object(X.a)(rc,rc.S$i,"recordInteractivityContentDisplayed"),!1)}this.mub(this.uQb,Ba);this.uQb=this.PDa=this.Fgb=null}}Jla(Ba,Ea,rc=!0){z.a.WP&&Object(nd.a)(kd.PerformanceClock,Na.a.Qa)&&rc&&(Ba+=window.performance.timing.navigationStart);Ea(Ba)}uj(Ba){return Qb.a(Ba)}Qe(Ba,
Ea,rc=!1){try{if(this.srf[k[Ba]]=!0,rc){var wd=e.ULS,Pd=wd.sendTraceTag;const Oc={};let Gf=null;switch(Ba){case 0:Gf="Actions";var te=Ea.a;null!=te&&(Oc.Id=te);var af=null==Ea.b?null:Ea.b;null!=af&&(Oc.Operation=af);var Cf=Ea.c;null!=Cf&&(Oc.Target=Cf);var Of=null==Ea.d?null:Ea.d.toString();null!=Of&&(Oc.StartTime=Of);var Ef=null==Ea.e?null:Ea.e.toString();null!=Ef&&(Oc.Duration=Ef);var ig=Ea.f;null!=ig&&(Oc.CorrelationId=ig);var Wf=Ea.g;null!=Wf&&(Oc.ParentAction=Wf);var og=null==Ea.h?null:Ea.h.toString();
null!=og&&(Oc.DocumentHidden=og);break;case 1:Gf="CorrelationStart";var Xf=Ea.a;null!=Xf&&(Oc.CorrelationId=Xf);var xg=Ea.b;null!=xg&&(Oc.UserSessionId=xg);var qg=Ea.c;null!=qg&&(Oc.UserAction=qg);break;case 2:Gf="ReorderSheetOp";var Yf=Ea.a;null!=Yf&&(Oc.UserSessionId=Yf);var dh=null==Ea.b?null:Ea.b.toString();null!=dh&&(Oc.IsDragReorder=dh);var Bf=null==Ea.c?null:Ea.c.toString();null!=Bf&&(Oc.DocumentUp=Bf);var Bg=null==Ea.d?null:Ea.d.toString();null!=Bg&&(Oc.OldIndex=Bg);var Hg=null==Ea.e?null:
Ea.e.toString();null!=Hg&&(Oc.NewIndex=Hg);var Ig=null==Ea.f?null:Ea.f.toString();null!=Ig&&(Oc.TotalSheets=Ig);break;case 3:Gf="FormatCellOp";var Jg=Ea.a;null!=Jg&&(Oc.UserSessionId=Jg);var Cg=null==Ea.b?null:Ea.b.toString();null!=Cg&&(Oc.TaskId=Cg);var xh=null==Ea.c?null:Ea.c.toString();null!=xh&&(Oc.NumberOfRanges=xh);var Yg=Ea.d;null!=Yg&&(Oc.Ranges=Yg);var Zg=Ea.e;null!=Zg&&(Oc.ActiveCell=Zg);var jh=null==Ea.f?null:Ea.f.toString();null!=jh&&(Oc.ActionId=jh);var eh=Ea.g;null!=eh&&(Oc.CommandParameters=
eh);var fh=Ea.h;null!=fh&&(Oc.UserActionStopwatchId=fh);break;case 4:Gf="CopyOp";var Kg=Ea.a;null!=Kg&&(Oc.UserSessionId=Kg);var $g=null==Ea.b?null:Ea.b.toString();null!=$g&&(Oc.IsChrome=$g);var nf=null==Ea.c?null:Ea.c.toString();null!=nf&&(Oc.IsIE=nf);var ma=null==Ea.d?null:Ea.d.toString();null!=ma&&(Oc.IsFromUI=ma);var vb=null==Ea.e?null:Ea.e.toString();null!=vb&&(Oc.IsCopyInLoadedRange=vb);var nc=null==Ea.f?null:Ea.f.toString();null!=nc&&(Oc.IsRepeatedCopy=nc);var Ec=null==Ea.g?null:Ea.g.toString();
null!=Ec&&(Oc.IsClipboarAccessSupported=Ec);var Ad=null==Ea.h?null:Ea.h.toString();null!=Ad&&(Oc.IsClipboarAccessInstallationSupported=Ad);var Ld=null==Ea.i?null:Ea.i.toString();null!=Ld&&(Oc.RibbonCommand=Ld);var ge=null==Ea.j?null:Ea.j.toString();null!=ge&&(Oc.CutCopyPasteFlags=ge);var ca=null==Ea.k?null:Ea.k.toString();null!=ca&&(Oc.IsDrag=ca);var kb=null==Ea.l?null:Ea.l.toString();null!=kb&&(Oc.IsIeBeforeAlowDenyPopUp=kb);var Mb=Ea.m;null!=Mb&&(Oc.IsPasteMatchCopy=Mb);var F=Ea.n;null!=F&&(Oc.WaitMessageInClipboard=
F);var ia=null==Ea.o?null:Ea.o.toString();null!=ia&&(Oc.CallCount=ia);break;case 5:Gf="PasteOp";var Qa=Ea.a;null!=Qa&&(Oc.UserSessionId=Qa);var Gb=null==Ea.b?null:Ea.b.toString();null!=Gb&&(Oc.IsChrome=Gb);var kc=null==Ea.c?null:Ea.c.toString();null!=kc&&(Oc.IsIE=kc);var gc=null==Ea.d?null:Ea.d.toString();null!=gc&&(Oc.IsCopyActive=gc);var fc=null==Ea.e?null:Ea.e.toString();null!=fc&&(Oc.IsFromUI=fc);var $c=null==Ea.f?null:Ea.f.toString();null!=$c&&(Oc.IsClipboarAccessSupported=$c);var hd=null==Ea.g?
null:Ea.g.toString();null!=hd&&(Oc.IsClipboarAccessInstallationSupported=hd);var jd=null==Ea.h?null:Ea.h.toString();null!=jd&&(Oc.RibbonCommand=jd);var Xd=null==Ea.i?null:Ea.i.toString();null!=Xd&&(Oc.CutCopyPasteFlags=Xd);var ee=Ea.j;null!=ee&&(Oc.WaitMessageInClipboard=ee);var re=Ea.k;null!=re&&(Oc.PopupDialog=re);var ze=Ea.l;null!=ze&&(Oc.SimplePopupMessage=ze);var Se=Ea.m;null!=Se&&(Oc.DialogCloseButton=Se);var df=Ea.n;null!=df&&(Oc.UserPressedInstallLink=df);var cf=null==Ea.o?null:Ea.o.toString();
null!=cf&&(Oc.CallCount=cf);break;case 6:Gf="GetNumberViewModelDataOp";var of=Ea.a;null!=of&&(Oc.UserSessionId=of);var tf=Ea.b;null!=tf&&(Oc.NumberFormatOptionsPreviousOutputJson=tf);var Df=Ea.c;null!=Df&&(Oc.NumberFormatOptionsNewInputJson=Df);break;case 7:Gf="InstantaneousSetData";var If=Ea.a;null!=If&&(Oc.Id=If);var vf=null==Ea.b?null:Ea.b.toString();null!=vf&&(Oc.WasEmpty=vf);var mf=null==Ea.c?null:Ea.c.toString();null!=mf&&(Oc.ValueNotChanged=mf);var sg=Ea.d;null!=sg&&(Oc.Source=sg);var ng=null==
Ea.e?null:Ea.e.toString();null!=ng&&(Oc.ProcessingCompleted=ng);break;case 8:Gf="ImmediateSetData";var wg=Ea.a;null!=wg&&(Oc.ClientStopwatchId=wg);var yh=Ea.b;null!=yh&&(Oc.Operation=yh);var Fh=Ea.c;null!=Fh&&(Oc.Parameters=Fh);var Vf=null==Ea.d?null:Ea.d.toString();null!=Vf&&(Oc.WasUpdatedByImmediate=Vf);var Lg=null==Ea.e?null:Ea.e.toString();null!=Lg&&(Oc.areHtmlElementsEqualClientComparison=Lg);var ug=null==Ea.f?null:Ea.f.toString();null!=ug&&(Oc.WasDecisionMadeByHtmlComparison=ug);var Rg=null==
Ea.g?null:Ea.g.toString();null!=Rg&&(Oc.IsNumeric=Rg);var Jh=null==Ea.h?null:Ea.h.toString();null!=Jh&&(Oc.IsDateTime=Jh);var Qi=null==Ea.i?null:Ea.i.toString();null!=Qi&&(Oc.HasCurrencySymbol=Qi);var Zh=null==Ea.j?null:Ea.j.toString();null!=Zh&&(Oc.HasPercentSymbol=Zh);var $h=null==Ea.k?null:Ea.k.toString();null!=$h&&(Oc.IsFunc=$h);var ai=null==Ea.l?null:Ea.l.toString();null!=ai&&(Oc.DiffInWrappingWhitespace=ai);var yg=Ea.m;null!=yg&&(Oc.ImmediatePattern=yg);var lh=null==Ea.n?null:Ea.n.toString();
null!=lh&&(Oc.TextAlignmentMatch=lh);var bi=null==Ea.o?null:Ea.o.toString();null!=bi&&(Oc.FontColorMatch=bi);var qi=null==Ea.p?null:Ea.p.toString();null!=qi&&(Oc.FormulaTextMatch=qi);var ri=null==Ea.q?null:Ea.q.toString();null!=ri&&(Oc.isFormula=ri);var Ri=Ea.r;null!=Ri&&(Oc.FormulaText=Ri);var Si=Ea.s;null!=Si&&(Oc.InstantaneousPattern=Si);var Ch=null==Ea.t?null:Ea.t.toString();null!=Ch&&(Oc.AreHtmlInnerTextElementsEqualClientComparison=Ch);var gh=Ea.u;null!=gh&&(Oc.HtmlComparisonDecision=gh);break;
case 9:Gf="DependentCellsCalc";var si=Ea.a;null!=si&&(Oc.CalcStatus=si);var Oh=null==Ea.b?null:Ea.b.toString();null!=Oh&&(Oc.SuccessfullyCalculatedRanges=Oh);var ph=null==Ea.c?null:Ea.c.toString();null!=ph&&(Oc.RangesSkipped=ph);var ci=null==Ea.d?null:Ea.d.toString();null!=ci&&(Oc.TotalErrors=ci);var qh=null==Ea.e?null:Ea.e.toString();null!=qh&&(Oc.Partial=qh);var Fi=null==Ea.f?null:Ea.f.toString();null!=Fi&&(Oc.Canceled=Fi);var di=null==Ea.g?null:Ea.g.toString();null!=di&&(Oc.Aggregate=di);var Xc=
null==Ea.h?null:Ea.h.toString();null!=Xc&&(Oc.Unknown=Xc);var Cd=null==Ea.i?null:Ea.i.toString();null!=Cd&&(Oc.UnavailableData=Cd);var Sg=null==Ea.j?null:Ea.j.toString();null!=Sg&&(Oc.Cycle=Sg);var Gi=null==Ea.k?null:Ea.k.toString();null!=Gi&&(Oc.NotImplemented=Gi);var ti=null==Ea.l?null:Ea.l.toString();null!=ti&&(Oc.InvalidInput=ti);var ei=null==Ea.m?null:Ea.m.toString();null!=ei&&(Oc.AreDepCells=ei);break;case 10:Gf="DependentCellsGraphStat";var Hi=null==Ea.a?null:Ea.a.toString();null!=Hi&&(Oc.ParsedFormulas=
Hi);var hh=null==Ea.b?null:Ea.b.toString();null!=hh&&(Oc.GraphNodes=hh);var pg=null==Ea.c?null:Ea.c.toString();null!=pg&&(Oc.GraphArcs=pg);var Ii=null==Ea.d?null:Ea.d.toString();null!=Ii&&(Oc.AnalyzedBlocks=Ii);var rh=null==Ea.e?null:Ea.e.toString();null!=rh&&(Oc.IterationId=rh);var fi=Ea.f;null!=fi&&(Oc.UniqueId=fi);var gi=null==Ea.g?null:Ea.g.toString();null!=gi&&(Oc.Aborted=gi);break;case 11:Gf="DependentCellsGraphSectionStat";var Ji=null==Ea.a?null:Ea.a.toString();null!=Ji&&(Oc.IterationId=Ji);
var Kh=Ea.b;null!=Kh&&(Oc.BlockHash=Kh);var hi=Ea.c;null!=hi&&(Oc.Functions=hi);var Lh=Ea.d;null!=Lh&&(Oc.Operators=Lh);var kg=null==Ea.e?null:Ea.e.toString();null!=kg&&(Oc.CrossDocRefs=kg);var vg=null==Ea.f?null:Ea.f.toString();null!=vg&&(Oc.CrossSheetRefs=vg);var ui=null==Ea.g?null:Ea.g.toString();null!=ui&&(Oc.ErrRefs=ui);var zh=null==Ea.h?null:Ea.h.toString();null!=zh&&(Oc.LargeRanges=zh);var Ki=null==Ea.i?null:Ea.i.toString();null!=Ki&&(Oc.NameRefs=Ki);var ii=null==Ea.j?null:Ea.j.toString();
null!=ii&&(Oc.ParserErrors=ii);var Ah=null==Ea.k?null:Ea.k.toString();null!=Ah&&(Oc.RowRefs=Ah);var ji=null==Ea.l?null:Ea.l.toString();null!=ji&&(Oc.ColumnRefs=ji);var jf=null==Ea.m?null:Ea.m.toString();null!=jf&&(Oc.TableRefs=jf);var Dh=Ea.n;null!=Dh&&(Oc.UniqueId=Dh);var Tg=null==Ea.o?null:Ea.o.toString();null!=Tg&&(Oc.UnreachableReferences=Tg);break;case 12:Gf="GetRangeContentPrefetchFailures";var zg=Ea.a;null!=zg&&(Oc.UserSessionId=zg);var Ag=Ea.b;null!=Ag&&(Oc.ClientStopwatchId=Ag);var Ph=null==
Ea.c?null:Ea.c.toString();null!=Ph&&(Oc.StateId=Ph);break;case 13:Gf="GridBlockUpdates";var Qh=Ea.a;null!=Qh&&(Oc.UserSessionId=Qh);var sh=Ea.b;null!=sh&&(Oc.CorrelationId=sh);var kh=Ea.c;null!=kh&&(Oc.Operation=kh);var Wg=null==Ea.d?null:Ea.d.toString();null!=Wg&&(Oc.PerformanceType=Wg);var ki=Ea.e;null!=ki&&(Oc.BlockHash=ki);var Rh=null==Ea.f?null:Ea.f.toString();null!=Rh&&(Oc.DurationInMs=Rh);break;case 14:Gf="BrowserAppStart";var Sh=null==Ea.a?null:$e.a.Dta(Ea.a.getTime());null!=Sh&&(Oc.ScriptExecutionStart=
Sh);var Ti=Ea.b;null!=Ti&&(Oc.UserSessionId=Ti);var Ui=Ea.c;null!=Ui&&(Oc.ClockMechanism=Ui);var Mg=null==Ea.d?null:Ea.d.toString();null!=Mg&&(Oc.ScreenDPI=Mg);var Li=null==Ea.e?null:Ea.e.toString();null!=Li&&(Oc.NavigationToScriptExecutionDelta=Li);break;case 15:Gf="LinkedObjects";var vi=Ea.a;null!=vi&&(Oc.ChildId=vi);var li=Ea.b;null!=li&&(Oc.ParentId=li);var wi=Ea.c;null!=wi&&(Oc.ChildTable=wi);var th=Ea.d;null!=th&&(Oc.ParentTable=th);break;case 16:Gf="LongFrames";var mi=null==Ea.a?null:$e.a.Dta(Ea.a.getTime());
null!=mi&&(Oc.StartTime=mi);var xi=null==Ea.b?null:Ea.b.toString();null!=xi&&(Oc.DurationInMs=xi);break;case 17:Gf="Task";var Dg=Ea.a;null!=Dg&&(Oc.StopwatchId=Dg);var Th=null==Ea.b?null:Ea.b.toString();null!=Th&&(Oc.Status=Th);var Ug=null==Ea.c?null:Ea.c.toString();null!=Ug&&(Oc.CreateTime=Ug);var Gh=null==Ea.d?null:Ea.d.toString();null!=Gh&&(Oc.TaskId=Gh);break;case 18:Gf="ConflictInEditing";var yi=Ea.a;null!=yi&&(Oc.OtherUserState=yi);var Eh=Ea.b;null!=Eh&&(Oc.UserSessionId=Eh);var lg=null==Ea.c?
null:$e.a.Dta(Ea.c.getTime());null!=lg&&(Oc.ConflictTime=lg);break;case 19:Gf="IncomingPresenceData";var Hh=Ea.a;null!=Hh&&(Oc.UserSessionId=Hh);var zi=Ea.b;null!=zi&&(Oc.UserId=zi);var Vi=null==Ea.c?null:Ea.c.toString();null!=Vi&&(Oc.Disconnected=Vi);var Tf=null==Ea.d?null:$e.a.Dta(Ea.d.getTime());null!=Tf&&(Oc.ReceivedTime=Tf);break;case 20:Gf="EditorTableDelay";var uh=Ea.a;null!=uh&&(Oc.UserSessionId=uh);var Wi=Ea.b;null!=Wi&&(Oc.UserId=Wi);var Uh=null==Ea.c?null:Ea.c.toString();null!=Uh&&(Oc.Received=
Uh);var mh=null==Ea.d?null:Ea.d.toString();null!=mh&&(Oc.DurationInMs=mh);var ah=null==Ea.e?null:Ea.e.toString();null!=ah&&(Oc.NotAloneAtLogTime=ah);var Ai=null==Ea.f?null:$e.a.Dta(Ea.f.getTime());null!=Ai&&(Oc.Time=Ai);break;case 21:Gf="PresenceStartup";var Mi=Ea.a;null!=Mi&&(Oc.UserSessionId=Mi);var bh=null==Ea.b?null:Ea.b.toString();null!=bh&&(Oc.EverReceived=bh);var ni=null==Ea.c?null:Ea.c.toString();null!=ni&&(Oc.NotAloneOnOpen=ni);var Ni=null==Ea.d?null:Ea.d.toString();null!=Ni&&(Oc.NotAloneAtLogTime=
Ni);var Vh=null==Ea.e?null:Ea.e.toString();null!=Vh&&(Oc.EditorCount=Vh);var Bi=null==Ea.f?null:Ea.f.toString();null!=Bi&&(Oc.WorkbookOpenToFirstReceivedInMs=Bi);break;case 22:Gf="PresenceDelete";var qf=Ea.a;null!=qf&&(Oc.UserSessionId=qf);var Ci=Ea.b;null!=Ci&&(Oc.UserId=Ci);var Oi=Ea.c;null!=Oi&&(Oc.Context=Oi);var nh=Ea.d;null!=nh&&(Oc.Reason=nh);var oi=null==Ea.e?null:$e.a.Dta(Ea.e.getTime());null!=oi&&(Oc.Time=oi);break;case 23:Gf="EditorEvent";var Wh=Ea.a;null!=Wh&&(Oc.UserSessionId=Wh);var eg=
Ea.b;null!=eg&&(Oc.UserId=eg);var Mh=Ea.c;null!=Mh&&(Oc.Context=Mh);var oh=null==Ea.d?null:$e.a.Dta(Ea.d.getTime());null!=oh&&(Oc.Time=oh);break;case 24:Gf="EditorTime";var Nh=Ea.a;null!=Nh&&(Oc.UserSessionId=Nh);var R=Ea.b;null!=R&&(Oc.UserId=R);var Ua=null==Ea.c?null:Ea.c.toString();null!=Ua&&(Oc.DurationInMs=Ua);break;case 25:Gf="GridScreenReaderOps";var pb=Ea.a;null!=pb&&(Oc.UserSessionId=pb);var Wb=Ea.b;null!=Wb&&(Oc.CommandTaskId=Wb);var pc=null==Ea.c?null:Ea.c.toString();null!=pc&&(Oc.CommandId=
pc);var Kc=null==Ea.d?null:Ea.d.toString();null!=Kc&&(Oc.ClientSideOnly=Kc);var Dc=null==Ea.e?null:Ea.e.toString();null!=Dc&&(Oc.DurationInMS=Dc);var Gc=null==Ea.f?null:Ea.f.toString();null!=Gc&&(Oc.ReachedMaxReadoutCells=Gc);var oc=null==Ea.g?null:Ea.g.toString();null!=oc&&(Oc.RequstedCellCount=oc);var Qc=null==Ea.h?null:Ea.h.toString();null!=Qc&&(Oc.NonEmptyCellCount=Qc);var ed=null==Ea.i?null:Ea.i.toString();null!=ed&&(Oc.Succeeded=ed);var Yc=null==Ea.j?null:Ea.j.toString();null!=Yc&&(Oc.Canceled=
Yc);var Kd=Ea.k;null!=Kd&&(Oc.ErrorType=Kd);break;case 26:Gf="SendPresenceToService";var Zd=Ea.a;null!=Zd&&(Oc.UserSessionId=Zd);var pe=null==Ea.b?null:Ea.b.toString();null!=pe&&(Oc.TotalCount=pe);var Pe=null==Ea.c?null:Ea.c.toString();null!=Pe&&(Oc.SendCount=Pe);break;case 27:Gf="IME";var ef=Ea.a;null!=ef&&(Oc.UserSessionId=ef);break;case 28:Gf="FreezePaneFloatingObjects";var wf=Ea.a;null!=wf&&(Oc.UserSessionId=wf);var Uf=null==Ea.b?null:Ea.b.toString();null!=Uf&&(Oc.ObjectType=Uf);var hf=Ea.c;null!=
hf&&(Oc.ObjectID=hf);var Af=null==Ea.d?null:Ea.d.toString();null!=Af&&(Oc.SpannedPanesCount=Af);break;case 29:Gf="CustomizeStatusBar";var kf=Ea.a;null!=kf&&(Oc.UserSessionId=kf);var ag=Ea.b;null!=ag&&(Oc.UIControlName=ag);var mg=null==Ea.c?null:Ea.c.toString();null!=mg&&(Oc.IsControlVisible=mg);break;case 30:Gf="ClientWebRequests";var Eg=Ea.a;null!=Eg&&(Oc.Path=Eg);var Fg=Ea.b;null!=Fg&&(Oc.ProxyStopwatchId=Fg);var Vg=Ea.c;null!=Vg&&(Oc.RequestStatus=Vg);var vh=null==Ea.d?null:Ea.d.toString();null!=
vh&&(Oc.ResponseSizeInBytes=vh);var rf=Ea.e;null!=rf&&(Oc.ClientRequestId=rf);var ff=null==Ea.f?null:Ea.f.toString();null!=ff&&(Oc.StateId=ff);break;case 31:Gf="ShowCommentTaskPane";var yf=Ea.a;null!=yf&&(Oc.UserSessionId=yf);var Pf=null==Ea.b?null:Ea.b.toString();null!=Pf&&(Oc.IsFromKeyboardShortcut=Pf);var Sf=null==Ea.c?null:Ea.c.toString();null!=Sf&&(Oc.IsShowPane=Sf);var Kf=null==Ea.d?null:Ea.d.toString();null!=Kf&&(Oc.ShowForDeepLink=Kf);var Nf=null==Ea.e?null:Ea.e.toString();null!=Nf&&(Oc.DeepLinkFound=
Nf);break;case 32:Gf="ApplyThreadedCommentChange";var Qf=Ea.a;null!=Qf&&(Oc.UserSessionId=Qf);var Rf=null==Ea.b?null:Ea.b.toString();null!=Rf&&(Oc.Operation=Rf);var gg=Ea.c;null!=gg&&(Oc.CommentId=gg);var Xg=null==Ea.d?null:Ea.d.toString();null!=Xg&&(Oc.CommentsCount=Xg);break;case 33:Gf="UpgradeLegacyCommentsChange";var Ff=Ea.a;null!=Ff&&(Oc.UserSessionId=Ff);var pi=null==Ea.b?null:Ea.b.toString();null!=pi&&(Oc.OperationSuccessful=pi);break;case 34:Gf="FindNextOrPreviousComment";var Di=Ea.a;null!=
Di&&(Oc.UserSessionId=Di);var Pi=null==Ea.b?null:Ea.b.toString();null!=Pi&&(Oc.Succeeded=Pi);break;case 35:Gf="Goto";var Ei=Ea.a;null!=Ei&&(Oc.UserSessionId=Ei);var dg=null==Ea.b?null:Ea.b.toString();null!=dg&&(Oc.IsSucceeded=dg);var Og=null==Ea.c?null:Ea.c.toString();null!=Og&&(Oc.IsNOVMode=Og);break;case 36:Gf="LaunchOfficeAddInDialog";var ch=Ea.a;null!=ch&&(Oc.UserSessionId=ch);var Zf=Ea.b;null!=Zf&&(Oc.SourceId=Zf);var hg=Ea.c;null!=hg&&(Oc.SourceLabel=hg);var ih=Ea.d;null!=ih&&(Oc.Flight=ih);
var wh=Ea.e;null!=wh&&(Oc.Experiment=wh);var Bh=Ea.f;null!=Bh&&(Oc.UICultureTag=Bh);var Xh=null==Ea.g?null:Ea.g.toString();null!=Xh&&(Oc.UICultureTagLcid=Xh);var $i=null==Ea.h?null:Ea.h.toString();null!=$i&&(Oc.WacHostId=$i);break;case 37:Gf="RichApiInvocation";var aj=Ea.a;null!=aj&&(Oc.UserSessionId=aj);var bj=null==Ea.b?null:Ea.b.toString();null!=bj&&(Oc.Succeeded=bj);var cj=Ea.c;null!=cj&&(Oc.ErrorType=cj);var dj=Ea.d;null!=dj&&(Oc.ResultInfo=dj);var jj=Ea.e;null!=jj&&(Oc.Source=jj);break;case 38:Gf=
"FxLibrary";var kj=Ea.a;null!=kj&&(Oc.EntityName=kj);var Xi=null==Ea.b?null:Ea.b.toString();null!=Xi&&(Oc.EntryPoint=Xi);var ej=null==Ea.c?null:Ea.c.toString();null!=ej&&(Oc.Action=ej);var fj=null==Ea.d?null:Ea.d.toString();null!=fj&&(Oc.InsertLocation=fj);break;case 39:Gf="EmbeddedApiSession";var gj=Ea.a;null!=gj&&(Oc.UserSessionId=gj);break;case 40:Gf="NumberFormattingCalculator";var hj=Ea.a;null!=hj&&(Oc.Id=hj);var lj=Ea.b;null!=lj&&(Oc.CounterName=lj);var ij=Ea.c;null!=ij&&(Oc.Values=ij);break;
case 41:Gf="RequestDataAfterSend";var mj=Ea.a;null!=mj&&(Oc.ClientStopwatchId=mj);var Yi=Ea.b;null!=Yi&&(Oc.RequestStatus=Yi);var nj=null==Ea.c?null:Ea.c.toString();null!=nj&&(Oc.SendDuration=nj);var oj=null==Ea.d?null:Ea.d.toString();null!=oj&&(Oc.RequestId=oj);break;case 42:Gf="FloatingObjectsStopwatchData";var pj=Ea.a;null!=pj&&(Oc.StopMessage=pj);var qj=null==Ea.b?null:Ea.b.toString();null!=qj&&(Oc.Type=qj);var rj=Ea.c;null!=rj&&(Oc.GUID=rj);var sj=null==Ea.d?null:Ea.d.toString();null!=sj&&(Oc.Pane=
sj);var tj=null==Ea.e?null:Ea.e.toString();null!=tj&&(Oc.IsAboveGrid=tj);var xf=Ea.f;null!=xf&&(Oc.StartCorrelation=xf);var Zi=Ea.g;null!=Zi&&(Oc.LoadImageCorrelation=Zi);var P=null==Ea.h?null:Ea.h.toString();null!=P&&(Oc.SkippedGetEffectsExtents=P);var Ta=null==Ea.i?null:Ea.i.toString();null!=Ta&&(Oc.Version=Ta);break;case 43:Gf="Copy";var Hb=Ea.a;null!=Hb&&(Oc.UserSessionId=Hb);var lc=Ea.b;null!=lc&&(Oc.Trigger=lc);var xc=Ea.c;null!=xc&&(Oc.RibbonCommandName=xc);var cd=Ea.d;null!=cd&&(Oc.SourceItem=
cd);var id=null==Ea.e?null:Ea.e.toString();null!=id&&(Oc.SourceRangeCellCount=id);var od=Ea.f;null!=od&&(Oc.ClientSideStopwatchId=od);var Fd=Ea.g;null!=Fd&&(Oc.CopyOperationId=Fd);var Rd=null==Ea.h?null:Ea.h.toString();null!=Rd&&(Oc.IsAsync=Rd);var Re=null==Ea.i?null:Ea.i.toString();null!=Re&&(Oc.IsFromCache=Re);var We=null==Ea.j?null:Ea.j.toString();null!=We&&(Oc.IsSuccessiveCopy=We);var lf=null==Ea.k?null:Ea.k.toString();null!=lf&&(Oc.IsSelectionAllowed=lf);var rg=null==Ea.l?null:Ea.l.toString();
null!=rg&&(Oc.IsSuccess=rg);var fg=null==Ea.m?null:Ea.m.toString();null!=fg&&(Oc.IsExpectedError=fg);var $f=Ea.n;null!=$f&&(Oc.ExpectedErrorReason=$f);var bg=Ea.o;null!=bg&&(Oc.ErrorMessage=bg);var jg=null==Ea.p?null:Ea.p.toString();null!=jg&&(Oc.ClientSideCopyTimeInMs=jg);var Pg=null==Ea.q?null:Ea.q.toString();null!=Pg&&(Oc.TotalTimeInMs=Pg);var Ng=null==Ea.r?null:Ea.r.toString();null!=Ng&&(Oc.PlainTextPayloadSize=Ng);var Qg=Ea.s;null!=Qg&&(Oc.CopyPasteTargetType=Qg);var Ih=null==Ea.t?null:Ea.t.toString();
null!=Ih&&(Oc.ShadowWorkbookPayloadSize=Ih);var Yh=null==Ea.u?null:Ea.u.toString();null!=Yh&&(Oc.HtmlPayloadSize=Yh);var kk=null==Ea.v?null:Ea.v.toString();null!=kk&&(Oc.HtmlSizeExceedsLimit=kk);var lk=null==Ea.w?null:Ea.w.toString();null!=lk&&(Oc.CopyTotalSizeExceedsLimit=lk);var mk=null==Ea.x?null:Ea.x.toString();null!=mk&&(Oc.ErrorReason=mk);var nk=Ea.y;null!=nk&&(Oc.ErrorName=nk);var ok=null==Ea.z?null:Ea.z.toString();null!=ok&&(Oc.IsSucceededWithAlert=ok);var pk=null==Ea.ba?null:Ea.ba.toString();
null!=pk&&(Oc.EncounteredDeploymentErrors=pk);var qk=null==Ea.bb?null:Ea.bb.toString();null!=qk&&(Oc.ShadowWorkbookSizeExceedsLimit=qk);var rk=Ea.bc;null!=rk&&(Oc.CopyPasteTargetName=rk);var sk=Ea.bd;null!=sk&&(Oc.CCPSliceName=sk);var tk=Ea.be;null!=tk&&(Oc.SyncClipboardItemsKeys=tk);var uk=Ea.bf;null!=uk&&(Oc.AsyncClipboardItemsKeys=uk);var vk=Ea.bg;null!=vk&&(Oc.CopyPasteHandlerName=vk);var wk=Ea.bh;null!=wk&&(Oc.SucceededPopulatingSystemClipboardSync=wk);var xk=Ea.bi;null!=xk&&(Oc.SucceededPopulatingSystemClipboardAsync=
xk);var yk=Ea.bj;null!=yk&&(Oc.Location=yk);var zk=Ea.bk;null!=zk&&(Oc.CopyContextId=zk);var Ak=null==Ea.bl?null:Ea.bl.toString();null!=Ak&&(Oc.ServerRequestTimeInMs=Ak);var Bk=null==Ea.bm?null:Ea.bm.toString();null!=Bk&&(Oc.EcsOperationDuration=Bk);var Ck=null==Ea.bn?null:Ea.bn.toString();null!=Ck&&(Oc.EcsRequestDuration=Ck);var Dk=null==Ea.bo?null:Ea.bo.toString();null!=Dk&&(Oc.WfeRequestDuration=Dk);var Ek=null==Ea.bp?null:Ea.bp.toString();null!=Ek&&(Oc.OriginalSourceRangesCountExceedsLimit=Ek);
var Fk=null==Ea.bq?null:Ea.bq.toString();null!=Fk&&(Oc.UploadToClipServiceAttempted=Fk);var Gk=null==Ea.br?null:Ea.br.toString();null!=Gk&&(Oc.FloatingObjectType=Gk);break;case 44:Gf="Paste";var Hk=Ea.a;null!=Hk&&(Oc.UserSessionId=Hk);var Ik=Ea.b;null!=Ik&&(Oc.Trigger=Ik);var Jk=Ea.c;null!=Jk&&(Oc.RibbonCommandName=Jk);var Kk=null==Ea.d?null:Ea.d.toString();null!=Kk&&(Oc.PasteTypeFlagValue=Kk);var Lk=Ea.e;null!=Lk&&(Oc.PasteOperationId=Lk);var Mk=Ea.f;null!=Mk&&(Oc.CopyOperationId=Mk);var Nk=Ea.g;
null!=Nk&&(Oc.ClientSideStopwatchId=Nk);var Ok=Ea.h;null!=Ok&&(Oc.OriginalDestinationRange=Ok);var Pk=Ea.i;null!=Pk&&(Oc.ExpandDestinationRange=Pk);var Qk=Ea.j;null!=Qk&&(Oc.SourceItem=Qk);var Rk=null==Ea.k?null:Ea.k.toString();null!=Rk&&(Oc.SourceRangeCellCount=Rk);var Sk=null==Ea.l?null:Ea.l.toString();null!=Sk&&(Oc.IsSuccess=Sk);var Tk=null==Ea.m?null:Ea.m.toString();null!=Tk&&(Oc.IsExpectedError=Tk);var Uk=Ea.n;null!=Uk&&(Oc.ClipboardFormatReadTimeInMs=Uk);var Vk=Ea.o;null!=Vk&&(Oc.ClipboardFormatReadStatus=
Vk);var Wk=null==Ea.p?null:Ea.p.toString();null!=Wk&&(Oc.ClipboardReadPermissionPromptShown=Wk);var Xk=null==Ea.q?null:Ea.q.toString();null!=Xk&&(Oc.AsyncApiReadTimedOut=Xk);var Yk=Ea.r;null!=Yk&&(Oc.ExpectedErrorReason=Yk);var Zk=Ea.s;null!=Zk&&(Oc.ErrorMessage=Zk);var $k=null==Ea.t?null:Ea.t.toString();null!=$k&&(Oc.TotalTimeInMs=$k);var al=null==Ea.u?null:Ea.u.toString();null!=al&&(Oc.PlainTextPayloadSize=al);var bl=null==Ea.v?null:Ea.v.toString();null!=bl&&(Oc.ShadowWorkbookPayloadSize=bl);var cl=
null==Ea.w?null:Ea.w.toString();null!=cl&&(Oc.HtmlPayloadSize=cl);var dl=Ea.x;null!=dl&&(Oc.CopyPasteTargetType=dl);var el=null==Ea.y?null:Ea.y.toString();null!=el&&(Oc.IsLastCopyWasExternal=el);var fl=null==Ea.z?null:Ea.z.toString();null!=fl&&(Oc.IsClipboardDataContainShadowWorkbook=fl);var gl=null==Ea.ba?null:Ea.ba.toString();null!=gl&&(Oc.IsShadowWorkbookParsedSuccessfully=gl);var hl=Ea.bb;null!=hl&&(Oc.ActiveSelectionType=hl);var il=Ea.bc;null!=il&&(Oc.PasteResult=il);var jl=null==Ea.bd?null:
Ea.bd.toString();null!=jl&&(Oc.ErrorReason=jl);var kl=Ea.be;null!=kl&&(Oc.ErrorName=kl);var ll=null==Ea.bf?null:Ea.bf.toString();null!=ll&&(Oc.IsSucceededWithAlert=ll);var ml=null==Ea.bg?null:Ea.bg.toString();null!=ml&&(Oc.IsAfterCut=ml);var nl=null==Ea.bh?null:Ea.bh.toString();null!=nl&&(Oc.EncounteredDeploymentErrors=nl);var ol=null==Ea.bi?null:Ea.bi.toString();null!=ol&&(Oc.IsCrossSession=ol);var pl=null==Ea.bj?null:Ea.bj.toString();null!=pl&&(Oc.ShadowWorkbookSizeExceedsLimit=pl);var Qj=null==
Ea.bk?null:Ea.bk.toString();null!=Qj&&(Oc.ClipboardContainXLOPayload=Qj);var ql=Ea.bl;null!=ql&&(Oc.CopyPasteTargetName=ql);var rl=Ea.bm;null!=rl&&(Oc.ChromeExtensionId=rl);var sl=Ea.bn;null!=sl&&(Oc.PayloadOrigin=sl);var tl=Ea.bo;null!=tl&&(Oc.PayloadType=tl);var ul=Ea.bp;null!=ul&&(Oc.CCPSliceName=ul);var vl=Ea.bq;null!=vl&&(Oc.ClipboardItemsKeys=vl);var wl=Ea.br;null!=wl&&(Oc.CopyPasteHandlerName=wl);var xl=null==Ea.bs?null:Ea.bs.toString();null!=xl&&(Oc.IsSourceItemOriginSameSession=xl);var yl=
Ea.bt;null!=yl&&(Oc.Location=yl);var zl=Ea.bu;null!=zl&&(Oc.ExternalAppSource=zl);var Al=Ea.bv;null!=Al&&(Oc.PasteContextId=Al);var sm=null==Ea.bw?null:Ea.bw.toString();null!=sm&&(Oc.ServerRequestTimeInMs=sm);var uj=null==Ea.bx?null:Ea.bx.toString();null!=uj&&(Oc.IndicationDisplayScheduled=uj);var vj=Ea.by;null!=vj&&(Oc.PasteIndicationDisplayStatus=vj);var wj=null==Ea.bz?null:Ea.bz.toString();null!=wj&&(Oc.PasteRecoveryUIDisplayed=wj);var xj=null==Ea.ca?null:Ea.ca.toString();null!=xj&&(Oc.IsFromPasteRecoveryUI=
xj);var yj=null==Ea.cb?null:Ea.cb.toString();null!=yj&&(Oc.EcsOperationDuration=yj);var zj=null==Ea.cc?null:Ea.cc.toString();null!=zj&&(Oc.EcsRequestDuration=zj);var Aj=null==Ea.cd?null:Ea.cd.toString();null!=Aj&&(Oc.WfeRequestDuration=Aj);var Bl=null==Ea.ce?null:Ea.ce.toString();null!=Bl&&(Oc.OriginalSourceRangesCountExceedsLimit=Bl);var Cl=Ea.cf;null!=Cl&&(Oc.PasteRecoveryUndoStopwatchId=Cl);var Rj=null==Ea.cg?null:Ea.cg.toString();null!=Rj&&(Oc.PasteRecoveryUndoTimeInMs=Rj);var Sj=null==Ea.ch?
null:Ea.ch.toString();null!=Sj&&(Oc.PasteCSEPerformed=Sj);var Tj=null==Ea.ci?null:Ea.ci.toString();null!=Tj&&(Oc.CSEStatus=Tj);var Uj=null==Ea.cj?null:Ea.cj.toString();null!=Uj&&(Oc.IsFromEnterShortcut=Uj);var Dl=null==Ea.ck?null:Ea.ck.toString();null!=Dl&&(Oc.pasteDestinationHasMergedCells=Dl);break;case 45:Gf="DragDrop";var Bj=Ea.a;null!=Bj&&(Oc.UserSessionId=Bj);var Cj=Ea.b;null!=Cj&&(Oc.Trigger=Cj);var Dj=Ea.c;null!=Dj&&(Oc.RibbonCommandName=Dj);var Ej=Ea.d;null!=Ej&&(Oc.OperationId=Ej);var Fj=
Ea.e;null!=Fj&&(Oc.ClientSideStopwatchId=Fj);var Gj=Ea.f;null!=Gj&&(Oc.SourceRange=Gj);var Hj=Ea.g;null!=Hj&&(Oc.DestinationRange=Hj);var Ij=Ea.h;null!=Ij&&(Oc.CutCopyType=Ij);var Jj=null==Ea.i?null:Ea.i.toString();null!=Jj&&(Oc.IsShiftKeyDown=Jj);var Kj=null==Ea.j?null:Ea.j.toString();null!=Kj&&(Oc.IsDragInsert=Kj);var Lj=null==Ea.k?null:Ea.k.toString();null!=Lj&&(Oc.IsSuccess=Lj);var Mj=null==Ea.l?null:Ea.l.toString();null!=Mj&&(Oc.IsExpectedError=Mj);var Nj=Ea.m;null!=Nj&&(Oc.ExpectedErrorReason=
Nj);var Oj=Ea.n;null!=Oj&&(Oc.ErrorMessage=Oj);var Pj=null==Ea.o?null:Ea.o.toString();null!=Pj&&(Oc.TotalTimeInMs=Pj);var El=Ea.p;null!=El&&(Oc.ErrorName=El);var Fl=null==Ea.q?null:Ea.q.toString();null!=Fl&&(Oc.IsSucceededWithAlert=Fl);var Gl=Ea.r;null!=Gl&&(Oc.CopyPasteTargetType=Gl);var Hl=null==Ea.s?null:Ea.s.toString();null!=Hl&&(Oc.EncounteredDeploymentErrors=Hl);break;case 46:Gf="ClearCopyState";var Il=Ea.a;null!=Il&&(Oc.UserSessionId=Il);var Jl=Ea.b;null!=Jl&&(Oc.ClientSideStopwatchId=Jl);
var Kl=Ea.c;null!=Kl&&(Oc.Trigger=Kl);var Ll=null==Ea.d?null:Ea.d.toString();null!=Ll&&(Oc.IsClearClipboard=Ll);var Ml=null==Ea.e?null:Ea.e.toString();null!=Ml&&(Oc.IsExplicit=Ml);var Nl=null==Ea.f?null:Ea.f.toString();null!=Nl&&(Oc.IsSuccess=Nl);var Ol=Ea.g;null!=Ol&&(Oc.ErrorMessage=Ol);var Pl=Ea.h;null!=Pl&&(Oc.ErrorName=Pl);var Ql=null==Ea.i?null:Ea.i.toString();null!=Ql&&(Oc.TotalTimeInMs=Ql);var Rl=Ea.j;null!=Rl&&(Oc.CopyPasteTargetType=Rl);break;case 47:Gf="WebWorkerRecalcStats";var Sl=null==
Ea.a?null:Ea.a.toString();null!=Sl&&(Oc.SuccessCount=Sl);var Tl=null==Ea.b?null:Ea.b.toString();null!=Tl&&(Oc.FailureCount=Tl);var Ul=null==Ea.c?null:Ea.c.toString();null!=Ul&&(Oc.ValueTypeMismatchCount=Ul);var Vl=null==Ea.d?null:Ea.d.toString();null!=Vl&&(Oc.CellValueMismatchCount=Vl);var Wl=null==Ea.e?null:Ea.e.toString();null!=Wl&&(Oc.IfmtMismatchCount=Wl);var Xl=null==Ea.f?null:Ea.f.toString();null!=Xl&&(Oc.FormattedTextMismatchCount=Xl);var Yl=null==Ea.g?null:Ea.g.toString();null!=Yl&&(Oc.CellValueStringMismatchCount=
Yl);var Zl=null==Ea.h?null:Ea.h.toString();null!=Zl&&(Oc.CellValueNumberMismatchCount=Zl);var $l=null==Ea.i?null:Ea.i.toString();null!=$l&&(Oc.CellValueBooleanMismatchCount=$l);var am=null==Ea.j?null:Ea.j.toString();null!=am&&(Oc.CellValueBlankMismatchCount=am);var bm=null==Ea.k?null:Ea.k.toString();null!=bm&&(Oc.CellValueErrorMismatchCount=bm);var cm=null==Ea.l?null:Ea.l.toString();null!=cm&&(Oc.FormattedTextStringMismatchCount=cm);var dm=null==Ea.m?null:Ea.m.toString();null!=dm&&(Oc.FormattedTextNumberMismatchCount=
dm);var em=null==Ea.n?null:Ea.n.toString();null!=em&&(Oc.FormattedTextBooleanMismatchCount=em);var fm=null==Ea.o?null:Ea.o.toString();null!=fm&&(Oc.FormattedTextBlankMismatchCount=fm);var gm=null==Ea.p?null:Ea.p.toString();null!=gm&&(Oc.FormattedTextErrorMismatchCount=gm);var hm=null==Ea.q?null:Ea.q.toString();null!=hm&&(Oc.StringMismatchCount=hm);var im=null==Ea.r?null:Ea.r.toString();null!=im&&(Oc.NumericMismatchCount=im);var jm=null==Ea.s?null:Ea.s.toString();null!=jm&&(Oc.ErrorMismatchCount=jm);
var km=null==Ea.t?null:Ea.t.toString();null!=km&&(Oc.StringValuesCount=km);var lm=null==Ea.u?null:Ea.u.toString();null!=lm&&(Oc.NumericValuesCount=lm);var mm=null==Ea.v?null:Ea.v.toString();null!=mm&&(Oc.BooleanValuesCount=mm);var nm=null==Ea.w?null:Ea.w.toString();null!=nm&&(Oc.BlankValuesCount=nm);var om=null==Ea.x?null:Ea.x.toString();null!=om&&(Oc.ErrorValuesCount=om);var pm=null==Ea.y?null:Ea.y.toString();null!=pm&&(Oc.NumericValuesDiffAverage=pm);var qm=Ea.z;null!=qm&&(Oc.NumericEvaluatedValuesMismatchSamples=
qm);var Vj=Ea.ba;null!=Vj&&(Oc.NumericFormattedTextMismatchSamples=Vj);var Wj=Ea.bb;null!=Wj&&(Oc.NumericMismatchSamples=Wj);var Xj=Ea.bc;null!=Xj&&(Oc.CellValueTypeMismatchSamples=Xj);var Yj=Ea.bd;null!=Yj&&(Oc.IfmtMismatchSamples=Yj);var Zj=Ea.be;null!=Zj&&(Oc.BlockHashCode=Zj);break;case 48:Gf="DataValidationEditOpenDialog";var ak=Ea.a;null!=ak&&(Oc.ServerCommand=ak);var tm=null==Ea.b?null:Ea.b.toString();null!=tm&&(Oc.SubDialogOpened=tm);var rm=Ea.c;null!=rm&&(Oc.SubDialogButtonClicked=rm);var bk=
null==Ea.d?null:Ea.d.toString();null!=bk&&(Oc.DialogOpened=bk);var ck=Ea.e;null!=ck&&(Oc.RuleType=ck);var dk=Ea.f;null!=dk&&(Oc.ConditionType=dk);var ek=null==Ea.g?null:Ea.g.toString();null!=ek&&(Oc.LowerBoundaryFilled=ek);var fk=null==Ea.h?null:Ea.h.toString();null!=fk&&(Oc.UpperBoundaryFilled=fk);var gk=null==Ea.i?null:Ea.i.toString();null!=gk&&(Oc.IgnoreBlank=gk);var hk=null==Ea.j?null:Ea.j.toString();null!=hk&&(Oc.InCellDropdown=hk);var ik=null==Ea.k?null:Ea.k.toString();null!=ik&&(Oc.ShowInputMessage=
ik);var jk=null==Ea.l?null:Ea.l.toString();null!=jk&&(Oc.InputTitleFilled=jk);var zm=null==Ea.m?null:Ea.m.toString();null!=zm&&(Oc.InputMessageFilled=zm);var Am=null==Ea.n?null:Ea.n.toString();null!=Am&&(Oc.ShowErrorAlert=Am);var Bm=null==Ea.o?null:Ea.o.toString();null!=Bm&&(Oc.AlertBlocking=Bm);var Cm=null==Ea.p?null:Ea.p.toString();null!=Cm&&(Oc.AlertTitleFilled=Cm);var Dm=null==Ea.q?null:Ea.q.toString();null!=Dm&&(Oc.AlertMessageFilled=Dm);var Em=Ea.r;null!=Em&&(Oc.StopWatchId=Em);break;case 49:Gf=
"DataValidationEditSubmitRule";var Fm=Ea.a;null!=Fm&&(Oc.RuleType=Fm);var Gm=Ea.b;null!=Gm&&(Oc.ConditionType=Gm);var Hm=null==Ea.c?null:Ea.c.toString();null!=Hm&&(Oc.LowerBoundaryFilled=Hm);var Im=null==Ea.d?null:Ea.d.toString();null!=Im&&(Oc.UpperBoundaryFilled=Im);var Jm=null==Ea.e?null:Ea.e.toString();null!=Jm&&(Oc.IgnoreBlank=Jm);var Km=null==Ea.f?null:Ea.f.toString();null!=Km&&(Oc.InCellDropdown=Km);var Lm=null==Ea.g?null:Ea.g.toString();null!=Lm&&(Oc.ShowInputMessage=Lm);var Mm=null==Ea.h?
null:Ea.h.toString();null!=Mm&&(Oc.InputTitleFilled=Mm);var Nm=null==Ea.i?null:Ea.i.toString();null!=Nm&&(Oc.InputMessageFilled=Nm);var Om=null==Ea.j?null:Ea.j.toString();null!=Om&&(Oc.ShowErrorAlert=Om);var Pm=null==Ea.k?null:Ea.k.toString();null!=Pm&&(Oc.AlertBlocking=Pm);var Qm=null==Ea.l?null:Ea.l.toString();null!=Qm&&(Oc.AlertTitleFilled=Qm);var Rm=null==Ea.m?null:Ea.m.toString();null!=Rm&&(Oc.AlertMessageFilled=Rm);var Sm=null==Ea.n?null:Ea.n.toString();null!=Sm&&(Oc.ClearAllPressed=Sm);var Tm=
Ea.o;null!=Tm&&(Oc.ActionStatus=Tm);var Um=Ea.p;null!=Um&&(Oc.Error=Um);var Vm=Ea.q;null!=Vm&&(Oc.StopWatchId=Vm);break;case 50:Gf="CustomSort";var Wm=Ea.a;null!=Wm&&(Oc.RangeType=Wm);var Xm=null==Ea.b?null:Ea.b.toString();null!=Xm&&(Oc.HasHeaders=Xm);var Ym=null==Ea.c?null:Ea.c.toString();null!=Ym&&(Oc.SortTopToBottom=Ym);var Zm=null==Ea.d?null:Ea.d.toString();null!=Zm&&(Oc.ColumnCount=Zm);var $m=null==Ea.e?null:Ea.e.toString();null!=$m&&(Oc.RowCount=$m);var an=null==Ea.f?null:Ea.f.toString();null!=
an&&(Oc.RangeLimitExceeded=an);var bn=null==Ea.g?null:Ea.g.toString();null!=bn&&(Oc.CaseSensitive=bn);var cn=null==Ea.h?null:Ea.h.toString();null!=cn&&(Oc.GetSortInfoDuration=cn);var dn=null==Ea.i?null:Ea.i.toString();null!=dn&&(Oc.LevelCount=dn);var en=null==Ea.j?null:Ea.j.toString();null!=en&&(Oc.SortOnValuesCount=en);var fn=null==Ea.k?null:Ea.k.toString();null!=fn&&(Oc.SortOnCellColorCount=fn);var gn=null==Ea.l?null:Ea.l.toString();null!=gn&&(Oc.SortOnFontColorCount=gn);var hn=null==Ea.m?null:
Ea.m.toString();null!=hn&&(Oc.SortOnIconCount=hn);var jn=null==Ea.n?null:Ea.n.toString();null!=jn&&(Oc.CustomOrderCount=jn);var kn=null==Ea.o?null:Ea.o.toString();null!=kn&&(Oc.AvgCellColorCount=kn);var ln=null==Ea.p?null:Ea.p.toString();null!=ln&&(Oc.MaxCellColorCount=ln);var mn=null==Ea.q?null:Ea.q.toString();null!=mn&&(Oc.AvgFontColorCount=mn);var nn=null==Ea.r?null:Ea.r.toString();null!=nn&&(Oc.MaxFontColorCount=nn);var on=null==Ea.s?null:Ea.s.toString();null!=on&&(Oc.AvgIconsCount=on);var pn=
null==Ea.t?null:Ea.t.toString();null!=pn&&(Oc.MaxIconsCount=pn);var qn=null==Ea.u?null:Ea.u.toString();null!=qn&&(Oc.Executed=qn);break;case 51:Gf="NamedSheetViewUserAction";var rn=Ea.a;null!=rn&&(Oc.UserSessionId=rn);var sn=Ea.b;null!=sn&&(Oc.UserActionName=sn);var tn=null==Ea.c?null:Ea.c.toString();null!=tn&&(Oc.UserActionSource=tn);var un=Ea.d;null!=un&&(Oc.UserActionData=un);var vn=Ea.e;null!=vn&&(Oc.OtherData=vn);break;case 52:Gf="NamedSheetViewTeachingCallout";var wn=Ea.a;null!=wn&&(Oc.UserSessionId=
wn);var xn=null==Ea.b?null:Ea.b.toString();null!=xn&&(Oc.TeachingCalloutSequence=xn);var yn=null==Ea.c?null:Ea.c.toString();null!=yn&&(Oc.TeachingCalloutIndex=yn);var zn=null==Ea.d?null:Ea.d.toString();null!=zn&&(Oc.UserActionName=zn);var An=Ea.e;null!=An&&(Oc.UserActionData=An);var Bn=null==Ea.f?null:Ea.f.toString();null!=Bn&&(Oc.DurationInMs=Bn);break;case 53:Gf="NamedSheetViewTeachingDialog";var Cn=Ea.a;null!=Cn&&(Oc.UserSessionId=Cn);var Dn=Ea.b;null!=Dn&&(Oc.UserActionName=Dn);var En=Ea.c;null!=
En&&(Oc.ButtonClicked=En);var Fn=null==Ea.d?null:Ea.d.toString();null!=Fn&&(Oc.DurationInMs=Fn);var Gn=null==Ea.e?null:Ea.e.toString();null!=Gn&&(Oc.IsNewTeachingDialog=Gn);break;case 54:Gf="NamedSheetViewOptionsDialog";var Hn=Ea.a;null!=Hn&&(Oc.UserSessionId=Hn);var In=null==Ea.b?null:Ea.b.toString();null!=In&&(Oc.OptionsAction=In);var Jn=Ea.c;null!=Jn&&(Oc.OptionsActionData=Jn);var Kn=Ea.d;null!=Kn&&(Oc.OptionsOtherData=Kn);var Ln=null==Ea.e?null:Ea.e.toString();null!=Ln&&(Oc.DurationInMs=Ln);break;
case 55:Gf="NamedSheetViewTempViewApplyDialog";var Mn=Ea.a;null!=Mn&&(Oc.UserSessionId=Mn);var Nn=Ea.b;null!=Nn&&(Oc.TriggeredFrom=Nn);var On=Ea.c;null!=On&&(Oc.ButtonClicked=On);var Pn=null==Ea.d?null:Ea.d.toString();null!=Pn&&(Oc.DurationInMs=Pn);break;case 56:Gf="NamedSheetViewTempViewSaveDialog";var Qn=Ea.a;null!=Qn&&(Oc.UserSessionId=Qn);var Rn=Ea.b;null!=Rn&&(Oc.TriggeredFrom=Rn);var Sn=Ea.c;null!=Sn&&(Oc.ButtonClicked=Sn);var Tn=null==Ea.d?null:Ea.d.toString();null!=Tn&&(Oc.NameUpdated=Tn);
var Un=null==Ea.e?null:Ea.e.toString();null!=Un&&(Oc.DurationInMs=Un);break;case 57:Gf="TemporaryViewStartedDataRestore";var Vn=Ea.a;null!=Vn&&(Oc.UserSessionId=Vn);var Wn=null==Ea.b?null:Ea.b.toString();null!=Wn&&(Oc.CountOfTempViews=Wn);break;case 58:Gf="TemporaryViewFetchedVersion";var Xn=Ea.a;null!=Xn&&(Oc.UserSessionId=Xn);var Yn=null==Ea.b?null:Ea.b.toString();null!=Yn&&(Oc.NumberOfBytes=Yn);break;case 59:Gf="RaiseEventsAndGenerateBlockRequests";var Zn=null==Ea.a?null:Ea.a.toString();null!=
Zn&&(Oc.ReturnContentStatus=Zn);var $n=null==Ea.b?null:Ea.b.toString();null!=$n&&(Oc.CacheState=$n);var ao=null==Ea.c?null:Ea.c.toString();null!=ao&&(Oc.FromXhrCallback=ao);var bo=null==Ea.d?null:Ea.d.toString();null!=bo&&(Oc.AreGeneralErrorsPresent=bo);var co=Ea.e;null!=co&&(Oc.BlockCacheItemHash=co);var eo=Ea.f;null!=eo&&(Oc.StopwatchId=eo);var fo=Ea.g;null!=fo&&(Oc.BlockCacheItemProcessingStopwatchId=fo);var go=null==Ea.h?null:Ea.h.toString();null!=go&&(Oc.StateId=go);var ho=null==Ea.i?null:Ea.i.toString();
null!=ho&&(Oc.IsHighPriority=ho);var io=null==Ea.j?null:Ea.j.toString();null!=io&&(Oc.CalcComplete=io);var jo=null==Ea.k?null:Ea.k.toString();null!=jo&&(Oc.EditedCellsUpdatedByCse=jo);var ko=null==Ea.l?null:Ea.l.toString();null!=ko&&(Oc.DependentCellsUpdatedByCse=ko);var lo=null==Ea.m?null:Ea.m.toString();null!=lo&&(Oc.Revision=lo);var mo=null==Ea.n?null:Ea.n.toString();null!=mo&&(Oc.SheetProcessedDataVersion=mo);var no=null==Ea.o?null:Ea.o.toString();null!=no&&(Oc.RefCount=no);var oo=null==Ea.p?
null:Ea.p.toString();null!=oo&&(Oc.ExistsInView=oo);var po=null==Ea.q?null:Ea.q.toString();null!=po&&(Oc.ContentSource=po);break;case 60:Gf="LaunchMakerCodeEditor";var qo=Ea.a;null!=qo&&(Oc.SessionId=qo);var ro=Ea.b;null!=ro&&(Oc.Command=ro);var so=null==Ea.c?null:Ea.c.toString();null!=so&&(Oc.IsPreviewGallery=so);var to=Ea.d;null!=to&&(Oc.MenuItemId=to);var uo=Ea.e;null!=uo&&(Oc.ScriptId=uo);var vo=Ea.f;null!=vo&&(Oc.ShareId=vo);var wo=null==Ea.g?null:Ea.g.toString();null!=wo&&(Oc.IsOwner=wo);var xo=
null==Ea.h?null:Ea.h.toString();null!=xo&&(Oc.PublishedScriptCount=xo);var yo=null==Ea.i?null:Ea.i.toString();null!=yo&&(Oc.RecentScriptCount=yo);var zo=null==Ea.j?null:Ea.j.toString();null!=zo&&(Oc.WorkbookScriptCount=zo)}Oc.Table=Gf;var Eo=Sys.Serialization.JavaScriptSerializer.serialize(Oc);Pd.call(wd,3704927,0,50,Eo)}}catch(Oc){e.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${Ba} exception: ${Oc}`)}}I9c(Ba,Ea,rc){if(this.mrc){const wd=this.RXa[Ba+Ea];wd&&(wd.e=rc,this.Sbd(wd));
delete this.RXa[Ba+Ea]}}Uvd(Ba,Ea){k[Ba]in this.srf||this.Qe(Ba,Ea)}g1i(){this.Oh.appStart&&this.e$f(Td.YEd,this.Oh.appStart)}EAi(Ba){const Ea={};Ea.a=Ba.i;Ea.b=Ba.o;Ea.c=Ba.t;Ea.d=Bd.a(Ba.s,Ba.p||this.Oh.appStart);Ea.e=Bd.a(Ba.e,Ba.s);Ea.f=Ba.c;Ea.g=Ba.a;Ea.h=Ba.h;this.Qe(0,Ea,this.noi(Ea.b,Ea.c))}noi(Ba,Ea){return["CommandTask","QueuedTask","Task"].includes(Ba)&&!this.DBh.includes(Ea)?!1:!0}OA(Ba,Ea,rc,wd,Pd=!0){if(Ba&&Ea){const te={};te.a=Ba;te.b=Ea;te.c=rc.toString();te.d=wd.toString();this.Qe(15,
te,Pd)}}crf(Ba,Ea,rc,wd){const Pd={};Ba&&(Pd.c=Bd.a(Ba,this.Oh.appStart));Pd.b=Ea;Pd.a=rc;Pd.d=wd;this.Qe(17,Pd)}dispose(){this.CRa.execute(Ba=>{Ba.deactivate(!0);Ba.tfj(this.SFf)});this.De&&this.De.scb(this.aW);super.dispose()}Q7e(){return this.Lkg=this.Lkg||new ae}wIe(Ba,Ea,rc=null,wd=null,Pd=null){const te={};te.o=Ba;te.t=Ea;te.p=Pd;te.s=wd||this.Oh.ve;this.xnd(te,rc);return te}yEe(Ba,Ea=null){Ba&&(Ba.e=Ea||this.Oh.ve,Ba.i=Ba.i||this.z1a.G9a(),Ba.c=Ba.c||this.aJe,Ba.a=Ba.a||this.kJe,Ba.h=void 0!==
Ba.h&&null!==Ba.h?Ba.h:this.De?this.De.ti:!1,this.Sbd(Ba))}krf(Ba){const Ea=Ba.context;Ba.duration>Td.Fnh&&(Ea.methodName===dd.a.txb||Ea.methodName===dd.a.iwa)&&this.avc(1,Td.tZh);if("GetSessionStatus"!==Ea.methodName){const rc={};rc.a=Ea.methodName;rc.b=Ea.stopwatch.id;rc.c=Ba.lvc;rc.d=Ba.responseSize;rc.e=Ea.XHa;rc.f=Ba.nd?Ba.nd.StateId:dd.a.u_d;this.Qe(30,rc,!0);this.OA(rc.b,Ba.nd.ServerCorrelationId,"clientWebRequests","ServerActions")}}W$f(){if(this.mrc){const Ba=this.RXa.LoadingUIShownSplashScreen;
Ba&&ob.PageLoadTrackingInfo.instance.Dvj(Ba.s)}}avc(Ba,Ea){this.rjg.nKb(Ba,Ea,null)}nWf(Ba,Ea=null){this.jEc.ajj(Ba,Ea)}mWf(Ba,Ea,rc=null){this.jEc.$ij(Ba,Ea,rc)}oWf(Ba){this.jEc.rKb(Ba,null)}pWf(Ba,Ea){this.jEc.nKb(Ba,Ea,null)}Yuc(Ba,Ea,rc=null){this.Kgb.Yuc(Ba,Ea,rc)}dvc(Ba,Ea,rc=null){this.Kgb.dvc(Ba,Ea,rc)}sendDNMTraceTag(Ba,Ea,rc,wd,...Pd){Wa.EwaSettings.ma(216)&&e.ULS.sendTraceTag.apply(null,[Ba,Ea,rc,wd].concat(Pd))}QLb(Ba,Ea,rc,wd,Pd,te,af,...Cf){this.Kgb.QLb(Ba,Ea,rc,wd,Pd,te,af,...Cf)}SLb(Ba,
Ea,rc,wd,Pd,te){this.Kgb.SLb(Ba,Ea,rc,wd,Pd,te)}RLb(Ba,Ea,rc,wd,Pd,te,...af){this.Kgb.RLb(Ba,Ea,rc,wd,Pd,te,...af)}TLb(Ba,Ea,rc,wd,Pd,te){this.rjg.TLb(Ba,Ea,rc,wd,Pd,te)}Zwc(Ba,Ea,rc,wd){this.Kgb.Zwc(Ba,Ea,rc,wd)}Sbd(Ba){this.rKj.EAi(Ba)}h1i(){if(this.mrc){Stw.swpc=null;const Ba=this.mrc;for(let Ea in Ba)this.xnd(Ba[Ea])}}EEh(){const Ba=window[sc.a.namespace];if(Ba){const Ea=Ba[sc.a.FDe];Ea&&(delete Ba[sc.a.FDe],Ea.forEach(rc=>{this.xnd(rc);this.Sbd(rc)}))}}Fpi(Ba,Ea){if("about:blank"===Ba||"renamehandler.ashx"===
Ea&&"2"===y.a.iy(Ba,"u"))return!0;for(Ba=0;Ba<this.YMd.length;Ba++)if(Ea.endsWith(this.YMd[Ba]))return!0;return!1}dyi(){this.CRa.execute(Ba=>{Ba.Wh(Td.uSg,0);Ba.cKg(this.SFf);Ba.activate()})}Xxi(){const Ba={};Ba.a=new Date(ac.EcmaDateClock.instance.appStart.m);Ba.b=this.userSessionId;Ba.c=this.Oh.Pcg;Ba.d=Td.yhh*l.devicePixelRatio;Ba.e=Na.a.Qa.appStart.m;this.Qe(14,Ba,!0);this.Jla(Na.a.Qa.appStart.m,Object(X.a)(z.a.instance,z.a.instance.y$i,"recordAppInitStart"))}e$f(Ba,Ea){this.Fgb=this.z1a.G9a();
this.uQb=this.z1a.G9a();this.PDa=Ba;this.$Nb("UserAction",Ba,this.uQb,Ea);this.eqf(Ba,this.Fgb)}uMj(){const Ba=window[sc.a.namespace];Ba&&!Td.LGe&&(Ba[sc.a.mJj]=(Ea,rc)=>this.wIe(Ea,rc),Ba[sc.a.Nph]=Ea=>{this.yEe(Ea)},Td.LGe=!0)}RUj(Ba){const Ea=$d.$Vg(Ba.o,Ba.t),rc=new $d(Bd.a(Ba.e,Ba.s)),wd=Ea in this.JWd?this.JWd[Ea].m4g(rc):rc;this.JWd[Ea]=wd;if(rc===wd||rc.average!==wd.average)Ba=Object(Cb.a)(new Jd,{operation:Ba.o,target:Ba.t,$Gi:wd.average,sender:this}),this.raiseEvent(Ea,Ba)}eqf(Ba,Ea){const rc=
{};rc.a=Ea;rc.b=this.userSessionId;rc.c=Ba;this.Qe(1,rc,!0)}Tdi(){this.YMd=[dd.a.bdj,dd.a.getSessionStatus,dd.a.iwa,dd.a.a4g,dd.a.R0g,dd.a.ygb,dd.a.Mcc,dd.a.getObjectMetadata,dd.a.setRichTextCell,dd.a.nwa,dd.a.XYj,dd.a.pollSessionStatus,dd.a.k1h,dd.a.x_h,dd.a.KUh]}xnd(Ba,Ea=null){Ba.i=Ea||this.z1a.G9a();Ba.a=this.kJe;Ba.c=this.aJe;Ba.h=this.De?this.De.ti:!1}static ka(Ba){var Ea=new sf;Ba.da.Ga(291,Ea);Ea=new Td(Ba.va.UserSessionId,void 0,void 0,void 0,Ea,!0);Ea.eqf(Td.kwf,Ea.VJe);e.ULS.sendTraceTag(524166239,
0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Ea.dyi();Ea.uMj();Ea.g1i();Ea.Xxi();Ea.EEh();Ea.h1i();Ea.Tdi();Td.utj(Ba);rd.a.Tl.Ga(41,Ea)}static utj(Ba){const Ea=l.devicePixelRatio;1<Ea&&Ba.dc.kx(!0,2<=Ea?8388608:4194304)}}Td.kwf="UnassignedUserAction";Td.YEd="PageLoad";Td.Kjd="GridUpdateOperation";Td.Fnh=5E3;Td.tZh="MoreThan_5000_Ms";Td.yhh=96;Td.uSg=30;Td.LGe=!1;Object(b.a)(Td,"TelemetryManager",ye.a,[488,489,490,491]);var oe=a(199),Oe=a(103);class be{constructor(Ba,
Ea,rc){this.a0j=Ba;this.UU=Ea;this.name=rc}}Object(b.a)(be,"Validation",null,[]);class Ge{constructor(Ba){this.Kca=()=>{this.RKf(this.FXe)};this.Hj=()=>{this.RKf(this.CTg)};this.$=Ba;this.CTg=new ab.a;this.FXe=new ab.a;Nb.h(this.$).Ea.hw(this.Hj);Nb.h(this.$).Ea.oWc(this.Kca)}SVc(Ba,Ea,rc,wd,Pd){if(Ba&&wd){const te=oe.a.xz(Ea,rc);this.b_b(()=>!!Oe.a(Ba).Sq(te),wd.StateId,Pd)}}b_b(Ba,Ea,rc){this.SIg(this.FXe,Ba,Ea,rc)}SIg(Ba,Ea,rc,wd){Ba&&Ea&&rc!==dd.a.qe&&Ba.add(new be(Ea,rc,wd))}RKf(Ba){if(Ba){var Ea=
new ab.a;for(let rc of Ba){if(rc.UU===this.$.ea.ze)try{rc.a0j()||e.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${rc.name}]`)}catch(wd){e.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${rc.name}]. Exception: [${wd}]`)}Ea.add(rc)}for(let rc of Ea)Ba.remove(rc)}else e.ULS.shipAssertTag(537151011,0,!!Ba,
"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){Nb.h(this.$)&&Nb.h(this.$).Ea&&(Nb.h(this.$).Ea.gx(this.Hj),Nb.h(this.$).Ea.GJb(this.Kca));this.$=null}static ka(Ba){const Ea=new Ge(Ba);Ba.da.Ga(277,Ea)}}Object(b.a)(Ge,"ValidationTelemetryManager",null,[485,2]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");n.main();Type.registerNamespace("CNT");W.main();Type.registerNamespace("CACPU");mb.main();Type.registerNamespace("Common.App.EventsCacheManager");
ib.main();(()=>{cc.a.Fa(Ba=>{Ba.da.Ga(137,new xa(Ba))})})();(()=>{cc.a.Fa(Ba=>{Ba.da.Ga(37,new $b(Ba))})})();(()=>{cc.a.Fa(Ba=>{Ub.ka(Ba)})})();(()=>{cc.a.Fa(Ba=>{Sc.ka(Ba)})})();(()=>{cc.a.Fa(Ba=>{Id.ka(Ba)})})();(()=>{cc.a.Fa(Ba=>{Ba.da.Ga(40,new ce(Ba,new Ka.a(()=>zb.GetServiceTaskFactory.create(Ba.da,137,Ba.la,1))))})})();(()=>{cc.a.Fa(Ba=>{Ba.da.Ga(276,new Lc(Ba))})})();(()=>{cc.a.Fa(Ba=>{rd.a.Tl.$a(135,()=>{Td.ka(Ba);Nd.ka(Ba);Ge.ka(Ba);Wc.ka(Ba);Wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnregisterCpuMeter",
!1)||bd(Ba);ve.ka(Ba);Ja.ka(Ba);fd.RenderingFidelityTracker.ka(Ba)})})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tm.js.map/8dede9a3a7fca378e592e03b3b5b934d/EwaDSEsNext.tm.js.map