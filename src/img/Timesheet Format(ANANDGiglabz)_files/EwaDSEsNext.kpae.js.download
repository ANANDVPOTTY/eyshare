'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1078:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1079:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{constructor(b,e){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=e}us(){return this.command}}Object(u.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[137])},1080:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:bold}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1081:function(u,E,a){a.d(E,"a",function(){return"FieldInfoListContextLoaded"});a.d(E,"h",function(){return"GetFieldInfoListContextOperationFailed"});a.d(E,"d",function(){return"Days from Today"});a.d(E,"g",function(){return"Years from Today"});a.d(E,"c",function(){return"Day of the Week"});a.d(E,"f",function(){return"Month of the Year"});a.d(E,"e",function(){return"End of Month"});a.d(E,"b",function(){return"Next Day"})},1082:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>
{c.a.Oi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1083:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}.DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1084:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);var c;(function(b){b[b.anyValue=0]="anyValue";b[b.wholeNumber=1]="wholeNumber";b[b.decimal=2]="decimal";b[b.list=3]="list";b[b.date=4]="date";b[b.time=5]="time";b[b.textLength=6]="textLength";b[b.custom=7]="custom"})(c||(c={}));Object(u.b)("DataValidationRuleType",c)},1086:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".ewa-facp-text-box{position:absolute}")}},1087:function(u,E,a){a.d(E,"b",function(){return"MinorThemeFont"});
a.d(E,"a",function(){return"MajorThemeFont"})},1089:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1090:function(u,E,a){a.d(E,"a",function(){return m});u=a(0);E=a(238);var c=a(5),b=a(33),e=a(11),f=a(21),d=a(34),h=a(4);class m extends E.a{constructor(l){super(document.createElement("div"));this.oR=this.lJa=this.kJa=this.mJa=this.oJa=this.nJa=!1;this.oJ=null;this.visible=void 0;this.Soc=(w,n)=>{this.Rt(w,n)};this.tMa=()=>{this.Za.textBox.GF=!0};this.xza=()=>{this.jz(!0)};this.yyf=()=>{this.Za.textBox.focus()};this.Rh=()=>{f.h(this.$).inRangePicker||(this.re=!1)};this.$=l;f.h(l)&&f.h(l).ha&&f.h(this.$).ha.gH(this.Rh);
this.$k=b.a.g5(l)}get qI(){return this.mu.qI}get re(){return this.mu.re}set re(l){this.mu.re=l}get Za(){return this.oJ}set Za(l){(this.oJ=l)&&this.oJ.b2d.add(this)}get YHh(){return b.a.AN(this.$)?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(l){if(this.visible===l)return l;this.visible=l;return super.set_visible(l)}Rt(){this.xCa(!1);this.mu.Rt()}dispose(){this.$&&f.h(this.$)&&f.h(this.$).ha&&f.h(this.$).ha.mL(this.Rh);this.$=null;super.dispose()}Yh(l,
w,n=!1){l=!1;if((this.P1a||n)&&!this.Axa()&&this.get_visible()&&this.re)switch(this.$k&&this.WCc(w),w){case 1872288872:this.re=!1;l=!0;break;case -798660877:this.mu.BB(1);l=!0;break;case 137938150:this.mu.BB(-1);l=!0;break;case 2091832999:this.mu.BB(this.qI-1);l=!0;break;case 742457698:this.mu.BB(-(this.qI-1));l=!0;break;case 125627505:l=this.jz(!1);break;case 267796030:b.a.g5(this.$)&&(l=this.jz(!1))}return l}xCa(l){if(this.re||l){var w=f.h(this.$);l=w.domElement;var n=this.oJ.textBox.domElement,
y=d.a(this.$).zi(n.offsetHeight),t=d.a(this.$).zi(n.offsetTop),r=d.a(this.$).zi(n.offsetWidth);n=d.a(this.$).zi(n.offsetLeft);w=w.Ul;var v=h.AFrameworkApplication.sa&&h.AFrameworkApplication.sa.Pa.Ye,B=$get(this.$.Eb+c.a.Q0a,this.$.domElement);v&&(B=document.getElementById("EditorContainer"));var A=new Sys.UI.Point(w?this.mu.Hac:0,w?this.YHh:m.B5h);y=B.offsetTop+A.y+(b.a.AN(this.$)&&w?0:y+t);this.$.q_||(t=$get(c.a.Csa,this.$.domElement),y+=t&&!v?t.offsetHeight:0);t=this.domElement;t.style.top=e.HelperMethods.uc(y);
n=B.offsetLeft+n+A.x;!b.a.AN(this.$)&&this.$.isChromeRtl?t.style.right=e.HelperMethods.uc(w?this.mu.Hac:l.offsetLeft+l.offsetWidth-n-r):t.style.left=e.HelperMethods.uc(n)}}UTa(l){this.mu&&(l&&!this.oR?(this.mu.a$(this.yyf),this.mu.F_b(this.tMa),this.mu.vob(this.xza),this.oR=!0):this.oR&&(this.mu.Ida(this.yyf),this.mu.quc(this.tMa),this.mu.YJb(this.xza),this.oR=!1))}WCc(l){switch(l){case -798660877:case 137938150:case 2091832999:case 742457698:this.nJa=!0;break;case 125627505:this.mJa=!0;break;case 267796030:b.a.g5(this.$)&&
(this.kJa=!0)}}}m.Hac=0;m.B5h=1;Object(u.a)(m,"AutoCompleteControl",E.a,[345])},1091:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c extends Sys.EventArgs{constructor(b,e=0,f="",d=""){super();this.length=b;this.selectedIndex=e;this.qG=f;this.description=d}}Object(u.a)(c,"ListEventArgs",Sys.EventArgs,[])},1092:function(u,E,a){a.d(E,"a",function(){return t});u=a(0);var c=a(15),b=a(27);E=a(837);var e=a(775),f=a(5),d=a(76),h=a(33),m=a(12),l=a(1),w=a(117),n=a(21),y=a(908);class t extends E.a{constructor(r,
v){super(r,v,new y.a(e.a.listItem,e.a.eDb,e.a.hDb,e.a.iDb));this.bec=!1;this.smb=this.qp=null;this.EYe=!1;this.visible=void 0;this.OBa(!0);this.EYe=l.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get Hac(){if(h.a.AN(this.$)){var r=document.getElementById(this.$.Eb+f.a.DYe);return!this.EYe||r?m.DOMElementExtensions.getBoundingClientRect(r).x:0}r=l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.xzd):document.getElementById(this.$.Eb+
f.a.xzd+"-"+f.a.tvf);c.ULS.shipAssertTag(537170323,0,!!r||this.$.HK,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return r?r.offsetWidth:0}get ee(){return this.smb}set ee(r){this.smb=r}get re(){return void 0!==this.visible?this.visible&&0<this.qp.length:(this.visible=m.DOMElementExtensions.isVisible(this.Kf))&&0<this.qp.length}set re(r){this.visible!==r&&(m.DOMElementExtensions.setVisible(this.Kf,r),m.DOMElementExtensions.setVisible(this.vUa,r),this.visible=
r);const v=n.h(this.$).view;r?this.bec||(v.nt(this.jHa.Soc),this.bec=!0):(this.qp.length=0,this.bec&&(v.gr(this.jHa.Soc),this.bec=!1))}Oya(){var r=460;const v=n.h(this.$);var B=v.domElement,A=this.vUa.style;const z=this.Kf.offsetTop+this.Oj.offsetHeight*this.Oj.sectionRowIndex-this.Kf.scrollTop;A.width="auto";A.whiteSpace="nowrap";A.position="absolute";const x=B.offsetLeft+B.offsetWidth-(this.domElement.offsetLeft+this.Kf.offsetLeft+this.Kf.offsetWidth+3);B=this.domElement.offsetLeft-3-(B.offsetLeft+
this.Hac);r=Math.min(this.vUa.offsetWidth,r,Math.max(x,B));m.DOMElementExtensions.Vv(this.vUa,r);A.whiteSpace="";A.position="absolute";z+3>this.Kf.offsetTop+this.Kf.offsetHeight||z<this.Kf.offsetTop||(r=this.Kf.offsetLeft-3-this.vUa.offsetWidth,A=this.Kf.offsetLeft+this.Kf.offsetWidth+3,m.DOMElementExtensions.updatePosition(this.vUa,B>x!==v.rtl?r:A,z,!1))}BB(r){super.BB(r);this.Oya()}Rt(){this.Oya()}tsa(){const r=this.Kn,v=this.Kf,B=3===d.a.Db||b.a.Dp,A=B?this.aEb:this.qI;this.re=!0;v.style.height=
"auto";this.jHa.set_visible(!0);this.bob(r,B);this.qp.length>A&&(m.DOMElementExtensions.gJ(v,Math.floor(v.offsetHeight*A/this.qp.length)),v.style.overflowY="auto");m.DOMElementExtensions.Vv(v,r.offsetWidth+(this.qp.length>A?w.a.Mu:0))}}Object(u.a)(t,"AutoCompleteListBox",E.a,[])},1093:function(u,E,a){a.d(E,"a",function(){return n});u=a(0);var c=a(224),b=a(14),e=a(107),f=a(239);E=a(238);var d=a(732),h=a(5),m=a(53),l=a(12),w=a(71);class n extends E.a{constructor(y,t,r,v,B,A,z,x,D,J){super(document.createElement("a"));
this.nn=!1;this.gd=L=>{this.raiseEvent("ClickButton",L);return!0};this.onKeyDown=L=>{this.raiseEvent("KeyDown",L);return!1};this.Vw=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.gO=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=L=>{w.g(L);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=L=>{w.g(L);this.focused=!0;this.raiseEvent("Focus")};this.Gph=x;this.Wkh=D;this.uJ=n.pb(this.domElement,t,r,v,B,A,z,J);this.Gc.ka("contextmenu",L=>{w.g(L)});this.enable();
this.focused=this.hovered=!1;y.appendChild(this.domElement)}vWc(y){this.get_events().addHandler("ClickButton",y)}pLd(y){this.get_events().removeHandler("ClickButton",y)}HWc(y){this.get_events().addHandler("KeyDown",y)}CLd(y){this.get_events().removeHandler("KeyDown",y)}T_b(y){this.get_events().addHandler("PointerOver",y)}MLd(y){this.get_events().removeHandler("PointerOver",y)}S_b(y){this.get_events().addHandler("PointerOut",y)}LLd(y){this.get_events().removeHandler("PointerOut",y)}hob(y){this.get_events().addHandler("Blur",
y)}JJb(y){this.get_events().removeHandler("Blur",y)}a$(y){this.get_events().addHandler("Focus",y)}Ida(y){this.get_events().removeHandler("Focus",y)}get Fl(){return this.uJ}get isEnabled(){return this.nn}enable(){this.domElement&&(this.domElement.classList.remove(d.a.rU),this.domElement.style.cursor="",c.a.instance.ta(b.a.click,this.domElement,this.gd),e.KeyInputManager.instance.ta(b.a.Pb,this.domElement,this.onKeyDown),f.a.instance.ta(b.a.pointerOver,this.domElement,this.Vw),f.a.instance.ta(b.a.pointerOut,
this.domElement,this.gO),this.Gc.Pi("blur")||this.Gc.ka("blur",this.onBlur),this.Gc.Pi("focus")||this.Gc.ka("focus",this.onFocus),this.domElement.title=this.Gph,this.nn=!0)}disable(){this.domElement&&(this.domElement.classList.add(d.a.rU),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.gd),e.KeyInputManager.instance.Ba(b.a.Pb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Vw),f.a.instance.Ba(b.a.pointerOut,this.domElement,
this.gO)),this.domElement.title=this.Wkh,this.nn=!1)}dispose(){this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.gd),e.KeyInputManager.instance.Ba(b.a.Pb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Vw),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.gO),this.nn=!1);l.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static pb(y,t,r,v,B,A,z,x){y.removeAttribute("Href");y.setAttribute(h.a.Ld,h.a.ot);y.className=t;y.tabIndex=
x;t=document.createElement("span");t.className=z;t.classList.add(r);t.tabIndex=-1;y.appendChild(t);y=document.createElement("img");y.src=m.a.we(v);y.className=B;y.alt=A;y.tabIndex=-1;t.appendChild(y);return y}}Object(u.a)(n,"ListButton",E.a,[386,2])},1094:function(u,E,a){a.d(E,"a",function(){return d});u=a(0);var c=a(109),b=a(28),e=a(1),f=a(725);class d{constructor(l){this.Cuf=l;this.mW=Object.assign({},m);this.Ytb=[];this.umc=-1;(this.Buf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&
l&&(this.mW.countAboveThresholds={},l.forEach(w=>this.mW.countAboveThresholds[w]=0))}static get qYd(){return b.a.Qa.ve.m}LTa(){this.umc=d.qYd}j4(l,w=null){if(-1!==this.umc||Object(f.b)(w))l?(this.$nb(d.qYd-(w||this.umc)),this.umc=-1):this.mW.failedCount++}DWe(){this.mW.excludingFirstAction=d.CWe(this.Ytb);this.Ytb.push(this.mW.firstAction);this.mW.includingFirstAction=d.CWe(this.Ytb)}$nb(l){this.mW.count?1E3>this.mW.count&&this.Ytb.push(l):this.mW.firstAction=l;this.Buf&&this.Cuf&&this.Cuf.forEach(w=>
{l>w&&this.mW.countAboveThresholds[w]++});this.mW.count++}static CWe(l){const w=Object.assign({},h);0<l.length&&(c.i(l),w.median=l[Math.floor(.5*l.length)],w.P75=l[Math.floor(.75*l.length)],w.P95=l[Math.floor(.95*l.length)],w.max=l[l.length-1],w.average=c.g(l,n=>n)/l.length);return w}}Object(u.a)(d,"PerformanceMeasurement",null,[]);const h={average:0,max:0,median:0,P75:0,P95:0},m={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},h),excludingFirstAction:Object.assign({},
h)}},1137:function(u,E,a){function c(Z){var db=Object(J.h)(Z),Lb=Object(T.a)(Z);const hc=db.Ai;var Pc=db.fc.vjf;Pc=db.Ul||Pc;Lb=b((Pc?Lb:hc).textBox.domElement);if(Pc)db={top:0,left:0,right:innerWidth,bottom:innerHeight};else if(db=b(db.domElement),{zoom:Z}=Object(O.a)(Z),1!==Z)for(const Rc of[Lb,db])for(const xd in Rc)Rc[xd]*=Z;return{target:Lb,bounds:db}}function b(Z){const {top:db,left:Lb,right:hc,bottom:Pc}=Z.getBoundingClientRect();return{top:db,left:Lb,right:hc,bottom:Pc}}function e(Z){var db;
if(Z){var Lb=new Tc(0===Z.kind);Z=null===(db=null===Z||void 0===Z?void 0:Z.rangeInfo)||void 0===db?void 0:db.positionKindInfo;if(!Z)return Lb;Lb.NF=0===Z.firstRow;Lb.MF=0===Z.firstColumn;Lb.CK=0===Z.secondRow;Lb.BK=0===Z.secondColumn;return Lb}}var f=a(9),d=a(0),h=a(692),m=a(50),l=a(37),w=a(15),n=a(19),y=a(382),t=a(76);class r{}r.Qad="!";r.zJf="[";r.yJf="]";r.openParen="(";r.closeParen=")";r.slg=" /.(*\\".split("");r.O8b="...";r.jHb="param_help_link";r.gFd="param_help_udf";r.Idd="function_list_box";
r.SIh="function_param_box";r.Kdd="function_reader_description";r.Ddd="function_description_box";r.VYe="function_param_table";r.w_i="param_row_";r.Rqc="param_set";r.hKf="param_row_0";r.iKf="param_row_1";r.TIh="<div id='{0}' class='{1}'></div>";r.RIh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";r.jKf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";
r.PIh="<div id='{0}' class='{1} {2} {3}'></div>";r.NIh="<div id='{0}' class='{1} {2} {3} {4}'></div>";r.Eof="[@";r.c9g=1;r.b9g=3;r.mih=500;r.Ytf=50;Object(d.a)(r,"FormulaAssistanceConstants",null,[]);var v=a(13),B=a(284),A=a(8),z=a(5),x=a(91),D=a(11),J=a(21),L=a(355),T=a(113),O=a(34),G=a(437),C=a(229);const H=(Z,db,Lb)=>{if(Z){const hc=Z.da.za(491);hc?hc.PP.argumentAssistanceLearnMoreCounter++:w.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");
Lb?M(Z,db,Lb):(Lb=new x.a(-859308420,t.a.Db,Z.Hc,0,null),Z.Ja.Kb(Lb,{[t.a.Jc]:z.a.qV,[t.a.og]:"HelpID="+db}))}},I=(Z,db,Lb)=>{const hc={};hc[z.a.CQ]=db;db={};db.FunctionName=Lb;hc[z.a.ubd]=db;Z.Xc(802602464,0,8,hc)},M=(Z,db,Lb)=>{if(Lb){if(db&&(!db||db.startsWith("http://")||db.startsWith("https://"))){if(Z.ma(156)&&(Z=Object(G.a)({qFb:269,new:C.c,registry:Z.da}))&&Z.Xoa(db))return;D.HelperMethods.lf(db,"_blank",L.a)}}else D.HelperMethods.eW(Z.GG,"XLWAEndUser_"+db,Z.GS)},Q=Z=>{let db=A.a.a0;const Lb=
Z.da.za(368);Lb&&!Object(J.h)(Z).Ul&&(db=Lb.zoom);return db};var U;(function(Z){Z.CategoryList="categoryList";Z.FunctionsMap="functionsMap";Z.FunctionIdsToDisplay="functionIdsToDisplay";Z.RefreshListCallback="refreshListCallback";Z.HelpCallback="helpCallback";Z.feedbackCallback="giveFeedbackCallback";Z.InitialCategory="initialCategory";Z.AllCategoryName="allFunctionsCategoryName"})(U||(U={}));Object(d.b)("PropsKeys",U);class N extends B.a{constructor(Z){super(Z);this.PYe=(db,Lb)=>{1===db&&(this.hide(),
Lb=Lb.functionName,db=0<this.functionInfoManager.h2e(Lb).Params.length,Lb={[t.a.Jc]:Lb,["ibdk"]:!0},db=new x.a(db?1117706454:-433697611,0,this.$.Hc,8,null),this.$.Ja.Kb(db,Lb))};this.onFunctionInfoLoaded=()=>{this.functionInfoManager.ucb(this.onFunctionInfoLoaded);this.rdf()};this.a$h=db=>{M(this.$,db,!1)};this.WNi=db=>{this.hide();I(this.$,"InsertFunctionDialog",db)};this.sjf=db=>!this.functionInfoManager.Shc(db);this.Pl=v.a.instance.ga(1031);this.functionInfoManager=Z.da.za(19);this.gg()}get pc(){return"FunctionDialog"}gg(){this.functionInfoManager.JJa({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Rb=1;this.functionInfoManager.BV?this.rdf():this.functionInfoManager.DGa(this.onFunctionInfoLoaded)}rdf(){var Z;this.x0b=this.functionInfoManager.Qac.filter(this.sjf);const db=null!==(Z=N.xnf)&&void 0!==Z?Z:N.k5g;Z=this.functionInfoManager.Bdd;const Lb=this.functionInfoManager.kcc(db).map(hc=>hc.FunctionIndex);this.Oq={[N.uu]:this.pc,[U.CategoryList]:Z,[U.FunctionsMap]:this.Sah(),[U.FunctionIdsToDisplay]:Lb,[U.RefreshListCallback]:this.mRi.bind(this),
[U.feedbackCallback]:this.WNi.bind(this),[U.HelpCallback]:this.a$h,[U.InitialCategory]:db,[U.AllCategoryName]:N.AllCategoryName};this.initializeAndShow(this.Pl,this.PYe,this.Oq)}Sah(){let Z={};this.x0b.forEach(db=>{Z[db.FunctionIndex]=db});return Z}OVj(Z){Z=Z.map(db=>db.FunctionIndex);this.Oq[U.FunctionIdsToDisplay]=Z;this.MUa(this.Pl,this.l5a(this.PYe),this.Oq)}mRi(Z,db){db?db=this.tEh(db):(db=this.functionInfoManager.kcc(Z).filter(this.sjf),N.xnf=Z);this.OVj(db)}tEh(Z=""){Z=Z.toLocaleLowerCase();
const db=this.x0b.filter(({NameUI:Lb})=>Lb.toLocaleLowerCase().startsWith(Z));3<=Z.length&&(db.push(...this.x0b.filter(Lb=>Lb.NameUI.toLocaleLowerCase().includes(Z)&&!db.includes(Lb))),db.push(...this.x0b.filter(Lb=>Lb.Help.toLocaleLowerCase().includes(Z)&&!db.includes(Lb))));return db}}N.AllCategoryName=v.a.instance.ga(1030);N.k5g=v.a.instance.ga(1029);N.xnf=void 0;Object(d.a)(N,"FunctionDialog",B.a,[]);var W=a(55),X=a(66),sa=a(33),da=a(87),S=a(27),oa=a(210),K=a(68),ea=a(108),ya=a(226),ha=a(53),
La=a(735),Ia=a(12),ra=a(71),pa=a(1);const ba=K.a.ith,fa=K.a.sth,Ka=K.a.tth,aa=K.a.MQe,ja=K.a.kth,Va=K.a.mth,bb=K.a.HQe,wa=K.a.PQe,ka=K.a.lth,ta=K.a.KQe;class qa extends oa.a{constructor(Z,db){super(Z,v.a.instance.ga(1031),void 0,void 0,void 0,pa.EwaSettings.ma(391));this.Svb=this.Kpf=this.XYe=this.UYe=this.Dja=this.TYe=this.Vvb=this.BKa=this.Eja=this.CKa=null;this.bld=!1;this.Gyb=this.FEb=this.Z2b=null;this.onFunctionInfoLoaded=()=>{if(!this.BKa.count){const Lb=this.functionInfoManager.Bdd;for(let hc=
0,Pc=Lb.length;hc<Pc;++hc)this.BKa.BY(Lb[hc],Lb[hc],!1).className=K.a.jth;this.BKa.selectedIndex=0;da.a.qc([this.Z2b,this.FEb,this.Gyb]);this.Z2b=this.Ce.Zd(this.CKa);this.FEb=this.Ce.Zd(this.Eja);this.Gyb=this.Ce.Zd(this.Svb);this.Z2b.ka("change",this.NBf);this.FEb.ka("change",this.JOi);this.FEb.ka("dblclick",this.KOi);this.Gyb.ka("click",this.Sca);this.Gyb.ka("keyup",this.TQi);Ia.DOMElementExtensions.setVisible(this.Eja,!0);Ia.DOMElementExtensions.setVisible(this.TYe,!1);this.$.Q6c&&Ia.DOMElementExtensions.setVisible(this.Kpf,
!0)}this.NBf(null);this.getButton(0).get_element().disabled=!1;this.CKa.disabled=!1;this.ESa();this.bld=!0};this.Sca=()=>{this.faa&&H(this.$,this.faa.HelpId,this.faa.IsDynamicUdf)};this.TQi=Lb=>{13!==Lb.keyCode&&32!==Lb.keyCode||this.Sca(Lb)};this.NBf=()=>{const Lb=this.functionInfoManager.kcc(this.BKa.ee.value);this.k4a(Lb);this.Eja.scrollTop=0;this.k2f()};this.JOi=()=>{this.k2f()};this.KOi=Lb=>{this.faa&&(ra.g(Lb),this.close(0))};this.Tc=(Lb,hc)=>{ya.b(hc)&&this.rv()};this.functionInfoManager=Z.da.za(19);
this.formulaAssistanceControl=Z.da.za(221);if(this.Kvb=sa.a.zV(this.$))this.formulaAssistanceManager=Z.da.za(464);this.XM=db}get pc(){return"FunctionDeprecatedDialog"}get faa(){if(!this.Eja||!this.Eja.firstChild)return null;const Z=Number.parseInvariant(this.Eja.children[this.Eja.selectedIndex].value);return this.functionInfoManager.zTh(Z)}initialize(){this.Mb.classList.add(K.a.hth);if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7262176_FunctionDeprecatedDialogReduceInnerHtml")){var Z=document.createElement("div");
Z.classList.add(K.a.GQe);var db=document.createElement("label");db.setAttribute("for",qa.Cdd);db.innerText=v.a.instance.ga(1034)+" ";Z.appendChild(db);db=document.createElement("select");db.id=qa.Cdd;db.classList.add(ba);db.setAttribute("disabled","true");Z.appendChild(db);this.Mb.appendChild(Z);Z=document.createElement("div");Z.classList.add(ea.a.zo);Z.innerText=v.a.instance.ga(1035);this.Mb.appendChild(Z);Z=document.createElement("div");Z.classList.add(K.a.FQe);db=document.createElement("select");
db.id=qa.SYe;db.classList.add(fa,S.a.Jw?Ka:null,n.a.Ao,n.a.Bo);db.size=7;Z.appendChild(db);db=document.createElement("div");db.classList.add(Va);db.innerText=v.a.instance.ga(736);Z.appendChild(db);this.Mb.appendChild(Z);Z=document.createElement("div");Z.classList.add(K.a.IQe);db=document.createElement("div");db.classList.add(ta);db.style.direction="ltr";var Lb=document.createElement("span");Lb.classList.add(ka,n.a.Ao);const hc=document.createElement("span");hc.classList.add(n.a.qv,K.a.JQe);const Pc=
document.createElement("img");Pc.title=v.a.instance.nb(3);Pc.classList.add(n.a.FTe);Pc.src=ha.a.we(13);hc.appendChild(Pc);Lb.appendChild(hc);db.appendChild(Lb);Lb=document.createElement("span");Lb.id=qa.Fdd;Lb.classList.add(wa);db.appendChild(Lb);Lb=document.createElement("a");Lb.tabIndex=0;Lb.title=v.a.instance.ga(1036);Lb.classList.add(ja);db.appendChild(Lb);Lb=document.createElement("span");Lb.id=qa.Pac;db.appendChild(Lb);Z.appendChild(db);db=document.createElement("div");db.classList.add(bb);
db.id=qa.Edd;Z.appendChild(db);this.Mb.appendChild(Z)}else this.Mb.innerHTML=qa.tH();this.Of||(this.Nt(),this.isa());super.initialize();Z=Ia.DOMElementExtensions.nk(this.Mb,ta);this.rtl&&(Z.align="right",this.Svb.style.marginLeft="5px");this.Of&&(Z.style.padding="1px");this.functionInfoManager.JJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&(this.functionInfoManager.ucb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.uk(this.Tc));da.a.qc([this.Z2b,
this.FEb,this.Gyb,this.BKa,this.Vvb]);super.dispose()}Nt(){this.CKa=Ia.DOMElementExtensions.nk(this.Mb,ba);this.Eja=Ia.DOMElementExtensions.nk(this.Mb,fa);this.CKa.setAttribute(z.a.Ld,z.a.Z0b);this.BKa=new La.a(this.CKa,!0);this.Vvb=new La.a(this.Eja,!0);this.TYe=Ia.DOMElementExtensions.nk(this.Mb,Va);this.Svb=Ia.DOMElementExtensions.nk(this.Mb,ja);this.XYe=Ia.DOMElementExtensions.nk(this.Mb,wa);this.Kpf=Ia.DOMElementExtensions.nk(this.Mb,ka);this.UYe=$get(qa.Pac,this.Mb);this.Dja=Ia.DOMElementExtensions.nk(this.Mb,
bb);this.Of&&(this.Dja.style.paddingLeft="1px");this.functionInfoManager.DGa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Uj(this.Tc)}YQ(Z){this.$.da.$a(40,()=>{this.BKa.YQ(Z)})}uq(){this.Kvb?this.formulaAssistanceManager.Q7b():this.formulaAssistanceControl.set_visible(!1);super.uq();this.bld||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.CKa.disabled&&this.bld&&Ia.DOMElementExtensions.setFocus(this.CKa)}commit(){return!0}Grb(){let Z=this.faa.NameDataStrings;const db=
new x.a(-433697611,0,this.$.Hc,8,null);this.$.Ja.Kb(db,{[t.a.Jc]:Z})}Zsa(){this.Kvb?this.formulaAssistanceManager.Oda():this.formulaAssistanceControl.spb()}k4a(Z){this.Vvb.clear();const db=qa.Pac+" "+qa.Edd;for(let Lb=0,hc=Z.length;Lb<hc;++Lb){const Pc=this.Vvb.BY(Z[Lb].NameUI,Z[Lb].FunctionIndex.toString(),!1);S.a.Jw&&Pc.classList.add(aa);Pc.setAttribute(z.a.QP,qa.Fdd);Pc.setAttribute(z.a.JJ,db)}this.Vvb.selectedIndex=0}k2f(){if(this.faa){this.Svb.parentNode.className=K.a.KQe+(this.functionInfoManager.Shc(this.faa)?
"-udf":"");var Z=this.faa.NameDataStrings;this.XYe.innerText=Z;this.Svb.innerText=Z;this.Dja.innerText=this.faa.Help;Z=this.faa.Params.split(r.Qad);this.UYe.innerText=r.openParen+(1<Z.length?r.O8b:Z[0])+r.closeParen}}static tH(){return String.format("<div class='"+K.a.GQe+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+ea.a.zo+"'>{1}</div>\r\n<div class='"+K.a.FQe+"'>\r\n\t<select id='{16}' class='{17} "+n.a.Ao+" "+n.a.Bo+
"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+K.a.IQe+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+n.a.Ao+"'>\r\n\t\t\t<span class='"+n.a.qv+" "+K.a.JQe+"'>\r\n\t\t\t\t<img title='{3}' class='"+n.a.FTe+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
v.a.instance.ga(1034),v.a.instance.ga(1035),v.a.instance.ga(736),v.a.instance.nb(3),ha.a.we(13),v.a.instance.ga(1036),qa.Cdd,qa.Pac,7,ba,ja,Va,bb,wa,ka,ta,qa.SYe,fa+(S.a.Jw?" "+Ka:""),qa.Edd,qa.Fdd)}}qa.Pac="function_dialog_param_string";qa.Edd="function_dialog_function_description";qa.Fdd="function_dialog_function_name";qa.SYe="function_list";qa.Cdd="function_category";Object(d.a)(qa,"FunctionDeprecatedDialog",oa.a,[]);var rb=a(261),Za=a(22);class gb extends B.a{constructor(Z,db,Lb,hc){super(Z);
this.Tvb=db;this.formulaAuthoringHelper=Lb;this.P8f=hc;this.KIh=(Pc,Rc)=>{var xd;if(1===Pc){this.hide();Pc=this.Tvb.NameUI;for(Rc=null!==(xd=Rc.functionArgs)&&void 0!==xd?xd:[];1<Rc.length&&Za.a.Dh(Rc[Rc.length-1]);)Rc.pop();xd={[t.a.Jc]:Pc,["functionArgs"]:Rc,["ibdk"]:!0};Rc=new x.a(-433697611,0,this.$.Hc,8,null);this.$.Ja.Kb(Rc,xd)}else 2===Pc&&(this.hide(),xd=new x.a(753860909,0,this.$.Hc,8,null),this.$.Ja.Kb(xd))};this.AMh=Pc=>this.formulaAuthoringHelper.getFunctionParamByIndex(this.P8f,this.Tvb,
Pc);this.Pl=v.a.instance.ga(1032);this.gg()}get pc(){return"FunctionArgumentsDialog"}gg(){this.Rb=1;this.Oq={[rb.a.uu]:this.pc,["functionInfo"]:this.Tvb,["initialArgs"]:this.formulaAuthoringHelper.getMinimalParamArray(this.P8f,this.Tvb),["generateArgByIndex"]:this.AMh,["helpCallback"]:this.eW,["isModal"]:!1};this.initializeAndShow(this.Pl,this.KIh,this.Oq)}eW(){M(this.$,this.Tvb.HelpId,!1)}}Object(d.a)(gb,"FunctionArgumentsDialog",B.a,[]);class mb{constructor(Z,db,Lb){this.$=Z;this.Va=db;this.functionInfoManager=
Lb;this.OIh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.OIh.includes(this.menuId)&&this.frame.px(this.menuId)};this.zV=sa.a.zV(this.$);this.UAb=sa.a.ljf();this.zV&&(this.formulaAssistanceManager=this.$.da.za(464));this.PY={};this.frame=this.$.frame;this.functionInfoManager.DGa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=
Z.da.za(491)}nc(Z,db){switch(db){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return Z=J.h(this.$).Ai,Z.t6a||!Z.eb||0>=Z.text.length?!1:!0;default:return!1}}executeCommand(Z,db,Lb){var hc,Pc;Z=db.command;const Rc=J.h(this.$),xd=Rc.Ai;switch(Z){case 753860909:case -2060563418:null===(hc=this.formulaAssistanceManager)||
void 0===hc?void 0:hc.Q7b();Rc.inRangePicker&&xd.TE(!1);this.UAb?new N(this.$):(new qa(this.$,xd)).vg();this.formulaAssistanceTelemetryManager.c4a.dialogShownCounter++;break;case 1117706454:null===(Pc=this.formulaAssistanceManager)||void 0===Pc?void 0:Pc.Q7b();Rc.inRangePicker&&xd.TE(!1);const Wd=this.functionInfoManager.h2e(Lb[t.a.Jc]);hc=Za.a.SSf(Wd.Params).split("!")[0];const ue=""!==hc?hc.split(this.$.listSeparator).filter(we=>"..."!==we):[];l.TaskExtensions.TJ(m.GetServiceTaskFactory.Oa(this.$.da,
520,521,0),we=>{new gb(this.$,Wd,we.result,ue)},this.$.la,3);Lb.ibdk?this.formulaAssistanceTelemetryManager.c4a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.c4a.argsDialogOpenedByRibbonCounter++;break;case -433697611:hc=Lb.functionArgs;Lb.ibdk&&(void 0!==hc?this.formulaAssistanceTelemetryManager.c4a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.c4a.dialogCommitedCounter++);let ve=Lb[t.a.Jc]+r.openParen;this.UAb&&(void 0!==hc&&(ve+=hc.join(this.$.listSeparator)),
ve+=r.closeParen);Lb.UILocation&&this.$.Xc(-1075437823,-1,0,null);Rc.view.visibleArea.contains(Rc.fg(null))||Rc.Ht(Rc.ha.ra.activeCell,3,"FormulaAssistanceCommandHandler.ExecuteCommand");const qe=xd.textBox;Lb=xd.textBox.caretPosition;xd.eb&&xd.text?(hc=xd.text,Pc=Lb?hc.substring(0,Lb):"=",xd.text=Pc+ve+hc.substring(Lb+(qe.Oy?qe.Oy.length:0),hc.length),qe.caretPosition=Pc.length+ve.length):l.TaskExtensions.Aa(Rc.startEdit(!0,1),()=>{xd.text="="+ve;if(this.UAb)Rc.endEdit(!0,"FormulaAssistanceCommandHandler.ExecuteCommand");
else{const we=ve.length+1;qe.Ldb(we);qe.caretPosition=we}},this.$.la,11,X.a.current);Rc.Ul&&(Lb=Rc.Vb,Lb.text=qe.text,Lb.setCaretPosition(qe.caretPosition));this.zV?this.formulaAssistanceManager.Oda():(Lb=xd.b3.get(y.a.Uvb),null===Lb||void 0===Lb?void 0:Lb.XY(!1));break;case -1334919469:H(this.$,"154468",!1)}return W.Task.Ta(!0)}wc(Z,db){switch(db.command){case 753860909:case -2060563418:case -433697611:case -1334919469:return!0;case 1117706454:return this.UAb;default:return!1}}JJh(Z,db){db=this.Va.aq(db);
const Lb=this.Va.Ec();var hc=this.functionInfoManager.kcc(Z);if(!hc)return w.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),db.JC();const Pc=this.UAb?1117706454:-433697611;for(let Rc=0;Rc<hc.length;++Rc){const xd=hc[Rc].NameUI,Wd=this.Va.jQ(280,"Formulas."+Z+"MenuItem_"+hc[Rc].FunctionIndex.toString(),Pc,null,1,"None",0,0,xd,!1,0);Wd.label=xd;const ue=hc[Rc].Params.split(r.Qad);Wd.mS(xd+" "+(r.openParen+(1<ue.length?r.O8b:ue[0])+r.closeParen)+
"\n"+hc[Rc].Help);Lb.buttons.push(Wd)}Z=this.Va.Ec();hc=this.Va.jQ(280,"Formulas.MoreFunctionsMenuItem",-2060563418,n.a.XTe,3,"Image16by16",1033,0,"Formulas.MoreFunctionsMenuItem",!1,0);Z.buttons.push(hc);db.tc.push(Lb);db.tc.push(Z);return db.JC()}Kc(Z,db,Lb){Z=this.yTh(db);if(-1===Z)return!1;this.menuId=Lb.MenuId;if(!this.functionInfoManager.BV)return this.functionInfoManager.JJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;Z=this.functionInfoManager.Bdd[Z];this.PY[Z]=this.PY[Z]||
this.JJh(Z,Lb.MenuId);Lb.MenuItems=this.PY[Z];return!0}yTh(Z){switch(Z){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}}}
Object(d.a)(mb,"FormulaAssistanceCommandHandler",null,[223]);class Ga extends h.a{constructor(Z){super(Z)}ld(){const Z=m.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya),db=m.GetServiceTaskFactory.create(this.$.da,153,this.la,this.Ya);l.TaskExtensions.Aa(l.TaskExtensions.Ed([Z,db],this.la),()=>{this.Yc([new mb(this.$,Z.result,db.result)])},this.la,3)}static ka(Z){h.a.Nd(92,new Ga(Z))}}Object(d.a)(Ga,"FormulaAssistanceCommandHandlerFactory",h.a,[]);var ib=a(222);class cc{constructor(Z,db){this.DKa=
this.sva=this.yja=null;this.xFf=(Lb,hc)=>{this.U9i(hc.functionName,hc.Jdd)};this.zFf=(Lb,hc)=>{this.T9i(hc.Jdd,hc.EPd,hc.x_i)};this.yFf=(Lb,hc)=>{Lb=[];for(var Pc of hc.EPd)(!this.fxa||void 0!==Pc&&null!==Pc)&&(hc=Pc.trim())&&Lb.push(hc);if(!this.fxa||Lb.length){Pc="";for(hc=0;hc<Lb.length;hc++){const Rc=this.x_c(Lb[hc]),xd=cc.lGd(hc,Lb.length);Pc+=Rc+xd;xd&&(Pc+=this.ariaLiveNotifier.rya)}this.ariaLiveNotifier.readText(Pc)}};this.AFf=(Lb,hc)=>{this.ariaLiveNotifier.W9i(hc.qG,hc.description,hc.selectedIndex.toString(),
hc.length.toString())};this.tFf=(Lb,hc)=>{this.ariaLiveNotifier.qQf(hc.description,hc.length)};this.HBf=()=>{this.ariaLiveNotifier.Sbb(v.a.instance.ga(883),z.a.fHa)};this.ABf=()=>{this.ariaLiveNotifier.readText(v.a.instance.ga(884))};this.DBf=()=>{this.ariaLiveNotifier.readText(v.a.instance.ga(885))};this.$=db;this.ariaLiveNotifier=Z;this.$.da.Ga(219,this);this.fxa=sa.a.g5(db)}dispose(){this.F_d();this.DKa=this.sva=this.yja=null}SYc(Z){Z&&(this.yja=Z,this.yja.zqe(this.xFf),this.yja.sre(this.zFf),
this.fxa&&this.yja.rre(this.yFf))}TYc(Z){Z&&(this.sva=Z,this.fxa&&(this.sva.xqe(this.HBf),this.sva.vqe(this.ABf)),this.sva.wqe(this.DBf))}UYc(Z){Z&&(this.DKa=Z,this.DKa.UWc(this.AFf),this.DKa.K_b(this.tFf))}F_d(){var Z,db,Lb;this.yja&&(this.yja.xUf(this.xFf),this.yja.WUf(this.zFf),this.fxa&&this.yja.VUf(this.yFf));this.DKa&&(this.DKa.PLd(this.AFf),this.DKa.tuc(this.tFf));this.fxa&&(null===(Z=this.sva)||void 0===Z?void 0:Z.wUf(this.HBf),null===(db=this.sva)||void 0===db?void 0:db.uUf(this.ABf));null===
(Lb=this.sva)||void 0===Lb?void 0:Lb.vUf(this.DBf)}U9i(Z,db){if(db){let Lb="";this.fxa||(Lb+=v.a.instance.nb(57)+this.ariaLiveNotifier.rya);for(let hc=0;hc<db.length;hc++)Lb+=Z+this.ariaLiveNotifier.rya+this.x_c(db[hc])+cc.lGd(hc,db.length);this.fxa&&(Lb+=v.a.instance.ga(882)+this.ariaLiveNotifier.rya);this.ariaLiveNotifier.readText(Lb)}}T9i(Z,db,Lb){if(Z){let Pc="",Rc=0;if(db){for(let xd=0;xd<db.length;xd++){if(Lb>=Z[xd].split(this.$.listSeparator).length){Rc++;continue}var hc=db[xd].trim();if(!hc)return;
hc=this.x_c(hc);const Wd=cc.lGd(xd-Rc,db.length-Rc);Pc+=hc+Wd;Wd&&(Pc+=this.ariaLiveNotifier.rya)}this.ariaLiveNotifier.readText(Pc)}}}x_c(Z){if(!Z)return"";var db=Z.split(this.$.listSeparator);Z="";for(const Lb of db){if(cc.Jpd(Lb))Z+=Lb;else{const hc=(db=cc.ooi(Lb))?Lb.replace("[","").replace("]",""):Lb;Z+=String.format(db?v.a.instance.nb(59):v.a.instance.nb(58),hc)}Z+=this.ariaLiveNotifier.rya}return Z}static lGd(Z,db){return Z>=db||1===db?(w.ULS.shipAssertTag(537161997,0,Z<db,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),
""):String.format(v.a.instance.nb(55),Z+1,db)+"\r\n"}static Jpd(Z){return Za.a.contains(Z,r.O8b,!0)}static ooi(Z){return Z.trimStart().startsWith(r.zJf)||Z.trimEnd().endsWith(r.yJf)}}Object(d.a)(cc,"FormulaAssistanceReadoutHandler",null,[343,2]);class ic extends ib.a{constructor(Z){super();this.$=Z;this.Fb()}create(){const Z=this.$.da;l.TaskExtensions.Aa(m.GetServiceTaskFactory.Oa(Z,211,212,this.Ya),db=>{db=Z.za(219)||new cc(db.result,this.$);this.ob(db)},this.la,3)}static ka(Z){Z.da.Ga(220,new ic(Z))}}
Object(d.a)(ic,"FormulaAssistanceReadoutHandlerFactory",ib.a,[]);var xb=a(640),Vb=a(111),wb=a(979),cb=a(58),lb=a(42),Y=a(116);class Oa{constructor(){this.GRa={}}Eid(Z){return this.GRa&&Z in this.GRa?this.GRa[Z]:null}Y$f(Z,db){this.GRa||(this.GRa={});this.GRa[Z]=db}i_(){this.GRa=null}}Object(d.a)(Oa,"FormulaAssistanceContextualPreviewCache",null,[]);var Wa=a(60);const Ca=(Z,db,Lb,hc,Pc,Rc,xd=null)=>{xd=Z.Na(1,xd);xd.getPartialCalcResultsParameters=db;return Wa.g(Z,"GetPartialCalcResults",xd,Lb,hc,
Pc,Rc,4)};class Ra{constructor(Z){this.vDi=30;this.calcManager=null;this.Cd=!1;this.TPa=this.yHb=this.Vab=null;this.Ay=()=>{this.Mha.i_()};this.$=Z;this.Mha=new Oa;this.XWf=-1;this.$.ea.JE(this.Ay)}dispose(){this.Cd||(this.$&&(this.$.ea.$D(this.Ay),this.$=null),this.Mha=this.yHb=null,this.Cd=!0)}dfd(Z,db,Lb,hc){if(db&&0>=db.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!Z)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");
this.calcManager=this.$.da.za(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");let Pc="="+db.substring(Lb.start,Lb.end);pa.EwaSettings.ma(583)&&(Pc=this.calcManager.y1h(J.h(this.$).ha.ra.activeCell,Z,Lb));const Rc=this.GPh(Pc,Lb);if(pa.EwaSettings.ma(583)){if(Rc&&!this.calcManager.isFormulaSubExpressionVolatile(Z))return Promise.resolve(Rc)}else if(Rc)return Promise.resolve(Rc);return this.IPh(Pc,Lb).then(xd=>{if(this.z1c(hc))throw Error.create("OperationCanceledException");
if(!xd||xd.Olj||xd.yna.startsWith("##UNSUPPORTED:"))return this.D0e(db,Pc,Lb,hc);this.Mha.Y$f(Pc,xd.yna);return Promise.resolve(xd)})}GPh(Z,db){return(Z=this.Mha.Eid(Z))?new wb.a(Z,db.start,db.end,0):null}IPh(Z,db){if(!Z||0>=Z.length||!db)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.zYg(J.h(this.$).ha.ra.activeCell,Z,this.vDi,db)}D0e(Z,db,Lb,hc){if(!Z||0>=Z.length||!db||0>=db.length||!Lb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.TPa)return this.HPh(Z,db,Lb,hc);const Pc={};Pc.PartialFormula=db;Pc.Formula=Z;Pc.SourceRange=lb.v(J.h(this.$).ha.ra.activeCell,this.$);return this.TPa=new Promise((Rc,xd)=>{this.yHb=new xb.a;this.XWf=this.$.ea.ze;this.Vab=Ca(this.$.pa.ya,Pc,Wd=>{this.mYi(db,Lb,hc,Wd,Rc,xd)},Wd=>{this.Vab=this.TPa=null;xd(Wd)},null,null,null);this.yHb.token.register(()=>{this.f_g(xd)})})}mYi(Z,db,Lb,hc,Pc,Rc){this.Vab=this.TPa=null;if(this.XWf!==this.$.ea.ze)Rc(Error.create("OperationCanceledException"));else if(hc.Result)if(hc=
cb.a.li(hc.Result),!hc||Vb.a.isEmpty(hc))Pc(null);else{for(let xd in hc)this.Mha.Y$f(xd,hc[xd]);this.z1c(Lb)?Rc(Error.create("OperationCanceledException")):(Z=this.Mha.Eid(Z))?(""===Z&&(Z=" "),Pc(new wb.a(Z,db.start,db.end,0))):Rc(Error.create("SubexpressionNotFoundException"))}else Pc(null)}HPh(Z,db,Lb,hc){return new Promise((Pc,Rc)=>{this.TPa.then(()=>{this.JXf(Z,db,Lb,hc,Pc,Rc)}).catch(()=>{this.JXf(Z,db,Lb,hc,Pc,Rc)})})}JXf(Z,db,Lb,hc,Pc,Rc){if(this.z1c(hc))Rc(Error.create("OperationCanceledException"));
else{const xd=this.Mha.Eid(db);xd?Pc(new wb.a(xd,Lb.start,Lb.end,0)):this.D0e(Z,db,Lb,hc).then(Wd=>{Pc(Wd)}).catch(Wd=>{Rc(Wd)})}}f_g(Z){this.Vab&&(Y.a.Ru(this.Vab.lu)?(this.TPa=this.Vab=null,Z(Error.create("PendingWebReqeuestCancelled"))):w.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}i_(){this.g_g();this.Mha&&this.Mha.i_()}g_g(){this.yHb&&this.yHb.cancel()}z1c(Z){return this.Cd||Z.EK}}Object(d.a)(Ra,"FormulaAssistanceContextualPreviewCalculator",null,[2]);var la=
a(157),ua=a(212);class xa{}xa.Yth="ewa-facp-text-box";Object(d.a)(xa,"CssClassNames",null,[]);class fb{constructor(Z){this.Uqa=this.WTa=this.c3a=this.iQ=this.W$=this.Za=null;this.Pkd=!1;this.Lc=Z}dispose(){(this.W$||this.iQ)&&this.Saf();this.Za=this.Uqa=null}AVj(Z,db,Lb,hc){Z&&db&&hc&&db.yna&&!(1>db.yna.length)&&(this.Za=Z,this.xTf(),this.c3a=db,this.WTa=hc,this.QDj(db,Lb,hc))}Saf(){this.n$h();this.xTf();this.WTa=this.c3a=null}QDj(Z,db,Lb){if(Z.yna&&!(1>Z.yna.length)){var hc=this.Lc.da.za(266);if(hc){var Pc=
hc.LVh();Pc&&l.TaskExtensions.Aa(this.nDb,()=>{if(db)if(pa.EwaSettings.ma(583)&&this.Za.eb&&0<Lb.length){this.Ryb(Z.zKa,Lb[0].start,null);var Rc=this.P6e(Lb[0],Pc),xd=this.Za.text.substring(Lb[0].start,Lb[0].end).trim();xd=this.Za.text.indexOf(xd);xd=this.Za.text.substring(0,xd).lastIndexOf("\n");this.Ryb(0>xd||1>=Lb.length?Lb[0].start:xd+1,Lb[0].end,Rc?String.format(Rc,.3):null);for(var Wd=1;Wd<Lb.length;Wd++)Rc=this.P6e(Lb[Wd],Pc),xd=this.Za.text.substring(Lb[Wd].start,Lb[Wd].end).trim(),xd=this.Za.text.indexOf(xd),
xd=this.Za.text.substring(Lb[Wd-1].end,xd).lastIndexOf("\n"),this.Ryb(0>xd?Lb[Wd-1].end:xd+1+Lb[Wd-1].end,Lb[Wd].end,Rc?String.format(Rc,.3):null);xd=this.Za.text.substring(Lb[Lb.length-1].end,Z.uva).indexOf("\n");this.Ryb(0>xd?Lb[Lb.length-1].end:xd+1+Lb[Lb.length-1].end,Z.uva,null);w.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.Ryb(Z.zKa,Z.uva,null),w.ULS.sendTraceTag(537162060,
0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.W$||(this.W$=document.createElement(ua.a.div),this.Za.textBox.domElement.appendChild(this.W$));this.iQ||(this.iQ=document.createElement(ua.a.div),this.iQ.className=xa.Yth,this.Lc.domElement.appendChild(this.iQ));Rc=Z.uva;pa.EwaSettings.ma(583)&&this.Za.eb&&Lb&&0<Lb.length&&Lb[0].start<Rc&&Lb[0].start!==Z.zKa&&!this.Za.textBox.Oy.length&&(Rc=Lb[0].start);
Wd=Za.a.contains(this.Za.textBox.Le.id,"FormulaBar",!0)&&Za.a.contains(this.Za.text.substring(Z.zKa,Z.uva),"\n",!0);xd=this.Za.eb?this.Za.textBox.caretPosition:0;Rc=excelOnline.utils.getBoundingRectForText(this.Za.textBox.Le,Wd?xd:Z.zKa,Wd?xd:Rc,pa.EwaSettings.ma(583));this.iQ.style.left=D.HelperMethods.uc(Rc.left);this.iQ.style.top=D.HelperMethods.uc(Rc.top);this.iQ.style.width=D.HelperMethods.uc(Rc.width);this.iQ.style.height=D.HelperMethods.uc(Rc.height);dialogControls.renderToolTip(this.W$,`FormulaAssistancePreviewToolTip_${Z.uva}_${Z.uva}`,
Z.yna,this.iQ,0,!1,!1,1)},this.Lc.la,3)}}}P6e(Z,db){const Lb=this.Za.text;var hc=Lb.substring(Z.start,Z.end);hc=hc.trim();Z=Lb.indexOf(hc,Z.start);db=Lb.indexOf(db,Z);hc=Lb.substring(Z,db);hc=hc.trim();return this.Za.colors.getItem(Z+"-"+(Z+hc.length))}n$h(){this.Za&&this.W$&&this.iQ&&l.TaskExtensions.Aa(this.nDb,()=>{this.Za.textBox.domElement.contains(this.W$)&&(dialogControls.clearToolTip(this.W$),this.Za.textBox.domElement.removeChild(this.W$),this.W$=null);this.Lc.domElement.contains(this.iQ)&&
(this.Lc.domElement.removeChild(this.iQ),this.iQ=null)},this.Lc.la,3)}Ryb(Z,db,Lb){!this.Za||Z>=db||(this.Za.textBox.formatText(Z,db-Z,{["background"]:Lb||"#E3DDCC"}),this.Pkd=!0)}xTf(){if(this.Za&&this.c3a&&this.Pkd){var Z=this.c3a.uva;pa.EwaSettings.ma(583)&&0<this.WTa.length&&this.WTa[this.WTa.length-1].end>Z&&(Z=this.WTa[this.WTa.length-1].end);this.Za.textBox.formatText(this.c3a.zKa,Z-this.c3a.zKa,{["background"]:!1});this.Pkd=!1}}get nDb(){if(this.Uqa)return this.Uqa;const Z=new la.a;this.Lc.ky(db=>
{l.TaskExtensions.Aa(db.yvd(),()=>{Z.setResult(!0)},this.Lc.la,3)});return this.Uqa=Z.task}}Object(d.a)(fb,"FormulaAssistanceContextualPreviewControl",null,[2]);var Jb=a(83),Ob=a(47),eb=a(46);class Ma{constructor(Z){this.i8=0;this.gdd=Z}r7f(Z,db,Lb){Lb?this.bah(Z,db,Lb):this.W8e(Z,db,Lb,!0)}pkj(){this.i8=0}bah(Z,db,Lb){this.i8++;const hc=this.i8;Ob.a.instance.create(()=>{this.W8e(Z,db,Lb,hc===this.i8)},500,eb.a.OHh,!0,!0)}W8e(Z,db,Lb,hc){const Pc=this.gdd.dfd(Z,db);Pc&&Pc.then(Rc=>{hc&&this.gdd.uqd(db)&&
this.gdd.zVj(Z,Rc,Lb)}).catch(Rc=>{Rc=Object(Jb.a)(Error,Rc);"OperationCanceledException"===Rc.message?w.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${Rc}`):w.ULS.sendTraceTag(537162058,0,10,`GetContextualFormulaPreviewResults - caught exception: ${Rc}`)})}}Object(d.a)(Ma,"FormulaAssistanceContextualPreviewHoverManager",null,[]);var va=a(173);class Pa{constructor(Z){this.Msb=this.Kha=this.calcManager=this.Za=null;this.M$a=()=>{this.Y5a(!1,!1)};this.$=Z;
this.Jvb=new fb(Z);this.Eac=new Ra(Z);this.Fac=new Ma(this);J.h(Z).Vb.Rm(this.M$a);this.$.da.Ga(317,this)}dispose(){this.y0c();da.a.qc([this.Jvb,this.Eac]);this.Fac=this.Eac=this.Jvb=null;this.$&&J.h(this.$).Vb.em(this.M$a);this.Kha=this.Za=this.$=null}RDj(Z,db){db&&va.f(db.text)&&!(db.qxa||db.textBox.Oy||this.Za&&this.Za.textBox.Oy)&&(this.Za=db,this.calcManager=this.$.da.za(266))&&(w.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),
Z=D.HelperMethods.swb(Z),Z=this.calcManager.v1h(J.h(this.$).ha.ra.activeCell,this.Za.text,Z.x,Z.y),db=this.calcManager.getSubExpressionSpan(Z),!db||db.end<=db.start||this.uqd(db)||(this.Kha=db,this.Fac.r7f(Z,db,!0)))}tUd(Z){if(Z&&va.f(Z.text))if(Z.textBox.Oy&&Z.textBox.Oy.trim()){if(this.Za=Z,this.calcManager=this.$.da.za(266)){w.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");Z={};var db=
this.Za.textBox.Oy.trim();Z.start=this.Za.text.indexOf(db,this.Za.textBox.caretPosition);Z.end=Z.start+db.length;(db=this.calcManager.getFormulaSubExpressionObject(J.h(this.$).ha.ra.activeCell,this.Za.text,this.Za.textBox.Oy))&&!this.uqd(Z)&&(this.Kha=Z,this.Fac.r7f(db,Z,!1))}}else this.Y5a(!1,!0)}Y5a(Z,db){!this.Za||db&&this.Za.textBox.Oy||(this.Kha=null,Z&&(this.y0c(),this.Eac.i_(),this.Fac.pkj()),this.Jvb&&this.Jvb.Saf(),this.Za.qxa||(this.Za.qxa=!1,this.Za=null))}dfd(Z,db){if(!this.Za||this.Za.qxa)return null;
this.y0c();this.Msb=new xb.a;return this.Eac.dfd(Z,this.Za.text,db,this.Msb.token)}zVj(Z,db,Lb){this.Msb=null;!Z||!db||!db.yna||0>=db.yna.length?this.Y5a(!1,!1):(Z=this.calcManager.w1h(J.h(this.$).ha.ra.activeCell,Z,this.Za.text),this.Jvb.AVj(this.Za,db,Lb,Z))}uqd(Z){return this.Kha?Z.start===this.Kha.start&&Z.end===this.Kha.end&&Z.pre===this.Kha.pre&&Z.post===this.Kha.post:!1}y0c(){this.Msb&&this.Msb.cancel()}}Object(d.a)(Pa,"FormulaAssistanceContextualPreviewManager",null,[442,2,443]);var Ha=a(7),
tb=a(4),Ya=a(224),V=a(14),za=a(187),yb=a(1090),jc=a(70),Cc=a(775),Sa=a(31),na=a(24),jb=a(64),Ib=a(283),dc=a(247),ob=a(162);class Fa{constructor(Z=!1){this.hT=0;this.Qae=!1;this.NWa=this.qce=null;this.Wwg=Z;this.textEdit=null}X2f(Z){this.hT=0;this.Qae=Z.IsCompatibility;this.set_name(Z.NameDataStrings);this.NWa=Z.Help}puj(Z){this.hT=1;this.set_name(Z.Name)}Stj(Z){this.hT=2;this.set_name(Z.name);this.NWa=Z.tooltip}tvj(Z){this.hT=3;this.set_name(Z.name);this.NWa=Z.toolTip}t4f(Z){this.hT=4;this.set_name(Z.name)}Lxj(Z){this.hT=
5;this.set_name(Z.name);this.NWa=Z.toolTip}Kxj(Z){this.hT=7;this.set_name(Z.name)}jwj(){this.hT=6;this.set_name(v.a.instance.nb(192));this.NWa=v.a.instance.nb(193)}get itemType(){return this.hT}get Vji(){return this.Qae}get name(){return this.label}set_name(Z){return this.qce=Z}get label(){return this.qce}get Dja(){return this.NWa}get DBb(){return this.Wwg}static weh(){return Object(Ha.a)(new Fa(!0),{})}}Object(d.a)(Fa,"AutoCompleteItem",null,[472]);class Ab{constructor(){this.sheetName=this.namedRange=
this.tooltip=this.name=null;this.type=0}}Object(d.a)(Ab,"DefinedNameInfo",null,[]);var $b=a(186);class Cb{constructor(Z){this.tKe={};this.$=Z}get sKe(){const Z=[];if(!this.$.Cb||!this.$.Cb.items)return Z;let db=0;const Lb=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&sa.a.zV(this.$);for(const hc of this.$.Cb.items)if(hc&&(3===hc.type&&hc.usedRange||Lb&&2===hc.type)){const Pc=new Ab;Pc.tooltip=hc.sheetName+jc.a.exclamation+hc.usedRange.toString();Pc.name=
hc.name;Pc.namedRange=this.i8g(hc.usedRange);Pc.sheetName=hc.sheetName;Pc.type=this.a8g(hc.type);Z.push(Pc);this.tKe[hc.name.toUpperCase()]=Pc;++db;if(db===r.Ytf){w.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${r.Ytf}`);break}}return Z}SRj(Z){var db=this.tKe[Z.toUpperCase()];if(!db)return{returnValue:!1,sheetName:"",range:null};Z=db.sheetName;db=this.S7g(db.namedRange);return{returnValue:!0,sheetName:Z,range:db}}i8g(Z){if(null!=Z&&void 0!=Z)return{top:Z.top,
left:Z.left,bottom:Z.bottom,right:Z.right,maxRows:Z.maxRows,maxColumns:Z.maxColumns,sheetName:void 0}}S7g(Z){if(null!=Z&&void 0!=Z)return new $b.a(Z.top,Z.left,Z.bottom,Z.right,Z.maxRows,Z.maxColumns)}a8g(Z){switch(Z){case 2:return 0;case 3:return 1;default:return-1}}}Object(d.a)(Cb,"DefinedNameInfoManager",null,[]);var Rb=a(128),uc=a(263),nb=a(260),Fb=a(238);class Jc extends Sys.EventArgs{constructor(Z,db){super();this.functionName=Z;this.Jdd=db}}Object(d.a)(Jc,"FormulaAssistanceFunctionChangedEventArgs",
Sys.EventArgs,[]);class Fc extends Sys.EventArgs{constructor(Z){super();this.EPd=Z}}Object(d.a)(Fc,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class zb extends Sys.EventArgs{constructor(Z,db,Lb){super();this.Jdd=Z;this.EPd=db;this.x_i=Lb}}Object(d.a)(zb,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var hb=a(259);class Pb{constructor(Z,db,Lb,hc,Pc=null){this.Uka=this.l0c=!1;this.$=Z;this.formulaAssistanceUIControl=db;this.zYe=Lb;this.Xpj=hc;this.n9e=
Pc;this.Uka=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get Gf(){return this.l0c}set Gf(Z){this.l0c!==Z&&(Z?hb.a(this.$).ai(this):hb.a(this.$).Xz(this),this.l0c=Z)}get de(){return this.Xpj}get mc(){return this.formulaAssistanceUIControl.getRootElement(this.zYe)}kg(Z,db){Z=!1;db||(J.h(this.$).Ai.textBox.GF=!0,Z=this.formulaAssistanceUIControl.focus(this.zYe));return Z}mh(Z){const db=this.mc;return!(void 0===db||null===db)&&Ia.DOMElementExtensions.yf(db,Z)}sj(){this.n9e&&
this.n9e();if(this.Uka){const Z=J.h(this.$).Ai.textBox;this.selection=Z.selection;Z.removeSelection()}}Zj(){this.Uka&&(J.h(this.$).Ai.textBox.selection=this.selection)}dispose(){hb.a(this.$).Xz(this)}}Object(d.a)(Pb,"FormulaAssistanceFocusManager",null,[36,2]);var ud=a(38),Ub=a(371),Ac=a(188),Ic=a(35),dd=a(282),Ud=a(281),Hd=a(910);class me extends ud.a{constructor(Z,db){super();this.Dug=[];this.Mdd={};this.Ndd={};this.dT=null;this.g9=[];this.EKa={};this.dCf=(Lb,hc)=>{w.ULS.sendTraceTag(537161987,
0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.PBf(Lb,!!hc&&1!==hc.FilterType,!0)};this.cCf=()=>{w.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.dT=null};this.MBf=Lb=>{w.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.PJd(Lb.Fja,!0,!1)};this.bCf=Lb=>{w.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");
this.PBf(Lb,!0,!1)};this.BMc=this.DMc=!1;this.jb=Z;this.pluginScheduler=db;this.$.da.Ga(19,this)}DGa(Z){this.addHandler("FunctionInfoLoaded",Z)}ucb(Z){this.removeHandler("FunctionInfoLoaded",Z)}qKg(Z){this.addHandler("FunctionInfoReset",Z)}Efj(Z){this.removeHandler("FunctionInfoReset",Z)}get BV(){return this.DMc}get Qli(){return this.BMc}get Qac(){var Z=this.dT,db=Hd.a(this.$);if(!db)return Z;db=db.NSh();const Lb=db.length;if(0>=Lb)return Z;const hc=[];hc.push(...Z);for(Z=0;Z<Lb;Z++){const Pc=db[Z],
Rc={};Rc.FunctionIndex=hc.length;Rc.HelpId=Rc.GroupUI=null;Rc.Help=Pc.description;Rc.IsCommonlyUsed=Rc.IsCompatibility=!1;Rc.NameDataStrings=Pc.name;Rc.NameUI=Pc.name;Rc.Params=null;Rc.ParamsHelp=null;hc.push(Rc)}return hc}get Bdd(){return this.g9}get $(){return this.jb}dispose(){const Z=this.$.da.za(268);Z&&Z.xLd(this.MBf);this.jb=null;super.dispose()}pXf(){this.raiseEvent("FunctionInfoReset")}cNd(){this.pXf();this.DMc=!1;this.dT=null;this.BMc=!0}JJa(Z,db=!1){if(this.BV)this.WOf();else{w.ULS.sendTraceTag(537161991,
0,50,`Retrieving the list of function names for culture '${this.$.va.UICultureTag}' from the server.`);let hc=null;(hc=this.$.da.za(268))||w.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===hc||void 0===hc?0:hc.Fja)&&0<hc.Fja.length)pa.EwaSettings.ma(121)?hc.rHh(this.bCf):this.PJd(hc.Fja,!0,!1);else{var Lb=this.$.pa.ya.Wb();Z&&(this.$.ea.Zb||db)&&!this.Qli&&(db?Ub.a(this.$.userOperationManager,(Pc,Rc,xd)=>Wa.o(this.$.pa.ya,Z,Ud.b(Pc,this.dCf),Ud.a(Rc,this.cCf),
xd,Z,Lb),Pc=>new Ac.a(130,0,Pc,16),null):Wa.o(this.$.pa.ya,Z,this.dCf,this.cCf,null,Z,Lb));!this.BV&&this.$.ea.Zb&&(hc?(w.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.BV}, IsSessionActive=${this.$.ea.Zb}`),hc.yqe(this.MBf)):(w.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),Wa.o(this.$.pa.ya,{FilterType:0},this.bCf,null,null,
null,Lb),this.BMc=!1))}}}zTh(Z){return 0>Z||Z>=this.dT.length?null:this.dT[Z]}igd(Z){return Ic.a.Dc(this.Mdd,Z.toUpperCase())}h2e(Z){return Ic.a.Dc(this.Ndd,Z.toUpperCase())}kcc(Z){return Ic.a.Dc(this.EKa,Z)}Shc(Z){return!Z.GroupUI}PBf(Z,db,Lb){const hc=dd.a(Z);w.ULS.sendTraceTag(537161955,0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${hc}`);hc?(J.h(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.Qo(Z.Errors)):(this.PJd(Z.Result,
db,Lb),sa.a.AV(this.$)&&!sa.a.zV(this.$)&&this.SXj())}PJd(Z,db,Lb){w.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${Z.length}, isCategorized = ${db}, partialResult = ${Lb} IsFullyLoaded = ${this.BV}`);this.BV||(this.dT=Z,this.nVg(db),this.DMc=!Lb,this.WOf())}WOf(){this.raiseEvent("FunctionInfoLoaded")}SXj(){const Z=this.Qac;this.pluginScheduler.notifier().setFunctionsInfo(Z);w.ULS.sendTraceTag(512278604,0,50,`FuntionInfoManager.updateSchedulerFunctionArgumentAssistanceList update functions info with ${null===
Z||void 0===Z?void 0:Z.length} functions}`)}nVg(Z){var db=v.a.instance.ga(1029),Lb=[];this.EKa={};this.g9=[];this.EKa[db]=Lb;const hc=v.a.instance.ga(1030),Pc=[];this.g9.push(db);this.g9.push(hc);for(let xd=0,Wd=this.dT.length;xd<Wd;xd++){db=this.dT[xd];db.IsCompatibility||Pc.push(db);var Rc=db.NameUI;const ue=db.NameDataStrings;this.Mdd[ue.toUpperCase()]||(this.Mdd[ue.toUpperCase()]=db);this.Ndd[Rc.toUpperCase()]||(this.Ndd[Rc.toUpperCase()]=db);if(!this.Shc(db)){if(Z){Rc=db.GroupUI;let ve=Ic.a.Dc(this.EKa,
Rc);ve||(ve=[],this.EKa[Rc]=ve,this.g9.push(Rc));ve.push(db)}db.IsCommonlyUsed&&Lb.push(db);db.IsCompatibility||this.Dug.push(ue)}}this.EKa[hc]=Pc;Z&&(me.MSf(Lb,[2,3,0,5,4,9,1,7,8,6]),Lb=Array(14),Lb[0]=0,Lb[1]=1,Lb[2]=7,Lb[3]=11,Lb[4]=5,Lb[5]=2,Lb[6]=6,Lb[7]=10,Lb[8]=9,Lb[9]=3,Lb[10]=4,Lb[11]=13,Lb[12]=12,Lb[13]=8,me.MSf(this.g9,Lb),Lb=[],Lb.push(...this.g9),Lb.splice(13,1),this.g9=Lb);Lb=(xd,Wd)=>xd.NameUI.localeCompare(Wd.NameUI);this.dT=[...this.dT];this.dT.sort((xd,Wd)=>xd.NameDataStrings.localeCompare(Wd.NameDataStrings));
for(let xd=1,Wd=this.g9.length;xd<Wd&&Z;xd++)this.EKa[this.g9[xd]].sort(Lb);for(let xd=0,Wd=this.dT.length;xd<Wd;xd++)this.dT[xd].FunctionIndex=xd}static MSf(Z,db){const Lb=[...Z];for(let hc=0;hc<Lb.length&&hc<db.length;hc++)Z[hc]=Lb[db[hc]]}}Object(d.a)(me,"FunctionInfoManager",ud.a,[341,342,2]);var xe=a(239),Ke=a(94),vd=a(49),Qe=a(706);class bc extends Ke.a{constructor(Z,db,Lb,hc=null){super(Z,hc);this.b4=null;this.mOb=this.bXd=!1;this.offsetParent=this.Z7=this.D2a=null;this.$Kc=!1;this.lCd=Pc=>
this.H6(Pc);this.kCd=Pc=>this.YN(Pc);this.HAf=Pc=>{const Rc=D.HelperMethods.Eo(Pc);Rc.button===Sys.UI.MouseButton.leftButton&&2===Pc.tb&&(this.Spd(Rc.target)||this.JTa(Rc));return!1};this.r8d=db;Lb&&(this.bXd=!0,xe.a.instance.ta(V.a.pointerDown,this.ZMe,this.HAf));this.Cfa=!1}get A8b(){return this.Cfa}get ZMe(){return this.r8d}get j9h(){return this.$Kc}dispose(){this.bXd&&(xe.a.instance.Ba(V.a.Jj,this.ZMe,this.HAf),this.bXd=!1);this.mOb&&(this.mOb=!1,xe.a.instance.Ba(V.a.Qf,this.domElement.ownerDocument.body,
this.lCd),xe.a.instance.Ba(V.a.Jj,this.domElement.ownerDocument.body,this.kCd));this.b4=this.r8d=null;super.dispose()}yoe(Z){this.b4?this.b4.push(Z):this.b4=[Z]}Spd(Z){if(this.b4)for(let db=0,Lb=this.b4.length;db<Lb;++db)if(Ia.DOMElementExtensions.yf(this.b4[db],Z))return!0;return!1}JTa(Z){this.A8b||(this.Cfa=!0,Za.a.equals(this.domElement.currentStyle.position,"absolute",!0)||(this.domElement.style.position="absolute"),this.Fqh(),xe.a.instance.ta(V.a.Qf,this.domElement.ownerDocument.body,this.lCd),
xe.a.instance.ta(V.a.Jj,this.domElement.ownerDocument.body,this.kCd),this.mOb=!0,this.drag(!0,Z))}drag(Z,db){ra.g(db);var Lb=new vd.a(0,0),hc=new Sys.UI.Point(db.clientX,db.clientY);db=this.domElement.parentNode;hc=Qe.a.Us(Lb,db,hc,this.isRtl());Z?(Lb=Qe.a.xF(Lb,db,this.domElement,this.isRtl()),this.D2a=Qe.a.gE(hc,Lb),this.Z7=hc,this.$Kc=!1):!this.j9h&&this.f9h(hc,this.Z7)&&(this.$Kc=!0);Lb=Qe.a.gE(hc,this.D2a);Qe.a.Odb(db,this.domElement,Lb,this.isRtl(),Z)}xw(Z){this.mOb&&(this.mOb=!1,xe.a.instance.Ba(V.a.Qf,
this.domElement.ownerDocument.body,this.lCd),xe.a.instance.Ba(V.a.Jj,this.domElement.ownerDocument.body,this.kCd));ra.g(Z);this.Cfa=!1;this.Z7=this.D2a=null}H6(Z){const db=D.HelperMethods.Eo(Z);db.button===Sys.UI.MouseButton.leftButton&&2===Z.tb&&this.xw(db);return!1}YN(Z){2===Z.tb&&this.drag(!1,D.HelperMethods.Eo(Z));return!1}f9h(Z,db){return db.x<Z.x-2||db.x>Z.x+2||db.y<Z.y-2||db.y>Z.y+2}Fqh(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;Ia.DOMElementExtensions.getLocation(this.offsetParent)}}
Object(d.a)(bc,"BaseDraggableBehavior",Ke.a,[]);class Zc extends bc{constructor(Z,db,Lb=null,hc=!1){super(Z,db,!1,Lb);this.MSa(hc);this.pj=Za.a.equals("rtl",Z.dir,!0)}setVisible(Z){Ia.DOMElementExtensions.setVisible(this.domElement,Z);Z||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.pj}MSa(Z){const db=this.domElement.style;db.cursor="move";db.position=Z?"relative":"absolute"}}Object(d.a)(Zc,"FunctionParamBoxDraggableItem",bc,[]);class gd{constructor(){this.onDismissClick=
this.onFeedback=this.onHelpLink=this.onIsExpandedChange=this.onCardModeChange=null}}Object(d.a)(gd,"FormulaArgumentAssistanceCallbacks",null,[]);class Sc{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0;this.showCollapseText=this.isExpanded=!1}}Object(d.a)(Sc,"FormulaArgumentAssistanceRenderingInfo",null,[]);var Gd=a(85),Vd=a(107),Ed=a(152);class Od{constructor(Z){this.Bt=Z;this.tB=this.YSa=this.Pi=!1;this.onKeyDown=db=>!this.tB&&db.keyCode===Gd.a.$ea&&db.altKey&&db.ctrlKey?
(this.X2a(),db.stopPropagation(),db.preventDefault(),!0):!1;this.yla=db=>{if(!this.tB)return!1;if(db.eventName===V.a.Pb){const Lb=db.Ca.ctrlKey?1:db.Ca.shiftKey?50:10;switch(db.Ca.keyCode){case Gd.a.lpa:this.WK(0,-Lb);break;case Gd.a.w8:this.WK(0,Lb);break;case Gd.a.x8:this.WK(-Lb,0);break;case Gd.a.KCa:this.WK(Lb,0);break;case Gd.a.JG:case Gd.a.Lh:this.YSa=!0;break;default:return!1}}db.eventName===V.a.Fd&&this.YSa&&this.ZM(!0);db.Ca.preventDefault();return!0};this.Rza=db=>{if(!this.tB)return!1;db.Ca.preventDefault();
this.ZM();return!0};this.onBlur=()=>{if(!this.tB)return!1;this.ZM();return!0};this.Ho=Vd.KeyInputManager.instance;this.pointerInputManager=xe.a.instance}ka(Z){(this.root=Z)&&!this.Pi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Pi=!0)}detach(){this.root&&this.Pi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Pi=!1)}X2a(){this.root&&(this.target=this.Bt.zGb("move",!0),this.tWd=this.target.getBoundingClientRect(),this.tB=!0,this.YSa=!1,this.Ns(),this.Qya||this.zsb(),
this.target.appendChild(this.Qya))}ZM(Z=!1){this.Bt.Hoc(Z);this.tB=!1;this.wJb();this.kJb();this.tWd=this.target=void 0}Ns(){this.Ho.capture(this.yla,null);this.pointerInputManager.Ms(V.a.pointerDown,this.target,this.Rza,!0);this.target.addEventListener("blur",this.onBlur)}kJb(){this.Ho.releaseCapture();this.pointerInputManager.Vs(V.a.pointerDown,this.target,this.Rza,!0);this.target.removeEventListener("blur",this.onBlur)}wJb(){var Z;this.target&&(null===(Z=this.Qya)||void 0===Z?void 0:Z.parentNode)===
this.target&&this.target.removeChild(this.Qya)}WK(Z,db){const Lb=this.target.getBoundingClientRect();this.Bt.onMove(Z+Lb.left-this.tWd.left,db+Lb.top-this.tWd.top)}zsb(){this.Qya=Ed.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(d.a)(Od,"FormulaAssistanceMoveAdapter",null,[]);var se=a(276);class Le{constructor(Z){this.Bt=Z;this.Pi=!1}l5(){return this.Pi&&!!this.qD}lza(Z){this.qD.style.cursor="grabbing";this.JJj=Z.clientPoint.x;this.KJj=Z.clientPoint.y;this.Bt.zGb("drag");
return!0}Qca(Z){this.Bt.onMove(Z.clientPoint.x-this.JJj,Z.clientPoint.y-this.KJj);return!0}Pca(){this.xw()}Oca(){this.xw()}ka(Z){if(this.qD=Z)this.qD.style.cursor="grab",se.a.instance.HW(this.qD,this),this.Pi=!0}detach(){this.Pi&&this.qD&&(this.qD.style.cursor="",se.a.instance.p1(this.qD,this),this.Pi=!1)}xw(){this.qD.style.cursor="grab";this.Bt.Hoc()}}Object(d.a)(Le,"FormulaAssistanceDragAdapter",null,[484]);class Id{constructor(Z,db){this.vKa=Z;this.formulaAssistanceTelemetryManager=db;this.Pi=
!1;this.RL={[fe.Drag]:0,[fe.Move]:0};this.PEc=this.vKa.getWindowEdgeBuffer()+1;this.tEb=new Od(this);this.Rtb=new Le(this)}ka(Z,db,Lb,hc){this.root=Z;this.render=Lb;this.dismiss=hc;this.detach();db&&(this.Rtb.ka(db),this.tEb.ka(Z.firstChild),this.Pi=!0)}detach(){this.Pi&&(this.Rtb.detach(),this.tEb.detach(),this.Pi=!1);Ia.DOMElementExtensions.uf(this.placeholder)}clear(){this.vKa.setOverrideTarget(void 0);this.detach();this.rKb()}zGb(Z,db=!1){this.RL[Z]+=1;this.lAc=this.root.firstChild.getBoundingClientRect();
this.placeholder=this.root.cloneNode(!0);Z=this.placeholder.firstChild;Z.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);db&&(this.zQa=document.activeElement,Z.tabIndex=0,Z.focus());this.dismiss();return Z}onMove(Z,db){this.placeholder.firstChild.style.transform=`translate(${Math.min(Math.max(Z,this.PEc-this.lAc.left),window.innerWidth-this.lAc.right-this.PEc)}px, ${Math.min(Math.max(db,this.PEc-this.lAc.top),window.innerHeight-this.lAc.bottom-this.PEc)}px)`}Hoc(Z=
!0){const db=this.placeholder.firstChild.getBoundingClientRect(),Lb=this.vKa.getDirectionalHint({top:db.top,left:db.left});this.vKa.setOverrideTarget({top:1===Lb?db.bottom:db.top,left:db.left});this.render();window.requestAnimationFrame(()=>{Ia.DOMElementExtensions.uf(this.placeholder);this.zQa&&(Z&&this.zQa.focus(),this.zQa=void 0)})}rKb(){const Z=this.formulaAssistanceTelemetryManager.PP,db=this.RL[fe.Drag],Lb=this.RL[fe.Move];0<db&&(Z.argumentAssistanceDragCounter+=1,Z.argumentAssistanceDragTotalCounter+=
db,this.RL[fe.Drag]=0);0<Lb&&(Z.argumentAssistanceMoveCounter+=1,Z.argumentAssistanceMoveTotalCounter+=Lb,this.RL[fe.Move]=0)}}Object(d.a)(Id,"FormulaAssistanceDragControl",null,[]);var fe;(function(Z){Z.Drag="drag";Z.Move="move"})(fe||(fe={}));Object(d.b)("FormulaAssistanceDragMode",fe);class Yd extends Fb.a{constructor(Z,db,Lb,hc,Pc,Rc,xd){super(Yd.HKa(sa.a.g5(Z),sa.a.Bff(),xd));this.$=Z;this.zj=db;this.functionInfoManager=Lb;this.formulaAssistanceUIControl=hc;this.formulaAssistanceTelemetryManager=
Pc;this.pluginScheduler=Rc;this.htmlSanitizationHelper=xd;this.F2a=null;this.IY=0;this.Qq=null;this.tYc=!1;this.Dla=this.Ro=null;this.$Sa=!0;this.FK=!1;this.Mba=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Vif=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=Wd=>{this.QPb(Wd);1===Wd?this.formulaAssistanceTelemetryManager.PP.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.PP.argumentAssistanceExpandCounter++};
this.pSa=Wd=>{const ue={};ue[z.a.CQ]="ArgumentAssistanceCard";const ve={};ve.FunctionName=Wd.functionName;ue[z.a.ubd]=ve;this.$.Xc(802602464,0,8,ue)};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.PP.argumentAssistanceDismissCounter++;this.$Sa=!1;this.Ctb();this.FK&&this.Bt.clear();0===this.IY&&this.QPb(1)};this.jg=()=>{this.$Sa=!0;this.FK&&this.Bt.clear()};this.IOi=Wd=>{Wd.button===Sys.UI.MouseButton.leftButton&&Wd.target&&(ra.g(Wd),this.F2a&&this.F2a.JTa(Wd))};this.Rt=()=>{void 0!==
this.Ro&&null!==this.Ro&&this.Ro()};this.$k=sa.a.g5(Z);this.pti=sa.a.Bff();this.f5=this.$k&&pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);if(this.$k){this.jRd();this.Qq=new Pb(this.$,this.formulaAssistanceUIControl,0,dc.a.fdd);this.f5&&J.h(this.$).fc.Rm(this.jg);if(this.FK=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&
!!this.formulaAssistanceUIControl)this.Bt=new Id(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}else this.F2a=new Zc(this.domElement,this.$.aF,void 0,sa.a.AN(this.$)),this.Gc.ka("mousedown",this.IOi),Z=$get(r.Idd,this.zj),this.zj.insertBefore(this.domElement,Z);J.h(this.$).view.nt(this.Rt)}zqe(Z){this.addHandler("FAFunctionNameUpdated",
Z)}xUf(Z){this.removeHandler("FAFunctionNameUpdated",Z)}sre(Z){this.addHandler("FAParameterSelectionChangedOld",Z)}WUf(Z){this.removeHandler("FAParameterSelectionChangedOld",Z)}rre(Z){this.addHandler("FAParameterSelectionChanged",Z)}VUf(Z){this.removeHandler("FAParameterSelectionChanged",Z)}set_visible(Z){this.$k?Z||this.Ctb():Sys.UI.Control.prototype.set_visible.call(this,Z);return Z}Ctb(){this.formulaAssistanceUIControl&&(this.Ro=null,this.FK&&this.Bt.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),
this.Dla=null,this.Qq.Gf=!1)}show(Z){this.$k||(this.formulaAssistanceTelemetryManager.WB(["argumentAssistanceRender"]),this.F2a.setVisible(!!Z),this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceRender"]),this.tYc&&(this.tYc=!1,this.formulaAssistanceTelemetryManager.Lua("argumentAssistanceOverall")))}QMd(){if(!this.f5||this.$Sa){this.f5||this.formulaAssistanceTelemetryManager.WB(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.WB(["argumentAssistanceComputation"]);
var Z=J.h(this.$).Ai,db={content:Z.text,caretPosition:Z.textBox.caretPosition};(this.Mba?this.pluginScheduler.getRequester().argumentAssistance(db,0):this.pluginScheduler.requester().argumentAssistance(db)).then(Lb=>{0===Lb.kind?Lb.payload?(this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceComputation"]),this.vDj(this.Xrc(Lb.payload),Z.textBox.domElement)):this.Ctb():this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceComputation"],!1);return null})}}update(Z,db,Lb,hc){if(!this.$k&&
Z){this.formulaAssistanceTelemetryManager.WB(["argumentAssistanceComputation","argumentAssistanceOverall"]);this.tYc=!0;var Pc=this.$.listSeparator;try{var Rc=$get(r.Kdd,this.zj);const xd=$get(r.Ddd,this.zj);Rc.innerText="";xd.innerText="";const Wd=$get(r.VYe,this.zj),ue=Z.Params.split(r.Qad);Rc=[];for(let ve=0,qe=Wd.rows.length;ve<qe;ve++){const we=Wd.rows[ve];Ia.DOMElementExtensions.setVisible(we,ve<ue.length);let Ze=ue[ve];const zf=r.w_i+ve+"_",Ja=Z.NameDataStrings;$get(zf+r.jHb,we).innerText=
Ja;$get(zf+r.gFd,we).innerText=Ja;if(Ze){const Eb=ue[ve].split(Pc),zc=Yd.Jpd(Eb[Eb.length-1]),bd=Yd.toi(Z);zc&&(bd&&(2<Eb.length?(Eb[Eb.length-2]+="1",Eb[Eb.length-3]+="1"):w.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Ja,Eb.length.toString(),db)),Yd.APg(Eb,bd,db,Z));Ze=Eb.join(Pc.toString()+" ");ue[ve]=Ze;Lb<Eb.length?(Rc[ve]=Eb[Lb],w.ULS.shipAssertTag(537162072,0,!!Eb[Lb]&&
1<=Eb[Lb].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",Lb,Eb.length,Ja,ve),Eb[Lb]=`${"<b>"}${Eb[Lb]}${"</b>"}`,Ze=Eb.join(Pc.toString()+" ")):w.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+Lb+"currRowParamsArray.Length = "+Eb.length+", current row = "+ve);hc&&w.ULS.sendTraceTag(558474578,0,50,`formula '${Ja}', ${Eb.length} params, isElipsis = ${zc}, isPairsParamsFormula = ${bd}, currentParameterIndex = ${db}`)}this.pti?
this.htmlSanitizationHelper.dk($get(zf+r.Rqc,we),"("+(Ze||"")+")"):$get(zf+r.Rqc,we).innerHTML="("+(Ze||"")+")"}hc?this.raiseEvent("FAFunctionNameUpdated",new Jc(Z.NameDataStrings,ue)):this.raiseEvent("FAParameterSelectionChangedOld",new zb(ue,Rc,Lb));Wd.className=Cc.a.Duh+(this.functionInfoManager.Shc(Z)?"-udf":"")}catch(xd){throw w.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",Z.NameDataStrings,db,xd),xd;}this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceComputation"])}}dispose(){this.$k||
(this.Gc.dD(),da.a.Ia(this.Gc),J.h(this.$).view.gr(this.Rt),da.a.Ia(this.F2a),this.F2a=null);this.$k&&da.a.Ia(this.Qq);this.f5&&J.h(this.$).fc.em(this.jg);this.functionInfoManager=this.$=null;super.dispose()}Xrc(Z){const db=new Sc;db.functionRenderingInfo=Z;db.cardMode=this.IY;this.tKd(db);return db}tKd(Z){Z.callbacks=new gd;Z.callbacks.onHelpLink=this.qgd(Z.functionRenderingInfo);Z.callbacks.onCardModeChange=this.onCardModeChange;Z.callbacks.onFeedback=this.pSa;this.f5&&(Z.callbacks.onDismissClick=
this.onDismissClick)}vDj(Z,db){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.WB(["argumentAssistanceRender"]);const Lb={};Lb.zoomLevel=Q(this.$);this.formulaAssistanceUIControl.updateContext(Lb);this.Ro=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,db,Z,()=>{})};this.Ro();this.qrc(Z);this.FK&&this.Bt.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Ro,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));
this.Qq.Gf=!0;this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Lua("argumentAssistanceOverall")}}qgd(Z){return()=>{H(this.$,Z.helpID,Z.isUDF)}}jRd(){const Z=Rb.a.get(z.a.ipb);this.IY=Z?parseInt(Z,10):Yd.p7c;this.formulaAssistanceTelemetryManager.C1f(this.IY)}qrc(Z){var db=Z.functionRenderingInfo.functionName;this.Dla&&Za.a.equals(this.Dla,db,!0)?(db=uc.a.map(Z.functionRenderingInfo.signatures,Lb=>{let hc="";0<=Lb.signatureParams.activeParam&&
Lb.signatureParams.activeParam<Lb.signatureParams.params.length&&(hc=Lb.signatureParams.params[Lb.signatureParams.activeParam]);return hc}),this.raiseEvent("FAParameterSelectionChanged",new Fc(db))):(this.Dla=db,Z=uc.a.map(Z.functionRenderingInfo.signatures,Lb=>Lb.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Jc(db,Z)))}QPb(Z){this.IY=Z;try{Rb.a.Pv(z.a.ipb,Z.toString(),nb.AFrame.m8)}catch(db){w.ULS.sendTraceTag(537162070,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${db.message}`)}}static Jpd(Z){return Za.a.contains(Z,
r.O8b,!0)}static toi(Z){return!!Z&&Za.a.Q2a(Z.NameDataStrings,"IFS")}static APg(Z,db,Lb,hc){try{if(!Z||2>Z.length)w.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${hc.NameDataStrings}', ${Z?Z.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${db}, currentParameterIndex = ${Lb}.`);else{var Pc=Z.pop().toString();for(let Rc=Z.length-1;Rc<Lb;Rc++){const xd=Z[Rc].trim();if(db){const Wd=Z[Rc-1].trim();Z.push(Yd.AKh(Wd,xd))}else{const Wd=Yd.Tcf(xd);
Z.push(Yd.wZe(Wd))}}Z.push(Pc)}}catch(Rc){throw w.ULS.shipAssertTag(537162068,0,!1,`AppendNewOptionalParameters Exception. formula '${hc.NameDataStrings}', ${Z?Z.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${db}, currentParameterIndex = ${Lb}. 
Exception: ${Rc}`),Rc;}}static AKh(Z,db){Z=Yd.Tcf(Z);const Lb=Yd.H4e(Z);db=Yd.H4e(db);return Yd.wZe(Z,!0,!!Lb&&!!db&&Lb!==db)}static Tcf(Z){var db=Z.match(Yd.eBd);Z=Za.a.trimEnd(Za.a.trimStart(Z,r.zJf),r.yJf);if(db&&db.length){db=db[db.length-1];const Lb=Number.parseLocale(db)+1;Z=Z.replace(db,Lb.toString())}else Z=`${Z}${1}`;return Z}static wZe(Z,db=!1,Lb=!1){let hc="[{0}]";db&&(hc=Lb?"[{0}":"{0}]");return String.format(hc,Z)}static H4e(Z){return(Z=Z.match(Yd.eBd))&&Z.length?Z[0]:null}static HKa(Z,
db,Lb){if(Z)return document.createElement("div");Z=String.format(r.jKf,r.hKf,r.gFd,Cc.a.dRe,r.jHb,Cc.a.cRe,r.Rqc);var hc=String.format(r.jKf,r.iKf,r.gFd,Cc.a.dRe,r.jHb,Cc.a.cRe,r.Rqc);Z=String.format(r.RIh,r.SIh,Cc.a.aSe,Cc.a.Jrh,n.a.Ao,r.VYe,Z,hc);hc=document.createElement("div");db?Lb.dk(hc,Z):hc.innerHTML=Z;return hc.firstChild}}Yd.eBd=RegExp("\\d+");Yd.p7c=0;Object(d.a)(Yd,"FormulaArgumentAssistanceControlDeprecated",Fb.a,[470]);class Ce{constructor(){this.cia=this.ota=this.pta=!1;this.oJf=40;
this.ZCe=41;this.T0a=this.LEd=this.MEd=this.kHb=0;this.gAf=!0;this.pDd=!1;this.mXe=this.rPd=-1}}Object(d.a)(Ce,"ParseContext",null,[]);var ye=a(416),Ae=a(909),He=a(325);class gf extends Ae.a{constructor(Z,db,Lb,hc){super(Z,db);this.formulaAssistanceControl=Lb;this.formulaAssistanceTelemetryManager=hc;this.YIf=!1;this.cTa=null;this.Jmd=0;this.XIa=this.xHc=null;this.rQ=0;this.Fpb=db.textBox;this.$k=sa.a.g5(Z);this.Odj=pa.EwaSettings.xb()}get jAb(){return Object(ye.a)(qa,this.$.rb.Jh)}get GK(){return this.formulaAssistanceControl.re}set GK(Z){this.formulaAssistanceControl.re=
Z}get t6a(){return this.Za.t6a}get ybi(){var Z=this.Fpb.text;let db=!1;if(0>=Z.length)return db;const Lb=this.$.Jb.Ac("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),hc=J.h(this.$).ha.ra.activeCell.clone();var Pc=Z.charCodeAt(0);this.XIa="";this.rQ=this.x_g(Z,this.Fpb.caretPosition);Pc=61===Pc&&-1!==this.rQ;if(!pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Pc&&(db=!0);else if(Pc){if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Pc=
0;for(var Rc=this.rQ-1;1<=Rc&&!(this.rQ-Rc>gf.Vtf);Rc--)if(gf.xxe.includes(Z.charAt(Rc))){Pc=Rc;break}Pc=Z.substring(Pc+1,this.rQ);Z=""!==Pc?this.$.Cb.getItemByName(Pc):null;Rc=this.rQ;for(var xd=this.rQ+1;xd<=this.Za.textBox.caretPosition;xd++)if("["===this.Za.text.charAt(xd))Rc=xd;else break;this.rQ=Rc}else{Pc=Z.lastIndexOf("[");Rc=0;for(xd=Pc-1;1<=xd&&!(Pc-xd>gf.Vtf);xd--)if(gf.xxe.includes(Z.charAt(xd))){Rc=xd;break}Pc=Z.substring(Rc+1,Pc);Z=""!==Pc?this.$.Cb.getItemByName(Pc):null}Z&&2===Z.type?
(db=!0,this.XIa=Pc):J.h(this.$).Bb.Bj(hc)&&(db=!0,this.XIa="")}Lb.stop();this.Jmd=Lb.zc;w.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.Jmd} milliseconds`);return db}get key(){return y.a.Uvb}get calcManager(){this.xHc||(this.xHc=this.$.da.za(266,!1));return this.xHc}get RTd(){if(null!=this.cTa)return this.cTa;if(!pa.EwaSettings.ma(135))return this.cTa=!1;const Z=J.h(this.$).ha.ra.activeCell.clone();
if(1!==Z.ztf||!Z.left||J.h(this.$).ha.ra.ric())return!1;let db=this.formulaAssistanceControl.tableManager.Cn(Z);if(db)return this.cTa=!1;--Z.left;--Z.right;if(!Z.Jz)return!1;db=this.formulaAssistanceControl.tableManager.Cn(Z);return this.cTa=!!db&&Z.top===db.top&&this.formulaAssistanceControl.tableManager.$8g(db,J.h(this.$))}Yh(Z,db){this.formulaAssistanceControl.Za=this.Za;-1470715894!==db&&-1231471547!==db||!this.nLe()||(this.GK=!1);return super.Yh(Z,db)}zBd(){var Z=this.t6a;if(Z||this.RTd)if(this.formulaAssistanceControl.Za=
this.Za,this.formulaAssistanceTelemetryManager.Lpb.formulaAssistanceRequestAttemptedCounter++,this.nLe())if(!Z&&this.RTd)this.formulaAssistanceControl.Ave();else if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.ybi){if(Z=this.$.Jb.Ac("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.Cve(),Z.stop(),this.Fpb.text.endsWith("[")&&"["!==this.Fpb.text.charAt(this.Fpb.text.length-2)){const db=""===this.XIa?
this.formulaAssistanceControl.tableManager.Kg:Object(Jb.a)(He.a,this.$.Cb.getItemByName(this.XIa));w.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${db.nj} in ${Z.zc} ms with cell edit regression time of ${this.Jmd} ms and popup visibility - ${this.GK}`)}}else this.formulaAssistanceControl.spb(),this.YIf&&(this.YIf=this.GK=!1);else this.formulaAssistanceTelemetryManager.Lpb.formulaAssistanceRequestOptimizedCounter++;
else this.GK=!1}rh(){this.Odj||(this.cTa=null,this.RTd&&this.formulaAssistanceControl.OZ())}jg(){this.GK=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.mvc();this.$k&&this.Yyi()}ZHd(Z,db){return this.formulaAssistanceControl.Yh(Z,db)}Yyi(){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceControl.kaa&&!this.formulaAssistanceControl.Gia&&!this.formulaAssistanceControl.soa&&(this.formulaAssistanceTelemetryManager.LJ.dismissSmartSuggestionImplicitlyCounter++,
this.formulaAssistanceControl.kaa=!1);this.formulaAssistanceControl.XI&&(this.formulaAssistanceTelemetryManager.mK.smartSuggestionShownCounter++,this.formulaAssistanceControl.XI=!1);this.formulaAssistanceControl.soa&&(this.formulaAssistanceTelemetryManager.mK.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.soa=!1);this.formulaAssistanceControl.DTa&&(this.formulaAssistanceTelemetryManager.mK.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.DTa=!1);this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&
(this.formulaAssistanceTelemetryManager.mK.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1);this.formulaAssistanceControl.TMa&&(this.formulaAssistanceTelemetryManager.mK.isCellContentFormulaCounter++,this.formulaAssistanceControl.TMa=!1)}x_g(Z,db){let Lb=0,hc;for(;-1!==Lb;)if(Lb=Z.indexOf("[",Lb+1),-1!==Lb&&Lb<db&&(hc=Z.indexOf("]",Lb+1),-1===hc||hc>=db))return Lb;return-1}nLe(){const Z=this.Za.text,db=this.Za.textBox.caretPosition,Lb=this.formulaAssistanceControl.c6,
hc=this.formulaAssistanceControl.ica;if(this.GK&&Za.a.equals(Z,Lb,!0)&&db===hc)return!1;this.formulaAssistanceControl.c6=Z;this.formulaAssistanceControl.ica=db;return!0}}gf.xxe=" !%&'()*+,-/:;<=>@[]^{|}~".split("");gf.Vtf=255;Object(d.a)(gf,"FormulaAutoCompleteListAutoCompleteBehavior",Ae.a,[]);var Xe=a(30),$a;(function(Z){Z[Z.function=0]="function";Z[Z.field=1]="field";Z[Z.definedName=2]="definedName";Z[Z.letVariable=3]="letVariable";Z[Z.tableColHeaderName=4]="tableColHeaderName";Z[Z.tableSpecialStructRef=
5]="tableSpecialStructRef";Z[Z.pendingData=6]="pendingData";Z[Z.tableNamedObject=7]="tableNamedObject"})($a||($a={}));Object(d.b)("ItemType",$a);var ac=a(1092),Da=a(1091);class Na{constructor(Z){this.index=Z}execute(Z){Z.push(this.index)}}Object(d.a)(Na,"AppendIndexOperation",null,[483]);class sb{execute(){}}Object(d.a)(sb,"NopIndexOperation",null,[483]);class Kb{constructor(Z,db){this.y4i=Z;this.Yvf=db}execute(Z){for(let db=0;db<Z.length;db++)Z[db]===this.y4i&&(Z[db]=this.Yvf)}}Object(d.a)(Kb,"ReplaceIndexOperation",
null,[483]);var Yb=a(79);class vc{constructor(Z,db){this.$=Z;this.items=db;this.hNa=sa.a.hNa(this.$)}LHe(Z,db){const Lb=new Na(db);if(!this.hNa)return Lb;Z=this.uti(Z,db);return null!=Z?this.items[Z].DBb?new Kb(Z,db):new sb:Lb}uti(Z,db){const Lb=this.items[db];w.ULS.shipAssertTag(537162075,0,!!Lb,"Internal error: invalid item index");Z=Yb.where(Yb.asEnumerable(Z),hc=>this.items[hc].name===Lb.name);return Yb.Ct(Z)?Yb.first(Z):null}}Object(d.a)(vc,"FilterItemOperationFactory",null,[]);var ad=a(117),
ld=a(837);class md{constructor(){this.evaluation=this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}}Object(d.a)(md,"CompletionItem",null,[]);const Qd=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${n.a.Ao}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${n.a.Ao}'>{5}</td>\r\n</tr>`,ce=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${n.a.Ao}'></td>\r\n\t<td id='${"item_type_cell"}' class='${n.a.Ao}'>{2}</td>\r\n</tr>`,
ec=`<td>\r\n\t<div class='${n.a.qv}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,Vc=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${n.a.Ao}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${n.a.Ao}'>{2}</td>\r\n</tr>`;class td extends ac.a{constructor(Z,db,Lb,hc,Pc,Rc){super(Z,db);this.htmlSanitizationHelper=Pc;this.Gra=null;this.Qeb=this.Mwc=0;this.Mrb=null;this.WYe=Lb;this.Rvb=hc;this.formulaAssistanceControl=
Rc;this.qp=[];this.sW=[];this.mjf=(this.$k=sa.a.g5(Z))&&pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");this.Dmi=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7253303_ReduceInnerHTMLUsageFormulaAutoCompleteListBox")}UWc(Z){this.addHandler("FLBSelectedRowChanged",Z)}PLd(Z){this.removeHandler("FLBSelectedRowChanged",Z)}K_b(Z){this.addHandler("ACLBUpdated",Z)}tuc(Z){this.removeHandler("ACLBUpdated",
Z)}get zjc(){return 0<this.Qeb&&this.Qeb===this.qp.length}get Sqi(){return 0<this.Qeb}get re(){return super.re}set re(Z){super.re=Z;Z||(this.Mwc=0,this.ee=null);0===this.Mwc?Ia.DOMElementExtensions.setVisible(this.Rvb,Z&&!this.$k):Ia.DOMElementExtensions.setVisible(this.Rvb,!1)}get Oj(){return this.Gra}set Oj(Z){this.fCa(this.Oj);if(Z){this.WYe.innerText="";this.Gra=Z;var db=this.fCa(this.Oj);const Lb=Z.rowIndex+1,hc=$get("description_cell"+Lb,Z);this.Rvb.innerText=hc.innerText;const Pc=$get("item_type_cell",
Z);this.ee=db=db.innerText;this.Mwc="field"===Pc.innerText?1:"definedName"===Pc.innerText?2:"letVariable"===Pc.innerText?3:"tableColHeaderName"===Pc.innerText?4:"tableSpecialStructRef"===Pc.innerText?5:"pendingData"===Pc.innerText?6:"tableNamedObject"===Pc.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Da.a(this.qp.length,Lb,db,hc.innerText));this.ywc(Z)}}get vUa(){return this.Rvb}get jHa(){return this.formulaAssistanceControl}get J0(){return this.Mwc}dispose(){super.dispose();this.Gra=
this.WYe=this.Rvb=null}VAc(Z,db,Lb,hc=0){this.mjf||this.c8(!1);let Pc="";Lb&&(Pc+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${Cc.a.h4g}'>${Lb}</td></tr></table>`);Pc+=`<table class='${this.i6}' aria-live='off'><tbody>`;const Rc=new za.a;for(let Wd=0,ue=this.sW.length;Wd<ue;Wd++)Pc+=this.W6e(Z[this.sW[Wd]],Wd+1,db,hc),this.$k&&Rc.add(this.x0e(Z[this.sW[Wd]]));let xd=this.sW.length;for(let Wd=0,ue=this.qp.length;Wd<ue;Wd++)this.sW.includes(this.qp[Wd])||(xd++,Pc+=this.W6e(Z[this.qp[Wd]],
xd,db,hc),this.$k&&Rc.add(this.x0e(Z[this.qp[Wd]])));Pc+="</tbody></table>";this.Dmi?this.htmlSanitizationHelper.dk(this.Kf,Pc):this.Kf.innerHTML=Pc;this.Kn=Ia.DOMElementExtensions.nk(this.domElement,this.i6);this.$k&&(this.Mrb=Rc.toArray());this.mjf?(this.re=!0,this.jHa.set_visible(!0)):(this.c8(!0),this.xNg(!!Lb))}kKa(Z,db,Lb,hc="",Pc=0,Rc=!1){if(Z){var xd=[],Wd=[];this.Qeb=0;var ue=new vc(this.$,Z);if(db){var ve=!!db&&0<Pc,qe=ve&&91===db.charCodeAt(Pc+1)?Pc+2:Pc+1;Rc=ve?db.length===qe:!1;ve&&db.length===
Pc&&pa.EwaSettings.ma(135)&&(Rc=!0);var we=null;!Rc&&ve&&db.length>Pc+1&&(we=db.substring(qe,db.length));if(db)for(let Ze=0,zf=Z.length;Ze<zf;Ze++)if(ve=Z[Ze].name,!Z[Ze].Vji){qe=ue.LHe(xd,Ze);Z[Ze].DBb&&this.Qeb++;if(!we&&!Rc||0===Z[Ze].itemType)({Zcf:xd,pMf:Wd}=this.vWe(db,ve,Lb,qe,xd,Wd));we&&1===Z[Ze].itemType&&({Zcf:xd,pMf:Wd}=this.vWe(we,ve,!0,qe,xd,Wd));Rc&&1===Z[Ze].itemType&&qe.execute(xd)}}else for(Lb=0;Lb<Z.length;++Lb)if(Z[Lb].DBb||Rc)we=ue.LHe(xd,Lb),we.execute(xd),we.execute(Wd),Z[Lb].DBb&&
this.Qeb++;this.sW=Wd;this.qp=xd;this.VAc(Z,db,hc,Pc)}}UWj(Z){if(Z&&!(1<Z.length)){var db=[],Lb=[];db.push(0);Lb.push(0);this.sW=db;this.qp=Lb;this.VAc(Z,"","",0)}}Oya(){this.Oj&&super.Oya()}X7i(Z,db){this.raiseEvent("ACLBUpdated",new Da.a(Z,void 0,void 0,db))}iig(Z){const db=this.Kn.rows[Z];return(!this.Oj||this.Oj!==db)&&Z<this.Kn.rows.length?(this.Oj=db,!0):!1}static y0e(Z){switch(Z){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;
case 7:return 106;default:return 3}}onItemClick(Z){ra.g(Z.Ca);0===this.J0||2===this.J0||3===this.J0||4===this.J0||5===this.J0||7===this.J0?(this.raiseEvent(ld.a.z5a),this.Oya()):1===this.J0?this.jHa.jz(!1):(this.jHa.jz(!1),Z=J.h(this.$),Z.Uo(!1),Z.focus());return!0}xNg(Z){this.tsa();if(Z){var db=this.Kn.offsetWidth+(this.qp.length>this.qI?ad.a.Mu:0);Z=$get("list_column_header");Z.offsetWidth>db&&Ia.DOMElementExtensions.Vv(this.Kf,Z.offsetWidth);db=this.Kf.getElementsByClassName(this.RV);for(let Lb=
0;Lb<db.length;Lb++)db[Lb].style.width=D.HelperMethods.uc(Z.offsetWidth)}}W6e(Z,db,Lb,hc){if(1===Z.itemType){const Pc=Xe.a.Gg(Z.name),Rc=Xe.a.Gg(hc?Lb.substring(hc+1,Lb.length):Lb);let xd=0;Pc.substring(0,Rc.length).toLowerCase()!==Rc.toLowerCase()&&(xd=td.pJj(Pc,r.slg,Rc));Lb="";Lb=0<=xd?Lb+(Pc.substring(0,xd)+"<b>"+Pc.substring(xd,xd+Rc.length)+"</b>"+Pc.substring(xd+Rc.length,Pc.length)):Lb+Pc;hc=hc?String.format(ec,n.a.BSe,Xe.a.c_(ha.a.we(0)),v.a.instance.ga(712)):"";return String.format(ce,hc,
db,$a[Z.itemType],this.RV,Lb)}if(5===Z.itemType)return String.format(Vc,"",db,$a[Z.itemType],this.RV,Xe.a.Gg(Z.name),Xe.a.Gg(Z.Dja));if(4===Z.itemType)return String.format(Vc,"(...)",db,$a[Z.itemType],this.RV,Xe.a.Gg(Z.name));if(6===Z.itemType)return hc=hc?String.format(ec,n.a.BSe,Xe.a.c_(ha.a.we(0)),v.a.instance.ga(712)):"",String.format(Qd,hc,this.RV,Xe.a.Gg(Z.name),Xe.a.Gg(Z.Dja),db,$a[Z.itemType]);hc=String.format(ec,2===Z.itemType||3===Z.itemType?n.a.Ixh:n.a.Gxh,Xe.a.c_(ha.a.we(0)),v.a.instance.ga(709));
return String.format(Qd,hc,this.RV,Xe.a.Gg(Z.name),Xe.a.Gg(Z.Dja),db,$a[Z.itemType])}x0e(Z){const db=new md;db.label=Z.label;db.textEdit=Z.textEdit;db.kind=td.y0e(Z.itemType);db.type=Z.DBb?1:0;if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===db.kind){const Lb=this.formulaAssistanceControl.ATh(Z.label);db.detail=Lb?Lb:Z.Dja}else db.detail=Z.Dja;return db}vWe(Z,db,Lb,hc,Pc,Rc){Za.a.equals(db,"Pretend this is the line.",!1)&&0<Pc.length||Za.a.wG(db,Z)?(hc.execute(Pc),
hc.execute(Rc)):Lb&&Z.length>=r.c9g&&td.Rih(db,r.slg,Z)?hc.execute(Pc):!Lb&&Z.length>=r.b9g&&Za.a.contains(db,Z,!0)&&hc.execute(Pc);return{Zcf:Pc,pMf:Rc}}static Rih(Z,db,Lb){for(const hc of db)if(db=Z.split(hc),!(2>db.length))for(const Pc of db)if(Za.a.wG(Pc,Lb))return!0;return!1}static pJj(Z,db,Lb){for(const hc of db)if(db=Z.toLowerCase().indexOf((hc+Lb).toLowerCase()),0<db)return db+1;return-1}}Object(d.a)(td,"FormulaAutoCompleteListBox",ac.a,[467]);class he{constructor(){this.O9=this._name=null}get name(){return this._name}get toolTip(){return this.O9}}
Object(d.a)(he,"LETVariableInfo",null,[]);class ne{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(ne,"TableColHeaderNameInfo",null,[]);class Te{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(Te,"TableNamedObjectInfo",null,[]);class Me{constructor(){this.O9=this._name=null}get name(){return this._name}get toolTip(){return this.O9}}Object(d.a)(Me,"TableSpecialStructRefInfo",null,[]);var Ye=a(171),pf=a(29),Be=a(99),Ie=a(906),Hf=a(251),Ne=a(51),Je=a(145);
class Jf{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(d.a)(Jf,"FormulaAutoCompleteCallbacks",null,[]);class Ue{constructor(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}}Object(d.a)(Ue,"FormulaAutoCompleteRenderingInfo",null,[]);class ab{}Object(d.a)(ab,"RunExperimentRequest",null,[]);class Nb extends yb.a{constructor(Z,db,Lb,hc,Pc,Rc,xd,Wd,ue,ve){super(Z);this.functionInfoManager=db;
this.calcManager=hc;this.instantaneousSupportInformationManager=Pc;this.formulaAssistanceUIControl=xd;this.formulaAssistanceTelemetryManager=Wd;this.pluginScheduler=ue;this.Sec=!1;this.U5=this.Itd=this.MV=this.Kg=this.kHa=this.Qq=null;this.u6b=this.AOb=this.Ptb=this.IMe=this.a4=this.Rac=this.d4a=0;this.Wyc=!1;this.Xqc=this.fja=null;this.columnName="";this.Wze=this.z7c=!1;this.wKa=[];this.qQ=null;this.QNb=[];this.G8=this.Ldd=this.Ro=null;this.Gia=this.kaa=this.TMa=this.isCellContentOnlyEqualDuringEdit=
this.DTa=this.soa=this.XI=this.Sfa=!1;this.c6=null;this.ica=0;this.V4d=null;this.oEb=0;this.zod=!1;this.onRestoreFocus=()=>{};this.Vgb=void 0;this.Mba=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Vif=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.XAb=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.Ojd=()=>{this.$k&&this.raiseEvent(Nb.Ncd,
null)};this.rWe=()=>{this.fja=!1;this.MV=this.Za.text;this.Vg.kKa(this.yr,this.MV,!0,this.columnName,void 0,!1);1===this.Vg.qp.length&&1===this.Vg.sW.length?(this.set_visible(!1),this.Wze||this.Dmd()):this.show()};this.wQi=qe=>{if(dd.a(qe))-315732528!==qe.Errors[0].MessageId&&w.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${pf.a.sc(qe.Errors)}`);else if((qe=qe.Result)&&qe.length){this.Kg.VO||(this.Kg.VO={},this.Kg.VO.HeadersList=
[]);this.Kg.VO.IsFullTableHeaders=!0;for(let we=0;we<qe.length;++we)this.Kg.VO.HeadersList[we]={},this.Kg.VO.HeadersList[we].Index=we,this.Kg.VO.HeadersList[we].Name=qe[we];this.NLf(!0);this.MV=this.V6e();this.Vg.kKa(this.yr,this.MV,!0,void 0,void 0,!0);this.show()}else w.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.vQi=qe=>{qe=Y.a.Pe(qe.data);w.ULS.sendTraceTag(537162011,0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${pf.a.sc(qe)}`)};
this.Pxf=(qe,we)=>{this.gridView.eb||this.gridView.si||this.gPa(null===we||void 0===we?void 0:we.cell)};this.rh=(qe,we)=>{this.gPa(null===we||void 0===we?void 0:we.wja)};this.E6=(qe,we)=>{this.xOd(we.newValue)};this.Pc=()=>{(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||this.$k)&&this.set_visible(!1)};this.OBf=()=>{this.G8=this.kHa=null};this.Fh=()=>{this.$k&&this.u2a()};this.onFunctionInfoLoaded=()=>{this.spb()};this.mza=()=>{this.Fka?(this.kHa=
this.G8=null,this.spb()):this.Tg.al&&this.Ave()};this.Sca=()=>{this.qQ&&H(this.$,this.qQ.HelpId,this.qQ.IsDynamicUdf);return!0};this.Uca=(qe,we)=>{0==we.Kr&&(170==we.Rf.operation.operationName&&this.formulaAssistanceTelemetryManager.Tkc++,this.$.userOperationManager.ko(this.Uca))};this.FPa=(qe,we)=>{0==we.Kr&&(12==we.Rf.operation.operationName&&this.$.userOperationManager.ur(this.Uca),this.$.userOperationManager.ko(this.FPa))};this.u2a=()=>{this.$k&&this.Rvd();pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.XI&&(this.kaa=!0);this.OF&&this.Za.eb&&this.mna();this.Ro=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.x1b),this.Qq.Gf=!1);this.zod=!1};this.KGf=()=>{this.OF&&this.mna();this.o8f();1===this.m0f.type&&pa.EwaSettings.xb()&&!this.Za.text.includes("\n")&&this.TGd(this.m0f)};this.onDismiss=()=>{this.re=!1;this.gridView.Ai.textBox.focus()};this.pSa=()=>{const qe={};qe[z.a.CQ]=this.Vg.zjc?"SmartSuggestionsCard":this.Vg.Sqi?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";
this.$.Xc(802602464,0,8,qe)};this.$Bd=(qe,we)=>{this.Vg.iig(we);this.$k&&(this.oJa=!0)};this.ZBd=qe=>{this.$k&&(this.lJa=!0);this.OF?(this.lEe(),this.QZf(),this.gridView.uaa.r1f(),this.gridView.Ai.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):qe.textEdit?this.Hrb(qe.textEdit):this.jz(!0)};this.zq=J.h(Z);this.domElement.className=Cc.a.eQe;this.Tg=Rc.a5c(Z,Lb);this.h7b=new Cb(Z);this.wCg=Lb;Nb.xfc||(Nb.xfc=Nb.HKa());pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7252767_ReduceInnerHTMLUsageFormulaAssistanceControl")?ve.dk(this.domElement,Nb.xfc):this.domElement.innerHTML=Nb.xfc;this.eBd=RegExp("\\d+");Hf.d(this.style,this.$.isChromeRtl);this.xja=new Yd(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler,ve);db=$get(r.Idd,this.domElement);Lb=$get(r.Ddd,this.domElement);hc=$get(r.Kdd,this.domElement);this.yug=new td(this.$,db,
hc,Lb,ve,this);this.Tg.B_b(this.mza);this.functionInfoManager.DGa(this.onFunctionInfoLoaded);this.functionInfoManager.qKg(this.OBf);this.x1b=this.domElement;this.$k&&(this.$.xa.Vf(this.Fh),this.Vg.UWc(this.KGf),pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(this.x1b=document.createElement("div")));this.UTa(!0);this.Cag(!0);this.$.domElement.appendChild(this.x1b);this.$Rc=0;(ve=T.a(Z))&&this.wKa.push(new gf(Z,ve,this,this.formulaAssistanceTelemetryManager));
this.wKa.push(new gf(Z,this.zq.Vb,this,this.formulaAssistanceTelemetryManager));this.Lvb=this.wKa[0];this.Sqb=this.wKa[this.wKa.length-1];Z.da.Ga(221,this);this.instantaneousSupportInformationManager||this.$.da.$a(268,qe=>{this.instantaneousSupportInformationManager=qe});this.HVe=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);pa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===this.formulaAssistanceTelemetryManager.dX.anyPluginInitialized?
w.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):this.formulaAssistanceTelemetryManager.dX.anyPluginInitialized||(this.oEb=pa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));this.CTa=sa.a.hNa(this.$);this.ZBj=sa.a.Epb(this.$);this.FAd=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.PZc=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");
sa.a.AV(this.$)&&this.znd();sa.a.AN(this.$)&&db.classList.add("ewa-fb-refactor");this.$k?this.gridView.ha.iH(this.Pc):this.gridView.ha.NT(this.Pc);this.Qq=new Pb(this.$,this.formulaAssistanceUIControl,1,dc.a.hdd,this.Ojd);this.gpd=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.mmi=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",!1)}xqe(Z){this.addHandler(Nb.ndd,Z)}wUf(Z){this.removeHandler(Nb.ndd,Z)}vqe(Z){this.addHandler(Nb.Ncd,
Z)}uUf(Z){this.removeHandler(Nb.Ncd,Z)}wqe(Z){this.addHandler("FormulaAutoCompleteShown",Z)}vUf(Z){this.removeHandler("FormulaAutoCompleteShown",Z)}get mu(){return this.Vg}get yr(){return this.G8}get ELb(){return this.Vg.ee}get RYe(){return this.Vg}get yYe(){return this.xja}get Vg(){return this.yug}get P1a(){return this.CTa?this.Za?this.Za.text:null:this.MV}get rjf(){var Z;return 0===(null===(Z=this.lXe)||void 0===Z?void 0:Z.type)}get ari(){var Z;return 1===(null===(Z=this.lXe)||void 0===Z?void 0:
Z.type)}get_visible(){return void 0!==this.Vgb?this.Vgb:this.Vgb=super.get_visible()}set_visible(Z){if(this.Vgb===Z)return this.$k&&!Z&&this.u2a(),Z;this.xja.set_visible(Z);this.$k&&!Z&&this.u2a();Sys.UI.Control.prototype.set_visible.call(this,Z);return this.Vgb=Z}get re(){return this.mu.re}set re(Z){this.$k&&!Z&&this.u2a();this.mu.re=Z}get tableManager(){return this.wCg}get Fka(){return 0<this.uZ}get OF(){return this.Sfa}get gridView(){return this.mmi?this.zq:J.h(this.$)}get Bb(){return this.gridView.Bb}GZg(Z,
db){this.re&&(Z+=r.openParen,db++,this.kFd(Z,db));var Lb=db===Z.length||Z.charAt(db)===r.closeParen;if(!(0<db&&Z.charAt(db-1)===r.openParen&&Lb))return w.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${db} is invalid. Is cell empty: ${!Z.length}. Function exists in cell: ${!!this.qQ}`),!1;Lb=Z.substring(0,db).lastIndexOf(this.$.listSeparator);const hc=Z.substring(0,db-1).lastIndexOf(r.openParen);Z=Z.substring(-1===Lb&&-1===hc?1:Math.max(Lb,hc)+
1,db-1).trim();return this.functionInfoManager.igd(Z)?!0:(w.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.qQ}`),!1)}Tfi(Z,db){var Lb=this.GZg(Z,db);if(!Lb||!this.qQ)return w.ULS.shipAssertTag(537162051,0,!Lb||Lb&&!!this.qQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Uvf:0,nXe:0};Lb=this.qQ.Params;Lb=Lb.replace(RegExp("[\\[\\]]",
"g"),"");const hc=Z.charAt(db-1)===r.openParen,Pc=hc?"":"(",Rc=db===Z.length?")":"";var xd=this.$.listSeparator;xd=Lb.includes(xd)?Lb.indexOf(xd):Lb.length;return{returnValue:Z.substring(0,db)+Pc+Lb+Rc+Z.substring(db,Z.length),Uvf:hc?db:db+1,nXe:xd}}Rt(Z,db){this.$k&&void 0!==this.Ro&&null!==this.Ro&&this.Ro();this.$k||super.Rt(Z,db)}get h1b(){return this.V4d}get uZ(){return this.IMe}set uZ(Z){this.IMe=Z;Z||(this.a4=0)}get DBj(){if(null==this.Xqc){const Z=this.$.dc;this.Xqc=!!Z&&!Z.inEmbedView}return this.Xqc}get m0f(){return this.Vg.Mrb[this.Vg.Oj.rowIndex]}get lXe(){var Z,
db;return null===(db=null===(Z=this.Vg)||void 0===Z?void 0:Z.Mrb)||void 0===db?void 0:db[0]}get ZYe(){!this.Ldd&&this.pluginScheduler&&(this.Ldd=this.pluginScheduler.getFunctionsShortDescriptions());return this.Ldd}dispose(){if(this.$){this.UTa(!1);const Z=this.gridView;this.$.userOperationManager.ko(this.Uca);this.$.userOperationManager.ko(this.FPa);Z&&(Z.ha&&(this.$k?Z.ha.jG(this.Pc):Z.ha.XR(this.Pc),sa.a.AV(this.$)&&4!==this.oEb&&(this.XAb?Z.fc.Hk(this.rh):Z.ha.nna(this.Pxf))),Z.view.gr(this.Soc));
this.$k&&this.$.xa&&this.$.xa.Dg(this.Fh)}this.functionInfoManager&&(this.functionInfoManager.ucb(this.onFunctionInfoLoaded),this.functionInfoManager.Efj(this.OBf));this.Tg&&this.Tg.luc(this.mza);this.$k&&this.Vg&&this.Vg.PLd(this.KGf);sa.a.Ogc&&this.Za&&this.Za.KJb(this.E6);this.Cag(!1);da.a.Ia(this.Vg);da.a.Ia(this.h1b);da.a.Ia(this.xja);da.a.Ia(this.Qq);this.Za=this.functionInfoManager=this.Tg=null;da.a.qc(this.wKa);this.Kg=this.G8=this.xja=this.wKa=null;super.dispose()}Axa(){return!this.yr}ani(){return!this.kHa}EUj(Z){this.ari&&
1872288872===Z&&(this.formulaAssistanceTelemetryManager.yw(["autoCompleteSmartSuggestionActiveDismissing"]),this.Gia=!0)}Yh(Z,db){if(!this.Axa()){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.EUj(db);if(this.$k&&this.OF){if(125627505===db||267796030===db)return this.$k&&this.WCc(db),this.lEe(),this.QZf(),!1;if(1872288872===db)return this.mna(),this.re=!1,!0;if(this.Vg.zjc&&(-798660877===db||137938150===db))return!1}if(1!==this.Vg.J0||125627505!==db&&
267796030!==db)if(6===this.Vg.J0){var Lb=Z.keyCode;13!==Lb&&9!==Lb||this.jz(!1)}else{if(4===this.Vg.J0||5===this.Vg.J0)return super.Yh(Z,db,!0);1===this.Vg.sW.length&&(Lb=Z.keyCode,this.Wze=8===Lb||127===Lb||46===Lb?!0:!1)}else{if(this.jz(!1)&&!this.Fka)return this.gridView.ha.Yh(Z,db);if(125627505===db&&this.Fka)return!0}}return super.Yh(Z,db)}mvc(){this.Tg.Tcb();this.G8=null;null==this.fja||this.fja||this.vlc("NoFieldChosen",1,2,1);this.fja=null;this.uZ=0;this.U5=this.Itd=this.Xqc=null}spb(){this.Vif&&
this.formulaAssistanceTelemetryManager.WB(["argumentAssistanceOverall"]);const Z=!!this.Za&&!jb.f(this.$.oa);let db=null;Z&&(db=this.Za.text,db.startsWith("=")&&(this.TMa=!0,1===db.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if(this.ZBj&&Z){const Lb={content:db,caretPosition:null};(this.Mba?this.pluginScheduler.getRequester().functionSuggestion(Lb,0):this.pluginScheduler.requester().functionSuggestion(Lb)).then(hc=>{if(0===hc.kind){w.ULS.shipAssertTag(537162050,0,!!hc&&!!hc.payload.items,
"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const Pc=Yb.toArray(Yb.select(Yb.asEnumerable(hc.payload.items),Rc=>Nb.P7g(Rc)));this.gridView.uaa.oRd(hc.payload,db);this.CTa&&(this.QNb=Pc,tb.AFrameworkApplication.Ng||(this.PZc&&this.Bb.E5(this.gridView.ha.ra.activeCell)?this.formulaAssistanceTelemetryManager.mK.smartSuggestionWouldSuggestInsidePivotCounter++:this.Bve(Z,!0)))}return null})}this.CTa&&Z||this.Bve(Z,!1)}V6e(){if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var Z=
this.gridView.Ul?this.Lvb.rQ:this.Sqb.rQ;this.AOb="@"===this.Za.text.charAt(Z+1)&&this.Za.textBox.caretPosition>Z+1?Z+2:Z+1}else{Z=this.Za.text.lastIndexOf(r.Eof);const db=this.Za.text.lastIndexOf("[");this.AOb=Z+1>=db?Z+2:db+1}return this.Za.text.substring(this.AOb,this.Za.textBox.caretPosition)}Cve(){this.B8f()&&(this.Neh(),this.yr&&(this.fja=!1,this.MV=this.V6e(),this.Vg.kKa(this.yr,this.MV,!0,void 0,void 0,!0),this.show(),pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&
this.xja.Ctb()))}Ave(){this.B8f()&&(this.h1b&&this.h1b.cancel(),this.Tg.k7a?(this.Axa()&&this.yGe(!0),this.get_visible()?this.rWe():this.V4d=Ye.AsyncMethodContext.Er(this.rWe,r.mih,eb.a.PHh,this.h1b)):this.OZ())}B8f(){return this.Za?0<this.$.rb.GR||!this.Za.text||!this.Za.eb?(this.set_visible(!1),!1):jb.f(this.$.oa)?!1:!0:!1}Hrb(Z){this.Za&&this.re&&(this.Qnd(this.Za.text,Z),this.Za.textBox.caretPosition=Z.range.start.character+Z.newText.length,this.set_visible(!1))}jz(){var Z;if(!this.Za||!this.re)return!1;
const db=this.Vg.J0;this.formulaAssistanceTelemetryManager.Qcf(td.y0e(db));let Lb="";var hc=0;const Pc=this.gridView;var Rc=this.Za.text,xd=0,Wd=this.Vg.ee,ue=!1;if(0===db||2===db||3===db||7===db)Lb+=Rc.substr(0,this.d4a)+this.Vg.ee,0!==db||this.Vg.ee.endsWith(")")||(Lb+="("),hc=Lb.toString().length,Lb+=Rc.substr(this.Rac),2===db&&(xd=4,Wd="DefinedName",ue=!0,this.set_visible(!1));else if(1===db)if(this.fja=!0,this.Fka){Lb+=Rc.substr(0,this.uZ+2);!Lb.toString().endsWith(jc.a.GU)&&pa.EwaSettings.ma(135)&&
(Lb+=jc.a.GU);xd=this.Vg.ee;xd=xd.replace("'","''");xd=xd.replace("[","'[");xd=xd.replace("]","']");if(this.z7c||this.wDh(xd))xd=jc.a.Wvi+xd+jc.a.Nmj,ue=!0;Lb+=xd;hc=Lb.length;xd=3;Je.a("PulloutFieldAccepted")}else return this.Za.text=this.Vg.ee,this.set_visible(!1),Pc.Uo(!1),Pc.focus(),this.vlc("FieldName",1,1,1),Je.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===db)w.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),
Lb+=Rc.substr(0,this.AOb),Za.a.equals(this.Vg.ee,"@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString,!1)?Lb+="@":(Lb+=this.Vg.ee,ue=!0,this.set_visible(!1)),hc=Lb.length;else if(4===db){w.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");Lb+=Rc.substr(0,this.AOb);ue="";hc=!1;var ve=[39,91,93,64,35];for(let qe=0;qe<this.Vg.ee.length;qe++){const we=this.Vg.ee.charCodeAt(qe);ve.includes(we)&&(ue+="'");ue+=
this.Vg.ee.charAt(qe).toString();hc||Za.a.isNumeral(we)||Za.a.Iif(we)||(hc=!0)}ve=this.gridView.Ul?this.Lvb.rQ:this.Sqb.rQ;Rc=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Rc.charAt(ve+1)&&hc:Rc.lastIndexOf(r.Eof)+1>=Rc.lastIndexOf("[")&&hc;Lb+=Rc?"["+ue+"]":ue;ue=!0;this.set_visible(!1);hc=Lb.toString().length}else if(6===db)Lb+=Rc.substr(0,this.Ptb);else return w.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),
!1;this.Za.text=Lb;this.Za.textBox.caretPosition=hc;this.Za.Pxa()&&(null===(Z=Pc.gs)||void 0===Z?0:Z.tva)&&Pc.gs.NLb(this.Za.text,this.Za.textBox.caretPosition,this.Za.textBox.caretPosition,this.Za.textBox.Oy.length);Pc.Ul&&(Z=Pc.Vb,Z.text=this.Za.text,Z.setCaretPosition(this.Za.textBox.caretPosition));Wd=(null==this.fja?0:this.fja)?"FieldName":Wd;this.Vg.Oj.sectionRowIndex>=this.Vg.sW.length?this.vlc(Wd,4,xd,0):this.vlc(Wd,1,xd,0);ue||(5===db||4===db?this.Cve():this.spb());return!0}OZ(Z=null,db=
null){Z?(this.Tg.Tcb(),this.Tg.OZ(Z,!1,!1,db)):(Z=this.gridView,Z.ha.ra.Og&&(Z=lb.v(Z.ha.ra.$c,this.$),this.Tg.OZ(Z,!0,!0,db)))}mna(){this.Sfa=!1;this.Za.PLe()}ATh(Z){Z=this.calcManager.getWorksheetFuncId(Z);return this.ZYe?this.ZYe.descriptionsMap.get(Z):null}yGe(Z){if(this.ani()){if(this.Tg.k7a&&this.Tg.al&&(!this.Tg.al.length||!this.Tg.al[0].FieldInfoDataList))return;this.QUj(Z)}Z=Yb.asEnumerable(this.kHa);Z=Yb.concat(Z,this.DVh(this.Za.text));pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&
this.$k&&(Z=Yb.concat(Z,this.LWh()));Yb.OBc(Z,db=>db.name,new Ie.a);this.CTa&&(Z=Yb.concat(Yb.asEnumerable(this.QNb),Z),pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?0<this.QNb.length?(this.XI||this.formulaAssistanceTelemetryManager.WB(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.XI=!0):this.XI&&this.rjf&&(this.kaa=!0):0<this.QNb.length&&(this.XI=!0),this.QNb=[]);this.G8=Yb.toArray(Z)}Neh(){var Z=this.Za.text;
if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var db=this.gridView.Ul?this.Lvb.XIa:this.Sqb.XIa,Lb=!0;if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==db&&(this.Kg=Object(Jb.a)(He.a,this.$.Cb.getItemByName(db))),this.Kg||(this.Kg=this.tableManager.Kg,Lb=!1),!this.Kg){w.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");
return}}else this.Kg=Object(Jb.a)(He.a,this.$.Cb.getItemByName(db)),this.Kg||(this.Kg=this.tableManager.Kg,Lb=!1);this.Kg.VO&&this.Kg.VO.IsFullTableHeaders?this.NLf(Lb):ob.d(this.Kg)?(w.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),Ib.q(this.$.pa.ya,this.Kg.nj,this.wQi,this.vQi,null,null)):w.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&
this.tableManager.Kg)if(db=this.calcManager.r5a(this.tableManager.Kg))if(this.calcManager.lOg(this.tableManager.Kg,db)){Z=Yb.empty();if(91===this.Za.text.charCodeAt(this.Za.text.length-1)){const hc=this.K1a("@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString);Z=Yb.concat(Z,(Lb=new za.a,Lb.add(hc),Lb))}Z=Yb.concat(Z,Yb.select(Yb.asEnumerable(db.toArray()),hc=>{const Pc=new Fa,Rc=new ne;Rc._name=hc.toString();Pc.t4f(Rc);return Pc}));this.G8=Yb.toArray(Z)}else Z.endsWith("[")&&
"["!==Z.charAt(Z.length-2)&&w.ULS.sendTraceTag(572381130,0,50,`FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with ${db.count} columns for a table with id ${this.tableManager.Kg.nj} of size ${this.tableManager.Kg.usedRange.right-this.tableManager.Kg.usedRange.left+1}`);else Z.endsWith("[")&&"["!==Z.charAt(Z.length-2)&&w.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")}wDh(Z){if(!Z)return!1;
let db=Z.charCodeAt(0);if(46===db||48<=db&&57>=db||63===db)return!0;for(let Lb=0;Lb<Z.length;Lb++,db=Z.charCodeAt(Lb))if(!((pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Za.a.isLetter(db):Za.a.Jqd(db))||92===db||95===db||63===db||48<=db&&57>=db))return!0;return!1}kFd(Z,db){let Lb=!1,hc=!1;var Pc=!1,Rc=0;let xd=0;this.d4a=0;this.Rac=db;this.u6b=1;for(let Wd=db-1;0<=Wd;--Wd)switch(Z.charCodeAt(Wd)){case 39:hc=!hc;break;case 34:Lb=!Lb;
break;case 91:++Rc;Pc=Rc>xd;break;case 93:++xd}Pc=Object(Ha.a)(new Ce,{ota:!Lb,pta:!hc,cia:!Pc,kHb:1});Rc=this.S_i(Z,db,Pc);db=this.T_i(Z,db,Pc.ota,Pc.pta,Pc.cia);this.u6b=Rc+db;if(this.$Rc=Rc-1)this.Wyc=!1;this.lEh(Z,Lb,hc,Pc.LEd,Pc.MEd)}znd(){4!==this.oEb&&(this.XAb?this.gridView.fc.Yk(this.rh):this.gridView.ha.bha(this.Pxf));const Z=sa.a.Mzb()?this.zq.Sb(null):void 0;this.gPa(Z);sa.a.Ogc&&this.gridView.Ai.xZa(this.E6);Nb.COd(this.pluginScheduler);this.CTa&&this.Z0g()}PCh(){return this.CTa||this.HVe}U_i(){var Z=
this.U5;if(!this.DBj||!Z)return this.uZ=0,this.kHa=this.G8=null,!1;Z=Z.endsWith(jc.a.GU);let db;if(pa.EwaSettings.ma(135)&&({sheetRange:db}=this.iSj(this.U5.substring(0,this.a4))).returnValue){const Lb=this.U5.substring(0,this.uZ);if(Z&&Lb!==this.Itd)return this.Itd=Lb,this.uZ=this.U5.length-(Z?1:0),this.OZ(db,this.U5),this.fja=!1,w.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}DVh(Z){const db=new za.a;this.calcManager&&pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&
w.ULS.shipAssertTag(537162014,0,!!this.calcManager.Eta(na.Range.Qc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.HVe&&(Z=this.calcManager.extractLetVariables(Z,this.Za.textBox.caretPosition)))for(const Lb of Z){Z=new he;Z._name=Lb;Z.O9=v.a.instance.ga(2213);const hc=new Fa;hc.tvj(Z);db.add(hc)}return db}LWh(){const Z=new za.a,db=this.$.Cb.items;for(let hc=0,Pc=db.length;hc<Pc;hc++){var Lb=db[hc];if(!jb.n(Lb))continue;const Rc=new Te;
Rc._name=Lb.name;Lb=new Fa;Lb.Kxj(Rc);Z.add(Lb)}return Z}K1a(Z){const db=new Fa,Lb=new Me;Lb._name=Z;db.Lxj(Lb);return db}NLf(Z){const db=new za.a,Lb=this.Za.text.charCodeAt(this.Za.text.length-1),hc=this.Za.textBox.caretPosition-1;if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Za.text.charCodeAt(hc):91===Lb){var Pc=this.K1a("@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString);db.add(Pc)}for(var Rc of this.Kg.VO.HeadersList){Pc=
new Fa;const xd=new ne;xd._name=Rc.Name;Pc.t4f(xd);db.add(Pc)}Rc=this.gridView.Ul?this.Lvb.rQ:this.Sqb.rQ;Pc=this.Za.text.charCodeAt(Rc+1);(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!Z||hc!==Rc&&35!==Pc:!Z||91!==Lb&&35!==Lb)||(Z=this.K1a("#"+this.instantaneousSupportInformationManager.Je.AllStructRefString),db.add(Z),Z=this.K1a("#"+this.instantaneousSupportInformationManager.Je.DataStructRefString),db.add(Z),Z=this.K1a("#"+this.instantaneousSupportInformationManager.Je.HeadersStructRefString),
db.add(Z),Z=this.K1a("#"+this.instantaneousSupportInformationManager.Je.TotalsStructRefString),db.add(Z));db&&(this.G8=db.toArray())}QUj(Z){let db=Yb.empty();!Z&&this.functionInfoManager.BV&&(db=Yb.concat(db,Yb.select(Yb.asEnumerable(this.functionInfoManager.Qac),Lb=>{const hc=new Fa;hc.X2f(Lb);return hc})),Z=this.h7b.sKe,0<Z.length&&(db=Yb.OBc(Yb.concat(db,Yb.select(Yb.asEnumerable(Z),Lb=>{const hc=new Fa;hc.Stj(Lb);return hc})),Lb=>Lb.name,new Ie.a)));if(this.Tg.k7a&&this.Tg.al){if(!this.Tg.al.length||
!this.Tg.al[0].FieldInfoDataList)return;db=Yb.OBc(Yb.concat(db,Yb.select(Yb.asEnumerable(this.Tg.al[0].FieldInfoDataList),Lb=>{const hc=new Fa;hc.puj(Lb);return hc})),Lb=>Lb.name,new Ie.a);this.columnName=this.Tg.al[0].ColumnName}this.kHa=Yb.toArray(db)}gPa(Z){var db;if(1!==this.oEb){var Lb=this.gridView.ha.ra.activeCell;if(Lb){var hc=this.calcManager.Eta(Lb,!this.gpd);if(hc){var Pc=this.$.xa,Rc=hc.sheet.index;0>=Pc.count||0>Rc||Rc>=Pc.count?w.ULS.sendTraceTag(512278611,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Pc.count}, currentSheetIndex = ${Rc}.`):
(Rc=Pc=null,this.FAd&&void 0!==this.calcManager&&null!==this.calcManager&&(Z=null!==(db=null===Z||void 0===Z?void 0:Z.cell)&&void 0!==db?db:this.gridView.Ea.ps(Lb))&&(db=this.calcManager.Ncc(Z.$j),void 0!==db&&null!==db&&(Pc=db.FormatString,Rc=db.Builtin)),2!==this.oEb&&(this.pluginScheduler.notifier().setActiveCell({colIndex:hc.range.col,rowIndex:hc.range.row,sheetIndex:this.$.xa.getItem(hc.sheet.index).sheetId,docName:hc.sheet.document.name,docPath:hc.sheet.document.path,formatString:Pc,builtIn:Rc}),
w.ULS.sendTraceTag(512278610,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged sent notification to the scheduler. col: ${hc.range.col}, row: ${hc.range.row}, format: ${Pc}`)))}else w.ULS.sendTraceTag(512278612,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null")}else w.ULS.sendTraceTag(512278613,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged activeCell range is null")}}QZf(){this.formulaAssistanceTelemetryManager.kI={Pk:this.gridView.ha.ra.activeCell,
Uqb:this.gridView.Vb.text,Jrb:!0};this.formulaAssistanceTelemetryManager.QCb=this.$.ea.ze;this.formulaAssistanceTelemetryManager.Skc=this.$.xa.oa.sheetId;this.$.userOperationManager.ur(this.FPa)}Z0g(){this.gridView.Ul?this.Lvb.XY(!1):this.Sqb.XY(!1)}mmf(Z){let db;db=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Za.a.isLetter(Z):Za.a.Jqd(Z);return 48<=Z&&57>=Z||46===Z||95===Z||db}show(){if(this.yr){var Z=this.Vg.iig(0);this.$k?0<this.Vg.qp.length?
(this.formulaAssistanceTelemetryManager.Rcf(this.Vg.Mrb),Z||this.o8f()):this.u2a():((Z=0<this.Vg.qp.length)&&this.formulaAssistanceTelemetryManager.WB(["autoCompleteRender"]),!this.re&&this.columnName&&Z&&this.Vg.X7i(this.Vg.qp.length,this.columnName),this.re=Z,this.xja.show(this.qQ),this.xCa(!0),this.Vg.Oya(),Z&&this.formulaAssistanceTelemetryManager.yw(["autoCompleteRender"]))}}T_i(Z,db,Lb,hc,Pc){for(Lb=Object(Ha.a)(new Ce,{oJf:41,ZCe:40,ota:Lb,pta:hc,cia:Pc});db<Z.length&&!this.nKf(Z,db,Lb);++db);
return Lb.kHb}S_i(Z,db,Lb){for(--db;0<=db&&!this.nKf(Z,db,Lb);--db);return Lb.kHb}nKf(Z,db,Lb){const hc=Z.charCodeAt(db);0>=this.a4&&(this.a4=Z.substring(0,db).lastIndexOf(jc.a.GU));46===hc&&(db<this.a4?this.a4=db:db>this.Ptb&&(this.uZ=this.Ptb=db));if(!this.mmf(hc)&&!Nb.Osi(hc)&&(!this.Fka||db<=this.a4||!Nb.$ai(hc,Lb))){Lb.gAf&&(Lb.gAf=!1,this.d4a=db+1);if(Lb.pDd){Lb.MEd=db+1;if(this.functionInfoManager.igd(Z.substring(Lb.MEd,Lb.LEd)))return!0;Lb.pDd=!1}switch(hc){case 39:Lb.pta=!Lb.pta;break;case 34:Lb.ota=
!Lb.ota;break;case 91:Lb.cia=!1;break;case 93:Lb.cia=!0}hc===this.$.listSeparator.toString().charCodeAt(0)&&Lb.pta&&Lb.ota&&!Lb.T0a&&(!this.Fka||Lb.cia)&&(db<Lb.rPd||-1===Lb.rPd)&&(Lb.kHb+=1,this.u6b++);hc===Lb.ZCe&&Lb.ota&&Lb.pta&&(!this.Fka||Lb.cia)?Lb.T0a+=1:hc===Lb.oJf&&Lb.ota&&Lb.pta&&(!this.Fka||Lb.cia)?0<Lb.T0a?--Lb.T0a:(Lb.rPd=Lb.mXe,Lb.mXe=db,0<db&&this.mmf(Z.charCodeAt(db-1))&&(Lb.pDd=!0,Lb.LEd=db)):this.Fka&&46===hc&&db>this.a4&&(db<this.a4?this.a4=db:db>this.Ptb&&(this.uZ=this.Ptb=db))}return!1}lEh(Z,
db,Lb,hc,Pc){this.Rac>this.d4a&&0<=this.d4a?db||Lb||(this.MV=Z.substring(this.d4a,this.Rac)):this.MV=null;hc!==Pc?(Z=Z.substring(Pc,hc),this.qQ&&Za.a.equals(this.qQ.NameDataStrings,Z,!0)||(this.Wyc=!0),this.qQ=this.functionInfoManager.igd(Z)):(this.Wyc=!1,this.qQ=null)}Cag(Z){const db=$get(r.hKf+"_"+r.jHb,this.domElement),Lb=$get(r.iKf+"_"+r.jHb,this.domElement);Z&&!this.Sec?(db&&Ya.a.instance.ta(V.a.click,db,this.Sca),Lb&&Ya.a.instance.ta(V.a.click,Lb,this.Sca),this.Sec=!0):this.Sec&&(db&&Ya.a.instance.Ba(V.a.click,
db,this.Sca),Lb&&Ya.a.instance.Ba(V.a.click,Lb,this.Sca),this.Sec=!1)}iSj(Z){let db;db=null;var Lb;if(({sheetName:hc,range:Lb}=lb.Z(Z,this.$.ea.xa)).returnValue&&Lb){if(!hc){var hc=Object(Jb.a)(Be.a,this.$.oa);if(!hc)return{returnValue:!1,sheetRange:db};hc=hc.name}db=lb.v(Lb,this.$);db.SheetName=hc;this.z7c=!1;return{returnValue:!0,sheetRange:db}}return({sheetName:hc,range:Lb}=this.h7b.SRj(Z)).returnValue?(db=lb.v(Lb,this.$),db.SheetName=hc,this.z7c=!0,{returnValue:!0,sheetRange:db}):{returnValue:!1,
sheetRange:db}}xOd(Z){Z={content:Z,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Mba?this.pluginScheduler.getRequester().runAuthoringExperiment(Z,0):this.pluginScheduler.requester().runAuthoringExperiment(Z)}Dmd(){if(1===this.Vg.sW.length&&this.yr.length){var Z=this.yr[this.Vg.sW[0]];if(1===Z.itemType){var db=Z.name;Z=this.Za.text;db=db.substring(Z.length,db.length);db.length&&(this.Za.text=Z+db,this.Za.textBox.selectRange(Z.length,this.Za.text.length))}}else w.ULS.shipAssertTag(537162007,
0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.Vg.sW.length})`)}vlc(Z,db,Lb,hc){const Pc={};Pc.a=Z;Pc.b=db;Pc.c=Lb;Pc.d=hc;Ne.b().Qe(38,Pc,!0)}Bve(Z,db){if(!this.functionInfoManager.BV){if(Z)if(this.kFd(this.Za.text,this.Za.textBox.caretPosition),this.CTa||this.MV){const Lb={};Lb.Filter=this.MV?this.MV.charAt(0).toString():"";Lb.FilterType=1;Lb.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.JJa(Lb)}else pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&
this.get_visible()&&this.set_visible(!1);if(!db)return}0<this.$.rb.GR||this.Za&&!this.Za.eb?this.set_visible(!1):Z&&(this.kFd(this.Za.text,this.Za.textBox.caretPosition),this.xja.update(this.qQ,this.u6b,this.$Rc,this.Wyc),this.U5=this.Za.text.substring(1,this.Za.textBox.caretPosition),this.a4=this.U5.indexOf(jc.a.GU),this.uZ=this.U5.lastIndexOf(jc.a.GU),this.U_i()?(Z=new Fa,Z.jwj(),this.kHa=this.G8=Z=[Z],this.Vg.UWj(Z),this.show()):((this.PCh()||this.Axa())&&this.yGe(!1),0<this.uZ?this.Vg.kKa(this.yr,
this.U5,!1,void 0,this.U5.lastIndexOf(jc.a.GU),!1):this.Vg.kKa(this.yr,this.MV,!1,void 0,this.uZ,!1),this.show(),this.$k&&(this.Vg.qp.length||this.gridView.Ai.jL?this.xja.Ctb():(this.xja.QMd(),this.$k&&this.u2a()))))}o8f(){if(0<this.Vg.qp.length){this.formulaAssistanceTelemetryManager.WB(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const Z={};Z.zoomLevel=Q(this.$);this.formulaAssistanceUIControl.updateContext(Z);this.Ro=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.x1b,
this.gridView.Ai.textBox.domElement,this.icc(),()=>{})};this.Ro();this.$k&&this.Vg.zjc&&this.raiseEvent(Nb.ndd,null);this.zod||this.Vg.zjc||this.raiseEvent("FormulaAutoCompleteShown");this.zod=this.Qq.Gf=!0}this.formulaAssistanceTelemetryManager.yw(["autoCompleteRender"]);pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.XI&&this.rjf&&(this.kaa=!0)}}Rvd(){this.nJa&&(this.formulaAssistanceTelemetryManager.LJ.selectByArrowKeyCounter++,this.nJa=!1);this.oJa&&
(this.formulaAssistanceTelemetryManager.LJ.selectByMouseHoverCounter++,this.oJa=!1);this.mJa&&(this.formulaAssistanceTelemetryManager.LJ.commitByTabKeyCounter++,this.mJa=!1);this.kJa&&(this.formulaAssistanceTelemetryManager.LJ.commitByEnterKeyCounter++,this.kJa=!1);this.lJa&&(this.formulaAssistanceTelemetryManager.LJ.commitByMouseClickCounter++,this.lJa=!1);pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.Gia&&(this.formulaAssistanceTelemetryManager.LJ.dismissSmartSuggestionExplicitlyCounter++,
this.Gia=!1)}icc(){const Z=new Ue;Z.completionItems=this.Vg.Mrb;Z.activeItemIndex=this.Vg.Oj?this.Vg.Oj.rowIndex:-1;this.oKd(Z);return Z}oKd(Z){Z.callbacks=new Jf;Z.callbacks.onCompletionItemSelected=this.$Bd;Z.callbacks.onCompletionItemCommitted=this.ZBd;Z.callbacks.onFeedback=this.pSa;Z.callbacks.onDismiss=this.onDismiss;Z.callbacks.onRestoreFocus=this.onRestoreFocus}TGd(Z){this.Sfa=!0;const db=Z.textEdit.newText;this.Za.Geb(db.substring(this.Za.text.length-Z.textEdit.range.start.character,db.length))}lEe(){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.formulaAssistanceTelemetryManager.yw(["autoCompleteSmartSuggestionAccepted"]);this.jz(!0);this.Sfa=this.re=!1;this.DTa=this.soa=!0}Qnd(Z,db){this.Za.text=Z.substring(0,db.range.start.character)+db.newText+Z.substring(db.range.end.character,Z.length);this.gridView.Ul&&(this.gridView.Vb.text=this.Za.text)}static COd(Z){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?Z.getRequester().runExperiment(new ab,0):Z.requester().runExperiment(new ab)}static P7g(Z){const db=
Fa.weh(),Lb={IsCompatibility:!1};Lb.NameDataStrings=Z.label;Lb.Help=Z.detail;db.X2f(Lb);db.textEdit=Z.textEdit;return db}static HKa(){const Z=String.format(r.TIh,r.Kdd,Sa.a.gRe),db=String.format(r.PIh,r.Idd,Cc.a.D9b,n.a.Bo,n.a.Ao),Lb=String.format(r.NIh,r.Ddd,Cc.a.D9b,n.a.Bo,Cc.a.aSe,n.a.Ao);return`${Z}
${db}
${Lb}`}static Osi(Z){return 36===Z||58===Z||33===Z||39===Z||32===Z}static $ai(Z,db){return 32===Z||91===Z||!db.cia}}Nb.ndd="FACardOpened";Nb.Ncd="FAFocusOnSmartSuggestionsCard";Nb.xfc=null;Object(d.a)(Nb,"FormulaAssistanceControl",yb.a,[439,345,2,440,441]);class tc{constructor(Z){this.Bt=Z;this.tB=this.YSa=this.Pi=!1;this.onKeyDown=db=>this.tB||"Space"!==db.code&&" "!==db.key||!db.altKey||!db.ctrlKey?!1:(this.X2a(),db.stopPropagation(),db.preventDefault(),!0);this.yla=db=>{if(!this.tB)return!1;if(db.eventName===
V.a.Pb){const Lb=db.Ca.ctrlKey?1:db.Ca.shiftKey?50:10;switch(db.Ca.keyCode){case Gd.a.lpa:this.WK(0,-Lb);break;case Gd.a.w8:this.WK(0,Lb);break;case Gd.a.x8:this.WK(-Lb,0);break;case Gd.a.KCa:this.WK(Lb,0);break;case Gd.a.JG:case Gd.a.Lh:this.YSa=!0;break;default:return!1}}db.eventName===V.a.Fd&&this.YSa&&this.ZM(!0);db.Ca.preventDefault();return!0};this.Rza=db=>{if(!this.tB)return!1;db.Ca.preventDefault();this.ZM();return!0};this.onBlur=()=>{if(!this.tB)return!1;this.ZM();return!0};this.Ho=Vd.KeyInputManager.instance;
this.pointerInputManager=xe.a.instance}ka(Z){(this.root=Z)&&!this.Pi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Pi=!0)}detach(){this.root&&this.Pi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Pi=!1)}X2a(){this.root&&(this.Bt.zGb("move",!0),this.root.focus(),this.tB=!0,this.YSa=!1,this.Ns(),this.Qya||this.zsb(),this.root.appendChild(this.Qya))}ZM(Z=!1){this.tB&&(this.tB=!1,this.Bt.Hoc(Z),this.wJb(),this.kJb())}Ns(){this.Ho.capture(this.yla,null);this.pointerInputManager.Ms(V.a.pointerDown,
this.root,this.Rza,!0);this.root.addEventListener("blur",this.onBlur)}kJb(){this.Ho.releaseCapture();this.pointerInputManager.Vs(V.a.pointerDown,this.root,this.Rza,!0);this.root.removeEventListener("blur",this.onBlur)}wJb(){var Z;null===(Z=this.Qya)||void 0===Z?void 0:Z.remove()}WK(Z,db){const Lb=this.Bt.getPosition();Lb.x+=Z;Lb.y+=db;this.Bt.setPosition(Lb)}zsb(){this.Qya=Ed.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(d.a)(tc,"FormulaAssistanceMoveAdapter",
null,[]);class Nc{constructor(Z){this.Bt=Z;this.startOffset={x:0,y:0};this.h$f=!0;this.Pi=!1;this.sYc=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeArgumentAssistanceDragCursorToMove",!1)}l5(){return this.Pi&&!!this.qD}lza(Z){this.sYc||(this.qD.style.cursor="grabbing");const db=this.Bt.getPosition();this.h$f=db.renderDown;this.startOffset.x=db.x-Z.clientPoint.x;this.startOffset.y=db.y-Z.clientPoint.y;this.Bt.zGb("drag");return!0}Qca(Z){this.Bt.setPosition({x:Z.clientPoint.x+this.startOffset.x,
y:Z.clientPoint.y+this.startOffset.y,renderDown:this.h$f});return!0}Pca(){this.xw()}Oca(){this.xw()}ka(Z,db){this.qD=db;this.root=Z;this.qD&&(this.qD.style.cursor=this.sYc?"move":"grab",se.a.instance.HW(this.qD,this,!1),this.Pi=!0)}detach(){this.Pi&&this.qD&&(this.qD.style.cursor="",se.a.instance.p1(this.qD,this),this.Pi=!1)}xw(){this.sYc||(this.qD.style.cursor="grab")}}Object(d.a)(Nc,"FormulaAssistanceDragAdapter",null,[484]);class pd{constructor(Z){this.formulaAssistanceTelemetryManager=Z;this.Pi=
!1;this.RL={[zd.Drag]:0,[zd.Move]:0};this.tEb=new tc(this);this.Rtb=new Nc(this)}get getPosition(){return this.Rug}get setPosition(){return this.Bje}ka(Z,db,Lb,hc){this.Rug=Lb;this.Bje=hc;this.tEb.ka(Z);this.Rtb.ka(Z,db);this.Pi=!0}detach(){this.Pi&&(this.Rtb.detach(),this.tEb.detach(),this.Pi=!1)}clear(){var Z;null===(Z=this.Bje)||void 0===Z?void 0:Z.call(this,null);this.detach();this.rKb()}zGb(Z,db=!1){this.RL[Z]++;db&&(this.zQa=document.activeElement)}Hoc(Z=!0){this.zQa&&(Z&&this.zQa.focus(),this.zQa=
null)}rKb(){const Z=this.formulaAssistanceTelemetryManager.PP,db=this.RL[zd.Drag],Lb=this.RL[zd.Move];0<db&&(Z.argumentAssistanceDragCounter+=1,Z.argumentAssistanceDragTotalCounter+=db,this.RL[zd.Drag]=0);0<Lb&&(Z.argumentAssistanceMoveCounter+=1,Z.argumentAssistanceMoveTotalCounter+=Lb,this.RL[zd.Move]=0)}}Object(d.a)(pd,"FormulaAssistanceDragControl",null,[]);var zd;(function(Z){Z.Drag="drag";Z.Move="move"})(zd||(zd={}));Object(d.b)("FormulaAssistanceDragMode",zd);class Sd extends Fb.a{constructor(Z,
db,Lb){super(Sd.HKa());this.$=Z;this.formulaAssistanceUIControl=db;this.formulaAssistanceTelemetryManager=Lb;this.showCollapseText=this.isExpanded=!0;this.IY=0;this.Dla=this.Ro=this.Qq=null;this.FK=this.fv=!1;this.setPosition=hc=>{this.formulaAssistanceUIControl.setFixedPosition(hc);this.formulaAssistanceUIControl.updatePosition(0)};this.getPosition=()=>this.formulaAssistanceUIControl.getPosition();this.Pc=()=>{this.visible=!1};this.onCardModeChange=hc=>{this.QPb(hc);this.showCollapseText=!1;1===
hc?this.formulaAssistanceTelemetryManager.PP.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.PP.argumentAssistanceExpandCounter++};this.onIsExpandedChange=hc=>{this.Bhg(hc);this.showCollapseText=!1;const Pc=this.formulaAssistanceTelemetryManager.PP;hc?Pc.argumentAssistanceExpandCounter++:Pc.argumentAssistanceCollapseCounter++};this.pSa=hc=>I(this.$,"ArgumentAssistanceCard",hc.functionName);this.Rt=()=>{this.o_?this.formulaAssistanceUIControl.updatePosition(0):void 0!==this.Ro&&
null!==this.Ro&&this.Ro()};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.PP.argumentAssistanceDismissCounter++;this.dismiss();this.raiseEvent("DC");this.o_?(this.FK&&this.Bt.clear(),this.isExpanded&&this.Bhg(!1)):(this.FK&&this.t8b.clear(),0===this.IY&&this.QPb(1))};this.jg=()=>{this.FK&&(this.o_?this.Bt.clear():this.t8b.clear())};this.o_=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.f5=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",
!1);this.jRd();this.Qq=new Pb(this.$,this.formulaAssistanceUIControl,0,dc.a.fdd);this.grid=Object(J.h)(Z);this.grid.view.nt(this.Rt);this.grid.ha.iH(this.Pc);if(this.FK=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1))this.o_?this.Bt=new pd(this.formulaAssistanceTelemetryManager):this.t8b=new Id(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),this.grid.fc.Rm(this.jg);
pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}zqe(Z){this.addHandler("FAFunctionNameUpdated",Z)}xUf(Z){this.removeHandler("FAFunctionNameUpdated",Z)}sre(Z){this.addHandler("FAParameterSelectionChangedOld",Z)}WUf(Z){this.removeHandler("FAParameterSelectionChangedOld",Z)}rre(Z){this.addHandler("FAParameterSelectionChanged",Z)}VUf(Z){this.removeHandler("FAParameterSelectionChanged",Z)}VJg(Z){this.addHandler("DC",
Z)}nfj(Z){this.removeHandler("DC",Z)}get visible(){return this.fv}set visible(Z){Z||this.dismiss();this.fv=Z}dismiss(){this.fv=!1;this.formulaAssistanceUIControl&&(this.Ro=null,this.FK&&(this.o_?this.Bt.detach():this.t8b.detach()),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Dla=null,this.Qq.Gf=!1)}qGj(Z,db){this.fv=!0;const Lb=this.Xrc(Z);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.WB(["argumentAssistanceRender"]);Z={};Z.zoomLevel=Q(this.$);this.formulaAssistanceUIControl.updateContext(Z);
const hc=()=>{};pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Ro=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,db,Lb,hc)},this.Ro()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,db,Lb,hc);this.qrc(Lb);this.FK&&this.t8b.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Ro,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));
this.Qq.Gf=!0;this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Lua("argumentAssistanceOverall")}}show(Z,db){this.o_?this.rGj(Z):this.qGj(Z,db)}rGj(Z){this.fv=!0;const db=this.Xrc(Z);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.WB(["argumentAssistanceRender"]);const Lb=()=>c(this.$);this.Ro=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,void 0,db,Lb)};this.Ro();this.qrc(db);
this.FK&&this.Bt.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.getPosition,this.setPosition);this.Qq.Gf=!0;this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Lua("argumentAssistanceOverall")}}dispose(){this.$&&this.grid&&(this.grid.ha&&this.grid.ha.jG(this.Pc),this.grid.view.gr(this.Rt),this.FK&&this.grid.fc.em(this.jg));da.a.Ia(this.Qq);this.$=null}Xrc(Z){const db=new Sc;
db.functionRenderingInfo=Z;db.showCollapseText=this.showCollapseText;this.o_?db.isExpanded=this.isExpanded:db.cardMode=this.IY;this.tKd(db);return db}tKd(Z){Z.callbacks=new gd;Z.callbacks.onHelpLink=this.qgd(Z.functionRenderingInfo);this.o_?Z.callbacks.onIsExpandedChange=this.onIsExpandedChange:Z.callbacks.onCardModeChange=this.onCardModeChange;Z.callbacks.onFeedback=this.pSa;this.f5&&(Z.callbacks.onDismissClick=this.onDismissClick)}qgd(Z){return()=>{H(this.$,Z.helpID,Z.isUDF)}}jRd(){const Z=Rb.a.get(z.a.ipb);
this.o_?(Z?(this.isExpanded="false"!==Z,this.showCollapseText=!1):(this.isExpanded=Sd.Ehh,this.formulaAssistanceTelemetryManager.B1f()),this.formulaAssistanceTelemetryManager.Rsj(this.isExpanded)):(Z?(this.IY=parseInt(Z,10),this.showCollapseText=!1):(this.IY=Sd.p7c,this.formulaAssistanceTelemetryManager.B1f()),this.formulaAssistanceTelemetryManager.C1f(this.IY))}qrc(Z){var db=Z.functionRenderingInfo.functionName;this.Dla&&Za.a.equals(this.Dla,db,!0)?(db=uc.a.map(Z.functionRenderingInfo.signatures,
Lb=>{let hc="";0<=Lb.signatureParams.activeParam&&Lb.signatureParams.activeParam<Lb.signatureParams.params.length&&(hc=Lb.signatureParams.params[Lb.signatureParams.activeParam]);return hc}),this.raiseEvent("FAParameterSelectionChanged",new Fc(db))):(this.Dla=db,Z=uc.a.map(Z.functionRenderingInfo.signatures,Lb=>Lb.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Jc(db,Z)))}QPb(Z){this.IY=Z;try{Rb.a.Pv(z.a.ipb,Z.toString(),nb.AFrame.m8)}catch(db){w.ULS.sendTraceTag(537162074,
0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${db.message}`)}}Bhg(Z){this.isExpanded=Z;try{Rb.a.Pv(z.a.ipb,Z.toString(),nb.AFrame.m8)}catch(db){w.ULS.sendTraceTag(512267714,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${db.message}`)}}static HKa(){return document.createElement("div")}}Sd.p7c=0;Sd.Ehh=!0;Object(d.a)(Sd,"FormulaArgumentAssistanceControl",Fb.a,[474]);var ke;(function(Z){Z[Z.Dismissed=0]="Dismissed";Z[Z.Smart=
1]="Smart";Z[Z.Simple=2]="Simple";Z[Z.Mixed=3]="Mixed"})(ke||(ke={}));Object(d.b)("UIState",ke);class ie extends Fb.a{constructor(Z,db,Lb){super(ie.HKa());this.$=Z;this.formulaAssistanceUIControl=db;this.formulaAssistanceTelemetryManager=Lb;this.Qq=this.Za=this.gridView=null;this.kaa=this.Gia=this.lJa=this.kJa=this.mJa=this.oJa=this.nJa=!1;this.yr=null;this.$W=0;this.Ro=null;this.DTa=this.soa=this.XI=this.Sfa=this.fv=!1;this.GPb=ke.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.fv=!1;
this.y7a&&this.XI&&this.gNa&&(this.kaa=!0);this.Rvd();this.OF&&this.Za.eb&&this.mna();this.Ro=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.Qq.Gf=!1,this.GPb=ke.Dismissed)};this.Ojd=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};this.Uca=(hc,Pc)=>{0==Pc.Kr&&(170==Pc.Rf.operation.operationName&&this.formulaAssistanceTelemetryManager.Tkc++,this.$.userOperationManager.ko(this.Uca))};this.FPa=(hc,Pc)=>{0==Pc.Kr&&(12==Pc.Rf.operation.operationName&&
this.$.userOperationManager.ur(this.Uca),this.$.userOperationManager.ko(this.FPa))};this.eNi=()=>{this.dismiss();this.gridView.Ai.textBox.focus()};this.pSa=()=>{const hc={};hc[z.a.CQ]=this.ZIf?"SmartSuggestionsCard":this.JVd?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Xc(802602464,0,8,hc)};this.jg=()=>{pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartSuggestionSurvey",!1)&&1===this.formulaAssistanceTelemetryManager.mK.smartSuggestionShownCounter&&this.XI&&this.$.Xc(1073817162,
-1,0,null);this.gNa&&this.WNg()};this.$Bd=(hc,Pc)=>{this.zgb(Pc);this.oJa=!0};this.Pc=()=>{this.visible=!1};this.ZBd=hc=>{this.lJa=!0;this.Hrb(hc)};this.Fh=()=>{this.dismiss()};this.Rt=()=>{this.o_?this.formulaAssistanceUIControl.updatePosition(1):void 0!==this.Ro&&null!==this.Ro&&this.Ro()};this.gridView=J.h(this.$);this.Qq=new Pb(this.$,this.formulaAssistanceUIControl,1,dc.a.hdd,this.Ojd);this.gridView.view.nt(this.Rt);this.gridView.ha.iH(this.Pc);this.$.xa.Vf(this.Fh);this.gNa=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");
this.o_=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceRedesign",!1)&&pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.y7a=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6650011_LogSuggestionsDismissal");this.gNa&&this.gridView.fc.Rm(this.jg);pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement);this.pni=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")}xqe(Z){this.addHandler("FACardOpened",
Z)}wUf(Z){this.removeHandler("FACardOpened",Z)}vqe(Z){this.addHandler("FAFocusOnSmartSuggestionsCard",Z)}uUf(Z){this.removeHandler("FAFocusOnSmartSuggestionsCard",Z)}wqe(Z){this.addHandler("FormulaAutoCompleteShown",Z)}vUf(Z){this.removeHandler("FormulaAutoCompleteShown",Z)}UWc(Z){this.addHandler("SelectedRowChanged",Z)}PLd(Z){this.removeHandler("SelectedRowChanged",Z)}K_b(Z){this.addHandler("ListBoxUpdated",Z)}tuc(Z){this.removeHandler("ListBoxUpdated",Z)}dispose(){this.$&&(this.$.userOperationManager.ko(this.Uca),
this.$.userOperationManager.ko(this.FPa),this.gridView&&(this.gridView.ha&&this.gridView.ha.jG(this.Pc),this.gridView.fc&&this.gNa&&this.gridView.fc.em(this.jg),this.gridView.view.gr(this.Rt)),this.$.xa&&this.$.xa.Dg(this.Fh));da.a.Ia(this.Qq);this.$=null}IJg(Z){this.addHandler("CVIC",Z)}$ej(Z){this.removeHandler("CVIC",Z)}get visible(){return this.fv}set visible(Z){Z||this.dismiss();this.fv=Z}get OF(){return this.Sfa}get JVd(){var Z,db;return 1===(null===(db=null===(Z=this.yr)||void 0===Z?void 0:
Z.items[0])||void 0===db?void 0:db.type)}get ZIf(){return 1===this.yr.items.length&&this.JVd}Yh(Z,db){if(!this.visible)return!1;this.WCc(db);let Lb;return(Lb=this.v7h(db)).wec?Lb.result:this.hBj(db)}Xxb(Z){if(!this.visible)return!1;let db=!1;switch(Z){case 1872288872:this.OF&&this.mna();this.y7a&&this.JVd&&(this.formulaAssistanceTelemetryManager.yw(["autoCompleteSmartSuggestionActiveDismissing"]),this.Gia=!0);this.visible=!1;db=!0;break;case -798660877:this.zgb(this.Cxb(this.$W+1));db=!0;break;case 137938150:this.zgb(this.Cxb(this.$W-
1));db=!0;break;case 2091832999:this.zgb(this.Cxb(this.$W+8));db=!0;break;case 742457698:this.zgb(this.Cxb(this.$W-8));db=!0;break;case 125627505:case 267796030:this.Hrb(this.yr.items[this.$W]),db=!0}return db}show(Z){this.Za=this.gridView.Ai;this.fv=!0;this.$W=0;this.yr=Z;0<this.yr.items.length&&(this.render(),this.zgb(this.Cxb(this.$W)),this.y7a?this.gNa&&(1===this.yr.items[0].type?(this.XI||this.formulaAssistanceTelemetryManager.WB(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),
this.XI=!0):this.XI&&(this.kaa=!0)):1===this.yr.items[0].type&&this.gNa&&(this.XI=!0));this.formulaAssistanceTelemetryManager.Rcf(Z.items)}mna(){this.Sfa=!1;this.Za.PLe()}hBj(Z){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(Z)}v7h(Z){return this.OF?125627505===Z||267796030===Z?(this.Hrb(this.yr.items[this.$W]),{wec:!0,result:!1}):!this.ZIf||-798660877!==Z&&137938150!==Z?{wec:!1}:{wec:!0,result:!1}:{wec:!1}}render(){this.formulaAssistanceTelemetryManager.WB(["autoCompleteRender"]);
if(this.formulaAssistanceUIControl){if(this.o_){const Z=()=>c(this.$);this.Ro=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,void 0,this.icc(),Z)}}else{const Z={};Z.zoomLevel=Q(this.$);this.formulaAssistanceUIControl.updateContext(Z);this.Ro=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,this.Za.textBox.domElement,this.icc(),()=>{})}}this.Ro();this.M7i();this.Qq.Gf=!0;this.Mph()}}Mph(){this.formulaAssistanceTelemetryManager.yw(["autoCompleteRender"]);
this.formulaAssistanceTelemetryManager.Lua("autoCompleteOverall");const Z=this.yr.items.some(Lb=>1===Lb.type),db=this.yr.items.some(Lb=>0===Lb.type);Z&&db?this.formulaAssistanceTelemetryManager.Lua("autoCompleteOverallSimpleAndSmart"):Z?this.formulaAssistanceTelemetryManager.Lua("autoCompleteOverallSmartOnly"):db&&this.formulaAssistanceTelemetryManager.Lua("autoCompleteOverallSimpleOnly")}M7i(){const Z=this.GPb;this.GPb=this.X2h(this.yr.items);Z!==ke.Dismissed&&Z!==ke.Smart||this.GPb!==ke.Simple&&
this.GPb!==ke.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}r8i(){var Z;if(this.pni&&0!==this.yr.items.length){var db=0<=this.$W?this.$W:0,Lb=this.yr.items[db];Lb={qG:Lb.label,description:null!==(Z=Lb.detail)&&void 0!==Z?Z:"",selectedIndex:db+1,length:this.yr.items.length};this.raiseEvent("SelectedRowChanged",Lb)}}Hrb(Z){if(this.Za&&this.visible){var db=Z.textEdit;this.Qnd(this.Za.text,db);this.Za.textBox.caretPosition=db.range.start.character+db.newText.length;this.OF&&(this.Sfa=!1,this.gNa&&
(this.y7a&&this.formulaAssistanceTelemetryManager.yw(["autoCompleteSmartSuggestionAccepted"]),this.DTa=this.soa=!0),this.yvj(),this.gridView.uaa.r1f(),this.Za.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:Z.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.Qcf(Z.kind)}}yvj(){this.formulaAssistanceTelemetryManager.kI={Pk:this.gridView.ha.ra.activeCell,Uqb:this.gridView.Vb.text,Jrb:!0};
this.formulaAssistanceTelemetryManager.Skc=this.$.xa.oa.sheetId;this.formulaAssistanceTelemetryManager.QCb=this.$.ea.ze;this.$.userOperationManager.ur(this.FPa)}WNg(){this.y7a&&this.kaa&&!this.Gia&&!this.soa&&(this.formulaAssistanceTelemetryManager.LJ.dismissSmartSuggestionImplicitlyCounter++,this.kaa=!1);this.XI&&(this.formulaAssistanceTelemetryManager.mK.smartSuggestionShownCounter++,this.XI=!1);this.soa&&(this.formulaAssistanceTelemetryManager.mK.smartSuggestionSelectedCounter++,this.soa=!1);this.DTa&&
(this.formulaAssistanceTelemetryManager.mK.smartSuggestionCommittedCounter++,this.DTa=!1)}icc(){const Z=new Ue;Z.completionItems=this.yr.items;Z.activeItemIndex=this.$W;this.oKd(Z);return Z}oKd(Z){Z.callbacks=new Jf;Z.callbacks.onCompletionItemSelected=this.$Bd;Z.callbacks.onCompletionItemCommitted=this.ZBd;Z.callbacks.onFeedback=this.pSa;Z.callbacks.onDismiss=this.eNi;Z.callbacks.onRestoreFocus=this.onRestoreFocus}TGd(Z){this.Sfa=!0;const db=Z.textEdit.newText;this.Za.Geb(db.substring(this.Za.text.length-
Z.textEdit.range.start.character,db.length))}zgb(Z){const db=this.$W;this.$W=Z;const Lb=this.yr.items[Z];this.OF&&this.mna();db!==Z&&this.render();1===Lb.type&&pa.EwaSettings.xb()&&!this.gridView.Ai.text.includes("\n")&&this.TGd(Lb);this.r8i()}Cxb(Z){return 0>Z?0:Math.min(Z,this.yr.items.length-1)}Qnd(Z,db){this.Za.text=Z.substring(0,db.range.start.character)+db.newText+Z.substring(db.range.end.character,Z.length);this.gridView.Ul&&(this.gridView.Vb.text=this.Za.text)}Rvd(){this.nJa&&(this.formulaAssistanceTelemetryManager.LJ.selectByArrowKeyCounter++,
this.nJa=!1);this.oJa&&(this.formulaAssistanceTelemetryManager.LJ.selectByMouseHoverCounter++,this.oJa=!1);this.mJa&&(this.formulaAssistanceTelemetryManager.LJ.commitByTabKeyCounter++,this.mJa=!1);this.kJa&&(this.formulaAssistanceTelemetryManager.LJ.commitByEnterKeyCounter++,this.kJa=!1);this.lJa&&(this.formulaAssistanceTelemetryManager.LJ.commitByMouseClickCounter++,this.lJa=!1);this.y7a&&this.Gia&&(this.formulaAssistanceTelemetryManager.LJ.dismissSmartSuggestionExplicitlyCounter++,this.Gia=!1)}WCc(Z){switch(Z){case -798660877:case 137938150:case 2091832999:case 742457698:this.nJa=
!0;break;case 125627505:this.mJa=!0;break;case 267796030:this.kJa=!0}}static HKa(){return document.createElement("div")}X2h(Z){return Z.reduce((db,Lb)=>db|=0===Lb.type?ke.Simple:ke.Smart,ke.Dismissed)}}Object(d.a)(ie,"FormulaAutoCompleteControl",Fb.a,[471,2,440]);var Fe=a(725);class qc{constructor(Z,db){var Lb,hc;this.Tg=Z;this.$=db;this.mza=()=>{this.D$b.resolve(this.Tg.al);this.rfg()};this.WBf=()=>{this.D$b.reject(null);this.rfg()};this.jg=()=>{this.Tg.Tcb();this.nud=null};null===(hc=null===(Lb=
J.h(this.$))||void 0===Lb?void 0:Lb.fc)||void 0===hc?void 0:hc.Rm(this.jg);this.JGj=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(Z,db,Lb,hc){const Pc={G$:Z,JMe:db};var Rc;if(Rc=Object(Fe.b)(this.nud))Rc=this.nud,Rc=!(Pc.G$.FirstRow===Rc.G$.FirstRow&&Pc.G$.FirstColumn===Rc.G$.FirstColumn&&Pc.G$.LastRow===Rc.G$.LastRow&&Pc.G$.LastColumn===Rc.G$.LastColumn&&Pc.G$.SheetName===Rc.G$.SheetName&&Pc.JMe===Rc.JMe);Rc&&this.Tg.Tcb();
this.nud=Pc;this.JGj&&this.Tg.k7a||this.Tg.OZ(Z,Lb,hc,db);this.D$b=new Fe.a;this.Tg.k7a?this.D$b.resolve(this.Tg.al):this.nbj();return this.D$b.promise}dispose(){var Z,db;null===(db=null===(Z=J.h(this.$))||void 0===Z?void 0:Z.fc)||void 0===db?void 0:db.em(this.jg)}nbj(){this.Tg.B_b(this.mza);this.Tg.sKg(this.WBf)}rfg(){this.Tg.luc(this.mza);this.Tg.Gfj(this.WBf)}}Object(d.a)(qc,"ServerDataProvider",null,[473]);var Uc=a(322),ub=a(579),Xb=a(343),wc=a(871);class Tc{constructor(Z){this.BK=this.CK=this.MF=
this.NF=!1;this.v_=Z}}Object(d.a)(Tc,"MarqueeRangeData",null,[]);class sd{constructor(Z,db,Lb,hc=!1){this.jYd=Z;this.QOb=db;this.S7a=hc;Lb?(this.v_=Lb.v_,this.NF=Lb.NF,this.MF=Lb.MF,this.CK=Lb.CK,this.BK=Lb.BK):w.ULS.shipAssertTag(510255180,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(d.a)(sd,"MarqueeMetadata",null,[]);const qb="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class Sb{constructor(Z,db,Lb){this.$=Z;this.pluginScheduler=db;this.formulaAssistanceTelemetryManager=Lb;this.dmf=this.AK=this.kfb=!1;this.Jha=void 0;this.ZR=null;this.rh=()=>{this.Jha=void 0};this.fza=()=>{this.AK=!1;this.Jha=void 0;this.ZR=null};this.gridView=J.h(Z);this.gridView.Vb.Rm(this.fza);this.dmf=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094505_updateFormulaHighlightsTelemetry");this.Vrd=(this.s8a=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",!1))&&
pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7144730_FormulaHighlightsCaching")}get coloredReferencesManager(){this.YVa||(this.YVa=this.$.da.za(281));return this.YVa}FSj(Z,db,Lb){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.bgb(Z,db,Lb)}bgb(Z,db,Lb){var hc;this.dmf&&Z.textBox.addEventLogRecord("FormulaHighlightsControl.TryUpdateFormulaHighlights");if(this.kfb||Z.OF)return!1;const Pc=isNullOrUndefined(db)?Z.text:db;if(1>=Pc.length)return this.Uhg(Z,Pc,Object(Fe.b)(db));
Lb=this.h3h(Z,db,Lb);if(this.s8a&&!this.Vrd&&this.ECj(Z,{content:Pc,selection:Lb}))return!0;Lb=null===(hc=this.S4a(Pc,Lb))||void 0===hc?void 0:hc.formulaHighlights;if(!Lb)return w.ULS.sendTraceTag(512349465,0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),this.Uhg(Z,Pc,Object(Fe.b)(db));const {dNj:Rc,X8i:xd,V8i:Wd,XCi:ue}=this.lUh(Lb,Pc);this.hyc(Z,Rc,!!db);db=Z.textBox.text;if(!Za.a.equals(db,Pc,!1))return w.ULS.shipAssertTag(38114182,
0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${db.length}], updatedTextLength [${Pc.length}]`),db=Z.textBox.caretPosition,Z.textBox.text=Pc,Z.textBox.caretPosition=db,!0;this.Bz(xd,Wd,ue);return this.AK=!0}vEb(Z,db,Lb){if(!Z||!db||!Lb)return w.ULS.shipAssertTag(512349463,0,!!Z,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),w.ULS.shipAssertTag(512349462,0,
!!db,"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),w.ULS.shipAssertTag(512349461,0,!!Lb,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const hc=Object(Jb.a)(sd,db.metadata);if(!hc)return w.ULS.shipAssertTag(512349460,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),!1;var Pc=hc.jYd,Rc=hc.QOb,xd=this.gridView.Bb.Gpd(Lb)?Lb.Fwb(hc.MF,hc.NF):Lb.oLa(hc.MF,hc.NF,hc.BK,hc.CK);if(!xd)return w.ULS.shipAssertTag(512349459,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),
!1;const Wd=Rc.indexOf("!");-1!==Wd&&(xd=Rc.substring(0,Wd+1)+xd);if(!Z.textBox.changeTextInExistingTextPart(Pc,Rc,xd))return w.ULS.shipAssertTag(38926105,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),!1;hc.QOb=xd;Pc=!0;for(Rc=1;4>=Rc;Rc++)(xd=J.h(this.$).qb.Bv(3,Rc,db.jU))?(xd.range=Lb,xd.metadata=hc):(w.ULS.shipAssertTag(512349458,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),Pc=!1);this.gridView.qb.update(!1,!1);this.gridView.Ul&&
(this.gridView.fc.textBox.text=Z.text);this.gridView.fc.FQa(new Uc.a({oAb:!0}));return Pc}xni(Z){if(3!==Z.Tq)return w.ULS.shipAssertTag(512349457,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),!1;Z=Object(Jb.a)(sd,Z.metadata);return Z?Z.v_&&!Z.S7a:(w.ULS.shipAssertTag(512349456,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),!1)}RBa(Z,db){w.ULS.sendTraceTag(512349455,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+
(db?"suspending":"resuming")+" colored references");db&&this.AK&&(this.AK=!1,this.Bz(null,null),Z.textBox.eCe());this.kfb=db}dispose(){var Z;this.gridView&&this.gridView.Vb&&this.gridView.Vb.em(this.fza);(null===(Z=this.gridView)||void 0===Z?0:Z.fc)&&this.gridView.fc.Hk(this.rh);this.Jha=void 0}Syb(Z){this.formulaAssistanceTelemetryManager.WB(["highlightPreviewRanges"]);var db=this.S4a(Z,wc.a);if(isNullOrUndefined(db))this.Uka&&this.Bz(null,null);else{var Lb=this.$ja(),hc=[],Pc=new Ic.a(!1),Rc=[];
db=db.formulaHighlights;for(const xd of db)if(db=xd.kind,0===db||2===db||1===db)db=lb.B(xd.rangeInfo.sharedRange),Object(Fe.b)(db)&&(hc.push(new Xb.a(db,Lb)),this.NZ(db,Pc,1),Rc.push(new sd(xd.span.start,Z.substring(xd.span.start,xd.span.end),e(xd),!0)));this.Bz(hc,Pc,Rc);this.formulaAssistanceTelemetryManager.yw(["highlightPreviewRanges"],!0)}}DWj(Z,db){Z&&this.formulaAssistanceTelemetryManager.Iac.formulaHighlightsCounter++;db&&this.formulaAssistanceTelemetryManager.Iac.parenthesesCouplingCounter++}Uhg(Z,
db,Lb){this.Bz(null,null);this.Jha=void 0;if(this.AK){this.AK=!1;const hc=Z.textBox.caretPosition;Z.textBox.setPlainText(db);Z.textBox.caretPosition=Math.min(hc,db.length);if(Lb)return!0}return!1}ECj(Z,db){var Lb,hc,Pc,Rc;const xd=(null===(Lb=this.Jha)||void 0===Lb?void 0:Lb.XM)===Z&&(null===(hc=this.Jha)||void 0===hc?void 0:hc.b9c.content)===db.content&&(null===(Pc=this.Jha)||void 0===Pc?void 0:Pc.b9c.selection.index)===db.selection.index&&(null===(Rc=this.Jha)||void 0===Rc?void 0:Rc.b9c.selection.length)===
db.selection.length;xd||(this.Jha={b9c:db,XM:Z});return xd}h3h(Z,db,Lb){let hc=Lb;Object(Fe.b)(db)?Object(Fe.b)(Lb)||(hc={index:db.length,length:0}):hc=Z.textBox.selection;return hc}S4a(Z,db){if(this.Vrd&&this.Epi({content:Z,selection:db}))return this.ZR.result;this.formulaAssistanceTelemetryManager.WB(["formulaHighlightsRequest"]);const Lb=this.pluginScheduler.syncRequester().formulaHighlighting({content:Z,caretPosition:db.index,selectionLength:db.length});this.Vrd&&(this.ZR={content:Z,selection:db,
result:Lb});this.formulaAssistanceTelemetryManager.yw(["formulaHighlightsRequest"]);return Lb}NZ(Z,db,Lb){let hc=db.getItem(Z.toString());hc||(hc=qb[db.count%qb.length],db.add(Z.toString(),hc));return String.format(hc,Lb)}FE(Z,db,Lb,hc,Pc=null,Rc=null){w.ULS.shipAssertTag(512349453,0,Lb<=hc,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");Lb<hc&&(db=db.substring(Lb,hc),Z.push(Object(Ha.a)(new ub.a,{text:db,color:Pc,backgroundColor:Rc})))}Bz(Z,db,Lb=null){Z&&Z.length?
(w.ULS.sendTraceTag(512349452,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+Z.length),Z.reverse(),Lb.reverse(),this.gridView.qb.lx(Z,[3],!0,(hc,Pc)=>{if(hc&&hc.range&&Pc){w.ULS.shipAssertTag(512349448,0,db.mb(hc.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${hc.range.toString()}' doesn't exist in the range to color dictionary`);var Rc=this.NZ(hc.range,db,.1),xd=this.NZ(hc.range,db,1);this.$.frame&&this.$.frame.tD&&this.$.frame.tD.zN||(Pc.style.background=
Rc);Pc.style.borderColor=xd;Lb&&(Pc.setAttribute(z.a.v6a,hc.jU.toString()),hc.metadata=Lb[hc.jU])}else w.ULS.shipAssertTag(512349451,0,!!hc,"FormulaHighlightsControl.HighlightRanges: state is null"),w.ULS.shipAssertTag(512349450,0,!!hc.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),w.ULS.shipAssertTag(512349449,0,!!Pc,"FormulaHighlightsControl.HighlightRanges: div is null")})):(Z=this.$.Jb.Ac("UserAction","HideRangesHighlightsStopwatch"),this.gridView.qb.Xg([3]),this.gridView.qb.HSa(new Xb.a(null,
this.$ja()),[3]),Z.stop())}hyc(Z,db,Lb){const hc=Z.textBox;hc.GF=!0;var Pc=hc.selection;const Rc=Pc.index;Pc=Rc+Pc.length;hc.setTextFromTextParts(db);db=hc.text.length;hc.selectRange(Math.min(Rc,db),Math.min(Pc,db));Lb&&Z.FQa(new Uc.a);hc.GF=!1}Scc(){return this.gridView.dr&&this.gridView.dr.dG?this.gridView.dr.dG:this.$.oa}$ja(){return this.Scc().sheetId}lUh(Z,db){const Lb=[],hc=new Ic.a(!1),Pc=[],Rc=[],xd=[];let Wd=!1;var ue=!1;let ve=0;const qe=this.$ja();for(const we of Z){this.FE(Pc,db,ve,we.span.start,
null);switch(we.kind){case 0:case 1:case 2:Z=lb.B(we.rangeInfo.sharedRange);if(isNullOrUndefined(Z)){w.ULS.sendTraceTag(512349464,0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${we.kind.toString()}`);this.FE(Pc,db,we.span.start,we.span.end,null);break}ue=this.NZ(Z,hc,1);this.FE(Pc,db,we.span.start,we.span.end,ue);Lb.push(new Xb.a(Z,qe));Rc.push({Start:we.span.start,End:we.span.end});ue=Pc.length-1;xd.push(new sd(ue,Pc[ue].text,
e(we)));ue=!0;break;case 3:this.FE(Pc,db,we.span.start,we.span.end,null,"rgba(229, 229, 229, 1)"),Wd=!0}ve=we.span.end}this.FE(Pc,db,ve,db.length);this.DWj(ue,Wd);return{dNj:Pc,X8i:Lb,V8i:hc,XCi:xd}}Epi(Z){return Object(Fe.b)(this.ZR)&&this.ZR.content===Z.content&&this.ZR.selection.index===Z.selection.index&&this.ZR.selection.length===Z.selection.length}}Object(d.a)(Sb,"FormulaHighlightsControl",null,[453,2]);class mc{constructor(Z,db,Lb,hc,Pc,Rc,xd){this.$=Z;this.functionInfoManager=db;this.calcManager=
Lb;this.pluginScheduler=hc;this.formulaAssistanceUIControl=Pc;this.formulaAssistanceTelemetryManager=Rc;this.Tg=xd;this.$Sa=!0;this.TMa=this.isCellContentOnlyEqualDuringEdit=!1;this.c6=null;this.ica=-1;this.lW=0;this.Mba=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.XAb=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.vcd=pa.EwaSettings.getBooleanFeatureGate("OfficeVSO:7135425_fixSetFunctionsInfoNotification",
!1);this.KDc=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7262196_updateRequestCacheOnAutoCompleteCommit");this.Rh=(Wd,ue)=>{this.gridView.eb||this.gridView.si||this.gPa(null===ue||void 0===ue?void 0:ue.cell)};this.rh=(Wd,ue)=>{this.gPa(null===ue||void 0===ue?void 0:ue.wja)};this.onFunctionInfoLoaded=()=>{this.vcd||this.functionInfoManager.ucb(this.onFunctionInfoLoaded);this.fig();this.Oda()};this.pyf=()=>{this.$Sa=!1};this.xyf=(Wd,ue)=>{var ve=this.Za;Wd=ve.text;ve=ve.textBox.caretPosition;0<this.lW&&
this.formulaAssistanceTelemetryManager.LJ.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.WB(["argumentAssistanceComputation","argumentAssistanceOverall"]);ue.shouldRequestAutocompleteOnCommit?this.A0f(Wd,ve):this.QMd(Wd,ve)};this.jg=()=>{this.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.mK.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=!1);this.TMa&&(this.formulaAssistanceTelemetryManager.mK.isCellContentFormulaCounter++,
this.TMa=!1);this.$Sa=!0;pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.Q7b()};this.E6=(Wd,ue)=>{this.xOd(ue.newValue)};this.Hj=()=>{this.Zgg()};this.Zgg=()=>{const Wd=this.h7b.sKe;this.pluginScheduler.notifier().setDefinedNamesInfo(Wd);w.ULS.sendTraceTag(512278605,0,50,`FormulaAssistanceManager.updateDefinedNamesList updated defined names info with ${null===Wd||void 0===Wd?void 0:Wd.length} names}`)};this.S4a=(Wd,ue)=>{Wd=this.pluginScheduler.syncRequester().formulaHighlighting({content:Wd,
caretPosition:null===ue||void 0===ue?void 0:ue.index,selectionLength:null===ue||void 0===ue?void 0:ue.length});if(isNullOrUndefined(Wd)||isNullOrUndefined(Wd.formulaHighlights))w.ULS.sendTraceTag(521211933,0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(Wd)}`);else return Wd};this.functionInfoManager=db;this.formulaAssistanceUIControl=Pc;this.pluginScheduler=hc;this.gridView=J.h(this.$);this.kjf=
pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.f5=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.FAd=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.PZc=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.Bli=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");this.kjf&&(this.h7b=new Cb(Z),
this.gridView.Ea.hw(this.Hj),this.Zgg());this.yqa=new Sd(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.f9=new ie(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.Zli=sa.a.eR(Z);this.DHj=sa.a.Epb(Z);this.Hii=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AuthoringPerCharExp",!1);this.bri=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled",!1);this.Zli&&(this.zqa=new Sb(this.$,
this.pluginScheduler,this.formulaAssistanceTelemetryManager));Z.da.Ga(464,this);this.calcManager=Lb;sa.a.AV(this.$)&&this.znd();this.gridView.fc.Rm(this.jg);this.f5&&this.yqa.VJg(this.pyf);this.gpd=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.vcd&&(this.functionInfoManager.DGa(this.onFunctionInfoLoaded),this.functionInfoManager.BV?this.fig():this.functionInfoManager.JJa({}))}get zja(){return this.f9}get xYe(){return this.yqa}get kB(){return this.zqa}get dbb(){return this.Za.Yoi?
1:0}get Za(){return this.gridView.Ai}get Bb(){return this.gridView.Bb}dispose(){if(this.$){const Z=this.gridView;Z&&(Z.ha&&sa.a.AV(this.$)&&(this.XAb?Z.fc.Hk(this.rh):Z.ha.nna(this.Rh)),this.kjf&&Z.Ea&&Z.Ea.gx(this.Hj))}this.gridView.fc.em(this.jg);this.f5&&this.yqa.nfj(this.pyf);this.f9.$ej(this.xyf);this.functionInfoManager&&this.functionInfoManager.ucb(this.onFunctionInfoLoaded);sa.a.Ogc&&this.Za&&this.Za.KJb(this.E6);da.a.Ia(this.yqa);da.a.Ia(this.f9);this.f9=this.yqa=this.functionInfoManager=
this.$=null}bkj(){this.ica=-1;this.c6=null}Q7b(){this.f9.visible=!1;this.yqa.visible=!1}Yh(){this.Oda();return!1}Oda(){if(!this.Za.jL)if(this.formulaAssistanceTelemetryManager.Lpb.formulaAssistanceRequestAttemptedCounter++,this.TBj()){this.vcd||this.functionInfoManager.BV||(this.functionInfoManager.DGa(this.onFunctionInfoLoaded),this.functionInfoManager.JJa({}));var Z=this.Za,db=Z.text;Z=Z.textBox.caretPosition;db.startsWith("=")&&(this.TMa=!0,1===db.length&&(this.isCellContentOnlyEqualDuringEdit=
!0));!this.f5||this.$Sa?(this.formulaAssistanceTelemetryManager.WB("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" ")),this.A0f(db,Z)):(this.formulaAssistanceTelemetryManager.WB(["autoCompleteComputation","autoCompleteOverall"]),this.Jjj(db,Z));this.Hii&&this.Ojj(db,Z)}else this.formulaAssistanceTelemetryManager.Lpb.formulaAssistanceRequestOptimizedCounter++}A0f(Z,
db){const Lb=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:Z,caretPosition:db},argumentAssistance:{content:Z,caretPosition:db}});this.lW+=1;this.KDc&&(this.c6=Z,this.ica=db);Lb.then(hc=>{--this.lW;0===hc.kind&&(this.N8e(hc.payload.argumentAssistance),this.s9e(hc.payload.functionSuggestion,Z));return null})}Jjj(Z,db){const Lb={content:Z,caretPosition:db};this.KDc&&(this.c6=Z,this.ica=db);db=this.Mba?this.pluginScheduler.getRequester().functionSuggestion(Lb,
this.dbb):this.pluginScheduler.requester().functionSuggestion(Lb);this.lW+=1;db.then(hc=>{--this.lW;0===hc.kind&&this.s9e(hc.payload,Z);return null})}Ojj(Z,db){db={content:Z,caretPosition:db,enableAutocompleteWrapperPlugin:this.bri&&!this.DHj};this.Mba&&(db=this.pluginScheduler.getRequester().runPerCharacterExperiment(db,this.dbb),this.lW+=1,db.then(Lb=>{--this.lW;if(0===Lb.kind)for(const hc of Lb.payload.results)0===hc.kind&&this.gridView.uaa.oRd(hc.value,Z);return null}))}QMd(Z,db){const Lb={content:Z,
caretPosition:db};this.KDc&&(this.c6=Z,this.ica=db);Z=this.Mba?this.pluginScheduler.getRequester().argumentAssistance(Lb,this.dbb):this.pluginScheduler.requester().argumentAssistance(Lb);this.lW+=1;Z.then(hc=>{--this.lW;0===hc.kind&&this.N8e(hc.payload)})}TBj(){var Z=this.Za;const db=Z.text;Z=Z.textBox.caretPosition;if(this.f9.visible&&Za.a.equals(db,this.c6,!0)&&(!this.Bli||!va.e(db))&&Z===this.ica)return!1;this.KDc||(this.c6=db,this.ica=Z);return!0}COd(){this.Mba?this.pluginScheduler.getRequester().runExperiment(new ab,
this.dbb):this.pluginScheduler.requester().runExperiment(new ab)}N8e(Z){Z&&this.Za.eb?(this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceComputation"]),this.yqa.show(Z,this.Za.textBox.domElement)):this.yqa.dismiss()}s9e(Z,db){Z&&0<Z.items.length&&this.Za.eb&&this.Za.text===this.c6?this.PZc&&this.Bb.E5(this.gridView.ha.ra.activeCell)?(this.formulaAssistanceTelemetryManager.mK.smartSuggestionWouldSuggestInsidePivotCounter++,this.f9.dismiss()):(this.formulaAssistanceTelemetryManager.yw(["autoCompleteComputation"]),
this.f9.show(Z)):this.f9.dismiss();this.gridView.uaa.oRd(Z,db)}xOd(Z){Z={content:Z,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Mba?this.pluginScheduler.getRequester().runAuthoringExperiment(Z,this.dbb):this.pluginScheduler.requester().runAuthoringExperiment(Z)}gPa(Z){var db;const Lb=this.gridView.ha.ra.activeCell;if(Lb){var hc=this.calcManager.Eta(Lb,!this.gpd);if(hc){var Pc=this.$.xa,Rc=hc.sheet.index;0>=Pc.count||0>Rc||Rc>=Pc.count?w.ULS.sendTraceTag(512278608,0,
50,`FormulaAssistanceManager.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Pc.count}, currentSheetIndex = ${Rc}.`):(Rc=Pc=null,this.FAd&&void 0!==this.calcManager&&null!==this.calcManager&&(Z=null!==(db=null===Z||void 0===Z?void 0:Z.cell)&&void 0!==db?db:this.gridView.Ea.ps(Lb))&&(db=this.calcManager.Ncc(Z.$j),void 0!==db&&null!==db&&(Pc=db.FormatString,Rc=db.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:hc.range.col,rowIndex:hc.range.row,sheetIndex:this.$.xa.getItem(hc.sheet.index).sheetId,
docName:hc.sheet.document.name,docPath:hc.sheet.document.path,formatString:Pc,builtIn:Rc}),w.ULS.sendTraceTag(512278607,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged sent notification to the scheduler. col: ${hc.range.col}, row: ${hc.range.row}, format: ${Pc}`))}else w.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}else w.ULS.sendTraceTag(512278609,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged activeCell range is null")}fig(){const Z=
this.functionInfoManager.Qac;this.pluginScheduler.notifier().setFunctionsInfo(Z);w.ULS.sendTraceTag(512278606,0,50,`FormulaAssistanceManager.updateSchedulerFunctionList update functions info with ${null===Z||void 0===Z?void 0:Z.length} functions}`)}znd(){this.XAb?this.gridView.fc.Yk(this.rh):this.gridView.ha.bha(this.Rh);const Z=sa.a.Mzb()?this.gridView.Sb(null):void 0;this.gPa(Z);sa.a.Ogc&&this.Za.xZa(this.E6);this.COd();this.f9.IJg(this.xyf);this.pluginScheduler.setServerDataProvider(new qc(this.Tg,
this.$));this.Oda()}bgb(Z,db,Lb){Lb=Object(Fe.b)(db)?this.S4a(db,Object(Fe.b)(Lb)?Lb:wc.a):this.S4a(Z.text,Z.textBox.selection);return this.zqa.FSj(Z,db,Lb)}}Object(d.a)(mc,"FormulaAssistanceManager",null,[438,2]);a(184);class Lc extends ib.a{constructor(Z){super();this.$=Z;this.Fb()}create(){var Z=sa.a.AV(this.$);const db=pa.EwaSettings.ma(369),Lb=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),hc=sa.a.zV(this.$),Pc=this.$.da,Rc=m.GetServiceTaskFactory.create(Pc,
134,this.la,this.Ya),xd=m.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya);let Wd;Wd=sa.a.g5(this.$)?m.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):W.Task.Ta(null);let ue;ue=sa.a.AV(this.$)?m.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):W.Task.Ta(null);let ve;ve=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&!hc?m.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):W.Task.Ta(null);if(Lb||Z){const qe=m.GetServiceTaskFactory.Oa(Pc,266,265,this.Ya),
we=m.GetServiceTaskFactory.Oa(Pc,219,220,this.Ya),Ze=m.GetServiceTaskFactory.Oa(Pc,491,492,this.Ya);Z=[qe,ue,Wd,we,Ze,ve];pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&Z.push(Rc,xd);l.TaskExtensions.Aa(l.TaskExtensions.Ed(Z,this.la),()=>{const zf=Pc.za(19)||new me(this.$,ue.result),Ja=we.result;if(hc){var Eb=Pc.za(464);Eb||(Eb=new mc(this.$,zf,qe.result,ue.result,Wd.result,Ze.result,xd.result.a5c(this.$,Rc.result)),Ja.SYc(Eb.xYe),Ja.TYc(Eb.zja),
pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&Ja.UYc(Eb.zja))}else Eb=Pc.za(221),Eb||(Eb=new Nb(this.$,zf,Rc.result,qe.result,null,xd.result,Wd.result,Ze.result,ue.result,ve.result),Ja.SYc(Eb.yYe),Ja.UYc(Eb.RYe),Ja.TYc(Eb)),db&&(Pc.za(317)||new Pa(this.$));this.ob(zf)},this.la,3)}else{const qe=m.GetServiceTaskFactory.Oa(Pc,219,220,this.Ya),we=m.GetServiceTaskFactory.Oa(Pc,491,492,this.Ya);l.TaskExtensions.Aa(l.TaskExtensions.Ed([qe,Wd,ue,ve],this.la),()=>{const Ze=
Pc.za(19)||new me(this.$,ue.result),zf=qe.result;let Ja=Pc.za(221);Ja||(Ja=new Nb(this.$,Ze,Rc.result,null,null,xd.result,Wd.result,we.result,ue.result,ve.result),zf.SYc(Ja.yYe),zf.UYc(Ja.RYe),zf.TYc(Ja));db&&(Pc.za(317)||new Pa(this.$));this.ob(Ze)},this.la,3)}}static ka(Z){Z.da.Ga(153,new Lc(Z))}}Object(d.a)(Lc,"FunctionInfoManagerFactory",ib.a,[]);a.d(E,"a",function(){return rd});const rd=()=>{f.a.Fa(Z=>{Ga.ka(Z);ic.ka(Z);Lc.ka(Z)})}},1138:function(u,E,a){var c=a(0),b=a(692),e=a(149),f=a(7),d=
a(15),h=a(82),m=a(4),l=a(157),w=a(1073),n=a(1071),y=a(716),t=a(5),r=a(463),v=a(560),B=a(76),A=a(58),z=a(905),x=a(132),D=a(42),J=a(188),L=a(60),T=a(50),O=a(749),G=a(142),C=a(37),H=a(116),I=a(208),M=a(91),Q=a(71),U=a(35),N=a(29),W=a(282),X=a(1),sa=a(183),da=a(13),S=a(62),oa=a(281),K=a(21),ea=a(133),ya=a(771),ha=a(772),La=a(124),Ia=a(112),ra=a(51),pa=a(34),ba=a(422);class fa{constructor(){this.Sections=this.Id=null}}Object(c.a)(fa,"AutoFilterMenu",null,[]);class Ka{constructor(){this.Disabled=!1;this.RibbonCommand=
this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(c.a)(Ka,"MenuItem",null,[]);class aa{constructor(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}}Object(c.a)(aa,"MenuSection",null,[]);class ja{constructor(){this.isSuccess=!1}}Object(c.a)(ja,"ApplyFilterByValueResponse",null,[]);class Va{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=
0;this.expanded=!1}}Object(c.a)(Va,"FilterByValueItem",null,[]);class bb{constructor(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}}Object(c.a)(bb,"GetColorsAndIconsResponse",null,[]);class wa{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(c.a)(wa,"GetFilterByValueItemsResponse",null,[]);class ka{constructor(){this.autoFilterMenu=this.targetPoint=null}}
Object(c.a)(ka,"ShowSortFilterMenuParams",null,[]);class ta{constructor(){this.focusShiftOnMenuDismiss=this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}}Object(c.a)(ta,"SortFilterControllerFactoryParams",null,[]);class qa{constructor(){this.top=this.left=0}}Object(c.a)(qa,"TargetPoint",null,[]);var rb=a(55),Za=a(184),gb=a(33),mb=a(155),Ga=a(227),ib=a(8);const cc=t.a.m7g;class ic extends y.a{constructor(qb,
Sb,mc,Lc){super(qb,"PopulateAutoFilterContextMenu",1675506831,1651433993,cc,!0,!1,"AutoFilterContextMenuRoot",Sb,mc,!1,Lc);this.eYc=this.yUa=this.sheetName=this.Qsb=null;this.D3a=this.Fpf=!1;this.j6c=this.Qab=this.eJe=this.iQa=this.Rcc=this.Oad=this.Teb=this.QHb=null;this.ZV=()=>{this.Wzc();this.$.ea.jo(this.ZV)};this.XBf=rd=>{this.D3a||ea.b(this.$).ud(x.a.YBf,this.vm(),void 0,!0);var Z={};this.$.pk(Z);var db=this.$.ea.isNamedObjectViewMode;const Lb=A.a.li(this.eYc);Lb.SheetName=db?Z.NamedObjectName:
Z.SheetName;Lb.NamedObjectView=db;Z=!!rd.searchText;db=586;this.D3a&&(Z&&(Lb.ItemListOptions=this.d$g(rd.searchText),db=597),ea.b(this.$).ud(x.a.YBf,{["UserOperation"]:db.toString()},void 0,!0));const hc=this.CCd(Z),Pc=this.qPi(),Rc=this.$.pa.ya.Wb();this.eJe=Rc.RequestId;this.D3a&&this.Rcc&&!this.Rcc.dequeueUtcTime&&(this.$.userOperationManager.iua(this.Rcc),this.a_g());rd=new J.a(db,0,(xd,Wd,ue)=>this.j6c=L.n(this.$.pa.ya,Lb,oa.b(xd,hc),this.D3a?oa.a(Wd,Pc):Wd,ue,null,Rc),80);this.Rcc=this.$.userOperationManager.Ic(rd,
null);this.Qab=this.j6c;this.iQa=this.eJe};this.onMenuItemClick=(rd,Z,db)=>{ea.b(this.$).ud(x.a.mUi,this.vm(),void 0,!0);Z={["CommandValueId"]:Z,["MenuItemId"]:Z,["InputMethod"]:db,["TopCellAddress"]:this.yUa};const Lb=new M.a(rd,db,this.$.isEditMode?2:1,19,null);this.$.Ja.Kb(Lb,Z);d.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${rd}, ${db}`)};this.focusShiftOnMenuDismiss=()=>{K.h(this.$).focus()};this.myf=rd=>{if(rd.checkedItems&&rd.checkedItems.length){ea.b(this.$).ud(x.a.nyf,
this.vm(),void 0,!0);var Z=A.a.li(this.eYc),db={};this.$.pk(db);db.FirstRow=0;db.FirstColumn=Z.Column;var Lb=this.$.ea.isNamedObjectViewMode;Z.NamedObjectView=Lb;Z.SheetName=Lb?db.NamedObjectName:db.SheetName;var hc=xd=>{if(ya.a.Yyc(xd)){const Wd=ya.a.obc(xd);this.vNa?ya.a.tRa(ha.a.applyItemFilter,Wd.MessageIdName,Ia.a.lHa,!0,ya.a.isSessionEndingError(Wd.MessageId)):d.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${Wd.MessageIdName}`)}W.a(xd)||
(d.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),ea.b(this.$).ud(x.a.RBf,this.vm(),void 0,!0),xd=Object(f.a)(new ja,{isSuccess:!0}),this.Teb.onApplyFilterByValueFinish(xd),this.BS(this.yUa))},Pc=this.O4c(Z,db),Rc=new J.a(208,0,(xd,Wd,ue)=>L.a(this.$.pa.ya,Pc,rd.checkedItems,oa.b(xd,hc),Wd,ue,null,null),6,()=>new z.a(rd.checkedItems,Pc));this.ZEj(()=>{this.$.userOperationManager.Ic(Rc,null)})}else d.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};
this.Pue=rd=>{const Z=D.o(this.yUa,this.$),db=D.v(this.yUa,this.$);var Lb=Object(f.a)(new w.a,{SortConditionType:rd.type,RowColOffset:Z.FirstColumn-db.FirstColumn,SortColor:rd.color,SortIconSet:rd.icon.IconSet,SortIcon:rd.icon.Icon,IsAscending:!0});Lb=Object(f.a)(new n.a,{OperationType:1,ActiveCell:Z,SelectedRange:db,SortConditions:[Lb],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const hc={};hc.SortOptions=Lb;hc.SelectedRange=db;hc.OriginalActiveCell=Z;hc.ShouldRestoreSelection=!1;hc.ShouldPromptNamedSheetViewTeachingDialog=
!0;d.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${rd.type}`);this.$.Xc(-1089513346,B.a.Db,19,{["CustomSortCommandData"]:hc})};this.vNa=ya.a.Aod();this.Cz=X.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get Zw(){return"PopulateAutoFilterContextMenu"}get OB(){return t.a.PPf}executeCommand(qb,Sb,mc){qb=Sb.command;switch(qb){case 1701016594:return y.a.JBh(mc),rb.Task.Ta(!0);case 966232027:if(X.EwaSettings.nl()){const Lc=new l.a;
C.TaskExtensions.Aa(T.GetServiceTaskFactory.Oa(this.$.da,8,9,0),rd=>{this.$9e(Sb,mc,rd.result);Lc.setResult(!0)},this.la,3).continueWith(()=>{Lc.setResult(!1)},5,this.la,Ga.a.instance);return Lc.task}this.$9e(Sb,mc);return rb.Task.Ta(!0);default:return sa.a(qb)}}$9e(qb,Sb,mc){const Lc=Sb.domEvent;if(Q.e(Lc.rawEvent)&&(Q.g(Lc),Lc.target)){var rd=new G.a(this.$.xa);if(rd.Td(4096)||rd.Td(2048)){var Z=A.a.li(Sb[B.a.og]);this.x6f(Z)&&(this.Fpf?this.Puc(Lc,Lc.target,Z,qb,mc):(this.QHb=()=>{this.x6f(Z)&&
(this.efi(),this.Puc(Lc,Lc.target,Z,qb,mc),this.D3a=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),this.Fpf=!0)},this.Wzc()))}}}wc(qb,Sb,mc){if(qb=!!mc)switch(Sb.command){case 1701016594:case 966232027:X.EwaSettings.nl()||r.a(this.$)||(qb=!1,Sb=ra.b().uj(Sb.command),d.ULS.sendTraceTag(537167137,0,15,`AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was ${Sb}`));break;default:qb=!1}return qb}cGd(qb){qb.MenuSectionList.push(...this.Qsb)}efi(){ba.a(()=>
{X.EwaSettings.isChangeGateEnabled("OfficeVSO:7271429_FocusShiftOnMenuDismiss_ViewportRegressionFix")?this.Teb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new ta,{getFilterByValueItemsRequest:this.XBf,applyFilterByValueRequest:this.myf,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,autoFilterMenuWidth:ic.fZc,applySortByColorOrIconRequest:this.Pue})):this.Teb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new ta,
{getFilterByValueItemsRequest:this.XBf,applyFilterByValueRequest:this.myf,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:ic.fZc,applySortByColorOrIconRequest:this.Pue}))});this.Oad=h.a.instance.Kh("Common.IExternalUICommandDefinitionMapping")||new v.a(this.$.Eb,this.$)}Puc(qb,Sb,mc,Lc,rd){ea.b(this.$).ud(x.a.Puc,this.vm(),void 0,!0);if(mc){qb=this.PMh(mc,rd);Lc=Sys.UI.DomElement.getBounds(Sb);Sb=Lc.x+Lc.width;Lc=Lc.y;if(this.Cz&&!mc.IsHeaderSnapped){if(!y.a.epd(this.$,mc.Cell))return;mc=
y.a.cfd(this.$,mc.Cell,!0);Sb=mc.x;Lc=mc.y}mc=K.h(this.$).rtl?new Sys.UI.Point(Sb-pa.a(this.$).UGa(ic.fZc),Lc):new Sys.UI.Point(Sb,Lc);mc=pa.a(this.$).cka(mc);mc=Object(f.a)(new ka,{targetPoint:Object(f.a)(new qa,{left:mc.x,top:mc.y}),autoFilterMenu:qb});this.Teb.showSortFilterMenu(mc);this.$.Xc(-544117314,-1,0,null)}else d.ULS.shipAssertTag(537167135,0,!!mc,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}x6f(qb){return(null===qb||void 0===qb?0:qb.Cell.SheetName)?K.h(this.$).x5?
qb.Cell.SheetName===this.$.oa.name:qb.Cell.SheetName===this.$.oa.sheetName:!0}PMh(qb,Sb){return(qb=this.QMh(qb,Sb))?this.GNf(qb):null}GNf(qb){const Sb=[];for(const mc of qb.Sections){if(Object(mb.g)(this.$)&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&mc.Title===da.a.instance.ga(1942))continue;const Lc=this.i5i(mc);Sb.push(Lc)}return Object(f.a)(new fa,{Id:qb.Id,Sections:Sb})}i5i(qb){const Sb=[];for(const mc of qb.MenuItems)if(2===mc.Identifier)this.eYc=mc.CommandData;
else switch(mc.Type){case 3:case 2:Sb.push(this.g5i(mc,2===mc.Type));break;case 1:Sb.push(this.h5i(mc))}return Object(f.a)(new aa,{MenuItems:Sb,DisplayType:qb.DisplayType,Id:this.nKh(qb)})}h5i(qb){({label:rd,pMa:Lc}=this.zZe(qb));const Sb=this.GNf(qb.SubMenu),mc=this.pZe(qb);var Lc=this.Oad.dcc(Lc);var rd=rd||qb.Label;return Object(f.a)(new Ka,{Disabled:qb.Disabled,Type:qb.Type,Identifier:qb.Identifier,Id:mc,CommandData:qb.CommandData,Label:rd,SubMenu:Sb,IsChecked:qb.IsChecked,IconName:"MissingIcon_20"===
Lc?null:Lc})}g5i(qb,Sb){let mc;({label:Sb,pMa:rd,Mr:mc}=this.Yac(qb,Sb&&qb.IsChecked));const Lc=this.Wdd(qb,Sb);var rd=this.Oad.dcc(rd);return Object(f.a)(new Ka,{Disabled:qb.Disabled,Type:qb.Type,Identifier:qb.Identifier,Id:Lc,RibbonCommand:mc,CommandData:qb.CommandData,Label:Sb||qb.Label,SubMenu:null,IsChecked:qb.IsChecked,IconName:"MissingIcon_20"===rd?null:rd})}QMh(qb,Sb){var mc;this.yUa=mc=D.C(qb.Cell);this.sheetName=this.$.oa.sheetName;Sb=Sb||r.a(this.$);if(qb.IsHeaderSnapped)mc=Sb.M$b.fUh(mc);
else{Sb=K.h(this.$).Ea.kLa(mc);if(!Sb)return this.vNa?ya.a.tRa(ha.a.RPf,La.a.r5h,Ia.a.Kpb,!0,!1):(qb=K.h(this.$).view.visibleArea,d.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${mc}, visible range: ${qb}`)),null;mc=Sb.autoFilterMenu}if(!mc)return this.vNa?ya.a.tRa(ha.a.RPf,La.a.kEi,Ia.a.Kpb,!0,!1):d.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.Htb=qb.Cell.FirstRow+"_"+qb.Cell.FirstColumn;return mc}Wzc(){if(this.$.ea.sg){const qb=T.GetServiceTaskFactory.Oa(this.$.da,283,284,1);C.TaskExtensions.Aa(qb,()=>{this.vNa?qb.result.ln.loadScript("sortFilter").then(()=>{this.QHb()},Sb=>{S.a.Vk(Sb,"AutoFilterContextMenu.SortFilterScriptLoad");ya.a.tRa(ha.a.Wzc,La.a.UHj,Ia.a.Kpb,!1,!1)}):C.TaskExtensions.Aa(Za.c(qb.result.ln.loadScript("sortFilter")),()=>{this.QHb()},this.$.la,3)},this.$.la,3)}else this.$.ea.Ak(this.ZV)}d$g(qb){const Sb={};
Sb.SearchText=qb;Sb.Page=1;Sb.DateNodeType=-1;return Sb}a_g(){this.iQa&&(d.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.iQa}`),L.h(this.$.pa.ya,this.iQa,null,null,null),this.iQa=null);this.Qab&&(m.AFrameworkApplication.Dd.Ru(this.Qab.lu),this.Qab=null)}CCd(qb){return Sb=>{this.Qab=this.iQa=null;if(ya.a.Yyc(Sb)){var mc=ya.a.obc(Sb);this.vNa?ya.a.tRa(qb?ha.a.searchAutoFilterItemList:ha.a.getAutoFilterItemList,
mc.MessageIdName,Ia.a.Kpb,!0,!0):d.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${mc.MessageIdName}`)}if(!W.a(Sb)){d.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");Sb=Sb.Result;mc=new U.a(!0);const Lc=Sb.AutoFilterDateNodes?!0:!1;Sb.AutoFilterItems&&mc.add("AutoFilterItemsCount",Sb.AutoFilterItems.length);Lc&&mc.add("AutoFilterDateItemsCount",Sb.AutoFilterDateNodes.length);
mc.add("Location","contextMenu");ea.b(this.$).ud(x.a.CCd,mc.Eu,void 0,!0);mc=this.D3a?Object(f.a)(new wa,{filterByValueItems:this.AFe(Sb),hasMoreRecords:Sb.ItemListMaxExceeded,searchText:Sb.SearchText}):Object(f.a)(new wa,{filterByValueItems:this.AFe(Sb),hasMoreRecords:Sb.ItemListMaxExceeded});this.Teb.onGetFilterByValueItemsFinish(mc);qb||(d.ULS.shipAssertTag(529063959,0,null!==Sb.FontColors&&null!==Sb.CellColors&&null!==Sb.Icons&&null!==Sb.SelectedSortFontColors&&null!==Sb.SelectedSortCellColors&&
null!==Sb.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),Sb=Object(f.a)(new bb,{fontColors:Sb.FontColors,cellColors:Sb.CellColors,icons:Sb.Icons,selectedSortFontColor:0<Sb.SelectedSortFontColors.length?Sb.SelectedSortFontColors[0]:null,selectedSortCellColor:0<Sb.SelectedSortCellColors.length?Sb.SelectedSortCellColors[0]:null,selectedSortIcon:0<Sb.SelectedSortIcons.length?Sb.SelectedSortIcons[0]:null,getColorName:this.getColorName}),
this.Teb.onGetColorsAndIconsFinish(Sb))}}}qPi(){return qb=>{this.Qab=this.iQa=null;qb=H.a.Pe(qb.data);qb=N.a.sc(qb);d.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${qb}].`)}}AFe(qb){const Sb=this.O7g(qb),mc=this.W7g(qb.AutoFilterItems),Lc=[],rd=[];let Z=0,db=0;qb.HasBlanks&&(qb=ic.b5c(da.a.instance.ga(782),qb.IsBlanksSelected?1:0,t.a.lwe),Lc[Z++]=qb);for(const Lb of Sb)Lc[Z++]=Lb;if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const Lb of mc)-1!==
Array.indexOf(ib.a.r$c,Lb.displayText)?rd[db++]=Lb:Lc[Z++]=Lb;else for(const Lb of mc)Lc[Z++]=Lb;return Array.prototype.concat(rd,Lc)}O7g(qb){const Sb=[];if(!qb.AutoFilterDateNodes||!qb.AutoFilterDateNodes.length)return Sb;const mc=[this.X4a(qb.YearKeys,qb.YearValues),this.X4a(qb.MonthKeys,qb.MonthValues),this.X4a(qb.DayKeys,qb.DayValues),this.X4a(qb.HourKeys,qb.HourValues),this.X4a(qb.MinuteKeys,qb.MinuteValues),this.X4a(qb.SecondKeys,qb.SecondValues)];let Lc=!1,rd=!1,Z=0;var db=null;const Lb=Array(6);
var hc=null;for(const Pc of qb.AutoFilterDateNodes){Lb[0]&&(hc.Year!==Pc.Year?(Lc=!0,Z=0,db=null):hc.Month!==Pc.Month?(rd=!0,Z=1,db=Lb[0]):hc.Day!==Pc.Day?(Z=2,db=Lb[1]):qb.ShowTime&&(hc.Hour!==Pc.Hour?(Z=3,db=Lb[2]):hc.Minute!==Pc.Minute?(Z=4,db=Lb[3]):(Z=5,db=Lb[4])));for(;6>Z;){let Rc;switch(Z){case 0:Rc=Pc.Year;hc=mc[0].getItem(Rc.toString());break;case 1:Rc=Pc.Month;hc=mc[1].getItem(Rc.toString());break;case 2:Rc=Pc.Day;hc=mc[2].getItem(Rc.toString());break;case 3:Rc=Pc.Hour;hc=mc[3].getItem(Rc.toString());
break;case 4:Rc=Pc.Minute;hc=mc[4].getItem(Rc.toString());break;case 5:Rc=Pc.Second;hc=mc[5].getItem(Rc.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}hc=ic.b5c(hc,-1!==Pc.NodeType&&Z>=Pc.NodeType?1:0,db?db.key+";"+Rc:t.a.gZc+Rc,!1,[]);db=db?db.children:Sb;db=db[db.length]=hc;Lb[Z]=hc;switch(Z){case 5:Z=6;break;case 2:Z=qb.ShowTime?Z+1:6;break;default:Z++}}hc=Pc}Lc||(Lb[0].expanded=!0,rd||(Lb[1].expanded=!0));return Sb}W7g(qb){const Sb=[];if(!qb)return Sb;
let mc=0;for(const Lc of qb)Sb[mc++]=ic.b5c(Lc.DisplayString,Lc.Selected?1:0,t.a.hZc+Lc.DisplayString);return Sb}X4a(qb,Sb){const mc=new U.a(!0);if(!qb||!Sb)return mc;const Lc=qb.length<Sb.length?qb.length:Sb.length;for(let rd=0;rd<Lc;rd++)mc.add(qb[rd].toString(),Sb[rd]);return mc}O4c(qb,Sb){const mc={};mc.Location=Sb;mc.FieldId=qb.Id.toString();mc.DataSourceIndex=-1;mc.FilterType=qb.AutoFilterType;mc.AnchorType=0;mc.ChartId=null;mc.AnchorValue1=-1;mc.AnchorValue2=-1;mc.Property=qb.RichProperty;
return mc}BS(qb){gb.a.ola(this.$)&&C.TaskExtensions.Aa(T.GetServiceTaskFactory.Oa(this.$.da,430,431,1),Sb=>{Sb.result.Lea(qb);d.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)}vm(){return{["Location"]:"contextMenu"}}getColorName(qb){return O.a.iLa(I.a.GH(qb))}ZEj(qb){C.TaskExtensions.Aa(T.GetServiceTaskFactory.Oa(this.$.da,309,310,3),Sb=>{Sb.result.mTa().continueWith(mc=>{mc.result&&qb()})},this.$.la,
3)}static b5c(qb=null,Sb=0,mc=null,Lc=!1,rd=null){return Object(f.a)(new Va,{displayText:qb?y.a.dg(qb):qb,state:Sb,key:mc,parent:null,children:rd,indentationLevel:0,expanded:Lc})}}ic.fZc=268;Object(c.a)(ic,"AutoFilterContextMenu",y.a,[]);var xb=a(723),Vb=a(83),wb=a(187),cb=a(70),lb=a(19);class Y{}Y.sWe=26;Y.Obd=[228,229,0,99,0,95,94];Object(c.a)(Y,"Constants",null,[]);class Oa{constructor(qb,Sb,mc,Lc){this.cyg=qb;this.Lsg=Sb;this.Psg=mc;this.nCg=Lc}get Bni(){return 3===this.b6b}get tri(){return 4===
this.b6b&&!!this.subMenu}get subMenu(){return this.nCg}get kuf(){return this.cyg}get b6b(){return this.Lsg}get z6c(){return this.Psg}}Object(c.a)(Oa,"FiltersMenuData",null,[]);class Wa extends Oa{constructor(qb,Sb){super(qb,2,0,null);this.mwe=Sb}}Object(c.a)(Wa,"AutoFilterFiltersMenuData",Oa,[]);class Ca{}Ca.WMj=[new Oa(100,2,0,null),new Oa(101,2,1,null),new Oa(0,3,0,null),new Oa(170,2,2,null),new Oa(172,2,4,null),new Oa(0,3,0,null),new Oa(174,2,6,null),new Oa(175,2,7,null),new Oa(0,3,0,null),new Oa(108,
0,0,null)];Ca.IIi=[new Oa(100,2,0,null),new Oa(101,2,1,null),new Oa(0,3,0,null),new Oa(102,2,8,null),new Oa(103,2,10,null),new Oa(104,2,12,null),new Oa(0,3,0,null),new Oa(105,1,0,null),new Wa(106,1),new Wa(107,2),new Oa(0,3,0,null),new Oa(108,0,0,null)];Ca.Sgh=[new Oa(100,2,0,null),new Oa(0,3,0,null),new Oa(112,2,10,null),new Oa(113,2,8,null),new Oa(104,2,12,null),new Oa(0,3,0,null),new Wa(110,8),new Wa(109,9),new Wa(111,10),new Oa(0,3,0,null),new Wa(115,11),new Wa(114,12),new Wa(116,13),new Oa(0,
3,0,null),new Wa(117,14),new Wa(118,15),new Wa(119,16),new Oa(0,3,0,null),new Wa(120,17),new Wa(121,18),new Wa(122,19),new Oa(0,3,0,null),new Wa(123,20),new Wa(124,21),new Wa(125,22),new Oa(0,3,0,null),new Wa(126,23),new Oa(127,2,12,[new Wa(128,24),new Wa(129,25),new Wa(130,26),new Wa(131,27),new Oa(0,3,0,null),new Wa(132,28),new Wa(133,29),new Wa(134,30),new Wa(135,31),new Wa(136,32),new Wa(137,33),new Wa(138,34),new Wa(139,35),new Wa(140,36),new Wa(141,37),new Wa(142,38),new Wa(143,39)]),new Oa(0,
3,0,null),new Oa(108,0,0,null)];Object(c.a)(Ca,"Constants",null,[]);var Ra=a(906),la=a(79);class ua extends y.a{constructor(qb,Sb,mc,Lc){super(qb,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,ua.sDh,!0,!1,ua.SKb,Sb,mc,!1,Lc);this.tm=null}get Zw(){return"PopulateAutoFilterFieldListContextMenu"}get OB(){return t.a.QPf}executeCommand(qb,Sb,mc){qb=Sb.command;switch(qb){case -699941697:this.applyAutoFilterFieldList(Sb,mc);break;case 216058793:break;case -1494291901:break;default:return sa.a(qb)}return rb.Task.Ta(!0)}Ued(qb,
Sb){return!qb||qb.length<=Sb?(d.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(qb[Sb],10)}GHd(qb,Sb,mc,Lc,rd,Z){const db=this.Ued(rd,Z);0>db&&d.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Y.Obd[db]){case 99:qb=new M.a(-2058042992,Sb.method,Sb.mode,Sb.$e,Sb.tabName);this.tm.mH.Rub(this.$,Lc,0,qb);break;case 228:qb=new M.a(504133448,Sb.method,Sb.mode,Sb.$e,Sb.tabName);
this.tm.mH.Rub(this.$,Lc,0,qb);break;case 229:qb=new M.a(-798968736,Sb.method,Sb.mode,Sb.$e,Sb.tabName);this.tm.mH.Rub(this.$,Lc,0,qb);break;case 233:qb=new M.a(-1677817820,Sb.method,Sb.mode,Sb.$e,Sb.tabName);this.tm.mH.Rub(this.$,Lc,0,qb);break;case 95:this.XNf(qb,Sb,Lc,mc,rd,Z+1);break;case 94:this.tm.mH.rvi(this.$,Lc)}}XNf(qb,Sb,mc,Lc,rd,Z){const db=this.Ued(rd,Z);0>db&&d.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!Lc||db>=
Lc.length)d.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(Lc=Lc[db],Lc.b6b){case 1:this.tm.mH.Kvi(this.$,mc);break;case 2:(rd=Object(Vb.a)(Wa,Lc))?(qb=new M.a(-2058042992,Sb.method,Sb.mode,Sb.$e,Sb.tabName),this.tm.mH.Rub(this.$,mc,rd.mwe,qb)):this.tm.mH.tof(this.$,qb,mc,Lc.z6c);break;case 0:this.tm.mH.tof(this.$,qb,mc,Lc.z6c);break;case 4:this.XNf(qb,Sb,mc,Lc.subMenu,rd,Z+1)}}applyAutoFilterFieldList(qb,Sb){var mc=Sb[xb.a.uG];
if(mc)if(mc=mc.split(cb.a.GU),3>mc.length)d.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var Lc=this.Ued(mc,1),rd=this.XKa(Lc),Z=this.fuf(Lc).returnValue;Z?this.GHd(Sb,qb,Z,rd,mc,2):d.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+Lc.toString()+cb.a.GU)}else d.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}wc(qb,
Sb){if(qb=this.$.isEditMode)switch(Sb.command){case 216058793:break;case -699941697:break;case -1494291901:qb=!0;break;default:qb=!1}return qb}Y0(qb,Sb,mc){this.$.isEditMode&&((this.tm=Object(Vb.a)(445,mc))||d.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.hZ(),super.Y0(qb,Sb,null,null,!0))}V4c(){if(!this.tm||!this.tm.al||1!==this.tm.al.length)return d.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),
null;const qb=this.tm.al[0];let Sb=new wb.a;Sb.add(da.a.instance.ga(249));Sb=la.OBc(la.concat(Sb,la.select(la.asEnumerable(qb.FieldInfoDataList),mc=>mc.Name)),mc=>mc,new Ra.a);return la.toArray(Sb)}fieldIndex(qb){if(!this.tm||!this.tm.al||1!==this.tm.al.length||!this.tm.al[0].FieldInfoDataList)return-1;for(let Sb=0;Sb<this.tm.al[0].FieldInfoDataList.length;++Sb)if(this.tm.al[0].FieldInfoDataList[Sb].Name===qb)return Sb;return-1}XKa(qb){return 0>qb||!this.tm||!this.tm.al||1!==this.tm.al.length||!this.tm.al[0].FieldInfoDataList||
this.tm.al[0].FieldInfoDataList.length<qb?null:this.tm.al[0].FieldInfoDataList[qb].Name}hZ(){var qb=this.V4c();if(!qb||!qb.length)return null;const Sb=this.Va,mc=Sb.Ec();for(let db=0;db<qb.length;++db){const Lb=qb[db],hc=0<db?this.fieldIndex(Lb):-1,Pc=ua.z9f+hc.toString()+cb.a.GU;let Rc=null;const xd=this.tm.mH.X8h(0<db?Lb:null),Wd=this.f5c(Sb,xd,ua.z9f+hc.toString(),Lb);for(let ue=0;ue<Y.Obd.length;++ue){var Lc=Y.Obd[ue],rd=Pc+ue.toString();Rc||(Rc=Sb.Ec());switch(Lc){case 228:Rc.buttons.push(Sb.Nc(223,
rd,-699941697,this.tm.mH.dri(0<db?Lb:null)?lb.a.T9b:lb.a.RJa,8,228,!1,null));break;case 229:Rc.buttons.push(Sb.Nc(224,rd,-699941697,this.tm.mH.eri(0<db?Lb:null)?lb.a.U9b:lb.a.SJa,8,229,!1,null));break;case 233:Rc.buttons.push(Sb.Nc(225,rd,-699941697,lb.a.Q9b,1,233,!1,null));break;case 99:Lc=this.BWg(Lb);rd=Sb.AIa(rd+(xd?".enabled":".disabled"),Lc,-699941697,null,"None",null,!xd,void 0,!0);rd.oS("Image16by16",8,lb.a.n3a);Rc.buttons.push(rd);break;case 95:var Z=void 0;const ve=({BWe:Z,isChecked:Lc}=
this.fuf(hc)).returnValue;if(!ve)return null;Z=this.f5c(Sb,Lc&&xd,rd,Z);rd=this.EZe(Z.menu,Sb,rd+cb.a.GU,ve,Lc&&xd);Z.menu.tc.push(rd);Rc.buttons.push(Z);break;case 0:Rc&&(Wd.menu.tc.push(Rc),Rc=null);break;default:rd=Sb.AIa(rd,da.a.instance.ga(Lc),-699941697,null,"None",null,!1,void 0,!0),this.W1f(rd,xd&&94===Lc&&this.tm.mH.filter(),da.a.instance.ga(Lc)),Rc.buttons.push(rd)}}Wd.menu.tc.push(Rc);mc.buttons.push(Wd)}qb=Sb.aq(this.menuId);qb.tc.push(mc);return qb}EZe(qb,Sb,mc,Lc,rd){let Z=null;for(let Rc=
0;Rc<Lc.length;++Rc){var db=Lc[Rc],Lb=mc+Rc.toString(),hc=!1;switch(db.b6b){case 1:hc=rd&&this.tm.mH.Vh.IsTop10;break;case 2:hc=Object(Vb.a)(Wa,db);hc=rd&&this.tm.mH.hki(hc?hc.mwe:0,db.z6c);break;case 0:hc=rd&&this.tm.mH.Vh.IsCustomSupportedAndNotPresent}Z||(Z=Sb.Ec());if(db.Bni)Z&&(qb.tc.push(Z),Z=null);else if(db.tri){var Pc=da.a.instance.ga(db.kuf);Pc=this.f5c(Sb,hc,Lb,Pc);Pc.menu.tc.push(this.EZe(Pc.menu,Sb,Lb+cb.a.GU,db.subMenu,hc));Z.buttons.push(Pc)}else db=da.a.instance.ga(db.kuf),Lb=Sb.AIa(Lb,
db,-699941697,null,"None",null,!1,void 0,!0),this.W1f(Lb,hc,db),Z.buttons.push(Lb)}return Z}W1f(qb,Sb,mc){Sb?qb.oS("Image16by16",8,lb.a.Yua):qb.oS("None",0,null);qb.mS(mc);qb.label=mc}f5c(qb,Sb,mc,Lc){return Sb?qb.W4c(mc,this.menuId,Lc,798637440,8,lb.a.Yua):qb.tw(mc,this.menuId,Lc,798637440)}Dh(qb){return!qb||!qb.length}fuf(qb){var Sb=0>qb?0:this.tm.al[0].FieldInfoDataList[qb].MajorityDataTypeForField;var mc=null;qb=this.tm.mH.W8h(Sb);switch(Sb){case 0:mc=96;Sb=Ca.WMj;break;case 1:mc=95;Sb=Ca.IIi;
break;case 2:mc=97;Sb=Ca.Sgh;break;default:return d.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,BWe:mc,isChecked:qb}}mc=da.a.instance.ga(mc);return{returnValue:Sb,BWe:mc,isChecked:qb}}BWg(qb){return!qb||this.Dh(qb.trim())?da.a.instance.ga(98):qb.length>Y.sWe?String.format(da.a.instance.nb(155),qb.substring(0,Y.sWe)):String.format(da.a.instance.nb(156),qb)}}ua.sDh=t.a.l7g;ua.SKb="AutoFilterFieldListContextMenuRoot";
ua.z9f="ApplyAutoFilterFieldList.";Object(c.a)(ua,"AutoFilterFieldListContextMenu",y.a,[]);var xa=a(548),fb=a(836),Jb=a(11),Ob=a(122),eb=a(372),Ma=a(773);class va extends y.a{constructor(qb,Sb,mc,Lc,rd="PopulateFloatingObjectContextMenu",Z=-2017893763,db=1350204367,Lb=t.a.s7g,hc=!0,Pc=!1){super(qb,rd,Z,db,Lb,hc,Pc,Lb,Sb,mc,!0,Lc);this.floatingObject=null;this.tb=0;this.wmc=!0}get Zw(){return"PopulateFloatingObjectContextMenu"}get OB(){return t.a.YPf}executeCommand(qb,Sb,mc){qb=Object(Vb.a)(xa.a,mc.eventArgs);
switch(Sb.command){case -1372040782:mc=K.h(this.$).ha.Sa.$b;d.ULS.shipAssertTag(537167048,0,!!mc);mc&&(this.floatingObject=mc.floatingObject,this.tb=Sb.method,Sb=this.Mbc(qb),this.Qp(Sb,!0,qb.tb));break;case 848910589:qb&&(Sb=[fb.a.j5f],qb=new Sys.UI.Point(qb.Ca.clientX,qb.Ca.clientY),this.showFloatie(Sb,new Sys.UI.Bounds(qb.x,qb.y,0,0),2))}return rb.Task.Ta(!0)}wc(qb,Sb,mc){switch(Sb.command){case -1372040782:return!!mc&&this.wlf(qb);case 848910589:return qb=K.h(this.$).ha.Sa.$b,!!mc&&!!qb&&qb.eb;
default:return!1}}wlf(qb){switch(qb){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}GVc(qb,Sb,mc){eb.a(this.$)?K.h(this.$).ib.tj||(pa.a(this.$).UTd()?mc.buttons.push(qb.pb(265)):mc.buttons.push(qb.pb(264))):(this.$.isEditMode&&3===this.tb&&!this.pac()&&mc.buttons.push(qb.pb(101)),5!==this.floatingObject.type||Ob.a.YH(this.floatingObject.Ab)||this.floatingObject.Ab.IsGroup||(this.ksd()?mc.buttons.push(qb.pb(186)):mc.buttons.push(qb.pb(147))),this.pac()||this.ksd()||mc.buttons.push(qb.pb(146)),
X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.oJh(mc),this.OKh(mc)),X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&mc.buttons.push(qb.pb(287)),X.EwaSettings.ma(164)&&0===this.floatingObject.type&&mc.buttons.push(qb.pb(249)),5===this.floatingObject.type&&K.h(this.$).ha.Sa.$b.K5()&&this.$.z5&&this.$.X2&&mc.buttons.push(qb.pb(273)))}$Ka(qb){const Sb=[];if(eb.a(this.$))return Sb;3===qb?(qb=!!this.$.ie.get(5)&&
this.floatingObject.kXd(),this.pac()||(this.$.isEditMode?(qb&&Sb.push(fb.a.sGh),5===K.h(this.$).ha.Sa.bB.floatingObject.type&&Sb.push(fb.a.fzj)):qb&&Sb.push(fb.a.copy)),Sb.push(fb.a.tGh)):2===qb&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?K.h(this.$).ha.Sa.$b&&this.J3e(K.h(this.$).ha.Sa.$b,Sb):this.J3e(K.h(this.$).ha.Sa.bB,Sb));return Sb}hZ(){const qb=this.Va,Sb=qb.aq(this.menuId);var mc=eb.a(this.$);if(this.$.isEditMode){var Lc=qb.Ec();this.GVc(qb,
Sb,Lc);Sb.tc.push(Lc)}this.$.ie.get(5)&&this.floatingObject.kXd()&&!this.pac()&&!mc&&(Lc=qb.Ec(),this.gGg(qb,Lc),Sb.tc.push(Lc));(Lc=this.$.xa.oa)&&Lc.Gd&&(Lc=Lc.Gd.Gv||Lc.Gd.gI,!X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||!Ma.g(this.$)||this.$.ea.isNamedObjectViewMode||mc||this.$.isMobileMode||Lc||(mc=qb.Ec(),this.dIg(qb,mc),Sb.tc.push(mc)));return Sb}Mbc(qb){var Sb=K.h(this.$).ha.Sa.$b;qb=qb&&1!==qb.tb&&qb.clientPoint?qb.clientPoint:
Sys.UI.DomElement.getLocation(Sb.domElement);const mc=this.$.domElement,Lc=K.h(this.$).rtl;(Sb=Jb.HelperMethods.oD(Sb.pg.domElement,mc,Lc))?(qb.y=Math.max(qb.y,Sb.y),qb.x=Math.max(qb.x,Sb.x)):d.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${m.AFrameworkApplication.Ng}`);return qb}ksd(){const qb=K.h(this.$).ha.Sa.$b;return!!qb&&qb.eb}gGg(qb,Sb){if(this.$.isEditMode){Sb.buttons.push(qb.pb(42));
Sb.buttons.push(qb.pb(43));const mc=this.$.da.za(254,!0);(mc&&2===mc.FCb()||this.ksd())&&Sb.buttons.push(qb.pb(44))}else Sb.buttons.push(qb.pb(43))}dIg(qb,Sb){Sb.buttons.push(qb.pb(274))}pac(){return X.EwaSettings.ma(461)&&!!K.h(this.$).ha.Sa.mo}J3e(qb,Sb){5===qb.floatingObject.type?qb.eb?Sb.push(fb.a.j5f):Sb.push(fb.a.bzj):Sb.push(y.a.DXe)}oJh(qb){const Sb=this.Va.Ec();Sb.buttons.push(this.Va.pb(282));Sb.buttons.push(this.Va.pb(281));const mc=this.Va.tw("BringToFront","BringToFrontMenuId",da.a.instance.ga(822),
-1777747317);mc.menu.tc.push(Sb);qb.buttons.push(mc)}OKh(qb){const Sb=this.Va.Ec();Sb.buttons.push(this.Va.pb(284));Sb.buttons.push(this.Va.pb(283));const mc=this.Va.tw("SendToBack","SendToBackMenuId",da.a.instance.ga(823),-1777747317);mc.menu.tc.push(Sb);qb.buttons.push(mc)}}Object(c.a)(va,"FloatingObjectContextMenu",y.a,[]);var Pa=a(787),Ha=a(101),tb=a(555),Ya=a(516);const V=t.a.o7g;class za extends va{constructor(qb,Sb,mc,Lc){super(qb,Sb,mc,Lc,"PopulateChartContextMenu",-498523270,1640762262,V);
this.isPivotChart=this.refresh=this.BZ=this.Lwa=this.BBa=!1}get Zw(){return"PopulateChartContextMenu"}get OB(){return t.a.SPf}executeCommand(qb,Sb,mc){const Lc=this.$;this.tb=Sb.method;Sb=mc[za.m1c];if(!(qb&68)){if(!Sb){if(8===qb)Sb=Ya.a(Lc).Vc;else{var rd=K.h(Lc).ha.Sa.$b;if(null===rd||void 0===rd?0:rd.floatingObject)Sb=rd.floatingObject.Vc}if(!Sb)return rb.Task.Ta(!0)}this.isPivotChart=!!(Sb.Attributes&4)}if(this.isPivotChart||Lc.isEditMode)if(this.refresh=this.BZ=this.Lwa=this.BBa=!1,rd=K.h(this.$).ha.Sa.$b,
d.ULS.shipAssertTag(537167107,0,!!rd),rd){this.floatingObject=rd.floatingObject;rd=tb.a(Lc);if(null===rd||void 0===rd?0:rd.oTd)this.BBa=rd=Ha.f(Lc.lg),this.Lwa=!rd;rd=Lc.dc;this.BZ=!!Pa.a(Lc)&&!!Sb&&!!(Sb.Attributes&512)&&!(qb&8)&&rd.W2(32768);rd.allowManualDataRefresh&&rd.allowInteractivity&&(this.refresh=!0);qb=this.Mbc(Object(Vb.a)(xa.a,mc.eventArgs));this.Qp(qb,!0)}return rb.Task.Ta(!0)}wc(qb,Sb,mc){return-149612405===Sb.command&&!!mc&&this.wlf(qb)}GVc(qb,Sb,mc){this.isPivotChart&&(this.refresh&&
mc.buttons.push(qb.pb(100)),this.BZ&&mc.buttons.push(qb.pb(99)),this.BBa?mc.buttons.push(qb.pb(59)):this.Lwa&&mc.buttons.push(qb.pb(58)));super.GVc(qb,Sb,mc)}static get m1c(){return"chartMetaData"}}Object(c.a)(za,"ChartContextMenu",va,[]);var yb=a(12);const jc=t.a.q7g;class Cc extends y.a{constructor(qb,Sb,mc,Lc){super(qb,"PopulateFieldListContextMenu",-1045020714,-170383950,jc,!0,!1,jc,Sb,mc,!1,Lc);this.SL=this.Do=null;this.mXd=this.isOlap=this.HV=this.l_=!1}get Zw(){return"PopulateFieldListContextMenu"}get OB(){return t.a.SId}executeCommand(qb,
Sb,mc){qb=Sb.command;switch(qb){case 330754562:Sb=mc.domElement;this.isOlap=mc.isOlap;this.SL=mc.versionkey;this.Do=mc.fieldItem;this.l_=mc.isChart;this.HV=mc.isPpm;this.mXd="supportsImplicitMeasures"in mc?mc.supportsImplicitMeasures:!1;K.h(this.$).Uo(!0);Sb=yb.DOMElementExtensions.getBounds(Sb);Sb=new Sys.UI.Point(Sb.x+Sb.width,Sb.y+Sb.height/2);"isKeyboardInput"in mc&&mc.isKeyboardInput?this.Qp(Sb,!1,1):this.Qp(Sb,!1);break;case 926905850:this.mXd&&this.Do&&5===this.Do.TypeTag&&!this.Do.IsCollapsible&&
d.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");tb.a(this.$).dK(this.Do,8,-1,this.SL,Sb);break;case -67292059:tb.a(this.$).dK(this.Do,1,-1,this.SL,Sb);break;case 745182485:tb.a(this.$).dK(this.Do,2,-1,this.SL,Sb);break;case 359279088:tb.a(this.$).dK(this.Do,4,-1,this.SL,Sb);break;case 547535945:tb.a(this.$).k9i(this.Do);break;default:return sa.a(qb)}return rb.Task.Ta(!0)}wc(qb,Sb,mc){qb=!1;switch(Sb.command){case 330754562:qb=!!mc;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:qb=
!0}return qb}hZ(){const qb=this.Va.aq(this.menuId);this.F2i(qb);this.l_||this.isOlap||this.E2i(qb);return qb}F2i(qb){const Sb=this.Va,mc=Sb.Ec();let Lc=!1;X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(Lc=this.isOlap&&!this.HV&&this.mXd&&5===this.Do.TypeTag&&!this.Do.IsCollapsible);3!==this.Do.TypeTag&&37!==this.Do.TypeTag||this.Do.IsSet?17===this.Do.TypeTag||this.HV?(mc.buttons.push(Sb.pb(79)),mc.buttons.push(Sb.pb(this.l_?91:80)),mc.buttons.push(Sb.pb(this.l_?
92:81)),mc.buttons.push(Sb.pb(82))):13===this.Do.TypeTag||this.Do.IsSet?(mc.buttons.push(Sb.pb(83)),mc.buttons.push(Sb.pb(this.l_?91:80)),mc.buttons.push(Sb.pb(this.l_?92:81)),mc.buttons.push(Sb.pb(86))):(mc.buttons.push(Sb.pb(79)),mc.buttons.push(Sb.pb(this.l_?91:80)),mc.buttons.push(Sb.pb(this.l_?92:81)),mc.buttons.push(Sb.pb(Lc?82:86))):(mc.buttons.push(Sb.pb(83)),mc.buttons.push(Sb.pb(this.l_?93:84)),mc.buttons.push(Sb.pb(this.l_?94:85)),mc.buttons.push(Sb.pb(82)));qb.tc.push(mc)}E2i(qb){const Sb=
this.Va.Ec();Sb.buttons.push(this.Va.pb(78));qb.tc.push(Sb)}}Object(c.a)(Cc,"FieldListContextMenu",y.a,[]);var Sa=a(416),na=a(64);class jb{constructor(qb){this.$=qb;this.PN={}}get(qb,Sb,mc){const Lc=this.Aeg(qb,"PivotFilterContextMenuCache.Get");return Lc&&this.PN[Lc]?this.PN[Lc][jb.Qgd(Sb,this.$,qb,mc)]:null}set(qb,Sb,mc,Lc){const rd=this.Aeg(qb,"PivotFilterContextMenuCache.Set");rd&&(this.PN[rd]||(this.PN[rd]={}),this.PN[rd][jb.Qgd(Sb,this.$,qb,Lc)]=mc)}D8b(qb){qb in this.PN&&this.PN[qb]&&(this.PN[qb]=
null)}Aeg(qb,Sb){return na.f(this.$.oa)?this.$.activeItemName:(qb=this.GRj(qb,Sb))?qb.zd:null}GRj(qb,Sb){qb=D.C(qb);qb=K.h(this.$).Ea.Yva(qb,this.$.activeItemName);d.ULS.shipAssertTag(537167008,0,!!qb,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${Sb}`);return qb}static Qgd(qb,Sb,mc,Lc){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===Lc?Sb.oa.index+"_"+qb.id+
"_"+mc.FirstRow.toString()+"_"+mc.FirstColumn.toString():Sb.oa.index+"_"+qb.id}}Object(c.a)(jb,"PivotFilterContextMenuCache",null,[]);class Ib{constructor(){this.cell=null;this.dataSourceIndex=0;this.Po=this.pivotName=null}}Object(c.a)(Ib,"ShowPivotFilterData",null,[]);var dc=a(459),ob=a(1294),Fa=a(53);const Ab=t.a.oFe;class $b extends y.a{constructor(qb,Sb,mc,Lc,rd,Z,db,Lb=Ab){super(qb,Sb,mc,Lc,Lb,!0,!1,"PivotFilterMenuRootName",rd,Z,!1,db);this.Mnc=this.fBd=this.pivotData=this.onb=this.Enf=this.m6b=
null;this.HY=this.q3b=this.iFb=0;this.Qsb=null;this.LPi=(hc,Pc)=>{if(Pc)if(W.a(hc))this.Yxd(Pc,!1);else if(hc=hc.Result){this.Htb=jb.Qgd(Pc,this.$,this.pivotData.cell,this.HY);var Rc=this.guf(hc.MenuModel.Sections);this.Qsb=Rc;$b.PN.set(this.pivotData.cell,Pc,Rc,this.HY);ob.a(this.$).tKj(hc);this.Yxd(Pc,!0)}};this.KPi=(hc,Pc)=>{this.Yxd(Pc,!1)};this.tf=(hc,Pc)=>{$b.PN.D8b(Pc.ed.hash)};this.an=(hc,Pc)=>{$b.PN.D8b(Pc.ed.hash)};this.oAa=null;this.aBe=this.q3b=this.gBd=this.iFb=-1;this.Vse=this.HY=0;
this.Cz=X.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");$b.PN||($b.PN=new jb(this.$),K.h(this.$).Ea.mt(this.tf),K.h(this.$).Ea.hH(this.an),K.h(this.$).Ea.cha(this.tf))}Uad(qb,Sb){const mc=qb.rawEvent,Lc=qb.cell,rd=qb.requiresConfirmation;dc.a(this.$).Px(rd,Z=>{if(Z){Z=mc?new Sys.UI.DomEvent(mc):null;this.pivotData=new Ib;this.pivotData.pivotName=qb.pivotName;this.pivotData.dataSourceIndex=qb.dataSourceIndex;this.pivotData.cell=Lc;this.pivotData.Po=qb.optionalPivotMenuAnchorParameter;
if(this.pivotData.Po&&0<this.pivotData.Po.AnchorType){this.Mnc=qb.objectId;this.iFb=qb.objectVersion;const db=this.pivotData.Po.AnchorType;if(4===db||5===db||6===db||11===db||9===db||10===db||8===db)this.onb=qb.location}else this.fBd=this.Mnc=null,this.gBd=this.iFb=-1;K.h(this.$).Uo(!0);this.$.pk(Lc);this.Y0(Z,Z?Z.target:qb.domElement,this.pivotData,Sb,this.ZMa())}});return!0}Y0(qb,Sb,mc,Lc){if(Object(Sa.a)(Ib,mc)){this.pivotData=mc;this.m6b=Sb;this.Enf=qb;this.q3b=this.pivotData.Po?this.pivotData.Po.AnchorValue1:
-1;this.HY=this.pivotData.Po?this.pivotData.Po.AnchorType:0;var rd=!1,Z=null;Z=$b.PN.get(this.pivotData.cell,Sb,this.HY);rd=!!Z;var db=!0;switch(this.HY){case 4:case 5:case 6:this.oAa=new Sys.UI.Point(this.onb.x,this.onb.y);db=!1;break;case 7:var Lb=Sys.UI.DomElement.getBounds(Sb);db=Lb.x+(0<=Lb.x?0:Lb.width);Lb=Lb.y+(0<=Lb.y?0:Lb.height);this.oAa=new Sys.UI.Point(0<=db?db:0,0<=Lb?Lb:0);db=!1;break;case 8:case 10:case 9:case 11:this.oAa=new Sys.UI.Point(this.onb.x,this.onb.y);break;default:this.oAa=
null}rd&&this.Mnc===this.fBd&&this.iFb===this.gBd&&this.q3b===this.aBe&&this.HY===this.Vse?(d.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.Qsb=Z,this.oAa?this.Qp(this.oAa,this.ZMa()):this.Cz?y.a.epd(this.$,this.pivotData.cell)&&this.Qp(y.a.cfd(this.$,this.pivotData.cell,!1),this.ZMa()):super.Y0(qb,Sb,mc,Lc,this.ZMa())):1!==$b.mSh(Sb)&&(db&&(Sb.parentNode.menuFetchStates=1,this.Ftj(Sb),this.E1f(!0)),this.$.userOperationManager.Ic(new J.a(126,
0,(hc,Pc,Rc)=>{const xd=this.$;return L.p(xd.pa.ya,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,xd.domElement.id,xd.isChromeRtl,xd.workbookContext.NovMode,oa.b(hc,this.LPi),oa.a(Pc,this.KPi),Rc,Sb,this.pivotData.Po)},16),Lc))}}cGd(qb){qb.MenuSectionList.push(...this.Qsb)}Yxd(qb,Sb){qb.parentNode.menuFetchStates=2;this.E1f(!1);if(Sb){if(this.m6b!==qb||this.lEi())this.Qp(this.oAa,this.ZMa());else if(this.Cz&&!this.oAa){if(!y.a.epd(this.$,this.pivotData.cell))return;this.Qp(y.a.cfd(this.$,
this.pivotData.cell,!1),this.ZMa())}else super.Y0(this.Enf,qb,null,null,this.ZMa());this.fBd=this.Mnc;this.gBd=this.iFb;this.Vse=this.HY;this.aBe=this.q3b}}ZMa(){return 8!==this.HY&&9!==this.HY&&10!==this.HY&&11!==this.HY}lEi(){switch(this.pivotData.Po?this.pivotData.Po.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}E1f(qb){const Sb=this.m6b;if(Sb){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var mc=yb.DOMElementExtensions.LZ(Sb,
"ewaprevsrc","");mc=!!mc&&"null"!==mc}else mc=!!yb.DOMElementExtensions.LZ(Sb,"ewaprevsrc","");qb&&mc||!qb&&!mc||(qb?(Sb.setAttribute("ewaprevsrc",Sb.src),Sb.src=Fa.a.current.fo(99)):(qb=yb.DOMElementExtensions.LZ(Sb,"ewaprevsrc",""),Sb.src=qb,Sb.setAttribute("ewaprevsrc",null)))}}Ftj(qb){this.m6b=qb}static mSh(qb){const Sb=qb.parentNode.menuFetchStates;void 0===Sb&&(qb.parentNode.menuFetchStates=0);return Sb}}$b.PN=null;Object(c.a)($b,"PivotFilterContextMenuBase",y.a,[]);const Cb="FieldList"+t.a.oFe;
class Rb extends $b{constructor(qb,Sb,mc,Lc){super(qb,"PopulateFieldListPivotMenu",-1793121409,1378457149,Sb,mc,Lc,Cb)}get Zw(){return"PopulateFieldListPivotMenu"}get OB(){return t.a.WPf}executeCommand(qb,Sb,mc){return this.Uad(mc,Sb)?rb.Task.Ta(!0):sa.a(Sb.command)}wc(qb,Sb,mc){return-1065117584===Sb.command&&!!mc}}Object(c.a)(Rb,"FieldListPivotContextMenu",$b,[]);var uc=a(263),nb=a(30),Fb=a(87),Jc=a(752);class Fc{}Object(c.a)(Fc,"PivotValueFieldSettingsApplyData",null,[]);class zb{}zb.Tjg="valueFieldSettingTabs";
zb.xgh="dataFieldCustomLabel";zb.uJe="dataFieldSourceLabel";zb.fVd="showValueAsSelect";zb.dVd="showValueAsBaseFieldSelect";zb.eVd="showValueAsBaseItemSelect";zb.D1d="valueFieldsSettingsFieldName";Object(c.a)(zb,"CssElementIds",null,[]);var hb=a(108);class Pb{constructor(qb,Sb,mc){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=qb;this.baseFieldIndex=Sb;this.baseItemIndex=mc}}Object(c.a)(Pb,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class ud{constructor(qb,Sb,
mc,Lc,rd){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=qb;this.activeCell=Sb;this.pivotFieldTitle=mc;this.summarizeBy=Lc;this.showAsValueParameters=rd}getActiveCell(){return this.activeCell}}Object(c.a)(ud,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[137]);var Ub=a(238);class Ac{}Object(c.a)(Ac,"PivotValueFieldShowValueAsApplyData",null,[]);var Ic=a(735),dd=a(44);const Ud=`<div id='showValueAsControlBody'><label for='${zb.fVd}' class='${hb.a.zo} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${zb.fVd}' class='${hb.a.oF}'></select></div><div class='showValueAsControlSelectRegion'><label for='${zb.dVd}'>{1}</label><div><select size=6 id='${zb.dVd}' class='${hb.a.oF}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${zb.eVd}'>{2}</label><div><select size=6 id='${zb.eVd}' class='${hb.a.oF}'></select></div></div></div>`;
class Hd extends Ub.a{constructor(qb,Sb,mc,Lc,rd,Z,db,Lb,hc){super(qb);this.htmlSanitizationHelper=this.y7d=this.h5d=this.g5d=this.G1b=this.R6b=this.AD=null;this.jAf=()=>{var Pc=parseInt(this.U3.ee.value,10);this.PZg(Pc)?(this.RP.Pp.disabled=!0,this.SP.Pp.disabled=!0,this.SP.clear(),Hd.Kff(Pc)?(this.RP.Pp.disabled=!1,this.PPb(!X.EwaSettings.isChangeGateEnabled("OfficeVSO:6857026_ShowValueAsControlOKButtonFix"))):Hd.Lff(Pc)?(this.RP.Pp.disabled=!1,this.SP.Pp.disabled=!1,this.PPb(!0),this.hpf()):this.PPb(!1)):
(Pc=N.a.Zc(1,0,0,1127,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),dd.a(this.$).Pr([Pc]),this.U3.Ilj())};this.tKi=()=>{0>this.RP.selectedIndex||this.SP.Pp.disabled||(this.PPb(!0),this.hpf())};this.IQi=Pc=>{this.AD.QTa();this.SP.Pp.style.overflowY="scroll";if(Pc&&!W.a(Pc)){Pc=Pc.Result;this.SP.clear();for(const Rc of Pc.BaseItems)this.SP.BY(Rc.DisplayString,Rc.Id.toString(),Rc.Id===Pc.SelectedBaseItem);this.PPb(!1)}};this.get_visible=this.lka;this.set_visible=this.aoa;this.$=Sb;this.cell=mc;this.Po=
Lc;this.externalSourceIndex=rd;this.Wd=Z;this.Ata=db;this.Yni=Lb;this.htmlSanitizationHelper=hc;this.gXj=X.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.Hka()}lka(){return this.isVisible}aoa(qb){return this.isVisible=qb}get title(){return da.a.instance.ga(1115)}get nxb(){const qb=this.U3.ee?parseInt(this.U3.ee.value,10):-1,Sb=this.RP.ee?parseInt(this.RP.ee.value,10):-1,mc=this.SP.ee?parseInt(this.SP.ee.value,10):-1;return Object(f.a)(new Ac,{SelectedDataFormat:0<=
qb?qb:-1,SelectedBaseField:Sb,SelectedBaseItem:mc})}get RP(){return this.g5d}get SP(){return this.h5d}get U3(){return this.y7d}setFocus(){yb.DOMElementExtensions.setFocus(this.U3.Pp)}render(qb){qb.appendChild(this.domElement)}dispose(){Fb.a.qc([this.U3,this.RP,this.SP,this.R6b,this.G1b]);super.dispose()}owj(qb){Fb.a.qc([this.R6b,this.G1b]);this.U3.clear();for(const Sb of qb.DataFormatTypes)this.U3.BY(Hd.yQh(Sb),Sb.toString(),Sb===qb.SelectedDataFormat);this.R6b=this.Ce.Zd(this.U3.domElement);this.R6b.ka("change",
this.jAf);this.RP.clear();for(const Sb of qb.BaseFieldList)this.RP.BY(Sb.DisplayString,Sb.Id.toString(),Sb.Id===qb.SelectedBaseField);this.G1b=this.Ce.Zd(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6857021_ShowValueAsControlBaseFieldSelectionFix")?this.RP.domElement:this.U3.domElement);this.G1b.ka("change",this.tKi);this.AD=this.Ata.Ksb(this.SP.Pp.parentNode,1E3,null,"",736);X.EwaSettings.isChangeGateEnabled("OfficeVSO:6857019_ShowValueAsControlLoadingIndicatorFix")&&this.AD.QTa();this.jAf(null)}YQ(qb){this.U3.YQ(qb);
this.RP.YQ(qb);this.SP.YQ(qb)}Hka(){X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.dk(this.domElement,String.format(Ud,da.a.instance.ga(1116),da.a.instance.ga(1117),da.a.instance.ga(1118))):this.domElement.innerHTML=String.format(Ud,da.a.instance.ga(1116),da.a.instance.ga(1117),da.a.instance.ga(1118));this.y7d=new Ic.a(yb.DOMElementExtensions.getElementById(this.domElement,
zb.fVd),!1);this.g5d=new Ic.a(yb.DOMElementExtensions.getElementById(this.domElement,zb.dVd),!1);this.h5d=new Ic.a(yb.DOMElementExtensions.getElementById(this.domElement,zb.eVd),!1)}PZg(qb){return this.Yni||!Hd.Kff(qb)&&!Hd.Lff(qb)?!0:!!this.RP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Ic(new J.a(108,0,(qb,Sb,mc)=>{var Lc=this.$.pa.ya,rd=parseInt(this.RP.ee.value,10);qb=oa.b.call(null,qb,this.IQi);const Z=L.L(Lc,this.cell,this.externalSourceIndex,this.Po);Z.selectedBaseField=
rd;return L.g(Lc,"GetPivotValueFieldSettingsShowValueAsBaseItems",Z,qb,Sb,mc,null,4)},16),this.Wd)}hpf(){this.SP.clear();this.RP.ee&&(this.AD.KTa(),this.SP.Pp.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}PPb(qb){const Sb=document.getElementById("WACDialogActionButton");this.gXj&&Sb&&(Sb.disabled=qb)}static yQh(qb){switch(qb){case 0:return da.a.instance.ga(1119);case 1:return da.a.instance.ga(1120);case 2:return da.a.instance.ga(1121);case 3:return da.a.instance.ga(1122);
case 4:return da.a.instance.ga(1123);case 5:return da.a.instance.ga(1124);case 6:return da.a.instance.ga(1125);case 7:return da.a.instance.ga(1126);case 8:return da.a.instance.ga(1128);case 9:return da.a.instance.ga(1129);case 10:return da.a.instance.ga(1130);case 11:return da.a.instance.ga(1131);case 12:return da.a.instance.ga(1132);case 13:return da.a.instance.ga(1133);case 14:return da.a.instance.ga(1134);default:return""}}static Kff(qb){return 11===qb||12===qb||14===qb||13===qb||4===qb}static Lff(qb){return 1===
qb||3===qb||2===qb}}Object(c.a)(Hd,"ShowValueAsControl",Ub.a,[405,2]);class me{}Object(c.a)(me,"PivotValueFieldSummarizeValueByApplyData",null,[]);const xe="<div id='summarizeValuesByControlBody'>"+`<label class='${hb.a.zo} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+`<div id='${"pivotDataFieldSelectDescription"}' class='${hb.a.zo} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${hb.a.oF}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${t.a.JJ}='${"pivotDataFieldSelectDescription"}'></select></div>`+
"</div>";class Ke extends Ub.a{constructor(qb,Sb){super(qb);this.htmlSanitizationHelper=this.Lge=null;this.get_visible=this.lka;this.set_visible=this.aoa;this.htmlSanitizationHelper=Sb;this.Hka()}get nxb(){const qb=this.sl.ee?parseInt(this.sl.ee.value,10):-1;return Object(f.a)(new me,{Aggregation:0<=qb?qb:-1})}lka(){return this.isVisible}aoa(qb){return this.isVisible=qb}get title(){return da.a.instance.ga(1114)}get enabled(){return!this.sl.Pp.disabled}set enabled(qb){this.sl.Pp.disabled=!qb}get sl(){return this.Lge}setFocus(){yb.DOMElementExtensions.setFocus(this.sl.Pp)}render(qb){qb.appendChild(this.domElement)}dispose(){Fb.a.Ia(this.sl);
super.dispose()}focus(){yb.DOMElementExtensions.setFocus(this.sl.Pp)}nwj(qb){this.sl.bWd();for(const Sb of qb.AggregationTypes){const mc=Sb===qb.SelectedAggregation;this.sl.DVc(Ke.$Lh(Sb),Sb.toString(),mc,"")}this.sl.C9c();this.sl.Pp.disabled=qb.AggregationsDisabled}Elj(){this.sl.Flj()}Hka(){X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.dk(this.domElement,
String.format(xe,da.a.instance.ga(1099),da.a.instance.ga(1100))):this.domElement.innerHTML=String.format(xe,da.a.instance.ga(1099),da.a.instance.ga(1100));this.Lge=new Ic.a(yb.DOMElementExtensions.getElementById(this.domElement,Ke.eLf),!1)}static $Lh(qb){switch(qb){case 0:return da.a.instance.ga(1102);case 1:return da.a.instance.ga(1103);case 2:return da.a.instance.ga(1104);case 3:return da.a.instance.ga(1105);case 4:return da.a.instance.ga(1106);case 5:return da.a.instance.ga(1107);case 6:return da.a.instance.ga(1108);
case 7:return da.a.instance.ga(1109);case 8:return da.a.instance.ga(1110);case 9:return da.a.instance.ga(1111);case 10:return da.a.instance.ga(1112);case 11:return da.a.instance.ga(1113);default:return""}}}Ke.eLf="pivotDataFieldSelect";Object(c.a)(Ke,"SummarizeValuesByControl",Ub.a,[405,2]);var vd=a(210),Qe=a(468),bc=a(1238);class Zc extends Jc.a{constructor(qb,Sb,mc,Lc,rd,Z,db,Lb,hc,Pc){super(rd,da.a.instance.nb(61),!0,2,!0);this.b7f=!0;this.htmlSanitizationHelper=this.kTc=this.Q6b=this.ftb=this.bga=
this.tTa=this.nme=null;this.fKi=Rc=>{uc.a.any(Rc.Errors,xd=>-103190598===xd.MessageId)&&this.YTa.Elj()};this.HQi=Rc=>{Rc&&!W.a(Rc)&&(Rc=Rc.Result,X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.B2f(this.Q6b,da.a.instance.ga(1097)+nb.a.Gg(Rc.ValueFieldSourceName)):this.Q6b.innerHTML=da.a.instance.ga(1097)+nb.a.Gg(Rc.ValueFieldSourceName),this.isOlap&&
!this.HV?(this.YTa.enabled=!1,this.bga.activeTab=this.bga.XAc-1):(this.YTa.enabled=!0,this.bga.activeTab=0),this.YTa.nwj(Rc.PivotValueFieldSettingsSummarizeValueByInfo),this.tTa.owj(Rc.PivotValueFieldShowValueAsInitialInfo),this.vg())};this.cell=qb;this.Po=Sb;this.externalSourceIndex=mc;this.Sjg=Lc;this.Wd=Z;this.Ata=db;this.isOlap=Lb;this.HV=hc;this.htmlSanitizationHelper=Pc}get pc(){return"ValueFieldSettingsDialog"}get MCa(){return this.nme}get EEb(){return this.bga}get YTa(){return this.kTc}get cC(){return 560}dispose(){this.Q6b=
this.ftb=this.tTa=this.kTc=null;Fb.a.Ia(this.bga);this.bga=null;super.dispose()}initialize(){let qb="<div id='"+zb.uJe+"' class='"+hb.a.zo+"'></div><div id='"+zb.xgh+"' class='"+hb.a.zo+"'><label for='"+zb.D1d+"'>{0}</label><input type='text' id='"+zb.D1d+"' value='{1}' class='"+hb.a.oF+" UIFont' /></div><div id='"+zb.Tjg+"'></div>";qb=String.format(qb,da.a.instance.ga(1098),nb.a.Gg(this.Sjg));X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
this.htmlSanitizationHelper.dk(this.Mb,qb):this.Mb.innerHTML=qb;this.Of||(this.isa(),this.Nt());this.nme=[-103190598];this.G3h();super.initialize()}close(qb){1===qb&&(this.b7f=!1);super.close(qb)}wLe(qb){this.xN=qb;this.domElement.disabled=qb;const Sb=["input","option","select"];for(let mc=0,Lc=Sb.length;mc<Lc;++mc){const rd=this.domElement.getElementsByTagName(Sb[mc]);for(let Z=0;Z<rd.length;++Z)rd[Z].disabled=qb}}Nt(){this.ftb=document.getElementById(zb.D1d);this.Q6b=yb.DOMElementExtensions.getElementById(this.Mb,
zb.uJe);const qb=yb.DOMElementExtensions.getElementById(this.Mb,zb.Tjg);this.kTc=new Ke(document.createElement("div"),this.htmlSanitizationHelper);this.tTa=new Hd(document.createElement("div"),this.$,this.cell,this.Po,this.externalSourceIndex,this.Wd,this.Ata,!this.isOlap,this.htmlSanitizationHelper);let Sb;this.bga=new bc.a(qb,(Sb=new wb.a,Sb.add(this.YTa),Sb.add(this.tTa),Sb));this.bga.pVf()}nGd(){const qb=new Zc(this.cell,this.Po,this.externalSourceIndex,this.Sjg,this.$,this.Wd,this.Ata,this.isOlap,
this.HV,this.htmlSanitizationHelper);qb.initialize();qb.vg()}IQb(){const qb=new Qe.a;if(!this.b7f)return qb.isValid=!0,qb;this.ftb.value.length?qb.isValid=!0:(this.wLe(!0),qb.error=N.a.Zc(1,0,751,766,0,1783218700,"PivotTableValueFieldNoBlank"),this.xN=!0,this.Of||(this.oz.disabled=!0),qb.isValid=!1);return qb}c9e(){this.xN=!1;this.Of||(this.oz.disabled=!1);this.wLe(!1)}jza(qb){const Sb=new M.a(2105621672,0,this.$.Hc,30,null);this.$.Ja.Kb(Sb);this.LW(5,qb.tb,"Number Format");return!0}uq(){this.Moa=
String.format(da.a.instance.nb(61),null);super.uq()}setFocus(){if(this.Of){const qb=yb.DOMElementExtensions.getElementById(this.Mb,Ke.eLf);vd.a.p_d(qb)}else this.bga.setFocus()}jk(){const qb=this.tTa.nxb,Sb=new Pb(qb.SelectedDataFormat,qb.SelectedBaseField,qb.SelectedBaseItem);return()=>new ud(this.externalSourceIndex,this.cell,this.ftb.value,this.YTa.nxb.Aggregation,Sb)}nH(){const qb=Object(f.a)(new Fc,{PivotValueFieldSummarizeValueByApplyData:this.YTa.nxb,PivotValueFieldShowValueAsApplyData:this.tTa.nxb,
PivotValueFieldTitle:this.ftb.value});return(Sb,mc,Lc)=>{var rd=this.$.pa.ya;Sb=oa.b(Sb,this.fKi);const Z=L.L(rd,this.cell,this.externalSourceIndex,this.Po);Z.pivotValueFieldSettingsApplyData=qb;return L.g(rd,"ApplyPivotValueFieldSettings",Z,Sb,mc,Lc,null,0)}}YQ(qb){this.$.da.$a(40,()=>{this.tTa.YQ(qb)})}G3h(){this.$.userOperationManager.Ic(new J.a(123,0,(qb,Sb,mc)=>{var Lc=this.$.pa.ya;qb=oa.b.call(null,qb,this.HQi);const rd=L.L(Lc,this.cell,this.externalSourceIndex,this.Po);return L.g(Lc,"GetPivotValueFieldSettingsInitial",
rd,qb,Sb,mc,null,4)},16),this.Wd)}}Object(c.a)(Zc,"ValueFieldSettingsDialog",Jc.a,[]);const gd=t.a.r7g;class Sc extends y.a{constructor(qb,Sb,mc,Lc){super(qb,"PopulateFieldWellContextMenu",1374696078,495005930,gd,!0,!1,gd,Sb,mc,!1,Lc);this.Po=this.Do=this.cell=null;this.P2d=this.externalSourceIndex=-1;this.FTa=0;this.Xzc=-1;this.SL=null;this.C3a=this.HV=this.isOlap=!1}get Zw(){return"PopulateFieldWellContextMenu"}get OB(){return t.a.TId}executeCommand(qb,Sb,mc,Lc){qb=Sb.command;switch(qb){case -1453503574:Lc=
mc.domElement;this.Do=mc.fieldItem;this.P2d=mc.zoneCount;this.FTa=mc.sourceAxis;this.Xzc=mc.sourceAxisPos;this.Po=mc.optionalPivotMenuAnchorParameter;this.SL=mc.versionkey;this.isOlap=mc.isOlap;this.HV=mc.isPpm;this.C3a="fieldItemsupportsImplicitMeasures"in mc?mc.fieldItemsupportsImplicitMeasures:!1;this.cell=mc.cell;this.externalSourceIndex=mc.externalSourceIndex;K.h(this.$).Uo(!0);Lc=yb.DOMElementExtensions.getBounds(Lc);qb=new Sys.UI.Point(Lc.x,Lc.y+Lc.height);this.$.isChromeRtl&&(qb.x+=Lc.width);
"isKeyboardInput"in mc&&mc.isKeyboardInput?this.Qp(qb,!1,1):this.Qp(qb,!1);break;case 495005930:break;case -1170196828:tb.a(this.$).dK(this.Do,this.FTa,this.Xzc-1,this.SL,Sb);break;case -889576107:tb.a(this.$).dK(this.Do,this.FTa,this.Xzc+2,this.SL,Sb);break;case 2033235475:tb.a(this.$).dK(this.Do,this.FTa,this.P2d,this.SL,Sb);break;case 389774337:tb.a(this.$).dK(this.Do,this.FTa,0,this.SL,Sb);break;case -96230454:tb.a(this.$).dK(this.Do,4,-1,this.SL,Sb);break;case 74086617:tb.a(this.$).dK(this.Do,
1,-1,this.SL,Sb);break;case 1529312473:tb.a(this.$).dK(this.Do,2,-1,this.SL,Sb);break;case 563292088:this.C3a&&d.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");tb.a(this.$).dK(this.Do,8,-1,this.SL,Sb);break;case -1092351914:tb.a(this.$).dK(this.Do,0,-1,this.SL,Sb);break;case -2141589616:const rd=T.GetServiceTaskFactory.Oa(this.$.da,12,477,Lc.I4()),Z=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
T.GetServiceTaskFactory.Oa(this.$.da,498,499,Lc.I4()):rb.Task.Ta(null);return C.TaskExtensions.Aa(C.TaskExtensions.Ed([rd,Z],this.$.la),()=>{(new Zc(this.cell,this.Po,this.externalSourceIndex,this.Do.Name,this.$,Sb,rd.result,this.isOlap,this.HV,Z.result)).initialize()},this.la);default:return sa.a(qb)}return rb.Task.Ta(!0)}wc(qb,Sb,mc){qb=!1;switch(Sb.command){case -1453503574:qb=!!mc;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:qb=
!0}return qb}hZ(){const qb=this.Va.aq(this.menuId);this.M2i(qb,this.Xzc,this.P2d);this.N2i(qb,this.FTa);this.O2i(qb);8===this.FTa&&this.K2i(qb);return qb}M2i(qb,Sb,mc){const Lc=this.Va,rd=Lc.Ec();Sb||Sb!==mc-1?!Sb&&Sb<mc-1?(rd.buttons.push(Lc.pb(64)),rd.buttons.push(Lc.pb(61)),rd.buttons.push(Lc.pb(66)),rd.buttons.push(Lc.pb(63))):0<Sb&&Sb<mc-1?(rd.buttons.push(Lc.pb(60)),rd.buttons.push(Lc.pb(61)),rd.buttons.push(Lc.pb(62)),rd.buttons.push(Lc.pb(63))):0<Sb&&Sb===mc-1&&(rd.buttons.push(Lc.pb(60)),
rd.buttons.push(Lc.pb(65)),rd.buttons.push(Lc.pb(62)),rd.buttons.push(Lc.pb(67))):(rd.buttons.push(Lc.pb(64)),rd.buttons.push(Lc.pb(65)),rd.buttons.push(Lc.pb(66)),rd.buttons.push(Lc.pb(67)));qb.tc.push(rd)}N2i(qb,Sb){const mc=this.Va,Lc=mc.Ec(),rd=1!==Sb&&(!this.isOlap||this.HV||8!==Sb||this.C3a),Z=2!==Sb&&(!this.isOlap||this.HV||8!==Sb||this.C3a),db=8!==Sb&&-2!==this.Do.PivotTableIndex&&(!this.isOlap||this.HV||this.C3a);Lc.buttons.push(mc.pb(4===Sb||this.Do.IsSet||-2===this.Do.PivotTableIndex||
this.isOlap&&!this.HV&&8===Sb&&!this.C3a?72:68));8===this.Po.AnchorType||10===this.Po.AnchorType?(Lc.buttons.push(mc.pb(rd?95:97)),Lc.buttons.push(mc.pb(Z?96:98))):(Lc.buttons.push(mc.pb(rd?69:73)),Lc.buttons.push(mc.pb(Z?70:74)));Lc.buttons.push(mc.pb(db?71:75));qb.tc.push(Lc)}O2i(qb){const Sb=this.Va.Ec();Sb.buttons.push(this.Va.pb(76));qb.tc.push(Sb)}K2i(qb){const Sb=this.Va.Ec();Sb.buttons.push(this.Va.pb(77));qb.tc.push(Sb)}}Object(c.a)(Sc,"FieldWellContextMenu",y.a,[]);var Gd=a(1219);class Vd extends $b{constructor(qb,
Sb,mc,Lc){super(qb,"PopulatePivotContextMenu",2123758504,912277356,Sb,mc,Lc)}get Zw(){return"PopulatePivotContextMenu"}get OB(){return t.a.bQf}executeCommand(qb,Sb,mc){let Lc=!1;const rd=Sb.command;switch(rd){case 37023044:Lc=this.Uad(mc,Sb);break;case 541421805:case -569786022:Lc=this.wkd(qb,Sb)}return Lc?rb.Task.Ta(!0):sa.a(rd)}wc(qb,Sb,mc){qb=!1;switch(Sb.command){case 37023044:qb=!!mc;break;case 541421805:case -569786022:qb=!0}return qb}wkd(qb,Sb){var mc=8===qb,Lc=this.$,rd=Ya.a(Lc),Z=K.h(Lc).ha.Sa.$b;
let db=qb=null;mc&&rd?(qb=rd.chartId,db=rd.Vc):!mc&&Z&&(qb=Z.floatingObject.id,db=Z.floatingObject.Vc);return Vd.Xue(db,260)?(mc={},Lc.pk(mc),mc.FirstColumn=mc.FirstRow=-1,Lc={["rawEvent"]:null,["pivotName"]:null,["cell"]:mc,["requiresConfirmation"]:Vd.Xue(db,64),["dataSourceIndex"]:db.ExternalSourceIndex},Z?(rd=Z.floatingObject,Lc.domElement=Z.domElement,Lc.objectId=rd.id,Lc.objectVersion=rd.version):rd&&(Lc.domElement=rd.Fl,Lc.objectId=rd.chartId,Lc.objectVersion=rd.dBe),Z={AnchorType:7},Z.ChartId=
qb,Z.AnchorValue1=-1,Z.AnchorValue2=-1,Lc.optionalPivotMenuAnchorParameter=Z,this.Uad(Lc,Sb)):!1}static Xue(qb,Sb){return(qb.Attributes&Sb)===Sb}}Object(c.a)(Vd,"PivotFilterContextMenu",$b,[]);var Ed=a(1293);const Od=(qb,Sb,mc,Lc,rd,Z,db,Lb,hc,Pc=null)=>{Pc=qb.Na(41,Pc);Pc.activeCell=Sb;Pc.operationType=mc;Pc.fieldCaption=Lc;Pc.prevFieldCaption=rd;return L.g(qb,"ExecutePivotTableOperation",Pc,Z,db,Lb,hc,0)},se=(qb,Sb,mc,Lc,rd,Z,db,Lb=null)=>{Lb=qb.Na(41,Lb);Lb.activeCell=Sb;Lb.pivotValueFieldSettingsApplyData=
mc;return L.g(qb,"ApplyValueFieldSettingsToPivotTable",Lb,Lc,rd,Z,db,0)};var Le=a(148),Id=a(371),fe=a(283),Yd=a(28),Ce=a(22);const ye=t.a.v7g,Ae=ye+".RemoveField",He=ye+".Subtotal",gf=ye+".ClearFilter",Xe=ye+".LayoutSameColumn",$a=ye+".LayoutNextColumn";class ac extends y.a{constructor(qb,Sb,mc,Lc){super(qb,"PopulatePivotTableContextMenu",-1475408662,1114549926,ye,!0,!1,"PivotTableContextMenuRootName",Sb,mc,!0,Lc);this.s2d=this.activeCell=this.jc=null;this.BZ=this.refresh=this.expandCollapse=this.Ypd=
this.Jjc=!1;this.lbb=this.vb=this.u1a=this.mA=this.Be=null;this.Sba=!1;this.XPi=rd=>{rd&&!N.a.ag(rd.Errors)&&this.jc&&(this.jc.fp=rd.Result,this.fMb());this.showPivotTableContextMenu()};this.WPi=()=>{};this.KTi=()=>{this.Scb()};this.JTi=()=>{this.Scb()};this.lKi=()=>{this.Scb()};this.kKi=()=>{this.Scb()};this.yy=()=>{this.N_d();this.Sba=!1};this.ar=()=>{if(this.Sba){d.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
const rd=this.jc;this.grid.Bb.xp(this.grid.ha.ra.activeCell)!==rd&&(this.Scb(),this.y$h())}};this.Vmh=new DOMParser;this.zAj=!0;this.grid=K.h(qb);this.wmc=!0}get Zw(){return"PopulatePivotTableContextMenu"}get OB(){return t.a.cQf}executeCommand(qb,Sb,mc){Sb=Sb.command;qb=null;this.grid=K.h(this.$);this.activeCell=D.o(this.grid.ha.ra.activeCell,this.$);if(this.$.isEditMode&&(this.jc=this.grid.Bb.xp(this.grid.ha.ra.activeCell),!this.jc))return d.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),
C.TaskExtensions.jba();this.s2d=this.$.pa.ya;this.u1a=Object(Vb.a)(xa.a,mc.eventArgs);switch(Sb){case 671488277:this.nCj()?this.kYh():(this.Scb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,
2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.PSa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.PSa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.PSa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.PSa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.PSa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.PSa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:mc=Number.parseInvariant(mc.MenuItemId.split(".")[2]);this.PSa(11,mc);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Xc(-1556797033,B.a.Db,8,null);break;case 1514686611:this.yvi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:mc=Number.parseInvariant(mc.MenuItemId);this.C2g(mc);break;case 1778578888:mc=Number.parseInvariant(mc.MenuItemId);this.RPg(mc);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,
12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:qb=sa.a(Sb)}return qb||C.TaskExtensions.jba()}wc(qb,Sb){qb=!1;switch(Sb.command){case 671488277:qb=
Ma.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:qb=!0;break;case 1600778266:qb=!0;break;case -556893687:qb=!0;break;case -1966978671:qb=!0;break;case -1951357930:qb=!0;break;case -1390365353:case -1457478532:qb=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:qb=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:qb=
!0;break;case -1007663920:case 234234584:case 1194992911:qb=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:qb=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:qb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return qb}nCj(){if(!this.$.isEditMode||this.jc.Chc)return!1;let qb=this.$5f(!1);return X.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.jc.isOlap||qb:!this.jc.zic()||qb}nc(qb,Sb){let mc=!1;switch(Sb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:mc=this.qS();break;case -1007663920:case 234234584:mc=this.RAj()||this.qS();break;case 1194992911:mc=this.SAj()||this.qS();break;
case 1217404289:mc=!Ed.j(this.vb.LabelOrDateFilterType)||this.qS();break;case -743135194:mc=!Ed.m(this.vb.ValueFilterType)&&!Ed.l(this.vb.ValueFilterType)||this.qS();break;case 771421327:mc=0===this.vb.LabelOrDateFilterType&&0===this.vb.ValueFilterType&&!this.vb.HasManualFilter||this.qS();break;case 1015867427:mc=!Ed.i(this.vb.LabelOrDateFilterType)||this.qS();break;case 1105960559:mc=!Ed.k(this.vb.LabelOrDateFilterType)||this.qS()}return mc||super.nc(qb,Sb)}Scb(){this.lbb=this.vb=this.Be=null}XWd(){this.grid.KT(this.ar);
this.$.Ja.DZa(this.yy)}N_d(){this.grid.uO(this.ar);this.$.Ja.QJb(this.yy)}fMb(){if(this.jc&&this.jc.fp){this.Be=this.jc.fp;this.vb=this.jc.Qbc();if(this.N6f()){const qb=this.jc.tL[4===this.Be.CellType?this.jc.P6c-1:this.Be.CurrentFieldIndex-1];qb&&(this.lbb=-2===qb.Index?this.jc.zJe:qb.Caption)}this.jdi();this.vb&&8===this.Be.CellArea&&(this.mA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.vb.DataFieldAggregationType,this.mA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.vb.DataFieldFormatType,
this.mA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.vb.BaseFieldIndex,this.mA.PivotValueFieldTitle=this.vb.Caption)}}$5f(qb){return this.jc?this.jc.isOlap&&!this.jc.RNa(!qb):!1}ZAj(){const qb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.vb.MeasureType&&(!this.jc.kkf||qb&&2===this.vb.MeasureType)}hZ(){const qb=this.Va.aq(this.menuId),Sb=this.Va.Ec(),mc=K.h(this.$).Sb(null);if(this.jc)this.Be&&this.jc.fp&&this.Be!==this.jc.fp&&
d.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.vb&&this.vb!==this.jc.Qbc()&&d.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return qb;this.sJh(qb);if(this.$.isEditMode){this.refresh&&this.IKh(qb);if(this.Be&&this.vb){var Lc=this.Va.Ec();this.WKh(Lc);this.HJh(Lc);qb.tc.push(Lc)}this.BZ&&Sb.buttons.push(this.Va.pb(99));this.Be&&this.vb&&this.fKh(qb);if(this.expandCollapse){Lc=this.Va.tw("ContextMenu.PivotExpandCollapse",
null,da.a.instance.ga(1163),589118293);const rd=this.Va.Ec();rd.buttons.push(this.Va.pb(243));rd.buttons.push(this.Va.pb(244));rd.buttons.push(this.Va.pb(245));rd.buttons.push(this.Va.pb(246));Lc.menu.tc.push(rd);Lc&&0<rd.buttons.length&&Sb.buttons.push(Lc)}this.Be&&(Lc=this.Va.Ec(),X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.qKh(Lc),this.JKh(Lc),0<Lc.buttons.length&&qb.tc.push(Lc));this.Be&&this.vb&&8===this.Be.CellArea&&8!==this.Be.CellType&&
(Lc=this.Va.Ec(),this.ZAj()&&this.YKh(Lc),3!==this.Be.CellType&&this.TKh(Lc),qb.tc.push(Lc));!this.jc.zic()&&""!==(null===mc||void 0===mc?void 0:mc.text)&&this.Be&&0===this.Be.CellType&&X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.SKh(qb);this.Ioi()?Sb.buttons.push(this.Va.pb(257)):Sb.buttons.push(this.Va.pb(258));this.Ypd?Sb.buttons.push(this.Va.pb(59)):Sb.buttons.push(this.Va.pb(58))}qb.tc.push(Sb);return qb}eTa(){return this.vb&&this.vb.Caption?20<
this.vb.Caption.length:!1}YKa(qb){return this.vb&&this.vb.Caption?qb?this.vb.Caption.substring(0,20)+"...":this.vb.Caption:""}Zva(qb){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?Ce.a.hashCode(qb).toString():qb}WKh(qb){if(this.Be&&this.vb&&4!==this.Be.CellArea){var Sb=this.Gja(this.KH("PivotTableContextMenu.Sort",this.Zva(this.vb.Caption)),-1777747317,0,0!==this.vb.SortInfo,da.a.instance.ga(227)),mc=this.Va.Ec();mc.buttons.push(this.Sd("PivotTableContextMenu.SortAscending",
-1007663920,0,1===this.vb.SortInfo,da.a.instance.ga(228)));mc.buttons.push(this.Sd("PivotTableContextMenu.SortDescending",234234584,0,2===this.vb.SortInfo,da.a.instance.ga(229)));1!==this.Be.CellArea&&2!==this.Be.CellArea||mc.buttons.push(this.Sd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.vb.SortInfo||4===this.vb.SortInfo,da.a.instance.ga(154)));Sb.menu.tc.push(mc);Sb&&0<mc.buttons.length&&qb.buttons.push(Sb)}}HJh(qb){if(this.Be&&this.vb&&(1===this.Be.CellArea||2===this.Be.CellArea)){var Sb=
this.mCj();const Z=this.Gja(this.KH("PivotTableContextMenu.Filter",this.Zva(this.vb.Caption)),-1777747317,0,Sb,da.a.instance.ga(651)),db=this.Va.Ec();var mc="",Lc=this.eTa(),rd=String.format(da.a.instance.nb(156),this.YKa(Lc));Lc&&(mc=String.format(da.a.instance.nb(156),this.vb.Caption));Sb=this.Zva(this.vb.Caption)+"."+(Sb?"enabled":"disabled");mc=this.Sd(this.KH(gf,Sb),771421327,0,!1,rd,"0",mc,8,lb.a.n3a);Sb=this.Zva(this.vb.Caption)+"."+this.vb.LabelOrDateFilterType.toString();this.vb.IsDateField?
(rd=this.Gja(this.KH("PivotTableContextMenu.DateFilter",Sb),-1777747317,0,0!==this.vb.LabelOrDateFilterType,da.a.instance.ga(97)),this.vJh(rd.menu)):(rd=this.Gja(this.KH("PivotTableContextMenu.LabelFilter",Sb),-1777747317,0,0!==this.vb.LabelOrDateFilterType,da.a.instance.ga(649)),this.eKh(rd.menu));Sb=this.Zva(this.vb.Caption)+"."+this.vb.ValueFilterType.toString();Sb=this.Gja(this.KH("PivotTableContextMenu.ValueFilter",Sb),-1777747317,0,0!==this.vb.ValueFilterType,da.a.instance.ga(650));this.jLh(Sb.menu);
Lc=this.Va.Ec();Lc.buttons.push(this.Sd("PivotTableContextMenu.ManualFilter",1514686611,0,this.vb.HasManualFilter,da.a.instance.ga(94)));db.buttons.push(mc);db.buttons.push(rd);db.buttons.push(Sb);Z.menu.tc.push(db);Z.menu.tc.push(Lc);Z&&0<db.buttons.length&&qb.buttons.push(Z)}}vJh(qb){qb.tc.push(this.lcc(!0,!1));qb.tc.push(this.CQh());qb.tc.push(this.BQh());qb.tc.push(this.rSh());qb.tc.push(this.uSh());qb.tc.push(this.sSh());qb.tc.push(this.tSh());qb.tc.push(this.vSh());qb.tc.push(this.wSh());qb.tc.push(this.pQh())}kJh(qb){qb.tc.push(this.lcc(!0,
!0));qb.tc.push(this.gZh());qb.tc.push(this.vWh())}eKh(qb){qb.tc.push(this.lcc(!0,!1));qb.tc.push(this.y1e(!0));qb.tc.push(this.VMh());qb.tc.push(this.APh());qb.tc.push(this.w0e(!0));qb.tc.push(this.A_e(!0))}jLh(qb){qb.tc.push(this.lcc(!1,!1));qb.tc.push(this.y1e(!1));qb.tc.push(this.w0e(!1));qb.tc.push(this.A_e(!1));qb.tc.push(this.A2h())}A2h(){const qb=this.Va.Ec();qb.buttons.push(this.Sd("PivotTableContextMenu.Top10",-1611233597,0,Ed.l(this.vb.ValueFilterType),da.a.instance.ga(105)));return qb}APh(){const qb=
this.Va.Ec();this.vb&&(qb.buttons.push(this.Sd("PivotTableContextMenu.Contains",786260386,0,10===this.vb.LabelOrDateFilterType,da.a.instance.ga(652),"10")),qb.buttons.push(this.Sd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.vb.LabelOrDateFilterType,da.a.instance.ga(653),"11")));return qb}VMh(){const qb=this.Va.Ec();this.vb&&(qb.buttons.push(this.Sd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.vb.LabelOrDateFilterType,da.a.instance.ga(654),"6")),qb.buttons.push(this.Sd("PivotTableContextMenu.DoesNotBeginWith",
786260386,0,7===this.vb.LabelOrDateFilterType,da.a.instance.ga(655),"7")),qb.buttons.push(this.Sd("PivotTableContextMenu.EndsWith",786260386,0,8===this.vb.LabelOrDateFilterType,da.a.instance.ga(656),"8")),qb.buttons.push(this.Sd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.vb.LabelOrDateFilterType,da.a.instance.ga(657),"9")));return qb}y1e(qb){const Sb=this.Va.Ec();if(this.vb){const mc=qb?Ed.c:Ed.f;Sb.buttons.push(this.Sd(this.KH("PivotTableContextMenu.Equals",mc),786260386,0,qb?4===
this.vb.LabelOrDateFilterType:18===this.vb.ValueFilterType,da.a.instance.ga(100),qb?"4":"18"));Sb.buttons.push(this.Sd(this.KH("PivotTableContextMenu.DoesNotEqual",mc),786260386,0,qb?5===this.vb.LabelOrDateFilterType:19===this.vb.ValueFilterType,da.a.instance.ga(101),qb?"5":"19"))}return Sb}w0e(qb){const Sb=this.Va.Ec();if(this.vb){const mc=qb?Ed.c:Ed.f;Sb.buttons.push(this.Sd(this.KH("PivotTableContextMenu.GreaterThan",mc),786260386,0,qb?12===this.vb.LabelOrDateFilterType:20===this.vb.ValueFilterType,
da.a.instance.ga(102),qb?"12":"20"));Sb.buttons.push(this.Sd(this.KH("PivotTableContextMenu.GreaterThanOrEqualTo",mc),786260386,0,qb?13===this.vb.LabelOrDateFilterType:21===this.vb.ValueFilterType,da.a.instance.ga(658),qb?"13":"21"));Sb.buttons.push(this.Sd(this.KH("PivotTableContextMenu.LessThan",mc),786260386,0,qb?14===this.vb.LabelOrDateFilterType:22===this.vb.ValueFilterType,da.a.instance.ga(103),qb?"14":"22"));Sb.buttons.push(this.Sd(this.KH("PivotTableContextMenu.LessThanOrEqualTo",mc),786260386,
0,qb?15===this.vb.LabelOrDateFilterType:23===this.vb.ValueFilterType,da.a.instance.ga(659),qb?"15":"23"))}return Sb}A_e(qb){const Sb=this.Va.Ec();if(this.vb){const mc=qb?Ed.c:Ed.f;Sb.buttons.push(this.Sd(this.KH("PivotTableContextMenu.Between",mc),786260386,0,qb?16===this.vb.LabelOrDateFilterType:24===this.vb.ValueFilterType,da.a.instance.ga(104),qb?"16":"24"));Sb.buttons.push(this.Sd(this.KH("PivotTableContextMenu.NotBetween",mc),786260386,0,qb?17===this.vb.LabelOrDateFilterType:25===this.vb.ValueFilterType,
da.a.instance.ga(660),qb?"17":"25"))}return Sb}lcc(qb,Sb){const mc=this.Va.Ec();if(this.vb){var Lc=da.a.instance.ga(98);const Z=qb?this.vb.LabelOrDateFilterType.toString():this.vb.ValueFilterType.toString();var rd=["PivotTableContextMenu.ClearFilter",this.Zva(this.vb.Caption),Z];qb=qb?this.vb.IsDateField?Sb?1015867427:1105960559:1217404289:-743135194;rd.push(qb.toString());rd=rd.join(".");Lc=this.Sd(rd,qb,0,!1,Lc,Z,Lc,8,lb.a.n3a);mc.buttons.push(Lc)}return mc}CQh(){const qb=this.Va.Ec();this.vb&&
qb.buttons.push(this.Sd(this.KH("PivotTableContextMenu.Equals",Ed.d),786260386,0,26===this.vb.LabelOrDateFilterType,da.a.instance.ga(100),"26"));return qb}BQh(){const qb=this.Va.Ec();this.vb&&(qb.buttons.push(this.Sd("PivotTableContextMenu.Before",786260386,0,27===this.vb.LabelOrDateFilterType,da.a.instance.ga(112),"27")),qb.buttons.push(this.Sd("PivotTableContextMenu.After",786260386,0,28===this.vb.LabelOrDateFilterType,da.a.instance.ga(113),"28")),qb.buttons.push(this.Sd("PivotTableContextMenu.Between",
786260386,0,29===this.vb.LabelOrDateFilterType,da.a.instance.ga(104),"29")));return qb}rSh(){const qb=this.Va.Ec();this.vb&&(qb.buttons.push(this.Sd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.vb.LabelOrDateFilterType,da.a.instance.ga(110),"30")),qb.buttons.push(this.Sd("PivotTableContextMenu.Today",1778578888,0,31===this.vb.LabelOrDateFilterType,da.a.instance.ga(109),"31")),qb.buttons.push(this.Sd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.vb.LabelOrDateFilterType,da.a.instance.ga(111),
"32")));return qb}uSh(){const qb=this.Va.Ec();this.vb&&(qb.buttons.push(this.Sd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.vb.LabelOrDateFilterType,da.a.instance.ga(115),"33")),qb.buttons.push(this.Sd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.vb.LabelOrDateFilterType,da.a.instance.ga(114),"34")),qb.buttons.push(this.Sd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.vb.LabelOrDateFilterType,da.a.instance.ga(116),"35")));return qb}sSh(){const qb=this.Va.Ec();this.vb&&
(qb.buttons.push(this.Sd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.vb.LabelOrDateFilterType,da.a.instance.ga(117),"36")),qb.buttons.push(this.Sd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.vb.LabelOrDateFilterType,da.a.instance.ga(118),"37")),qb.buttons.push(this.Sd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.vb.LabelOrDateFilterType,da.a.instance.ga(119),"38")));return qb}tSh(){const qb=this.Va.Ec();this.vb&&(qb.buttons.push(this.Sd("PivotTableContextMenu.NextQuarter",
1778578888,0,39===this.vb.LabelOrDateFilterType,da.a.instance.ga(120),"39")),qb.buttons.push(this.Sd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.vb.LabelOrDateFilterType,da.a.instance.ga(121),"40")),qb.buttons.push(this.Sd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.vb.LabelOrDateFilterType,da.a.instance.ga(122),"41")));return qb}vSh(){const qb=this.Va.Ec();this.vb&&(qb.buttons.push(this.Sd("PivotTableContextMenu.NextYear",1778578888,0,42===this.vb.LabelOrDateFilterType,
da.a.instance.ga(123),"42")),qb.buttons.push(this.Sd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.vb.LabelOrDateFilterType,da.a.instance.ga(124),"43")),qb.buttons.push(this.Sd("PivotTableContextMenu.LastYear",1778578888,0,44===this.vb.LabelOrDateFilterType,da.a.instance.ga(125),"44")));return qb}wSh(){const qb=this.Va.Ec();if(this.vb){qb.buttons.push(this.Sd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.vb.LabelOrDateFilterType,da.a.instance.ga(126),"45"));const Sb=this.Gja("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,Ed.i(this.vb.LabelOrDateFilterType),da.a.instance.ga(127));this.kJh(Sb.menu);qb.buttons.push(Sb)}return qb}pQh(){const qb=this.Va.Ec();this.vb&&qb.buttons.push(this.Sd("PivotTableContextMenu.CustomFilter",786260386,0,this.jCj(this.vb.LabelOrDateFilterType),da.a.instance.ga(108),"26"));return qb}gZh(){const qb=this.Va.Ec();this.vb&&(qb.buttons.push(this.Sd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.vb.LabelOrDateFilterType,da.a.instance.ga(128),"46")),qb.buttons.push(this.Sd("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.vb.LabelOrDateFilterType,da.a.instance.ga(129),"47")),qb.buttons.push(this.Sd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.vb.LabelOrDateFilterType,da.a.instance.ga(130),"48")),qb.buttons.push(this.Sd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.vb.LabelOrDateFilterType,da.a.instance.ga(131),"49")));return qb}vWh(){const qb=this.Va.Ec();this.vb&&(qb.buttons.push(this.Sd("PivotTableContextMenu.January",1778578888,0,50===this.vb.LabelOrDateFilterType,da.a.instance.ga(132),
"50")),qb.buttons.push(this.Sd("PivotTableContextMenu.February",1778578888,0,51===this.vb.LabelOrDateFilterType,da.a.instance.ga(133),"51")),qb.buttons.push(this.Sd("PivotTableContextMenu.March",1778578888,0,52===this.vb.LabelOrDateFilterType,da.a.instance.ga(134),"52")),qb.buttons.push(this.Sd("PivotTableContextMenu.April",1778578888,0,53===this.vb.LabelOrDateFilterType,da.a.instance.ga(135),"53")),qb.buttons.push(this.Sd("PivotTableContextMenu.May",1778578888,0,54===this.vb.LabelOrDateFilterType,
da.a.instance.ga(136),"54")),qb.buttons.push(this.Sd("PivotTableContextMenu.June",1778578888,0,55===this.vb.LabelOrDateFilterType,da.a.instance.ga(137),"55")),qb.buttons.push(this.Sd("PivotTableContextMenu.July",1778578888,0,56===this.vb.LabelOrDateFilterType,da.a.instance.ga(138),"56")),qb.buttons.push(this.Sd("PivotTableContextMenu.August",1778578888,0,57===this.vb.LabelOrDateFilterType,da.a.instance.ga(139),"57")),qb.buttons.push(this.Sd("PivotTableContextMenu.September",1778578888,0,58===this.vb.LabelOrDateFilterType,
da.a.instance.ga(140),"58")),qb.buttons.push(this.Sd("PivotTableContextMenu.October",1778578888,0,59===this.vb.LabelOrDateFilterType,da.a.instance.ga(141),"59")),qb.buttons.push(this.Sd("PivotTableContextMenu.November",1778578888,0,60===this.vb.LabelOrDateFilterType,da.a.instance.ga(142),"60")),qb.buttons.push(this.Sd("PivotTableContextMenu.December",1778578888,0,61===this.vb.LabelOrDateFilterType,da.a.instance.ga(143),"61")));return qb}fKh(qb){const Sb=this.Va.Ec();if(this.N6f()){var mc=this.jc.tL[4===
this.Be.CellType?this.jc.P6c-1:this.Be.CurrentFieldIndex-1];if(mc&&this.lbb){var Lc=this.Va.tw("ContextMenu.PivotTableLayout",null,da.a.instance.ga(647),-1777747317);var rd=this.Va.Ec();const Z=String.format(da.a.instance.nb(169),this.lbb),db=String.format(da.a.instance.nb(170),this.lbb);rd.buttons.push(this.Sd($a,-1457478532,0,!mc.IsCompactLayout,Z));rd.buttons.push(this.Sd(Xe,-1390365353,0,mc.IsCompactLayout,db));Lc.menu.tc.push(rd);Lc&&Sb.buttons.push(Lc)}}if(1===this.Be.CellArea||2===this.Be.CellArea)this.vb.Caption&&
(mc="",rd=this.eTa(),Lc=String.format(da.a.instance.nb(159),this.YKa(rd)),rd&&(mc=String.format(da.a.instance.nb(159),this.vb.Caption)),1===this.Be.CellArea?(mc=this.Gja("ContextMenu.PivotTableSubtotal",1801458190,0,this.vb.ShowSubtotal,Lc),Lc=this.Va.Ec(),Lc.buttons.push(this.Va.pb(259)),Lc.buttons.push(this.Sd("ContextMenu.PivotTableSubtotalOnTop",671485366,639,this.vb.ShowSubtotal&&this.vb.ShowSubtotalAtTop)),Lc.buttons.push(this.Sd("ContextMenu.PivotTableSubtotalOnBottom",772221736,640,this.vb.ShowSubtotal&&
!this.vb.ShowSubtotalAtTop)),mc.menu.tc.push(Lc),mc&&0<Lc.buttons.length&&Sb.buttons.push(mc)):(rd=rd?this.KH(He,this.Zva(Lc)):He,Sb.buttons.push(this.Sd(rd,1801458190,0,this.vb.ShowSubtotal,Lc,null,mc)))),Sb.buttons.push(this.Sd("ContextMenu.RepeatItemLabels",-556893687,642,this.vb.RepeatItemLabels));1===this.Be.CellArea&&Sb.buttons.push(this.Sd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,641,this.vb.ShowBlankLineAfterEachItem));qb.tc.push(Sb)}SKh(qb){const Sb=this.Va.Ec();Sb.buttons.push(this.Va.pb(247));
qb.tc.push(Sb)}qKh(qb){if(this.$.isEditMode&&this.grid){var Sb=this.grid.ha.ra.activeRange;if(Sb.top===Sb.bottom&&Sb.left===Sb.right&&0!==this.Be.MoveItemsMenuState){Sb=this.Gja("PivotTableContextMenu.Move",-1777747317,0,!1,da.a.instance.ga(73));var mc=this.Va.Ec();this.yva(mc,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(da.a.instance.nb(162),this.Be.MoveItemName),0===(this.Be.MoveItemsMenuState&1));this.yva(mc,"PivotTableContextMenu.MoveUp",713270357,String.format(da.a.instance.nb(163),
this.Be.MoveItemName),0===(this.Be.MoveItemsMenuState&2));this.yva(mc,"PivotTableContextMenu.MoveDown",-1842411134,String.format(da.a.instance.nb(160),this.Be.MoveItemName),0===(this.Be.MoveItemsMenuState&4));this.yva(mc,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(da.a.instance.nb(161),this.Be.MoveItemName),0===(this.Be.MoveItemsMenuState&8));Sb.menu.tc.push(mc);mc=this.Va.Ec();this.yva(mc,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(da.a.instance.nb(167),this.YKa(this.eTa())),
0===(this.Be.MoveItemsMenuState&16));this.yva(mc,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(da.a.instance.nb(164),this.YKa(this.eTa())),0===(this.Be.MoveItemsMenuState&32));this.yva(mc,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(da.a.instance.nb(165),this.YKa(this.eTa())),0===(this.Be.MoveItemsMenuState&64));this.yva(mc,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(da.a.instance.nb(166),this.YKa(this.eTa())),0===(this.Be.MoveItemsMenuState&
128));Sb.menu.tc.push(mc);qb.buttons.push(Sb)}}}JKh(qb){var Sb="";let mc="";var Lc=!1;3===this.Be.CellType?Sb=da.a.instance.ga(644):8===this.Be.CellType?this.jc&&(Sb=String.format(da.a.instance.nb(168),this.jc.zJe)):this.vb&&((Lc=this.eTa())&&(mc=String.format(da.a.instance.nb(168),this.vb.Caption)),Sb=String.format(da.a.instance.nb(168),this.YKa(Lc)));Sb&&(Lc=Lc?this.KH(Ae,this.Zva(Sb)):Ae,Sb=this.Sd(Lc,-1951357930,0,!1,Sb,null,mc,8,lb.a.qad),qb.buttons.push(Sb))}sJh(qb){const Sb=this.Va.Ec();Sb.buttons.push(this.Va.pb(43));
this.vb&&this.Be&&this.$.isEditMode&&(0===this.Be.CellType||4===this.Be.CellType)&&Sb.buttons.push(this.Va.pb(136));if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&X.EwaSettings.ma(104)&&this.grid&&this.grid.ha){const mc=this.grid.ha.ra.selectedRanges;mc&&1===mc.length&&(mc[0].isSingle||this.grid.Bb.HNa(mc[0]))&&this.grid.Bb.Oxa(mc[0])&&!this.grid.Bb.Ozb(mc[0])&&Sb.buttons.push(this.Va.pb(this.grid.Bb.Yff(mc[0])?217:216))}qb.tc.push(Sb)}IKh(qb){const Sb=
this.Va.Ec();Sb.buttons.push(this.Va.pb(100));qb.tc.push(Sb)}YKh(qb){const Sb=2===this.vb.MeasureType&&!this.vb.IsNumeric,mc=this.Va.tw("ContextMenu.SummarizeValuesBy",null,da.a.instance.ga(645),-249874296),Lc=this.Va.Ec();Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesBySum",-1255320719,1102,0===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Sb));Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByCount",1746132849,1103,1===this.vb.DataFieldAggregationType));Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByAverage",
-771066011,1104,2===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Sb));Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByMax",835007294,1105,3===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Sb));Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByMin",929115636,1106,4===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Sb));Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByProduct",1935475057,1107,5===this.vb.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,this.$5f(!0)||Sb));2!==this.vb.MeasureType&&(Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1108,6===this.vb.DataFieldAggregationType)),Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1109,7===this.vb.DataFieldAggregationType)),Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1110,8===this.vb.DataFieldAggregationType)),Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByVariant",
1668427539,1111,9===this.vb.DataFieldAggregationType)),Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1112,10===this.vb.DataFieldAggregationType)));this.jc&&this.jc.zic()&&Lc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1113,11===this.vb.DataFieldAggregationType));mc.menu.tc.push(Lc);qb.buttons.push(mc)}TKh(qb){const Sb=this.Va.tw("ContextMenu.ShowValuesAs",null,da.a.instance.ga(646),-1128612833),mc=this.Va.Ec();mc.buttons.push(this.Sd("ContextMenu.ShowValuesAsNoCalculation",
-841863025,1119,0===this.vb.DataFieldFormatType));mc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1126,7===this.vb.DataFieldFormatType));mc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1125,6===this.vb.DataFieldFormatType));mc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1124,5===this.vb.DataFieldFormatType));mc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1129,9===this.vb.DataFieldFormatType));
mc.buttons.push(this.Sd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1130,10===this.vb.DataFieldFormatType));if(this.jc&&this.jc.tL&&0<this.jc.tL.length||this.jc.Q$&&0<this.jc.Q$.length){const Lc=this.Gja("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1131,11===this.vb.DataFieldFormatType),rd=this.Va.Ec(),Z=this.XKh();for(let db=0;db<Z.length;db++){const Lb=Z[db];rd.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfParentTotal."+Lb.Caption,-2031744961,1131,11===this.vb.DataFieldFormatType&&
this.vb.BaseFieldIndex===Lb.Index,Lb.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Lb.Index))}Lc.menu.tc.push(rd);mc.buttons.push(Lc)}Sb.menu.tc.push(mc);qb.buttons.push(Sb)}showPivotTableContextMenu(){this.Ypd=!0;this.expandCollapse=this.BZ=this.refresh=!1;var qb=this.$,Sb=K.h(qb),mc=dc.a(qb).pLa();if(mc){var Lc=tb.a(qb);if(null===Lc||void 0===Lc?0:Lc.oTd)this.Ypd=Ha.f(qb.lg);Lc=qb.dc;this.BZ=mc.supportsBIExplore&&!!Pa.a(qb)&&Lc.W2(32768);Lc.allowInteractivity&&(qb=Sb.Sb(null),(null===
qb||void 0===qb?0:qb.cell)&&(qb.cell.i0c||qb.cell.K6f)&&(this.expandCollapse=!0),Lc.allowManualDataRefresh&&(this.refresh=!0))}qb=null;mc=1;this.u1a&&1!==this.u1a.tb?(qb=new Sys.UI.Point(this.u1a.clientPoint.x,this.u1a.clientPoint.y),mc=this.u1a.tb):(Sb=Ma.e(Sb,this.$))&&(qb=new Sys.UI.Point(Sb.x+(this.$.isChromeRtl?0:Sb.width),Sb.y+Sb.height));B.a.Db=mc;this.Jjc=3===mc;this.Qp(qb,!0,mc);this.Sba=!0;this.XWd()}y$h(){const qb=new M.a(1114549926,0,this.$.Hc,19,null);this.$.Ja.Kb(qb)}kYh(){if(this.jc&&
this.jc.fp){var qb=this.jc.fp.CurrentCol;if(this.jc.fp.CurrentRow===this.activeCell.FirstRow&&qb===this.activeCell.FirstColumn){this.fMb();this.showPivotTableContextMenu();return}}qb=new J.a(228,0,(Sb,mc,Lc)=>fe.l(this.$.pa.ya,this.activeCell,oa.b(Sb,this.XPi),oa.a(mc,this.WPi),Lc,null),16);this.$.userOperationManager.Ic(qb,null)}Ioi(){if(gb.a.fd(this.$)){var qb=this.$.da.za(441);if(qb)return qb.ms}else if(qb=this.$.da.za(346))return qb.ms;return!1}KH(qb,Sb){return qb+"."+Sb}performPivotTableOperation(qb,
Sb){const mc=Yd.a.Qa.zb;if(!this.jc||!this.vb&&this.Be&&3!==this.Be.CellType)this.vj();else{var Lc=this.jc.isOlap;dc.a(this.$).Px(Lc,rd=>{rd&&this.$.Ic(qb,(Z,db,Lb)=>Od(this.s2d,this.activeCell,Sb,this.vb?this.vb.Caption:null,this.lbb,oa.b(Z,this.KTi),oa.a(db,this.JTi),Lb,null,this.$.pa.ya.Wb()),mc,0,4,229)})}}applyValueFieldSettingsToPivotTable(qb,Sb=!1){const mc=Yd.a.Qa.zb;this.jc&&this.vb?(Sb&&2===this.vb.MeasureType&&d.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),
Sb=this.jc.isOlap,dc.a(this.$).Px(Sb,Lc=>{Lc&&this.$.Ic(qb,(rd,Z,db)=>se(this.s2d,this.activeCell,this.mA,oa.b(rd,this.lKi),oa.a(Z,this.kKi),db,null,this.$.pa.ya.Wb()),mc,0,4,231)})):this.vj()}Sd(qb,Sb,mc,Lc,rd=null,Z=null,db=null,Lb=8,hc=null,Pc=!1){Lc&&(qb+=".Checked");Pc&&(qb+=".Disabled");this.Va.Kod(qb)&&this.Va.KKd(qb);mc=rd||da.a.instance.ga(mc);qb=this.Va.AIa(qb,mc,Sb,null,"None",Z,Pc,null);qb.Cxc(null);db&&qb.mS(db);Lc?qb.oS("Image16by16",3,lb.a.zaa):hc?qb.oS("Image16by16",Lb,hc):qb.K3b();
return qb}Gja(qb,Sb,mc,Lc,rd=null){mc=rd||da.a.instance.ga(mc);this.Va.Kod(qb)?this.Va.KKd(qb):this.Va.KKd(qb+".Checked");Lc&&(qb+=".Checked");this.zAj&&(mc=this.Vmh.parseFromString(mc,"text/html").body.innerText);qb=this.Va.W4c(qb,null,mc,Sb,3,lb.a.zaa);qb.Ccf=Lc;!Lc&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&qb.K3b();return qb}jdi(){this.mA=Object(f.a)(new Fc,{PivotValueFieldSummarizeValueByApplyData:Object(f.a)(new me,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(f.a)(new Ac,
{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}PSa(qb,Sb){this.mA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=qb;this.mA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=Sb;this.mA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}XKh(){const qb=[];if(this.jc&&this.jc.Q$&&0<this.jc.Q$.length)for(const Sb of this.jc.Q$)Sb&&qb.push(Sb);if(this.jc&&this.jc.tL&&0<this.jc.tL.length)for(const Sb of this.jc.tL)Sb&&qb.push(Sb);qb.sort((Sb,
mc)=>Sb.Index-mc.Index);return qb}N6f(){if(!this.Be||!this.jc||!this.jc.tL)return!1;const qb=1===this.Be.CellArea||4===this.Be.CellType&&this.Be.IsRowAxis,Sb=4===this.Be.CellType?0<this.jc.P6c:0<this.Be.CurrentFieldIndex;return 1<this.jc.tL.length&&qb&&Sb}$Ka(qb){const Sb=[];3===qb?this.$.isEditMode?Sb.push(...[fb.a.gLf,fb.a.iLf,fb.a.u1i]):Sb.push(...[fb.a.copy]):2===qb&&Sb.push(fb.a.FAe);return Sb}vj(){const qb=N.a.Zc(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");dd.a(this.$).vj(qb)}mCj(){return this.vb?
0!==this.vb.LabelOrDateFilterType||0!==this.vb.ValueFilterType||this.vb.HasManualFilter:!1}jCj(qb){return 62<=qb&&65>=qb}yvi(){if(this.activeCell&&this.vb&&this.jc){var qb={};qb.cell=this.activeCell;qb.dataSourceIndex=this.jc.externalSourceIndex;qb.fieldId=this.vb.Index.toString();qb.isOlap=this.jc.isOlap;qb.confirmationRequired=this.jc.confirmationRequiredForDataOps;var Sb={};Sb.showPivotFilterDialogCommandData=qb;this.$.Xc(492140419,B.a.Db,19,Sb)}}C2g(qb){this.activeCell&&this.vb&&this.jc&&this.$.userOperationManager.Ic(new J.a(153,
0,(Sb,mc,Lc)=>L.A(this.$.pa.ya,this.activeCell,this.jc.externalSourceIndex,this.vb.Index.toString(),qb,Sb,mc,Lc,null,null)),null)}RPg(qb){!(30>qb||61<qb)&&this.activeCell&&this.vb&&this.jc&&this.$.userOperationManager.Ic(new J.a(152,0,(Sb,mc,Lc)=>L.e(this.$.pa.ya,this.activeCell,this.jc.externalSourceIndex,this.vb.Index.toString(),qb,Sb,mc,Lc,null,null)),null)}applyPivotSort(qb){if(this.jc&&this.vb&&this.activeCell&&this.Be){var Sb=1===this.Be.CellArea||2===this.Be.CellArea;8===this.Be.CellArea?Id.a(this.$.userOperationManager,
(mc,Lc,rd)=>fe.b(this.$.pa.ya,this.activeCell,qb,this.vb.Caption,mc,Lc,rd,null),mc=>new J.a(1015,0,mc,void 0,null),null):Sb&&(Sb=1===this.Be.CellArea?1:2,this.$.ma(682)?Le.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.jc.externalSourceIndex,this.vb.Index.toString(),this.vb.Caption,this.jc.isOlap?"":this.vb.Caption,Sb,1===qb):Le.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.jc.externalSourceIndex,this.vb.Index.toString(),1===
qb))}}qS(){return!this.jc||!this.jc.isActionable}RAj(){return(this.Be||this.jc)&&4!==this.Be.CellType&&(0!==this.Be.CellType||8!==this.Be.CellArea||this.jc.Q$&&this.jc.Q$.length||this.jc.tL&&this.jc.tL.length)?!1:!0}SAj(){return this.Be&&this.jc&&(1===this.Be.CellArea||2===this.Be.CellArea)&&this.jc.LQb&&this.jc.LQb.length?!1:!0}yva(qb,Sb,mc,Lc,rd){qb.buttons.push(this.Sd(Sb,mc,0,!1,Lc,null,null,8,null,rd))}}Object(c.a)(ac,"PivotTableContextMenu",y.a,[]);class Da{compare(qb,Sb){return(qb||"").localeCompare(Sb||
"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(c.a)(Da,"DigitsAsNumberComparer",null,[454]);var Na=a(1081),sb=a(154),Kb=a(345),Yb=a(262),vc=a(24),ad=a(145);const ld=t.a.x7g;class md extends y.a{constructor(qb,Sb,mc,Lc){super(qb,"PopulateTableFieldListContextMenu",-751848458,-1085236154,ld,!0,!1,"TableFieldListContextMenuRoot",Sb,mc,!1,Lc);this.r6b=null;this.VAd=0;this.sFa=null;this.grid=K.h(qb)}get Zw(){return"PopulateTableFieldListContextMenu"}get OB(){return t.a.eQf}get iL(){this.sFa||(this.sFa=
this.$.da.za(261));return this.sFa}executeCommand(qb,Sb,mc){qb=Sb.command;switch(qb){case 639960842:this.applyTableFieldList(mc);this.iL.Qda();break;case -1085236154:d.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.VAd}`);this.iL.Qda();break;case 1833782813:this.iL.showCallout();break;default:return sa.a(qb)}return rb.Task.Ta(!0)}applyTableFieldList(qb){var Sb=qb.MenuItemId.toString();X.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(Sb=Sb.replace("'","''"),Sb=Sb.replace("[","'["),Sb=Sb.replace("]","']"));var mc=Object(Vb.a)(String,qb.SourceControlId);const Lc={};Lc.PulloutField=Sb;Lc.PulloutCardPath=qb.SourceCardKeyPath;Lc.PulloutCardSourceRow=qb.SourceCardRow;Lc.PulloutCardSourceColumn=qb.SourceCardColumn;if(this.iL.GN){d.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");Lc.ParameterType=2;qb=qb.ColumnIndex;if(void 0===qb||null===qb){if(void 0===mc||null===mc){d.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}qb=0<=this.iL.mOf?this.iL.mOf:parseInt(mc.substring(20+Sb.length+1,mc.length),10);if(isNaN(qb)){d.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${mc}`);return}}Lc.PulloutRichColumnSourceIndex=qb;if(this.sFa.rNg){this.dOg(Sb,Lc);return}}else d.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),Lc.ParameterType=4,mc=this.iL.selectedRange.right,gb.a.hAb()&&this.sFa.nxa&&(Lc.ParameterType=8,qb=this.iL.fma.top,qb=
vc.Range.OM(mc)+qb,Sb==Na.d?(Sb="=DAYS("+qb+", TODAY())",ad.a("DateFormulaPulledOut_DaysFromToday")):Sb==Na.g?(Sb="=IF(TODAY() < "+qb+", DATEDIF(TODAY(), "+qb+', "Y"), DATEDIF('+qb+', TODAY(), "Y"))',ad.a("DateFormulaPulledOut_YearsFromToday")):Sb==Na.c?(Sb="=TEXT("+qb+', "dddd")',ad.a("DateFormulaPulledOut_DayOfWeek")):Sb==Na.f?(Sb="=TEXT("+qb+', "mmmm")',ad.a("DateFormulaPulledOut_MonthOfYear")):Sb==Na.e?(Sb="EOMONTH("+qb+", 0)",Sb="=DATE(YEAR("+Sb+"), MONTH("+Sb+"), DAY("+Sb+"))",ad.a("DateFormulaPulledOut_EndOfMonth")):
Sb==Na.b&&(Sb="="+qb+" + 1",ad.a("DateFormulaPulledOut_AddOneDay"))),void 0!==Lc.PulloutCardSourceColumn&&null!==Lc.PulloutCardSourceColumn&&(mc=Lc.PulloutCardSourceColumn+1),Lc.PulloutRichColumnSourceIndex=mc;this.WQd(Sb,Lc)}WQd(qb,Sb,mc=0){d.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.VAd}, SelectedColumnIndex, ${Sb.PulloutRichColumnSourceIndex}`);qb=Object(f.a)(new Yb.a,{Text:qb});this.grid.setCell(qb,this.iL.fma,0,127,Sb,mc);this.grid.focus();
this.r6b=null;this.iL.Qda();this.iL.Dkj()}wc(qb,Sb,mc){if(qb=this.$.isEditMode&&X.EwaSettings.ma(135)&&!!this.iL)switch(Sb.command){case -1085236154:break;case 639960842:qb=!!mc;break;case 1833782813:qb=this.iL.exa&&this.iL.TCb;break;default:qb=!1}return qb}Y0(qb,Sb,mc){this.$.isEditMode&&(this.r6b=this.lKh(Object(Vb.a)(444,mc)),super.Y0(qb,Sb,null,null,!1))}hZ(){return this.r6b}V4c(qb){if(!this.iL||!qb||!qb.al)return d.ULS.shipAssertTag(537166994,0,!!this.iL,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
d.ULS.shipAssertTag(537166993,0,!!qb,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),qb&&d.ULS.shipAssertTag(537166992,0,!!qb.al,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let Sb=new wb.a;for(const Lc of qb.al){qb=new wb.a;qb.add(Lc.ColumnName);qb.add(Lc.ColumnIndex.toString());let rd=new wb.a;var mc=null;gb.a.hAb()&&this.sFa.nxa?rd=la.toList(la.select(la.asEnumerable(Lc.FieldInfoDataList),Z=>Z.Name)):(mc=
X.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Da:new Ra.a,rd=la.OBc(la.concat(rd,la.select(la.asEnumerable(Lc.FieldInfoDataList),Z=>Z.Name)),Z=>Z,mc));mc=new wb.a;mc.add(la.toArray(la.concat(qb,rd)));Sb=la.toList(la.concat(Sb,mc))}return la.toArray(Sb)}lKh(qb){var Sb=this.V4c(qb);if(!Sb||!Sb.length)return this.r6b=null;qb=this.Va;const mc=qb.aq(this.menuId);let Lc=qb.Ec();const rd=1<Sb.length,Z=gb.a.hAb()&&this.sFa.nxa;this.VAd=Sb.length;for(const db of Sb){Z?
Lc.title="Calculate Date Information":rd||(Lc.title=db[0]);Sb=qb.Ec();for(let Lb=2,hc=db.length;Lb<hc;++Lb)!Z||db[Lb]!=Na.d&&db[Lb]!=Na.e||(mc.tc.push(Lc),Lc=qb.Ec()),(rd?Sb.buttons:Lc.buttons).push(qb.AIa("ApplyTableFieldList."+db[Lb]+"."+db[1],db[Lb],639960842,null,"None",db[Lb],!1,void 0,!0));if(rd){const Lb=qb.tw("ApplyTableFieldList."+db[0],this.menuId,db[0],798637440);Lb.menu.tc.push(Sb);Lc.buttons.push(Lb)}}mc.tc.push(Lc);return mc}dOg(qb,Sb){const mc=N.a.Zc(12,1,0,899,0,2007340793,"RichValuePulloutIntoNonEmptyRange");
if(X.EwaSettings.Iz()){const Lc=new Kb.a(this.$,mc);Lc.KP(()=>{2===Lc.returnValue&&this.WQd(qb,Sb,8)})}else{const Lc=new sb.ErrorDialog(this.$,mc);Lc.KP(()=>{2===Lc.returnValue&&this.WQd(qb,Sb,8)});Lc.vg()}}}Object(c.a)(md,"PulloutFieldListContextMenu",y.a,[]);const Qd=t.a.gQf;class ce extends y.a{constructor(qb,Sb,mc,Lc){super(qb,"PopulateRichTextContextMenu",679816325,1151222423,Qd,!0,!1,Qd,Sb,mc,!0,Lc);this.grid=K.h(qb)}get Zw(){return"PopulateRichTextContextMenu"}get OB(){return t.a.gQf}wc(qb,
Sb,mc){return-1687037502===Sb.command&&!!mc&&this.grid.eb}executeCommand(qb,Sb,mc){this.showRichTextFloatie(mc);return rb.Task.Ta(!0)}$Ka(){return[fb.a.b0g]}showRichTextFloatie(qb){var Sb=Object(Vb.a)(xa.a,qb.eventArgs);Sb&&(qb=this.$Ka(Sb.tb),Sb=new Sys.UI.Point(Sb.Ca.clientX,Sb.Ca.clientY),this.showFloatie(qb,new Sys.UI.Bounds(Sb.x,Sb.y,0,0),2))}}Object(c.a)(ce,"RichTextContextMenu",y.a,[]);var ec=a(99),Vc=a(573);const td=t.a.w7g;class he extends y.a{constructor(qb,Sb,mc,Lc){super(qb,"PopulateSheetOpsContextMenu",
274207288,-1497523576,td,!0,!1,"SheetTabContextMenuRootName",Sb,mc,!1,Lc);this.Bjc=this.$hc=!1}get Zw(){return"PopulateSheetOpsContextMenu"}get OB(){return t.a.hQf}executeCommand(qb,Sb,mc){if(eb.a(this.$))return rb.Task.Ta(!0);this.$.isEditMode&&(qb=mc[t.a.E5f],qb=qb.x&&qb.y?new Sys.UI.Point(qb.x+(this.$.isChromeRtl?10:-10),qb.y):yb.DOMElementExtensions.getLocation(mc[t.a.F5f]),this.Qp(qb,!1));return rb.Task.Ta(!0)}wc(qb,Sb,mc){return-1075099431===Sb.command&&!!mc}hZ(){const qb=this.Va.aq(this.menuId),
Sb=this.$.isEditMode;this.cYj();this.$Jh(qb,Sb);this.PJh(qb);this.RKh(qb);return qb}g_b(qb,Sb,mc,Lc){qb.push(this.Va.pb(Sb?mc:Lc))}$Jh(qb,Sb){var mc=this.Va;const Lc=mc.Ec();Lc.buttons.push(mc.pb(54));this.g_b(Lc.buttons,this.Bjc,127,56);Lc.buttons.push(mc.pb(55));Sb&&this.g_b(Lc.buttons,this.Bjc,126,125);Lc.buttons.push(mc.pb(158));Sb=this.$.xa.oa;X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.HK&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
Sb&&Sb.Gd&&(Sb.Gd.Gv||Sb.Gd.gI||Lc.buttons.push(mc.pb(299)));this.$.ea.OMb&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?m.AFrameworkApplication.jsd(Vc.a):this.$.va.ExcelSheetProtectionSettingsEnabled)&&(Sb=Object(Vb.a)(ec.a,this.$.oa))&&na.p(Sb)&&this.$.isEditMode&&(Lc.buttons.push(mc.pb(277)),Sb.isLockPausedInSession?Lc.buttons.push(mc.pb(279)):Sb.ki&&Lc.buttons.push(mc.pb(278)));Sb=mc.tw("ContextMenu.TabColor",null,da.a.instance.ga(518),1841703919);
mc=mc.T4c(467002767,1549407384,541,-221093529,this.OB);Sb.menu.tc.push(mc);Lc.buttons.push(Sb);qb.tc.push(Lc)}PJh(qb){const Sb=this.Va.Ec();this.g_b(Sb.buttons,this.Bjc,114,112);this.g_b(Sb.buttons,!this.$hc,115,113);qb.tc.push(Sb)}RKh(qb){if(X.EwaSettings.ma(476)&&!na.e(this.$.xa.oa)){var Sb=this.Va,mc=Sb.Ec();mc.buttons.push(Sb.pb(263));qb.tc.push(mc)}}cYj(){let qb,Sb;({F4c:qb,eGe:Sb}=this.$.E4c());this.Bjc=1===qb;this.$hc=0<Sb}}Object(c.a)(he,"SheetOpsContextMenu",y.a,[]);var ne=a(517);class Te extends y.a{constructor(qb,
Sb,mc,Lc){super(qb,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",Sb,mc,!0,Lc)}get Zw(){return"PopulateSlicerContextMenu"}get OB(){return t.a.iQf}nc(qb,Sb){var mc=!0;switch(Sb){case -231711729:mc=!1;break;case -1909381757:mc=this.ndc();mc=!!mc&&mc.wli;break;case 1312363469:mc=!0}return!mc||super.nc(qb,Sb)}executeCommand(qb,Sb,mc){if(!this.$.isEditMode)return C.TaskExtensions.jba();qb=Sb.command;Sb=this.ndc();let Lc=null;switch(qb){case 2108047455:Sb&&
Sb.zCe();break;case -231711729:d.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:Sb&&Sb.S3b();break;case 1312363469:this.showSlicerContextMenu(mc);break;default:Lc=sa.a(qb)}return Lc||C.TaskExtensions.jba()}wc(qb,Sb,mc){qb=!1;switch(Sb.command){case -231711729:case 2108047455:case -1909381757:qb=!0;break;case 1312363469:qb=!!mc}return qb}hZ(){const qb=this.Va.aq(this.menuId);var Sb=this.Va.Ec();Sb.buttons.push(this.Va.pb(252));Sb.buttons.push(this.Va.pb(253));
Sb.buttons.push(this.Va.pb(254));qb.tc.push(Sb);Sb=this.Va.Ec();this.Yqi()?Sb.buttons.push(this.Va.pb(266)):Sb.buttons.push(this.Va.pb(267));qb.tc.push(Sb);return qb}Yqi(){if(gb.a.fd(this.$)){var qb=this.$.da.za(439);if(qb)return qb.ms}else if(qb=this.$.da.za(371))return qb.ms;return!1}showSlicerContextMenu(qb){var Sb=Object(Vb.a)(xa.a,qb.eventArgs);qb=this.Mbc(Object(Vb.a)(xa.a,qb.eventArgs));Sb=Sb.tb;B.a.Db=Sb;this.Qp(qb,!1,Sb)}DZe(qb){const Sb=this.Va.Ec(),mc=this.Va.Ec();mc.buttons.push(this.Va.pb(255));
mc.buttons.push(this.Va.pb(256));const Lc=this.Va.W4c("ContextMenu.SlicerSort",null,da.a.instance.ga(2173),-814639094,0,lb.a.ESe);Lc.menu.tc.push(mc);Sb.buttons.push(Lc);qb.tc.push(Sb)}DCj(qb){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&qb.Gb.className===lb.a.bad||X.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===qb.tb}Mbc(qb){var Sb=K.h(this.$).ha.Sa.$b;let mc=qb&&1!==qb.tb&&
qb.clientPoint?qb.clientPoint:Sys.UI.DomElement.getLocation(Sb.domElement);if(this.DCj(qb)){var Lc=this.ndc();Lc&&(qb.Gb.className===lb.a.bad&&(mc=Jb.HelperMethods.swb(qb.Ca)),1===qb.tb&&(mc=pa.a(this.$).cka(yb.DOMElementExtensions.getLocation(Lc.frame))))}else if(qb=this.ndc())qb=this.sTh(qb.frame),(Lc=Jb.HelperMethods.oD(this.$.vf,this.$.domElement,K.h(this.$).rtl,!1))?(qb.x=pa.a(this.$).zi(qb.x-Lc.x)+Lc.x,qb.y=pa.a(this.$).zi(qb.y-Lc.y)+Lc.y):d.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),
mc.y+=qb.y,mc.x+=qb.x;qb=this.$.domElement;Lc=K.h(this.$).rtl;Sb=Jb.HelperMethods.oD(Sb.pg.domElement,qb,Lc);mc.y=Math.max(mc.y,Sb.y);mc.x=Math.max(mc.x,Sb.x);return mc}ndc(){const qb=K.h(this.$).ha.Sa.$b;d.ULS.shipAssertTag(537166988,0,!!qb);return ne.a(this.$).PH(qb.floatingObject.id)}sTh(qb){let Sb=new Sys.UI.Point(qb.offsetParent.offsetLeft,qb.offsetParent.offsetTop);var mc=K.h(this.$);if(!mc)return Sb;const Lc=K.h(this.$).rtl;Sb=Jb.HelperMethods.oD(qb,this.$.vr.ownerDocument.body,Lc);mc.XFe(Sb);
Sb.x=Lc?this.$.vr.clientWidth-Sb.x-qb.clientWidth:Sb.x;qb=mc.view.dqb;mc=Lc?-mc.iS.Fca(qb.x):qb.x;Sb.x-=mc;Sb.y-=qb.y;return Sb}}Object(c.a)(Te,"SlicerContextMenu",y.a,[]);class Me{constructor(qb,Sb,mc){this.type=qb;this.u7g=Sb;this.Mr=mc}}Object(c.a)(Me,"TimeSlicerRibbonButtonParameter",null,[]);class Ye extends y.a{constructor(qb,Sb,mc,Lc){super(qb,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Ye.WNj,!0,!1,Ye.SKb,Sb,mc,!1,Lc);this.S1a=0;this.GNe=this.hLa=this.eta=null}get Zw(){return"PopulateTimeSlicerLevelMenu"}get OB(){return t.a.lQf}executeCommand(qb,
Sb,mc){qb=Sb.command;switch(qb){case 2000085697:qb=mc.DOMElement;this.eta=mc.ChangeLevelCallback;this.hLa=mc.GetLevelLabelCallback;this.S1a=mc.CurrentLevel;const Lc=mc.DomEvent;Q.g(Lc);const rd=mc.location;mc=mc.levelLabelText;this.GNe=yb.DOMElementExtensions.Fz(document.activeElement,"iframe")&&mc?mc.parentNode:null;mc=Sys.UI.DomElement.getBounds(mc);mc.x=rd.x;mc.y=rd.y;this.Y0(Lc,qb,mc,Sb,!0);break;case -649826274:this.eta(0);break;case 149600865:this.eta(1);break;case -2012435159:this.eta(2);break;
case -1979934975:this.eta(3);break;case 1634477200:yb.DOMElementExtensions.setFocus(this.GNe);break;default:return sa.a(qb)}return rb.Task.Ta(!0)}wc(qb,Sb,mc){qb=!1;switch(Sb.command){case 2000085697:qb=!!mc;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:qb=!0}return qb}Y0(qb,Sb,mc){qb=Sys.UI.DomElement.getBounds(Sb);mc.x=pa.a(this.$).zi(mc.x);mc.y=pa.a(this.$).zi(mc.y);qb.x=pa.a(this.$).zi(qb.x);qb.y=pa.a(this.$).zi(qb.y);qb=new Sys.UI.Point(qb.x+mc.x,qb.y+
mc.y);this.showContextMenu(new Sys.UI.Bounds(qb.x,qb.y-mc.height,mc.width,mc.height))}hZ(){const qb=this.Va,Sb=qb.aq(this.menuId),mc=qb.Ec();for(let rd=0;3>=rd;rd++){const Z=this.hLa(rd);var Lc=Ye.KNh(rd);Lc=qb.A9g(Lc.u7g,Lc.Mr,this.S1a===rd,Ye.BBe);Lc.label=Z;Lc.mS(Z);this.S1a===rd?Lc.oS("Image16by16",8,Ye.BBe):Lc.K3b();mc.buttons.push(Lc)}Sb.tc.push(mc);return Sb}static KNh(qb){let Sb=null;switch(qb){case 0:Sb=new Me(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:Sb=new Me(88,"ContextMenu.TimeSlicerLevelQuater",
149600865);break;case 2:Sb=new Me(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:Sb=new Me(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return Sb}}Ye.WNj=t.a.y7g;Ye.SKb="TimeSlicerLevelMenuRootName";Ye.BBe=lb.a.Yua;Object(c.a)(Ye,"TimeSlicerLevelMenu",y.a,[]);var pf=a(317),Be=a(3);class Ie extends b.a{constructor(qb){super(qb)}ld(){const qb=this.$,Sb=Ga.a.L1a(ra.b(),this.la,"Task","IRootUser"),mc=e.a(qb);let Lc=null;Lc=(db,Lb)=>{mc.QUf(Lc);Sb.setResult(Lb.b5b)};mc.Yqe(Lc);mc.w4e();
const rd=T.GetServiceTaskFactory.create(qb.da,102,qb.la,this.Ya),Z=T.GetServiceTaskFactory.Oa(qb.da,342,338,this.Ya);C.TaskExtensions.Aa(C.TaskExtensions.Ed([Sb.task,rd,Z],this.la),()=>{const db=rd.result,Lb=Sb.task.result,hc=Z.result;this.Yc([new ic(qb,Lb,db,hc),new za(qb,Lb,db,hc),new Cc(qb,Lb,db,hc),new Rb(qb,Lb,db,hc),new Sc(qb,Lb,db,hc),new va(qb,Lb,db,hc),new Gd.GridContextMenu(qb,Lb,db,hc),new Vd(qb,Lb,db,hc),new he(qb,Lb,db,hc),new Ye(qb,Lb,db,hc),new md(qb,Lb,db,hc),new ua(qb,Lb,db,hc),new ac(qb,
Lb,db,hc),new Te(qb,Lb,db,hc),new ce(qb,Lb,db,hc)])},qb.la,3)}static initData(){const qb=pf.a.W9;qb(2000085697,20479,0,0);qb(-227942804,Be.a.lc|24576,0,0);qb(1634477200,Be.a.lc|131072,0,0);qb(-649826274,4095,0,0);qb(149600865,4095,0,0);qb(-2012435159,4095,0,0);qb(-1979934975,4095,0,0);qb(1247109494,Be.a.lc|24576,0,0);qb(-2064931494,Be.a.lc|131072,0,0);qb(-1396319072,Be.a.Ha,128,0);qb(-425234874,Be.a.Ha,128,0);qb(-1253126584,Be.a.Ha,0,0);qb(274207288,Be.a.lc|24576,0,0);qb(-1497523576,Be.a.lc|131072,
0,0);qb(-498523270,Be.a.lc|24576,64,0);qb(1640762262,Be.a.lc|131072,64,0);qb(-2017893763,Be.a.lc|24576,0,0);qb(1350204367,Be.a.lc|131072,0,0);qb(-889576107,Be.a.qw,128,0);qb(-1170196828,Be.a.qw,128,0);qb(389774337,Be.a.qw,128,0);qb(1529312473,Be.a.qw,128,0);qb(2033235475,Be.a.qw,128,0);qb(-96230454,Be.a.qw,128,0);qb(74086617,Be.a.qw,128,0);qb(563292088,Be.a.qw,128,0);qb(-1092351914,Be.a.qw,128,0);qb(-2141589616,Be.a.qw|16384,128,0);qb(745182485,Be.a.qw,0,0);qb(359279088,Be.a.qw,128,0);qb(-67292059,
Be.a.qw,128,0);qb(926905850,Be.a.qw,128,0);qb(547535945,Be.a.qw,128,0);qb(1374696078,Be.a.lc|24576,0,0);qb(495005930,Be.a.lc|212992,0,0);qb(-1045020714,Be.a.lc|24576,0,0);qb(-170383950,Be.a.lc|212992,0,0);qb(324156914,Be.a.Ha,0,0);qb(-1085236154,Be.a.ov,0,0);qb(-751848458,Be.a.Al|16384,0,0);qb(216058793,Be.a.ov,0,0);qb(474690375,Be.a.Al|16384,0,0);qb(-1920954846,Be.a.lc|24576,0,0);qb(723126814,Be.a.lc|131072,0,0);qb(2108047455,128,128,0);qb(-231711729,128,128,0);qb(-1909381757,128,128,0);qb(-814639094,
128,128,0);qb(1701016594,Be.a.lc|3072,128,0);qb(-1475408662,Be.a.lc|24576,0,0);qb(1114549926,Be.a.lc|131072,32,0)}static ka(qb){b.a.Nd(10,new Ie(qb))}}Object(c.a)(Ie,"ContextMenuCommandHandlerFactory",b.a,[]);var Hf=a(222),Ne=a(1400),Je=a(92),Jf=a(190);class Ue{constructor(qb,Sb){this.bsb=Sb;this.$=qb}dispose(){}maa(){this.bsb.X3()}gD(){this.bsb.gD()}rUd(qb,Sb,mc){Ma.i(this.$,Ma.b);this.bsb.showContextMenu(Object(f.a)(new Ne.a,{x:Sb.x,y:Sb.y}),mc,qb);Je.EventHandlerManager.instance.Ycd()}ozc(qb,Sb,
mc){Ma.i(this.$,Ma.b);this.bsb.showFloatie(Object(f.a)(new Ne.a,{x:Sb.x,y:Sb.y}),qb,mc);Jf.a(()=>{Je.EventHandlerManager.instance.Ycd()},this.$.la)}qUd(qb,Sb,mc,Lc){Ma.i(this.$,Ma.b);this.bsb.qUd(Object(f.a)(new Ne.a,{x:Sb.x,y:Sb.y}),qb,mc,Lc)}}Object(c.a)(Ue,"ReactContextMenuController",null,[457,2]);class ab extends Hf.a{constructor(qb){super();this.qdf=!1;this.bnd=()=>{let Sb;(Sb=this.$.da.za(342))?this.ob(Sb):this.$.ky(mc=>{mc.Ufc().then(Lc=>{(Sb=this.$.da.za(342))?this.ob(Sb):(Sb=new Ue(this.$,
Lc),this.ob(this.$.da.Ga(342,Sb)))})})};this.$=qb;this.Fb()}dispose(){this.qdf&&this.$&&this.$.ea.jo(this.bnd);super.dispose()}create(){this.$.ea.sg?(d.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.sg}`),this.bnd(null,null)):(this.qdf=!0,this.$.ea.Ak(this.bnd))}static ka(qb){qb.da.Ga(338,new ab(qb))}}Object(c.a)(ab,"ContextMenuControllerFactory",Hf.a,[]);var Nb=a(156);class tc{constructor(){this.dictionary=this.Wd=
null}}Object(c.a)(tc,"RibbonCommandParams",null,[]);class Nc{constructor(){this.menuModel=null;this.OIe=0}}Object(c.a)(Nc,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class pd{constructor(){this.Nec={}}WNh(qb){return(qb=this.Nec[qb.toString()])?qb.menuModel:null}mYg(qb,Sb){this.Nec[Sb.toString()]=Object(f.a)(new Nc,{menuModel:qb,OIe:Jb.HelperMethods.Tb()})}D8b(qb){this.Nec[qb.toString()]=null}s2h(qb){return(qb=this.Nec[qb.toString()])?qb.OIe:-1}}Object(c.a)(pd,"FilterMenuCache",null,[]);var zd=
a(14),Sd=a(177),ke=a(224);class ie{constructor(){this.zd=this.nwe=this.cell=null}}Object(c.a)(ie,"AutoFilterEventRegistrationArgs",null,[]);class Fe{constructor(qb){this.D_a=null;this.GTd=!1;this.VCb=0;this.D$c=1;this.YPe=0;this.UFb=Sb=>{this.EOf(Sb.domElement,Sb.hashCode)};this.rSf=Sb=>{let mc=0;for(;window.performance.now()-Sb<this.Erh&&0<this.D_a.length;)this.hpe(this.D_a.shift()),mc++;d.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.D$c}, Events Registered in this frame: ${mc}, Events in queue: ${this.D_a.length}`);
0<this.D_a.length?this.VCb=window.requestAnimationFrame(this.rSf):(Sb=window.performance.now()-this.YPe,d.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.D$c}, Total time in MS: ${Sb}`),this.D$c++,this.VCb=0)};this.onPointerDown=Sb=>{Le.a.slim(Sb.Ca.rawEvent);return!1};this.$=qb;this.gridView=K.h(this.$);this.oci();this.Erh=this.$.va.AutoFilterEventRegistrationTimeLimit}dispose(){window.cancelAnimationFrame(this.VCb);this.gridView&&
this.gridView.puc(this.UFb);this.gridView=null}oci(){if(this.GTd=Jb.HelperMethods.P7a)this.D_a=[];this.CHg();this.gridView.E_b(this.UFb)}CHg(){for(const qb of this.gridView.Mn){const Sb=qb.PCa;for(let mc in Sb){const Lc=Sb[mc];this.EOf(Lc.domElement,Lc.hashCode)}}}EOf(qb,Sb){if(K.h(this.$).Ea.Dm.y2a(Sb))if(qb){qb=qb.querySelectorAll('[id^="'+t.a.Nbd+'"]');for(let rd=0;rd<qb.length;rd++){var mc=qb[rd],Lc=mc.getAttribute(t.a.vEh);const Z=mc.getAttribute(t.a.oEh);d.ULS.shipAssertTag(537167053,0,!!Lc&&
!!Z,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${mc.id}, BlockHash: ${Sb}`);Lc=vc.Range.Qc(parseInt(Lc,10),parseInt(Z,10));mc=Object(f.a)(new ie,{cell:Lc,nwe:mc,zd:Sb});this.GTd?(this.D_a.push(mc),this.VCb||(this.YPe=window.performance.now(),this.VCb=window.requestAnimationFrame(this.rSf))):this.hpe(mc)}}else d.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${Sb}`);
else d.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${Sb}`)}hpe(qb){const Sb=this.gridView.Ea.kLa(qb.cell,qb.zd);Sb?this.BHg(qb.nwe,Sb):d.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${qb.zd}, AutoFilter Cell: ${qb.cell}`)}BHg(qb,Sb){Sb.hasAutoFilter?this.AFg(qb,
Sb.cvb):Sb.V4?this.zHg(qb,Sb.cvb,Sb.trd):d.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");Nb.a.instance.ta(zd.a.Ef,qb,this.onPointerDown);Sd.a.instance.ta(zd.a.Sya,qb,this.onPointerDown)}AFg(qb,Sb){ke.a.instance.ta(zd.a.click,qb,mc=>{Sb&&Le.a.hrc(mc.Ca.rawEvent,966232027,Sb,null);return!0})}zHg(qb,Sb,mc){const Lc=A.a.li(Sb);ke.a.instance.ta(zd.a.click,qb,rd=>{mc?Le.a.spf(document.getElementById(Lc.EwaElementId),
Lc.Cell,Lc.DataSourceIndex,Lc.FieldId,Lc.IsOlap,Lc.RequiresConfirmation,rd.Ca.rawEvent,Lc.OptionalPivotMenuAnchor):Le.a.spfm(rd.Ca.rawEvent,Lc.RequiresConfirmation,Lc.Cell,Lc.DataSourceIndex,Lc.PivotName,Lc.OptionalPivotMenuAnchor);return!1})}}Object(c.a)(Fe,"FilterMenuPointerEventsManager",null,[2]);class qc{constructor(qb){this.wWe=null;this.$=qb;this.O9a=new pd;X.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||
(this.wWe=new Fe(this.$))}dispose(){X.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.wWe.dispose();this.$=null}fUh(qb){const Sb=K.h(this.$).Ea.y$(qb,this.$.activeItemName);return Sb&&Sb.blockPresentInViewportTimeStamp>this.O9a.s2h(qb.left)?Sb.rs(qb).autoFilterMenu:this.O9a.WNh(qb.left)}RQi(qb,Sb,mc){this.O9a&&this.O9a.mYg(qb.menuModel[Sb],mc)}SQi(qb){this.O9a&&this.O9a.D8b(qb)}}Object(c.a)(qc,"FilterMenuManager",
null,[334,2]);var Uc=a(204),ub=a(167);class Xb{constructor(qb,Sb,mc){this.Mzc={};this.Cd=!1;this.$l=(Lc,rd=null)=>{this.showContextMenu(rd)};this.bAf=(Lc,rd)=>{rd.oEi===Xb.i5h&&K.h(this.$).focus()};this.XN=(Lc,rd)=>{Lc=this.$.Ja.Waa(rd.Wd.command);(null===Lc||void 0===Lc?0:Lc.dismissesContextualUI)&&this.X3()};this.yR=()=>{this.$.da.BU(342);C.TaskExtensions.Aa(T.GetServiceTaskFactory.create(this.$.da,338,this.$.la,3),Lc=>{Lc=Lc.result;for(let rd of this.Mzc)rd.$Rf(Lc)},this.$.la)};this.$=qb;this.contextMenuController=
mc;this.p9d=new qc(this.$);qb.da.Ga(8,this);for(mc=0;mc<Sb.length;mc++)this.Mzc[Xb.z7g[mc]]=Sb[mc];this.ha=K.h(qb).ha;this.ha.x_b(this.$l);this.$.Ja.DZa(this.bAf);Nb.a.instance.uxj();X.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ja.osa(this.XN);X.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.DY(this.yR)}get M$b(){return this.p9d}bfd(qb){return U.a.Dc(this.Mzc,qb)}dispose(){this.Cd?
d.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Cd=!0,this.$&&(this.$.Jl(Xb.dd),this.$.da.BU(8),this.ha&&this.ha.huc(this.$l),this.$.Ja.QJb(this.bAf),X.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ja&&this.$.Ja.BAa(this.XN),X.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.w0(this.yR)),this.$=this.ha=null,this.M$b.dispose(),
this.Mzc=this.p9d=null)}showContextMenu(qb,Sb=null,mc=null){this.iCj(qb)&&(Ma.i(this.$,Ma.j),qb=this.N$g(qb,Sb,mc),this.$.Ja.Kb(qb.Wd,qb.dictionary))}X3(){this.contextMenuController?this.contextMenuController.maa():d.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}iCj(qb){return dd.a(this.$).mq()?(d.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
dd.a(this.$).yW(ub.a.grid,Uc.a.showContextMenu),!1):!this.$.Ja.cCh&&(!qb||qb.Gb!==K.h(this.$).domElement&&!Ce.a.equals(qb.Gb.tagName,"INPUT",!0))}N$g(qb,Sb=null,mc=null){mc={["eventArgs"]:qb,["creationParams"]:mc};qb=qb?qb.tb:-1;const Lc=this.ha.Sa.$b;let rd=1441131127;Lc?(Sb=Lc.floatingObject,d.ULS.shipAssertTag(537167059,0,!!Sb,"floatingObj shouldn't be null."),Xb.Dsd(Sb)?rd=1312363469:Xb.isPivotChart(Sb)?(mc[za.m1c]=Sb?Sb.Vc:null,rd=-149612405):rd=-1372040782):Xb.Njf(Sb)?(mc[za.m1c]=Sb,rd=-149612405):
!Ma.h(this.$)&&Ma.f(K.h(this.$))&&(rd=671488277);Sb=new M.a(rd,qb,this.$.Hc,30,null);return Object(f.a)(new tc,{Wd:Sb,dictionary:mc})}static ka(qb){qb.ml(Xb.dd)}static isPivotChart(qb){return!!qb&&0===qb.type&&Xb.Njf(qb.Vc)}static Dsd(qb){return!!qb&&2===qb.type}static Njf(qb){return!!qb&&!!(qb.Attributes&4)}}Xb.z7g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Xb.i5h="GridContextMenu";Xb.dd=qb=>{(qb=Object(Vb.a)(7,qb))&&T.GetServiceTaskFactory.create(qb.da,9,qb.la,0)};Object(c.a)(Xb,"ContextMenuManager",null,[319,2]);class wc extends Hf.a{constructor(qb){super();this.$=qb;this.Fb()}create(){const qb=this.$,Sb=qb.dc;if(Sb.allowSelection||Sb.allowEdits||Sb.allowFiltering||Sb.allowSorting||Sb.allowPivotSpecificOperations){const mc=T.GetServiceTaskFactory.create(qb.da,10,qb.la,this.Ya),Lc=T.GetServiceTaskFactory.Oa(qb.da,342,338,this.Ya);C.TaskExtensions.Aa(C.TaskExtensions.Ed([mc,
Lc],this.la),()=>{this.ob(r.a(qb)||new Xb(qb,mc.result,Lc.result))},this.$.la,3)}else d.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),qb.da.BU(8),this.ob(null)}static ka(qb){qb.da.Ga(9,new wc(qb))}}Object(c.a)(wc,"ContextMenuManagerFactory",Hf.a,[]);var Tc=a(9);a.d(E,"a",function(){return sd});const sd=()=>{Ie.initData();Tc.a.Fa(qb=>{ab.ka(qb);wc.ka(qb);Ie.ka(qb);Xb.ka(qb)})}},1151:function(u,E,a){var c=
a(9);u=a(0);var b=a(692),e=a(15);const f=bb=>{switch(bb){case 0:bb="Between";break;case 1:bb="NotBetween";break;case 2:bb="Equal";break;case 3:bb="NotEqual";break;case 4:bb="GreaterThan";break;case 5:bb="LessThan";break;case 6:bb="GreaterThanOrEqual";break;case 7:bb="LessThanOrEqual";break;default:bb="Unknown"}return bb},d=bb=>{switch(bb){case 0:bb="AnyValue";break;case 1:bb="WholeNumber";break;case 2:bb="Decimal";break;case 3:bb="List";break;case 4:bb="Date";break;case 5:bb="Time";break;case 6:bb=
"TextLength";break;case 7:bb="Custom";break;default:bb="Unknown"}return bb};var h=a(132),m=a(42),l=a(371),w=a(188),n=a(283);class y{constructor(bb=null){this.p5=bb?bb.IsIgnoreBlank:!0;this.q5=bb?bb.IsInCellDropDown:!0;this.jO=bb?bb.LowerBoundary:"";this.kO=bb?bb.UpperBoundary:"";this.QB=bb?bb.ConditionType:0;this.ruleType=bb?bb.RuleType:0;this.k_=bb?bb.IsAlertBlocking:!0;this.QT=bb?bb.AlertTitle:"";this.PT=bb?bb.AlertMessage:"";this.uV=bb?bb.InputMessage:"";this.JF=bb?bb.InputTitle:"";this.O5=bb?
bb.IsShowErrorAlert:!0;this.P5=bb?bb.IsShowInputMessage:!0}isEqual(bb){return bb?this.p5===bb.p5&&this.q5===bb.q5&&this.jO===bb.jO&&this.kO===bb.kO&&this.QB===bb.QB&&this.ruleType===bb.ruleType&&this.k_===bb.k_&&this.QT===bb.QT&&this.PT===bb.PT&&this.uV===bb.uV&&this.JF===bb.JF&&this.O5===bb.O5&&this.P5===bb.P5:(e.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(u.a)(y,"DataValidationEditDialogState",null,[]);var t=a(282),r=a(183),v=a(281),
B=a(21),A=a(133),z=a(51),x=a(55);class D{constructor(bb,wa){this.bC=this.b2a=this.selectedRanges=null;this.nNe=!1;this.di=null;this.bPi=ka=>{e.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!ka||t.a(ka)?e.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(this.b2a=ka.Result,this.k4i())};this.kCh=ka=>{this.LW("DataValidationEdit.ExpandExisitngDialog",
ka);this.bC.c=D.Eia(ka);1===ka?this.BIa(new y(this.b2a)):2===ka?this.BIa(new y):this.irf()};this.a_i=ka=>{this.LW("DataValidationEdit.OverrideExisitngDialog",ka);this.bC.c=D.Eia(ka);1===ka?this.BIa(new y):this.irf()};this.$=bb;this.S6c=wa}nc(){return!1}executeCommand(bb,wa){-1728432249!==wa.command&&r.a(wa.command);this.selectedRanges=m.r(B.h(this.$).ha.ra.selectedRanges,this.$);B.h(this.$).oTa(!0);this.getDataValidationInitialState();this.di=this.$.Jb.Ac("UserAction","DataValidationEditTimeToDialogOpen");
this.nNe?e.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(e.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.nNe=!0);return x.Task.Ta(!0)}wc(bb,wa){return-1728432249===wa.command}Kc(){return!1}getDataValidationInitialState(){const bb=this.$.pa.ya.Wb();l.a(this.$.userOperationManager,(wa,ka,ta)=>n.g(this.$.pa.ya,this.selectedRanges,v.b(wa,this.bPi),v.a(ka),ta,bb),wa=>new w.a(120,0,wa,16),null)}k4i(){var bb=
this.bC={};let wa;switch(this.b2a.Command){case 0:wa="CreateNew";break;case 1:wa="CreateNewFromRule";break;case 2:wa="ExpandExisitng";break;case 3:wa="OverrideExisitng";break;default:wa="Unknown"}bb.a=wa;this.di&&(this.di.stop(),this.bC.r=this.di.id);switch(this.b2a.Command){case 0:this.bC.b=!1;this.bC.c="None";this.BIa(new y);break;case 1:this.bC.b=!1;this.bC.c="None";this.BIa(new y(this.b2a));break;case 2:this.bC.b=!0;this.S6c.J9g(this.$,this.kCh);break;case 3:this.bC.b=!0;this.S6c.L9g(this.$,this.a_i);
break;default:e.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}BIa(bb){this.S6c.BIa(this.$,this.selectedRanges,bb,this.b2a.Command);this.WAi(bb)}WAi(bb){D.ytb(bb,this.bC);this.bC.d=!0;z.b().Qe(48,this.bC,!0)}irf(){this.bC.d=!1;z.b().Qe(48,this.bC,!0)}LW(bb,wa){bb={["ButtonType"]:D.Eia(wa),["DialogName"]:bb,["Location"]:"dialog",["NumberOfSelectedRanges"]:B.h(this.$).ha.ra.YF};A.b(this.$).ud(h.a.x7b,bb)}static ytb(bb,wa){wa.e=d(bb.ruleType);
wa.f=f(bb.QB);wa.g=!!bb.jO;wa.h=!!bb.kO;wa.i=bb.p5;wa.j=bb.q5;wa.k=bb.P5;wa.l=!!bb.JF;wa.m=!!bb.uV;wa.n=bb.O5;wa.o=bb.k_;wa.p=!!bb.QT;wa.q=!!bb.PT}static Eia(bb){switch(bb){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return e.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(u.a)(D,"DataValidationEditCommandHandler",null,[223]);var J=a(134),L=a(800),T;(function(bb){bb[bb.between=0]="between";bb[bb.notBetween=
1]="notBetween";bb[bb.equal=2]="equal";bb[bb.notEqual=3]="notEqual";bb[bb.greaterThan=4]="greaterThan";bb[bb.lessThan=5]="lessThan";bb[bb.greaterThanOrEqual=6]="greaterThanOrEqual";bb[bb.lessThanOrEqual=7]="lessThanOrEqual"})(T||(T={}));Object(u.b)("DataValidationRuleConditionType",T);var O=a(1084),G=a(146),C=a(185);class H{static get qg(){return G.a.gq(H.ol,"")}static get bkh(){return G.a.gq(H.fkh,C.a.ga(1665),C.a.ga(1680),C.a.ga(1681),C.a.ga(1682),C.a.ga(1683),C.a.ga(1684),C.a.ga(1685),C.a.ga(1686),
C.a.ga(1687),C.a.ga(1666),C.a.ga(1690),C.a.ga(1691),C.a.ga(1692),C.a.ga(1693),C.a.ga(1694),C.a.ga(1695),C.a.ga(1696),C.a.ga(1697),C.a.ga(1667),C.a.ga(1668),C.a.ga(1688),C.a.ga(1689),C.a.ga(1679),"255")}static get ikh(){return G.a.gq(H.gkh,C.a.ga(1702),C.a.ga(1706),C.a.ga(1707),"255","32")}static get mkh(){return G.a.gq(H.hkh,C.a.ga(1701),C.a.ga(1704),C.a.ga(1703),C.a.ga(1705),C.a.ga(1706),C.a.ga(1707),"255","32")}}H.fcg=255;H.ol="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";
H.fkh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
H.gkh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
H.hkh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(u.a)(H,"DataValidationEditDialogHtml",null,[]);var I=a(85),M=a(554),Q=a(14),U=a(187),N=a(238),W=a(12),X=a(13);class sa extends N.a{constructor(bb,wa,ka){super(wa);this.FEd=this.xqc=this.ZPa=this.xab=this.rOa=this.s6a=this.Gza=this.Fza=this.eL=this.RT=this.Mfc=this.Vwa=null;this.VFh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.Mpj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,
1],[12,12]];this.Xoc=ta=>{let qa=!1;(null===ta||void 0===ta?0:ta.Ca)&&(ta.Ca.keyCode===I.a.$ea||ta.Ca.keyCode===I.a.Lh)&&(qa=this.Tca(ta),this.RT.blur(),this.eL.blur());return qa};this.Tca=()=>{const ta=this.RT.selectedIndex,qa=this.eL.selectedIndex;this.xqc.innerText=this.Kwb(ta,qa);this.FEd.innerText=this.Zhd(ta,qa);switch(ta){case 0:return this.eL.disabled=!0,W.DOMElementExtensions.setVisible(this.xab,!1),W.DOMElementExtensions.setVisible(this.ZPa,!1),W.DOMElementExtensions.setVisible(this.s6a,
!1),W.DOMElementExtensions.setVisible(this.rOa,!1),this.Vwa.disabled=!0,!1;case 3:return this.eL.disabled=!0,W.DOMElementExtensions.setVisible(this.xab,!0),W.DOMElementExtensions.setVisible(this.ZPa,!1),W.DOMElementExtensions.setVisible(this.s6a,!0),W.DOMElementExtensions.setVisible(this.rOa,!0),this.Vwa.disabled=!1;case 7:return this.eL.disabled=!0,W.DOMElementExtensions.setVisible(this.xab,!0),W.DOMElementExtensions.setVisible(this.ZPa,!1),W.DOMElementExtensions.setVisible(this.s6a,!1),W.DOMElementExtensions.setVisible(this.rOa,
!1),this.Vwa.disabled=!1;default:this.Vwa.disabled=!1,W.DOMElementExtensions.setVisible(this.xab,!0),W.DOMElementExtensions.setVisible(this.rOa,!1)}switch(qa){case 0:case 1:W.DOMElementExtensions.setVisible(this.ZPa,!0);break;default:W.DOMElementExtensions.setVisible(this.ZPa,!1)}this.eL.disabled=!1;this.xqc.disabled=!1;W.DOMElementExtensions.setVisible(this.s6a,!1);W.DOMElementExtensions.setVisible(this.rOa,!1);return!1};this.get_visible=this.lka;this.set_visible=this.aoa;this.lR=new U.a;this.lR.add(X.a.instance.ga(1667));
this.lR.add(X.a.instance.ga(1668));this.lR.add(X.a.instance.ga(1671));this.lR.add(X.a.instance.ga(1669));this.lR.add(X.a.instance.ga(1670));this.lR.add(X.a.instance.ga(1672));this.lR.add(X.a.instance.ga(1673));this.lR.add(X.a.instance.ga(1674));this.lR.add(X.a.instance.ga(1675));this.lR.add(X.a.instance.ga(1676));this.lR.add(X.a.instance.ga(1677));this.lR.add(X.a.instance.ga(1678));this.lR.add("");this.$=bb;this.Tk=ka;this.Hka()}get title(){return X.a.instance.ga(1698)}get V5g(){return this.RT.selectedIndex}hBa(bb){this.RT.selectedIndex=
bb.ruleType;this.eL.selectedIndex=bb.QB;this.Mfc.checked=bb.q5;this.Vwa.checked=bb.p5;this.Fza.value=bb.jO;this.Gza.value=bb.kO;this.Tca(null)}vqb(bb){bb.p5=this.Vwa.checked;bb.q5=this.Mfc.checked;bb.QB=this.eL.selectedIndex;bb.ruleType=this.RT.selectedIndex;bb.jO=this.Fza.value;bb.kO=this.Gza.value}dispose(){this.gk();this.Tk=this.FEd=this.xqc=this.ZPa=this.xab=this.rOa=this.s6a=this.Mfc=this.Gza=this.Fza=this.eL=this.RT=this.Vwa=null;super.dispose()}render(bb){bb.appendChild(this.domElement)}lka(){return this.isVisible}aoa(bb){return this.isVisible=
bb}setFocus(){}Kwb(bb,wa){return this.r4e(bb,wa,this.VFh)}Zhd(bb,wa){return 0!==wa&&1!==wa?"":this.r4e(bb,wa,this.Mpj)}Hka(){this.domElement.innerHTML=H.bkh;this.Vwa=W.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.RT=W.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.eL=W.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Fza=W.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");
this.Gza=W.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.xqc=W.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.FEd=W.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.s6a=W.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.rOa=W.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.xab=W.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");
this.ZPa=W.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Mfc=W.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Lj()}r4e(bb,wa,ka){return ka.length<bb||ka[bb].length<wa?(e.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${bb} operatorOption=${wa}, cannot get label.`),""):this.lR.na(ka[bb][wa])}Lj(){M.a.instance.ta(Q.a.Pb,this.RT,this.Xoc);M.a.instance.ta(Q.a.Pb,this.eL,
this.Xoc);M.a.instance.ta(Q.a.change,this.RT,this.Tca);M.a.instance.ta(Q.a.change,this.eL,this.Tca);M.a.instance.ta(Q.a.change,this.eL,this.Tk);M.a.instance.ta(Q.a.change,this.RT,this.Tk);M.a.instance.ta(Q.a.change,this.Fza,this.Tk);M.a.instance.ta(Q.a.Pb,this.Fza,this.Tk);M.a.instance.ta(Q.a.change,this.Gza,this.Tk);M.a.instance.ta(Q.a.Pb,this.Gza,this.Tk)}gk(){M.a.instance.Ba(Q.a.Pb,this.RT,this.Xoc);M.a.instance.Ba(Q.a.Pb,this.eL,this.Xoc);M.a.instance.Ba(Q.a.change,this.RT,this.Tca);M.a.instance.Ba(Q.a.change,
this.eL,this.Tca);M.a.instance.Ba(Q.a.change,this.eL,this.Tk);M.a.instance.Ba(Q.a.change,this.RT,this.Tk);M.a.instance.Ba(Q.a.change,this.Fza,this.Tk);M.a.instance.Ba(Q.a.Pb,this.Fza,this.Tk);M.a.instance.Ba(Q.a.change,this.Gza,this.Tk);M.a.instance.Ba(Q.a.Pb,this.Gza,this.Tk)}static Ija(){let bb;return bb=new U.a,bb.add("operatorInputId1"),bb.add("operatorInputId2"),bb}}Object(u.a)(sa,"DataValidationEditConditionsControl",N.a,[405,2,411]);var da=a(60);const S=(bb,wa,ka,ta,qa,rb,Za,gb=null)=>{gb=
bb.Na(9,gb);gb.selectedRanges=wa;gb.ruleOptions=ka;return da.g(bb,"CreateOrEditDataValidation",gb,ta,qa,rb,Za,0)};var oa=a(29),K=a(22),ea=a(173);class ya extends L.a{constructor(bb,wa,ka,ta){super(bb);this.tPd=this.lvb=null;this.VNa=this.disposed=this.Xka=!1;this.di=null;this.N_j=(qa,rb)=>{let Za;this.Ubc(qa);if(({errorString:qa,Pq:Za}=this.z1d()).returnValue)return this.FMa(121,this.zQh(this.$,rb),0,this.Tba,!1),"";this.Kla("OkInvalidByClient",Za);return qa};this.R6c=qa=>{this.LW(qa);this.di=this.$.Jb.Ac("UserAction",
"DataValidationEditTimeToDialogTryClose");0===qa&&this.qma()};this.selectedRanges=wa;this.mTb=ka;this.command=ta;3===ta&&(this.Xka=!0);this.Rb=2;this.$v=!1}get yd(){return this.mTb}get pc(){return"DataValidationEditDialog"}cVd(){var bb={["RuleType"]:this.yd.ruleType,["RuleOperatorType"]:this.yd.QB,["OperatorInput1"]:this.yd.jO,["OperatorInput2"]:this.yd.kO,["IsIgnoreBlank"]:this.yd.p5,["IsInCellDropDown"]:this.yd.q5,["IsAlertBlocking"]:this.yd.k_,["AlertTitle"]:this.yd.QT,["AlertMessage"]:this.yd.PT,
["InputTitle"]:this.yd.JF,["InputMessage"]:this.yd.uV,["IsShowErrorAlert"]:this.yd.O5,["IsShowInputMessage"]:this.yd.P5};this.oc(2,X.a.instance.ga(1664));bb={[ya.uu]:this.pc,["validateDialogValues"]:this.N_j,["RangePickerController"]:B.h(this.$).Hf.$cc(),["isModal"]:!1,["bodyProps"]:bb};this.initializeAndShow(X.a.instance.ga(1663),this.R6c,bb);e.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||(super.dispose(),this.disposed=!0)}get e3b(){return 3===
this.yd.ruleType}Ija(){return sa.Ija()}zQh(bb,wa){return(ka,ta,qa)=>{const rb=bb.pa.ya.Wb();return S(this.$.pa.ya,this.selectedRanges,this.sWg(),this.E0a(ka,this.dCd(wa)),v.a(ta),qa,rb)}}dCd(bb){return wa=>{e.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let ka;t.a(wa)?(e.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${wa?oa.a.sc(wa.Errors):null}.`),wa.Errors&&1===wa.Errors.length&&
((ka=this.nfd(wa.Errors[0].MessageId))?this.Kla("OkInvalidByServer",wa.Errors[0].MessageIdName):(this.Kla("OkValid","None"),this.hide()),bb(ka)),e.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${oa.a.sc(wa.Errors)}`)):this.hide()}}sWg(){const bb={};bb.Command=this.command;bb.RuleType=this.yd.ruleType;bb.ConditionType=this.yd.QB;bb.IsIgnoreBlank=this.yd.p5;bb.IsInCellDropDown=this.yd.q5;bb.LowerBoundary=this.yd.jO;bb.UpperBoundary=
this.yd.kO;bb.IsAlertBlocking=this.yd.k_;bb.IsShowErrorAlert=this.yd.O5;bb.IsShowInputMessage=this.yd.P5;bb.AlertTitle=this.yd.QT;bb.AlertMessage=this.yd.PT;bb.InputTitle=this.yd.JF;bb.InputMessage=this.yd.uV;bb.ShouldIgnoreFormulaError=this.VNa;return bb}nfd(bb){switch(bb){case 1173235830:return X.a.instance.ga(1713);case 43935303:return X.a.instance.ga(1714);case -1323438439:return X.a.instance.ga(1716);case 2112020473:return X.a.instance.ga(1710);case -219503282:return X.a.instance.ga(1711);case 1689335445:return X.a.instance.ga(1712);
case 2146493810:return X.a.instance.ga(1715);case -2104909922:return String.format(X.a.instance.nb(105),this.lvb,this.tPd);case -869372599:return String.format(X.a.instance.nb(104),this.lvb);case -1181828368:return X.a.instance.ga(1718);case -758480861:return X.a.instance.ga(1719);case -13729088:return X.a.instance.ga(1720);case -846654055:return X.a.instance.ga(1721);case 751854001:return X.a.instance.ga(1722);case -453846397:return X.a.instance.ga(1723);case 1102013489:return X.a.instance.ga(1724);
case 835813260:return X.a.instance.ga(1725);case 1577787509:return X.a.instance.ga(1726);case 2083564019:return X.a.instance.ga(1717);default:e.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${bb.toString()}.`)}return null}qma(){this.Kla("Cancel","None")}LW(bb){e.ULS.sendTraceTag(537163273,0,50,`DataValidationEditDialog ${1===bb?"Ok":"Cancel"} was clicked.`);bb={["ButtonType"]:ya.Eia(bb),["DialogName"]:this.pc,["Location"]:"dialog",
["NumberOfSelectedRanges"]:B.h(this.$).ha.ra.YF};A.b(this.$).ud(h.a.x7b,bb)}Kla(bb,wa){const ka={};ya.ytb(this.yd,ka);ka.o=bb;ka.p=wa;ka.n=this.Xka;this.di&&(this.di.stop(),ka.q=this.di.id);z.b().Qe(49,ka,!0)}Ubc(bb){this.yd.ruleType=bb.RuleType;this.yd.QB=bb.RuleOperatorType;this.yd.jO=bb.OperatorInput1;this.yd.kO=bb.OperatorInput2;this.yd.k_=bb.IsAlertBlocking;this.yd.O5=bb.IsShowErrorAlert;this.yd.QT=bb.AlertTitle;this.yd.PT=bb.AlertMessage;this.yd.P5=bb.IsShowInputMessage;this.yd.JF=bb.InputTitle;
this.yd.uV=bb.InputMessage;this.yd.p5=bb.IsIgnoreBlank;this.yd.q5=bb.IsInCellDropDown;this.lvb=bb.firstOperatorLabel;this.tPd=bb.secondOperatorLabel}HQb(bb,wa,ka){let ta,qa;qa=ta=null;if(!bb)return ka?(ta=String.format(X.a.instance.nb(105),this.lvb,this.tPd),qa="DataValidationEditNoMinMaxError"):(ta=String.format(X.a.instance.nb(104),this.lvb),qa="DataValidationEditNoValueError"),{returnValue:!1,errorString:ta,Pq:qa};if(bb.length>H.fcg)return ta=X.a.instance.ga(1717),{returnValue:!1,errorString:ta,
Pq:qa};if(ea.d(bb))return{returnValue:!0,errorString:ta,Pq:qa};if(1===wa||2===wa||6===wa){if(!K.a.y5(bb))return ta=X.a.instance.ga(1710),{returnValue:!1,errorString:ta,Pq:qa};if(1===wa&&!K.a.isInteger(bb))return ta=X.a.instance.ga(1711),{returnValue:!1,errorString:ta,Pq:qa};if(6===wa){if(!K.a.isInteger(bb))return ta=X.a.instance.ga(1711),{returnValue:!1,errorString:ta,Pq:qa};if(0>parseInt(bb,10))return ta=X.a.instance.ga(1712),{returnValue:!1,errorString:ta,Pq:qa}}}return{returnValue:!0,errorString:ta,
Pq:qa}}z1d(){let bb,wa;wa=bb=null;const ka=this.yd.jO,ta=this.yd.kO,qa=O.a[this.yd.ruleType];var rb=T[this.yd.QB];if(0===qa)return{returnValue:!0,errorString:bb,Pq:wa};rb=(0===rb||1===rb)&&3!==qa&&7!==qa;return!({errorString:bb,Pq:wa}=this.HQb(ka,qa,rb)).returnValue||rb&&!({errorString:bb,Pq:wa}=this.HQb(ta,qa,rb)).returnValue?{returnValue:!1,errorString:bb,Pq:wa}:rb&&(1===qa||2===qa||6===qa)&&!ea.d(ka)&&!ea.d(ta)&&parseFloat(ka)>parseFloat(ta)?(bb=X.a.instance.ga(1715),{returnValue:!1,errorString:bb,
Pq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:bb,Pq:wa}}static Eia(bb){switch(bb){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static ytb(bb,wa){wa.a=d(bb.ruleType);wa.b=f(bb.QB);wa.c=!!bb.jO;wa.d=!!bb.kO;wa.e=bb.p5;wa.f=bb.q5;wa.g=bb.P5;wa.h=!!bb.JF;wa.i=!!bb.uV;wa.j=bb.O5;wa.k=bb.k_;wa.l=!!bb.QT;wa.m=!!bb.PT}}Object(u.a)(ya,
"DataValidationEditDialog",L.a,[]);var ha=a(87);L=a(261);class La{}La.Mgh="DataValidationDialogPanel";La.Lgh="DataValidationButtonPanel";La.Kgh="DataValidationButtonClearAll";Object(u.a)(La,"CssClassNames",null,[]);class Ia extends N.a{constructor(bb,wa){super(bb);this.yba=this.zba=this.xba=null;this.Zoc=()=>{this.xba.checked?(this.zba.disabled=!1,this.yba.disabled=!1):(this.zba.disabled=!0,this.yba.disabled=!0);return!1};this.get_visible=this.lka;this.set_visible=this.aoa;this.Tk=wa;this.Hka()}get title(){return X.a.instance.ga(1700)}render(bb){bb.appendChild(this.domElement)}lka(){return this.isVisible}aoa(bb){return this.isVisible=
bb}setFocus(){}dispose(){this.gk();this.Tk=this.zba=this.yba=this.xba=null;super.dispose()}Hka(){this.domElement.innerHTML=H.ikh;this.xba=W.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");W.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.zba=W.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.yba=W.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.xba.checked=!0;this.Lj();this.Zoc(null)}hBa(bb){this.zba.value=
void 0===bb.JF||null===bb.JF?"":bb.JF;this.yba.value=void 0===bb.uV||null===bb.uV?"":bb.uV;this.xba.checked=bb.P5;this.Zoc(null)}vqb(bb){bb.JF=this.zba.value;bb.uV=this.yba.value;bb.P5=this.xba.checked}Lj(){M.a.instance.ta(Q.a.change,this.xba,this.Zoc);M.a.instance.ta(Q.a.change,this.xba,this.Tk);M.a.instance.ta(Q.a.change,this.zba,this.Tk);M.a.instance.ta(Q.a.Pb,this.zba,this.Tk);M.a.instance.ta(Q.a.change,this.yba,this.Tk);M.a.instance.ta(Q.a.Pb,this.yba,this.Tk)}gk(){M.a.instance.Ba(Q.a.change,
this.xba,this.Zoc);M.a.instance.Ba(Q.a.change,this.xba,this.Tk);M.a.instance.Ba(Q.a.change,this.zba,this.Tk);M.a.instance.Ba(Q.a.Pb,this.zba,this.Tk);M.a.instance.Ba(Q.a.change,this.yba,this.Tk);M.a.instance.Ba(Q.a.Pb,this.yba,this.Tk)}}Object(u.a)(Ia,"DataValidationEditInputControl",N.a,[405,2,407]);class ra extends N.a{constructor(bb,wa){super(bb);this.h$=this.i$=this.iVa=this.zha=this.g$=null;this.Yoc=()=>{this.g$.checked?(this.zha.disabled=!1,this.iVa.disabled=!1,this.i$.disabled=!1,this.h$.disabled=
!1):(this.zha.disabled=!0,this.iVa.disabled=!0,this.i$.disabled=!0,this.h$.disabled=!0);return!1};this.get_visible=this.lka;this.set_visible=this.aoa;this.Tk=wa;this.Hka()}get title(){return X.a.instance.ga(1699)}render(bb){bb.appendChild(this.domElement)}lka(){return this.isVisible}aoa(bb){return this.isVisible=bb}setFocus(){}dispose(){this.gk();this.Tk=this.i$=this.h$=this.iVa=this.zha=this.g$=null;super.dispose()}Hka(){this.domElement.innerHTML=H.mkh;this.g$=W.DOMElementExtensions.getElementById(this.domElement,
"showAlertCheckBoxId");this.zha=W.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.iVa=W.DOMElementExtensions.getElementById(this.domElement,"warningId");this.i$=W.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.h$=W.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.g$.checked=!0;this.zha.checked=!0;this.Lj();this.Yoc(null)}hBa(bb){this.zha.checked=bb.k_;this.iVa.checked=!bb.k_;this.i$.value=void 0===bb.QT||null===
bb.QT?"":bb.QT;this.h$.value=void 0===bb.PT||null===bb.PT?"":bb.PT;this.g$.checked=bb.O5;this.Yoc(null)}vqb(bb){bb.QT=this.i$.value;bb.PT=this.h$.value;bb.k_=this.zha.checked;bb.O5=this.g$.checked}Lj(){M.a.instance.ta(Q.a.change,this.g$,this.Yoc);M.a.instance.ta(Q.a.change,this.g$,this.Tk);M.a.instance.ta(Q.a.change,this.zha,this.Tk);M.a.instance.ta(Q.a.change,this.iVa,this.Tk);M.a.instance.ta(Q.a.change,this.i$,this.Tk);M.a.instance.ta(Q.a.Pb,this.i$,this.Tk);M.a.instance.ta(Q.a.change,this.h$,this.Tk);
M.a.instance.ta(Q.a.Pb,this.h$,this.Tk)}gk(){M.a.instance.Ba(Q.a.change,this.g$,this.Yoc);M.a.instance.Ba(Q.a.change,this.g$,this.Tk);M.a.instance.ta(Q.a.change,this.zha,this.Tk);M.a.instance.ta(Q.a.change,this.iVa,this.Tk);M.a.instance.Ba(Q.a.change,this.i$,this.Tk);M.a.instance.Ba(Q.a.Pb,this.i$,this.Tk);M.a.instance.Ba(Q.a.change,this.h$,this.Tk);M.a.instance.Ba(Q.a.Pb,this.h$,this.Tk)}}Object(u.a)(ra,"DataValidationEditMessagesControl",N.a,[405,2,406]);class pa{constructor(bb,wa){this.options=
this.cellRange=null;this.cellRange=bb;this.options=wa}}Object(u.a)(pa,"MacroRecorderRangeDataValidationChangedPayload",null,[137]);var ba=a(1238);class fa extends L.a{constructor(bb,wa,ka,ta){super(bb);this.D3=this.kgc=this.Gmc=this.EEb=null;this.VNa=this.disposed=this.Xka=!1;this.di=null;this.dCd=qa=>{e.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(this.disposed)e.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");
else{if(t.a(qa)){e.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${qa?oa.a.sc(qa.Errors):null}.`);if(qa.Errors&&1===qa.Errors.length){const rb=qa.Errors[0].MessageId,Za=this.nfd(rb);if(Za){this.UCj(rb)?this.dyj(Za):this.Pr(Za);this.Kla("OkInvalidByServer",qa.Errors[0].MessageIdName);return}}e.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${oa.a.sc(qa.Errors)}`)}this.Kla("OkValid",
"None");this.hide()}};this.R6c=qa=>{this.LW(qa);2!==qa&&(this.di=this.$.Jb.Ac("UserAction","DataValidationEditTimeToDialogTryClose"));1===qa?this.dab():2===qa?this.jza():this.qma()};this.Tca=()=>{this.oVj();this.VNa?this.tCe():this.cCe();return this.Xka=!1};this.selectedRanges=wa;this.mTb=ka;this.command=ta;3===ta&&(this.Xka=!0);this.Rb=2;this.$v=!1;this.qg=H.qg}get yd(){return this.mTb}get pc(){return"DataValidationEditDialog"}cVd(){const bb={["key"]:this.yd};this.initializeAndShow(X.a.instance.ga(1663),
this.R6c,bb);e.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.kgc=this.Gmc=this.D3=null,ha.a.Ia(this.EEb),this.EEb=null,A.b(this.$)&&A.b(this.$).CWd("DataValidationDialogCorellation"),super.dispose(),this.disposed=!0)}get xy(){return()=>{this.LW(1);this.dab()}}Ov(bb){super.Ov(bb);this.oc(2,X.a.instance.ga(1664));bb=this.nK(2);var wa=this.nK(1),ka=this.nK(0),ta=wa.parentNode;ta.appendChild(bb);ta.appendChild(wa);ta.appendChild(ka);
bb.parentNode.classList.add(La.Lgh);bb.classList.add(La.Kgh);bb=document.getElementById("dataValidationTabsId");wa=new sa(this.$,document.createElement("div"),this.Tca);ka=new Ia(document.createElement("div"),this.Tca);ta=new ra(document.createElement("div"),this.Tca);this.lfi(wa,ka,ta);let qa;this.EEb=new ba.a(bb,(qa=new U.a,qa.add(wa),qa.add(ka),qa.add(ta),qa));this.EEb.pVf();this.xQ=document.getElementById("validationErrorMessageId");this.hBa();A.b(this.$)&&A.b(this.$).kWd("DataValidationDialogCorellation")}VI(){super.VI();
document.getElementById(this.mi("WACDialogPanel")).classList.add(La.Mgh)}get RY(){return!1}get e3b(){return 3===this.D3.V5g}Ija(){return sa.Ija()}Efd(){return"validationErrorMessageId"}lfi(bb,wa,ka){this.D3=bb;this.kgc=wa;this.Gmc=ka}Mqj(){const bb={};bb.IsClearAll=this.Xka;bb.Command=this.command;bb.RuleType=this.yd.ruleType;bb.ConditionType=this.yd.QB;bb.IsIgnoreBlank=this.yd.p5;bb.IsInCellDropDown=this.yd.q5;bb.LowerBoundary=this.yd.jO;bb.UpperBoundary=this.yd.kO;bb.IsAlertBlocking=this.yd.k_;
bb.IsShowErrorAlert=this.yd.O5;bb.IsShowInputMessage=this.yd.P5;bb.AlertTitle=this.yd.QT;bb.AlertMessage=this.yd.PT;bb.InputTitle=this.yd.JF;bb.InputMessage=this.yd.uV;bb.ShouldIgnoreFormulaError=this.VNa;const wa=this.$.pa.ya.Wb(),ka=()=>new pa(this.selectedRanges,bb);l.a(this.$.userOperationManager,(ta,qa,rb)=>S(this.$.pa.ya,this.selectedRanges,bb,v.b(ta,this.dCd),v.a(qa),rb,wa),ta=>new w.a(121,0,ta,void 0,ka),null)}UCj(bb){return 1577787509===bb}dyj(bb){this.xQ.innerText=bb;this.RI(this.nK(0));
this.VNa=!0}tCe(){this.VNa=!1;this.xQ.innerText=""}nfd(bb){switch(bb){case 1173235830:return X.a.instance.ga(1713);case 43935303:return X.a.instance.ga(1714);case -1323438439:return X.a.instance.ga(1716);case 2112020473:return X.a.instance.ga(1710);case -219503282:return X.a.instance.ga(1711);case 1689335445:return X.a.instance.ga(1712);case 2146493810:return X.a.instance.ga(1715);case -2104909922:return String.format(X.a.instance.nb(105),this.D3.Kwb(this.yd.ruleType,this.yd.QB),this.D3.Zhd(this.yd.ruleType,
this.yd.QB));case -869372599:return String.format(X.a.instance.nb(104),this.D3.Kwb(this.yd.ruleType,this.yd.QB));case -1181828368:return X.a.instance.ga(1718);case -758480861:return X.a.instance.ga(1719);case -13729088:return X.a.instance.ga(1720);case -846654055:return X.a.instance.ga(1721);case 751854001:return X.a.instance.ga(1722);case -453846397:return X.a.instance.ga(1723);case 1102013489:return X.a.instance.ga(1724);case 835813260:return X.a.instance.ga(1725);case 1577787509:return X.a.instance.ga(1726);
case 2083564019:return X.a.instance.ga(1717);default:e.ULS.sendTraceTag(537163265,0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${bb.toString()}.`)}return null}dab(){e.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.Ubc();let bb,wa;if(!({errorString:bb,Pq:wa}=this.z1d()).returnValue)return this.Pr(bb),this.Kla("OkInvalidByClient",wa),!1;this.Mqj();return!0}qma(){this.Ubc();this.Kla("Cancel","None");this.hide()}jza(){e.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.VNa?this.tCe():this.cCe();this.jkj();this.Xka=!0}LW(bb){bb={["ButtonType"]:fa.Eia(bb),["DialogName"]:this.pc,["Location"]:"dialog",["NumberOfSelectedRanges"]:B.h(this.$).ha.ra.YF};A.b(this.$).ud(h.a.x7b,bb)}jkj(){this.mTb=new y;this.hBa()}hBa(){this.Gmc.hBa(this.yd);this.kgc.hBa(this.yd);this.D3.hBa(this.yd)}Ubc(){this.D3.vqb(this.yd);this.Gmc.vqb(this.yd);this.kgc.vqb(this.yd)}Kla(bb,wa){const ka={};fa.ytb(this.yd,ka);ka.o=bb;
ka.p=wa;ka.n=this.Xka;this.di&&(this.di.stop(),ka.q=this.di.id);z.b().Qe(49,ka,!0)}HQb(bb,wa){let ka,ta;ta=ka=null;if(!bb)return wa?(ka=String.format(X.a.instance.nb(105),this.D3.Kwb(this.yd.ruleType,this.yd.QB),this.D3.Zhd(this.yd.ruleType,this.yd.QB)),ta="DataValidationEditNoMinMaxError"):(ka=String.format(X.a.instance.nb(104),this.D3.Kwb(this.yd.ruleType,this.yd.QB)),ta="DataValidationEditNoValueError"),{returnValue:!1,errorString:ka,Pq:ta};if(bb.length>H.fcg)return ka=X.a.instance.ga(1717),{returnValue:!1,
errorString:ka,Pq:ta};if(ea.d(bb))return{returnValue:!0,errorString:ka,Pq:ta};if(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType){if(!K.a.y5(bb))return ka=X.a.instance.ga(1710),{returnValue:!1,errorString:ka,Pq:ta};if(1===this.yd.ruleType&&!K.a.isInteger(bb))return ka=X.a.instance.ga(1711),{returnValue:!1,errorString:ka,Pq:ta};if(6===this.yd.ruleType){if(!K.a.isInteger(bb))return ka=X.a.instance.ga(1711),{returnValue:!1,errorString:ka,Pq:ta};if(0>parseInt(bb,10))return ka=X.a.instance.ga(1712),
{returnValue:!1,errorString:ka,Pq:ta}}}return{returnValue:!0,errorString:ka,Pq:ta}}z1d(){let bb,wa;wa=bb=null;if(this.Xka||0===this.yd.ruleType)return{returnValue:!0,errorString:bb,Pq:wa};const ka=(0===this.yd.QB||1===this.yd.QB)&&3!==this.yd.ruleType&&7!==this.yd.ruleType;return!({errorString:bb,Pq:wa}=this.HQb(this.yd.jO,ka)).returnValue||ka&&!({errorString:bb,Pq:wa}=this.HQb(this.yd.kO,ka)).returnValue?{returnValue:!1,errorString:bb,Pq:wa}:ka&&(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType)&&
!ea.d(this.yd.jO)&&!ea.d(this.yd.kO)&&parseFloat(this.yd.jO)>parseFloat(this.yd.kO)?(bb=X.a.instance.ga(1715),{returnValue:!1,errorString:bb,Pq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:bb,Pq:wa}}set xy(bb){super.xy=bb}static Eia(bb){switch(bb){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static ytb(bb,wa){wa.a=
d(bb.ruleType);wa.b=f(bb.QB);wa.c=!!bb.jO;wa.d=!!bb.kO;wa.e=bb.p5;wa.f=bb.q5;wa.g=bb.P5;wa.h=!!bb.JF;wa.i=!!bb.uV;wa.j=bb.O5;wa.k=bb.k_;wa.l=!!bb.QT;wa.m=!!bb.PT}}Object(u.a)(fa,"DataValidationEditDialogDeprecated",L.a,[]);var Ka=a(1);class aa{BIa(bb,wa,ka,ta){Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new ya(bb,wa,ka,ta)).cVd():(new fa(bb,wa,ka,ta)).cVd()}J9g(bb,wa){const ka=new J.StandardDialog;ka.Rb=3;ka.CBa(bb.rb.Ava,X.a.instance.ga(1708),wa)}L9g(bb,
wa){const ka=new J.StandardDialog;ka.Rb=1;ka.kX(bb.rb.Ava,X.a.instance.ga(1709),wa)}}Object(u.a)(aa,"DataValidationEditDialogFactory",null,[362]);class ja extends b.a{constructor(bb){super(bb)}ld(){this.Yc([new D(this.$,new aa)])}static ka(bb){b.a.Nd(245,new ja(bb))}}Object(u.a)(ja,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(E,"a",function(){return Va});const Va=()=>{c.a.Fa(ja.ka)}},1154:function(u,E,a){function c(la,ua,xa,fb,Jb,Ob){if(0===fb)return Object(ba.a)(Y.UnsupportedZeroResize);
if(0>fb||0===xa.length)return Object(ba.a)(Y.InvalidInput);if(la.x9h())return Object(ba.a)(Y.UnsupportedSkeletonInView);const eb=la.Xd;if(!eb)return Object(ba.a)(Y.NullSPD);var Ma=eb.C2e(xa);if(Ma&&0<Ma.length)return Object(ba.a)(Ma.length.toString()+" "+Y.UnsupportedHiddenInRange);a:{for(const Pa of xa)Jb?Pa.right=S.a.qh:Pa.bottom=S.a.fh;Ma=la.caa("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",xa);try{for(Ma.$$rst();Ma.$$mn();)if(Ma.Zn.hIj){var va=!0;break a}}finally{Ma&&Ma.dispose()}va=!1}if(va)return Object(ba.a)(Y.UnsupportedMergeCell);
if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Jb&&"undefined"!==typeof gridRenderer)for(const Pa of xa)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Pa.left);la=la.Ea;va=lb.a.create().toString();eb.eig(xa,fb,Jb);Ob=la.YUj(Jb,Ob);ua.maj(xa,Jb);la.r7i(Ob,va,Jb?"row":"column");return Object(ba.d)(fb)}var b=a(9);u=a(0);var e=a(222),f=a(7),d=a(15),h=a(87);a(263);var m=a(187),l=a(416),w=a(83),n=a(774),y=a(186),t=a(266),r=a(24),v=a(870),B=a(42);
class A{}A.$Ih="GalleryGeneral";A.bJh="GalleryNumber";A.YIh="GalleryCurrency";A.WIh="GalleryAccounting";A.eJh="GalleryShortDate";A.aJh="GalleryLongDate";A.gJh="GalleryTime";A.cJh="GalleryPercentage";A.ZIh="GalleryFraction";A.dJh="GalleryScientific";A.fJh="GalleryText";A.EXg="ButtonComma";A.buttonPercentage="ButtonPercentage";A.keyboardNumber="KeyboardNumber";A.keyboardCurrency="KeyboardCurrency";A.keyboardDate="KeyboardDate";A.keyboardTime="KeyboardTime";A.keyboardPercentage="KeyboardPercentage";
Object(u.a)(A,"RibbonFormatKind",null,[]);var z=a(60),x=a(294),D=a(618),J=a(617),L=a(616);class T extends x.a{constructor(la,ua,xa,fb,Jb,Ob,eb,Ma,va,Pa,Ha,tb=null,Ya=null){super(11,0,Ma,Ha);this.xHh=la;this.ddd=ua;this.format=fb;this.activeCell=xa;this.Gue=Jb;this.mLf=Ob;this.hLf=eb;this.bGa=va;this.clientCorrelationId=Pa;this.Nmb=tb;this.ejb=Ya}get Wt(){return this.Nmb}get Eaa(){return this.ejb}get bEc(){return this.bGa}i3(la){return super.i3(la)||this.xHh.i3(this.ddd,this.activeCell,this.format,
this.Gue,this.mLf,this.hLf,this.v0b,this.bGa,this.clientCorrelationId,this.Nmb,this.ejb)}jk(){const la=[];if(this.$dc)for(const ua of this.$dc)la.push(L.a(ua));else la.push(new J.a(this.format,this.ddd,this.activeCell));return()=>new D.a(la)}Gfb(){const la={OperationType:0};la.FormatCellsMultiRange=this.ddd;la.ActiveCell=this.activeCell;la.Format=this.format;la.ApplyFormatOnPivotTableValueField=this.Gue;la.PivotTableXluid=this.mLf;la.PivotTableFieldCaption=this.hLf;return la}}Object(u.a)(T,"FormatCellsBatchOperation",
x.a,[]);var O=a(33),G=a(207);class C{}C.editCell="Edited";C.dependentCell="Dependents";Object(u.a)(C,"RecalcPriorityGroupType",null,[]);var H=a(198),I=a(1);const M=la=>{switch(la.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return d.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},Q=la=>{if(la=la.color){if("String"===Object.getType(la).getName())return H.a.rp(la);if("Number"===
Object.getType(la).getName())return null}else return null;d.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},U=(la,ua)=>{la=excelOnlineCalc.calc.getCellValueKind(la.rangeDelta.data.value);switch(la){case "number":case "string":case "boolean":return!0;case "Blank":return!0;case "Error":if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7317053_CalcErrorValueTypeSupported"))return!0;ua.numberOfUnsupportedErrorCellTypes++;return!1;
case "Rich":return ua.numberOfUnsupportedRichCellTypes++,!1;default:return d.ULS.shipAssertTag(537162192,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${la}`),!1}},N=la=>{la=excelOnlineCalc.calc.getCellValueKind(la.rangeDelta.data.value);let ua=0;switch(la){case "number":ua=1;break;case "string":ua=2;break;case "boolean":ua=3;break;case "Error":ua=4;break;case "Blank":ua=0;break;default:d.ULS.shipAssertTag(537162191,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${la}`)}return ua},
W=la=>{const ua=la.value;switch(la.type){case 2:return void 0===ua||null===ua?"":ua;case 1:return la=parseFloat(ua),isNaN(la)?null:la;case 3:return la=parseFloat(ua),isNaN(la)?null:1===la;case 4:return la=parseFloat(ua),isNaN(la)?null:excelOnlineCalc.calc.errorValue(la);default:return excelOnlineCalc.calc.blankValue}},X=(la,ua)=>{const xa=sa(ua);var fb=!(void 0===ua.rangeDelta.data.format||null===ua.rangeDelta.data.format);d.ULS.shipAssertTag(537162187,0,0===xa||!fb,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${ua.priorityGroup}`);
la=Math.max(la.cell.$j,0);fb&&(fb=excelOnlineCalc.calc.getCellFormatKind(ua.rangeDelta.data.format.format),"number"===fb?la=ua.rangeDelta.data.format.format:"string"===fb?d.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===fb?d.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):d.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));
return la},sa=la=>{if(la.priorityGroup===C.editCell)return 0;if(la.priorityGroup===C.dependentCell)return 1;d.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2},da=la=>{la=sa(la);if(0===la)return 1;if(1===la)return 2;d.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0};var S=a(8);class oa{constructor(la=0,ua="",xa=0,fb="",Jb=""){this.VE=la;this.cellValue=ua;this.ifmt=
xa;this.priorityGroup=fb;this.fy=Jb}}Object(u.a)(oa,"RecalcAccuracyObject",null,[]);class K{}K.string="String";K.blank="Blank";K.general="General";K.kGh="Flexible";Object(u.a)(K,"FormattedUnitKind",null,[]);class ea{constructor(la=0,ua=0,xa=0,fb=0,Jb=0,Ob=0,eb=0,Ma=0,va=0,Pa=0,Ha=0,tb=0,Ya=0,V=0,za=0,yb=!1,jc="",Cc=0,Sa=null,na=null,jb=null,Ib=null,dc=null,ob=null,Fa=null){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=
this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=
this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=la;this.numberOfNonUpdatedCells=ua;this.numberOfUpdatedCells=xa;this.numberOfCellsUpdatedAlreadyByServer=fb;this.numberOfCellsSkippedDueToTimeout=Jb;this.numberOfCellsWithNoFormattedCell=Ob;this.numberOfUnsupportedErrorCellTypes=eb;this.numberOfUnsupportedBlankCellTypes=
Ma;this.numberOfUnsupportedRichCellTypes=va;this.numberOfSkippedCellsDueToMissingLocaleInfo=Pa;this.totalExecutionTime=Ha;this.originalProcessingTimeLimit=tb;this.newProcessingTimeLimit=Ya;this.numberOfEditedRecalcedCellsInBatch=V;this.numberOfDependentRecalcedCellsInBatch=za;this.isNewTask=yb;this.lastSetCellInstantaneousOperation=jc;this.taskId=Cc;this.isNewNumberFormatter=Sa;this.numberOfRecalcedCellsWithFormattedValue=na;this.numberOfRecalcedCellsWithoutFormattedValue=jb;this.totalNumberFormatterTime=
Ib;this.newNumberFormatterFinalizeFailures=dc;this.numberOfMeasureTextWidthCalls=ob;this.numberOfHashFormattedValues=Fa}}Object(u.a)(ea,"RecalcResultProcessingStatistics",null,[]);class ya{constructor(la,ua,xa,fb){this.rangeDelta=la;this.stateId=ua;this.isFinished=xa;this.priorityGroup=fb}}Object(u.a)(ya,"RecalcedCellInfo",null,[]);var ha=a(109),La=a(11),Ia=a(22),ra=a(55),pa=a(66),ba=a(288);class fa{constructor(la,ua,xa){this.wda=[];this.calcManager=this.NAc=this.lastSetCellInstantaneousOperation=
null;this.UNf=fb=>{var Jb;if(fb&&fb.rangeDeltas){var Ob=this.wda.length;for(let eb=0;eb<fb.rangeDeltas.length;eb++)(null===(Jb=fb.rangeDeltas[eb])||void 0===Jb?0:Jb.data)&&void 0!==fb.rangeDeltas[eb].data.value&&null!==fb.rangeDeltas[eb].data.value&&void 0!==fb.rangeDeltas[eb].range&&null!==fb.rangeDeltas[eb].range&&this.wda.push(new ya(fb.rangeDeltas[eb],fb.stateId,fb.isFinished,fb.priorityGroup));d.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${fb.stateId}, priorityGroup=${fb.priorityGroup}, recalcFinished=${fb.isFinished}, cellsFromCalc=${fb.rangeDeltas.length}, initialCellsToRender=${Ob}, recalcedCells=${this.wda.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);
!Ob&&this.wda.length&&this.DFf(!1,0)}};this.$=la;this.grid=ua;this.Ag=xa;this.rda=fa.gKe;this.$.da.$a(268,fb=>{this.NAc=fb});this.$.da.$a(266,fb=>{this.calcManager=fb});this.SBb=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Etd=I.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.nti=I.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}dispose(){this.calcManager=
this.NAc=this.Ag=this.grid=this.$=null}Qbd(la,ua,xa,fb,Jb,Ob,eb){if(!ua)return Object(ba.a)("Null");var Ma=excelOnlineCalc.numfmt.renderCallback(fb,Pa=>gridRenderer.CanvasRendererGlobals.measureTextWidth(Pa,Jb,!0,I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),eb);let va=la.renderValue(ua,Ma);if(!excelOnlineCalc.util.isSuccess(va))return Object(ba.a)("Finalize");fb=null;if(eb=excelOnlineCalc.numfmt.isHashesValue(va.value)){if(va=la.renderHashesValue(va.value,
Ma),!excelOnlineCalc.util.isSuccess(va))return Object(ba.a)("Hashes")}else fb=fa.JHh(ua,va.value);Ma=va.value;la=excelOnlineCalc.numfmt.renderedValueToString(Ma);ua=M(Ma);Ma=Q(Ma);return Object(ba.d)({text:la,valueType:xa,fontColor:Ma,$j:Ob,hPa:fb,horizontalAlignment:ua,isHashesValue:eb})}DFf(la,ua){this.$&&this.grid&&this.calcManager&&this.NAc&&this.calcManager.GB?(la&&(this.rda=this.NAc.xef),this.F5i(this.grid,this.calcManager.GB,la,ua),!this.rda&&this.wda.length?ra.Task.delay(0).jp(xa=>{this.DFf(!0,
xa.id);return!0},0,null,pa.a.current):ra.Task.Ta(!0)):(d.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),ra.Task.Ta(!1))}F5i(la,ua,xa,fb){const Jb=La.HelperMethods.Tb();for(xa=new ea(this.wda.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.rda,void 0,void 0,void 0,xa,void 0,fb,!0,0,0,0,0,0,0);0<this.wda.length;){fb=La.HelperMethods.Tb()-Jb;if(!this.rda||fb>this.rda){xa.numberOfCellsSkippedDueToTimeout=
this.wda.length;break}fb=Array.dequeue(this.wda);if(U(fb,xa)){var Ob=r.Range.Qc(fb.rangeDelta.range.row+1,fb.rangeDelta.range.column+1);(Ob=la.Sb(Ob))?fa.vZg(fb.stateId,Ob.cell)?(fa.ync(la,Ob,fb,xa),this.bQg(ua,Ob,fb,xa)):xa.numberOfCellsUpdatedAlreadyByServer++:xa.numberOfCellsWithNoFormattedCell++}}fb=Math.round(La.HelperMethods.Tb()-Jb);this.BYj(fb);this.iLj(xa,fb);this.rjj(xa)}bQg(la,ua,xa,fb){var Jb,Ob,eb,Ma,va=X(ua,xa);const Pa=xa.rangeDelta.data.formatted,Ha=N(xa),tb=sa(xa);la=this.Qbd(la,
Pa,Ha,ua.cell.WBa,ua.cell.uia,va,!1);va=ua.cell.tFc;if(Object(ba.c)(la))if(this.SBb&&this.Etd){if(0===tb||ua.text!==la.value.text)this.nti&&0===tb&&this.DTd(va,la.value)&&(ua.cell.formattedText=va),this.Ag.i_a(ua,la.value),xa=da(xa),this.Ag.E9c(ua,this.lastSetCellInstantaneousOperation,1,xa,!0,!0),0===tb&&I.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.Bwf(ua.range):d.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),
fb.numberOfUpdatedCells++}else ua.text!==la.value.text&&(this.Ag.i_a(ua,la.value),xa=da(xa),this.Ag.E9c(ua,this.lastSetCellInstantaneousOperation,1,xa,!0,!0),fb.numberOfUpdatedCells++);else switch(la.reason){case "Null":fb.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Jb=fb.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==Jb?Jb:0)+1;break;case "Hashes":fb.numberOfHashFormattedValues=(null!==(Ob=fb.numberOfHashFormattedValues)&&void 0!==Ob?Ob:0)+1;break;case "Finalize":fb.newNumberFormatterFinalizeFailures=
(null!==(eb=fb.newNumberFormatterFinalizeFailures)&&void 0!==eb?eb:0)+1}Object(ba.b)(la)&&"Null"!==la.reason&&(fb.numberOfRecalcedCellsWithFormattedValue=(null!==(Ma=fb.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Ma?Ma:0)+1);fb=0===tb?ua.cell.userInput:ua.formulaBarText;Ma=Object(ba.c)(la)?la.value.text:"";xa=Object(ba.b)(la)?la.reason:"";d.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${ua.range.top}, ${ua.range.left}) 2nd pass formatting, success: ${Object(ba.c)(la)}, reason: ${xa}, priority: ${tb}, ifmt: ${ua.cell.$j}, input: '${fb?
Ia.a.zM(fb):"null"}', prediction: '${Ma?Ia.a.zM(Ma):"null"}',`)}BYj(la){this.rda=Math.max(this.rda-Math.max(la,1),0)}iLj(la,ua){la.numberOfNonUpdatedCells=this.wda.length;la.totalExecutionTime=ua;la.newProcessingTimeLimit=this.rda;la.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation}rjj(la){la=Sys.Serialization.JavaScriptSerializer.serialize(la);d.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${la}`)}static JHh(la,ua){la=la.units;var xa=
ua.units;if(la.length!==xa.length)return d.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;ua=[];let fb=-1;for(let Jb=0;Jb<la.length;Jb++)switch(la[Jb].kind){case K.blank:ua.push(...ha.h(" ",xa[Jb].str.length));break;case K.string:ua.push(la[Jb].str);break;case K.kGh:ua.push("");fb=Jb;break;case K.general:ua.push(xa[Jb].str);break;default:d.ULS.sendTraceTag(537162178,
0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=fb||""===xa[fb].str)return null;xa={};xa.Start=ua.slice(0,fb).join("");xa.Separator=la[fb].str;xa.End=ua.slice(fb+1,ua.length).join("");return xa}static nOh(la){return la&&la&&la.my?la.my.QE:S.a.qe}static vZg(la,ua){if(!ua)return!1;ua=fa.nOh(ua);return ua===S.a.qe||ua===la}static ync(la,ua,xa,fb){var Jb=xa.rangeDelta.data.value.toString();const Ob=N(xa),eb=X(ua,xa);Jb=new oa(Ob,Jb,eb,xa.priorityGroup);ua.cell.ync(Jb,
la.Ea.e6);1===sa(xa)?fb.numberOfDependentRecalcedCellsInBatch++:fb.numberOfEditedRecalcedCellsInBatch++}DTd(la,ua){return null==la?!1:!!la.TextRuns&&!!la.Fonts&&la.Text===ua.text&&2===ua.valueType}}fa.gKe=20;Object(u.a)(fa,"CalcResultProcessor",null,[592,2]);class Ka{constructor(la,ua=null,xa=""){this.success=la;this.Dnc=ua;this.reason=xa}}Object(u.a)(Ka,"GetRibbonNumberFormatResult",null,[]);var aa=a(907);class ja{constructor(la,ua){this.Ix=null;this.Ea=la;this.A3a=ua}Mdb(la,ua,xa,fb,Jb=!1,Ob=!1){la&&
(la.S0(ua,xa,Jb,Ob),la.verticalAlignment=fb)}bMb(la,ua,xa){this.Ix||(this.Ix=new aa.a(this.Ea,this.A3a));this.Ix.bMb(la,ua,xa)}}Object(u.a)(ja,"FormatCellsActionModelAccessor",null,[591]);var Va=a(208),bb=a(28),wa=a(29),ka=a(282),ta=a(251),qa=a(281),rb=a(67);class Za{constructor(){this.Wjg=this.n1j=!1;this.source=0;this.Nka=this.Wic=!1}}Object(u.a)(Za,"FormatCellInstantaneousResult",null,[]);class gb{constructor(la,ua){this.success=la;this.fy=ua}}Object(u.a)(gb,"FormatStringResult",null,[]);var mb=
a(21),Ga=a(173),ib=a(1085),cc=a(44),ic=a(519),xb=a(51),Vb=a(200),wb=a(262),cb=a(79),lb=a(170),Y;(function(la){la.InvalidInput="invalid input";la.UnsupportedZeroResize="resizing to 0 - ignore";la.UnsupportedSkeletonInView="skeleton in view - ignore";la.NullSPD="ActiveSheetProcessedData is null";la.UnsupportedHiddenInRange="hiddens in resizeRanges";la.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(Y||(Y={}));Object(u.b)("InstantaneousRowColumnResizeFailureReason",Y);var Oa=
a(174);class Wa{constructor(la){this.Ix=this.calcManager=this.py=this.xTa=null;this.f1g=ua=>{if(ua){const xa=La.HelperMethods.TO.hasOwnProperty(ua);ua=mb.h(this.$).isFontSupported(ua);return!xa&&ua}d.ULS.sendTraceTag(512340115,0,15,"FormatCellsAction.checkIfNewFont: fontName cannot be null");return!1};this.COi=(ua,xa)=>{if(ua&&!ka.a(ua)&&xa){const fb=!!ua&&!!ua.RequestTelemetryData;mb.h(this.$).ji.Vla(xa.toString(),ua.StateId,fb?ua.RequestTelemetryData.EcsOperationDuration:0,fb?ua.RequestTelemetryData.EcsRequestDuration:
0,fb?ua.RequestTelemetryData.WfeRequestDuration:0)}};this.$=la;this.$.da.$a(268,ua=>{this.py=ua});this.yHh=new ja(mb.h(this.$).Ea,this.$);this.Nha=new fa(this.$,mb.h(this.$),this);this.$.da.$a(266,ua=>{this.calcManager=ua});this.xb=I.EwaSettings.xb();this.Vl=I.EwaSettings.Vl();this.SBb=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Etd=I.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.MNa=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",
!1);this.oti=I.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker");this.Gl=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)}get rva(){return this.yHh}get GB(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.GB}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){h.a.qc([this.xTa,this.Nha]);this.$=this.Nha=this.xTa=null}kTa(la,
ua,xa,fb=!1,Jb="",Ob=0,eb=null){return this.OEj(la,ua,xa,fb,Ob,Jb,eb)}E9c(la,ua,xa,fb,Jb,Ob){la.cell.my.WJ|=fb;Wa.H5g(mb.h(this.$),la,xa,Jb);this.Nha.lastSetCellInstantaneousOperation=ua;Ob&&(mb.h(this.$).ji.uS(ua,rb.BasicTelemetryCalculator.$Q),I.EwaSettings.isChangeGateEnabled("OfficeVSO:7198762_AddTelemetryforCalculateDurationBetweenPhases")&&(1===xa&&1===fb?mb.h(this.$).ji.uS(ua,rb.BasicTelemetryCalculator.yef):1!==xa&&mb.h(this.$).ji.uS(ua,rb.BasicTelemetryCalculator.Vnd)))}nea(la,ua,xa,fb=!1,
Jb=null,Ob=null){Ob=Ob||la.ha.ra.selectedRanges;if(!(-1690267012===ua&&1<Ob.length)){-1690267012===ua&&d.ULS.shipAssertTag(537162176,0,1===Ob.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${Ob.length}`);Ob=la.caa("FormatCellsAction.ShowInstantaneousFormatting",Ob);try{Ob.$$rst();let eb=!1;for(;Ob.$$mn();){let Ma;const va=Ob.$$cu().aI?la.ALb(Ob.$$cu().range):(Ma=new m.a,Ma.add(Ob.$$cu()),Ma);for(let Pa of va)if(mb.h(this.$),!Pa||Ob.hb.contains(Pa.range))if(this.P7f(ua,
Pa,xa,fb,Jb,Ob.$$cu().aI),eb||(la.Ea.xV(),eb=!0),Jb)break}}finally{Ob&&Ob.dispose()}}}i_a(la,ua,xa=null){xa&&(xa.Nka=!0);xa=!ua.text;const fb=Ia.a.yjf(ua.text);let Jb;const Ob=la.aI?mb.h(this.$).ALb(la.range):(Jb=new m.a,Jb.add(la),Jb);for(let eb of Ob)this.$Pg(this.$,eb,ua.text,ua.horizontalAlignment,ua.fontColor,ua.$j,la.cell.$j,xa,fb,ua.valueType,ua.hPa);la.cell.QDc()}B0i(la,ua,xa,fb,Jb=null){try{const Ob=B.D(ua);let eb=B.D(xa);if(la.Bb.B7a(Ob)||la.Bb.B7a(eb))return 8;if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste")&&
-185374993!==fb&&(la.Bb.vmf(Ob)||la.Bb.vmf(eb)))return 18;if(-185374993!==fb&&this.fri(la,Ob,eb))return 9;if(-185374993!==fb&&(la.Bb.I5(eb)||la.Bb.iBb(Ob)))return 10;if(1804571062!==fb&&la.Bb.E5(eb))return 11;if(this.Qmh(eb))return 12;if(this.bsi(Ob,eb))return 13;const Ma=this.$.Jb.Ac("UserAction","PasteInstantaneous");Ma.start();ic.a(Ma);Jb&&xb.b().OA(Ma.id,Jb.id,"actions","actions");!Ob.isSingle&&eb.isSingle&&(eb=Wa.expandRange(Ob,eb),la.ha.updateSelection(eb,eb,0));switch(fb){case 237279923:case 808159687:if(!this.T0i(Ob,
eb))return 14;this.s4c(la,Ob,eb,!0,!1);break;case 1804571062:this.s4c(la,Ob,eb,!0,!1);break;case -185374993:this.s4c(la,Ob,eb,!1,!0);break;default:return 2}d.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Ob){return d.ULS.sendTraceTag(537162145,0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(Ob)}`),15}}F2g(la,ua){for(const xa of la)this.W1c(xa,!0,ua)}W1c(la,ua,xa=""){if(la){var fb=mb.h(this.$);
if(ua){if(ua=fb.kk("FormatCellsAction.ClearRangeInstantaneous",la),fb=la.isSingle?null:la,ua.$$mn()&&void 0!==ua.$$cu()&&null!==ua.$$cu())for(la=Object(f.a)(new wb.a,{Text:""}),this.kTa(ua.$$cu(),la,!1,O.a.Fqd(this.$),xa,void 0,fb);ua.$$mn();)void 0!==ua.$$cu()&&null!==ua.$$cu()&&this.kTa(ua.$$cu(),la,!1,!1,xa)}else this.nea(fb,-1228228458,{},void 0,void 0,[la])}else d.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}maj(la,ua){if(!ua){ua=
La.HelperMethods.Tb();var xa=mb.h(this.$),fb=xa.caa("FormatCellsAction.ReformatCells",la);try{fb.$$rst();let Jb=!1;for(;fb.$$mn();){const Ob=fb.$$cu().cell;if(0===Ob.VE||2===Ob.VE)this.updateSpillInformation(Ob,la),Jb||(xa.Ea.xV(),Jb=!0)}}finally{fb&&fb.dispose()}d.ULS.sendTraceTag(537162143,0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${La.HelperMethods.Tb()-ua}.`)}}Gkd(la,ua){if(this.xb){if(la.formulaBarText)return!Ia.a.equals(ua.Text,la.formulaBarText,
!1);let xa=la.cell.formattedText;xa=ta.a(xa,la.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(xa,ua).isEqual}return!Ia.a.equals(ua.Text,la.text,!1)}tYe(la,ua,xa,fb){if(void 0===ua||null===ua)return new gb(!1,la);const Jb={};Jb.value=la;Jb.type=1;ua=this.U3a(Jb,ua,xa,fb);return Object(ba.b)(ua)?new gb(!1,la):new gb(!0,ua.value.text)}PEj(la,ua,xa,fb){return c(la,this,ua,xa,fb,!0)}MEj(la,ua,xa){if(!this.Gkd(ua,xa))return Object(ba.d)("Skip unchanged cell content");
ua=ua.cell;xa=this.vYe(xa.Text,ua.$j,ua.WBa,ua.uia,!0);if(Object(ba.b)(xa))la=xa;else{xa=xa.value;var fb=ua.hasRichValueIcon?"Unsupported rich value icon":ua.FX?"Unsupported wrapped text":ua.pmf||null!=ua.ML&&0!==ua.ML?"Unsupported rotated text":!0;!0!==fb?la=Object(ba.a)(fb):(ua.isCellWidthFixed?fb="Skip fixed width cell":(fb=xa.valueType,fb=0===fb?"Skip empty cell value":2===fb?"Skip string cell value":ua.PF&&!ua.Wqi?"Skip merged cell":ua.Dzc?"Skip shrunk to fit":xa.isHashesValue?"Skip hashes cell value":
!0),!0!==fb?la=Object(ba.d)(fb):(xa=ua.i7g(xa.text),xa>ua.offsetWidth?(ua=[ua.getRange().clone()],la=c(la,this,ua,xa,!1,!1),la=Object(ba.b)(la)?la:Object(ba.d)(xa)):la=Object(ba.d)("Column is wide enough")))}return la}sYe(la,ua,xa,fb,Jb){const Ob={};Ob.value=la;Ob.type=xa;ua=this.U3a(Ob,ua,fb,Jb);return Object(ba.b)(ua)?new gb(!1,la):new gb(!0,ua.value.text)}updateSpillInformation(la,ua){const xa=la.getRange();let fb=!1;for(const Jb of ua)if(xa.left===Jb.left){fb=!0;break}la.nVj(fb)}OEj(la,ua,xa,
fb,Jb,Ob="",eb=null){this.SBb&&this.oti&&(la.cell.tFc=ua);const Ma=new Za;Ma.source=0;Ma.Nka=!1;la.cell.XGb=la.cell.$j;let va=ua.Text;const Pa=!va,Ha=Ia.a.yjf(va);Ia.a.Vq(va)&&(d.ULS.shipAssertTag(537162142,0,!((void 0===va||null===va)&&void 0!==ua.TextRuns&&null!==ua.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),ua=Object(f.a)(new wb.a,{Text:""}),va="");la.cell.userInput=va;if(!this.Gkd(la,ua))return this.c0g(la,Jb,Pa,Ha,Ma);xa?this.W_g(la,
va,this.$.workbookContext.DefaultHyperlinkStyle,Ma):this.Q_g(la,ua,va,Pa,Ha,fb,Ma,eb);this.E9c(la,Ob,Jb,1,Ma.Wic,Ma.Nka);return Ma}c0g(la,ua,xa,fb,Jb){Jb.Wjg=!0;Jb.Wic=!0;Jb.Nka=!1;0===ua&&mb.h(this.$).Ea.xV();0===la.cell.Hza&&(xa?la.cell.S0(0,!1):fb&&la.cell.S0(1,!1));this.j_d(la.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return Jb}W_g(la,ua,xa,fb){fb.Nka=!0;la.insertHyperlink(ua,G.a.wcd(ua),xa);this.j_d(la.range,"FormatCellsAction.cellDataEntryCSE")}Q_g(la,ua,xa,fb,Jb,Ob,eb,Ma=null){eb.Nka=
!1;const va=la.cell;let Pa=!1;this.py||(this.py=this.$.da.za(268));this.WQj(this.py,va.$j);I.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")&&Ob&&(Pa=this.Rdg(this.py,la,xa,Ma));fb||Jb?this.S_g(la,fb,Jb,eb):(fb=this.vYe(xa,va.$j,va.WBa,va.uia,!1,Pa),Object(ba.c)(fb)?(this.DTd(ua.TextRuns,ua.Fonts)&&this.U_g(la,ua,fb.value),this.i_a(la,fb.value,eb),this.j_d(la.range,"FormatCellsAction.cellDataEntryCSE")):this.SBb&&this.Etd?this.$_g(la,ua.Text,eb):this.a0g(la,ua.Text,eb),
ua=Object(ba.c)(fb)?fb.value.text:"",Jb=Object(ba.b)(fb)?fb.reason:"",d.ULS.sendTraceTag(559724065,0,50,`FormatCellsAction.CellDataEntryCSE: (${la.range.top}, ${la.range.left}) 1st pass formatting, success: ${Object(ba.c)(fb)}, reason: ${Jb}, ifmt: ${va.$j}, input: '${Ia.a.d_a(va.userInput)}', prediction: '${Ia.a.d_a(ua)}',`));va.formulaBarText=xa;I.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")||Ob&&this.Rdg(this.py,la,xa,Ma);eb.Wic=!0}S_g(la,ua,xa,fb){fb.Nka=!0;la.text=
"";la.formulaBarText="";la.cell.userInput="";this.$2b(la,null,null,ua,xa)}U_g(la,ua,xa){ua.Text===xa.text&&2===xa.valueType&&(la.cell.formattedText=ua)}$_g(la,ua,xa){xa&&(xa.Nka=!0);la.text=ua;la.formulaBarText=ua;this.$2b(la,1)}a0g(la,ua,xa){xa&&(xa.Nka=!0);la.text=ua;la.formulaBarText=ua;this.$2b(la,1)}$2b(la,ua,xa=null,fb=!1,Jb=!1,Ob=!1){let eb=la.horizontalAlignment;xa=null!=xa?xa:la.verticalAlignment;0===la.cell.Hza&&(null!=ua||fb||Jb||Ob)&&(fb?eb=0:Jb||Ob?eb=1:null!=ua&&(eb=ua),this.rva.Mdb(la,
eb,!1,xa,!0))}j_d(la,ua){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const xa=mb.h(this.$),fb=()=>{this.calcManager?this.calcManager.Bwf(la):d.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${ua}, cell ${la}`);xa.Vb.em(fb)};xa.Vb.Rm(fb)}}WQj(la,ua){(null===la||void 0===la?0:la.Zya)&&ua>=Wa.SFh&&ua>la.Zya.length-1&&(d.ULS.sendTraceTag(537162141,
0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${ua}. Triggering refresh...`),la.lYe())}Rdg(la,ua,xa,fb=null){if(void 0===la||null===la)return!1;if(this.py.Und)return d.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing"),!1;const Jb=this.$.da.za(266);return Jb?(this.Nha.rda=fa.gKe,la&&(this.Nha.rda=la.xef),Jb.KYg(ua,xa,this.Nha.UNf,fb)):!1}U3a(la,ua,xa,fb){var Jb=this.$.da.za(266);if(!Jb)return Object(ba.a)("calcManager is null");
if(!Jb.GB)return Object(ba.a)("calcManager.NumberFormatter is null");if(!this.py)return Object(ba.a)("instantaneousManager is null");let Ob;if("number"===typeof ua||"string"===typeof ua){var eb=Jb.gxb(ua);if(!Object(ba.c)(eb))return eb;Ob=eb.value}else Ob=ua;eb=Jb.GB;const Ma=W(la);if(void 0===Ma||null===Ma)return Object(ba.a)("cellValue is null");Jb=excelOnlineCalc.calc.cellValueToReadOper(Jb.config.mathpack,Ma);if(void 0===Jb||null===Jb)return Object(ba.a)("readOper is null");Jb=eb.applyFormat(Ob,
Jb,I.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(Jb)?this.Nha.Qbd(eb,Jb.value,la.type,xa,fb,"number"===typeof ua?ua:-1,!1):Object(ba.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Jb.reason.kind))}vYe(la,ua,xa,fb,Jb,Ob){var eb=this.$.da.za(266);if(void 0===eb||null===eb)return Object(ba.a)("calcManager is null");if(void 0===eb.GB||null===eb.GB)return Object(ba.a)("calcManager.NumberFormatter is null");if(void 0===this.py||
null===this.py)return Object(ba.a)("instantaneousManager is null");if(this.SBb&&!Jb&&Ob)return Object(ba.a)("No main thread number formatter");Ob=eb.gxb(ua);if(!Object(ba.c)(Ob))return Ob;var Ma=Ob.value;Ob=eb.GB;la=Ob.parseEdit(la,Ma);if(!excelOnlineCalc.util.isSuccess(la))return Object(ba.a)(`ParseEdit failure: reason=${la.reason.kind}, features=${la.reason.features}`);if(la.value.kind===v.a.formula)return Object(ba.a)("Main thread - skipping formula edit");eb=excelOnlineCalc.numfmt.applyValueEdit(Ob,
eb.localeInfo,Ma,la.value);if(!excelOnlineCalc.util.isSuccess(eb))return Object(ba.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(eb.reason.kind));la=la.value;d.ULS.shipAssertTag(537162190,0,la.kind!==v.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");la=excelOnlineCalc.numfmt.getValueEditOperKind(la);Ma=0;switch(la){case 0:case 128:Ma=0;break;case 1:Ma=1;break;case 2:Ma=2;break;case 4:Ma=3;break;case 8:Ma=4;break;case 16:case 32:case 64:case 256:d.ULS.sendTraceTag(537162189,
0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${la} to a CellValueType`);break;default:d.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${la}`)}return this.Nha.Qbd(Ob,eb.value,Ma,xa,fb,"number"===typeof ua?ua:-1,Jb)}fri(la,ua,xa){if(ua.width<xa.width){const fb=la.kk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new r.Range(ua.top,ua.left,ua.bottom,ua.left,!0,!0));for(;fb.$$mn();){let Jb=fb.$$cu();if(Jb&&
Jb.WLa())return d.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(ua.height<xa.height)for(la=la.kk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new r.Range(ua.top,ua.left,ua.top,ua.right,!0,!0));la.$$mn();)if((ua=la.$$cu())&&ua.$La())return d.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}s4c(la,ua,xa,fb,Jb){const Ob=ua.zS().FirstRow,eb=ua.zS().LastRow;
var Ma=xa.zS().FirstRow;const va=xa.zS().LastRow;let Pa=Ob;for(;Ma<=va;Ma++,Pa++){Pa>eb&&(Pa=Ob);const Ha=ua.zS();Ha.FirstRow=Ha.LastRow=Pa;const tb=xa.zS();tb.FirstRow=tb.LastRow=Ma;this.K8g(la,y.a.IQ(Ha),y.a.IQ(tb),fb,Jb)}}T0i(la,ua){const xa=this.$.da.za(266);return void 0!==xa&&null!==xa?(xa.FYg(la,ua.topLeft,this.Nha.UNf),!0):!1}bsi(la,ua){const xa=la.right-la.left+1;la=la.bottom-la.top+1;const fb=ua.right-ua.left+1;ua=ua.bottom-ua.top+1;if(fb>xa&&ua>la){if(!(fb%xa&&ua%la))return!0}else if(fb===
xa&&ua>la){if(!(ua%la))return!0}else if(fb>xa&&ua===la&&!(fb%xa))return!0;return!1}Qmh(la){if(I.EwaSettings.ma(102)){la=mb.h(this.$).x1(la).gridView.getRangeInformation(la);for(const ua of la)if(Object(l.a)(t.DynamicArrayRange,ua)&&!Object(w.a)(t.DynamicArrayRange,ua).qnc)return!0}return!1}VFe(la,ua,xa,fb,Jb,Ob){for(let eb of ua)xa&&(this.O8g(eb,Jb),eb.setCell(!0)),fb&&(Ob=this.o7h(Jb,eb)),Ob||(la.Ea.xV(),Ob=!0);return Ob}nTh(la,ua,xa){ua=new r.Range(ua,xa,ua,xa,!0,!0);return la.Sb(ua)}K8g(la,ua,
xa,fb,Jb){if(xa){this.xTa&&xa.equals(this.xTa.range)||(h.a.Ia(this.xTa),this.xTa=la.kk("FormatCellsAction.CopyBetweenRows",xa));xa=this.xTa;xa.$$rst();var Ob=!1;if(I.EwaSettings.getBooleanFeatureGate(Oa.a.RIe,!1)){var eb=ua.zS().FirstColumn+1,Ma=ua.zS().LastColumn+1;ua=ua.zS().FirstRow+1;let Pa=eb;for(;xa.$$mn();){Pa>Ma&&(Pa=eb);const Ha=this.nTh(la,ua,Pa);Pa+=1;var va=void 0;const tb=xa.$$cu().aI?la.ALb(xa.$$cu().range):(va=new m.a,va.add(xa.$$cu()),va);Ha&&(Ob=this.VFe(la,tb,fb,Jb,Ha,Ob));cb.lastOrDefault(tb)}}else for(va=
la.kk("FormatCellsAction.CopyBetweenRows2",ua);xa.$$mn();)va.$$mn()||(va.$$rst(),va.$$mn()),Ma=va.$$cu(),ua=xa.$$cu().aI?la.ALb(xa.$$cu().range):(eb=new m.a,eb.add(xa.$$cu()),eb),Ma&&(Ob=this.VFe(la,ua,fb,Jb,Ma,Ob)),cb.lastOrDefault(ua)}else d.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}j8f(){const la=wa.a.Zc(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");cc.a(this.$).vj(la)}ICi(la,ua){const xa={ValidMembers:32},fb=ua.NumberFormat;switch(la){case 1890566896:if(1001===
fb||1002===fb||1003===fb){xa.NumberFormat=14;xa.NumberFormatOptions={};switch(fb){case 1001:xa.NumberFormatOptions.TimeType=2;break;case 1002:xa.NumberFormatOptions.DateType=7;break;case 1003:xa.NumberFormatOptions.DecimalPlaces=0}xa.NumberFormatOptions.NumberFormatCategory=this.PPg(fb)}else xa.NumberFormat=fb;break;case 1886928607:xa.NumberFormat=13;break;case -992833457:xa.NumberFormat=11;break;case 218524921:xa.NumberFormat=12;break;case 996232352:xa.NumberFormat=14;xa.NumberFormatOptions=Object(f.a)(new n.a,
{DecimalPlaces:0});xa.NumberFormatOptions.NumberFormatCategory=6;break;default:return ua}return xa}formatCells(la,ua,xa,fb=null,Jb=null,Ob=null,eb=null){var Ma;const va=this.$.Jb.Ac("UserAction","FormatCellsInstantaneous, command = "+xb.b().uj(la)),Pa=this.$.Jb.Pg("UserAction","FormatCellsInstantaneousFrame");Pa.start();ic.a(Pa);var Ha=xb.b().uj(la);const tb=this.$,Ya=mb.h(tb);var V=Ya.ha.ra,za=Jb||V.selectedRanges,yb=ha.g(za,jb=>jb.qH);Ha=`${Ha}, cellCount=${yb}`;mb.h(this.$).ji.X7(1,va.id,Ha);za=
B.r(za,this.$);V=V.activeCell;Ha=-168056295===xa.command;var jc=yb=null;if(Ha){jc=Ya.Bb.xp(V);if(!jc){this.j8f();return}yb=jc.hda.substring(1,jc.hda.length-1);jc=jc.Qbc();if(!jc){this.j8f();return}jc=jc.Caption}Ya.Hf.rH(!1,!0);const Cc=B.o(V,tb),Sa=tb.pa.ya.Wb({uca:!0,Dba:1}),na=this.ICi(xa.command,ua);Ha||this.nea(Ya,la,ua,!1,fb,Jb);va.stop();mb.h(this.$).ji.uS(va.id,rb.BasicTelemetryCalculator.$Q);xa.jgi=bb.a.Qa.zb;fb=this.$.Jb.Ac("UserAction","FormatCellsUserAction");Jb=this.Gl&&this.f1g(null===
(Ma=null===ua||void 0===ua?void 0:ua.Font)||void 0===Ma?void 0:Ma.FontName);this.Xyi(la,xa.taskId,ua,za,V,fb.id,Jb);xb.b().OA(va.id,fb.id,"actions","actions");xb.b().OA(Pa.id,fb.id,"actions","actions");tb.userOperationManager.Ic(new T(this,za,Cc,na,Ha,yb,jc,Sa,fb,va.id,64,Ob,eb),xa)}i3(la,ua,xa,fb,Jb,Ob,eb,Ma,va,Pa,Ha){const tb=this.$;return(Ya,V,za)=>{tb.My();Ya=[Ya,this.COi];V=[V];Pa&&Ya.push(Pa);Ha&&V.push(Ha);return z.l(tb.pa.ya,la,ua,xa,fb,Jb,Ob,!1,qa.b(...Ya),qa.a(...V),za,va,eb,Ma)}}P7f(la,
ua,xa,fb,Jb,Ob,eb=null){if(ua&&xa){var Ma=xa.Font,va=xa.HorizontalAlignment,Pa=xa.VerticalAlignment;xa.ValidMembers&2||(va=ua.horizontalAlignment);xa.ValidMembers&1||(Pa=ua.verticalAlignment);var Ha=0!==va;Wa.uii(la)&&0===va&&(va=this.F2e(ua));var tb=!1;switch(la){case -394785302:this.rva.Mdb(ua,va,Ha,0);break;case 1041132226:this.rva.Mdb(ua,va,Ha,1);break;case -571165336:this.rva.Mdb(ua,va,Ha,2);break;case -1150205178:case -1142465846:case -286432209:this.rva.Mdb(ua,va,Ha,Pa,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.MNa&&
this.ltj(ua,xa,Ha);break;case 1650812936:this.setFillColor(ua,xa,Ob);break;case -287251124:ua.bold=Ma.Bold;break;case -1690267012:mb.h(this.$).ha.ra.Og&&(Ma=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?eb?eb:mb.h(this.$).ha.ra.$c:mb.h(this.$).ha.ra.$c,this.rva.bMb(ua,xa,Ma));break;case 1970784898:xa=H.a.rp(ua.color,ua.backgroundColor);if(Va.a.compare(xa,Va.a.red)&&(Ia.a.y5(ua.text)||Ia.a.z$e(ua.text)))break;xa=Va.a.GH(Ma.FontColor);ua.color=
Vb.e(H.a.BG(xa));break;case -1925065947:ua.italic=Ma.Italic;break;case -1293291468:ua.fontName=Ma.FontName;this.Vl&&ua.U2f(Ma.FontScheme);break;case 862890474:case 963349338:ua.fontSize=Ma.FontSize;this.$.af();break;case -1077965542:ua.fontSize=Ma.FontSize;break;case 1764140053:ua.underline=Ma.Underline;break;case -1685033574:ua.doubleUnderline=Ma.DoubleUnderline;break;case -1590502662:ua.fontStrikethrough=Ma.Strikethrough;break;case -848953656:case 2045211913:tb=ua.hrb();break;case 2105621672:xa=
Object(w.a)(ib.a,Jb);if(!xa)break;Ma=Va.a.DIh(xa.color);ua.color=Vb.e(H.a.BG(Ma));this.Mue(ua,xa.Hnc);break;case -1409276245:this.Mue(ua,xa.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.ZPg(ua,xa);break;case -1228228458:ua.hrb();ua.clearFormat();this.hYc(ua,0);tb=!0;break;case -730106152:ua.clearFormat();this.hYc(ua,0);break;case 932244020:this.ktj(ua,xa,Ob);break;case -1942512156:case -1920201820:this.ivj(ua,xa)}fb||(tb?ua.qJb(!0):ua.setCell(!0))}else d.ULS.shipAssertTag(537162135,
0,!ua,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),d.ULS.shipAssertTag(537162134,0,!xa,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}O8g(la,ua){la&&ua?(la.rrb(ua),la.p2c(ua),this.hYc(la,ua.cell.$j)):d.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}hYc(la,ua){if(0>ua)this.oca({caller:"ApplyNumberFormatIndexOnCell",cell:la,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});
else{var xa=this.U3a(la.qx,ua,la.cell.WBa,la.cell.uia);Object(ba.b)(xa)?this.oca({caller:"ApplyNumberFormatIndexOnCell",cell:la,kind:"failure",reason:xa.reason}):(this.i_a(la,xa.value),this.oca({caller:"ApplyNumberFormatIndexOnCell",cell:la,kind:"success",fy:xa.value,format:ua}))}}Mue(la,ua){if(void 0===ua||null===ua)this.oca({caller:"ApplyNumberFormatStringOnCell",cell:la,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var xa=this.U3a(la.qx,ua,la.cell.WBa,
la.cell.uia);Object(ba.b)(xa)?this.oca({caller:"ApplyNumberFormatStringOnCell",cell:la,kind:"failure",reason:xa.reason}):(this.i_a(la,xa.value),this.oca({caller:"ApplyNumberFormatStringOnCell",cell:la,kind:"success",fy:xa.value,format:ua}))}}ZPg(la,ua=null){if(ua)if(ua=this.v_h(la,ua),ua.success){var xa=this.U3a(la.qx,ua.Dnc,la.cell.WBa,la.cell.uia);Object(ba.b)(xa)?this.oca({caller:"ApplyNumberFormatCategoryOnCell",cell:la,kind:"failure",reason:xa.reason,format:ua.Dnc}):(this.i_a(la,xa.value),this.oca({caller:"ApplyNumberFormatCategoryOnCell",
cell:la,kind:"success",fy:xa.value,format:ua.Dnc}))}else this.oca({caller:"ApplyNumberFormatCategoryOnCell",cell:la,kind:"failure",reason:ua.reason,format:ua.Dnc});else this.oca({caller:"ApplyNumberFormatCategoryOnCell",cell:la,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}PPg(la){switch(la){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<la?-1:la}v_h(la,
ua){if(!this.py||!this.localeInfo||!ua)return la=this.py?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new Ka(!1,void 0,"GetRibbonNumberFormat: "+la);ua=ua.NumberFormat;switch(ua){case 0:la=A.$Ih;break;case 1:la=A.bJh;break;case 2:la=A.YIh;break;case 3:la=A.WIh;break;case 4:la=A.eJh;break;case 5:la=A.aJh;break;case 6:la=A.gJh;break;case 7:la=A.cJh;break;case 8:la=A.ZIh;break;case 9:la=A.dJh;break;case 10:la=A.fJh;break;case 11:case 12:return this.py.lYe(),
this.FQh(la,ua);case 13:la=A.EXg;break;case 1006:la=A.buttonPercentage;break;case 1004:la=A.keyboardNumber;break;case 1005:la=A.keyboardCurrency;break;case 1002:la=A.keyboardDate;break;case 1001:la=A.keyboardTime;break;case 1003:la=A.keyboardPercentage;break;case 14:return la="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",d.ULS.shipAssertTag(537162132,0,!1,la),new Ka(!1,void 0,la);default:return la="GetRibbonNumberFormat: unknown NumberFormatType!",d.ULS.shipAssertTag(537162131,
0,!1,la),new Ka(!1,void 0,la)}return la?(la=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,la))?new Ka(!0,la):new Ka(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new Ka(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}FQh(la,ua){if(!this.calcManager||!this.GB)return ua=this.calcManager?"numberFormatter is null":"calcManager is null",new Ka(!1,void 0,"GetDecimalChangeNumberFormat: "+ua);la=
this.calcManager.gxb(la.cell.$j);if(!Object(ba.c)(la))return new Ka(!1,void 0,`getDecimalChangeNumberFormat: ${la.reason}`);ua=this.GB.changeFormatDecimals(la.value,11===ua?1:-1);return excelOnlineCalc.util.isSuccess(ua)?void 0===ua.value||null===ua.value?new Ka(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new Ka(!0,ua.value):new Ka(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}oca(la){const ua=la.caller,xa=la.cell;var fb=la.format;fb=
null==fb?"null":"number"===typeof fb?fb:"string"===typeof fb?Ia.a.d_a(fb):Ia.a.d_a(fb.formatString);const Jb=Ia.a.d_a(xa.qx.value)||"null",Ob="success"===la.kind?Ia.a.d_a(la.fy.text):"null";la=JSON.stringify({caller:ua,"range.top":xa.range.top,"range.left":xa.range.left,result:la.kind,reason:"success"===la.kind?"":la.reason,value:Jb,valueType:xa.qx.type,ifmt:fb,prediction:Ob});d.ULS.sendTraceTag(537162130,0,50,`FormatCellsAction.LogNumberFormatEdit: ${la}`)}$Pg(la,ua,xa,fb,Jb,Ob,eb,Ma=!1,va=!1,Pa=
0,Ha=null){const tb=ua.cell;tb.VE=Pa;Pa=ua.text;Pa!==xa&&(tb.text=xa);tb.hPa=Ha;Ga.f(Pa)?ua.formulaBarText=Pa:ua.formulaBarText="";la=mb.h(la).Bb.ckf(ua.range);this.$2b(ua,fb,null,Ma,va,la);Jb&&(ua.color=Vb.e(H.a.BG(Jb)));ua.cell.$j=Ob;ua.cell.XGb=eb;ua.cell.fAc=Ob}Xyi(la,ua,xa,fb,Jb,Ob,eb){const Ma={};Ma.a=this.$.va.UserSessionId;Ma.b=ua;Ma.c=fb.Ranges.length;Ma.d=this.Obh(fb.Ranges);Ma.e=Jb.toString();Ma.f=la;Ma.h=Ob;1890566896===la?Ma.g=xa.NumberFormat.toString():2105621672===la?Ma.g=xa.NumberFormatOptions.NumberFormatCategory.toString():
this.Gl&&-1293291468===la&&(Ma.g=`{ "isNewFont": ${eb} }`);xb.b().Qe(3,Ma,!0)}Obh(la){let ua=0,xa=0,fb=0;for(let Jb=0;Jb<la.length;Jb++){const Ob=B.B(la[Jb]).qH;ua+=Ob;Ob>fb&&(fb=Ob,xa=Jb)}la=B.B(la[xa]).toString();return"TotalCellCount:"+ua+"; Max range:"+la+"; MaxRangeSize:"+fb+";"}ktj(la,ua,xa){64===(ua.ValidMembers&64)&&this.setFillColor(la,ua,xa);16===(ua.ValidMembers&16)&&Wa.Luj(la,ua);128===(ua.ValidMembers&128)&&this.rva.bMb(la,ua,la.range);if(2===(ua.ValidMembers&2)||1===(ua.ValidMembers&
1)){xa=ua.VerticalAlignment;ua=ua.HorizontalAlignment;const fb=0!==ua;I.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!fb&&this.F2e(la);this.rva.Mdb(la,ua,fb,xa)}}setFillColor(la,ua,xa){(I.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?la.oV:la.oV&&la.gyb&&!la.jyb&&!la.myb)||(ua=-1===ua.FillColor?xa?H.a.BG(Va.a.white):null:H.a.BG(Va.a.GH(ua.FillColor)),la.backgroundColor=ua?Vb.e(ua):null)}ivj(la,ua){0!==la.horizontalAlignment&&
2!==la.horizontalAlignment||la.S0(1,!1);0<=la.indentation+ua.IndentationIncrease&&(la.indentation+=ua.IndentationIncrease)}ltj(la,ua,xa){const fb=ua.TextOrientation;fb!==S.a.verticalText&&(0>fb||180<fb)&&d.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${fb}`);la.ML=ua.TextOrientation;xa||la.S0(0<=la.ML?1:3,!1)}F2e(la){la=this.U3a(la.qx,la.cell.$j,la.cell.WBa,la.cell.uia);return Object(ba.b)(la)?0:null!=la.value.horizontalAlignment?
la.value.horizontalAlignment:0}wwj(la,ua,xa){this.Ix||(this.Ix=new aa.a(mb.h(this.$).Ea,this.$));this.Ix.bMb(la,ua,xa)}o7h(la,ua){const xa=new wb.a;if(la.cell.formulaBarText&&la.cell.formulaBarText.startsWith("'"))xa.Text=la.cell.formulaBarText;else{let fb=la.cellValue;fb&&4!==la.cell.VE||(fb=la.text);xa.Text=fb}this.kTa(ua,xa,!1,O.a.Fqd(this.$));return!0}DTd(la,ua){return this.xb&&!!la&&!!ua}static H5g(la,ua,xa,fb){fb&&ua.setCell(!0);0===xa&&la.Ea.xV()}static expandRange(la,ua){ua=ua.clone();ua.height<
la.height&&(ua.bottom=ua.top+la.height-1);ua.width<la.width&&(ua.right=ua.left+la.width-1);return ua}static uii(la){switch(la){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}}static Luj(la,ua){ua=ua.Font;var xa=0!==(ua.ValidMembers&16);const fb=0!==(ua.ValidMembers&16),Jb=0!==(ua.ValidMembers&16);la.bold=0!==(ua.ValidMembers&4);la.italic=0!==(ua.ValidMembers&8);xa&&(la.underline=xa);fb&&(la.doubleUnderline=fb);Jb&&(la.fontStrikethrough=
Jb);la.fontName=ua.FontName;la.fontSize=ua.FontSize;xa=H.a.rp(la.color,la.backgroundColor);Va.a.compare(xa,Va.a.red)&&(Ia.a.y5(la.text)||Ia.a.z$e(la.text))||(ua=Va.a.GH(ua.FontColor),la.color=Vb.e(H.a.BG(ua)))}}Wa.SFh=36;Object(u.a)(Wa,"FormatCellsAction",null,[549,2]);class Ca extends e.a{constructor(la){super();this.$=la;this.Fb()}create(){this.ob(new Wa(this.$))}static ka(la){la.da.Ga(18,new Ca(la))}}Object(u.a)(Ca,"FormatCellsActionFactory",e.a,[]);a.d(E,"a",function(){return Ra});const Ra=()=>
{b.a.Fa(Ca.ka)}},1163:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(1),f=a(15),d=a(196),h=a(78),m=a(37),l=a(47),w=a(46),n=a(640),y=a(28),t=a(118);class r{constructor(){this.startTime=y.a.Qa.zb;this.Kx=new n.a}t1e(){return t.a(y.a.Qa,this.startTime)}}Object(u.a)(r,"OngoingAction",null,[]);class v extends h.a{constructor(Ra,la,ua,xa,fb=null){super();this.SPa=this.Gob=null;this.G_c=0;this.uqc=null;this.ZUi=()=>{const Jb=this.SPa.t1e();f.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.Qla}>.OnRunningLong: Operation running for more than ${Jb}ms`);
this.uqc=l.a.instance.create(this.T6,Math.max(this.Bye-Jb,0),w.a.$me)};this.T6=()=>{f.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.Qla}>.OnTimeout: Operation running for more than ${this.SPa.t1e()}ms, timing out. Has pending actions: ${this.L6a}`);this.G_c++;this.G_c>this.Aye&&f.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.Qla}>.OnTimeout: passed the allowed bypassed count`);this.SPa.Kx.cancel();this.bXe()};this.zR=()=>{this.L6a&&f.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.Qla}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.IMa}, AggregatedActionParams not null: ${this.L6a}`);
this.aod()};this.EEg=Ra;this.FEg=la;this.documentVisibilityObserver=ua;this.Qla=xa;this.KL=fb;ua&&this.documentVisibilityObserver.CGa(this.zR);this.F_c=!!ua&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.Aye=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);la=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.Bye=Ra.ied(la);Ra=
e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.PXg=Math.max(this.Bye-la,0)+Ra}get IMa(){return!!this.SPa}get L6a(){return!!this.Gob}TKf(Ra){f.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.Qla}>.PerformThrottledAction: Start. IsActionOngoing: ${this.IMa}, AggregatedActionParams not null: ${this.L6a}`);this.Gob=this.FEg.BXc(Ra,this.Gob);this.aod()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.mRa(this.zR);
this.iAe();super.dispose()}I3f(Ra){this.F_c?(this.SPa=Ra?new r:null,Ra?this.startTimer():this.iAe()):this.SPa=Ra?{}:null}bXe(Ra=null){this.F_c&&Ra&&Ra.EK?f.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.Qla}>.FinishedCallback: timedout, skipping`):(f.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.Qla}>.FinishedCallback: Start. IsActionOngoing: ${this.IMa}, AggregatedActionParams not null: ${this.L6a}`),this.I3f(!1),this.aod())}aod(){if(!this.lNb()){var Ra=this.Gob;this.Gob=null;
this.I3f(!0);f.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.Qla}>.InternalPerformAction: Calling PerformAction.`);var la=this.F_c?this.SPa.Kx.token:d.a.none;m.TaskExtensions.Aa(this.EEg.GFd(Ra),()=>{this.bXe(la)},la,0,this.KL)}}lNb(){return!this.L6a||this.IMa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.ti?(f.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.Qla}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}iAe(){this.uqc&&this.uqc.cancel()}startTimer(){this.G_c<=
this.Aye&&(this.uqc=l.a.instance.create(this.ZUi,this.PXg,w.a.$me))}}Object(u.a)(v,"ActionAggregator",h.a,[696,2]);var B=a(27),A=a(85),z=a(107),x=a(14),D=a(45),J=a(38),L=a(19),T=a(5),O=a(127),G=a(13),C=a(21),H=a(55);class I extends J.a{constructor(Ra){super();this.Nw=this.firstElement=null;this.fNa=!1;this.Ys=null;this.hAj=B.a.If;this.oDf=la=>{const ua=la.Ca.keyCode;return ua===A.a.Lh?this.FNi():ua===A.a.Yy&&la.Ca.shiftKey?this.fCh(this.firstElement):!1};this.NIf=la=>{if(!this.fNa||la.Ca.keyCode!==
A.a.JG)return!1;I.lbf();H.Task.delay(1).jp(()=>{this.Nw.focus();return!0},0,this.la);return!0};this.tYi=()=>{document.activeElement&&document.activeElement.id===this.Nw.id||(I.lbf(),H.Task.delay(1).jp(()=>{this.Nw.focus();return!0},0,this.la))};this.sBf=()=>{this.Ldg(this.Nw)};this.nDf=la=>{la.stopPropagation();la.preventDefault();this.fNa&&(this.fNa=!1)};this.$=Ra;(Ra=this.$.ea.dc)&&f.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${Ra.vta}; InWebPart = '${Ra.inWebPart?"Classic":
"Non Classic"}', InEmbedView = '${Ra.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);Ra&&(Ra.inWebPart||Ra.inEmbedView)?f.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${Ra.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Ra.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.Eah(),this.Ebh(),z.KeyInputManager.instance.ta(x.a.Pb,this.$.domElement,this.NIf));
this.$.da.Ga(238,this)}TKg(Ra){this.addHandler("KBIS",Ra)}Zfj(Ra){this.removeHandler("KBIS",Ra)}dispose(){this.firstElement&&D.a.removeHandler(this.firstElement,x.a.focus,this.sBf);this.Ys&&this.Ys.detach("focus");this.Nw&&(D.a.removeHandler(this.Nw,x.a.focus,this.nDf),D.a.removeHandler(this.Nw,x.a.blur,I.onBlur),z.KeyInputManager.instance.Ba(x.a.Pb,this.Nw,this.oDf));z.KeyInputManager.instance.Ba(x.a.Pb,this.$.domElement,this.NIf);this.Ys=this.Nw=this.firstElement=this.$=null;super.dispose()}Eah(){this.hAj?
(this.firstElement=document.documentElement,this.Ys=O.a.instance.uH(document.parentWindow),this.Ys.ka("focus",this.tYi)):(this.firstElement=I.dHe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),D.a.addHandler(this.firstElement,x.a.focus,this.sBf))}Ebh(){this.Nw=I.dHe();this.Nw.id=T.a.jOe;this.Nw.setAttribute(T.a.kv,G.a.instance.ga(862));document.body.appendChild(this.Nw);D.a.addHandler(this.Nw,x.a.focus,this.nDf);D.a.addHandler(this.Nw,x.a.blur,I.onBlur);z.KeyInputManager.instance.ta(x.a.Pb,
this.Nw,this.oDf)}fCh(Ra){this.Ldg(Ra);return!1}FNi(){this.fNa=!0;C.h(this.$).focus();C.h(this.$).ha.m9e();this.raiseEvent("KBIS");return!0}Ldg(Ra){this.fNa?this.fNa=!1:(this.fNa=!0,Ra&&Ra.focus())}static dHe(){const Ra=document.createElement("div");Ra.tabIndex=0;return Ra}static lbf(){document.body.classList.add(L.a.RQe)}static onBlur(){document.body.classList.remove(L.a.RQe)}}Object(u.a)(I,"EmbedViewFocusControl",J.a,[695,2]);var M=a(4),Q=a(1081),U=a(61),N=a(521),W=a(24),X=a(42),sa=a(371),da=a(188),
S=a(283),oa=a(116),K=a(29),ea=a(282),ya=a(281),ha=a(60);const La=(Ra,la,ua,xa,fb,Jb,Ob,eb,Ma,va,Pa=null)=>{Pa=Ra.Na(1,Pa);Pa.selectedRange=la;Pa.richValueKeyPath=ua;Pa.singleColumn=xa;Pa.searchForRange=fb;Pa.calculateMajorityDataType=Jb;return ha.g(Ra,"GetRichValueFieldListContextList",Pa,Ob,eb,Ma,va,4)};var Ia=a(33);class ra extends J.a{constructor(Ra,la){super();this.GKb=this.Ofd=this.Jwb=this.wP=null;this.qVb=!1;this.o7d=null;this.sId=!1;this.jPi=(ua,xa,fb)=>{f.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+
fb);this.GKb&&this.GKb.stop();this.wP=null;this.raiseEvent(Q.h)};this.kPi=ua=>{ea.a(ua)||(this.GKb&&this.GKb.stop(),this.qVb=!1,(this.wP=ua.Result)&&0<this.wP.length&&f.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.wP.length} rich value field list context for autocomplete`),this.cXa=!0,this.Ksc())};this.cXa=!1;this.jb=Ra;this.dUb=-1;this.tableManager=la;this.sId=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&Ia.a.zV(Ra)}B_b(Ra){this.addHandler(Q.a,
Ra)}luc(Ra){this.removeHandler(Q.a,Ra)}sKg(Ra){this.addHandler(Q.h,Ra)}Gfj(Ra){this.removeHandler(Q.h,Ra)}get k7a(){return this.cXa}get vxi(){return this.qVb}get OYe(){return this.dUb}get t6c(){return this.o7d}get $(){return this.jb}get al(){return this.wP}get nSh(){return!!this.Jwb}dispose(){this.jb=null;this.Tcb();super.dispose()}j2i(){var Ra=Array(6);var la={};la.Name=Q.f;Ra[0]=la;la={};la.Name=Q.c;Ra[1]=la;la={};la.Name=Q.d;Ra[2]=la;la={};la.Name=Q.g;Ra[3]=la;la={};la.Name=Q.e;Ra[4]=la;la={};
la.Name=Q.b;Ra[5]=la;la={ColumnName:"",ColumnIndex:-1};la.FieldInfoDataList=Ra;Ra=[];Ra[0]=la;this.UQd(Ra)}OZ(Ra,la,ua,xa=null){if(Ra){this.v0c();this.P2b();var fb=null,Jb=!1;if(!xa&&({Mab:Jb,al:fb}=this.JRj(Ra,la,ua)).returnValue)if(this.sId||this.UQd(fb),this.qVb=!0,this.wP=fb,this.sId){if(!Jb){this.cXa=!0;this.Ksc();return}}else if(this.wP&&0<this.wP.length&&(this.cXa=!0,this.Ksc()),!Jb)return;this.zhg(Ra,xa,la,ua,!1)}}zhg(Ra,la,ua,xa,fb){if(this.$.ea.Zb){this.$.Jb&&(this.GKb=this.$.Jb.Ac("WebServiceCall",
"GetRichValueFieldInfoListContext"));this.Jwb=null;var Jb=this.$.pa.ya.Wb();this.Jwb=La(this.$.pa.ya,Ra,la,ua,xa,fb,this.kPi,this.jPi,null,Jb)}else this.wP=null}Tcb(){this.wP=null;this.cXa=!1;this.v0c();this.P2b();this.Jwb=null;this.dUb=-1}v0c(){ra.Oqb(this.Jwb)}P2b(){ra.Oqb(this.Ofd)}Ksc(){this.raiseEvent(Q.a)}Cn(Ra){Ra=X.D(Ra);--Ra.left;--Ra.right;return this.tableManager.Cn(Ra)}WKa(Ra){Ra.FirstColumn=Ra.FirstColumn;Ra.LastColumn=Ra.LastColumn;Ra.FirstRow=Ra.FirstRow;Ra.LastRow=Ra.LastRow;this.P2b();
this.Ofd=null;return sa.a(this.$.userOperationManager,(la,ua,xa)=>S.i(this.$.pa.ya,Ra,ya.b(la,fb=>{this.tPi(fb)}),ya.a(ua,ua,fb=>{this.sPi(fb)}),xa,null),la=>new da.a(264,0,la,80),null)}sPi(Ra){Ra=oa.a.Pe(Ra.data);f.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${K.a.sc(Ra)}`)}tPi(Ra){if(ea.a(Ra))-315732528!==Ra.Errors[0].MessageId&&f.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${K.a.sc(Ra.Errors)}`);
else if(Ra&&Ra.Result){Ra=Ra.Result;var la=Ra.HasHeaderRow;la=new N.AutofilterRange(Ra.TableRange.FirstRow+(la?1:0)+1,Ra.TableRange.FirstColumn+1,Ra.TableRange.LastRow+1,Ra.TableRange.LastColumn+1,null,null,null,0,la);this.dUb=Ra.TableRange.FirstColumn;(Ra=this.WNf(!1,!0,la))||f.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.UQd(Ra)}else f.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}JRj(Ra,
la,ua){let xa,fb;fb=null;xa=!1;if(Ra.SheetName!==this.$.ea.oa.sheetName)return{returnValue:!1,Mab:xa,WKa:!1,al:fb};let Jb;this.dUb=-1;if(ua){Jb=this.Cn(Ra);if(!Jb||!Jb.pba)return{returnValue:!1,Mab:xa,WKa:!1,al:fb};var Ob=C.h(this.$).Bb.J5e(Jb);this.o7d=Jb;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Ob&&0<Ob.count)return--Ra.FirstColumn,--Ra.LastColumn,this.Ofd=this.WKa(Ra),{returnValue:!0,Mab:xa,WKa:!0,al:fb};Jb.top+=1;
Jb.right=X.D(Ra).right-1}else Jb=new N.AutofilterRange(Ra.FirstRow+1,Ra.FirstColumn+1,Ra.LastRow+1,Ra.LastColumn+1,null,null,null,0,!1);if(Jb.top>Jb.bottom||Jb.left>Jb.right)return{returnValue:!0,Mab:xa,WKa:!1,al:fb};Ra=C.h(this.$);var eb=Ra.ib.width,Ma=Ra.ib.height;Ob=Ra.view.visibleArea;eb=new U.a(Ob.x-eb,Ob.y-Ma,Ob.width+eb,Ob.height+Ma);Ma=Ra.fg(Jb);if(!Ob||!Ma||!Ra.$ic(Jb))return{returnValue:!1,Mab:xa,WKa:!1,al:fb};eb.contains(Ma)||(xa=!0);fb=this.WNf(la,ua,Jb);return{returnValue:!0,Mab:xa,WKa:!1,
al:fb}}UQd(Ra){Ra&&f.ULS.sendTraceTag(25264348,0,50,`Retrieved ${Ra.length} rich value field contexts from block cache`);this.qVb=!0;(this.wP=Ra)&&0<this.wP.length&&(this.cXa=!0,this.Ksc())}WNf(Ra,la,ua){let xa;xa=null;const fb=ua.clone();if(la)for(let Jb=ua.right,Ob=0;Jb>=ua.left;--Jb){if(fb.left=Jb,fb.right=Jb,la=this.I1e(fb,!0,ua.left)){xa||(xa=[]);xa[Ob]=la;if(Ra)break;++Ob}}else if(Ra=this.I1e(fb,!1))xa=[],xa[0]=Ra;return xa}I1e(Ra,la,ua=0){var xa=null;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var fb=
C.h(this.$).Bb.y_h(Ra);if(fb&&0<fb.count){var Jb=Array(fb.count);xa=0;for(var Ob of fb.values)fb={},fb.Name=Ob,Jb[xa]=fb,++xa;Ob="";fb=-1;0<Ra.top&&la&&(Ra=new W.Range(Ra.top-1,Ra.left,Ra.top-1,Ra.left,!1,!1),null!=C.h(this.$).Sb(Ra)&&null!=C.h(this.$).Sb(Ra).originalText&&(Ob=C.h(this.$).Sb(Ra).originalText),fb=Ra.left-ua);xa={};xa.ColumnName=Ob;xa.ColumnIndex=fb;xa.FieldInfoDataList=Jb}}else if((Ob=C.h(this.$).Bb.J5e(Ra))&&0<Ob.count){Jb=Array(Ob.count);xa=0;for(fb of Ob)Ob={},Ob.Name=fb,Jb[xa]=
Ob,++xa;Ob="";fb=-1;0<Ra.top&&la&&(Ra=new W.Range(Ra.top-1,Ra.left,Ra.top-1,Ra.left,!1,!1),Ob=C.h(this.$).Sb(Ra).originalText,fb=Ra.left-ua);xa={};xa.ColumnName=Ob;xa.ColumnIndex=fb;xa.FieldInfoDataList=Jb}return xa}static Oqb(Ra){Ra&&M.AFrameworkApplication.Dd.Ru(Ra.lu)}}Object(u.a)(ra,"FieldInfoManager",J.a,[444,2]);class pa extends ra{constructor(Ra,la,ua,xa){super(Ra,la);this.J2a=null;this.mBf=()=>{this.luc(this.mBf);if(this.al&&this.al.length&&this.contextMenuManager){var fb=this.contextMenuManager.bfd("autoFilterRichFieldList"),
Jb=window.document.getElementById(this.J2a);fb.Y0(null,Jb,this,null,!0)}};this.Sqg=ua;this.contextMenuManager=xa}get mH(){return this.Sqg}xSh(Ra,la){this.J2a=la;f.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${Ra.FirstRow}, ${Ra.FirstColumn}, ${Ra.LastRow}, ${Ra.LastColumn})`);this.zhg(Ra,null,!0,!1,!0)}}Object(u.a)(pa,"FilterInfoManager",ra,[445,444,2]);var ba=a(837),fa=a(1093),Ka=a(30),
aa=a(87),ja=a(8);class Va{}Va.jwh="ewa-sharedUi-launchButton";Va.mwh="ewa-sharedUi-launchButtonWithText";Va.kwh="ewa-sharedUi-launchButtonClick";Va.nwh="ewa-sharedUi-launchButtonWithTextClick";Va.lwh="ewa-sharedUi-launchButtonText";Object(u.a)(Va,"CssClassNames",null,[]);var bb=a(64);a(516);var wa=a(239),ka=a(224);J=a(238);var ta=a(286),qa=a(71),rb=a(11),Za=a(251),gb=a(34);class mb extends J.a{constructor(Ra,la,ua,xa,fb,Jb,Ob,eb,Ma){super(document.createElement("div"));this.Unf=null;this.gVd=!1;this.htmlSanitizationHelper=
this.OOb=this.uTa=null;this.dO=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.cO=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.tGj=()=>{this.kne()};this.gd=va=>{this.raiseEvent(this.IHb,va);this.HHb();return!0};this.lNi=va=>{100<t.a(y.a.Qa,this.Unf)&&this.ikd(new Sys.UI.Point(Math.round(va.clientX),Math.round(va.clientY)))};this.ZN=va=>{qa.g(va.Ca,!1);return!1};this.tZ=this.Ce.DIa();this.set_visible(!1);this.Ajc=fb;this.IHb=Jb;this.snc=Ra;this.R3b=la;this.htmlSanitizationHelper=Ma;this.Ajc&&
(this.uTa=l.a.instance.create(this.tGj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));Ra&&this.domElement.classList.add(Ra);this.zHa=document.createElement("div");this.domElement.appendChild(this.zHa);ua&&this.zHa.classList.add(ua);this.Y_d(xa);Ob&&(this.OOb=document.createElement("div"),this.domElement.appendChild(this.OOb),this.OOb.classList.add(eb),this.OOb.innerText=Ob,this.domElement.style.padding="3px",wa.a.instance.ta(x.a.pointerDown,this.domElement,this.ZN));this.W_a=new ta.a(this.domElement,
7);ka.a.instance.ta(x.a.click,this.domElement,this.gd);e.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&wa.a.instance.ta(x.a.pointerDown,this.domElement,this.ZN);Ra=va=>{qa.g(va)};this.Gc.ka("mouseup",Ra);this.Gc.ka("click",Ra);this.Gc.ka("dblclick",Ra)}O2(Ra){this.addHandler(this.IHb,Ra)}Hda(Ra){this.get_events().removeHandler(this.IHb,Ra)}jLg(Ra){this.addHandler("OnObjectButtonMouseOver",Ra)}pgj(Ra){this.get_events().removeHandler("OnObjectButtonMouseOver",
Ra)}iLg(Ra){this.addHandler("OnObjectButtonMouseOut",Ra)}ogj(Ra){this.get_events().removeHandler("OnObjectButtonMouseOut",Ra)}Y_d(Ra){Ra&&(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?this.htmlSanitizationHelper.dk(this.zHa,Ra):this.zHa.innerHTML=Ra)}cVj(Ra,la,ua){e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?
this.htmlSanitizationHelper.gU(this.zHa):this.zHa.innerHTML="";Ra?Ra.Aba(la,16,16,this.zHa,16,16,void 0,ua):f.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}dVj(Ra,la){Ra&&(this.OOb.innerText=Ra);this.domElement.title=la}dispose(){this.get_isInitialized()&&(this.hide(),this.Gc.dD(),aa.a.qc([this.tZ,this.W_a]),ka.a.instance.Ba(x.a.click,this.domElement,this.gd),wa.a.instance.Ba(x.a.pointerDown,this.domElement,this.ZN),this.uTa&&this.uTa.dispose(),
super.dispose())}Rcb(){this.R3b&&this.domElement.classList.remove(this.R3b);this.snc&&this.domElement.classList.add(this.snc)}HHb(){this.snc&&this.domElement.classList.remove(this.snc);this.R3b&&this.domElement.classList.add(this.R3b);this.W2a()}W2a(){this.Ajc&&(this.uTa.cancel(),this.P$f(),this.setOpacity(1));this.set_visible(!0)}Qp(Ra,la,ua,xa,fb=!1){Ra=gb.a(xa).zi(Ra);la=gb.a(xa).zi(la);gb.a(xa).Wxc(this.domElement);this.domElement.style.top=rb.HelperMethods.uc(la);this.domElement.style.left=this.domElement.style.right=
"";la=Ra;fb&&(la=Ra-this.domElement.offsetWidth);Za.c(this.domElement.style,ua,rb.HelperMethods.uc(la));this.set_visible(!0);this.setOpacity(1);this.Ajc&&(this.gVd=!1,this.nJj(),this.uTa.sq())}hide(){this.Rcb();this.set_visible(!1);this.Ajc&&(this.P$f(),this.uTa.cancel())}T8b(){this.Gc.ka("mouseover",this.dO,!0);this.Gc.ka("mouseout",this.cO,!0)}nJj(){this.tZ.Pi("mousemove")||this.tZ.ka("mousemove",this.lNi)}P$f(){this.tZ.Pi("mousemove")&&this.tZ.detach("mousemove")}ikd(Ra){if(this.domElement.parentNode){var la=
Sys.UI.DomElement.getBounds(this.domElement);const ua=new Sys.UI.Point(Math.round(la.x+la.width),Math.round(la.y+la.height));la=Math.abs(ua.x-Ra.x);Ra=Math.abs(ua.y-Ra.y);Ra=la>Ra?la:Ra;this.gVd?this.setOpacity(mb.RYg(Ra)):100>=Ra&&this.kne()}}kne(){this.gVd=!0;this.uTa.cancel()}setOpacity(Ra){B.a.setOpacity(this.domElement,Ra);this.Unf=y.a.Qa.zb}static RYg(Ra){return 100>=Ra?1:250<=Ra?0:.01*(100-(Ra-100)/150*100)}}Object(u.a)(mb,"OnObjectButton",J.a,[707,164,2]);var Ga=a(790);const ib=Va.lwh;class cc extends h.a{constructor(Ra,
la,ua,xa,fb,Jb,Ob,eb,Ma=""){super();this.Lka=null;this.Qbf=!1;this.htmlSanitizationHelper=this.Rmc=this.Smc=null;this.buttons={};this.UPe={};this.$=Ra;this.svgIconProvider=la;this.GLi=ua;this.Gfc=xa;this.Ffc=fb;this.altText=Jb;this.IHb=Ob;this.htmlSanitizationHelper=eb;this.buttonText=Ma}get zz(){return gb.a(this.$).UGa(ja.a.pTi)}get p3b(){return ja.a.oTi}get buttonWidth(){return gb.a(this.$).UGa(ja.a.qTi)}dispose(){this.Klh();this.$=null;super.dispose()}getButton(Ra,la=!0){return this.Hva(Ra,la)}Hva(Ra,
la=!0){const ua=Ra.toString();ua in this.buttons||this.Gbh(Ra,la);return this.buttons[ua]}Qp(Ra,la,ua,xa,fb=!0,Jb=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&bb.i(this.$.oa)){var Ob=C.h(this.$).iS.domElement;const eb=Ra+this.buttonWidth-Ob.scrollWidth;Ob=la+this.buttonWidth-Ob.scrollHeight;Ra=0<eb?Ra-eb:Ra;la=0<Ob?la-Ob:la}this.Hva(xa,fb).Qp(Ra,la,ua,this.$,Jb)}hide(){const Ra=this.buttons;for(let la in Ra)Ra[la].hide()}T8b(Ra,la){!this.Qbf&&(la=this.buttons[la.toString()])&&(this.Smc=(ua,
xa)=>{Ra(xa,!0)},la.jLg(this.Smc),this.Rmc=(ua,xa)=>{Ra(xa,!1)},la.iLg(this.Rmc),this.Qbf=!0,la.T8b())}Gbh(Ra,la){this.Lka=String.format(this.Gfc===L.a.K9b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Ka.a.Gg(this.Gfc),Ka.a.Gg(this.Ffc),"{0}");var ua=String.format(this.Lka,Ka.a.Gg(this.altText));la=new mb(""===this.buttonText?Va.jwh:Va.mwh,""===this.buttonText?Va.kwh:Va.nwh,L.a.qv,
ua,la,this.IHb,this.buttonText,ib,this.htmlSanitizationHelper);ua=(xa,fb)=>{this.GLi(fb,Ra)};la.O2(ua);this.buttons[Ra.toString()]=la;this.UPe[Ra.toString()]=ua;ua=C.h(this.$).Bf(Ra);ua.domElement.insertBefore(la.domElement,ua.domElement.firstChild)}Klh(){for(const Ra of Ga.a(this.buttons)){const la=this.buttons[Ra];la.Hda(this.UPe[Ra]);aa.a.Ia(la);delete this.buttons[Ra];this.Smc&&la.pgj(this.Smc);this.Rmc&&la.ogj(this.Rmc)}}domElement(Ra){return this.Hva(Ra).domElement}W2a(Ra){this.Hva(Ra).W2a()}whg(Ra,
la){this.Gfc=Ra;this.Ffc=la}nQb(Ra,la,ua=!0){this.Lka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Ka.a.Gg(this.Gfc),Ka.a.Gg(this.Ffc),"{0}");Ra=String.format(this.Lka,Ka.a.Gg(Ra));this.Hva(la,ua).Y_d(Ra)}RUa(Ra,la,ua){this.Hva(ua,!1).dVj(Ra,la)}uhg(){this.Lka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Ka.a.Gg(this.Ffc),"{1}");const Ra=String.format(this.Lka,void 0,
Ka.a.Gg(void 0));this.Hva(void 0,!1).Y_d(Ra)}vhg(Ra,la,ua){this.Hva(ua,!1).cVj(this.svgIconProvider,Ra,la)}}Object(u.a)(cc,"OnObjectLaunchButton",h.a,[694,2]);h=a(94);class ic extends h.a{constructor(Ra,la){super(Ra);this.pDb=null;this.ulh=()=>{this.display()};this.Wbi=Math.max(1,la)}dispose(){aa.a.Ia(this.pDb);this.pDb=null;super.dispose()}KTa(){aa.a.Ia(this.pDb);this.pDb=l.a.instance.create(this.ulh,this.Wbi,w.a.zxi)}QTa(){aa.a.Ia(this.pDb);this.hide()}}Object(u.a)(ic,"LoadingIndicatorBehavior",
h.a,[705,2]);class xb extends ic{constructor(Ra,la,ua,xa){super(Ra,la);this.oDb=null;this.otg=ua;this.h$h=xa;this.WGg()}dispose(){this.oDb=null;super.dispose()}display(){this.otg(this.oDb)}hide(){this.h$h(this.oDb)}WGg(){this.oDb=document.createElement("div");this.domElement.appendChild(this.oDb)}}Object(u.a)(xb,"ShimmerLoadingIndicatorBehavior",ic,[]);var Vb=a(68),wb=a(53),cb=a(12);class lb extends ic{constructor(Ra,la,ua,xa=null,fb=null,Jb=0){super(Ra,la);this.Rwa=this.wOa=null;this.Rwa=ua;this.Lfc=
xa||wb.a.current.fo(104);this.Hpf=Jb;this.y6c=fb;this.VGg()}dispose(){this.wOa=null;super.dispose()}display(){cb.DOMElementExtensions.setVisible(this.wOa,!0)}hide(){cb.DOMElementExtensions.setVisible(this.wOa,!1)}VGg(){this.wOa=document.createElement("div");this.wOa.classList.add(Vb.a.Xuh);const Ra=document.createElement("div");Ra.classList.add(Vb.a.Yuh);this.y6c&&""!=this.y6c&&Ra.classList.add(this.y6c);var la=0===this.Hpf?"":G.a.instance.ga(this.Hpf);const ua=String.format('<div class="'+Vb.a.Zuh+
'">{0}</div>',la);this.Lfc?(la=`<img src="${this.Lfc}" alt="${la}" title="${la}"/>`,this.Rwa?this.Rwa.dk(Ra,la+ua):Ra.innerHTML=la+ua):this.Rwa?this.Rwa.dk(Ra,ua):Ra.innerHTML=ua;this.wOa.appendChild(Ra);this.domElement.appendChild(this.wOa)}}Object(u.a)(lb,"SpinnerLoadingIndicatorBehavior",ic,[]);class Y{constructor(Ra){this.Rwa=Ra}y5c(Ra,la,ua){return new ba.a(Ra,la,ua)}O5b(Ra,la,ua,xa,fb,Jb,Ob,eb,Ma,va){return new fa.a(Ra,la,ua,xa,fb,Jb,Ob,eb,Ma,va)}Ksb(Ra,la,ua,xa,fb=0){return new lb(Ra,la,this.Rwa,
ua,xa,fb)}lhd(Ra){return Ra.da.za(238)||new I(Ra)}R5b(Ra,la,ua,xa,fb,Jb,Ob,eb=""){return new cc(Ra,la,ua,xa,fb,Jb,Ob,this.Rwa,eb)}a5c(Ra,la){return new ra(Ra,la)}zah(Ra,la,ua,xa){return new pa(Ra,la,ua,xa)}H4c(Ra,la,ua,xa){return new v(Ra,la,ua,xa)}}Object(u.a)(Y,"SharedUIControlsFactory",null,[664]);var Oa=a(50);class Wa extends b.a{constructor(Ra){super();this.$=Ra;this.Fb()}create(){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7134912_ReduceInnerHTMLUsageSpinnerLoading")){const Ra=
Oa.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya);m.TaskExtensions.Aa(Ra,()=>{e.EwaSettings.nl()?this.ob(this.$.da.za(12)||new Y(Ra.result)):this.ob(new Y(Ra.result))},this.la,3)}else e.EwaSettings.nl()?this.ob(this.$.da.za(12)||new Y(null)):this.ob(new Y(null))}static ka(Ra){Ra.da.Ga(477,new Wa(Ra))}}Object(u.a)(Wa,"SharedUIControlsFactoryServiceFactory",b.a,[]);a.d(E,"a",function(){return Ca});const Ca=()=>{c.a.Fa(Wa.ka)}},1167:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(50),f=a(37),
d=a(1),h=a(811);class m extends b.a{constructor(va){super();this.$=va;this.Fb()}create(){const va=e.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Ya),Pa=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Ed([va,Pa],this.la),()=>{this.ob(this.$.da.za(296)||this.$.da.Ga(296,new h.BorderFormatManager(this.$,va.result,Pa.result)))},this.la,3)}static ka(va){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&va.da.Ga(468,
new m(va))}}Object(u.a)(m,"BorderFormatManagerFactory",b.a,[]);var l=a(692),w=a(15),n=a(263),y=a(170),t=a(824),r=a(27),v=a(40),B=a(30),A=a(95),z=a(260),x=a(354),D=a(351),J=a(97),L=a(187),T=a(8),O;(function(va){va[va.insert=1]="insert";va[va.delete=2]="delete";va[va.rows=4]="rows";va[va.columns=8]="columns";va[va.cellsShiftHorizontal=16]="cellsShiftHorizontal";va[va.cellsShiftVertical=32]="cellsShiftVertical";va[va.insertRows=5]="insertRows";va[va.insertColumns=9]="insertColumns";va[va.insertCellsShiftRight=
17]="insertCellsShiftRight";va[va.insertCellsShiftDown=33]="insertCellsShiftDown";va[va.deleteRows=6]="deleteRows";va[va.deleteColumns=10]="deleteColumns";va[va.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";va[va.deleteCellsShiftUp=34]="deleteCellsShiftUp";va[va.insertRowsBelow=37]="insertRowsBelow"})(O||(O={}));Object(u.b)("InsertDeleteCellFlags",O);var G=a(5),C=a(423),H=a(64),I=a(76);class M{constructor(va){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=va}}Object(u.a)(M,
"MacroRecorderRangeInsertedOrDeletedPayload",null,[137]);var Q=a(1079),U=a(42),N=a(371),W=a(188),X=a(60),sa=a(283),da=a(142),S=a(459),oa=a(113),K=a(53),ea=a(198),ya=a(91),ha=a(35),La=a(29),Ia=a(282),ra=a(257),pa=a(11),ba=a(183),fa=a(22),Ka=a(281);class aa{constructor(va,Pa,Ha,tb,Ya=0){this.wug=va;this.xug=Pa;this.jCg=Ha;this.bYb=tb;this.nHh=Ya}get wja(){return this.wug}get formattedText(){return this.xug}get style(){return this.jCg}get size(){return this.bYb}get JZ(){return this.nHh}static yWg(va,
Pa){return new aa(va,Pa,null,null,null)}static y_c(va,Pa){return new aa(va,null,Pa,null,null)}static zWg(va,Pa){return new aa(va,null,null,Pa,null)}static xWg(va,Pa,Ha){return new aa(va,null,Pa,null,Ha)}}Object(u.a)(aa,"CachedPreviewCellGroup",null,[]);var ja=a(83);b=a(284);var Va=a(99),bb=a(13);class wa extends b.a{constructor(va,Pa,Ha){super(va);this.Pl=null;this.R7c=0;this.Rfi=(tb,Ya)=>{if(0===tb)w.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");
else{tb={};var V="",za=1035996630;switch(Ya.selectedKey){case 0:V=1896159024===this.Mr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:V=1896159024===this.Mr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.Mr?(V="InsertRows",za=-1113896058):(V="DeleteRows",za=1554436520);break;case 3:1896159024===this.Mr?(V="InsertColumns",za=1415868706):(V="DeleteColumns",za=674605324)}w.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${V}`);
Ya=new ya.a(za,1,2,8,null);tb[I.a.Jc]=V;this.$.Ja.Kb(Ya,tb)}};this.Mr=Pa;this.selectedRanges=Ha;this.isRtl=Object(ja.a)(Va.a,this.$.xa.oa).displayRtl}get pc(){return"InsertDeleteCellsDialog"}gg(){1896159024===this.Mr?(this.Pl=bb.a.instance.ga(23),this.R7c=0):(this.Pl=bb.a.instance.ga(22),this.R7c=1);const va=this.selectedRanges[0].y_&&!this.selectedRanges[0].R5?0:1;this.Rb=1;this.initializeAndShow(this.Pl,this.Rfi,{[wa.uu]:this.pc,["dialogToDisplay"]:this.R7c,["defaultSelectedKey"]:va,["isRtl"]:this.isRtl})}}
Object(u.a)(wa,"InsertDeleteCellsDialog",b.a,[]);const ka=(va,Pa,Ha,tb,Ya,V,za=null)=>{za=va.Na(41,za);za.insertDeleteMultiRangeParameters=Pa;return X.g(va,"InsertDeleteCells",za,Ha,tb,Ya,V,0)};class ta{constructor(va,Pa,Ha,tb){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=va;this.targetSheetRange=Pa;this.fillRangeType=Ha;this.fillRangeDirection=tb}}Object(u.a)(ta,"MacroRecorderRangeFilledPayload",null,[137]);var qa=a(7),rb=a(24);
class Za{constructor(){this.MRa=this.tHa=this.kOa=this.xUa=0}}Object(u.a)(Za,"RangeBorders",null,[]);class gb{constructor(){this.scenario=0;this.GQ=null}}Object(u.a)(gb,"ScenarioInfo",null,[]);var mb=a(907),Ga=a(21),ib=a(262),cc=a(208),ic=a(79);class xb{constructor(va,Pa){this.$=va;this.Ag=Pa;this.Ix=new mb.a(Ga.h(this.$).Ea,this.$);this.cAb=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.Rqd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");
this.pic=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.aif=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.kki=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.cmf=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.Zic=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");
this.QAb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.qic=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.Cni=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.rki=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.Xff=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");
this.Xhf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.Uni=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.jti=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=null}qki(va,Pa){return!(void 0===Pa||null===Pa)&&!!(Pa.scenario&16384)&&!this.ski(va,Pa)&&this.Qff(Pa,va)}C3e(){var va=v.a.Ud(),Pa=Ga.h(this.$),Ha=Pa.ha.ra.selectedRanges;let tb=0;var Ya=
0,V=Ha.length;const za=new gb;if(1<V)return za.scenario=4,za;if(this.Xhf&&Pa.Xd.Gic(Ha[0]))return za.scenario=262144,za;this.Rqd&&Ga.h(this.$).rtl&&(tb|=65536);if(!Pa.IK(Ha[0]))if(this.cAb)tb|=32;else return za.scenario=32,za;if(Pa=Pa.Ea.Xva(Ha[0],this.$.activeItemName)){za.TZc=Pa;for(var yb of Pa)if(Ya+=1,1<Ya){this.cAb?(tb|=256,za.scenario=tb):za.scenario=256;if(!this.QAb)return za;break}}Ya=Ga.h(this.$).Ea.Hja(Ha[0]);if(!Ya)return za.scenario=32768,za;yb=Ya.length;Ha=Ha[0];Pa=Ha.bottom-Ha.top+
1;V=Ha.right-Ha.left+1;const jc=new Za;for(let Cc=0;Cc<yb;Cc++)if(this.oZh(Ya[Cc],Ha,jc),tb=tb|(void 0!==Ya[Cc].text&&null!==Ya[Cc].text&&""!==Ya[Cc].text?1:0)|(Ya[Cc].PF?2:0)|(Ya[Cc].Bwa?8:0)|(Ya[Cc].hyb?16:0)|(Ya[Cc].qB?64:0)|(Ya[Cc].oV?128:0),void 0!==Ya[Cc].text&&null!==Ya[Cc].text&&""!==Ya[Cc].text||Ya[Cc].Bwa)if(void 0===za.GQ||null===za.GQ)za.GQ=Ga.h(this.$).Sb(Ya[Cc].getRange());else{if(Ya[Cc].getRange().top<za.GQ.range.top||Ya[Cc].getRange().top==za.GQ.range.top&&Ya[Cc].getRange().left<za.GQ.range.left)za.GQ=
Ga.h(this.$).Sb(Ya[Cc].getRange());tb|=16384}jc.xUa===V&&(tb|=512);jc.tHa===V&&(tb|=2048);jc.kOa===Pa&&(tb|=4096);jc.MRa===Pa&&(tb|=1024);if(0<jc.xUa&&jc.xUa<V||0<jc.tHa&&jc.tHa<V||0<jc.kOa&&jc.kOa<Pa||0<jc.MRa&&jc.MRa<Pa)tb|=8192;!d.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Ha.right!==Ha.maxColumns&&Ha.bottom!==Ha.maxRows||(tb|=131072);va=v.a.Ud()-va;w.ULS.sendTraceTag(537159424,0,50,`Execution time of GetMergeCellScenario is : ${va}`);za.scenario=
tb;return za}muf(va,Pa){const Ha=va.command;if(void 0===Pa||null===Pa)Pa=this.C3e();if(!this.Qff(Pa,Ha))return!1;va=Ga.h(this.$).ha.ra.selectedRanges;var tb=Ga.h(this.$).Ea.Hja(va[0]);if(!tb)return!1;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===tb.length&&!tb[0].PF)return-167499203===Ha?(tb[0].S0(2,!0),!0):!1;tb=Ga.h(this.$).ha.ra.Bs;const Ya=this.$.oa.sheetName;let V=!0;switch(Ha){case -167499203:2===(Pa.scenario&2)&&this.pic?this.Gfg(Pa.scenario,va,
Ha):V=this.pEi(Pa,va);break;case 1097660126:(Pa=this.nuf(Pa,va))&&0!=Pa.length||(V=!1);break;case 155820588:this.Gfg(Pa.scenario,va,Ha);break;default:return!1}Ga.h(this.$).P4(va,tb,Ya,null,va[0],null,null,0,"MergeCellCommandAction");return this.QAb?V:!0}Qff(va,Pa){const Ha=this.fji(va,Pa);if(!this.aif)return Ha;const tb=Ga.h(this.$).ha.ra.selectedRanges[0].Ew(!1);w.ULS.sendTraceTag(526149324,0,50,`Merge Cell Command: ${Pa.toString()}; Scenario Number: ${va.scenario}; IsCSEPossible result: ${Ha}; Range: ${tb}`);
return Ha}fji(va,Pa){if(-255094134===Pa)return!1;var Ha=va.scenario;if(this.Xhf&&262144===Ha||this.Rqd&&65536===(Ha&65536))return!1;if(this.bmf(Pa,va))return Ha=Ga.h(this.$).ha.ra.selectedRanges,0===Ha.length?!1:this.qsi(Pa,va,Ha[0]);this.cAb&&32===(Ha&32)&&(Ha&=-33);if(256==(Ha&256))if(this.Tni(va))Ha&=-257;else return!1;return 32768===Ha||4===Ha||128===(Ha&128)||!this.cAb&&32===Ha?!1:-167499203!=Pa&&1097660126!==Pa||!this.Iod(va)?void 0!==va.GQ&&null!==va.GQ&&va.GQ.FX?!1:0===Ha?!0:16384===(Ha&16384)?
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(Ha&1)&&8!==(Ha&8)||!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.qic}eli(va){return 131072===(va.scenario&131072)?!0:!1}Tni(va){if(!this.QAb)return!1;let Pa="Multi block",Ha=!0;this.Iod(va)&&(Pa+=" with border",Ha=!1);this.eli(va)&&(Ha=!1,Pa+=" with entire row or column selected",16384===(va.scenario&16384)&&(Pa+=" and a data loss scenario"));
Ha||w.ULS.sendTraceTag(523511383,0,50,`CSE for ${Pa}, is not enabled`);return Ha}Iod(va){return 16===(va.scenario&16)||this.Fkd(va.scenario)||this.Ykd(va.scenario)||this.Rkd(va.scenario)||this.$kd(va.scenario)||8192===(va.scenario&8192)?!0:!1}ski(va,Pa){return this.rki?this.bmf(va,Pa):155820588===va}bmf(va,Pa){return 155820588===va||(-167499203===va||1097660126===va)&&2===(Pa.scenario&2)&&this.pic?!0:!1}psi(va){return this.$kd(va.scenario)||this.Rkd(va.scenario)||this.Fkd(va.scenario)||this.Ykd(va.scenario)?
!0:!1}i9h(va){va=Ga.h(this.$).Ea.Hja(va);if(!va||0===va.length)return!1;for(let Pa=0;Pa<va.length;Pa++)if(va[Pa].PF&&va[Pa].FX)return!0;return!1}qsi(va,Pa,Ha){if(1097660126===va&&2===(Pa.scenario&2))return!1;if(this.jti){if(this.i9h(Ha))return!1}else if(this.kki&&void 0!==Pa.GQ&&null!==Pa.GQ&&Pa.GQ.FX)return!1;this.cAb&&32===(Pa.scenario&32)&&(Pa.scenario&=-33);return 32768===Pa.scenario||4===Pa.scenario||256===(Pa.scenario&256)&&this.Cni||128===(Pa.scenario&128)?!1:2===(Pa.scenario&2)?this.psi(Pa)?
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1}oZh(va,Pa,Ha){const tb=va.getRange();if(tb.top===Pa.top)if(va.$La)Ha.xUa+=tb.right-tb.left+1;else{var Ya=this.Ix.KQ(tb,0);if(Ya)for(const za of Ya)za.ULa&&(Ha.xUa+=za.getRange().right-za.getRange().left+1)}if(tb.left===Pa.left)if(va.WLa)Ha.kOa+=tb.bottom-tb.top+1;else if(Ya=this.Ix.KQ(tb,
2))for(var V of Ya)V.YLa&&(Ha.kOa+=V.getRange().bottom-V.getRange().top+1);if(tb.bottom===Pa.bottom)if(va.ULa)Ha.tHa+=tb.right-tb.left+1;else if(V=this.Ix.KQ(tb,1))for(const za of V)za.$La&&(Ha.tHa+=za.getRange().right-za.getRange().left+1);if(tb.right===Pa.right)if(va.YLa)Ha.MRa+=tb.bottom-tb.top+1;else if(va=this.Ix.KQ(tb,3))for(const za of va)za.WLa&&(Ha.MRa+=za.getRange().bottom-za.getRange().top+1)}rdj(va,Pa){for(let Ha of Pa.TZc){Pa=va.Ke(Ha.qf);Pa=Ga.h(this.$).Ea.Hja(Pa);const tb=Pa.length;
for(let Ya=1;Ya<tb;Ya++){const V=Ga.h(this.$).Sb(Pa[Ya].getRange());this.qic?V.cell.deleteCellFromModel():(V.hrb(),V.clearFormat(),V.cell.sdj());V.qJb(!0)}}}zYj(va,Pa){va.backgroundColor=Pa.backgroundColor;va.color=Pa.color}Qmg(va,Pa){return{SpansBlocks:!0,OriginRow:va,OriginColumn:Pa,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}FFg(va,Pa,Ha,tb,Ya){Ha=va.Ke(Ha.qf);if(!Ha)return w.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),
null;var V=new rb.Range(va.top,va.left,Ha.top,Ha.left,!1,!1);let za;Ha.top==va.top?za=0:(V.bottom=Ha.top-1,za=Pa.Ghd(V));Ha.left==va.left?V=0:(V.right=Ha.left-1,V=Pa.Hhd(V));Pa=this.Qmg(va.top-1,va.left-1);Pa.OriginDeltaY=za;Pa.OriginDeltaX=V;Pa.Rows=Ha.bottom-Ha.top;Pa.Columns=Ha.right-Ha.left;Pa.Height=Ya;Pa.Width=tb;Ha.top==va.top&&Ha.left==va.left&&(Pa.IsOrigin=!0);va=Ga.h(this.$).Sb(Ha.topLeft);va.cell.w3f(Pa);return va}vRd(va,Pa){let Ha=[];const tb=Ga.h(this.$).Xd;if(!tb)return Ha;const Ya=
tb.Ghd(va),V=tb.Hhd(va);if(Pa.TZc)for(const za of Pa.TZc)if(Pa=this.FFg(va,tb,za,V,Ya))Ha.push(Pa);else{Ha=[];break}return Ha}p_h(va,Pa,Ha,tb){var Ya=Ha.bottom-Ha.top,V=Ha.right-Ha.left;let za=[];const yb=tb.scenario;if(256===(yb&256)){if(za=this.vRd(Ha,tb),!za||0==za.length)return za}else Pa.cell.vRd(Ya,V),za.push(Pa);Ya=this.q3(this.i5(Pa),!0,0,yb,"merge");if(void 0!==va&&null!==va)for(const jc of za){V=va.cell.formattedText;const Cc=Object(qa.a)(new ib.a,{TextRuns:V.TextRuns,Fonts:V.Fonts});Cc.Text=
void 0!==va.cell.originalText&&null!==va.cell.originalText?va.cell.originalText:void 0!==va.cell.userInput&&null!==va.cell.userInput?va.cell.userInput:V.Text;Ya=this.q3(this.i5(jc),Ya,1,yb,"merge");this.Ag.kTa(jc,Cc,!1,!0,"MergeCells",1);Ya=this.q3(this.i5(jc),Ya,2,yb,"merge");this.Rqd?jc.rrb(va):this.zYj(jc,va);Ya=this.q3(this.i5(jc),Ya,3,yb,"merge");jc.cell.M8g(va.cell);Ya=this.q3(this.i5(jc),Ya,4,yb,"merge");jc.cell.QDc(!1);Ya=this.q3(this.i5(jc),Ya,6,yb,"merge")}this.rdj(Ha,tb);this.q3(this.i5(Pa),
Ya,5,yb,"merge");return za}Rkd(va){return 4096===(va&4096)}$kd(va){return 512===(va&512)}Fkd(va){return 2048===(va&2048)}Ykd(va){return 1024===(va&1024)}ubc(va,Pa){let Ha=null;for(let tb=0;tb<va.length;tb++)if(va[tb].BorderPosition===Pa){Ha=va[tb];break}return Ha}yVh(va,Pa){this.Zic?(Pa=this.ubc(Pa.cell.fN().Borders,2))&&va.push(Pa):(Pa=Pa.cell.fN().Borders,1<Pa.length&&(Pa=[Pa[1]]),va=[...Pa,...va]);return va}B2h(va,Pa){this.Zic?(Pa=this.ubc(Pa.cell.fN().Borders,0))&&va.push(Pa):(Pa=Pa.cell.fN().Borders,
1<Pa.length&&(Pa=[Pa[0]]),va=[...Pa,...va]);return va}tNh(va,Pa){Pa=this.Ix.KQ(Pa.cell.getRange(),1);if(!Pa||0===Pa.length)return va;if(this.Zic){if(Pa=Pa[0].fN().Borders,Pa=this.ubc(Pa,0))Pa.BorderPosition=1,va.push(Pa)}else{let Ha=[];0<Pa.length&&(Ha=Pa[0].fN().Borders);Ha[0].BorderPosition=1;va=[...Ha,...va]}return va}z_h(va,Pa){Pa=this.Ix.KQ(Pa.cell.getRange(),3);if(!Pa||0===Pa.length)return va;if(this.Zic){if(Pa=Pa[0].fN().Borders,Pa=this.ubc(Pa,2))Pa.BorderPosition=3,va.push(Pa)}else{let Ha=
[];0<Pa.length&&(Ha=Pa[0].fN().Borders);Ha[0].BorderPosition=3;va=[...Ha,...va]}return va}pZh(va,Pa,Ha){this.Rkd(va.scenario)&&(Pa=this.yVh(Pa,Ha));this.$kd(va.scenario)&&(Pa=this.B2h(Pa,Ha));this.Fkd(va.scenario)&&(Pa=this.tNh(Pa,Ha));this.Ykd(va.scenario)&&(Pa=this.z_h(Pa,Ha));return Pa}MZ(va){if(0===va.length)return null;let Pa=[0,0,0,0],Ha=[1,1,1,1],tb=0;va.forEach(function(V){let za=V.BorderPosition;Ha[za]=V.BorderLineStyle;let yb=new cc.a(V.Color.Red,V.Color.Green,V.Color.Blue);Pa[za]=yb.yS();
tb|=pa.HelperMethods.x4a(V.BorderPosition)});va={};va.LineStyle=Ha;va.Color=Pa;let Ya={};Ya.BorderFormat=va;Ya.Border=tb;return Ya}I3d(va,Pa,Ha=null){let tb=[];tb=null!==Ha?[...Ha]:this.pZh(Pa,tb,va);if(Pa=this.MZ(tb))va.cell.lcb(va.cell.getRange()),this.Ix.pJb(va.cell.getRange()),this.Ag.nea(Ga.h(this.$),-1690267012,Pa,!1,null,[va.cell.getRange()])}cpi(va){return 512===(va.scenario&512)||4096===(va.scenario&4096)||1024===(va.scenario&1024)||2048===(va.scenario&2048)?!0:!1}C2h(va){va=this.Ix.KQ(va.cell.getRange(),
1);return va&&0!==va.length?va[0].$La?(va=va[0].fN().Borders[0],va.BorderPosition=1,va):null:null}D2h(va){va=this.Ix.KQ(va.cell.getRange(),3);return va&&0!==va.length?va[0].WLa?(va=va[0].fN().Borders[0],va.BorderPosition=3,va):null:null}Z6h(va,Pa,Ha,tb,Ya){Pa.cell.Ihg();if(this.cpi(va))this.I3d(Pa,va);else{const V=8192===(va.scenario&8192),za=Pa.cell.getRange();V&&this.Xff?(Pa.cell.lcb(),this.Ix.pJb(za)):Ya?(Ya=[],null!==Ha&&Ya.push(Ha),null!==tb&&Ya.push(tb),0<Ya.length?this.I3d(Pa,va,Ya):(Pa.cell.lcb(),
this.Ix.pJb(za))):V&&!this.Xff&&(Pa.cell.lcb(),this.Ix.pJb(za))}}TUh(va,Pa){return null===va||void 0===va?!0:va.cell.getRange().top===Pa.topLeft.top&&va.cell.getRange().left===Pa.topLeft.left&&va.cell.getRange().bottom===Pa.topLeft.bottom&&va.cell.getRange().right===Pa.topLeft.right?!0:!1}pEi(va,Pa){Pa=this.nuf(va,Pa);if(this.QAb&&(!Pa||0==Pa.length))return!1;for(let Ha=0;Ha<Pa.length;Ha++)Pa[Ha].S0(2,!0),this.q3(this.i5(Pa[Ha]),!0,8,va.scenario,"merge");return!0}YWj(va){const Pa=Ga.h(this.$).Ea.Xva(va,
this.$.activeItemName);if(Pa&&ic.Ct(Pa))for(let Ha of Pa)Ha.w0d(va,!0)}nuf(va,Pa){const Ha=va.GQ,tb=Ga.h(this.$).Sb(Pa[0]);let Ya=null,V=null;this.qic&&(Ya=this.C2h(tb),V=this.D2h(tb));const za=this.p_h(Ha,tb,Pa[0],va);if(this.QAb&&(!za||0==za.length))return za;this.Uni?this.YWj(Pa[0]):Ga.h(this.$).Ea.y$(Pa[0],this.$.activeItemName).w0d(Pa[0],!0);this.q3(this.i5(tb),!0,9,va.scenario,"merge");if(this.qic&&this.Iod(va)){Pa=this.TUh(Ha,Pa[0]);for(const yb of za)this.Z6h(va,yb,Ya,V,Pa)}return za}NPg(va,
Pa,Ha){if(!(1>va.Borders.length)){var tb=this.MZ(va.Borders);Ha.forEach(Ya=>{Ya=Ga.h(this.$).Sb(Ya.getRange());this.Ag.P7f(-1690267012,Ya,tb,!1,null,!1,Pa)})}}yTj(va,Pa,Ha){const tb=va.length;for(let V=0;V<tb;V++){va[V].cell.QDc();const za=va[V].cell.getRange(),yb=Ga.h(this.$).Ea.Hja(za),jc=yb.length;if(-167499203===Pa&&this.pic){var Ya=0;2===va[V].cell.lJd||1===va[V].cell.VE?Ya=3:2===va[V].cell.VE&&(Ya=1);va[V].S0(Ya,!1)}for(Ya=1;Ya<jc;Ya++)yb[Ya].attachCellToModel(),yb[Ya].rrb(va[V]),-167499203===
Pa&&this.pic&&yb[Ya].S0(null,!1);this.cmf&&Ha&&this.NPg(Ha[V],za,yb)}}WZe(va,Pa){let Ha=null;for(let tb=0;tb<va.length;tb++)if(va[tb].BorderPosition===Pa){Ha=va[tb];break}return Ha}sNh(va,Pa){let Ha=va.cell.fN();va.ULa()&&va.cell.gRa(1);va.YLa()&&va.cell.gRa(3);if((va=this.Ix.KQ(Pa,0))&&va[0].ULa){var tb=va[0].fN().Borders;tb=this.WZe(tb,1);tb.BorderPosition=0;Ha.Borders.push(tb);va.forEach(Ya=>{Ya.gRa(1)})}(Pa=this.Ix.KQ(Pa,2))&&Pa[0].YLa&&(va=Pa[0].fN().Borders,va=this.WZe(va,3),va.BorderPosition=
2,Ha.Borders.push(va),Pa.forEach(Ya=>{Ya.gRa(3)}));return Ha}Gfg(va,Pa,Ha){var tb=Ga.h(this.$).Ea.Yva(Pa[0],this.$.activeItemName);const Ya=Ga.h(this.$).Ea.y$(Pa[0],this.$.activeItemName),V=[];if(void 0!==tb&&null!==tb&&(Pa=Ga.h(this.$).Rja(Pa[0],tb),void 0!==Pa&&null!==Pa)){Pa=Pa.$$ge();for(tb=[];Pa.$$mn();){var za=Pa.$$cu();if(za.aI){V.push(za);this.q3(this.i5(za),!0,10,va,"unmerge");za.cell.u2g();const yb=za.cell.getRange();this.q3(this.i5(za),!1,11,va,"unmerge");Ya.w0d(yb,!1);this.cmf&&(za=this.sNh(za,
yb),tb.push(za))}}0<V.length&&(Ya.sf.resetCellLookup(),this.yTj(V,Ha,tb))}}q3(va,Pa,Ha,tb,Ya){if(!this.aif)return!1;va!==Pa&&w.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${Ha}; Scenario: ${tb}; Command: ${Ya}; Expected: ${Pa?"populated":"empty"}; Actual: ${va?"populated":"empty"}`);return va}i5(va){return!!va.cell.cell.Merge}}Object(u.a)(xb,"MergeCellCommandAction",null,[]);var Vb=a(67),wb=a(173),cb=a(44),lb=a(461),Y=a(377),Oa=a(51),Wa=a(69),
Ca=a(55),Ra=a(1087),la=a(33),ua=a(343),xa=a(145),fb=a(211),Jb=a(4);class Ob{constructor(va,Pa,Ha,tb,Ya,V,za){this.$=va;this.gridView=Pa;this.Ag=Ha;this.MB=tb;this.borderFormatManager=Ya;this.moreColorsHelper=V;this.fontDropdownHelper=za;this.KC=null;this.n0a=1461300262;this.Bx=this.k0a=this.R9a=this.Dac=null;this.uRi=(yb,jc,Cc)=>{const Sa=!!yb&&!!yb.RequestTelemetryData;!Ia.a(yb)&&jc&&Ga.h(this.$).ji.Vla(jc,yb.StateId,Sa?yb.RequestTelemetryData.EcsOperationDuration:0,Sa?yb.RequestTelemetryData.EcsRequestDuration:
0,Sa?yb.RequestTelemetryData.WfeRequestDuration:0);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){jc=1;if(33===Cc||17===Cc||9===Cc||5===Cc||37===Cc)jc=0;this.m1(jc,yb)}};this.bOi=yb=>{d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&this.m1(3,yb)};this.lrb=()=>{if(this.gridView.m7a){const yb=this.$.da.za(254,!0);yb&&yb.Bgj(this.lrb);this.gridView.m7a=
!1;this.gridView.Hf.gm(G.a.QQ);this.gridView.ha.JW(this.edd);Ga.h(this.$).$.af()}};this.edd=()=>{var yb=this.Dac;this.Dac=H.d(this.$.xa.oa);yb===this.Dac&&(this.gridView.ha.JW(this.edd),(yb=this.$.da.za(254,!0))&&yb.k0c(36,Ga.h(this.$).ha.ra.selectedRanges)?(yb=new ya.a(1804571062,2,2,0,null),this.$.Ja.Kb(yb,{[G.a.skipClipboardAccess]:!0,[G.a.M1c]:!0,[G.a.isFormatPainter]:!0}).continueWith(()=>{this.lrb()})):this.gridView.Hf.rH(!1))};this.xb=d.EwaSettings.xb();this.mergeCellCommandAction=new xb(this.$,
Ha);this.zD=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Vl=d.EwaSettings.Vl();this.Gl=la.a.Gl();this.uB=la.a.uB(this.$)}get Tkf(){return n.a.all(this.gridView.ha.ra.selectedRanges,va=>va.isRow)}get Pkf(){return n.a.all(this.gridView.ha.ra.selectedRanges,va=>va.hf)}get themesManager(){this.Bx||(this.Bx=this.$.da.za(422));return this.Bx}m1(va,Pa){const Ha=this.$.da.za(465);Ha&&Ha.m1(va,Pa)}Tmi(va){return 1896159024===va||-1554384558===va||-1113896058===va||1554436520===
va||1415868706===va||674605324===va||1035996630===va}nc(va,Pa){return 2054778433===Pa&&va&1?!S.a(this.$).bjc:600686207===Pa?!1:this.Tmi(Pa)&&n.a.any(this.gridView.ha.ra.selectedRanges,Ha=>Ha.hf||Ha.isRow)&&!this.Tkf&&!this.Pkf?!0:this.yjc(va,Pa)}executeCommand(va,Pa,Ha){return this.Kb(Pa,Ha)}wc(va,Pa,Ha){if(va=1===va)switch(Pa.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 2007171328:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:va=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:va=
!!Ha;break;case 862825906:case 1532790410:case 46555851:case -1522760979:va=!0;break;default:va=!1}return va}Kc(va,Pa,Ha){switch(Pa){case "PopulateFontColor":Ha.MenuItems=this.MB.Fbc(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,Ha.MenuId);break;case "PopulateFillColor":Ha.MenuItems=this.MB.Fbc(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,Ha.MenuId);break;case "PopulateBorderColor":Ha.MenuItems=this.MB.Fbc(-236759591,-1803452024,void 0,
void 0,void 0,void 0,void 0,46555851,Ha.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.s7h(Ha);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.Gl&&(this.fontDropdownHelper.Kvj(Ha.MenuId),!this.fontDropdownHelper.Kli()))return!1;Ha.MenuItems=this.fontDropdownHelper.qZe(-1293291468,324978188,-1428968098,Ha.MenuId);break;default:return!1}return!0}yjc(va,Pa){const Ha=Ga.h(this.$).ha.ra.selectedRanges;return!(new da.a(this.$.xa)).xm(va,Pa,Ha,this.gridView)}Kb(va,
Pa){var Ha=this.gridView;const tb=va.command;var Ya=f.TaskExtensions.Sj();let V=!0;switch(tb){case -1077965542:V=this.q9e(Pa,va,!1);break;case 909774670:this.wqb(tb);V=this.q9e(Pa,va,!0);break;case -1293291468:V=this.o9e(Pa,va,!1);break;case 324978188:this.wqb(tb);V=this.o9e(Pa,va,!0);break;case 862890474:case 963349338:V=this.M6h(va);break;case -1832800737:V=this.jec(tb,Pa,!1,va);break;case 1970784898:V=this.jec(tb,Pa,!1,va);break;case -803000997:V=this.jec(tb,Pa,!1,va);break;case -128950598:case 1688184685:this.wqb(tb);
V=this.jec(tb,Pa,!0,va);break;case 1597684571:V=this.Wxb(tb,Pa,!1,va);break;case 87208751:Pa.Color="-1";Pa.IntColor=!0;V=this.Wxb(tb,Pa,!1,va);break;case -446735083:this.wqb(tb);Pa.Color="-1";Pa.IntColor=!0;V=this.Wxb(tb,Pa,!0,va);break;case 1650812936:V=this.Wxb(tb,Pa,!1,va);break;case 673562736:this.wqb(tb);V=this.Wxb(tb,Pa,!0,va);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.VXf(tb);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:V=
this.x6h(tb,va);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 2007171328:V=this.J5h(tb,va);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:V=this.n7h(tb,va);break;case -1803452024:case -236759591:V=this.Sjd(tb,Pa,va);break;case -2118943501:V=this.borderFormatManager.Q5h(Pa,va);break;case 1012765228:V=this.borderFormatManager.I7h(Pa,va);break;case 1256700402:V=this.borderFormatManager.Wjd(va);
break;case -1756763834:V=this.borderFormatManager.Xjd(va);break;case -1418159950:V=this.borderFormatManager.b9e(va);break;case -1920201820:case -1942512156:V=this.N6h(tb,va);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:V=this.borderFormatManager.O8e(Pa,va);this.mEh(Pa);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:V=this.j7h(tb,Pa,va);break;case -693675336:case 322710748:break;case 1696566924:V=this.y6h(va);break;case -167499203:case -255094134:case 1097660126:case 155820588:Ya=
this.handleMergeCellsCommand(this.gridView,va);break;case 1896159024:case -1554384558:Pa=this.gridView.ha.ra.selectedRanges;if(this.pCj(va,Pa))w.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new wa(this.$,tb,Pa)).gg(),V=!0;else if(n.a.any(Pa,za=>this.gridView.Bb.G5(za))){Ha="";Ya=1461300262;const za=-1554384558===tb&&this.gridView.Bb.dpi(Pa[0]);Pa=Pa[0].height>Pa[0].width&&!za;switch(tb){case 1896159024:Ha=Pa?"InsertColumnsTable":"InsertRowsTable";
Ya=Pa?622604322:942362098;break;case -1554384558:Ha=Pa?"DeleteColumnsTable":"DeleteRowsTable",Ya=Pa?284490184:1405456548}Pa=ha.a.wq(Ob.Nnd,Ha,1);new ya.a(Ya,1,2,6,null);Ya=this.insertOrDeleteCells(Pa,va,!0)}else Ya=this.insertOrDeleteCells(1896159024===tb?1:2,va,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Ya=this.insertOrDeleteCells(ha.a.wq(Ob.Nnd,Pa[I.a.Jc],1),va,!0);this.uB&&(va=Ga.h(this.$),fb.d(this.$,va.ha.ra.activeCell,tb,null));break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Ya=
this.insertOrDeleteCells(ha.a.wq(Ob.Nnd,Pa[I.a.Jc],1),va,!1);break;case 504848446:Ya=Ha.startEdit(!1,1,Pa[G.a.event],void 0,void 0,!0);break;case 1504715724:if(Ga.h(this.$).Dz&&this.borderFormatManager.JU.wB)break;Ya=Ha.startEdit(!0,0,Pa[G.a.event],void 0,void 0,!0);break;case 1872288872:this.lrb();break;case 41465729:Ya=this.fill(Ha.ha.ra.$c,null,0,1,va);break;case -1451655532:case 1972143101:Ya=this.fillDownAbsoluteValueAndStartEdit(Ha,Pa[G.a.event],-1451655532===tb);break;case -475861485:Ya=this.fill(Ha.ha.ra.$c,
null,Ha.rtl?1:2,1,va);break;case -978843926:Ya=this.fill(Ha.ha.ra.$c,null,3,1,va);break;case 2098035706:Ya=this.fill(Ha.ha.ra.$c,null,Ha.rtl?2:1,1,va);break;case -2142700828:Ya=this.fill(Ha.ha.sourceRange,Ha.ha.ra.$c,Ob.L1e(Ha.ha.ra.$c,Ha.ha.sourceRange),2,va);break;case 1405660955:Ya=this.fill(Ha.ha.sourceRange,Ha.ha.ra.$c,Ob.L1e(Ha.ha.ra.$c,Ha.ha.sourceRange),4,va);break;case 1983983164:Ya=this.fill(Ha.ha.ra.$c,null,0,0,va);break;case 478842689:(va=this.$.da.za(376))?(va.I7i(),V=!0):w.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:V=Ha.ha.Kb(null,tb);break;case -208772570:this.e7h();V=!0;break;case -987339782:this.Y5h();V=!0;break;case -1770246794:Ha.ha.Z5h();V=!0;break;case 748067091:case -381232414:this.b6h(tb);V=!0;break;case -1522760979:this.gridView.toggleFormulaView();V=!0;break;case 886009118:Ya=this.K6h();break;case 894341014:this.P6h();
V=!0;break;case 862825906:Ya=this.G9e(1970784898,va);break;case 1532790410:Ya=this.G9e(1650812936,va);break;case 46555851:Ya=this.a7h(va);break;default:V=!1}V||(Ya=ba.a(tb));return Ya}mEh(va){va&&va.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(va.MenuItemId)&&d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.eUg(new ua.a(this.gridView.ha.ra.activeRange,H.d(this.$.xa.oa)))}eUg(va){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,
426,427,1),Pa=>{void Pa.result.iCc(va,"BorderActions")},this.$.la,3)}pCj(va,Pa){const Ha=n.a.all(Pa,V=>!this.gridView.Bb.G5(V)),tb=1<Pa.length&&!!this.gridView.Bb.Jid(Pa),Ya=n.a.all(Pa,V=>!this.gridView.Bb.E5(V));Pa=!n.a.any(Pa,V=>V.isRow||V.hf);return 1===va.method&&6===va.$e&&(Ha||tb)&&Ya&&Pa}fillDownAbsoluteValueAndStartEdit(va,Pa,Ha){const tb=va.ha.ra.activeCell,Ya=U.E(tb,this.gridView.jt);return va.startEdit(!0,0,Pa).jp(()=>{const V=va.Sb(Ya),za=va.Sb(tb);if(!V||!za)return w.ULS.shipAssertTag(537159507,
0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${tb.toString()} and above cell: ${Ya.toString()}`),Ca.Task.Ta(!1);this.gridView.Vb.text=Ha?V.wX:V.text;this.gridView.Vb.textBox.setCaretPositionToEnd();return Ca.Task.Ta(!0)})}insertOrDeleteCells(va,Pa,Ha){const tb=y.a.create().toString();var Ya=Enum.toString(O,va);this.gridView.ji.X7(17,tb,Ya);Ya=this.gridView.ha.ra.selectedRanges;var V=this.Tkf,za=this.Pkf;if(!this.$.Yp(null,!1,void 0,Pa.$e)&&!za&&!V&&
5!==va&&9!==va)return Ca.Task.Ta(!0);2===va?va=za?10:V?6:Ya[0].height>Ya[0].width?18:34:1===va?va=za?9:V?5:Ya[0].height>Ya[0].width?17:33:18===va&&V?va=34:34===va&&za&&(va=18);Ya=this.GNg(Ya,va);if((10===va||6===va)&&!this.$.Yp(Ya,!0,1,Pa.$e))return Ca.Task.Ta(!0);const yb={};yb.InsertDeleteRangeItems=Array(Ya.length);yb.SheetName=this.$.oa.sheetName;yb.IsTableCommand=Ha;for(Ha=0;Ha<Ya.length;Ha++){V=Ya[Ha];za={};let na,jb;va&4?(za.FirstRow=V.top-1,za.LastRow=T.a.Lz,za.FirstColumn=0,za.LastColumn=
T.a.Qw,na=V.bottom-V.top+1,jb=0,6===va?(V.hf||(za.FirstRow=V.bottom),na=-na):xa.b("InsertRowsAbove"),37===va&&(za.FirstRow=V.bottom,xa.b("InsertRowsBelow"))):va&8?(za.FirstRow=0,za.LastRow=T.a.Lz,za.FirstColumn=V.left-1,za.LastColumn=T.a.Qw,na=0,jb=V.right-V.left+1,10===va&&(V.isRow||(za.FirstColumn=V.right),jb=-jb)):va&16?(za.FirstRow=V.top-1,za.LastRow=V.bottom-1,za.FirstColumn=V.left-1,za.LastColumn=T.a.Qw,na=0,jb=V.right-V.left+1,18===va&&(za.FirstColumn=V.right,jb=-jb)):(za.FirstRow=V.top-1,
za.LastRow=T.a.Lz,za.FirstColumn=V.left-1,za.LastColumn=V.right-1,na=V.bottom-V.top+1,jb=0,34===va&&(za.FirstRow=V.bottom,na=-na));const Ib={};Ib.InsertDeleteRange=za;Ib.DeltaRow=na;Ib.DeltaColumn=jb;Ib.AdjustedSelectedRange=U.j(V);yb.InsertDeleteRangeItems[Ha]=Ib}this.gridView.Hf.rH(!1);const jc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");yb.IsDecoupleRecalc=jc;const Cc=this.$.pa.ya.Wb(),Sa=()=>new M(yb);return N.a(this.$.userOperationManager,(na,jb,Ib)=>{jc&&
!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.My();return ka(this.$.pa.ya,yb,Ka.b(na,(dc,ob)=>{this.uRi(dc,ob,va)},()=>{this.ZQj(va,yb)}),jb,Ib,tb,Cc)},na=>new W.a(237,0,na,void 0,Sa),Pa)}ZQj(va,Pa){const Ha=this.X1h(va);if(Ha&&1===Pa.InsertDeleteRangeItems.length){var tb=Pa.InsertDeleteRangeItems[0];1<tb.DeltaColumn||1<tb.DeltaRow||(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:7334505_FixLatePSCardFlightCheck")||this.Ssd(Ha))&&f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,
426,427,1),Ya=>{const V=new ua.a(U.B(tb.AdjustedSelectedRange),H.d(this.$.xa.oa));void Ya.result.iCc(V,Ha)},this.$.la,3)}}Ssd(va){return d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)?"DeleteColumn"===va||"DeleteRow"===va?(Jb.AFrameworkApplication.Ip("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteRowColProactiveSuggestions",
!1)):"InsertColumn"===va||"InsertRow"===va?(Jb.AFrameworkApplication.Ip("XLS-SmartView-InsertRowColProactiveSuggestions-Treatment;XLS-SmartView-InsertRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertRowColProactiveSuggestions",!1)):"InsertCellShiftDown"===va||"InsertCellShiftRight"===va?(Jb.AFrameworkApplication.Ip("XLS-SmartView-InsertCellTableProactiveSuggestions-Treatment;XLS-SmartView-InsertCellTableProactiveSuggestions-Control"),
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertCellTableProactiveSuggestions",!1)):"DeleteCellShiftUp"===va||"DeleteCellShiftLeft"===va?(Jb.AFrameworkApplication.Ip("XLS-SmartView-DeleteCellTableProactiveSuggestions-Treatment;XLS-SmartView-DeleteCellTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteCellTableProactiveSuggestions",!1)):!1:(Jb.AFrameworkApplication.Ip("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),
!1)}X1h(va){let Pa;switch(va){case 5:case 37:Pa="InsertRow";break;case 33:Pa="InsertCellShiftDown";break;case 9:Pa="InsertColumn";break;case 17:Pa="InsertCellShiftRight";break;case 6:Pa="DeleteRow";break;case 34:Pa="DeleteCellShiftUp";break;case 10:Pa="DeleteColumn";break;case 18:Pa="DeleteCellShiftLeft"}return Pa}GNg(va,Pa){return Pa&32?this.RZa(va,Ha=>Ha.bottom,Ha=>Ha.top,(Ha,tb)=>{Ha.bottom=tb},!1,!0):Pa&16?this.gridView.rtl?this.RZa(va,Ha=>Ha.left,Ha=>Ha.right,(Ha,tb)=>{Ha.left=tb},!1,!1):this.RZa(va,
Ha=>Ha.right,Ha=>Ha.left,(Ha,tb)=>{Ha.right=tb},!1,!1):Pa&4?this.RZa(va,Ha=>Ha.bottom,Ha=>Ha.top,(Ha,tb)=>{Ha.bottom=tb},!0,!0):Pa&8?this.gridView.rtl?this.RZa(va,Ha=>Ha.left,Ha=>Ha.right,(Ha,tb)=>{Ha.left=tb},!0,!1):this.RZa(va,Ha=>Ha.right,Ha=>Ha.left,(Ha,tb)=>{Ha.right=tb},!0,!1):va}RZa(va,Pa,Ha,tb,Ya,V){va=U.d(va);va.sort((za,yb)=>Pa(yb)-Pa(za));if(Ya){Ya=[];V=V?T.a.fh+1:T.a.qh+1;for(let za=0;za<va.length;za++){const yb=va[za];Ha(yb)<V&&(tb(yb,Math.min(Pa(yb),V-1)),Ya.push(yb),V=Ha(yb))}va=Ya}return va}fill(va,
Pa,Ha,tb,Ya){const V=this.$;if(!V.Yp([Pa],!0))return Ca.Task.Ta(!0);const za=U.v(va,V),yb=Pa?U.v(Pa,V):za,jc=this.$.pa.ya.Wb(),Cc=()=>new ta(za,yb,tb,Ha);return N.a(this.$.userOperationManager,(Sa,na,jb)=>{this.$.My();var Ib=this.$.pa.ya;Sa=Ka.b(Sa,this.bOi);const dc=Ib.Na(9,jc);dc.sourceRange=za;dc.targetRange=yb;dc.fillDirection=Ha;dc.fillType=tb;return X.g(Ib,"FillRange",dc,Sa,na,jb,null,0)},Sa=>new W.a(155,0,Sa,void 0,Cc),Ya)}j7h(va,Pa,Ha){const tb={ValidMembers:32};switch(va){case 1890566896:va=
parseInt(Pa[I.a.Jc].toString(),10);if(14===va)return Ha=new ya.a(2105621672,Ha.method,Ha.mode,Ha.$e,Ha.tabName),Pa[I.a.Jc]=null,this.$.Ja.Kb(Ha,Pa),w.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;tb.NumberFormat=va;break;case 1886928607:tb.NumberFormat=13;break;case -992833457:tb.NumberFormat=11;break;case 218524921:tb.NumberFormat=12;break;case 996232352:tb.NumberFormat=1006;break;default:return w.ULS.shipAssertTag(537159505,
0,!1,"Unexpected number formatting command "+Oa.b().uj(Ha.command)),!1}w.ULS.sendTraceTag(537159504,0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${Oa.b().uj(Ha.command)} command, with menu item ${Pa[I.a.Jc]}.`);this.Ag.formatCells(1890566896,tb,Ha);this.$.af();return!0}M6h(va){var Pa=this.gridView.Sb(this.gridView.ha.ra.activeCell);if(this.xb&&this.gridView.eb){Pa=this.gridView.Ai.R4a(Pa?wb.a(Pa).Font:null);if(!Pa)return w.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.ra.activeCell.toString()} is null while editing`),
!1;var Ha=Pa.FontSize}else if(Pa)Ha=Pa.fontSize;else return!1;Pa=va.command;let tb=0;if(862890474===Pa)for(;tb<Ob.tKa.length-1&&Ob.tKa[tb]<=Ha;)tb++;else if(963349338===Pa)for(tb=Ob.tKa.length-1;0<tb&&Ob.tKa[tb]>=Ha;)tb--;w.ULS.sendTraceTag(537159501,0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${Ha} to size ${Ob.tKa[tb]}`);if(Ha===Ob.tKa[tb])return!0;Ha=Ob.vxc(2);Ha.Font.FontSize=Ob.tKa[tb];this.xb&&this.gridView.eb?(this.Yob(va,!1,Ha),this.$.af()):this.Ag.formatCells(Pa,
Ha,va);return!0}q9e(va,Pa,Ha){va=va[va[t.a.IsFreeForm]?t.a.Value:I.a.og].toString();if(!Ob.a3i.test(va))return w.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),!0;va=parseFloat(va);if(8>va||72<va)return w.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),!0;const tb=Math.round(2*va)/2,Ya=Ob.vxc(2);Ya.Font.FontSize=tb;this.xb&&this.gridView.eb?
(this.Yob(Pa,Ha,Ya,!0),tb===va||Ha||this.$.af()):Ha?this.Ag.nea(this.gridView,-1077965542,Ya,Ha):(this.Ag.formatCells(-1077965542,Ya,Pa),this.N0a());return!0}o9e(va,Pa,Ha){var tb=va[I.a.og];let Ya;this.Gl?this.fontDropdownHelper.OAc&&this.fontDropdownHelper.OAc[tb]?Ya=tb:(w.ULS.sendTraceTag(523903201,1,15,`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${tb}`),Ya=pa.HelperMethods.TO[tb]):Ya=pa.HelperMethods.TO[tb];let V=0;this.Vl&&(va=va.MenuItemId,va===
Ra.b?(tb==this.themesManager.zG.Xyd&&(Ya=tb),V=2):va===Ra.a&&(tb==this.themesManager.zG.Ixd&&(Ya=tb),V=1),w.ULS.sendTraceTag(510247702,1,50,`GridCommandHandler.handleFontFamilyCommand: Font used is theme font: ${0!==V}`));if(!Ya)return!0;tb=Ob.vxc(1);tb.Font.FontName=Ya;this.Vl&&(tb.Font.FontScheme=V);this.xb&&this.gridView.eb?(this.Yob(Pa,Ha,tb),this.$.af()):Ha?this.Ag.nea(this.gridView,-1293291468,tb,Ha):(this.Ag.formatCells(-1293291468,tb,Pa),this.N0a());return!0}jec(va,Pa,Ha,tb){let Ya=-803000997===
va||1688184685===va?"black":Pa.Color;this.moreColorsHelper&&(-1832800737===va?Ya=fa.a.compare(Ya,"WindowText",!0)?this.moreColorsHelper.Vbb:"black":Ha||(this.moreColorsHelper.Vbb=Ya,this.moreColorsHelper.xda(Pa,Ya,tb)));va=Ob.vxc(32);va.Font.FontColor=ea.a.HH(Ya,ha.a.xg(Pa,"IntColor"));this.xb&&this.gridView.eb?this.Yob(tb,Ha,va,17===tb.$e):Ha?this.Ag.nea(this.gridView,1970784898,va,Ha):(this.zD&&({themeColor:Pa}=this.getThemeColor(Pa)).returnValue&&(va.Font.ThemeFontColor=Pa,va.Font.ColorTypeOption=
1),this.Ag.formatCells(1970784898,va,tb),this.N0a());return!0}b6h(va){var Pa=(new Date).format(748067091===va?this.$.va.ShortDateFormat:this.$.va.ShortTimeFormat);const Ha=this.gridView.Ul?oa.a(this.gridView.$):this.gridView.Vb;va=Ha.textBox;this.gridView.eb?Ha.insertText(Pa):(this.gridView.startEdit(!0,0),Ha.text=Pa,Pa=Pa.length,va.Ldb(Pa),va.caretPosition=Pa)}e7h(){this.gridView.IK(this.gridView.ha.ra.activeCell)||this.gridView.Qwc||this.gridView.sNa()||this.gridView.Ht(this.gridView.ha.ra.activeCell,
3,"GridCommandHandler.HandleMoveViewportToActiveCell")}Y5h(){if(!(this.gridView.Qwc||this.gridView.sNa()||this.gridView.eb&&r.a.isMac)){const va=this.gridView.ha.ra.x4;this.gridView.Bg(U.v(va,this.$),va,null,null,60,"GridCommandHandler.HandleMoveViewportToActiveCell")}}y6h(va){this.Dac=H.d(this.$.xa.oa);const Pa=this.$.da.za(254,!0);if(this.gridView.m7a)return this.gridView.Hf.rH(!1),!!Pa;if(!Pa)return w.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),
!1;this.gridView.ha.FY(this.edd);const Ha=String.format(G.a.Xta,K.a.current.fo(108));this.gridView.Hf.gm(Ha);va=new ya.a(-911352779,va.method,va.mode,va.$e,va.tabName);this.$.Ja.Kb(va,{[G.a.silentClipboardAccessFailures]:!0,[G.a.isFormatPainter]:!0}).continueWith(tb=>{(6>tb.status||6===tb.status&&!tb.result)&&this.lrb()});this.gridView.m7a=!0;Pa.DLg(this.lrb);return!0}Wxb(va,Pa,Ha,tb){let Ya=87208751===va?"-1":Pa.Color;this.moreColorsHelper&&(1597684571===va?Ya=this.moreColorsHelper.TQa:Ha||(this.moreColorsHelper.TQa=
Ya===Ob.notSet?Ob.EZd:Ya,this.moreColorsHelper.xda(Pa,Ya,tb)));va={ValidMembers:64};va.FillColor=ea.a.HH(Ya,ha.a.xg(Pa,"IntColor"));Ha?this.Ag.nea(this.gridView,1650812936,va,!0):(this.zD&&({themeColor:Pa}=this.getThemeColor(Pa)).returnValue&&(va.ThemeFillColor=Pa,va.ColorTypeOption=1),this.Ag.formatCells(1650812936,va,tb),this.N0a());return!0}P6h(){w.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");const va=this.$.da.za(221);if(va){var Pa=
this.gridView.Ai;if(Pa){var Ha,tb,Ya=({Uvf:Ha,nXe:tb}=va.Tfi(Pa.text,Pa.textBox.caretPosition)).returnValue;Ya?(va.re=!1,Pa.text=Ya,Pa.textBox.selectRange(Ha,Ha+tb),w.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):w.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else w.ULS.shipAssertTag(537159491,0,!1,
"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else w.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}x6h(va,Pa){let Ha=0;const tb=this.gridView,Ya=wb.a(tb.Sb(null));this.xb&&tb.eb&&(Ya.Font=tb.Ai.R4a(Ya.Font));let V=Ya.Font;V||(V={ValidMembers:0});switch(va){case -287251124:Ha|=4;ra.e(V,4)?V.Bold=!V.Bold:V.Bold=!0;break;case -1925065947:Ha|=8;ra.e(V,8)?V.Italic=!V.Italic:V.Italic=!0;break;case 1764140053:Ha|=
16;ra.e(V,16)?V.Underline=!V.Underline:V.Underline=!0;break;case -1685033574:Ha|=64;ra.e(V,64)?V.DoubleUnderline=!V.DoubleUnderline:V.DoubleUnderline=!0;break;case -1590502662:Ha|=128,ra.e(V,128)?V.Strikethrough=!V.Strikethrough:V.Strikethrough=!0}if(!Ha)return!1;V.ValidMembers=Ha;Ya.Font=V;Ya.ValidMembers=16;this.xb&&this.gridView.eb?this.Yob(Pa,!1,Ya):(d.EwaSettings.ma(647)||tb.Hf.rH(!1),this.Ag.formatCells(va,Ya,Pa));this.$.af();return!0}J5h(va,Pa){let Ha=0;const tb=this.gridView,Ya=wb.a(tb.Sb(null));
-571165336===va||1041132226===va||-394785302===va?(Ha|=1,Ya.VerticalAlignment=ha.a.wq(Ob.$Za,va.toString(),2)):Ob.zmi(va)?(Ha|=2,this.H6h(Ya,va)):-1116189897===va&&(Ha|=8,Ya.Wrap=Ya.ValidMembers&8?!Ya.Wrap:!0);if(!Ha)return!1;Ya.ValidMembers=Ha;d.EwaSettings.ma(647)||tb.Hf.rH(!1);this.Ag.formatCells(va,Ya,Pa);this.$.af();return!0}H6h(va,Pa){!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==Pa&&(Pa=-1150205178===Pa?-286432209:
-1150205178);Pa=ha.a.wq(Ob.$Za,Pa.toString(),0);va.HorizontalAlignment=Pa===va.HorizontalAlignment?0:Pa}QNf(va,Pa,Ha,tb){let Ya=!1;d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(Ya=this.mergeCellCommandAction.muf(Pa,Ha))&&Ga.h(this.$).ji.uS(this.R9a,Vb.BasicTelemetryCalculator.$Q);return this.oub(va,Pa,!1,Ya,V=>{this.DSi(V,Ha,Pa,Ya,tb)})}handleMergeCellsCommand(va,Pa){this.R9a=y.a.create().toString();let Ha=null;Ha=this.mergeCellCommandAction.C3e();var tb=
C.a(Pa.command);const Ya=this.mergeCellCommandAction.qki(Pa.command,Ha);let V=0;Ya?V=v.a.Ud():Ga.h(this.$).ji.X7(4,this.R9a,tb+", Scenario = "+Ha.scenario.toString());tb=va.ha.ra.selectedRanges;w.ULS.sendTraceTag(537159459,0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${Oa.b().uj(Pa.command)}, Number of ranges: ${tb.length}, Ranges: ${U.i(tb,",",this.$,!1)}`);tb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);va.Hf.rH(!1,tb);if(10===ha.a.wq(Ob.ouf,
Pa.command.toString(),10))return Ca.Task.Ta(!1);const za=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(tb&&za)return Ya?(this.u7f(Ha,Pa,!0,!0,V),Ca.Task.Ta(!0)):this.QNf(va,Pa,Ha,!1);let yb=!1;tb&&(yb=this.mergeCellCommandAction.muf(Pa,Ha))&&Ga.h(this.$).ji.uS(this.R9a,Vb.BasicTelemetryCalculator.$Q);return this.oub(va,Pa,!1,yb,jc=>{this.ESi(jc,Pa,yb)})}oub(va,Pa,Ha,tb,Ya=null){const V=this.$.pa.ya.Wb(),za=ha.a.wq(Ob.ouf,Pa.command.toString(),10),
yb=U.r(va.ha.ra.selectedRanges,va.$),jc=()=>new Q.a(za,yb),Cc=Sa=>{const na=!!Sa&&!!Sa.RequestTelemetryData;Ga.h(this.$).ji.Vla(this.R9a,Sa.StateId,na?Sa.RequestTelemetryData.EcsOperationDuration:0,na?Sa.RequestTelemetryData.EcsRequestDuration:0,na?Sa.RequestTelemetryData.WfeRequestDuration:0)};va=(Sa,na,jb)=>{this.$.My();Sa=Ya?Ka.b(Sa,Ya):Sa;Sa=Ka.b(Sa,Cc);return X.d(this.$.pa.ya,za,yb,Ha,Sa,na,jb,null,V)};return tb?N.a(this.$.userOperationManager,va,Sa=>new W.a(156,0,Sa,64,jc),Pa):N.a(this.$.userOperationManager,
va,Sa=>new W.a(156,0,Sa,void 0,jc),Pa)}u7f(va,Pa,Ha,tb=!1,Ya=0){w.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${Ha}`);var V=Ga.h(this.$).rtl;V=La.a.Zc(3,2,0,V?635:634,0,514846606,"MergeCellsLoseData");f.TaskExtensions.Aa(cb.a(this.$).vj(V),za=>{za=za.result;if(tb){const yb=v.a.Ud()-Ya;w.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${yb}, and the user action is : ${za}`)}0===za?(w.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),
Ha?(tb&&(za=C.a(Pa.command),Ga.h(this.$).ji.X7(4,this.R9a,za+", Scenario = "+va.scenario.toString())),this.QNf(Ga.h(this.$),Pa,va,!0)):this.oub(this.gridView,Pa,!0,!1)):1===za&&w.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)}wyi(va,Pa,Ha,tb){Pa!==va&&w.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${Pa} and as per server is ${va}. The scenario is:- ${Ha}, The CSE is done:- ${tb}`)}ESi(va,
Pa,Ha){Ia.b(va,514846606)&&(w.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Wa.a(this.$).hd.sM(514846606),va=Ga.h(this.$).rtl,va=La.a.Zc(3,2,0,va?635:634,0,514846606,"MergeCellsLoseData"),f.TaskExtensions.Aa(cb.a(this.$).vj(va),tb=>{tb=tb.result;0===tb?(w.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.oub(this.gridView,Pa,!0,Ha)):1===tb&&w.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11))}DSi(va,Pa,Ha,
tb,Ya){let V=!1;Ia.b(va,514846606)&&(V=!0,Wa.a(this.$).hd.sM(514846606),tb&&Ya?window.setTimeout(()=>{this.oub(this.gridView,Ha,!0,!0)},0):this.u7f(Pa,Ha,!1));this.wyi(V,Ya,Pa.scenario,tb)}wqb(va){if(this.n0a!==va&&1461300262!==this.n0a){this.VXf(this.n0a);var Pa=Oa.b().uj(va);const Ha=Oa.b().uj(this.n0a);w.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${Ha} was restored before caching the style for ${Pa} command.`)}this.n0a=va;if(this.xb&&this.gridView.eb)this.k0a||
(this.k0a=this.gridView.Ai.formattedText);else if(!this.KC){this.KC=[];Pa=this.gridView.caa("GridCommandHandler.CacheFontStyles",this.gridView.ha.ra.selectedRanges);try{for(Pa.$$rst();Pa.$$mn();){const Ha=Pa.$$cu();if(Ha.cell.hasRichText)this.KC.push(aa.yWg(Ha,Ha.cell.formattedText));else switch(va){case 673562736:case -446735083:this.KC.push(aa.y_c(Ha,Ha.backgroundColor));break;case -128950598:case 1688184685:this.KC.push(aa.y_c(Ha,Ha.color));break;case 909774670:this.KC.push(aa.zWg(Ha,Ha.fontSize));
break;case 324978188:this.Vl?this.KC.push(aa.xWg(Ha,Ha.fontName,Ha.JZ)):this.KC.push(aa.y_c(Ha,Ha.fontName))}}}finally{Pa&&Pa.dispose()}}}PGj(){return this.xb&&this.gridView.eb?!this.k0a:!this.KC}kji(va){return!!this.KC&&this.KC.length>va&&!!this.KC[va].formattedText}Ged(va){return this.KC[va].style}YNh(va){return this.KC[va].size}XNh(va){return this.KC[va].JZ}VXf(va){if(!this.PGj()){if(this.xb&&this.gridView.eb)this.k0a&&(this.gridView.Vb.formattedText=this.k0a);else{const Ha=this.KC.length;for(let tb=
0;tb<Ha;tb++){let Ya;var Pa=this.KC[tb].wja.cell.getRange();Ya=this.gridView.Sb(Pa);if(!Ya){w.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${Pa.Ew(!1)}`);continue}let V;Pa=Ya.aI?this.gridView.ALb(Ya.range):(V=new L.a,V.add(Ya),V);for(let za of Pa)if(za.cell.hasRichText&&1457172838!==va)this.kji(tb)&&(za.cell.formattedText=this.KC[tb].formattedText);else switch(va){case 1457172838:za.backgroundColor=this.Ged(tb);break;case 2036397036:za.color=
this.Ged(tb);break;case -1904244080:za.fontSize=this.YNh(tb);break;case -1428968098:za.fontName=this.Ged(tb),this.Vl&&za.U2f(this.XNh(tb))}}}this.n0a=1461300262;this.N0a()}}N0a(){this.xb&&this.gridView.eb?this.k0a=null:this.KC=null}N6h(va,Pa){const Ha={IndentationIncrease:0};if(-1942512156===va)Ha.IndentationIncrease=1;else if(-1920201820===va)Ha.IndentationIncrease=-1;else return!0;Ha.ValidMembers=256;this.Ag.formatCells(va,Ha,Pa);return!0}n7h(va,Pa){var Ha=this.gridView.Sb(null);Ha=wb.a(Ha);var tb=
va;!Ga.h(this.$).rtl||-1649235364!==va&&524773427!==va||(tb=-1649235364===va?524773427:-1649235364);switch(tb){case -1649235364:tb=T.a.rotateTextUp45;break;case 524773427:tb=T.a.Qvc;break;case 1886217042:tb=T.a.rotateTextUp90;break;case 928057943:tb=T.a.Svc;break;case -1526602249:tb=T.a.verticalText;break;default:return!1}Ha.ValidMembers=512;const Ya=Ha.TextOrientation;Ha.TextOrientation=tb===Ya||Ya===T.a.Pvc&&tb===T.a.Qvc||Ya===T.a.Rvc&&tb===T.a.Svc?0:tb;this.Ag.formatCells(va,Ha,Pa);return!0}K6h(){const va=
Ga.h(this.$),Pa=U.r(va.ha.ra.selectedRanges,this.$),Ha=U.o(va.ha.ra.activeCell,this.$);w.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return N.a(this.$.userOperationManager,(tb,Ya,V)=>sa.r(this.$.pa.ya,Ha,Pa,tb,Ya,V,null),tb=>new W.a(201,0,tb),null)}G9e(va,Pa){let Ha=null;var tb=Ga.h(this.$).ha.ra.selectedRanges;tb=this.gridView.caa("MoreColors",tb,1,!0);try{for(tb.$$rst();tb.$$mn();){const Ya=tb.$$cu().cell;if(!Ya)continue;let V=Ob.black;if(1970784898===
va)V=Ya.color;else if(1650812936===va){const za=Ya.backgroundColor;V=fa.a.compare(za,Ob.EZd,!0)&&fa.a.compare(za,Ob.empty,!0)?Ya.backgroundColor:Ob.white}if(!Ha)Ha=V;else if(Ha!==V){Ha=Ob.black;break}}}finally{tb&&tb.dispose()}this.xb&&this.gridView.eb&&1970784898===va&&this.gridView.Ai.textBox.ixe();return this.moreColorsHelper.UCb(va,Pa,Ha)}a7h(va){const Pa=B.a.h5a(this.borderFormatManager.N3);return this.moreColorsHelper.UCb(-236759591,va,Pa)}Yob(va,Pa,Ha,tb=!1){Pa?this.gridView.Ai.WMf(Ha.Font):
(this.KAi(va),tb?window.requestAnimationFrame(()=>{A.FocusManager.instance().wk(z.AFrame.naa);this.gridView.Ai.uYe(Ha.Font)}):(A.FocusManager.instance().wk(z.AFrame.naa),this.gridView.Ai.uYe(Ha.Font)),this.N0a())}KAi(va){const Pa=C.a(va.command);va=x.a[va.$e]+"_"+D.a[va.method];const Ha=this.gridView.fc.KAe.toString(),tb=new Map;tb.set("Command",Pa);tb.set("Source",va);tb.set("Ribbon","React");tb.set("CellTextRuns",Ha);J.Health.instance.recordKpiUsage(Y.a.BHh,0,lb.a.yYf,tb)}Sjd(va,Pa,Ha){va=this.borderFormatManager.Sjd(va,
Pa,Ha);this.moreColorsHelper&&this.moreColorsHelper.xda(Pa,this.borderFormatManager.N3,Ha);return va}getThemeColor(va){let Pa;Pa={};let Ha=!1;if((va.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return w.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:Pa};let tb;({themeIndex:va,aCa:tb,returnValue:Ha}=this.themesManager.getThemeColor(va.Color));Ha&&(Pa.ThemeColorIndex=va,Pa.ThemeColorRow=tb)}return{returnValue:Ha,
themeColor:Pa}}static get a3i(){return Ob.Uge||(Ob.Uge=RegExp("^[0-9]+[.]?[0-9]*$"))}static get Nnd(){return Ob.pae||(Ob.pae={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get $Za(){return Ob.qhb||(Ob.qhb={["-394785302"]:0,["-571165336"]:2,
["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3,["2007171328"]:6})}static get ouf(){return Ob.hee||(Ob.hee={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static zmi(va){return-1150205178===va||-1142465846===va||-286432209===va||2007171328===va}static vxc(va){const Pa={},Ha={};Pa.ValidMembers=16;Pa.Font=Ha;Ha.ValidMembers=va;return Pa}static L1e(va,Pa){let Ha;Ha=va.top<Pa.top?3:va.bottom>Pa.bottom?0:-1;return Ha=va.left<Pa.left?1:va.right>Pa.right?2:Ha}}
Ob.EZd="transparent";Ob.notSet="-1";Ob.black="#000000";Ob.empty="";Ob.white="#FFFFFF";Ob.pae=null;Ob.qhb=null;Ob.hee=null;Ob.Uge=null;Ob.tKa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(u.a)(Ob,"GridCommandHandler",null,[223]);class eb extends l.a{constructor(va){super(va)}ld(){const va=e.GetServiceTaskFactory.create(this.$.da,111,this.la,this.Ya),Pa=e.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Ya),Ha=e.GetServiceTaskFactory.create(this.$.da,397,this.la,this.Ya),tb=e.GetServiceTaskFactory.Oa(this.$.da,
502,503,this.Ya);if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const Ya=e.GetServiceTaskFactory.Oa(this.$.da,296,468,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Ed([va,Pa,Ha,Ya,tb],this.la),()=>{this.Yc([new Ob(this.$,Ga.h(this.$),Pa.result,va.result,Ya.result,Ha.result,tb.result)])},this.la,3)}else{const Ya=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Ed([va,Pa,Ya,Ha,tb],this.la),()=>{this.Yc([new Ob(this.$,
Ga.h(this.$),Pa.result,va.result,new h.BorderFormatManager(this.$,Pa.result,Ya.result),Ha.result,tb.result)])},this.la,3)}}static ka(va){l.a.Nd(80,new eb(va))}}Object(u.a)(eb,"GridCommandHandlerFactory",l.a,[]);a.d(E,"a",function(){return Ma});const Ma=()=>{c.a.Fa(eb.ka);c.a.Fa(m.ka)}},1173:function(u,E,a){function c(ra){return Object(y.c)(ra)?"cache":"client"===ra.origin||ra.cached?"client":"server"}function b({x:ra,y:pa},ba,fa=document){let Ka=-1,aa=null;void 0!==fa.caretPositionFromPoint?(ra=fa.caretPositionFromPoint(ra,
pa),null!==ra&&(Ka=ra.offset,aa=ra.offsetNode)):void 0!==fa.caretRangeFromPoint&&(ra=fa.caretRangeFromPoint(ra,pa),null!==ra&&(Ka=ra.startOffset,aa=ra.startContainer));return null===aa||-1===Ka?(r.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),-1):ba.contains(aa)?e(ba,aa,Ka):(r.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),-1)}function e(ra,pa,ba){if(ra===pa)return ba;if(pa.textContent!==pa.parentElement.textContent)for(;null!==
pa.previousSibling;)pa=pa.previousSibling,ba+=pa.textContent.length,"div"===pa.nodeName.toLowerCase()&&(ba+=1);return e(ra,pa.parentElement,ba)}function f(ra,pa){return ra.text===pa.text&&ra.start===pa.start&&ra.length===pa.length}function d(ra,pa,ba){if(ra.has(pa))return ra.get(pa);ba=ba();ra.set(pa,ba);return ba}function h(ra){return JSON.stringify({text:ra.text,start:ra.start,length:ra.length})}function m(ra){return Object(y.c)(ra)?"Undefined text":""===ra?"Empty text":null}var l=a(9);u=a(0);var w=
a(222),n=a(163),y=a(725),t=a(21),r=a(15),v=a(11),B=a(22),A=a(13),z=a(216),x=a(34),D=a(33),J=a(1094),L=a(1);class T{constructor(ra){this.$=ra;this.UIa=this.Ysb=null;this.usage={};this.results={};this.performance={};this.prc=-1;this.isEnabled=!1;this.pZc=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7190603_FATMAvoidSilentReopen");this.Bc=(pa,ba)=>{this.pZc&&(ba.Nf||ba.Sgf)||this.$.sendBeaconTraceTag(388818255,50,!1,this.JYd())};if(this.isEnabled=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7147898_ValuePreviewTelemetry"))this.editBox=
Object(t.h)(this.$).Vb,ra.ik(this.Bc)}static getInstance(ra){return T.instance||(T.instance=new T(ra))}set trigger(ra){this.isEnabled&&(this.Ysb=ra,this.prc=J.a.qYd)}set RNd(ra){this.isEnabled&&(this.UIa=ra)}setResult(ra,pa){if(this.isEnabled)if(Object(y.c)(this.Ysb))r.ULS.sendTraceTag(512258439,0,15,"ValuePreviewTelemetry.setResult - currentTrigger undefined");else{var ba=pa===this.editBox?"cellEditor":"formulaBar",fa=this.Ysb;pa=this.UIa;var Ka=this.prc;Object(y.c)(this.usage[ba])&&(this.usage[ba]=
{});Object(y.c)(this.usage[ba][fa])&&(this.usage[ba][fa]={success:0,error:0,unavailable:0});ba=this.usage[ba][fa];switch(ra.kind){case 1:this.KJd(ra.text);ba.success++;this.Ysb=this.UIa=null;this.prc=-1;break;case 2:ba.error++;this.Ysb=null;this.prc=-1;break;case 3:ba.unavailable++}this.yw(pa,Ka)}}KJd(ra){if(!Object(y.c)(this.UIa)){Object(y.c)(this.results[this.UIa.origin])&&(this.results[this.UIa.origin]=[]);var pa=this.results[this.UIa.origin];1E3>pa.length&&pa.push(ra.length)}}yw(ra,pa){if(-1!==
pa){ra=c(ra);this.y4e(`${ra}_request`).j4(!0,pa);var ba=this.y4e(`${ra}_overall`);window.requestAnimationFrame(()=>{ba.j4(!0,pa)})}}y4e(ra){return this.performance[ra]=this.performance[ra]||new J.a(O)}JYd(){const ra={};Object.keys(this.performance).forEach(pa=>{this.performance[pa].DWe();var ba=this.performance[pa];ra[pa]={metrics:ba.mW,durations:ba.Ytb}});return`{"usage":${JSON.stringify(this.usage)},"results":${JSON.stringify(this.results)},"performance":${JSON.stringify(ra)}}`}}Object(u.a)(T,"ValuePreviewTelemetry",
null,[]);const O=[50,80,100,130,150,170,200];class G{constructor(ra,pa,ba){this.$=ra;this.vKa=pa;this.ariaLiveNotifier=ba;this.gdi();this.editBox=Object(t.h)(this.$).Vb;this.UBj=D.a.eR(this.$)}get telemetry(){return T.getInstance(this.$)}get zoomManager(){this.Pme||(this.Pme=Object(x.a)(this.$));return this.Pme}dispose(){this.hide()}show(ra,pa,ba){const fa=Object.assign(Object.assign({},pa),{XM:ra,w2d:ba});this.seb(fa)&&(this.joa(fa)&&this.hide(),this.bD=fa,this.telemetry.setResult(pa,ra),this.Sy(),
ba&&this.$$h())}hide(){if(this.bD){var ra=this.bD.w2d;this.ilh();ra&&this.Qdj();this.bD=void 0}}seb(ra){var pa;(pa=!this.bD)||(pa=this.bD,pa=!(pa.XM===ra.XM&&pa.kind===ra.kind&&pa.text===ra.text&&pa.start===ra.start&&pa.length===ra.length&&pa.w2d===ra.w2d));return pa}joa(ra){var pa;if(pa=this.bD)pa=this.bD,pa=!(pa.XM===ra.XM&&pa.start===ra.start&&pa.length===ra.length);return pa}$$h(){this.bD.XM.textBox.formatText(this.bD.start,this.bD.length,{background:"rgba(202,234,216,0.6)"})}Qdj(){const ra=this.bD.XM,
pa=this.bD.start,ba=this.bD.length,fa=ra.text;fa.length<pa+ba?r.ULS.shipAssertTag(521019917,0,!1,`FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, ${fa.length}:${pa}:${ba}`):(ra.textBox.formatText(pa,ba,{background:!1}),this.UBj&&ra.$B(null))}Sy(){var ra=this.bD.text;switch(this.bD.kind){case 1:case 2:ra={isLoaded:!0,value:ra};break;case 3:ra={isLoaded:!1,value:null};break;default:return}this.FYj();this.vKa.renderValuePreview(this.Ts,this.mPb,ra);this.U0i(ra)}ilh(){this.vKa.dismiss(this.Ts)}gdi(){this.Ts=
document.createElement("div");this.mPb=document.createElement("div");this.mPb.style.position="absolute";this.mPb.style.visibility="hidden";this.$.domElement.appendChild(this.mPb)}FYj(){var ra=this.bD.XM,pa=this.bD.start;const ba=this.bD.length,fa=B.a.contains(ra.text.substring(pa,pa+ba),"\n",!0);ra=excelOnline.utils.getBoundingRectForText(ra.textBox.Le,pa,fa?pa:pa+ba,!1);pa=new z.a(this.mPb.style);pa.XB.left=this.Izc(ra.left);pa.XB.top=this.Izc(ra.top);pa.XB.width=this.Izc(ra.width);pa.XB.height=
this.Izc(ra.height);pa.V2()}Izc(ra){var pa=this.bD.XM;pa=Object(y.b)(this.zoomManager)&&pa===this.editBox;return v.HelperMethods.uc(pa?this.zoomManager.zi(ra):ra)}U0i({isLoaded:ra,value:pa}){ra?this.ariaLiveNotifier.readText(String.format(A.a.instance.nb(179),pa)):this.ariaLiveNotifier.readText(A.a.instance.ga(865))}}Object(u.a)(G,"FormulaAssistanceValuePreviewControl",null,[2]);var C=a(113);class H{constructor(ra){this.cache=ra}clearCache(){this.cache=void 0}}Object(u.a)(H,"Cacheable",null,[]);class I extends H{constructor(ra,
pa){super();this.$=ra;this.callbacks=pa;this.XAf=(ba,fa)=>{const Ka=this.gridView.Ai;if(!(0<(Ka.eb?Ka.textBox.selection:{index:0,length:0}).length))switch(fa.state){case 0:this.onHoverEnter(ba,fa.event);break;case 1:this.onHoverLeave(ba);break;default:return r.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),fa}};this.WAf=(ba,fa)=>{const Ka=fa.selection;fa={kind:"selection",text:fa.text,start:Ka.index,length:Ka.length};if(0<Ka.length)this.onSelectionChange(ba,
fa);else this.LGf(ba,fa)};this.gridView=Object(t.h)(this.$);this.editBox=this.gridView.fc;this.Lj(this.editBox);this.formulaBar=Object(C.a)(this.$);Object(y.b)(this.formulaBar)?this.Lj(this.formulaBar):Object(C.b)(this.$,ba=>{this.formulaBar=ba;this.Lj(this.formulaBar);r.ULS.sendTraceTag(509870663,1,50,"FormulaAssistanceValuePreviewHandler: formulaBar async")})}get telemetry(){return T.getInstance(this.$)}dispose(){this.gk(this.editBox);this.gk(this.formulaBar)}trigger(){const ra=this.gridView.Ai,
pa=ra.textBox.selection;this.onSelectionChange(ra,{kind:"shortcut",text:ra.text,start:pa.index,length:pa.length})}Lj(ra){ra.Dqe(this.XAf);ra.MJg(this.WAf)}gk(ra){null===ra||void 0===ra?void 0:ra.BUf(this.XAf);null===ra||void 0===ra?void 0:ra.dfj(this.WAf)}onHoverEnter(ra,pa){pa=new Sys.UI.Point(pa.clientX,pa.clientY);pa=b(pa,ra.textBox.Le);if(-1!==pa)this.onSelectionChange(ra,{kind:"hover",text:ra.text,start:pa,length:0})}onHoverLeave(ra){this.LGf(ra)}onSelectionChange(ra,pa){this.jBj(pa)&&(this.cache=
pa,this.callbacks.QDd(ra,{index:pa.start,length:pa.length}),this.telemetry.trigger=pa.kind)}LGf(ra,pa){this.fBj(pa)&&(this.clearCache(),this.callbacks.sPa(ra))}jBj(ra){return!this.cache||!f(this.cache,ra)}fBj(ra){return this.cache&&ra?"shortcut"!==this.cache.kind||!f(this.cache,ra):!0}}Object(u.a)(I,"FormulaAssistanceValuePreviewHandler",H,[2]);var M;(function(ra){ra[ra.Failure=0]="Failure";ra[ra.Success=1]="Success";ra[ra.Error=2]="Error";ra[ra.Unavailable=3]="Unavailable"})(M||(M={}));Object(u.b)("ValuePreviewResultKind",
M);var Q=a(42),U=a(60);class N{constructor(ra,pa){this.$=ra;this.pluginScheduler=pa;this.ZR=new X(h);this.h1f=new X(h);this.IVi=(ba,fa)=>Ka=>{if(Object(y.c)(Ka.Result))fa("No result");else if(Ka=JSON.parse(Ka.Result),Object(y.c)(Ka))fa("Failed to deserialize");else if(1!==Object.keys(Ka).length)fa("Invalid response");else{for(var aa in Ka)var ja=Ka[aa];aa=m(ja);Object(y.b)(aa)?fa(aa):ba(ja)}};this.HVi=ba=>()=>{ba("Request failed")};this.gridView=Object(t.h)(this.$);if(this.Kvb=D.a.zV(this.$))this.formulaAssistanceManager=
ra.da.za(464)}get telemetry(){return T.getInstance(this.$)}clearCache(){this.ZR.clear();this.h1f.clear()}request(ra){return Object(n.a)(this,void 0,void 0,function*(){return d(this.ZR,ra,()=>Object(n.a)(this,void 0,void 0,function*(){const {kind:pa,payload:ba}=yield this.pluginScheduler.getRequester().valuePreview(ra,this.formulaAssistanceManager?this.formulaAssistanceManager.dbb:0);if(0!==pa)return null;if(Object(y.c)(ba))return{kind:0};this.telemetry.RNd={origin:"client"};switch(ba.kind){case 0:return{kind:0};
case 1:case 2:return this.M_j(ba);case 3:const fa={text:ra.text,start:ba.start,length:ba.length};return this.ZR.has(fa)?(this.telemetry.RNd={origin:"server",cached:!0},yield this.ZR.get(fa)):Object.assign(Object.assign({},ba),{kind:3,next:()=>this.Ijj(fa,ra,ba.text)})}}))})}M_j(ra){const pa=m(ra.text);return Object(y.b)(pa)?(r.ULS.sendTraceTag(509871621,1,15,`FormulaAssistanceValuePreviewRequester.validateClientSuccessResult: formula failure:${pa}, kind:${M[ra.kind]}`),{kind:0}):ra}Ijj(ra,pa,ba){return Object(n.a)(this,
void 0,void 0,function*(){return d(this.h1f,ra,()=>{const fa=new Promise(Ka=>Object(n.a)(this,void 0,void 0,function*(){try{const aa=yield this.$Xh(ba);this.telemetry.RNd={origin:"server"};Ka({kind:1,text:aa,start:ra.start,length:ra.length})}catch(aa){r.ULS.sendTraceTag(520495426,1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${aa}`),Ka({kind:0})}}));fa.then(()=>{this.ZR.set(ra,fa);this.ZR.set(pa,fa)}).catch(Ka=>{r.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${Ka}`)});
return fa})})}$Xh(ra){return Object(n.a)(this,void 0,void 0,function*(){return new Promise((pa,ba)=>{const fa={Formula:ra,PartialFormula:ra,SourceRange:Object(Q.v)(this.gridView.ha.ra.activeCell,this.$)};W(this.$.pa.ya,fa,this.IVi(pa,ba),this.HVi(ba),null,null)})})}}Object(u.a)(N,"FormulaAssistanceValuePreviewRequester",null,[]);const W=(ra,pa,ba,fa,Ka,aa,ja=null)=>{ja=ra.Na(1,ja);ja.getPartialCalcResultsParameters=pa;return Object(U.g)(ra,"GetPartialCalcResults",ja,ba,fa,Ka,aa,4)};class X{constructor(ra){this.KYd=
ra;this.map=new Map}has(ra){ra=this.KYd(ra);return this.map.has(ra)}get(ra){ra=this.KYd(ra);return this.map.get(ra)}set(ra,pa){ra=this.KYd(ra);this.map.set(ra,pa);return this}clear(){this.map.clear()}}Object(u.a)(X,"RequestMap",null,[]);class sa{constructor(ra,pa,ba,fa){this.$=ra;this.QDd=(Ka,aa)=>Object(n.a)(this,void 0,void 0,function*(){const ja={text:Ka.text,start:aa.index,length:aa.length};void this.TNf(ja,this.requester.request.bind(this.requester),Ka,0===ja.length)});this.sPa=()=>{this.hide()};
this.reset=()=>{this.handler.clearCache();this.requester.clearCache();this.hide()};this.Ay=()=>{this.handler.clearCache();this.requester.clearCache()};this.gridView=Object(t.h)(this.$);this.control=new G(this.$,ba,fa);this.requester=new N(this.$,pa);this.handler=new I(this.$,{QDd:this.QDd,sPa:this.sPa});this.Lj()}trigger(){this.handler.trigger()}dispose(){this.gk();this.handler.dispose();this.control.dispose()}Lj(){this.gridView.Vb.Rm(this.reset);this.gridView.ha.bha(this.reset);this.$.ea.JE(this.Ay)}gk(){this.gridView.Vb.em(this.reset);
this.gridView.ha.nna(this.reset);this.$.ea.$D(this.Ay)}TNf(ra,pa,ba,fa){return Object(n.a)(this,void 0,void 0,function*(){const Ka=Object.assign(Object.assign({},ra),{XM:ba,wTd:fa});this.SIa=Ka;const aa=yield pa(ra);Object(y.c)(aa)||this.Ipi(Ka)&&void this.S7h(aa)})}S7h(ra){return Object(n.a)(this,void 0,void 0,function*(){const pa=this.SIa.text,ba=this.SIa.XM,fa=this.SIa.wTd;switch(ra.kind){case 0:this.hide();break;case 1:case 2:this.show(ba,ra,fa);break;case 3:if(!this.msi(ra))break;this.show(ba,
ra,fa);void this.TNf({text:pa,start:ra.start,length:ra.length},ra.next,ba,fa);break;default:return ra}})}show(ra,pa,ba){this.SIa=void 0;this.Qpi(pa)&&(this.control.show(ra,pa,ba),this.Ssb=pa)}hide(){this.control.hide();this.Ssb=this.SIa=void 0}Ipi(ra){var pa;if(pa=this.SIa)pa=this.SIa,pa=pa.text===ra.text&&pa.start===ra.start&&pa.length===ra.length&&pa.XM===ra.XM&&pa.wTd===ra.wTd;return pa}Qpi(ra){return Object(y.b)(ra.text)&&""!==ra.text}msi(ra){return!this.Ssb||this.Ssb.start!==ra.start||this.Ssb.length!==
ra.length||3===this.Ssb.kind}}Object(u.a)(sa,"FormulaAssistanceValuePreview",null,[456,2]);var da=a(50),S=a(37);class oa extends w.a{constructor(ra){super();this.$=ra;this.Fb()}static ka(ra){ra.da.Ga(497,new oa(ra))}create(){let ra=this.$.da.za(496);ra&&this.ob(ra);const pa=da.GetServiceTaskFactory.Oa(this.$.da,413,414,this.Ya),ba=da.GetServiceTaskFactory.Oa(this.$.da,448,449,this.Ya),fa=da.GetServiceTaskFactory.Oa(this.$.da,19,153,this.Ya),Ka=da.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Ya);
S.TaskExtensions.Aa(S.TaskExtensions.Ed([pa,ba,fa,Ka],this.la),()=>{ra=this.$.da.za(496);ra||(ra=new sa(this.$,pa.result,ba.result,Ka.result),this.$.da.Ga(496,ra));this.ob(ra)},this.la,3)}}Object(u.a)(oa,"FormulaAssistanceValuePreviewFactory",w.a,[]);var K=a(692),ea=a(183),ya=a(55);class ha{constructor(ra,pa){this.formulaAssistanceValuePreview=pa;this.gridView=Object(t.h)(ra)}nc(){return!1}executeCommand(ra,pa){ra=!1;pa=pa.command;switch(pa){case -46938080:this.formulaAssistanceValuePreview.trigger(),
ra=!0}return ra?ya.Task.Ta(!0):ea.a(pa)}wc(ra,pa){return-46938080===pa.command}Kc(){return!1}}Object(u.a)(ha,"FormulaAssistanceValuePreviewCommandHandler",null,[223]);class La extends K.a{constructor(ra){super(ra)}ld(){const ra=da.GetServiceTaskFactory.Oa(this.$.da,496,497,this.Ya);S.TaskExtensions.Aa(ra,()=>{this.Yc([new ha(this.$,ra.result)])},this.la)}static ka(ra){K.a.Nd(515,new La(ra))}}Object(u.a)(La,"FormulaAssistanceValuePreviewCommandHandlerFactory",K.a,[]);a.d(E,"a",function(){return Ia});
const Ia=()=>{l.a.Fa(ra=>{oa.ka(ra);La.ka(ra)})}},1179:function(u,E,a){u=a(0);var c=a(15),b=a(187),e=a(84),f=a(83),d=a(384),h=a(98),m=a(45);class l{constructor(){this.yda=this.KZe=null}}Object(u.a)(l,"GestureAdapterInfo",null,[]);var w=a(4),n=a(374),y=a(228);class t{constructor(){this.ZIc=null}Twi(){if(!this.ZIc){var Q="hammer.min.js";w.AFrameworkApplication.fa.Zp("IsServerFlavorDebug")&&(Q=w.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");Q=w.AFrameworkApplication.xL(String.format("{0}",
Q),5);Q=y.a.create(Q,null,null);n.a.Sia(Q);this.ZIc=Q.k9a}return this.ZIc}static get instance(){t.Ma||(t.Ma=new t);return t.Ma}}t.Ma=null;Object(u.a)(t,"HammerJsDependencyLoader",null,[581]);var r=a(14);const v=(Q,U,N=null)=>{if(void 0===U||null===U)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let W=null;switch(Q){case r.a.pinch:W=new Hammer.Pinch(N);break;case r.a.pan:W=new Hammer.Pan(N)}W&&(W.manager=U);return W};var B;(function(Q){Q[Q.none=
-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(B||(B={}));Object(u.b)("GestureEvent",B);var A=a(77);class z extends A.a{constructor(Q,U,N,W,X,sa,da,S){super(Q,N,W,sa);this.Xhb=U;this.yga=da;this.QX=S;this.Hug=X}get shiftKey(){return this.yga}get ctrlKey(){return this.QX}get clientPoint(){return this.Xhb}get Bva(){return this.Hug}static create(Q,U,N,W,X,sa){if(N.rawEvent)if(sa){var da=N.rawEvent;da=new Sys.UI.Point(da.clientX,da.clientY)}else da=A.a.twb(N);else da=new Sys.UI.Point(N.clientX,
N.clientY);return new z(Q,da,U,N,W,X,N.shiftKey,N.ctrlKey,sa)}}Object(u.a)(z,"GestureEventArgs",A.a,[]);class x{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=
null}}Object(u.a)(x,"GestureManagerData",null,[]);class D{}D.pog=2;D.qog=4;D.rog=8;D.sog=8;Object(u.a)(D,"HammerConstants",null,[]);var J=a(92),L=a(205),T=a(30),O=a(79);class G extends m.a{constructor(Q,U){super();this.Fqa=d.a.nLh;this.vQc=!!window.PointerEvent;this.Ble=window.hasOwnProperty("ontouchstart");this.OWa=this.klb=null;this.i9=!1;this.kT=new h.a;this.Flb=new h.a;this.Iug=new b.a;this.aqa=null;this.TVa=this.OKc=this.f6d=this.IHc=this.qOc=this.aie=this.l6d=this.hnb=!1;this.Nkb=-1;this.curRecognizer=
this.element=this.handlers=this.session=this.cTc=null;this.Md=J.EventHandlerManager.instance;this.vQc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.klb=Object(e.a)(this,this.Gpc,"onPointerEvent"),this.OWa=r.a.pLh):this.Ble?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.klb=Object(e.a)(this,this.Aza,"onTouchEvent"),this.OWa=r.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.klb=Object(e.a)(this,this.qpc,"onMouseEvent"),this.OWa=r.a.oLh);
this.Ah=U;this.Bfa=Q;w.AFrameworkApplication.fa&&(this.hnb=w.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),this.l6d=w.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),this.aie=w.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),this.qOc=w.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),this.IHc=w.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.f6d=w.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),
this.OKc=w.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),this.TVa=this.hnb&&w.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&w.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"))}GTh(){return this.vQc?0:this.Ble?1:2}Dn(Q){super.Dn(Q);this.Md.Ika(this.OWa,Q,0,this.klb)}rm(Q){super.rm(Q);this.Md.eJa(Q,this.OWa)}ubj(Q,U,N=null){w.AFrameworkApplication.uic()?t.instance.Twi().continueWith(W=>{this.xJj();if(W.Xf||W.Ch)c.ULS.sendTraceTag(591192778,
310,10,"Hammer did not download correctly: {0}",W.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",W.status);if(this.f6d){W=window.Hammer;if("undefined"===typeof W){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.xAc();return}if("undefined"===typeof W.inputHandler){c.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.xAc();return}}if(!Q)throw this.xAc(),Error.argumentNull("source element can not be null");W=L.a.cwa(Q,this.Fqa);
if(void 0===W||null===W)W=new h.a,L.a.Sdb(Q,this.Fqa,W),this.vbj(Q);var X=null;W.mb(B[0])||(X=Object.assign(new l,{yda:v(B[0],this,null),KZe:U}),W.add(B[0],X));if(void 0!==N&&null!==N)for(let sa=0;sa<N.length;sa++)if(W.mb(B[N[sa]])){const da=W.na(B[N[sa]]);X.yda.recognizeWith(da.yda)}}this.xAc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}xJj(){this.OKc&&(this.Ah?this.cTc=this.Ah.Ac("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,
310,10,"_stopwatchBuilder is null"))}xAc(){this.OKc&&(this.cTc?this.cTc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}vbj(Q){this.Iug.add(Q);this.Md.Ika(this.OWa,Q,0,this.klb)}recognize(Q){var U=Array(Q.pointers.length);for(var N=0;N<Q.pointers.length;N++)U[N]=Q.pointers[N].target;N=null;for(this.aqa=this.ZVh(U);void 0!==this.aqa&&null!==this.aqa&&(N=L.a.cwa(this.aqa,this.Fqa),void 0===N||null===N);this.aqa=this.aqa.parentNode);if(void 0!==N&&
null!==N){this.curRecognizer&&this.curRecognizer.state===D.sog&&(this.curRecognizer=null);U=N.keys;for(let W of U){U=N.na(W);void 0!==U&&null!==U&&void 0!==U.yda&&null!==U.yda&&(void 0===this.curRecognizer||null===this.curRecognizer||U.yda===this.curRecognizer||U.yda.canRecognizeWith(this.curRecognizer))&&U.yda.recognize(Q);const X=U.yda.state;this.curRecognizer||D.pog!==X&&D.qog!==X&&D.rog!==X||(this.curRecognizer=U.yda)}}}emit(Q,U){if("hammer.input"!==Q){this.i9=!1;U=z.create(Q,this.aqa,U.srcEvent,
U,3,this.vQc);var N=L.a.cwa(this.aqa,this.Fqa);if(this.Foi(Q))var W=0;else if(this.voi(Q))W=1;else if(this.Dri(Q))W=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:N}=N.Dc(B[W]));void 0!==N&&null!==N&&((N=N.KZe,N.gmi())?Q.endsWith("start")?this.i9=N.POi(U):Q.endsWith("end")?(N.NOi(U),this.i9=!0):Q.endsWith("cancel")?(N.MOi(U),this.i9=!0):Q.endsWith("move")&&(this.i9=N.OOi(U)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",
Q))}}get(Q){return Object(f.a)(Hammer.Recognizer,Q)}ZVh(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];var U=Q[0],N=!0;for(let W=1;W<Q.length;W++){if(!Q[W])return null;if(U!==Q[W]){N=!1;break}}if(N)return U;U=this.c_e(Q[0]);N=0;for(const W of Q){Q=this.c_e(W);if(U.na(U.count-1)!==Q.na(Q.count-1))return null;for(let X=U.count-2,sa=Q.count-2;X>=N&&0<=sa;X--,sa--)if(U.na(X)!==Q.na(sa)){N=X+1;break}}return U.na(N)}c_e(Q){const U=new b.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)U.add(Q);return U}T2e(Q){switch(Q){case r.a.Ef:case r.a.z$:return 1;
case r.a.Zf:case r.a.Dha:return 2;case r.a.xe:case r.a.wHa:return 4;case r.a.aCc:case r.a.g_c:return 8}return 0}Aza(Q,U,N){Q=this.T2e(Q);U=this.GUh(N);Hammer.inputHandler(this,Q,U);this.i9&&N.preventDefault();return this.i9}l$e(){return 1<this.kT.count}R2b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.hnb)for(let Q of this.kT)this.ATf(Q.key);else this.kT=new h.a;this.session=null}lHg(Q,U,N){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",
Q);if(!this.Flb.mb(Q)){try{U.setPointerCapture(Q)}catch(W){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",W)}this.Flb.add(Q,U)}this.kT.ia(Q,N);this.TVa&&1<this.kT.count&&this.Bfa&&!this.Bfa.Lqb&&(this.Bfa.Lqb=!0)}ATf(Q){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.Flb.mb(Q)){try{this.Flb.na(Q).releasePointerCapture(Q)}catch(U){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",U)}this.Flb.remove(Q)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",
Q);this.kT.remove(Q);this.TVa&&1>=this.kT.count&&this.Bfa&&this.Bfa.Lqb&&(this.Bfa.Lqb=!1)}Gpc(Q,U,N){var W=N.rawEvent.pointerType.toString();const X=N.rawEvent.pointerId.toString();if("touch"!==W)return!1;Q=this.T2e(Q);if(1!==Q&&!this.kT.mb(X))return!1;this.l6d&&1===Q&&N.rawEvent.isPrimary&&this.kT.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.R2b());this.hnb?this.lHg(X,U,N):this.kT.ia(X,N);this.qOc&&2===Q&&(!this.IHc||this.IHc&&"function"===typeof N.rawEvent.getCoalescedEvents)&&
(U=N.rawEvent.getCoalescedEvents())&&this.l$e()&&(this.Nkb=Math.max(this.Nkb,U.length));this.aie&&(this.i9=!1);W=this.FUh(this.kT,N,W);Hammer.inputHandler(this,Q,W);if(4===Q||8===Q)this.hnb?this.ATf(X):this.kT.remove(X),this.kT.count||(this.session=null,this.qOc&&-1!==this.Nkb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Nkb),this.Nkb=-1));this.i9&&N.preventDefault();return this.i9}qpc(){return!1}GUh(Q){const U=new x;var N=Q.rawEvent;const W=N.touches;N=N.changedTouches;
U.pointers=Array.clone(W);U.pointers=Array.clone(0<W.length?W:N);U.changedPointers=Array.clone(N);U.srcEvent=Q;U.pointerType="touch";return U}FUh(Q,U,N){const W=new x;W.pointers=O.toArray(Q.values);W.changedPointers=[U];W.pointerType=N;W.srcEvent=U;return W}Foi(Q){return T.a.startsWith(Q,r.a.pinch)}voi(Q){return T.a.startsWith(Q,r.a.pan)}Dri(Q){return T.a.startsWith(Q,r.a.swipe)}}Object(u.a)(G,"GestureInputManager",m.a,[555,556]);var C=a(276),H=a(248);class I{constructor(){this.gb=null;this.tx=!1}get name(){return"Common.App.GestureInputManager"}Wh(Q){Q.register(G,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").xc().Fc(()=>new G(C.a.instance,w.AFrameworkApplication.sa.iE));this.gb=Q}init(){this.tx||(this.gb.resolve("Common.App.GestureManager.GestureInputManager"),this.tx=!0)}dispose(){}static main(){H.a.instance.Fi(new I)}}Object(u.a)(I,"GestureInputManagerPackage",null,[4,5]);a.d(E,"a",function(){return M});const M=()=>{Type.registerNamespace("Common.App.GestureManager");I.main()}},1190:function(u,E,a){var c=a(9);u=a(0);
var b=a(222),e=a(27),f=a(87),d=a(30),h=a(416),m=a(238);class l{}l.yth="ewa-dv";l.zth="ewa-dv-buttonarea";l.Fsh="ewa-dlb";l.hDb="list-table";l.listItem="list-item";l.eDb="list-item-selected";l.iDb="list-table-touch";l.xth="ewa-dpb";l.Inh="dv-prompt-title";l.Hnh="dv-prompt-message";Object(u.a)(l,"CssClassNames",null,[]);var w=a(31),n=a(732),y=a(19),t=a(49),r=a(426),v=a(76),B=a(7),A=a(15),z=a(154),x=a(820),D=a(37),J=a(13),L=a(21),T=a(262),O=a(66);class G extends z.ErrorDialog{constructor(mb,Ga,ib){super(mb,
G.MQ(Ga,mb,ib));this.Pc=()=>{this.setFocus()};L.h(this.$).ha.iH(this.Pc);(mb=mb.da.za(14).F4a(ib))&&mb.options&1&&A.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){L.h(this.$).ha.jG(this.Pc);super.dispose()}setFocus(){switch(this.error.Severity){case 0:var mb=4;break;case 1:mb=3;break;case 2:mb=0;break;default:mb=this.LM}(mb=this.getButton(mb))?mb.get_element().focus():super.setFocus()}Grb(){const mb=
L.h(this.$);mb.eb&&mb.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.gWd(1);if(2===this.returnValue||0===this.returnValue){const Ga=mb.Sb(null);if(Ga){mb.Ea.xV();const ib=Object(B.a)(new T.a,{Text:Ga.originalText});mb.setCell(ib,Ga.range,0,63,null)}this.$.Xc(-798660877,v.a.Db,8,null)}super.Grb()}Zsa(){const mb=L.h(this.$);mb.eb&&mb.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.gWd(0);super.Zsa()}gWd(mb){const Ga=
L.h(this.$);D.TaskExtensions.Aa(Ga.startEdit(!1,mb),()=>{const ib=Ga.Vb.textBox;ib.text&&ib.selectRange(0,ib.text.length)},this.la,11,O.a.current)}static MQ(mb,Ga,ib){ib=Ga.da.za(14).F4a(ib);mb.MessageId=-1083021405;mb.MessageIdName="DataValidationError";mb.MessageIdHash=d.a.mw(mb.MessageIdName);mb.Severity=ib?ib.s$c:1;Ga=(null===ib||void 0===ib?0:ib.NJa)?d.a.Gg(ib.NJa):null;ib=(null===ib||void 0===ib?0:ib.error)?d.a.Gg(ib.error):String.format("<p>{0}</p><p>{1}</p>",J.a.instance.ga(895),J.a.instance.ga(896));
switch(mb.Severity){case 0:mb.Appearance=18;break;case 1:mb.Appearance=12;ib+=String.format("<p>{0}</p>",J.a.instance.ga(897));break;default:mb.Appearance=3}mb.Caption=Ga;mb.Description=ib;mb.HelpDescription=J.a.instance.ga(1315);mb.HelpTopicId=x.a.BJe;return mb}}Object(u.a)(G,"DataValidationErrorDeprecatedDialog",z.ErrorDialog,[]);z=a(284);var C=a(1084),H=a(5),I=a(42),M=a(283),Q=a(192),U=a(53),N=a(29),W=a(282),X=a(1),sa=a(11),da=a(281),S=a(159);class oa extends z.a{constructor(mb,Ga,ib){super(mb);
this.QU=this.Oq=null;this.wkf=!1;this.nX=this.Sm=this.Daf=this.errorMessage=null;this.CJe=cc=>{const ic=this.$;var xb=this.wkf;this.hide();const Vb=L.h(ic);Vb.eb&&Vb.Vb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===cc&&xb&&D.TaskExtensions.Aa(Vb.startEdit(!1,1),()=>{const wb=Vb.Vb.textBox;wb.text&&wb.selectRange(0,wb.text.length)},this.la,11,O.a.current);if(1===cc&&!xb){if(xb=Vb.Sb(null)){Vb.Ea.xV();const wb=Object(B.a)(new T.a,{Text:xb.cell.userInput});Vb.setCell(wb,
xb.range,0,63,null)}ic.Xc(-798660877,v.a.Db,8,null)}2===cc&&D.TaskExtensions.Aa(Vb.startEdit(!1,0),()=>{const wb=Vb.Vb.textBox;wb.text&&wb.selectRange(0,wb.text.length)},this.la,11,O.a.current)};this.KCd=()=>{sa.HelperMethods.eW(this.$.GG,this.error.HelpTopicId,this.$.GS)};this.JQi=()=>{this.Pyb();this.$.Xc(802602464,2,8,this.QU)};this.cPi=()=>{A.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};this.dPi=
cc=>{!cc||W.a(cc)?A.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(cc=this.H_h(cc.Result),this.Oq.errorInformation=cc,this.MUa(this.NJa,this.l5a(this.CJe),this.Oq))};this.tCd=()=>{this.show(this.nTb)};this.IPe=ib;this.sqmManager=S.a(this.$);this.error=oa.MQ(Ga,mb,ib);this.rb.kp=this;this.NJa=(this.sv=mb.da.za(14).F4a(this.IPe))&&this.sv.NJa?this.sv.NJa:J.a.instance.ga(1727);this.Vtj();this.initializeAndShow(this.NJa,
this.CJe,this.Oq)}get pc(){return"DataValidationErrorDialog"}dispose(){this===this.rb.kp&&(this.rb.kp=null);f.a.Ia(this.Sm);this.Sm=null;super.dispose()}Vtj(){this.sv&&this.sv.error?this.errorMessage=this.sv.error:this.sv&&this.sv.options&1?(A.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=J.a.instance.ga(1729),this.Daf=U.a.current.fo(120)):(this.errorMessage=J.a.instance.ga(1728),this.AQh(this.IPe));var mb=
this.sv?this.sv.s$c:1;this.Oq={[oa.uu]:this.pc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.Daf};switch(mb){case 0:this.Rb=1;this.oc(1,"Retry");this.Oq.dialogIcon=2;this.wkf=!0;break;case 1:this.Rb=4;this.Oq.dialogIcon=1;this.Oq.additionalInformation=J.a.instance.ga(897);break;default:this.Rb=1,this.Oq.dialogIcon=3}this.Oq.helpLink={["type"]:"AppLinkProps",[oa.uu]:this.error.HelpTopicId,["text"]:J.a.instance.ga(1315),["handler"]:this.KCd};mb=N.a.nYc([this.error]);this.QU={[H.a.B$b]:!0,
[H.a.ybd]:mb,[H.a.zbd]:S.a(this.$).wub(this.error.MessageIdHash),[H.a.CQ]:this.pc,["DismissHandler"]:this.tCd};this.Oq.giveFeedbackLink={["type"]:"AppLinkProps",[oa.uu]:H.a.zjd,["text"]:J.a.instance.ga(1766),["handler"]:this.JQi}}AQh(mb){const Ga=this.$.pa.ya.Wb();M.g(this.$.pa.ya,I.q(mb,this.$),da.b(this.dPi),da.a(this.cPi),null,Ga)}H_h(mb){let Ga;X.EwaSettings.isChangeGateEnabled("OfficeVSO:7253041_adddatavalidationerrortypetelemetry");A.ULS.sendTraceTag(509732815,0,50,`DataValidationErrorDialog.getRuleDescriptionString: The data validation error is because of ${C.a[mb.RuleType].toString()}`);
switch(mb.RuleType){case 1:switch(mb.ConditionType){case 0:return Ga=J.a.instance.nb(108),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);case 1:return Ga=J.a.instance.nb(109),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);case 2:return Ga=J.a.instance.nb(110),String.format(Ga,mb.LowerBoundary);case 3:return Ga=J.a.instance.nb(111),String.format(Ga,mb.LowerBoundary);case 4:return Ga=J.a.instance.nb(112),String.format(Ga,mb.LowerBoundary);case 5:return Ga=J.a.instance.nb(113),String.format(Ga,
mb.UpperBoundary);case 6:return Ga=J.a.instance.nb(114),String.format(Ga,mb.LowerBoundary);case 7:return Ga=J.a.instance.nb(115),String.format(Ga,mb.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(mb.ConditionType){case 0:return Ga=J.a.instance.nb(116),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);case 1:return Ga=J.a.instance.nb(117),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);case 2:return Ga=J.a.instance.nb(118),String.format(Ga,mb.LowerBoundary);case 3:return Ga=
J.a.instance.nb(119),String.format(Ga,mb.LowerBoundary);case 4:return Ga=J.a.instance.nb(120),String.format(Ga,mb.LowerBoundary);case 5:return Ga=J.a.instance.nb(121),String.format(Ga,mb.UpperBoundary);case 6:return Ga=J.a.instance.nb(122),String.format(Ga,mb.LowerBoundary);case 7:return Ga=J.a.instance.nb(123),String.format(Ga,mb.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(mb.ConditionType){case 0:return Ga=J.a.instance.nb(124),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);
case 1:return Ga=J.a.instance.nb(125),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);case 2:return Ga=J.a.instance.nb(126),String.format(Ga,mb.LowerBoundary);case 3:return Ga=J.a.instance.nb(127),String.format(Ga,mb.LowerBoundary);case 4:return Ga=J.a.instance.nb(128),String.format(Ga,mb.LowerBoundary);case 5:return Ga=J.a.instance.nb(129),String.format(Ga,mb.UpperBoundary);case 6:return Ga=J.a.instance.nb(130),String.format(Ga,mb.LowerBoundary);case 7:return Ga=J.a.instance.nb(131),String.format(Ga,
mb.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(mb.ConditionType){case 0:return Ga=J.a.instance.nb(132),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);case 1:return Ga=J.a.instance.nb(133),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);case 2:return Ga=J.a.instance.nb(134),String.format(Ga,mb.LowerBoundary);case 3:return Ga=J.a.instance.nb(135),String.format(Ga,mb.LowerBoundary);case 4:return Ga=J.a.instance.nb(136),String.format(Ga,mb.LowerBoundary);case 5:return Ga=
J.a.instance.nb(137),String.format(Ga,mb.UpperBoundary);case 6:return Ga=J.a.instance.nb(138),String.format(Ga,mb.LowerBoundary);case 7:return Ga=J.a.instance.nb(139),String.format(Ga,mb.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(mb.ConditionType){case 0:return Ga=J.a.instance.nb(140),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);case 1:return Ga=J.a.instance.nb(141),String.format(Ga,mb.LowerBoundary,mb.UpperBoundary);case 2:return Ga=J.a.instance.nb(142),String.format(Ga,
mb.LowerBoundary);case 3:return Ga=J.a.instance.nb(143),String.format(Ga,mb.LowerBoundary);case 4:return Ga=J.a.instance.nb(144),String.format(Ga,mb.LowerBoundary);case 5:return Ga=J.a.instance.nb(145),String.format(Ga,mb.UpperBoundary);case 6:return Ga=J.a.instance.nb(146),String.format(Ga,mb.LowerBoundary);case 7:return Ga=J.a.instance.nb(147),String.format(Ga,mb.UpperBoundary);default:return"we couldn't get the details"}case 3:return Ga=J.a.instance.nb(106),String.format(Ga,mb.LowerBoundary);case 7:return Ga=
J.a.instance.nb(107),String.format(Ga,mb.LowerBoundary);default:return"we couldn't get the details"}}gWd(mb){const Ga=L.h(this.$);D.TaskExtensions.Aa(Ga.startEdit(!1,mb),()=>{const ib=Ga.Vb.textBox;ib.text&&ib.selectRange(0,ib.text.length)},this.la,11,O.a.current)}get la(){this.Sm=this.Sm||new Q.a;return this.Sm.token}static MQ(mb,Ga,ib){Ga=Ga.da.za(14).F4a(ib);mb.MessageId=-1083021405;mb.MessageIdName="DataValidationError";mb.MessageIdHash=d.a.mw(mb.MessageIdName);mb.Severity=Ga?Ga.s$c:1;mb.HelpDescription=
J.a.instance.ga(1315);mb.HelpTopicId=x.a.BJe;return mb}}Object(u.a)(oa,"DataValidationErrorDialog",z.a,[99,100,2,101]);z=a(909);var K=a(382);class ea extends z.a{constructor(mb,Ga,ib){super(mb,Ga);this.dataValidationControl=ib}get jAb(){return Object(h.a)(oa,this.$.rb.Jh)}get GK(){return this.dataValidationControl.re}set GK(mb){this.dataValidationControl.re=mb}get t6a(){return!1}get key(){return K.a.T6c}dispose(){this.dataValidationControl=null;super.dispose()}Yh(mb,Ga){this.dataValidationControl.Za=
this.Za;const ib=mb.keyCode;return 1461300262!==Ga||16!==ib&&17!==ib&&18!==ib?super.Yh(mb,Ga):!1}zBd(){this.GK&&(this.dataValidationControl.Za=this.Za,this.dataValidationControl.show(this.dataValidationControl.DN,!0,!0,e.a.Dp||3===v.a.Db))}jg(){}rh(){this.dataValidationControl.show(this.dataValidationControl.DN,!0,!0,e.a.Dp||3===v.a.Db)}ZHd(mb,Ga){return this.dataValidationControl.Yh(Ga)}}Object(u.a)(ea,"DataValidationListAutoCompleteBehavior",z.a,[]);var ya=a(263);z=a(837);var ha=a(12),La=a(117),
Ia=a(22),ra=a(908);class pa extends z.a{constructor(mb,Ga,ib,cc){super(mb,Ga,new ra.a(l.listItem,l.eDb,l.hDb,l.iDb));this.$Ia=this.SV=this.Yda=this.ee=this.tmb=null;this.sOa=0;this.YGb=[];this.SVj=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");this.htmlSanitizationHelper=null;this.gDb=ib;this.htmlSanitizationHelper=cc}get Oj(){return this.tmb}set Oj(mb){this.fCa(this.tmb);if(mb){this.tmb=mb;this.gDb.innerText="";this.fCa(this.tmb);const Ga=this.YGb[mb.rowIndex];
this.ee=this.SV[Ga];this.$Ia&&(this.Yda=this.$Ia[Ga],A.ULS.shipAssertTag(537163286,0,!this.YGb.length||!!this.Yda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.gDb.innerText=this.ee;this.ywc(mb)}else this.Yda=this.ee=null}get eb(){return L.h(this.$).eb}get editText(){return L.h(this.$).Vb.text}dispose(){super.dispose();this.gDb=this.tmb=null}Oea(mb,Ga,ib,cc){if(mb&&(!mb||mb.length)){this.c8(!1);this.$Ia=mb;this.SV=[];for(var ic=0;ic<mb.length;ic++)this.SV[ic]=
mb[ic]?mb[ic].Name:null;ic=`<table class='${this.i6}' aria-live='polite'><tbody>`;var xb="",Vb="";mb=0;var wb=L.h(this.$).Sb(null);cc=this.eb?cc?cc.text:this.editText:wb?wb.originalText:null;wb=!cc;var cb=0;this.YGb.length=0;var lb=[],Y=[],Oa=[],Wa=cc?cc.split(" "):[""];cc=cc.trim();for(let Ra=0;Ra<this.SV.length;Ra++){const la=this.SV[Ra];var Ca=void 0;const ua=la.split(" ");Ca=ya.a.all(Wa,Jb=>ya.a.any(ua,Ob=>Ia.a.wG(Ob,Jb)));const xa=!la,fb=Oa.includes(la);xa||fb||this.eb&&!Ca||(Ca=la?d.a.Gg(d.a.A9c(la)):
"",Ca=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.RV,Ca),Oa.push(la),this.eb&&Ia.a.wG(la,cc)?(xb+=Ca,lb.push(Ra)):(Vb+=Ca,Y.push(Ra)),!wb&&Ia.a.equals(cc,la,!0)&&(mb=this.eb?lb.length-1:cb,wb=!0),cb++)}this.sOa=cb;this.YGb.push(...lb);this.YGb.push(...Y);ic+=xb+Vb+"</tbody></table>";X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7126089_ReduceInnerHTMLUsageForDataValidationListBox")&&this.htmlSanitizationHelper?
this.htmlSanitizationHelper.dk(this.Kf,ic):this.Kf.innerHTML=ic;ic=this.Kn=ha.DOMElementExtensions.nk(this.domElement,this.i6);this.bob(ic,Ga);this.c8(!0);this.tsa(Ga,ib);this.Oj=0<this.sOa?ic.rows[mb]:null}}ySa(mb){var Ga=!1;this.eb&&mb&&(Ga=!this.sOa,mb.endEdit(Ga,"DataValidationListBox.SetCellContent",0));if(!Ga&&(mb=L.h(this.$),Ga=mb.Sb(null))){let cc=null;if(this.Yda&&-1!==this.Yda.SheetId&&-1!==this.Yda.Row&&-1!==this.Yda.Column){var ib={};ib.SheetName=this.Yda.SheetId.toString();ib.FirstRow=
this.Yda.Row;ib.FirstColumn=this.Yda.Column;cc={ParameterType:6};cc.SourceRange=ib}ib=Object(B.a)(new T.a,{Text:this.ee});mb.setCell(ib,Ga.range,0,63,cc)}return!0}tsa(mb,Ga){const ib=mb?this.aEb:this.qI;mb=mb?this.klc:this.llc;0>=this.sOa?this.Kf.style.height=sa.HelperMethods.uc(mb):(this.Kf.style.height="auto",this.sOa>ib?(ha.DOMElementExtensions.gJ(this.Kf,this.SVj?Math.floor(mb*ib):Math.floor(this.Kf.offsetHeight*ib/this.sOa)),this.Kf.style.overflowY="auto"):(this.Kf.style.height="auto",this.Kf.style.overflowY=
"hidden"));ha.DOMElementExtensions.Vv(this.Kf,Ga);ha.DOMElementExtensions.Vv(this.Kn,Ga-(this.sOa>ib?La.a.Mu:0))}}Object(u.a)(pa,"DataValidationListBox",z.a,[]);var ba=a(113),fa=a(251),Ka=a(254),aa=a(1093);const ja=`<p class='${l.Inh}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,Va=`<p class='${l.Hnh}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var bb=y.a.QQe,wa=y.a.QQe,ka=y.a.f3g;class ta extends m.a{constructor(mb,Ga){super(document.createElement("div"));this.p2b=
this.SQ=this.oR=!1;this.$h=this.Qh=null;this.vki=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");this.wki=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.Lod=this.Erd=this.Lqd=!1;this.T6b=[];this.htmlSanitizationHelper=null;this.Rh=()=>{this.v7f(!1)};this.DPa=(ib,cc)=>{this.show(this.DN,!this.re,!0,e.a.Dp||3===cc.tb||3===v.a.Db);this.eCd(null,null)};this.eCd=()=>{this.gridView.setFocus()};this.tMa=()=>{this.Za.textBox.GF=
!0};this.Rt=()=>{this.Nhg()};this.onContentReady=()=>{this.v7f(this.re)};this.Bc=()=>{this.ny()};this.xza=()=>{this.ySa()};this.PAf=()=>{this.Nhg()};this.$=mb;this.gridView=L.h(this.$);this.oJ=this.gridView.Vb;this.htmlSanitizationHelper=Ga;Ga="<div id='dv_reader_description' class='"+w.a.gRe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+l.zth+" "+y.a.Ao+"'></div>\r\n<div id='dv_list_box' class='"+l.Fsh+" "+y.a.Bo+" "+y.a.Ao+"'></div>\r\n<div id='dv_prompt_box' class='"+
l.xth+" "+y.a.Ao+"'></div>";this.domElement.className=l.yth;X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7126086_ReduceInnerHTMLUsageForDataValidationControl")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.dk(this.domElement,Ga):this.domElement.innerHTML=Ga;fa.d(this.style,this.isGridRtl);this.Kf=$get("dv_list_box",this.domElement);this.wW=$get("dv_prompt_box",this.domElement);this.Usa=$get("dv_list_button",this.domElement);
this.gDb=$get("dv_reader_description",this.domElement);(Ga=ba.a(mb))&&this.T6b.push(new ea(mb,Ga,this));this.T6b.push(new ea(mb,this.gridView.Vb,this));this.gridView.ha.gH(this.Rh);this.gridView.jv(this.onContentReady);this.gridView.fc.ZJg(this.PAf);this.$.ik(this.Bc);Ga=this.gridView.zj;Ga.insertBefore(this.domElement,Ga.firstChild);this.onContentReady(null,null);mb.da.Ga(14,this)}get PBb(){return!!(this.$.qd&16)}get lsi(){return this.re||this.DN||this.hxa}get re(){return ha.DOMElementExtensions.isVisible(this.Kf)}set re(mb){ha.DOMElementExtensions.setVisible(this.Kf,
mb)}get DN(){return ha.DOMElementExtensions.isVisible(this.wW)}set DN(mb){ha.DOMElementExtensions.setVisible(this.wW,mb)}get hxa(){return ha.DOMElementExtensions.isVisible(this.Usa)&&!!this.Qh&&ha.DOMElementExtensions.isVisible(this.Qh.domElement)}set hxa(mb){ha.DOMElementExtensions.setVisible(this.Usa,mb);this.Qh&&ha.DOMElementExtensions.setVisible(this.Qh.domElement,mb)}get Za(){return this.oJ}set Za(mb){this.oJ=mb}get O5a(){return!!this.activeCell&&this.y8c(this.activeCell.range)}get activeCell(){return this.gridView.Sb(null)}get V$e(){return this.O5a&&
!!this.sv&&!!(this.sv.options&2)&&!!this.sv.prompt}get nyb(){return this.O5a&&!!this.sv&&!!(this.sv.options&1)}get isGridRtl(){return this.gridView.rtl}get sv(){return this.F4a(this.activeCell.range)}get mPa(){const mb=this.activeCell;return mb?this.dwa(this.gridView,mb):null}dispose(){this.$&&(this.jOb(!1),this.gridView.ha.mL(this.Rh),this.gridView.Ky(this.onContentReady),this.gridView.fc.qfj(this.PAf),this.$.Il(this.Bc));this.NHe(!1);this.OHe(!1);f.a.qc(this.T6b);this.T6b=this.Usa=this.Kf=this.wW=
this.oJ=this.gridView=this.$=null;super.dispose()}y8c(mb){return!!this.F4a(mb)}rsb(mb,Ga){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new oa(this.$,mb,Ga):new G(this.$,mb,Ga)}F4a(mb){mb=this.gridView.getRangeInformation(mb);for(let Ga=0;Ga<mb.length;Ga++){const ib=mb[Ga];if(Object(h.a)(r.DataValidationRange,ib))return ib}return null}BMh(){if(!this.O5a)return"";const mb=this.V$e?`${this.sv.fOf} ${this.sv.prompt}`:"",Ga=this.nyb?J.a.instance.ga(842):
"";return String.format(J.a.instance.nb(17),mb,Ga)}Yh(mb){let Ga=!1;if(this.re||(-569786022===mb||541421805===mb)&&this.nyb||1872288872===mb&&this.DN)switch(mb){case -569786022:case 541421805:this.show(this.DN,!this.re,!0,e.a.Dp||3===v.a.Db);Ga=!0;break;case 1872288872:this.re?(this.show(this.DN,!1,!0,!1),Ga=!0):this.DN?(this.show(!1,!1,!0,!1),Ga=!0):this.Za&&(this.Za.endEdit(!1,"DataValidationControl.HandleKeyDown",0),Ga=!0);break;case -798660877:this.$h.BB(1);Ga=!0;break;case 137938150:this.$h.BB(-1);
Ga=!0;break;case 2091832999:this.$h.BB(this.$h.qI-1);Ga=!0;break;case 742457698:this.$h.BB(-(this.$h.qI-1));Ga=!0;break;case 125627505:case 267796030:Ga=this.ySa()}return Ga}show(mb,Ga,ib,cc){this.ny();if(this.PBb&&this.O5a){var ic=this.mPa;if(ic){if(mb||Ga||ib)this.isVisible=!0;fa.d(this.style,this.isGridRtl);ib&&this.nyb&&(this.OHe(!0),this.Ehg(ic,!1));Ga&&this.nyb&&this.lTa(cc,ic);mb&&this.V$e&&this.CFj(ic);this.lsi||(this.isVisible=!1)}}}dwa(mb,Ga){if(!Ga||!Ga.cell.Qk)return null;var ib=this.gridView.fc.textBox.domElement;
var cc=0<ha.DOMElementExtensions.getHeight(ib)&&0<ha.DOMElementExtensions.getWidth(ib)&&0<=ib.offsetTop&&0<=ib.offsetLeft;if(cc)ib=ha.DOMElementExtensions.dwa(ib,mb.zj);else{ib=mb.getCellBounds(Ga.cell);var ic=ha.DOMElementExtensions.getBoundingClientRect(mb.zj);ib=new Sys.UI.Bounds(ib.x-ic.x,ib.y-ic.y,ib.width,ib.height)}if(ib)if(cc)2<ib.height&&2<ib.height&&(ib.x+=1,ib.y+=1,ib.height-=2,ib.width-=2);else if(cc=L.h(this.$).oK(Ga.cell))cc=cc.width+1,ic=Ia.a.equals(Ka.a.zwb(Ga.cell,mb.rtl),"right",
!0),mb.rtl&&ic&&(ib.x=ib.x+ib.width-cc),Ga.sla&&mb.rtl===ic&&(ib.width=cc);else return null;return ib}v7f(mb){const Ga=this.O5a;this.jOb(Ga);Ga?this.show(!0,mb,!0,!1):this.ny()}ySa(){let mb=!1;this.re&&(mb=this.$h.ySa(this.Za),this.show(this.DN,!1,!0,!1));return mb}ny(){this.vki?(this.re&&(this.re=!1),this.hxa&&(this.hxa=!1),this.DN&&(this.DN=!1),this.isVisible&&(this.isVisible=!1)):this.re=this.hxa=this.DN=this.isVisible=!1;this.Lqd=this.Lod=this.Erd=!1}lTa(mb,Ga){this.nyb&&!this.sv.$Ia?this.hxa&&
this.Qh.disable():(this.NHe(!0),this.$h.Oea(this.sv.$Ia,mb,this.KVh(Ga),this.Za),this.xCa(Ga,!1))}CFj(mb){this.sv.prompt&&(this.DN=!0,this.KXj(this.sv.fOf,this.sv.prompt),this.Yhg(mb,!1))}Ehg(mb,Ga){const ib=mb.y;this.Usa.style.top=sa.HelperMethods.uc(ib);mb=this.isGridRtl?mb.x-this.Usa.offsetWidth+1:mb.x+mb.width+1;this.Usa.style.left=sa.HelperMethods.uc(mb);Ga?this.hxa=this.gridView.Ujc(new t.a(mb,ib))&&this.Lod:this.Lod=!0}xCa(mb,Ga){const ib=mb.y+mb.height;mb=this.isGridRtl?mb.x+mb.width-this.Kf.offsetWidth:
mb.x;this.Kf.style.top=sa.HelperMethods.uc(ib);this.Kf.style.left=sa.HelperMethods.uc(mb);Ga?this.re=this.gridView.Ujc(new t.a(mb,ib))&&this.Lqd:this.Lqd=!0}Yhg(mb,Ga){const ib=mb.y+mb.height+5;var cc=this.activeCell;cc=cc?cc.width/2:32;mb=this.isGridRtl?mb.x-this.wW.offsetWidth+cc:mb.x+mb.width-cc;this.wW.style.top=sa.HelperMethods.uc(ib);this.wW.style.left=sa.HelperMethods.uc(mb);Ga?this.DN=this.gridView.Ujc(new t.a(mb,ib))&&this.Erd:this.Erd=!0}KXj(mb,Ga){if(Ga){var ib="";mb&&(ib+=String.format(ja,
d.a.Gg(mb)));ib+=String.format(Va,d.a.Gg(Ga));X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl2")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.dk(this.wW,ib):this.wW.innerHTML=ib;mb=ha.DOMElementExtensions.nk(this.wW,"dv-prompt-titletext");if(Ga=ha.DOMElementExtensions.nk(this.wW,"dv-prompt-messagetext")){mb=mb?parseInt(String(Math.max(mb.offsetWidth,Ga.offsetWidth)),
10):Ga.offsetWidth;mb+=6;ha.DOMElementExtensions.Vv(this.wW,mb);for(let cc=0,ic=this.wW.children.length;cc<ic;cc++)ha.DOMElementExtensions.Vv(this.wW.children[cc],mb)}}}KVh(mb){return this.wki?mb.width+17-2+1:mb.width+this.Usa.clientWidth-2+1}OHe(mb){this.$&&!this.PBb||!mb?(this.Bag(!1),f.a.Ia(this.Qh),this.Qh=null):(this.Qh||(this.Qh=new aa.a(this.Usa,bb,n.a.via,1,wa,J.a.instance.ga(894),ka,J.a.instance.ga(893),"",-1),this.Bag(!0)),this.hxa=!0,this.sv.$Ia?this.Qh.isEnabled||this.Qh.enable():this.Qh.disable())}NHe(mb){this.$&&
!this.PBb||!mb?(this.UTa(!1),f.a.Ia(this.$h),this.$h=null):(this.$h||(this.$h=new pa(this.$,this.Kf,this.gDb,this.htmlSanitizationHelper),this.UTa(!0)),this.re=!0)}UTa(mb){this.$h&&(mb&&!this.oR?(this.$h.a$(this.eCd),this.$h.F_b(this.tMa),this.$h.vob(this.xza),this.oR=!0):!mb&&this.oR&&(this.$h.Ida(this.eCd),this.$h.quc(this.tMa),this.$h.YJb(this.xza),this.oR=!1))}jOb(mb){mb&&!this.SQ?(this.gridView.view.nt(this.Rt),this.SQ=!0):!mb&&this.SQ&&(this.gridView.view.gr(this.Rt),this.SQ=!1)}Bag(mb){this.Qh&&
(mb&&!this.p2b?(this.Qh.vWc(this.DPa),this.Qh.HWc(this.DPa),this.Qh.hob(this.tMa),this.p2b=!0):!mb&&this.p2b&&(this.Qh.pLd(this.DPa),this.Qh.CLd(this.DPa),this.Qh.JJb(this.tMa),this.p2b=!1))}Nhg(){if(this.O5a){var mb=this.mPa;mb&&(this.Ehg(mb,!0),this.xCa(mb,!0),this.Yhg(mb,!0))}}}Object(u.a)(ta,"DataValidationControl",m.a,[363,2]);var qa=a(50),rb=a(55);class Za extends b.a{constructor(mb){super();this.$=mb;this.Fb()}create(){const mb=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
X.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl")?qa.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):rb.Task.Ta(null);D.TaskExtensions.Aa(mb,()=>{this.ob(this.$.da.za(14)||new ta(this.$,mb.result))},this.la,3)}}Object(u.a)(Za,"DataValidationControlFactory",b.a,[]);a.d(E,"a",function(){return gb});const gb=()=>{c.a.Fa(mb=>{mb.da.Ga(150,new Za(mb))})}},1215:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(187);const f={selectByArrowKeyCounter:0,
selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0,dismissSmartSuggestionExplicitlyCounter:0,dismissSmartSuggestionImplicitlyCounter:0},d={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},h={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,
argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0,argumentAssistanceCardIsInitialModeDefault:!1},m={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},l={parenthesesCouplingCounter:0,formulaHighlightsCounter:0},w={dialogCommitedCounter:0,dialogShownCounter:0,
argsDialogOpenedByRibbonCounter:0,argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},n={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0,smartFormulaSuggestionsFeatureEnabled:void 0,parenthesesCouplingFlight:void 0,coloredReferencesFlight:void 0};var y=a(58),t=a(1094),r=a(1),v=a(22),B=
a(41),A=a(21),z=a(98),x;(function(G){G[G.function=3]="function";G[G.namedRange=100]="namedRange";G[G.tableHeader=101]="tableHeader";G[G.letVariable=102]="letVariable";G[G.richEntity=103]="richEntity";G[G.lambda=104]="lambda";G[G.customFunction=105]="customFunction";G[G.table=106]="table";G[G.tableSpecialStructRef=107]="tableSpecialStructRef";G[G.richEntityEmptyCellRef=108]="richEntityEmptyCellRef";G[G.rangeRef=109]="rangeRef"})(x||(x={}));Object(u.b)("CompletionItemKind",x);var D=a(33);const J={["argumentAssistanceOverall"]:[50,
80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleAndSmart"]:[50,80,100,130,150,170,200],["autoCompleteOverallSmartOnly"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleOnly"]:[50,80,100,130,150,170,200],["tryUpdateHighlightsFromCellContentEditor"]:[50,80,100,130,150,170,200]};class L{constructor(G){this.$=G;this.kI=null;this.QCb=-1;this.Skc=null;this.Tkc=0;this.PP=Object.assign({},h);this.mK=Object.assign({},m);this.LJ=Object.assign({},
f);this.Lpb=Object.assign({},d);this.Iac=Object.assign({},l);this.dX=Object.assign({},n);this.Mpb={};this.c4a=Object.assign(Object.assign({},w),{isReactDialog:D.a.ljf()});this.pZc=r.EwaSettings.isChangeGateEnabled("OfficeVSO:7190603_FATMAvoidSilentReopen");this.jg=(C,H)=>{null!=this.kI&&(1==Math.abs(this.QCb-this.$.ea.ze)&&(C=this.$.xa.oa.sheetId,H.Jrb&&H.Pk.equals(this.kI.Pk)&&this.Skc===C&&this.kI.Uqb!==H.Uqb&&this.Tkc++),1<=Math.abs(this.QCb-this.$.ea.ze)&&(this.kI=null,this.QCb=-1,this.Skc=null))};
this.Bc=(C,H)=>{this.pZc&&(H.Nf||H.Sgf)||(this.pxj(),this.zxj(),this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging()))};this.Wab=new z.a;G.ik(this.Bc);A.h(this.$).Ai.Rm(this.jg)}dispose(){this.$&&A.h(this.$).Ai.em(this.jg)}WB(G){G.forEach(C=>{this.Wab.mb(C)||this.Wab.ia(C,new t.a(J[C]));this.Wab.na(C).LTa()})}yw(G,C=!0){G.forEach(H=>{this.Wab.mb(H)&&this.Wab.na(H).j4(C)})}C1f(G){let C="Undefined";switch(G){case 1:C="Collapsed";break;case 0:C="Expanded";break;case 2:C="Hidden"}this.PP.argumentAssistanceCardInitialMode=
C}Rsj(G){this.PP.argumentAssistanceCardInitialMode=G?"Expanded":"Collapsed"}B1f(){this.PP.argumentAssistanceCardIsInitialModeDefault=!0}Lua(G){window.requestAnimationFrame(()=>{this.yw([G])})}Rcf(G){G.forEach(C=>{C=x[C.kind];this.akg(C);this.Mpb[C].shownCounter++})}Qcf(G){G=x[G];this.akg(G);this.Mpb[G].committedCounter++}getJsonForLogging(){return"{"+this.hQ("SessionDetails",this.dX)+","+this.hQ("ArgumentAssistanceUsage",this.PP)+","+this.hQ("FormulaSuggestionsUsage",this.mK)+","+this.hQ("FunctionDialogUsage",
this.c4a)+","+this.hQ("AutocompleteCardInteraction",this.LJ)+","+this.hQ("AutocompleteRenderOptimization",this.Lpb)+","+this.hQ("AutocompleteUsageByKind",this.Mpb)+","+this.hQ("FormulaHighlightsUsage",this.Iac)+","+this.l0h()+"}"}zxj(){this.mK.smartSuggestionKeptCounter=this.mK.smartSuggestionCommittedCounter-this.Tkc}pxj(){this.dX.argumentAssistanceFlight=this.Tva("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.dX.autoCompleteUIFlight=this.Tva("Microsoft.Office.Excel.","AutoCompleteNewUI");
this.dX.smartFormulaBarAutoCompleteFlight=this.Tva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.dX.smartFormulaBarAutoCompletePluginFlight=this.Tva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.dX.formulaAssistanceRedesignFlight=this.Tva("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.dX.NewInsertFunctionDialogFlight=this.Tva("Microsoft.Office.Excel.","NewInsertFunctionDialog");this.dX.coloredReferencesFlight=this.Tva("Microsoft.Office.Excel.",
"ColoredReferences");this.dX.parenthesesCouplingFlight=this.Tva("Microsoft.Office.Excel.","ParenthesesCoupling");this.dX.smartFormulaSuggestionsFeatureEnabled=D.a.hNa(this.$)}l0h(){const G=new e.a;for(let C of this.Wab)C.value.DWe(),G.add(`"${C.key}":${y.a.hc(C.value.mW)}`);return`"PerfMeasurements": {${G.toArray().join(",")}}`}Tva(G,C){return v.a.contains(this.$.va.FlightHolder.FlightId,C,!0)?r.EwaSettings.getBooleanFeatureGate(G+C,!1)?"T":"C":"None"}hQ(G,C){return`"${G.toString()}":${B.c(C)}`}akg(G){this.Mpb[G]||
(this.Mpb[G]={shownCounter:0,committedCounter:0})}}Object(u.a)(L,"FormulaAssistanceTelemetryManager",null,[338]);class T extends b.a{constructor(G){super();this.$=G;this.Fb()}static ka(G){G.da.Ga(492,new T(G))}create(){var G;this.ob(null!==(G=this.$.da.za(491))&&void 0!==G?G:this.$.da.Ga(491,new L(this.$)))}}Object(u.a)(T,"FormulaAssistanceTelemetryManagerFactory",b.a,[]);a.d(E,"a",function(){return O});const O=()=>{c.a.Fa(G=>{T.ka(G)})}},1219:function(u,E,a){a.r(E);u=a(0);var c=a(15),b=a(276),e=
a(92),f=a(40),d=a(263),h=a(548),m=a(4),l=a(83),w=a(416),n=a(716),y=a(8),t=a(31),r=a(19),v=a(61),B=a(5),A=a(787),z=a(1047),x=a(836),D=a(13),J=a(33);class L{constructor(wb,cb,lb,Y,Oa,Wa,Ca,Ra){this.$=cb;this.Va=lb;this.tl=Y;this.selectedRanges=Oa;this.grid=Wa;this.Ry=Ra;this.d5=Ca;this.kha=d.a.all(Oa,la=>la.isRow);this.xsa=d.a.all(Oa,la=>la.hf);this.VEb=d.a.all(Oa,la=>!la.isRow&&!la.hf);cb=Wa.Bb.Jid(Oa);this.ysb=!!cb;this.UVf=!!cb&&cb.hasActiveFilter;this.menuSection=lb.Ec();wb.tc.push(this.menuSection);
this.Bba=this.kha||this.xsa?this.menuSection:lb.Ec();this.hua=this.kha||this.xsa?this.menuSection:lb.Ec()}Qdd(){this.WJh();this.zJh();const wb=this.Ry.c8a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Va.pb(wb?149:148))}bKh(){let wb=0;this.ysb?this.d5.xm(942362098)?wb=this.Ry.xm(this.tl,942362098,this.selectedRanges,this.grid)?161:169:this.UVf&&(wb=this.Ry.xm(this.tl,-1113896058,this.selectedRanges,this.grid)?177:181):this.d5.xm(-1113896058)&&(wb=this.kha?this.Ry.xm(this.tl,-1113896058,
this.selectedRanges,this.grid)?49:116:this.Ry.xm(this.tl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==wb&&this.Bba.buttons.push(this.Va.pb(wb))}aKh(){let wb;!this.ysb&&this.d5.xm(-1113896058)&&(wb=this.kha?this.Ry.xm(this.tl,-1113896058,this.selectedRanges,this.grid)?295:296:this.Ry.xm(this.tl,-1113896058,this.selectedRanges,this.grid)?297:298,this.Bba.buttons.push(this.Va.pb(wb)))}XJh(){let wb=0;this.ysb?this.d5.xm(622604322)&&(wb=this.grid.rtl?this.Ry.xm(this.tl,622604322,this.selectedRanges,
this.grid)?191:192:this.Ry.xm(this.tl,622604322,this.selectedRanges,this.grid)?162:170):this.d5.xm(1415868706)&&(wb=this.xsa?this.Ry.xm(this.tl,1415868706,this.selectedRanges,this.grid)?50:117:this.Ry.xm(this.tl,1415868706,this.selectedRanges,this.grid)?178:182);0!==wb&&this.Bba.buttons.push(this.Va.pb(wb))}VJh(){this.d5.xm(1035996630)&&(this.Ry.xm(this.tl,1035996630,this.selectedRanges,this.grid)?(this.Bba.buttons.push(this.Va.pb(this.grid.rtl?187:165)),this.Bba.buttons.push(this.Va.pb(166))):(this.Bba.buttons.push(this.Va.pb(this.grid.rtl?
188:173)),this.Bba.buttons.push(this.Va.pb(174))))}WJh(){const {GridContextMenu:wb}=a(1219);let cb=null;this.VEb&&(cb=this.Va.tw("ContextMenu.InsertCells",null,D.a.instance.ga(345),1896159024),cb.menu.tc.push(this.Bba));wb.YJh(this.Bba,this.Va,this.$);this.bKh();m.AFrameworkApplication.Ip("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");J.a.Cqd()&&this.aKh();this.XJh();this.VJh();cb&&0<this.Bba.buttons.length&&this.menuSection.buttons.push(cb)}BJh(){let wb=0;this.ysb?
this.d5.xm(1405456548)?wb=this.Ry.xm(this.tl,1405456548,this.selectedRanges,this.grid)?163:171:this.UVf&&(wb=this.Ry.xm(this.tl,1554436520,this.selectedRanges,this.grid)?179:183):this.d5.xm(1554436520)&&(wb=this.kha?this.Ry.xm(this.tl,1554436520,this.selectedRanges,this.grid)?51:118:this.Ry.xm(this.tl,1554436520,this.selectedRanges,this.grid)?179:183);0!==wb&&this.hua.buttons.push(this.Va.pb(wb))}AJh(){let wb=0;this.ysb?this.d5.xm(284490184)&&(wb=this.Ry.xm(this.tl,284490184,this.selectedRanges,this.grid)?
164:172):this.d5.xm(674605324)&&(wb=this.xsa?this.Ry.xm(this.tl,674605324,this.selectedRanges,this.grid)?52:119:this.Ry.xm(this.tl,674605324,this.selectedRanges,this.grid)?180:184);0!==wb&&this.hua.buttons.push(this.Va.pb(wb))}yJh(){this.d5.xm(1035996630)&&(this.Ry.xm(this.tl,1035996630,this.selectedRanges,this.grid)?(this.hua.buttons.push(this.Va.pb(this.grid.rtl?189:167)),this.hua.buttons.push(this.Va.pb(168))):(this.hua.buttons.push(this.Va.pb(this.grid.rtl?190:175)),this.hua.buttons.push(this.Va.pb(176))))}zJh(){let wb=
null;this.VEb&&(wb=this.Va.tw("ContextMenu.DeleteCells",null,D.a.instance.ga(409),-1554384558),wb.menu.tc.push(this.hua));this.BJh();this.AJh();this.yJh();wb&&0<this.hua.buttons.length&&this.menuSection.buttons.push(wb)}}Object(u.a)(L,"CellsContextMenuGenerator",null,[]);var T=a(773);class O{constructor(wb){this.ranges=null;this.ranges=wb}}Object(u.a)(O,"MacroRecorderRangeHyperlinkRemovedPayload",null,[137]);var G=a(525),C=a(24),H=a(101),I=a(76),M=a(74),Q=a(42),U=a(188),N=a(60),W=a(604),X=a(142),
sa=a(37),da=a(459),S=a(555),oa=a(1),K=a(183),ea=a(21),ya=a(372),ha=a(34),La=a(50),Ia=a(211),ra=a(22),pa=a(30),ba=a(1072),fa=a(905),Ka=a(132),aa=a(371),ja=a(283),Va=a(162),bb=a(154),wa=a(345),ka=a(91),ta=a(29),qa=a(282),rb=a(281),Za=a(133),gb=a(771),mb=a(772),Ga=a(112),ib=a(41),cc=a(55),ic;(function(wb){wb[wb.none=0]="none";wb[wb.once=1]="once";wb[wb.twice=2]="twice"})(ic||(ic={}));Object(u.b)("ToggleState",ic);class xb{constructor(wb,cb,lb,Y){this.fYc=this.Hfb=this.Jfb=0;this.$=wb;this.gridView=ea.h(this.$);
this.namedSheetViewPublic=cb;this.Ag=lb;this.instantaneousSupportInformationManager=Y;this.vNa=gb.a.Aod()}imh(){var wb=this.cV();wb={["CommandValueId"]:ib.c(wb)};const cb=new ka.a(-2058042992,2,this.$.Hc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ja.Kb(cb,wb)}ymh(){const wb=new ka.a(644342024,2,this.$.Hc,19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");
return this.$.Ja.Kb(wb)}nmh(){const wb=this.gridView.ha.ra.activeCell,cb=this.$.da.za(66).Kg,lb=this.$.da.za(66).hwb(wb);return cb||lb?this.pmh(cb,lb,wb):this.omh(wb)}pmh(wb,cb,lb){if(this.J0g(wb,cb,lb))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),cc.Task.Ta(!1);if(null!=wb&&wb.hasAutoFilter||null!=cb&&cb.i0a.every(Y=>0!=Y.length))return this.Jfb=ic.none,this.dYc();this.Jfb=ic.once;return this.k8b(ic.once)}omh(wb){var cb=
Q.v(this.gridView.ha.ra.$c,this.$);cb=this.gridView.$.xa.getItemByName(cb.SheetName);const lb=Q.D(cb.W0);if(this.I0g(lb,wb))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),cc.Task.Ta(!1);if(cb.hasAutoFilter){if(lb&&lb.contains(this.gridView.ha.ra.activeCell))return this.Jfb=ic.none,this.dYc();this.Jfb=ic.twice;return this.k8b(ic.twice)}this.Jfb=ic.once;return this.k8b(ic.once)}k8b(wb){const cb=Q.v(this.gridView.ha.ra.$c,
this.$);if(!cb)return cc.Task.Ta(!1);this.Hfb||(this.Hfb=Date.now());const lb=new ka.a(368460465,2,this.$.Hc,19,null),Y=this.$.pa.ya.Wb(),Oa=()=>new ba.a(cb),Wa=Ca=>{qa.a(Ca)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),wb===ic.twice?this.k8b(ic.once):this.dYc())};return aa.a(this.$.userOperationManager,(Ca,Ra,la)=>ja.B(this.$.pa.ya,cb,rb.b(Ca,
Wa),Ra,la,null,Y),Ca=>new U.a(516,0,Ca,64,Oa),lb)}J0g(wb,cb,lb){return null!=wb&&Va.d(wb)&&lb.top===wb.usedRange.top||null!=cb&&cb.pba&&lb.top===cb.top?(this.Lsc(this.$,223),!0):null!=wb&&Va.g(wb)&&lb.top===wb.usedRange.bottom?(this.Lsc(this.$,224),!0):!1}I0g(wb,cb){if(wb&&wb.contains(cb)&&cb.top===wb.top||!wb&&this.N_g(cb.top,cb.left))return this.Lsc(this.$,225),!0;wb=new C.Range(cb.top,cb.left,cb.top+1,cb.left+1,!1,!1);return this.gridView.Bb.Ixa(wb)?(this.Lsc(this.$,226),!0):!1}Lsc(wb,cb){cb=ta.a.Zc(1,
1,751,cb,0,147079615,"ContextMenuFilterByCellValueError");oa.EwaSettings.Iz()?new wa.a(wb,cb):(wb=new bb.ErrorDialog(wb,cb),wb.initialize(),wb.vg())}dYc(){this.fYc=Date.now();const wb=this.H3h();if(!wb)return c.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),cc.Task.Ta(!1);const cb=this.cV(),lb={FirstRow:0};lb.FirstColumn=cb.Column;lb.SheetName=cb.SheetName;Za.b(this.$).ud(Ka.a.nyf,this.vm(),void 0,!0);const Y=this.O4c(cb,lb),Oa=Ca=>{c.ULS.sendTraceTag(527500295,
0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.Jfb,["ApplyFilterTime"]:this.fYc?Date.now()-this.fYc:-1,["ToggleAndApplyFilterTime"]:this.Hfb?Date.now()-this.Hfb:-1,["FilterByValueType"]:cb.AutoFilterType})}`);this.Hfb&&(this.Hfb=0);if(gb.a.Yyc(Ca)){const Ra=gb.a.obc(Ca);this.vNa?gb.a.tRa(mb.a.filterByCellValue,Ra.MessageIdName,Ga.a.lHa,!0,gb.a.isSessionEndingError(Ra.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${Ra.MessageIdName}`)}qa.a(Ca)?
(Ca=ta.a.sc(Ca.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${Ca}`)):(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),Za.b(this.$).ud(Ka.a.RBf,this.vm(),void 0,!0),Ca={},Ca.FirstRow=this.ySh(),Ca.FirstColumn=cb.Column,-1!==Ca.FirstRow&&(Ca=Q.C(Ca),this.BS(Ca)))},Wa=new U.a(208,0,(Ca,Ra,la)=>N.a(this.$.pa.ya,Y,wb,rb.b(Ca,Oa),Ra,la,null,null),6,()=>new fa.a(wb,Y));this.namedSheetViewPublic?
this.namedSheetViewPublic.mTa().continueWith(Ca=>{Ca.result&&this.$.userOperationManager.Ic(Wa,null)}):this.$.userOperationManager.Ic(Wa,null);return cc.Task.Ta(!0)}BS(wb){J.a.ola(this.$)&&sa.TaskExtensions.Aa(La.GetServiceTaskFactory.Oa(this.$.da,430,431,1),cb=>{cb.result.Lea(wb);c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.la,3)}vm(){return{["Location"]:"contextMenu"}}cV(){var wb=0,cb=this.gridView.ha.ra.activeCell;
var lb=this.$.da.za(66).Kg;const Y=this.$.da.za(66).hwb(cb);if(lb){var Oa="Table";wb=lb.objectId}else Y?(Oa="Table",wb=Y.id):Oa="Sheet";lb=cb.left;cb={};cb.AutoFilterType=Oa;cb.Column=lb;cb.Id=wb;Oa={};this.$.pk(Oa);Oa.FirstRow=0;Oa.FirstColumn=cb.Column;wb=this.$.ea.isNamedObjectViewMode;cb.NamedObjectView=wb;cb.SheetName=wb?Oa.NamedObjectName:Oa.SheetName;cb.ItemListOptions=null;return cb}N_g(wb,cb){wb=C.Range.Qc(wb,cb);return this.gridView.Ea.y$(wb,this.$.oa.name)&&(wb=this.gridView.Ea.kLa(wb))&&
wb.autoFilterMenu?!0:!1}H3h(){var wb=null;const cb=this.gridView.Sb(this.gridView.ha.ra.activeCell);if(!cb)return null;const lb=cb.cell.fAc;let Y;({category:Y}=this.instantaneousSupportInformationManager.rCa(lb,!1));if(1===cb.qx.type)if(3===Y){if(!cb.cell.hPa)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${Y}. NumFmt is null. `),null;wb=(cb.cell.hPa.Start+cb.cell.hPa.End).trim()}else if(!Y&&(ra.a.s1a(cb.qx.value,"E")||ra.a.s1a(cb.originalText,
"E"))){wb=this.Ag.sYe(cb.qx.value,lb,1,Number.POSITIVE_INFINITY,cb.cell.uia);if(!wb.success)return c.ULS.sendTraceTag(527500289,0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${Y}. Failed to acquire formatted value`),null;wb=wb.fy}wb||(wb=cb.originalText);return pa.a.C1c(wb)?["[Blanks]"]:["i"+wb.trim()]}ySh(){const wb=this.gridView.ha.ra.activeCell;var cb=this.$.da.za(66).Kg;const lb=this.$.da.za(66).hwb(wb);if(cb)return cb.usedRange.top;if(null!=lb)return lb.top;cb=this.$.xa.getItemByName(this.$.oa.sheetName);
return(cb=Q.D(cb.W0))&&cb.contains(wb)?cb.top:-1}O4c(wb,cb){const lb={};lb.Location=cb;lb.FieldId=wb.Id.toString();lb.DataSourceIndex=-1;lb.FilterType=wb.AutoFilterType;lb.AnchorType=0;lb.ChartId=null;lb.AnchorValue1=-1;lb.AnchorValue2=-1;lb.Property=wb.RichProperty;return lb}}Object(u.a)(xb,"GridContextMenuFilter",null,[]);a.d(E,"GridContextMenu",function(){return Vb});class Vb extends n.a{constructor(wb,cb,lb,Y){super(wb,"PopulateGridContextMenu",1247109494,-2064931494,Vb.q5h,!0,!1,Vb.SKb,cb,lb,
!0,Y);this.Jjc=this.expandCollapse=this.refresh=this.BZ=this.Lwa=this.BBa=!1;this.BHe=!0;this.grid=ea.h(wb);this.wmc=!0;if(this.hhc=oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const Oa=La.GetServiceTaskFactory.Oa(this.$.da,309,310,3),Wa=La.GetServiceTaskFactory.create(this.$.da,18,this.la,3);sa.TaskExtensions.Aa(sa.TaskExtensions.Ed([Oa,Wa],this.la),()=>{this.$.da.$a(268,Ca=>{this.C5a=new xb(wb,Oa.result,Wa.result,Ca)})},this.la,3)}}get Zw(){return"PopulateGridContextMenu"}get OB(){return B.a.$Pf}dispose(){super.dispose();
this.grid=null}nc(wb,cb){wb=!this.Zrd(wb,cb);if(!wb)switch(cb){case -1977666927:wb=null==this.C5a||this.GAj();break;case 1549396389:wb=null==this.C5a||!this.qji();break;case 2045563128:case 1803952894:wb=null==this.C5a||!this.$.isEditMode&&!this.rji();break;case -425234874:wb=this.KAj()}return wb}Zrd(wb,cb){const lb=this.grid.ha.ra.selectedRanges;return(new X.a(this.$.xa)).xm(wb,cb,lb,this.grid)}executeCommand(wb,cb,lb){const Y=cb.command;wb=null;switch(Y){case -1396319072:if(cb=this.grid.Sb(null))b.a.instance.t0c(!0),
e.EventHandlerManager.instance.Ycd(),Vb.PYi(cb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.ra.selectedRanges,cb);break;case 324156914:wb=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(lb);break;case -1977666927:wb=this.C5a.imh();break;case 1549396389:wb=this.C5a.ymh();break;case 1803952894:wb=this.C5a.nmh();break;default:wb=K.a(Y)}return wb||sa.TaskExtensions.jba()}wc(wb,cb,lb){wb=!1;switch(cb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:wb=
!0;break;case 1441131127:wb=!!lb}return wb}hZ(wb=!1){let cb=!1,lb=!1,Y=0;oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Y=f.a.Ud());const Oa=this.Va.aq(this.menuId);var Wa=this.grid.ha.ra;const Ca=Wa.Og,Ra=Ca&&Wa.$c.hf,la=Ca&&Wa.$c.isRow;Wa=Wa.selectedRanges;const ua=d.a.all(Wa,Ob=>Ob.hf),xa=d.a.all(Wa,Ob=>Ob.isRow),fb=Q.O(Wa),Jb=Q.P(Wa);this.Ojf(Ra,la)?(cb=!0,this.EKh(Oa)):this.$.isEditMode?ya.a(this.$)?this.FKh(Oa,Ra,la):(this.CJh(Oa,!(la||Ra||!this.Jjc)),
this.ZJh(Oa,Wa,wb),this.OJh(Oa,ua,xa,fb,Jb),this.DZe(Oa,Ca,Ra,la),this.VKh(Oa),this.iZe(Oa,Ra,la),this.uKh(Oa,Ca,Ra,la,Wa),this.FJh(Oa),this.DJh(Oa,Wa),this.gKh(Oa),this.QKh(Oa,Ca),oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.TJh(Oa)):(lb=!0,ya.a(this.$)?this.yZe(Oa):this.kLh(Oa,Ca,Ra,la,Wa));oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(wb=f.a.Ud()-Y,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${wb}, isPivotMenu: ${cb}, isViewMenu: ${lb}, firstTimeEntry: ${this.BHe}`));
this.BHe=!1;return Oa}$Ka(wb){const cb=[];if(ya.a(this.$))return cb;if(3===wb){wb=this.grid.ha.ra;const Y=wb.Og,Oa=Y&&wb.$c.hf,Wa=Y&&wb.$c.isRow;let Ca=!1;var lb=!1;let Ra=!1;this.$.isMobileMode&&(lb=wb.selectedRanges,Ca=Q.O(lb),lb=Q.P(lb));if(Y){const la=ea.f(this.grid);la&&la.range.contains(wb.$c)&&this.EV(la)&&(Ra=!0)}this.$.isEditMode?this.Ojf(Oa,Wa)?cb.push(...[x.a.gLf,x.a.iLf]):Oa||Wa?(cb.push(x.a.clipboard),Wa?cb.push(x.a.bnj):Oa&&cb.push(x.a.i4g)):(cb.push(...[x.a.edit,x.a.clipboard]),Ra?
cb.push(x.a.hyperlink):cb.push(x.a.color),Y&&cb.push(x.a.mSg)):(cb.push(x.a.copy),Ra&&cb.push(x.a.openHyperlink),!Wa||this.$.isMobileMode&&lb?!Oa||this.$.isMobileMode&&Ca||cb.push(x.a.F0j):cb.push(x.a.G0j));cb.push(x.a.h5h)}else 2===wb&&cb.push(x.a.FAe);return cb}Ojf(wb,cb){return(this.BBa||this.Lwa||this.BZ||this.refresh||this.expandCollapse)&&!(wb||cb)}showGridContextMenu(wb){this.expandCollapse=this.refresh=this.BZ=this.Lwa=this.BBa=!1;var cb=this.$,lb=da.a(cb).pLa(),Y=this.grid.ha.ra;const Oa=
Y.Og;var Wa=Oa&&Y.$c.hf;Y=Oa&&Y.$c.isRow;if(lb&&!Wa&&!Y){Wa=S.a(cb);if(null===Wa||void 0===Wa?0:Wa.oTd)this.BBa=Wa=H.f(cb.lg),this.Lwa=!Wa;Wa=cb.dc;this.BZ=lb.supportsBIExplore&&!!A.a(cb)&&Wa.W2(32768);Wa.allowInteractivity&&(cb=this.grid.Sb(null),(null===cb||void 0===cb?0:cb.cell)&&(cb.cell.i0c||cb.cell.K6f)&&(this.expandCollapse=!0),Wa.allowManualDataRefresh&&(this.refresh=!0))}cb=null;lb=1;Wa=Object(l.a)(h.a,wb.eventArgs);wb=Object(l.a)(z.a,wb.creationParams);Y=this.EPh();wb?(cb=wb.clientPoint,
lb=wb.inputMethod):Wa&&1!==Wa.tb?(cb=new Sys.UI.Point(Wa.clientPoint.x,Wa.clientPoint.y),lb=Wa.tb):Y&&(cb=new Sys.UI.Point(Y.x+(this.$.isChromeRtl?0:Y.width),Y.y+Y.height));I.a.Db=lb;this.Jjc=3===lb;wb=t.a.Nub;this.Qp(cb,!Wa||Wa.Ca.target.className!==wb,lb)}removeHyperlinksFromRange(wb,cb){if(!oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Yp(wb,!0)){var lb=Q.r(wb,this.$),Y=this.$.pa.ya.Wb();this.$.userOperationManager.Ic(new U.a(125,
0,(Oa,Wa,Ca)=>{this.$.My();return N.b(this.$.pa.ya,lb,"","",!0,!1,127,Oa,Wa,Ca,null,Y)},void 0,()=>new O(lb)),cb);this.grid.Hf.rH(!1)}}EPh(){var wb=this.grid.Sb(null);if((null===wb||void 0===wb?0:wb.cell.Qk)&&this.Xif(wb))return this.grid.getCellBounds(wb.cell);wb=this.grid.ha.ra.activeCell;return(wb=this.X$b(new C.Range(wb.top,wb.left,y.a.fh,wb.left,!1,!1),2,!0)||this.X$b(new C.Range(1,wb.left,wb.top,wb.left,!1,!1),2,!1)||this.X$b(new C.Range(wb.top,wb.right,wb.top,y.a.qh,!1,!1),1,!0)||this.X$b(new C.Range(wb.top,
1,wb.top,wb.right,!1,!1),1,!1)||null)&&wb.Qk?this.grid.getCellBounds(wb):Sys.UI.DomElement.getBounds(this.grid.Gwa.mc)}Xif(wb){var cb=this.grid.rtl,lb=this.$.isChromeRtl;wb=wb.cell;var Y=ea.h(this.$).oK(wb);return Y?(Y=Y.topLeft,cb=Y.x+=cb===lb?wb.offsetWidth:0,lb=Y.y+=wb.offsetHeight,this.grid.view.visibleArea.contains(new v.a(cb,lb,0,0))):!1}X$b(wb,cb,lb){wb=this.grid.kk("GridContextMenu.FindFirstCellInViewportArea",wb,cb,lb);try{for(wb.$$rst();wb.$$mn();){const Y=wb.$$cu();if(Y&&this.Xif(Y))return Y.cell}}finally{wb&&
wb.dispose()}return null}EKh(wb){const cb=this.Va,lb=cb.Ec();this.refresh&&lb.buttons.push(cb.pb(100));this.BZ&&lb.buttons.push(cb.pb(99));this.BBa?lb.buttons.push(cb.pb(59)):this.Lwa&&lb.buttons.push(cb.pb(58));if(this.expandCollapse){let Y;Y=cb.tw("ContextMenu.PivotExpandCollapse",null,D.a.instance.ga(1163),589118293);const Oa=cb.Ec();Oa.buttons.push(cb.pb(243));Oa.buttons.push(cb.pb(244));Oa.buttons.push(cb.pb(245));Oa.buttons.push(cb.pb(246));Y.menu.tc.push(Oa);Y&&0<Oa.buttons.length&&lb.buttons.push(Y)}wb.tc.push(lb)}DZe(wb,
cb,lb,Y){if(cb&&!lb&&!Y){cb=this.Va.Ec();this.hhc&&!this.$.HK&&this.Udd(cb);this.ced(cb);this.ZKh(cb);if(oa.EwaSettings.ma(475)&&ea.h(this.$).ha.ra.DK()&&ea.h(this.$).ha.ra.Q5)switch(oa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:cb.buttons.push(this.Va.pb(237));break;case 2:cb.buttons.push(this.Va.pb(238));break;default:cb.buttons.push(this.Va.pb(236))}wb.tc.push(cb)}}ced(wb){if(this.$.dc.allowSorting&&(!this.$.isMobileMode||
(new X.a(this.$.xa)).Td(2048))){var cb=this.Va.Ec();cb.buttons.push(this.Va.pb(223));cb.buttons.push(this.Va.pb(224));cb.buttons.push(this.Va.pb(292));cb.buttons.push(this.Va.pb(293));cb.buttons.push(this.Va.pb(294));this.$.isMobileMode||cb.buttons.push(this.Va.pb(225));var lb=this.Va.tw("ContextMenu.sort",null,D.a.instance.ga(227),-864298118);lb.menu.tc.push(cb);wb.buttons.push(lb)}}Udd(wb){const cb=this.Va.tw("ContextMenu.filter",null,D.a.instance.ga(1964),2045563128),lb=this.Va.Ec();var Y=this.cUh();
const Oa=this.Va.pb(234);Oa.label=Y;lb.buttons.push(Oa);lb.buttons.push(this.Va.pb(235));Y=this.Va.Ec();Y.buttons.push(this.Va.pb(233));cb.menu.tc.push(lb);cb.menu.tc.push(Y);wb.buttons.push(cb)}ZKh(wb){if(ea.h(this.$).ha.ra.DK()){const cb=this.Va.Ec();cb.buttons.push(this.Va.pb(232));cb.buttons.push(this.Va.pb(285));cb.buttons.push(this.Va.pb(286));const lb=this.Va.tw("ContextMenu.table",null,D.a.instance.ga(1963),-697806646);lb.menu.tc.push(cb);wb.buttons.push(lb)}}tZe(wb,cb,lb,Y,Oa){if(cb){const Ca=
Q.K(Oa);var Wa=ea.f(this.grid);if(Wa&&!lb&&!Y){lb=new X.a(this.$.xa);if(Wa.range.contains(Ca)&&this.EV(Wa)){(cb=!Wa.yxa&&!lb.ki)&&this.$.isEditMode&&wb.buttons.push(this.Va.pb(45));Wa.nba&&wb.buttons.push(this.Va.pb(53));cb&&this.$.isEditMode&&wb.buttons.push(this.Va.pb(47));return}!Wa.yxa&&this.$.isEditMode&&(Wa=lb.Td(128),wb.buttons.push(this.Va.pb(Wa?46:121)))}}this.P8i(Oa)&&wb.buttons.push(this.Va.pb(48));(Wa=this.$.xa.oa)&&Wa.Gd&&(Wa=Wa.Gd.Gv||Wa.Gd.gI,!cb||this.$.HK||!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||!T.g(this.$)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||Wa||(cb=Q.K(Oa),this.O8i(cb)?wb.buttons.push(this.Va.pb(276)):cb.hf||cb.isRow||wb.buttons.push(this.Va.pb(275))))}P8i(wb){for(const cb of wb){wb=this.grid.getRangeInformation(cb);for(let lb=0;lb<wb.length;lb++)if(Object(w.a)(G.HyperlinkRange,wb[lb])){const Y=this.grid.Sb(wb[lb]);if(Y&&this.EV(Y)&&!Y.yxa)return!0}}return!1}O8i(wb){if(ea.h(this.$).ha.ra.DK()){const cb=ea.h(this.$).Bb.Bj(wb);if(cb&&cb.usedRange.equals(wb))return!0}return!1}iZe(wb,
cb,lb){var Y,Oa;if(1===ea.h(this.$).ha.Oe&&!cb&&!lb){cb=ya.a(this.$);lb=this.Va;var Wa=lb.Ec(),Ca=this.$.da.za(65);(null===(Y=null===Ca||void 0===Ca?void 0:Ca.Zm)||void 0===Y?0:Y.BF)&&!cb&&Wa.buttons.push(lb.pb(227));Ca&&Ca.isCommentOperationEnabled(3)&&Wa.buttons.push(lb.pb(221));(null===(Oa=null===Ca||void 0===Ca?void 0:Ca.Zm)||void 0===Oa?0:Oa.Vkd)&&!cb&&Wa.buttons.push(lb.pb(228));(null===Ca||void 0===Ca?0:Ca.hasCommentAtActiveCell)?Ca.TC.isResolved||Wa.buttons.push(lb.pb(159)):Ca&&Ca.hasCommentAtActiveCell||
(Ca&&Ca.Zm&&Ca.Zm.BF?cb||(Wa.buttons.push(lb.pb(229)),Wa.buttons.push(lb.pb(230))):(Wa.buttons.push(lb.pb(160)),cb||Wa.buttons.push(lb.pb(226))));wb.tc.push(Wa)}}VKh(wb){if(oa.EwaSettings.ma(134)){const cb=this.Va,lb=cb.Ec();lb.buttons.push(cb.pb(250));wb.tc.push(lb)}}ZJh(wb,cb,lb){if(!lb){lb=this.$.Ja.LH();var Y=new X.a(this.$.xa),Oa=new W.a(lb,cb,this.grid);(new L(wb,this.$,this.Va,lb,cb,this.grid,Oa,Y)).Qdd()}}OJh(wb,cb,lb,Y,Oa){const Wa=(new X.a(this.$.xa)).Td(8),Ca=this.Va,Ra=Ca.Ec();cb&&Ra.buttons.push(Ca.pb(Wa?
152:153));lb&&Ra.buttons.push(Ca.pb(Wa?150:151));cb&&(Y||Ra.buttons.push(Ca.pb(Wa?109:155)),Ra.buttons.push(Ca.pb(Wa?111:157)));lb&&(Oa||Ra.buttons.push(Ca.pb(Wa?108:154)),Ra.buttons.push(Ca.pb(Wa?110:156)));wb.tc.push(Ra)}CJh(wb,cb){const lb=this.Va,Y=lb.Ec();wb.tc.push(Y);cb&&Y.buttons.push(lb.pb(102));Y.buttons.push(lb.pb(42));Y.buttons.push(lb.pb(43));cb=this.BKh(lb);wb.tc.push(cb)}BKh(wb){const cb=wb.Ec();cb.title=D.a.instance.ga(1143);cb.H8f=!1;cb.G8f=!1;cb.Qcg=!1;let lb=5;const Y=J.a.ztd(this.$);
Y&&(lb=6);wb=wb.aB("PasteOptionsGallery",lb,"Size24by24",cb.title);cb.buttons.push(wb);wb.iu("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1144,void 0,"Paste_24",1,r.a.Jxh);wb.iu("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1145,void 0,"PasteValues_24",1,r.a.Oxh);wb.iu("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1146,void 0,"PasteFormulas_24",1,r.a.Lxh);wb.iu("ContextMenu.PasteTranspose",-958589048,
"QueryAdvancedPasteContextMenuGalleryIcon",1147,void 0,"PasteTranspose_24",1,r.a.Nxh);wb.iu("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"PasteFormatting_24",1,r.a.Kxh);Y&&wb.iu("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1149,void 0,"PasteLink_24",1,r.a.Mxh);return cb}kLh(wb,cb,lb,Y,Oa){var Wa;const Ca=this.Va;var Ra=Ca.Ec();Ra.buttons.push(Ca.pb(43));wb.tc.push(Ra);this.hhc&&!this.$.HK&&(Ra=this.Va.Ec(),this.Udd(Ra),
wb.tc.push(Ra));oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.dc.isMobileMode&&this.$.ea.dc.isReadOnlyEditMode&&!this.$.va.IsMeetingLiveSession||(Ra=this.Va.Ec(),this.ced(Ra),wb.tc.push(Ra),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));Ra=this.$.da.za(65);if(null===(Wa=null===Ra||void 0===Ra?void 0:Ra.Zm)||
void 0===Wa?0:Wa.BF)Wa=this.Va.Ec(),Wa.buttons.push(Ca.pb(229)),wb.tc.push(Wa);Wa=this.Va.Ec();this.tZe(Wa,cb,lb,Y,Oa);wb.tc.push(Wa);m.AFrameworkApplication.isMobileMode&&!M.a(this.$.va,29)&&(cb=Ca.Ec(),cb.buttons.push(Ca.pb(272)),wb.tc.push(cb))}uKh(wb,cb,lb,Y,Oa){const Wa=this.Va.Ec();this.vKh(Wa);this.tZe(Wa,cb,lb,Y,Oa);0<Wa.buttons.length&&wb.tc.push(Wa)}vKh(wb){wb.buttons.push(this.Va.pb(135))}TJh(wb){const cb=this.Va.Ec();cb.buttons.push(this.Va.pb(185));wb.tc.push(cb)}QKh(wb,cb){oa.EwaSettings.ma(476)&&
cb&&(cb=this.Va.Ec(),cb.buttons.push(this.Va.pb(262)),wb.tc.push(cb))}gKh(wb){var cb=this.grid.ha.ra.selectedRanges;if(cb&&cb.length){var lb=!1;for(var Y=0;Y<cb.length;Y++)if(this.grid.Bb.Oxa(cb[Y])){lb=!0;break}if(lb){lb=!1;for(Y=0;Y<cb.length;Y++){var Oa=this.grid.Bb.nYh(cb[Y]);if(null!=Oa&&null!=Oa[0]){for(var Wa=0;Wa<Oa.length;Wa++)if(this.grid.Bb.Oxa(Oa[Wa])){lb=!0;break}if(lb)break}}Wa=this.Va;Y=Wa.Ec();Oa=Wa.Ec();var Ca=1===cb.length&&(cb[0].isSingle||this.grid.Bb.HNa(cb[0])),Ra=!1,la=!1,ua=
!1,xa=!1;for(let fb=0;fb<cb.length&&!(Ra&&ua&&la&&xa);fb++)!Ra&&this.grid.Bb.doi(cb[fb])&&(Ra=!0),!ua&&this.grid.Bb.Oif(cb[fb],!1)&&(ua=!0),!la&&this.grid.Bb.Ord(cb[fb])&&(la=!0),!xa&&this.grid.Bb.Yff(cb[fb])&&(xa=!0);oa.EwaSettings.ma(104)&&Ca&&!this.grid.Bb.Ozb(cb[0])&&(xa?Y.buttons.push(Wa.pb(217)):Y.buttons.push(Wa.pb(216)));xa=Ra;xa=!(new X.a(this.$.xa)).ki&&xa;ua&&!lb&&(oa.EwaSettings.ma(130)&&H.l(this.$.lg)&&(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?
Oa.buttons.push(Wa.pb(220)):Oa.buttons.push(Wa.pb(xa?220:271)),la&&Oa.buttons.push(Wa.pb(xa?218:269)),Ca&&(this.grid.Bb.Ord(cb[0])||this.grid.Bb.Ozb(cb[0]))&&Oa.buttons.push(Wa.pb(xa?219:270))),Oa.buttons.push(Wa.pb(xa?215:268)));0<Oa.buttons.length&&(cb=Wa.tw(Ra?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,D.a.instance.ga(1774),798637440),cb.menu.tc.push(Oa),Y.buttons.push(cb));0<Y.buttons.length&&wb.tc.push(Y)}}}DJh(wb,cb){this.grid.Bb.dhf(cb)&&
(cb=this.Va.Ec(),this.grid.ha.ra.Yba()?(cb.buttons.push(this.Va.pb(241)),cb.buttons.push(this.Va.pb(239))):cb.buttons.push(this.Va.pb(240)),wb.tc.push(cb))}EV(wb){return wb.cell.hasHyperlink}yZe(wb){this.GKh(wb);var cb=this.Va.Ec();this.ced(cb);wb.tc.push(cb);this.hhc&&(cb=this.Va.Ec(),this.Udd(cb),wb.tc.push(cb))}FKh(wb,cb,lb){this.yZe(wb);this.iZe(wb,cb,lb)}GKh(wb){if(this.grid.ha.ra.Og&&!this.grid.ib.tj){var cb=this.Va,lb=cb.Ec();ha.a(this.$).UTd()?lb.buttons.push(cb.pb(265)):lb.buttons.push(cb.pb(264));
wb.tc.push(lb)}}static PYi(wb){const cb=wb.fLa(Vb.emd);cb&&cb.Znd&Vb.emd&&wb.invoke(Vb.emd,null)}static YJh(wb,cb,lb){(lb=lb.da.za(254))?(lb.Bqd()&&lb.Vnf()&&wb.buttons.push(cb.pb(212)),lb.Bqd()&&lb.Ekc()&&wb.buttons.push(cb.pb(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}GAj(){const wb=this.$.da.za(66).Kg,cb=this.grid.ha.ra.activeCell;return null!=wb&&!wb.hasActiveFilter||Ia.c(this.$,cb)||!this.sji(cb)}sji(wb){const cb=
wb.left;var lb=this.udc();if(null!=lb&&null!=lb.N$b&&lb.N$b.includes(cb-1))return!0;lb=this.ldc();return null!=lb&&Q.D(lb).contains(wb)&&null!=lb.FilteredColumns&&lb.FilteredColumns.includes(cb-1)?!0:!1}qji(){var wb=this.$.da.za(66).Kg;const cb=this.udc();if(null!=wb)return wb.hasAutoFilter&&wb.hasActiveFilter;if(null!=cb)return null!=cb.N$b&&0<cb.N$b.length;wb=this.ldc();return null!=wb&&null!=wb.FilteredColumns&&0<wb.FilteredColumns.length}rji(){var wb=this.$.da.za(66).Kg;const cb=this.udc();if(null!=
wb&&wb.hasAutoFilter||null!=cb&&cb.i0a.every(lb=>0!=lb.length))return!0;wb=Q.D(this.ldc());return null!=wb&&wb.contains(this.grid.ha.ra.activeCell)?!0:!1}udc(){const wb=this.$.da.za(66);wb.Cn(this.grid.ha.ra.activeCell);return wb.hwb(this.grid.ha.ra.activeCell)}ldc(){return this.$.xa.getItemByName(this.$.oa.sheetName).W0}cUh(){var wb=this.grid.ha.ra.activeCell,cb=0,lb=!1,Y=this.$.da.za(66),Oa=this.udc();Y=Y.Kg;null!=Y?(cb=Y.usedRange.top,lb=!0):null!=Oa?(cb=Oa.top,lb=!0):(Oa=this.ldc(),null!=Oa&&
Q.D(Oa).contains(wb)&&(cb=Oa.FirstRow+1,lb=!0));return lb?(wb=wb.left,cb=C.Range.Qc(cb,wb),cb=this.grid.Sb(cb),lb="",null!=cb&&(lb=cb.text),this.tVg(lb,wb)):D.a.instance.ga(220)}tVg(wb,cb){return null==wb||ra.a.Dh(wb.trim())?String.format(D.a.instance.nb(157),C.Range.OM(cb)):wb.length>Vb.x3d?String.format(D.a.instance.nb(155),wb.substring(0,Vb.x3d)):String.format(D.a.instance.nb(156),wb)}KAj(){const wb=this.grid.ha.ra.selectedRanges;if(!wb||!wb.length)return!0;for(let cb=0;cb<wb.length;cb++)if(!this.grid.Bb.Ixa(wb[cb]))return!1;
return!0}}Vb.SKb="GridContextMenuRootName";Vb.q5h=B.a.nFe;Vb.emd=192;Vb.x3d=26;Object(u.a)(Vb,"GridContextMenu",n.a,[])},1220:function(u,E,a){a.r(E);u=a(0);var c=a(15),b=a(87),e=a(1090),f=a(8),d=a(775);class h{}h.iXd="suggested_cells_list_box";Object(u.a)(h,"CssElementIds",null,[]);var m=a(5),l=a(1091);class w{constructor(sa,da){this.Rqg=sa;this.Qqg=da}get u$(){return this.Rqg}get bZc(){return this.Qqg}}Object(u.a)(w,"CellAutoCompleteItem",null,[379]);var n=a(4),y=a(83),t=a(909),r=a(382),v=a(42),
B=a(1),A=a(22),z=a(21);class x extends t.a{constructor(sa,da,S){super(sa,da);this.rSb=null;this.ykc=0;this.g1=this.Z8a=null;this.E6=(oa,K)=>{if(oa=this.cellAutoCompleteControl.items)if(1===oa.length&&this.cellAutoCompleteControl.P1a.length<oa[0].u$.length&&this.cellAutoCompleteControl.Owa&&A.a.wG(oa[0].u$,this.cellAutoCompleteControl.P1a)&&(K.newValue=oa[0].u$),this.Za&&B.EwaSettings.ma(135)){let ea=-1;1<oa.length?ea=this.cellAutoCompleteControl.rdc(this.Za.text,!0):1===oa.length&&(this.cellAutoCompleteControl.Owa||
this.cellAutoCompleteControl.kfc)&&(ea=0);if(0<=ea&&oa.length>ea&&oa[ea].bZc){const ya=v.C(oa[ea].bZc);ya&&z.h(this.$).Bb.Oxa(ya)&&(K.Wff=!0,K.AAe=oa[ea].bZc)}}};this.DGb=()=>{this.cellAutoCompleteControl.Owa=!1};this.Za.xZa(this.E6);if(this.Tzb=B.EwaSettings.nl())this.rSb=S;this.g1=this.Ce.Zd(this.Za.textBox.domElement);this.g1.ka("mousedown",this.DGb)}get jAb(){return!1}get GK(){return this.cellAutoCompleteControl.re}set GK(sa){this.cellAutoCompleteControl.re=sa}get t6a(){return!1}get key(){return r.a.X0c}get cellAutoCompleteControl(){if(this.Tzb)return this.rSb;
const {CellAutoCompleteControl:sa}=a(1220);return this.rSb||(this.rSb=Object(y.a)(sa,this.$.da.za(1)))}dispose(){this.Za.KJb(this.E6);super.dispose()}XY(sa){sa&&!this.cellAutoCompleteControl.re||super.XY(sa)}Yh(sa,da){this.cellAutoCompleteControl.Za=this.Za;this.ykc=sa.keyCode;if(this.Za.eb){const S=this.Za.text;A.a.equals(this.Z8a,S,!1)||(this.Z8a=S)}else this.Z8a=null;if(237279923===da)return this.cellAutoCompleteControl.re=!1;B.EwaSettings.ma(135)&&17===this.ykc&&this.cellAutoCompleteControl.Owa&&
(this.cellAutoCompleteControl.kfc=!0);return super.Yh(sa,da)}zBd(){var sa;if(!B.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!n.AFrameworkApplication.Ng)if(this.cellAutoCompleteControl.Za=this.Za,this.cellAutoCompleteControl.Owa=!1,this.Za.eb){const da=!A.a.equals(this.Z8a,this.Za.text,!0),S=this.Za.Cpd;S||!da&&229!==this.ykc?S&&(this.cellAutoCompleteControl.re&&(this.cellAutoCompleteControl.re=!1),null===(sa=this.cellAutoCompleteControl.qOa)||
void 0===sa?void 0:sa.cancel()):this.cellAutoCompleteControl.aRg(this.ykc)}else this.Z8a=null}rh(){}jg(){this.GK=!1;this.cellAutoCompleteControl.set_visible(!1);this.Z8a=null;this.cellAutoCompleteControl.Owa=!1;this.cellAutoCompleteControl.kfc=!1;this.cellAutoCompleteControl.qOa&&this.cellAutoCompleteControl.qOa.cancel()}ZHd(sa,da){return this.cellAutoCompleteControl.Yh(sa,da)}}Object(u.a)(x,"CellAutoCompleteListAutoCompleteBehavior",t.a,[]);var D=a(30);t=a(1092);var J=a(12),L=a(11),T=a(117);class O extends t.a{constructor(sa,
da,S,oa){super(sa,da);this.htmlSanitizationHelper=this.Gra=this.cellAutoCompleteControl=null;this.htmlSanitizationHelper=S;if(this.Tzb=B.EwaSettings.nl())this.cellAutoCompleteControl=oa;this.qp=[]}get Oj(){return this.Gra}set Oj(sa){this.fCa(this.Oj);this.Gra=sa;const da=this.fCa(this.Oj);this.ee=sa?da.innerText:null;this.ywc(sa)}get re(){return super.re}set re(sa){super.re=sa;sa||(this.Oj=null)}get vUa(){return null}get jHa(){return this.Tzb?this.cellAutoCompleteControl:this.cellAutoCompleteControl||
(this.cellAutoCompleteControl=this.$.da.za(1))}dispose(){super.dispose();this.Gra=null}VAc(sa){this.c8(!1);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&B.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")){var da=document.createElement("table");da.classList.add(this.i6);da.K3j=m.a.fHa;var S=document.createElement("tbody");for(let oa=0,K=this.qp.length;oa<K;oa++){const ea=document.createElement("tr"),ya=document.createElement("td");
ya.classList.add(this.RV);const ha=document.createElement("span");ha.classList.add(O.a3b);ha.setAttribute(m.a.KXc,sa[this.qp[oa]].u$);ha.innerText=sa[this.qp[oa]].u$;ya.appendChild(ha);ea.appendChild(ya);S.appendChild(ea)}da.appendChild(S);this.htmlSanitizationHelper.gU(this.Kf);this.Kf.appendChild(da)}else{da=`<table class='${this.i6}' aria-live='polite'><tbody>`;for(let oa=0,K=this.qp.length;oa<K;oa++)S=D.a.Gg(sa[this.qp[oa]].u$),S=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.RV,O.a3b,m.a.KXc,S,D.a.A9c(S)),da+=S;da+="</tbody></table>";this.Kf.innerHTML=da}this.Kn=J.DOMElementExtensions.nk(this.domElement,this.i6);this.c8(!0);this.tsa()}kKa(sa,da){if(sa&&sa.length){var S=[];if(da)for(let oa=0,K=sa.length;oa<K;oa++)A.a.wG(sa[oa].u$,da)&&S.push(oa);this.qp=S;this.VAc(sa)}else this.re=!1,this.Gra=null}Oya(){}AYg(sa,da,S){let oa=Math.min(sa,Math.max(200,S));da&&sa<S&&(oa+=T.a.Mu);J.DOMElementExtensions.Vv(this.Kf,oa);da&&(oa-=T.a.Mu);return oa}tsa(){super.tsa();var sa=
J.DOMElementExtensions.nk(this.get_element(),this.i6),da=this.qp.length>this.qI,S=z.h(this.$);if(S=S.Sb(S.ha.ra.activeCell))for(sa=this.AYg(sa.offsetWidth,da,S.width),da=this.Kf.getElementsByClassName(O.a3b),S=0;S<da.length;S++)da[S].style.maxWidth=L.HelperMethods.uc(sa);else c.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(sa){if(sa=super.onItemClick(sa)){const da=z.h(this.$);da.Uo(!1);da.focus()}return sa}}
O.a3b=d.a.cxh;Object(u.a)(O,"CellAutoCompleteListBox",t.a,[]);var G=a(24),C=a(64),H=a(113),I=a(171),M=a(46),Q=a(35),U=a(251),N=a(19);a.d(E,"CellAutoCompleteControl",function(){return X});const W=`<div id='${h.iXd}' class='${d.a.D9b} ${N.a.Bo}' ></div>`;class X extends e.a{constructor(sa,da,S){super(sa);this.MDa=null;this.W0c=[];this.B7d=null;this.kfc=this.Owa=!1;this.qde=this.Cq=null;this.eNe=()=>{this.UY.kKa(this.items,this.MDa);this.raiseEvent("ACLBUpdated",new l.a(this.items.length));this.show()};
this.tableManager=da;this.domElement.className=d.a.eQe;B.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&B.EwaSettings.isChangeGateEnabled("OfficeVSO:7141407_FilterDialog_InnerHtml_CleanUp")?(da=document.createElement("div"),da.classList.add(d.a.D9b),da.classList.add(N.a.Bo),da.id=h.iXd,this.domElement.appendChild(da)):this.domElement.innerHTML=W;J.DOMElementExtensions.setVisible(this.domElement,!1);U.d(this.style,this.$.isChromeRtl);this.zhf=B.EwaSettings.nl();this.zAe=
$get(h.iXd,this.domElement);this.UY=new O(this.$,this.zAe,S,this);this.UTa(!0);this.$.domElement.appendChild(this.domElement);this.Apb(sa,H.a(sa));this.Apb(sa,z.h(sa).Vb);this.zhf||this.$.da.Ga(1,this);this.wji=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1)}K_b(sa){this.addHandler("ACLBUpdated",sa)}tuc(sa){this.removeHandler("ACLBUpdated",sa)}R2(sa){this.addHandler("ACLBSelectionChanged",sa)}Kda(sa){this.removeHandler("ACLBSelectionChanged",sa)}OKg(sa){this.addHandler("ACLBMatchedItem",
sa)}Ufj(sa){this.removeHandler("ACLBMatchedItem",sa)}get mu(){return this.UY}get P1a(){return this.MDa}get ee(){return this.UY.ee}get items(){return this.Cq}get qOa(){return this.qde}get activeCell(){return z.h(this.$).ha.ra.activeCell}get dataValidationControl(){return this.B7d||(this.B7d=this.$.da.za(14))}$$f(sa){for(let da=0;da<sa.length;da++){const S=sa.charCodeAt(da);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?A.a.isLetter(S):
A.a.Jqd(S))return!0}return!1}Axa(){return!this.items}dispose(){if(this.$){this.UTa(!1);const sa=z.h(this.$);sa&&sa.view.gr(this.Soc)}b.a.qc([this.UY,this.qOa]);b.a.qc(this.W0c);this.W0c=this.zAe=this.UY=this.Za=null;super.dispose()}Yh(sa,da){let S=!1;if(this.gBj())switch(da){case -798660877:if(1===this.items.length&&this.ee)break;this.mu.BB(1);this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,this.rdc(this.ee),this.ee));S=this.jz(!1);break;case 137938150:if(1===this.items.length&&this.ee)break;
this.mu.BB(-1);this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,this.rdc(this.ee),this.ee));S=this.jz(!1);break;case 2091832999:this.mu.BB(this.qI-1);S=this.jz(!1);break;case 742457698:this.mu.BB(-(this.qI-1));S=this.jz(!1);break;case 125627505:this.Za.textBox.caretPosition=this.Za.text.length;this.re=!1;S=!0;break;case 267796030:this.jz(!0);break;default:S=super.Yh(sa,da)}return S}show(){this.items&&this.items.length&&(this.UY.Oj=this.ee?this.mu.Kn.rows[this.rdc(this.ee)]:null,this.re=
0<this.UY.qp.length,this.xCa(!0),this.UY.Oya())}aRg(sa){const da=!!this.Za&&!C.f(this.$.oa);this.kfc=this.Owa=!1;this.Za&&!this.Za.eb?this.set_visible(!1):da&&!this.Ngh(this.activeCell)&&this.REj(sa)}Ngh(sa){return!!this.dataValidationControl&&this.dataValidationControl.y8c(sa)}jz(sa){if(!this.Za||!this.re)return!1;const da=this.MDa;if(this.ee){var S=J.DOMElementExtensions.LZ(J.DOMElementExtensions.nk(this.UY.Oj,O.a3b),m.a.KXc,"");const oa=S.substring(da.length,S.length);sa?this.Za.text=S:this.Za.insertTextAt(oa,
da.length,this.Za.text.length)}S=z.h(this.$);S.Ul&&(S=S.Vb,S.text=this.Za.text,S.setCaretPosition(this.Za.textBox.caretPosition));sa?this.re=!1:this.Za.textBox.selectRange(da.length,this.Za.text.length);return!0}rdc(sa,da=!1){if(!this.UY.Kn)return-1;const S=this.UY.Kn.children[0],oa=S.children.length;let K;for(let ea=0;ea<oa;++ea)if(K=S.children[ea],A.a.equals(K.innerText.trim(),sa,da))return ea;return-1}SFg(sa,da,S,oa,K,ea,ya){const ha=S.originalText.replace(X.qwf,String.fromCharCode(32)),La=new G.Range(sa.top-
1,sa.left,sa.bottom-1,sa.right,!1,!1),Ia=ya?ya.Cn(S.range):null;(!S.aI||S.range.left===sa.left)&&1<ha.length&&!oa.mb(ha.toUpperCase())&&A.a.wG(ha,da)&&!A.a.equals(ha,da,!0)&&!X.kXe(da)&&this.$$f(ha)&&(!K&&!Ia||!K&&Ia.equals(ya.Cn(La))||K&&S.range.Bd(ea)&&S.range.top!==ea.top)&&(sa=S.formulaBarText,A.a.equals(sa,S.text,!1)||!sa)&&(sa={},sa.FirstRow=S.range.top-1,sa.FirstColumn=S.range.left-1,S=new w(ha,sa),oa.add(ha.toUpperCase(),S))}REj(sa){this.Cq=this.C1h();this.qOa&&this.qOa.cancel();0<this.Za.text.length&&
0!==sa?this.items&&((1<this.items.length||this.re)&&this.tnh(),8!==sa&&127!==sa&&46!==sa&&(1===this.items.length?this.Dmd(!1):this.UY.Oj&&this.jz(!1))):this.re=!1}tnh(){this.re?this.eNe():this.qde=I.AsyncMethodContext.Er(this.eNe,500,M.a.L_g,this.qOa)}Dmd(sa){c.ULS.shipAssertTag(537167966,0,!this.Axa()&&1===this.items.length,"Invalid Items");let da=this.items[0].u$,S=this.Za.text,oa=da.substring(S.length,da.length);if(sa&&!oa.length)this.Za.text=da;else if(!sa&&0<oa.length)this.Za.appendText(oa),
this.Za.textBox.selectRange(S.length,this.Za.text.length);else return;this.raiseEvent("ACLBMatchedItem",new l.a(this.items.length,0,da));this.Owa=!0}C1h(){this.Cq=null;const sa=new Q.a(!1);var da=this.activeCell;this.MDa=this.Za.text.replace(X.qwf,String.fromCharCode(32));const S=this.tableManager.Cn(da),oa=da.Bd(S);if(X.kXe(this.MDa)||!this.$$f(this.MDa))return this.items;const K=new G.Range(1,da.left,da.top-1,da.left,!1,!1);var ea=new G.Range(da.top+1,da.left,f.a.fh,da.left,!1,!1);let ya;const ha=
z.h(this.$);ea=ha.kk("CellAutoCompleteControl.GetSuggestedCells",ea);try{const La=ha.kk("CellAutoCompleteControl.GetSuggestedCells2",K);try{for(const Ia of[La,ea])for(;Ia.$$mn();)ya=Ia.$$cu(),this.SFg(da,this.MDa,ya,sa,oa,S,this.tableManager)}finally{La&&La.dispose()}}finally{ea&&ea.dispose()}this.Cq=Array(sa.values.length);for(da=0;da<this.items.length;da++)this.items[da]=sa.values[da];this.items.sort((La,Ia)=>La.u$.localeCompare(Ia.u$));return this.items}Apb(sa,da){sa&&da&&this.W0c.push(new x(sa,
da,this.zhf?this:void 0))}gBj(){return this.wji?this.P1a&&!this.Axa()&&this.re?this.get_visible():!1:this.P1a&&!this.Axa()&&this.get_visible()&&this.re}static get qwf(){return X.Zee||(X.Zee=new RegExp(String.fromCharCode(160),"g"))}static kXe(sa){sa=0<sa.length?sa.charCodeAt(0):-1;return 35===sa||61===sa||43===sa||45===sa||64===sa}}X.Zee=null;Object(u.a)(X,"CellAutoCompleteControl",e.a,[344,345,346,2])},1227:function(u,E,a){u=a(0);var c=a(566),b=a(561),e=a(558),f=a(1E3);class d{odh(J,L){if(J&&!(1>
J.length)&&L){var T=Object.assign(new e.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.Iah(J,T.ControlList);L.push(T)}}Iah(J,L){const T=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(L,T);L=Object.assign(new e.a,{Title:"",ControlList:[]});Array.add(T.Menu.MenuSectionList,L);this.Uch(J,L.ControlList)}Uch(J,
L){for(let T=0;T<J.length;T++){const O=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",T),Command:"336231556",DisplayName:J[T].userName,LabelText:J[T].userName,ImageBackColor:J[T].color,PersonaId:J[T].email,IsAnonymous:J[T].isAnonymous});Array.add(L,O)}}}Object(u.a)(d,"PresenceContextMenuSectionBuilder",null,[306]);var h=a(84),m=a(4),l=a(175),w=a(559),n=a(106),y=a(134),t=a(87),r=a(82),v=a(105),B=a(25);class A{constructor(J,L,T,O){this.A5d=this.G1=this.Xi=this.sE=this.J8=null;
this.$Xb=J;this.vBg=O;this.$Xb.QMa&&(this.Xi=new n.a(3,2,5E3,Object(h.a)(this,this.dSg,"authenticationCheckTask"),2),m.AFrameworkApplication.Gi.Eg(this.Xi),this.Hg(L,T));this.$Xb.gob(()=>{this.vyf()});this.$Xb.vZa(()=>{this.wyf()})}get businessBar(){return this.G1||(this.G1=r.a.instance.Kh("CommonUI.IBusinessBar"))}get mye(){return this.A5d||(this.A5d=r.a.instance.Kh("CommonUI.IBusinessBarEntryFactory"))}Hg(J,L){const T=m.AFrameworkApplication.ub;T.Ne(B.a.authenticationLost,v.a.frame,J,96);T.Ne(B.a.gwe,
v.a.frame,L,96);T.Nb(B.a.gAe,v.a.frame,l.ActionManager.r8c);T.Nb(B.a.hAe,v.a.frame,l.ActionManager.r8c);T.Nb(B.a.Uud,v.a.frame,l.ActionManager.r8c)}vyf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);m.AFrameworkApplication.ub.processAction(B.a.authenticationLost,2)}wyf(){this.FMj();m.AFrameworkApplication.ub.processAction(B.a.gwe,2)}dSg(){this.$Xb.authenticationCheck()}FMj(){this.sE&&(this.sE.hide(),this.sE.dispose(),this.sE=null);this.J8&&this.businessBar&&(m.AFrameworkApplication.Ng||
this.businessBar.removeEntry(this.J8),this.J8.dispose(),this.J8=null)}showDialog(J){t.a.Ia(this.sE);this.sE=new y.StandardDialog;this.vBg||(this.sE.It=!1,this.sE.Rb=0);this.sE.oc(1,CommonUIStrings.l_SignIn);this.sE.kX(CommonUIStrings.l_DefaultDialogTitle,J,Object(h.a)(this,this.vw,"dialogHandler"))}vw(J){1===J?(w.a.a7(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),m.AFrameworkApplication.ub.processAction(B.a.Uud,2)):(this.gUd(),m.AFrameworkApplication.ub.processAction(B.a.hAe,
2))}gUd(){this.businessBar&&this.mye&&(this.J8=this.mye.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.J8.closeable=!0,this.J8.addButton(CommonUIStrings.l_SignIn,A.yXg,""),this.J8.N$=Object(h.a)(this,this.BXg,"businessBarEntryCloseHandler"),this.businessBar.zC(this.J8,!1))}BXg(){this.Ukh();m.AFrameworkApplication.ub.processAction(B.a.gAe,2)}Ukh(){this.Xi&&(m.AFrameworkApplication.Gi.np(this.Xi),this.Xi=null)}dispose(){this.Xi=this.sE=this.J8=
null}static yXg(){w.a.a7();m.AFrameworkApplication.ub.processAction(B.a.Uud,2)}}Object(u.a)(A,"SignOutResponseUI",null,[2]);var z=a(248);class x{get name(){return"Common.App.UI"}Wh(J){J.register(d,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").xc()}init(){}dispose(){t.a.Ia(x.r2);x.r2=null}static main(){z.a.instance.Fi(new x)}}x.r2=null;Object(u.a)(x,"CommonAppUIPackage",null,[4,5]);a.d(E,"a",function(){return D});const D=()=>{Type.registerNamespace("CAUI");
x.main()}},1228:function(u,E,a){u=a(0);var c=a(55),b=a(222),e=a(1220),f=a(50),d=a(37),h=a(1),m=a(695);class l extends b.a{constructor(B){super();this.$=B;this.Fb()}create(){const B=this.$.da,A=f.GetServiceTaskFactory.create(B,134,this.la,this.Ya),z=f.GetServiceTaskFactory.Oa(B,213,214,this.Ya),x=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")?f.GetServiceTaskFactory.Oa(this.$.da,
498,499,this.Ya):c.Task.Ta(null);d.TaskExtensions.Aa(d.TaskExtensions.Ed([A,z,x],this.la),()=>{if(h.EwaSettings.nl())this.ob(Object(m.a)(this.$.da,1,()=>{const D=new e.CellAutoCompleteControl(this.$,A.result,x.result);z.result.ka(D);return D}));else{let D=B.za(1);D||(D=new e.CellAutoCompleteControl(this.$,A.result,x.result),z.result.ka(D));this.ob(D)}},this.la,3)}static ka(B){B.da.Ga(151,new l(B))}}Object(u.a)(l,"CellAutoCompleteControlFactory",b.a,[]);var w=a(15),n=a(13);class y{constructor(B,A){this.C_a=
null;this.uFf=(z,x)=>{1<x.length&&(z=n.a.instance.ga(857),this.ariaLiveNotifier.qQf(z,x.length))};this.vFf=(z,x)=>{w.ULS.shipAssertTag(537167961,0,0<=x.selectedIndex&&0<=x.length&&x.selectedIndex<x.length,"Invalid ListEventArgs: SelectedIndex/Length");w.ULS.shipAssertTag(537167960,0,!!x.qG,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.V9i(x.qG,x.selectedIndex+1,x.length)};this.wFf=(z,x)=>{this.ariaLiveNotifier.MQa(x.qG)};this.ariaLiveNotifier=B;h.EwaSettings.nl()||A.Ga(213,
this)}dispose(){this.F_d();this.C_a=null}ka(B){B&&(this.C_a=B,B.K_b(this.uFf),B.R2(this.vFf),B.OKg(this.wFf))}F_d(){this.C_a&&(this.C_a.tuc(this.uFf),this.C_a.Kda(this.vFf),this.C_a.Ufj(this.wFf))}}Object(u.a)(y,"CellAutoCompleteReadoutHandler",null,[455,2]);class t extends b.a{constructor(B){super();this.$=B;this.Fb()}create(){const B=this.$.da;d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(B,211,212,this.Ya),A=>{if(h.EwaSettings.nl())this.ob(Object(m.a)(B,213,()=>new y(A.result,B)));else{const z=
B.za(213)||new y(A.result,B);this.ob(z)}},this.la,3)}static ka(B){B.da.Ga(214,new t(B))}}Object(u.a)(t,"CellAutoCompleteReadoutHandlerFactory",b.a,[]);var r=a(9);a.d(E,"a",function(){return v});const v=()=>{r.a.Fa(l.ka);r.a.Fa(t.ka)}},1229:function(u,E,a){var c=a(9);u=a(0);var b=a(235),e=a(222),f=a(50),d=a(37),h=a(1),m=a(15),l=a(87),w=a(4),n=a(78),y=a(8),t=a(24),r=a(64),v=a(42),B=a(142),A=a(47),z=a(46),x=a(12),D=a(13),J=a(21),L=a(27),T=a(19),O=a(53);class G extends n.a{constructor(U,N,W,X){super();
this.isMac=L.a.isMac;this.nxa=!1;this.$=U;this.ariaLiveNotifier=X;this.wo=W.R5b(U,null,N,T.a.ISe,O.a.we(9),D.a.instance.ga(1731),"PulloutPointerDown")}Egg(U){this.nxa!==U&&(this.hide(),(this.nxa=U)?this.wo.whg(T.a.Oyh,O.a.we(3)):this.wo.whg(T.a.ISe,O.a.we(9)))}get zz(){return this.wo.zz}get buttonWidth(){return this.wo.buttonWidth}dispose(){this.wo.dispose();this.$=null;super.dispose()}domElement(U){return this.wo.domElement(U)}getButton(U){return this.wo.getButton(U,!1)}nQb(U,N){this.wo.nQb(U,N,
!1)}ABa(U,N){const W=J.h(this.$),X=W.ib.Ni(U);this.wo.nQb(this.nxa?D.a.instance.ga(1733):N?D.a.instance.ga(1731):D.a.instance.ga(1732),X);N=this.isMac?N?D.a.instance.ga(1736):D.a.instance.ga(1737):N?D.a.instance.ga(1734):D.a.instance.ga(1735);var sa=W.fg(U,X);U=W.Bf(X).Am;if(sa&&0<=sa.x&&0<=sa.y){const da=sa.bottomRight.x+this.zz;sa=sa.topLeft.y-this.zz-this.buttonWidth;if(sa<U.topLeft.y+this.zz){if(W.ib.iCa){this.hide();return}sa=U.topLeft.y+this.zz}this.Qp(da,sa,W.rtl,X);this.ariaLiveNotifier.MQa(N)}else this.hide()}Qp(U,
N,W,X){this.wo.Qp(U,N,W,X,!1)}hide(){this.wo.hide()}}Object(u.a)(G,"PulloutLaunchButton",n.a,[]);var C=a(33),H=a(22);class I extends n.a{constructor(U,N,W,X,sa){super();this.vYa=this.rPc=this.Dwc=this.nGa=this.dS=this.fP=null;this.qhe=0;this.zDb=this.gAb=this.gGc=!1;this.Cg=()=>{this.exa&&(this.gridView?1===this.gridView.ha.Oe?(this.gridView.ha.ra.activeCell.equals(this.nGa)||this.GN||this.ny(),this.vpb.sq()):this.ny():m.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};this.rh=
()=>{this.ny()};this.dd=()=>{this.iX()};this.Bc=()=>{this.ny()};this.gd=()=>{this.showCallout()};this.mza=()=>{if(this.Tg.al&&this.Tg.al.length)if(this.D_c)this.Tg.vxi||(this.gGc=this.Tg.al[0].BlockingDataForExpand),this.Tg.nSh&&m.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.qhe=this.Tg.t6c&&this.Tg.OYe<this.Tg.t6c.left-1?this.Tg.t6c.left-1-this.Tg.OYe:-1,this.showCallout();else if(this.gridView.ha.ra.Og){var da=this.gridView.ha.ra.activeCell;
if(da&&this.dS){var S=this.tableManager.Cn(da);this.hNc=!!S;const oa=this.gridView.ha.ra.$c;S=this.GN&&this.dS.Bd(S);const K=this.Jjd&&!this.GN&&oa.equals(this.selectedRange);S||K?(m.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.E$b=!0,h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.GN&&this.tableManager.aka(da)?m.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.GN?this.Eh.ABa(this.dS,this.GN):this.Eh.ABa(oa,this.GN):this.Eh.ABa(this.dS,this.GN),this.mvc())):m.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.hj=()=>{this.G7a()&&this.Eh.hide();1===this.gridView.ha.Oe&&this.iX()};this.AR=()=>{const da=this.gridView.ha.Oe;this.gridView.ha.ra.activeCell&&1===da&&this.iX()};this.Rt=()=>{if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.GN){if(this.dS&&
this.nGa){var da=this.tableManager.Cn(this.nGa);da&&1<da.bottom-da.top&&(--da.bottom,this.gridView.H5(da)&&this.vpb.sq())}}else this.gridView.ha.ra.Og&&this.gridView.H5(this.gridView.ha.ra.$c)&&this.vpb.sq();else this.dS&&this.nGa&&this.GN&&(da=this.tableManager.Cn(this.nGa))&&1<da.bottom-da.top&&(--da.bottom,this.gridView.H5(da)&&this.vpb.sq())};this.iX=()=>{if(this.$&&this.gridView){if(this.E$b&&this.GN){const da=this.gridView.ha.ra.activeCell;this.dS=this.UWe();const S=!!this.Dwc&&this.Dwc.contains(da);
if(this.dS&&(da.equals(this.nGa)||S)){this.Eh.ABa(this.dS,this.GN);return}}this.E$b=!1;(this.dS=this.UWe())&&this.fma&&this.gridView&&this.gridView.Ea.ps(this.fma)?(this.D_c=!1,this.OZ()):(this.Tg.v0c(),this.Tg.P2b());this.E$b||this.Eh.hide()}};this.$=U;this.tableManager=W;this.contextMenuManager=X;this.Eh=new G(U,this.gd,N,sa);this.Tg=N.a5c(U,W);this.E$b=this.D_c=!1;this.Jjd=h.EwaSettings.ma(135);this.hNc=!0;this.DEa=!1;this.gridView=J.h(this.$);this.gridView.Vb.Yk(this.rh);this.gridView.jv(this.AR);
this.$.ml(this.dd);this.$.ik(this.Bc);this.$.PA(this.hj);this.gridView.view.nt(this.Rt);this.gridView.ha.NT(this.Cg);this.vpb=A.a.instance.create(this.iX,250,z.a.k6i);m.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Tg.B_b(this.mza);C.a.hAb()&&(this.gAb=!0);this.iX();U.da.Ga(261,this)}get mc(){return this.Eh.domElement(1)}get fma(){return this.rPc}get selectedRange(){return this.vYa}get GN(){return this.hNc}get nxa(){return this.DEa}get mOf(){return this.qhe}get TCb(){const U=
this.Eh.domElement(this.Vea);return U?x.DOMElementExtensions.isVisible(U):!1}get exa(){return this.$.isEditMode&&h.EwaSettings.ma(135)?!(new B.a(this.$.xa)).ki:!1}get rNg(){return this.gGc}get Vea(){return this.fma?this.gridView.ib.Ni(this.fP):1}dispose(){this.gridView&&(this.gridView.ha.XR(this.Cg),this.gridView.view.gr(this.Rt),this.gridView.Vb&&this.gridView.Vb.Hk(this.rh));if(this.$){const U=this.$;U.Jl(this.dd);U.Il(this.Bc);U.YD(this.hj);J.h(U).Ky(this.AR)}this.Tg&&this.Tg.luc(this.mza);l.a.Ia(this.Eh);
this.Tg=this.$=this.gridView=this.vpb=this.Eh=null;super.dispose()}ny(){this.Eh.hide()}Qda(){this.Eh?this.Eh.getButton(this.Vea).Rcb():m.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}Dkj(){this.dS=null}HNf(){this.Eh&&this.Eh.hide()}E3h(){if(!this.Jjd||1!==this.selectedRange.width)return null;const U=this.selectedRange.clone();for(;this.gridView.H5(U);){U.left+=1;U.right+=1;if(!this.gridView.Bf(this.gridView.ib.Ni(U)).vi.Ke(U))break;if(!this.gridView.Ea.ps(U))continue;
const N=this.gridView.kk("PulloutManager.GetValidatedRangeToFill",U,2);try{if(I.B_j(N))return U}finally{N&&N.dispose()}}return null}mvc(){this.Tg.Tcb()}showCallout(){this.exa&&(this.Tg.k7a?(this.Eh.getButton(this.Vea).HHb(),h.EwaSettings.nl()?d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,8,9,0),U=>{this.i7f(U.result)},this.$.la,3):this.i7f(this.contextMenuManager)):(this.D_c=!0,this.OZ()))}i7f(U){U.bfd("tableFieldList").Y0(null,this.Eh.domElement(this.Vea),this.Tg,null,!0);this.mvc()}UWe(){if(!this.exa||
!this.gridView||this.gridView.ha.Sa.$b||!this.gridView.ha.ra.Og)return null;var U=this.gridView.ha.ra.activeCell,N=J.h(this.$).ib.Ni(U);if(!U)return null;this.nGa=U.clone();var W=this.tableManager.Cn(U);this.hNc=!!W;if(this.GN){this.Eh.nQb(D.a.instance.ga(1731),N);this.fP=I.Njg(W);if(!this.fP)return null;U=!1;N=({NY:U}=this.tableManager.bGe(W,this.gridView)).returnValue||U;this.gGc=U;if(N)return this.Dwc=new t.Range(W.top,W.left,W.bottom,W.right,!1,!1),this.rPc=new t.Range(this.fP.top,this.fP.right+
1,this.fP.top,this.fP.right+1,!1,!1),this.gAb&&(this.DEa=!1,this.Eh.Egg(this.DEa)),this.fP}else if(this.Jjd){this.vYa=this.gridView.ha.ra.$c.clone();W=this.selectedRange.isSingle&&J.h(this.$).Bb.Fgf(this.selectedRange);const X=J.h(this.$).Bb.Oxa(this.selectedRange);this.gAb&&(this.DEa=W&&!X);this.Eh.nQb(this.DEa?D.a.instance.ga(1733):D.a.instance.ga(1732),N);W&&!X&&!this.zDb&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&H.a.equals(w.AFrameworkApplication.uiCulture,
"en-us",!0)&&(w.AFrameworkApplication.Ip("XLS-DateSuggestionV2-Treatment;XLS-DateSuggestionV2-Control"),this.zDb=!0);this.fP=I.Njg(this.selectedRange);if(!(this.gAb&&W||X)||!this.fP||!this.selectedRange||h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.aka(this.selectedRange))return null;this.rPc=this.E3h();if((h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.H5(this.selectedRange):
this.gridView.H5(this.fP))&&this.fma)return this.gAb&&this.Eh.Egg(this.DEa),this.Dwc=this.fP,m.ULS.sendTraceTag(537154137,0,50,`PulloutManager:FindSelection, NextRange, ${this.fma?this.fma.toString():"null"}, RightColumnHeader, ${this.fP?this.fP.toString():"null"}, ActiveCell, ${U?U.toString():"null"}`),this.fP}return null}OZ(){this.GN?this.Tg.OZ(v.v(this.fma,this.$),!1,!0):this.DEa?this.Tg.j2i():h.EwaSettings.ma(135)&&this.Tg.OZ(v.v(this.selectedRange,this.$),!0,!1)}G7a(){return this.$.ea.isNamedObjectViewMode&&
r.f(this.$.oa)}static B_j(U){for(;U.$$mn();)if(U.$$cu().text||U.$$cu().aI||U.$$cu().ti||U.Zn.O$e)return!1;return!0}static Njg(U){return U.right===y.a.qh?null:new t.Range(U.top,U.right,U.top,U.right,!1,!1)}}Object(u.a)(I,"PulloutManager",n.a,[337,2]);class M extends e.a{constructor(U){super();this.$=U;this.Fb()}create(){c.a.Fa(U=>{const N=f.GetServiceTaskFactory.Oa(U.da,12,477,this.Ya),W=f.GetServiceTaskFactory.Oa(U.da,66,134,this.Ya),X=f.GetServiceTaskFactory.Oa(U.da,211,212,this.Ya);let sa=b.a.Ta(null);
const da=!h.EwaSettings.nl();da&&(sa=f.GetServiceTaskFactory.Oa(U.da,8,9,this.Ya));d.TaskExtensions.Aa(d.TaskExtensions.Ed([N,W,sa,X],U.la),()=>{da?this.ob(this.$.da.za(261)||new I(this.$,N.result,W.result,sa.result,X.result)):this.ob(this.$.da.za(261)||new I(this.$,N.result,W.result,null,X.result))},U.la)})}static ka(U){U.da.Ga(262,new M(U))}}Object(u.a)(M,"PulloutManagerFactory",e.a,[]);a.d(E,"a",function(){return Q});const Q=()=>{c.a.Fa(U=>{U.ma(135)&&M.ka(U)})}},1238:function(u,E,a){u=a(0);var c=
a(187);class b{HLj(t,r){t.set_visible(!1);r.set_visible(!0)}}Object(u.a)(b,"DefaultTabSwitchBehaviour",null,[423]);class e{}e.rMj="TabsContainer";e.dMj="TabTitlesContainer";e.bMj="TabTitle";e.cMj="TabTitleText";e.IXd="TabTitleActive";Object(u.a)(e,"MultitabControlStyles",null,[]);var f=a(84),d=a(45),h=a(85),m=a(86),l=a(56);class w{constructor(t,r,v){this.xk=t;this.Wp=r;this.QHc=v;this.Rfa=document.createElement("a");l.a.Hxc(this.Rfa,this.Wp);Sys.UI.DomElement.addCssClass(this.Rfa,e.cMj);Sys.UI.DomElement.addCssClass(this.xk,
e.bMj);this.xk.appendChild(this.Rfa);this.Rfa.tabIndex=0;this.VCc();d.a.addHandler(this.xk,"click",this.QHc);d.a.addHandler(this.xk,"keyup",Object(f.a)(this,this.kab,"onTitleKeyUp"))}get mc(){return this.xk}get title(){return this.Wp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.xk,e.IXd)}set isActive(t){this.setActive(t)}dispose(){d.a.removeHandler(this.xk,"keyup",Object(f.a)(this,this.kab,"onTitleKeyUp"));d.a.removeHandler(this.xk,"click",this.QHc);this.xk=this.Rfa=null}setActive(t){t?
Sys.UI.DomElement.addCssClass(this.xk,e.IXd):Sys.UI.DomElement.removeCssClass(this.xk,e.IXd);this.Rfa&&this.Rfa.setAttribute(m.a.rha,t)}kab(t){t.keyCode!==h.a.Lh&&t.keyCode!==h.a.$ea||this.QHc(t)}VCc(){this.xk.setAttribute(m.a.Ld,m.a.cs);this.Rfa.setAttribute(m.a.kv,this.Wp);this.Rfa.setAttribute(m.a.Ld,m.a.npb)}}Object(u.a)(w,"TabTitleControl",null,[2]);var n=a(40);a.d(E,"a",function(){return y});class y{constructor(t,r=null,v=null){this.Qmb=this.Ymb=null;this.B1=-1;this.xk=t;this.Ega=r||new c.a;
this.uCg=v||new b;this.QFa=new c.a;t=0;for(let B of this.Ega)this.rtd(this.B1)||(this.B1=t),r=t++,this.QFa.add(new w(document.createElement("li"),B.title,this.uah(r)))}get XAc(){return this.Ega.count}get activeTab(){return this.B1}set activeTab(t){this.ibg(t)}get mc(){return this.xk}get visible(){return n.a.isVisible(this.xk)}set visible(t){this.xk.style.visibility=t?"visible":"hidden"}pVf(){this.Ymb=document.createElement("ul");this.Ymb.className=e.dMj;this.Qmb=document.createElement("div");this.Qmb.className=
e.rMj;for(let t=0;t<this.XAc;++t){const r=this.Ega.na(t),v=this.QFa.na(t);r.set_visible(!1);v.isActive=!1;const B=document.createElement("div");r.render(B);this.Qmb.appendChild(B);this.Ymb.appendChild(v.mc)}this.mc.appendChild(this.Ymb);this.mc.appendChild(this.Qmb);this.rtd(this.B1)&&(this.QFa.na(this.B1).isActive=!0,this.Ega.na(this.B1).set_visible(!0))}dispose(){for(let t=0;t<this.XAc;++t)this.Ega.na(t).dispose(),this.QFa.na(t).dispose();this.QFa=this.Ega=this.xk=this.Qmb=this.Ymb=null}setFocus(){this.Ega.na(this.B1).setFocus()}rtd(t){return 0<=
t&&t<this.XAc}ibg(t){this.B1!==t&&this.rtd(t)&&(this.uCg.HLj(this.Ega.na(this.B1),this.Ega.na(t)),this.QFa.na(this.B1).isActive=!1,this.QFa.na(t).isActive=!0,this.B1=t,this.setFocus())}uah(t){return()=>{this.ibg(t)}}}Object(u.a)(y,"MultitabControl",null,[410,2])},1251:function(u,E,a){var c=a(9);u=a(0);var b=a(7),e=a(222),f=a(50),d=a(37);class h{constructor(){this.isFeedbackAllowed=!1;this.zoomLevel=0}}Object(u.a)(h,"FormulaAssistanceUIContext",null,[]);var m=a(184);class l extends e.a{constructor(n){super();
this.hpj="formulaAssistance";this.$=n;this.Fb()}create(){let n=this.$.da.za(448);if(n)this.ob(n);else{var y=f.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Ya);d.TaskExtensions.Aa(y,()=>{d.TaskExtensions.Aa(m.c(y.result.ln.loadScript(this.hpj)),()=>{n=this.$.da.za(448);if(!n){const t=Object(b.a)(new h,{isFeedbackAllowed:this.$.isFeedbackEnabled});n=this.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(t));this.$.rBe(()=>{const r={};r.isFeedbackAllowed=this.$.isFeedbackEnabled;
n.updateContext(r)})}this.ob(n)},this.$.la,3)},this.$.la,3)}}static ka(n){n.da.Ga(449,new l(n))}}Object(u.a)(l,"FormulaAssistanceUIControlFactory",e.a,[]);a.d(E,"a",function(){return w});const w=()=>{c.a.Fa(n=>{l.ka(n)})}},1252:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(50),f=a(37),d=a(21),h=a(15),m=a(31),l=a(209),w=a(24),n=a(64),y=a(1088),t=a(11);class r{constructor(A,z){this.gOa=1;this.T9=[];this.GAb=this.active=!1;this.Ww=()=>{const x=this.gridView.ajd();if(!(0>=x||x===this.gOa||this.gridView.Sr)){var D=
!1,J=[],L=[];for(var T=this.T9.length-1;0<=T;T--){var O=this.T9[T];if(this.$id(O)>x||O.bottom<x)J.push(O),this.T9.splice(T,1),D=!0}for(T=this.tableManager.rangeList.length-1;0<=T;T--){O=this.tableManager.rangeList[T];const G=this.$id(O);G<=x&&O.bottom>=x&&!(G<=this.gOa&&O.bottom>=this.gOa)&&O.pba&&(L.push(O),D=!0)}if(D){O=this.gridView.Nqc;for(let G of O)for(let C of G)for(let H of C)this.GAb?this.n1g(H,J,L):this.o1g(H,J,L,D)}else h.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
this.gOa=x}};this.CCf=(x,D)=>{D.isRow||D.dXc(this.Iec)};this.DCf=(x,D)=>{D.isRow||(this.tableManager.rangeList.length||this.deactivate(),D.YLd(this.Iec))};this.Iec=(x,D)=>{if(this.Td())this.activate();else if(x=this.active,this.deactivate(),!x){h.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(D=D.Kt)&&this.w9f(D.X4,D)};this.oFf=(x,D)=>{!this.gridView.Sr&&(this.Td()?this.activate():(x=this.active,this.deactivate(),
x||h.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),D=D.Kt)&&(x=y.a(D.X4),this.w9f(x,D)&&D.hRd(x))};this.te=()=>{this.gridView.ib.U4?this.deactivate():this.activate()};this.tableManager=A;this.gridView=z;this.$=z.$;A.jre(this.oFf);z.wKg(this.CCf);z.xKg(this.DCf);this.$.xa.Vf(this.te);this.$.Cb.Vf(this.te);this.Lue(x=>{x.dXc(this.Iec)});this.GAb=this.gridView.Tka;this.Td()&&(this.activate(),this.Ww(this,null));this.$.da.Ga(68,this)}dispose(){this.deactivate();
this.gridView&&(this.tableManager.SUf(this.oFf),this.gridView.Ifj(this.CCf),this.gridView.Jfj(this.DCf),this.$.xa.Dg(this.te),this.$.Cb.Dg(this.te),this.Lue(A=>{A.YLd(this.Iec)}));this.gridView=this.tableManager=this.T9=null}LBc(A,z,x){if(!n.b(this.$.oa)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.iCa)return!0;const D=x.A7e();var J=D.length;if(D[J-1]<A.left)return!1;var L=t.HelperMethods.jw(new l.a(D),0,J,A.left,t.HelperMethods.FB);if(0>L)return!1;const T=A.IYd;J=Math.min(T.length+L,J);let O=
0;for(;L<J;L++){const G=D[L];z?(x.updateCellText(L,T[O]),this.Woe(A,O,G)):(x.updateCellText(L,w.Range.OM(G)),this.fNe(G));x.fn("HeaderSnappingFeature::toggleHeaderSnapping",L);O++}A.HBa=z;return!0}MBc(A,z,x,D){if(!n.b(this.$.oa)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.iCa)return!0;if(!x.length)return!1;var J=D.length;if(D[J-1]<A.left)return!1;var L=t.HelperMethods.jw(new l.a(D),0,J,A.left,t.HelperMethods.FB);if(0>L)return!1;const T=A.IYd,O=!!A.i0a&&0<A.i0a.length,G=!!A.menuModel&&0<A.menuModel.length;
for(let H=L,I=0,M=Math.min(T.length+L,J);H<M;H++,I++)if(J=x[H]){L=null;var C=J.getElementsByClassName(m.a.Ead);C&&(L=C[0]);if(L&&L.innerText){if(C=J.getElementsByClassName(m.a.rse))for(let Q=C.length-1;0<=Q;Q--)J.removeChild(C[Q]);C=D[H];z?(L.innerText=T[I],J.classList.add(m.a.dUe),O&&A.i0a[I]&&(L=document.createElement("div"),L.innerHTML=A.i0a[I],G&&A.menuModel[I]&&this.Woe(A,I,C),J.appendChild(L.firstChild))):(J.classList.remove(m.a.dUe),L.textContent=w.Range.OM(C),this.fNe(C))}}A.HBa=z;return!0}Woe(A,
z,x){this.$.da.$a(8,D=>{D.M$b.RQi(A,z,x)})}fNe(A){this.$.da.$a(8,z=>{z.M$b.SQi(A)})}o1g(A,z,x,D){const J=A.Jt,L=y.a(A.X4);let T;for(let O=z.length-1;0<=O;O--)T=z[O],this.MBc(T,!1,L,J)&&z.splice(O,1);for(z=x.length-1;0<=z;z--)T=x[z],this.MBc(T,!0,L,J)&&this.T9.push(T);D&&A.hRd(L)}n1g(A,z,x){if(A.sZg()){for(var D=z.length-1;0<=D;D--)this.LBc(z[D],!1,A)&&z.splice(D,1);for(z=x.length-1;0<=z;z--)D=x[z],this.LBc(D,!0,A)&&this.T9.push(D)}}w9f(A,z){const x=this.GAb?z.A7e():z.Jt;var D=x[0];const J=x[x.length-
1],L=this.c3h(D,J);let T=!1;for(let O=this.T9.length-1;0<=O;O--){const G=this.T9[O];J>=G.left&&D<=G.right&&(this.GAb?this.LBc(G,!1,z):this.MBc(G,!1,A,x),this.T9.splice(O,1),T=!0)}for(let O=0,G=L.length;O<G;O++)if(D=L[O],this.GAb?this.LBc(D,!0,z):this.MBc(D,!0,A,x))this.T9.push(L[O]),T=!0;return T}activate(){this.Td()&&!this.active&&(this.gridView.view.nt(this.Ww),this.active=!0)}deactivate(){this.active&&(this.gridView.view.gr(this.Ww),this.active=!1)}Td(){return n.b(this.$.oa)&&!this.$.ea.isNamedObjectViewMode&&
0>=this.gridView.ib.jP&&0<this.tableManager.rangeList.length}Lue(A){const z=this.gridView.Nqc;for(let x of z)for(let D of x)for(let J of D)A(J)}c3h(A,z){const x=[];if(!this.active)return x;this.gOa=this.gridView.ajd();for(let D=this.tableManager.rangeList.length-1;0<=D;D--){const J=this.tableManager.rangeList[D];J.bottom>=this.gOa&&this.$id(J)<=this.gOa&&J.left>=A&&J.right<=z&&J.pba&&x.push(J)}return x}$id(A){const z=this.gridView.Bb.Bj(A);return z&&this.tableManager.Thf(A,z.usedRange.topLeft)?A.top+
1:A.top}}Object(u.a)(r,"HeaderSnappingFeature",null,[2]);class v extends b.a{constructor(A){super();this.$=A;this.Fb()}create(){const A=e.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Ed([A],this.la),()=>{this.ob(this.$.da.za(68)||new r(A.result,d.h(this.$)))},this.la,11)}static ka(A){A.da.Ga(67,new v(A))}}Object(u.a)(v,"HeaderSnappingFactory",b.a,[]);a.d(E,"a",function(){return B});const B=()=>{c.a.Fa(v.ka)}},1277:function(u,E,a){var c=a(9);u=a(0);
var b=a(15),e=a(872),f=a(27),d=a(196),h=a(222),m=a(227),l=a(1),w=a(51),n=a(55),y=a(184),t=a(33);class r{constructor(){this._list={}}addHandler(x,D){var J;this._list[x]=[...(null!==(J=this._list[x])&&void 0!==J?J:[]),D]}removeHandler(x,D){const J=this._list[x];void 0!==J&&(D=J.indexOf(D),0<=D&&(this._list[x]=[...J.slice(0,D),...J.slice(D+1)]))}getHandler(x){const D=this._list[x];return D&&0!==D.length?(J,L)=>{for(const T of D)T(J,L)}:null}static iKb(){Sys.EventHandlerList.prototype.addHandler=r.prototype.addHandler;
Sys.EventHandlerList.prototype.getHandler=r.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=r.prototype.removeHandler}}Object(u.a)(r,"EventHandlerListOptimized",null,[]);class v{constructor(){this._list={}}addHandler(x,D){this.invalidate(x);void 0===this._list[x]?this._list[x]=[D]:this._list[x].push(D)}invalidate(x){void 0!==this.wA&&this.wA.delete(x)}removeHandler(x,D){const J=this._list[x];void 0!==J&&0!==J.length&&(D=J.indexOf(D),0<=D&&(this.invalidate(x),J.splice(D,1)))}getHandler(x){void 0===
this.wA&&(this.wA=new Map);var D=this.wA.get(x);return void 0===D?(D=this.makeHandler(x),this.wA.set(x,D),D):D}makeHandler(x){x=this._list[x];if(!x||0===x.length)return null;const D=[...x];return(J,L)=>{for(let T=0;T<D.length;++T)D[T](J,L)}}static iKb(){Sys.EventHandlerList.prototype.addHandler=v.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=v.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=v.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=v.prototype.makeHandler;
Sys.EventHandlerList.prototype.invalidate=v.prototype.invalidate}}Object(u.a)(v,"EventHandlerListMemoized",null,[]);class B{constructor(x){this.a=x;this.preventDefault=B.CJf.preventDefault;this.stopPropagation=B.CJf.stopPropagation;const D=this.type=x.type.toLowerCase();this.rawEvent=x;this.altKey=x.altKey;"undefined"!==typeof x.button&&(this.button="undefined"!==typeof x.which?x.button:4===x.button?Sys.UI.MouseButton.middleButton:2===x.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton);
"keypress"===D?this.charCode=x.charCode||x.keyCode:this.keyCode=x.keyCode&&46===x.keyCode?127:x.keyCode;this.clientX=x.clientX;this.clientY=x.clientY;this.ctrlKey=x.ctrlKey;this.target=x.target?x.target:x.srcElement;this.screenX=x.screenX;this.screenY=x.screenY;this.shiftKey=x.shiftKey}get offsetX(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetX)return this.rawEvent.offsetX;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){const x=Sys.UI.DomElement.getLocation(this.target);
return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-x.x}}}get offsetY(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientY){const x=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||0)+this.clientY-x.y}}}static iKb(){Sys.UI.DomEvent=B;B.registerClass("Sys.UI.DomEvent",void 0,void 0)}}B.addHandler=Sys.UI.DomEvent.addHandler;
B.addHandlers=Sys.UI.DomEvent.addHandlers;B.removeHandler=Sys.UI.DomEvent.removeHandler;B.clearHandlers=Sys.UI.DomEvent.clearHandlers;B._removeHandler=Sys.UI.DomEvent._removeHandler;B._clearHandlers=Sys.UI.DomEvent._clearHandlers;B._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;B.CJf=Sys.UI.DomEvent.prototype;B.registerClass=function(x,D,J){this.prototype.constructor=this;this.__typeName=x;this.__class=!0;D&&(this.__baseType=D,this.__basePrototypePending=!0);Sys.__upperCaseTypes[x.toUpperCase()]=
this;if(J){this.__interfaces=[];for(let L=2,T=arguments.length;L<T;L++)this.__interfaces.push(arguments[L])}return this};Object(u.a)(B,"DomEventLazy",null,[320]);class A extends h.a{constructor(x){super();this.$=x;this.T5b=null;this.Fb()}create(){b.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");e.a.then(this.bdh(),x=>{this.ob(x)})}bdh(){if(this.T5b)return this.T5b;const x=m.a.L1a(w.b(),d.a.none,"LoadResource","x10Scheduler loading");if(l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",
!1)){var D=String.prototype;if(void 0===D.startsWithOriginal||void 0===D.endsWithOriginal)if(l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){const J=document.createElement("frame");document.body.appendChild(J);const L=J.contentWindow.String.prototype;document.body.removeChild(J);D.startsWithOriginal=L.startsWith;D.endsWithOriginal=L.endsWith}else D.startsWithOriginal=function(J,L=0){return this.lastIndexOf(J,L)===L},D.endsWithOriginal=function(J){return-1!==
this.indexOf(J,this.length-J.length)};D.startsWith=D.startsWithOriginal;D.endsWith=D.endsWithOriginal}l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&r.iKb();l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",!1)&&v.iKb();l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",!1)&&B.iKb();if(l.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&f.a.Jw)return D=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),
this.$.da.Ga(413,D),x.setResult(D),this.T5b=x.task;this.$.da.$a(266,()=>{this.$.da.$a(283,J=>{const L=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();J=y.b(n.Task.Ta(J.ln));Promise.all([excelOnlineCalc.x10.ensureGroupAttached(J,0),t.a.Epb(this.$)?excelOnlineCalc.x10.ensureGroupAttached(J,2):0]).then(T=>T.some(O=>0<O)).then(T=>{this.$.da.Ga(413,L);x.setResult(L);l.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&this.$.da.$a(491,O=>{O.dX.anyPluginInitialized=T})})})});
return this.T5b=x.task}static ka(x){x.da.Ga(414,new A(x))}}Object(u.a)(A,"PluginSchedulerFactory",h.a,[]);a.d(E,"a",function(){return z});const z=()=>{c.a.Fa(x=>{A.ka(x)})}},1278:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(695),f=a(50),d=a(37);class h extends b.a{constructor(l){super();this.$=l;this.Fb()}static ka(l){l.da.Ga(521,new h(l))}create(){const l=()=>excelOnlineCalc.FormulaAuthoringHelperSingletonGlobal.instance();d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,266,265,0),
()=>{this.ob(Object(e.a)(this.$.da,520,l))},this.$.la,3)}}Object(u.a)(h,"FormulaAuthoringHelperFactory",b.a,[]);a.d(E,"a",function(){return m});const m=()=>{c.a.Fa(l=>{h.ka(l)})}},1440:function(u,E,a){a.r(E);var c=a(1078),b=a(0),e=a(692),f=a(15),d=a(178),h=a(60);const m=(Cb,Rb,uc,nb,Fb,Jc)=>{if(Rb){const Fc=Cb.textBox;Cb.eb||Cb.startEdit(Rb,!0);Cb.Drd=!0;Cb.text=uc;Fc.caretPosition=Fb;Fb<Jc&&(nb&&Cb.JBa(),Fc.selectRange(0,Jc+1),Fc.selectRange(Fb,Jc))}};var l=a(76);class w{constructor(Cb,Rb){this.sharedSheetRange=
null;this.type=0;this.sharedSheetRange=Cb;this.type=Rb}m5a(){return this.sharedSheetRange}}Object(b.a)(w,"MacroRecorderAutoSumPayload",null,[137]);var n=a(42),y=a(371),t=a(188),r=a(50),v=a(37),B=a(154),A=a(345),z=a(29),x=a(1),D=a(183),J=a(281),L=a(21),T=a(124),O=a(563),G=a(55);class C extends d.a{constructor(Cb){super();this.rKi=Rb=>{const uc=L.h(this.$);if(Rb=Rb.Result){let nb=n.D(Rb.NewSelection),Fb=n.D(Rb.NewActiveCell);if(nb&&Fb)if(!Rb.Committed&&Rb.AutoSumFormula){const Jc=uc.Sb(Fb);Jc&&(uc.ha.updateSelection(nb,
Fb,60),nb=Fb=n.D(Rb.MarkedArea),uc.eK=2,m(uc.fc,Jc,Rb.AutoSumFormula,!!nb,Rb.FormulaMarkStart,Rb.FormulaMarkEnd),nb&&Fb&&uc.ha.updateSelection(nb,Fb,0),uc.fc.Drd=!1,v.TaskExtensions.Aa(r.GetServiceTaskFactory.create(this.$.da,153,this.la,0),Fc=>{Fc.result.JJa(null)},this.la,3))}else uc.ha.updateSelection(nb,Fb,60)}};this.$=Cb}nc(){return!1}executeCommand(Cb,Rb,uc){Cb=Rb.command;switch(Cb){case 1220954656:case 505713221:Rb=this.nMe(0,Rb);break;case -1537138325:Rb=this.nMe(parseInt(uc[l.a.Jc].toString(),
10),Rb);break;default:Rb=D.a(Cb)}return Rb}wc(Cb,Rb){if(Cb=1===Cb)switch(Rb.command){case 1220954656:case 505713221:case -1537138325:break;default:Cb=!1}return Cb}Kc(){return!1}nMe(Cb,Rb){const uc=L.h(this.$);uc.Hf.rH(!1);if(!L.h(this.$).ha.ra.Og)return Rb=L.h(this.$).ha.ra.YF,f.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${Cb} due to discontinuous selection. Number of selected ranges is ${Rb}`),this.Uza(),G.Task.Ta(!1);const nb=uc.AF();if(!nb)return null;
const Fb=n.v(uc.ha.ra.$c,this.$),Jc=n.o(uc.ha.ra.activeCell,this.$),Fc=n.o(nb,this.$),zb=this.$.pa.ya.Wb(),hb=()=>new w(Fb,Cb);return this.$.Yp(uc.ha.ra.selectedRanges,!0)?y.a(this.$.userOperationManager,(Pb,ud,Ub)=>{var Ac=this.$.pa.ya;Pb=J.b(Pb,this.rKi);const Ic=Ac.Na(9,zb);Ic.selectedRange=Fb;Ic.activeCell=Jc;Ic.autoSumType=Cb;Ic.topLeftCell=Fc;return h.g(Ac,"AutoSum",Ic,Pb,ud,Ub,Cb,0)},Pb=>new t.a(502,0,Pb,64,hb),Rb):G.Task.Ta(!1)}Uza(){O.a(T.a.discontinuousSelectionBlocking,["OtherICE"],!0,
!0,!1,!1,null);var Cb=z.a.Zc(1,1,751,2186,0,371863010,"DiscontinuousSelectionBlocking");x.EwaSettings.Iz()?new A.a(this.$,Cb):(Cb=new B.ErrorDialog(this.$,Cb),Cb.initialize(),Cb.vg())}}Object(b.a)(C,"AutoSumCommandHandler",d.a,[223]);class H extends e.a{constructor(Cb){super(Cb)}ld(){this.Yc([new C(this.$)])}static ka(Cb){e.a.Nd(96,new H(Cb))}}Object(b.a)(H,"AutoSumCommandHandlerFactory",e.a,[]);var I=a(9),M=a(170),Q=a(263),U=a(38),N=a(322),W=a(1079),X=a(282),sa=a(67);class da extends U.a{constructor(Cb,
Rb,uc){super();this.ALi=(nb,Fb)=>{if(!X.a(nb)&&Fb){const Jc=!!nb&&!!nb.RequestTelemetryData;L.h(this.$).ji.Vla(Fb.toString(),nb.StateId,Jc?nb.RequestTelemetryData.EcsOperationDuration:0,Jc?nb.RequestTelemetryData.EcsRequestDuration:0,Jc?nb.RequestTelemetryData.WfeRequestDuration:0)}};this.$=Cb;this.tableManager=Rb;this.Ag=uc}zJg(Cb){this.addHandler("ekcvc",Cb)}Sej(Cb){this.removeHandler("ekcvc",Cb)}nc(){return!1}executeCommand(Cb,Rb){Cb=Rb.command;switch(Cb){case -730106152:Rb=this.Tjd(Rb,3);break;
case -1228228458:Rb=this.Tjd(Rb,4);break;case -848953656:case 2045211913:if(this.Qoi()){Rb=G.Task.Ta(!0);break}Rb=this.Tjd(Rb,1);break;default:Rb=D.a(Cb)}return Rb}wc(Cb,Rb){if(Cb=1===Cb)switch(Rb.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:Cb=!1}return Cb}Kc(){return!1}Tjd(Cb,Rb){const uc=L.h(this.$),nb=uc.ha.ra.selectedRanges,Fb=Cb.command,Jc=M.a.create().toString();if(!this.$.Yp(nb,!0)&&-730106152!==Fb)return G.Task.Ta(!0);const Fc=n.r(nb,this.$);this.NEj(Fb,
uc,nb,Jc);x.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.u7i();const zb=this.$.pa.ya.Wb({uca:!0,Dba:1}),hb=()=>new W.a(Rb,Fc);return y.a(this.$.userOperationManager,(Pb,ud,Ub)=>{this.$.My();return h.d(this.$.pa.ya,Rb,Fc,!1,J.b(Pb,this.ALi),ud,Ub,Jc,zb)},Pb=>new t.a(508,0,Pb,67,hb),Cb)}NEj(Cb,Rb,uc,nb){if(-848953656!==Cb&&2045211913!==Cb&&-730106152!==Cb&&-1228228458!==Cb)f.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${Cb}.`);
else if(!Q.a.any(uc,Jc=>0<Rb.getRangeInformation(Jc).length)){var Fb=Q.a.any(uc,Jc=>this.tableManager.Qsd(Jc));if(-730106152!==Cb&&-1228228458!==Cb||!Fb)this.OIj(Rb,Cb,nb,uc),-730106152!==Cb&&-1228228458!==Cb||this.Ag.nea(Rb,-730106152,{}),-1228228458!==Cb&&2045211913!==Cb&&-848953656!==Cb||this.Ag.F2g(uc,nb),Rb.ji.uS(nb,sa.BasicTelemetryCalculator.$Q)}}OIj(Cb,Rb,uc,nb){let Fb="";switch(Rb){case -1228228458:Fb="ClearAll";break;case 2045211913:case -848953656:Fb="ClearContent";break;case -730106152:Fb=
"ClearFormat";break;default:f.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${Rb}.`)}Rb=nb.length;nb=n.b(nb);Cb.ji.X7(15,uc,Fb+(", ranges to clear: "+Rb+", cells to clear: "+nb))}u7i(){this.raiseEvent("ekcvc",new N.a)}Qoi(){if(L.h(this.$).Dz){const Cb=this.$.da.za(296);return!!Cb&&Cb.JU.wB}return!1}}Object(b.a)(da,"ClearCommandHandler",U.a,[223,890]);class S extends e.a{constructor(Cb){super(Cb)}ld(){const Cb=r.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.Ya),Rb=r.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Ya);v.TaskExtensions.Aa(v.TaskExtensions.Ed([Cb,Rb],this.la),()=>{const uc=new da(this.$,Cb.result,Rb.result);this.Yc([uc]);this.$.da.Ga(313,uc)},this.la,3)}static ka(Cb){e.a.Nd(101,new S(Cb))}}Object(b.a)(S,"ClearCommandHandlerFactory",e.a,[]);var oa=a(1227),K=a(1080),ea=a(1138),ya=a(1082),ha=a(1083),La=a(1151),Ia=a(87),ra=a(222),pa=a(4),ba=a(105),fa=a(45),Ka=a(11),aa=a(84),ja=a(146);class Va{}Va.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(b.a)(Va,"FileUploadDialogHTML",null,[]);var bb=a(152),wa=a(25);class ka extends ja.a{constructor(Cb){super(!1,!1,ka.Uu);this.oxd=!1;this.Tsf=!0;this.bsf=0;this.Rb=1;this.oc(1,CommonUIStrings.l_Send);this.oc(0,CommonUIStrings.l_NoThanks);this.qg=Va.HTML;this.Vrf=Cb;this.Fe=ka.ZXg}vj(Cb,Rb,uc,nb=!1,Fb=!0){this.oxd=nb;this.XDj(Rb);this.bsf=Cb;Fb&&pa.AFrameworkApplication.lG(Cb)}XDj(Cb){if(ka.Uu)this.EFj(Cb);else{var Rb={};Rb[ka.VXg]=Cb;Rb[ka.aYg]=CommonUIStrings.l_SendFileErrorReportMessage;Rb[ka.bYg]=
CommonUIStrings.l_SendFileErrorReportTextCaption;Rb[ka.P_c]="";Rb[ka.YXg]=CommonUIStrings.l_UserReportLinkText;Rb[ka.u2b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(aa.a)(this,this.Zvi,"legacyDialogHandler"),Rb);this.eX(ka.gYg)}}EFj(Cb){Cb={["id"]:this.Fe,["bodyControls"]:{["reportErrorCheckboxProps"]:this.oxd?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.Tsf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:pa.AFrameworkApplication.bna,["target"]:"_blank"}}},["errorMessage"]:Cb,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(aa.a)(this,this.RId,"reactDialogHandler"),Cb)}Q$a(){if(!ka.Uu){var Cb=document.getElementById(ka.dYg);Cb&&(Cb.className=ka.cYg,Cb.appendChild(bb.createClusteredImage(32,32,ka.$Xg,null,!0,CommonUIStrings.l_DialogError)));
if(Cb=document.getElementById(ka.eYg))Cb.innerText=CommonUIStrings.l_PrivacyStatement,Cb.href=pa.AFrameworkApplication.bna,fa.a.addHandler(Cb,"click",Object(aa.a)(this,this.aUi,"onPrivacyClickHandler"));this.Tsf||(Cb=document.getElementById(ka.P_c))&&Cb.parentNode&&Cb.parentNode.removeChild(Cb);this.oxd||(Cb=document.getElementById(ka.XXg))&&Cb.parentNode&&Cb.parentNode.removeChild(Cb)}}VI(){ka.Uu||(super.VI(),document.getElementById(this.mi("WACDialogPanel")).style.width=String.format("{0}px",400))}Zvi(Cb,
Rb){const uc=Rb[ka.P_c]||"";let nb=!0;void 0!==Rb[ka.u2b]&&null!==Rb[ka.u2b]&&(nb=Rb[ka.u2b]);this.vw(Cb,uc,nb)}RId(Cb,Rb){this.vw(Cb,Rb.text||"",Rb.reportErrorChecked)}vw(Cb,Rb,uc){this.Vrf&&(uc&&f.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.bsf),this.Vrf(Cb,Rb,uc))}aUi(Cb){pa.AFrameworkApplication.ub.ae(wa.a.kIb,2,Cb)}get RY(){return!1}static get Uu(){return pa.AFrameworkApplication.sa.Pa.Hv&&pa.AFrameworkApplication.sa.Pa.spi}}ka.VXg="WACDialogErrorMessage";ka.aYg=
"WACDialogErrorReportMessage";ka.bYg="WACDialogErrorTextPrompt";ka.P_c="WACDialogInput";ka.eYg="WACDialogPrivacyText";ka.dYg="WACDialogIconPanel";ka.$Xg="CancelRequest_32x32x32";ka.cYg="WACDialogIcon";ka.gYg="WACDialogTextPanel";ka.u2b="WACDialogSendFileCheckbox";ka.XXg="WACDialogSendFileCheckboxContainer";ka.YXg="WACDialogSendFileCheckboxText";ka.ZXg="FileUploadErrorDialog";Object(b.a)(ka,"FileUploadErrorDialog",ja.a,[]);class ta extends U.a{constructor(Cb){super();this.aNf=0;this.AH=null;this.Kdj=
Rb=>{this.afj(Rb)};this.W3g=(Rb,uc)=>{if(1===Rb&&this.AH.FileCollectionErrorStateId){Rb=this.$.pa.ya;var nb=this.AH.MessageId,Fb=this.AH.OriginalEcsServerId,Jc=this.AH.FileCollectionErrorStateId;const Fc=Rb.Na(0);Fc.errorMessageId=nb;Fc.ecsServerId=Fb;Fc.fileCollectionErrorStateId=Jc;Fc.userComment=uc;Rb.e0c("CollectFile",Fc,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=Cb}JJg(Cb){this.addHandler("fileCollectionComplete",Cb)}afj(Cb){this.removeHandler("fileCollectionComplete",
Cb)}V3g(Cb,Rb,uc){this.aNf=Rb;this.AH=Cb;this.JJg(uc);pa.AFrameworkApplication.bna=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;Cb=new ka(this.W3g);pa.AFrameworkApplication.ub.Nb(wa.a.kIb,ba.a.frame,ta.c5i);Cb.vj(0,"",null,!1,!1)}static c5i(Cb,Rb,uc,nb,Fb){fa.a.ou(Fb);pa.AFrameworkApplication.bna&&Ka.HelperMethods.lf(pa.AFrameworkApplication.bna,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(b.a)(ta,"FileCollectionOperation",U.a,[855,2]);class qa extends ra.a{constructor(Cb){super();
this.PTb=null;this.$=Cb;this.Fb()}get zDh(){return this.PTb||(this.PTb=new ta(this.$))}create(){v.TaskExtensions.Aa(r.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),()=>{this.ob(this.zDh)},this.la,3)}dispose(){Ia.a.Ia(this.PTb);this.PTb=null;super.dispose()}static ka(Cb){Cb.da.Ga(125,new qa(Cb))}}Object(b.a)(qa,"FileCollectionCommandHandlerFactory",ra.a,[]);var rb=a(1154),Za=a(1086),gb=a(1251),mb=a(7),Ga=a(643);class ib{}Object(b.a)(ib,"FreezePanesCommandParameters",null,[]);var cc=a(8),
ic=a(182),xb=a(24),Vb=a(386),wb=a(28),cb=a(268),lb=a(270),Y=a(117);const Oa=(Cb,Rb,uc,nb,Fb,Jc,Fc=null)=>{Fc=Cb.Na(9,Fc);Fc.freezeSettings=Rb;return h.g(Cb,"FreezeOrUnfreezePanes",Fc,uc,nb,Fb,Jc,0)};class Wa{constructor(Cb){this.freezeOptions=null;this.freezeOptions=Cb}getSheetName(){return this.freezeOptions.SheetName}}Object(b.a)(Wa,"MacroRecorderSheetPaneFrozenPayload",null,[137]);var Ca=a(44);class Ra{constructor(Cb,Rb){this.Lac=this.VHd=null;this.JBf=()=>{x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.ovc();if(this.Lac){const uc=cb.a(wb.a.Qa.ve,this.Lac);f.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${uc}`);this.Lac=null}this.sJf()};this.$=Cb;this.gridView=L.h(Cb);this.AD=Rb.Ksb(this.$.domElement,500,null,null);this.ILa=this.HLa=-1}nc(Cb,Rb){let uc=!1;switch(Rb){case 1844679312:uc=1!==Cb&&!this.gridView.ib.U4}return uc}executeCommand(Cb,Rb){Cb=this.gridView.ib;const uc=this.gridView.qjd();
pa.AFrameworkApplication.sa.Pa.Lw&&this.$.x_&&(1844679312===Rb.command||340334732===Rb.command||-806625837===Rb.command)&&Ga.ShyRibbon.MJ(1,2);switch(Rb.command){case 1844679312:return this.setFreezePanes(Rb,uc,Cb.tj);case 340334732:return Cb.eac?G.Task.Ta(!1):this.Quj(Rb,uc);case -806625837:return Cb.iCa?G.Task.Ta(!1):this.Ruj(Rb,uc)}return G.Task.Ta(!1)}wc(Cb,Rb){Cb=!1;switch(Rb.command){case 1844679312:case 340334732:case -806625837:case 1745254833:Cb=!0}return Cb}Kc(){return!1}setFreezePanes(Cb,
Rb,uc){if(uc)return this.Uwc(Cb,!1,0,0,0,0,Rb,null);var nb=this.gridView.ha.ra;uc=nb.activeCell.clone();nb=nb.activeRange;nb.hf&&(f.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${uc.top}) and firstUnfreezeCell.Bottom (${uc.bottom}) to equal topLeftRange.Top (${Rb.top})`),uc.top=uc.bottom=Rb.top);nb.isRow&&(f.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${uc.left}) and firstUnfreezeCell.Right (${uc.right}) to equal topLeftRange.Left (${Rb.left})`),
uc.left=uc.right=Rb.left);uc.top===Rb.top&&uc.left===Rb.left&&(uc=xb.Range.Qc(uc.top+1,uc.left));nb=uc.top-1;const Fb=uc.left-1,Jc=nb-(Rb.top-1),Fc=Fb-(Rb.left-1);return this.P_j(uc,Jc,Fc)?this.Uwc(Cb,!0,nb,Fb,Jc,Fc,Rb,uc):(this.$.af(),this.sJf(),G.Task.Ta(!0))}Quj(Cb,Rb){return this.Uwc(Cb,!0,0,Rb.left,0,1,Rb,null)}Ruj(Cb,Rb){return this.Uwc(Cb,!0,Rb.top,0,1,0,Rb,null)}P_j(Cb,Rb,uc){const nb=this.gridView.fg(Cb),Fb=this.gridView.view.visibleArea;return!nb||Fb.topLeft.y>nb.bottomRight.y||Fb.topLeft.x>
nb.bottomRight.x||Fb.bottomRight.y<nb.bottomRight.y||Fb.bottomRight.x<nb.bottomRight.x?(f.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${Cb}, rangeViewportArea=${nb?nb.toString():"null"}, visibleArea=${Fb.toString()}`),Cb=z.a.Zc(1,0,26,1486,0,2105967339,"FreezePaneSelectionNotInViewErr"),x.EwaSettings.Iz()?new A.a(this.$,Cb):(Cb=new B.ErrorDialog(this.$,Cb),Cb.initialize(),Cb.vg()),!1):0>=
Rb&&0>=uc?(f.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),Cb=L.h(this.$).rtl?1488:1487,Rb=L.h(this.$).rtl?-2131054257:-1953454131,Cb=z.a.Zc(1,0,26,Cb,0,Rb,"FreezePaneA1SelectedErr"),x.EwaSettings.Iz()?new A.a(this.$,Cb):(Cb=new B.ErrorDialog(this.$,Cb),Cb.initialize(),Cb.vg()),!1):!0}Uwc(Cb,Rb,uc,nb,Fb,Jc,Fc,zb){this.VHd=Ca.a(this.$).Z9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.KT(this.JBf);this.AD.KTa();
this.gridView.rJj(Rb?"":"UnsetFreezePane");this.kxj(Cb,Rb,this.gridView.ib);const hb=Object(mb.a)(new ib,{SheetName:this.$.oa.name,Freeze:Rb,FrozenRows:Fb,FrozenColumns:Jc,FirstRow:uc,FirstColumn:nb});f.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${Rb}, FrozenRows=${Fb}, FrozenColumns=${Jc}, FirstRow=${uc}, FirstColumn=${nb} `);const Pb=()=>new Wa(hb);this.Lac=wb.a.Qa.ve;return y.a(this.$.userOperationManager,(ud,Ub,Ac)=>{if(x.EwaSettings.ma(60)){var Ic=
window.performance;Ic.clearMarks();Ic.mark("FreezePanes request sent")}(Ic=this.gridView.jt)?(Ic=this.prh(hb,Ic,Fc,zb),this.zQj(Ic)):this.$.My();return Oa(this.$.pa.ya,hb,ud,Ub,Ac,Rb)},ud=>new t.a(151,0,ud,void 0,Pb),Cb)}prh(Cb,Rb,uc,nb){f.ULS.shipAssertTag(537159580,1,!!Rb,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!Cb.Freeze)return null;const Fb=lb.a();Fb.State=1;Fb.IsEstimated=!0;let Jc=!1,Fc=!1;const zb=Rb.dV(xb.Range.Qc(uc.top,uc.left));
let hb=Cb.FrozenRows;var Pb=Cb.FrozenColumns;1!==Cb.FrozenRows||Cb.FrozenColumns?Cb.FrozenRows||1!==Cb.FrozenColumns?(Pb=Rb.dV(xb.Range.Qc(Cb.FirstRow+1,Cb.FirstColumn+1)),Rb=Rb.dV(xb.Range.Qc(uc.top,uc.left)),Fb.Width=Pb.yj-zb.yj,Fb.Height=Pb.Nj-zb.Nj,0<Cb.FrozenRows&&(Fb.AbsoluteTop=Pb.Nj,Fc=!0),0<Cb.FrozenColumns&&(Fb.AbsoluteLeft=Pb.yj,Jc=!0),hb=Pb.uL-Rb.uL,Pb=Pb.QJ-Rb.QJ):(Fb.Width=Rb.Hhd(ic.a.Qc(uc.top,uc.left)),nb=xb.Range.Qc(uc.top,uc.left+1),Fb.AbsoluteLeft=zb.yj+Fb.Width,Jc=!0):(Fb.Height=
Rb.Ghd(ic.a.Qc(uc.top,uc.left)),nb=xb.Range.Qc(uc.top+1,uc.left),Fb.AbsoluteTop=zb.Nj+Fb.Height,Fc=!0);Fc&&(Fb.FirstFrozenRow=uc.top,Fb.FirstScrollableRow=nb.top);Jc&&(Fb.FirstFrozenColumn=uc.left,Fb.FirstScrollableColumn=nb.left);Fb.VisibleRows=hb;Fb.VisibleColumns=Pb;return Fb}zQj(Cb){G.Task.delay(this.$.va.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.oa&&this.$.ea&&(this.$.ea.xX(cc.a.qe,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Vb.b(this.$.oa,Cb,-1,void 0,!0))})}kxj(Cb,
Rb,uc){if(!x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(Cb.command){case 1844679312:if(Rb||-1===this.HLa&&-1===this.ILa)this.HLa=uc.Fx-uc.width+this.gridView.scrollLeft,this.ILa=uc.Gx-uc.height+this.gridView.scrollTop;break;case 340334732:if(Rb||-1===this.HLa)this.HLa=uc.Fx-uc.width+this.gridView.scrollLeft;break;case -806625837:if(Rb||-1===this.ILa)this.ILa=uc.Gx-uc.height+this.gridView.scrollTop}}ovc(){const Cb=this.gridView.ib;0<Cb.width?
this.gridView.scrollLeft=Y.a.d2b(this.gridView.domElement,L.h(this.$).rtl,0):-1!==this.HLa&&(this.gridView.scrollLeft=this.HLa,this.HLa=-1);0<Cb.height?this.gridView.scrollTop=0:-1!==this.ILa&&(this.gridView.scrollTop=this.ILa,this.ILa=-1)}sJf(){this.AD.QTa();Ia.a.Ia(this.VHd);this.VHd=null;this.gridView.uO(this.JBf)}}Object(b.a)(Ra,"FreezePanesCommandHandler",null,[223]);class la extends e.a{constructor(Cb){super(Cb)}ld(){v.TaskExtensions.Aa(r.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya),Cb=>
{this.Yc([new Ra(this.$,Cb.result)])},this.$.la)}static ka(Cb){Cb.da.Ga(116,new la(Cb))}}Object(b.a)(la,"FreezePanesCommandHandlerFactory",e.a,[]);var ua=a(1167),xa=a(27),fb=a(561),Jb=a(558),Ob=a(30),eb=a(994),Ma=a(1087);a(313);var va=a(13),Pa=a(33);class Ha{constructor(Cb,Rb){this.$=Cb;this.fontServiceManager=Rb;this.menuId=this.E_c=this.TO=this.pva=null;this.Scd=0;this.XEi="+mn-lt";this.cCi="+mj-lt";this.BOi=()=>{this.q2f()};this.YTi=uc=>{this.Rjf=!0;this.$.ky(nb=>{nb.qQa("FontName_New")});f.ULS.sendTraceTag(520710160,
1,15,`PreviewFont Status is ${uc}`)};this.bji=!!String.fromCodePoint&&!xa.a.Fv&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Rjf=!1;this.Vl=x.EwaSettings.Vl();this.gridView=L.h(this.$);(this.Gl=Pa.a.Gl())&&this.fontServiceManager&&(this.fontServiceManager.Mhc?this.q2f():this.fontServiceManager.$qe(this.BOi))}get themesManager(){this.Bx||(this.Bx=this.$.da.za(422));return this.Bx}q2f(){this.TO=this.fontServiceManager.OAc;this.pva=this.fontServiceManager.mHh;
this.Scd=2}get OAc(){return this.TO}qZe(Cb,Rb,uc,nb=null){const Fb=Object.assign(new fb.a,{Id:"FontDropdownMenu"});Fb.MenuSectionList=[];if(this.Vl&&this.themesManager){this.themesManager.Hbd(nb);if(null==this.themesManager.zG||this.themesManager.Wsd)return Fb;nb=Object.assign(new Jb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:va.a.instance.ga(1332),ControlList:this.j2h(Cb,Rb,uc)});Fb.MenuSectionList.push(nb)}nb=Object.assign(new Jb.a,{ControlsId:"FontsMenuSectionControl"});if(this.Vl||this.Gl)nb.Title=
va.a.instance.ga(1333);nb.ControlList=this.aTh(Cb,Rb,uc);Fb.MenuSectionList.push(nb);return Fb}j2h(Cb,Rb,uc){var nb;const Fb=[];var Jc=this.gridView.ha.Sa.$b;Jc=5===(null===(nb=null===Jc||void 0===Jc?void 0:Jc.floatingObject)||void 0===nb?void 0:nb.type);let Fc,zb;this.themesManager.zG?(Fc=this.themesManager.zG.Xyd,zb=this.themesManager.zG.Ixd):f.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");null!=zb?(nb=this.DIe(zb,1,Jc,Cb,Rb,uc),Fb.push(nb)):f.ULS.sendTraceTag(520710164,1,15,"Major Theme Font is Null");
null!=Fc?(Cb=this.DIe(Fc,2,Jc,Cb,Rb,uc),Fb.push(Cb)):f.ULS.sendTraceTag(520710163,1,15,"Minor Theme Font is Null");return Fb}DIe(Cb,Rb,uc,nb,Fb,Jc){var Fc=2===Rb?this.XEi:this.cCi;uc=uc?Fc:Ob.a.df(Cb);Fc=Ob.a.df(Ka.HelperMethods.ydc(Cb,Rb));Cb=Ob.a.df(Cb);return Object.assign(new eb.a,{MenuItemId:2===Rb?Ma.b:Ma.a,CommandValueId:uc,LabelText:Fc,LabelCss:String.format("font-size:12pt;font-family:{0};",Cb),Styles:Ha.kxb(Cb),AriaLabel:Fc,Alt:Fc,Command:nb.toString(),CommandPreviewId:Fb.toString(),CommandRevertId:Jc.toString()})}aTh(Cb,
Rb,uc){if(this.E_c)return this.E_c.c7c;let nb;const Fb=Ka.HelperMethods.t6(()=>{const Jc=this.bji&&!this.Rjf;let Fc=!1;this.pva||(this.Kdf(),Fc=!0);nb=this.eHe(Cb,Rb,uc,this.pva,Jc,Fc);nb.Oyc&&!Fc&&(f.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.Kdf(),nb=this.eHe(Cb,Rb,uc,this.pva,Jc,nb.Oyc));this.Gl&&!nb.Oyc&&(this.E_c=nb);Jc&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.YTi)});10<Fb&&f.ULS.sendTraceTag(512340117,
1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${Fb}`);return nb.c7c}eHe(Cb,Rb,uc,nb,Fb,Jc){const Fc=[];let zb;const hb=this.Gl&&!Jc;zb=hb?"msofpNew":"msofp";for(let Ic in nb){var Pb=Ic,ud=nb[Ic],Ub=Ob.a.df(Pb),Ac=void 0;if(hb)if(Ac=this.TO?this.TO[Pb]:null)Ac=Ob.a.df(Ac);else return f.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Pb}`),{Oyc:!0,
c7c:[]};else Ac=Ob.a.df(Ka.HelperMethods.TO[Pb]);Pb=Ob.a.df(Pb);Fb||(ud=0);Ub=Object.assign(new eb.a,{MenuItemId:Ub,CommandValueId:Ub,LabelText:Fb&&0<ud?Ob.a.df(String.fromCodePoint(ud)):Ac,LabelCss:String.format("font-size:12pt;font-family:{0};",Fb&&0<ud?zb:Pb),Styles:Ha.kxb(Fb&&0<ud?zb:Pb),AriaLabel:Ac,Alt:Ac,Command:Cb.toString(),CommandPreviewId:Rb.toString(),CommandRevertId:uc.toString()});Fc.push(Ub)}return{Oyc:Jc,c7c:Fc}}Kvj(Cb){this.menuId=Cb}Kli(){return 2!==this.Scd&&3!==this.Scd?!1:!0}Kdf(){this.pva=
{["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,
["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,
["Yu Mincho"]:983474}}static kxb(Cb){const Rb={};Rb["font-family"]=Cb;Rb["font-size"]="12pt";Cb={};Cb.optionText=Rb;return Cb}}Object(b.a)(Ha,"FontDropdownHelper",null,[854]);var tb=a(695);class Ya extends ra.a{constructor(Cb){super();this.$=Cb;this.Fb()}create(){x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.$a(504,Cb=>{this.ob(Object(tb.a)(this.$.da,502,()=>new Ha(this.$,Cb)))}):this.ob(Object(tb.a)(this.$.da,502,()=>new Ha(this.$,null)))}static ka(Cb){Cb.da.Ga(503,
new Ya(Cb))}}Object(b.a)(Ya,"FontDropdownHelperFactory",ra.a,[]);var V=a(1252),za=a(1089),yb=a(1228),jc=a(1190),Cc=a(1137),Sa=a(1163),na=a(1277),jb=a(1229),Ib=a(1215);class dc{constructor(Cb){this.$=Cb}nc(){return!1}executeCommand(Cb,Rb){Cb=!1;Rb=Rb.command;switch(Rb){case 1910465940:Cb=!0}return Cb?G.Task.Ta(!0):D.a(Rb)}wc(Cb,Rb){switch(Rb.command){case 1910465940:return!0;default:return!1}}Kc(){return!1}}Object(b.a)(dc,"NameManagerCommandHandler",null,[223]);class ob extends e.a{constructor(Cb){super(Cb)}ld(){this.Yc([new dc(this.$)])}static ka(Cb){e.a.Nd(493,
new ob(Cb))}}Object(b.a)(ob,"NameManagerCommandHandlerFactory",e.a,[]);var Fa=a(1173),Ab=a(1179),$b=a(1278);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");
Type.registerNamespace("_Ewa");Object(c.a)();I.a.Fa(H.ka);I.a.Fa(S.ka);Object(oa.a)();Object(K.a)();Object(ea.a)();Object(ya.a)();Object(ha.a)();Object(La.a)();I.a.Fa(qa.ka);Object(rb.a)();Object(Za.a)();Object(gb.a)();(()=>{I.a.Fa(Cb=>{la.ka(Cb)})})();Object(ua.a)();Object(V.a)();Object(za.a)();Object(yb.a)();Object(jc.a)();Object(Cc.a)();Object(Sa.a)();Object(na.a)();Object(jb.a)();Object(Ab.a)();Object(Ib.a)();Object(Fa.a)();Object($b.a)();(()=>{I.a.Fa(Cb=>{ob.ka(Cb)})})();(()=>{I.a.Fa(Cb=>{Ya.ka(Cb)})})()},
716:function(u,E,a){a.d(E,"a",function(){return M});u=a(0);var c=a(7),b=a(15),e=a(561),f=a(87),d=a(558),h=a(375),m=a(590),l=a(566),w=a(111),n=a(263),y=a(82),t=a(416),r=a(1399);E=a(78);var v=a(19),B=a(5),A=a(773),z=a(76),x=a(42),D=a(59),J=a(142),L=a(113),T=a(1),O=a(11),G=a(22),C=a(13),H=a(21),I=a(34);class M extends E.a{constructor(Q,U,N,W,X,sa,da,S,oa,K,ea,ya){super();this.wmc=!1;this.DHc=this.sKc=this.contextMenuController=null;this.cqd=!1;this.Mvc=this.Htb=null;this.gD=()=>{this.contextMenuController?
this.contextMenuController.gD():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.Tfg()};this.jb=Q;this.juf=X;this.fmb=K;this.DLf=sa;this.populateOnlyOnce=da;this.Y8h=ea;this.$Rf(ya)}get contextMenuRoot(){return this.Mvc}get $(){return this.jb}get Va(){return this.fmb}get menuId(){return this.$.Eb+this.juf}get Mvb(){this.sKc||(this.sKc=L.a(this.$));return this.sKc}get Vqb(){this.DHc||(this.DHc=
H.h(this.$).Vb);return this.DHc}nc(Q,U){Q=!0;switch(U){case 1651433993:case 1675506831:case 966232027:Q=this.Td(4096)||this.Td(2048);break;case 2045563128:Q=this.Td(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:Q=this.Td(8192)}return!Q}Kc(Q,U,N){N.IsShadowMenuOpen||A.i(this.$,A.d);Q=!1;U===this.Zw&&(N.IsShadowMenuOpen||A.i(this.$,A.a),U=Object(c.a)(new e.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.cGd(U,N.IsShadowMenuOpen),N.MenuItems=U,
N.IsShadowMenuOpen||A.i(this.$,A.c),Q=!0);Q&&this.wmc&&O.HelperMethods.e2b&&!N.IsShadowMenuOpen&&A.k(this.$);return Q}cGd(Q,U){(U=this.hZ(U))?(this.Wbf(U),Q.MenuSectionList.push(...U.JC().MenuSectionList),this.FHg(Q)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}hZ(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}Y0(Q,U,N,W,X){Q=Sys.UI.DomElement.getBounds(U);U=new Sys.UI.Point(Q.x,Q.y+Q.height);this.$.isChromeRtl&&(U.x+=Q.width);this.Qp(U,X)}Qp(Q,U,N=0){U&&(Q=I.a(this.$).cka(Q));U=!0;if(this.Y8h){let W;3===N?(W=this.$Ka(3))&&0<W.length?(U=!1,this.showFloatie(W,new Sys.UI.Bounds(Q.x,Q.y,0,0),N)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):2===N&&this.$.isEditMode&&
((W=this.$Ka(2))&&0<W.length?W[0]!==M.DXe?(U=!1,this.sUd(W,new Sys.UI.Bounds(Q.x,Q.y,0,0),N)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}U&&this.showContextMenu(new Sys.UI.Bounds(Q.x,Q.y,0,0),N)}$Ka(){return null}Bhd(Q,
U=null){let N="";3===Q?N="touch":2===Q&&(N="mouse");return{["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!D.a.zg&&D.a.zg.KK,["IsReactMLR"]:!!D.a.zg&&D.a.zg.IV,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:N,["FloatieGroups"]:JSON.stringify(U)}}showContextMenu(Q,U=0){const N=this.Bhd(U);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(N)}`);this.contextMenuController?this.OB!==B.a.SId&&this.OB!==B.a.TId||0===
U?this.contextMenuController.rUd(this.OB,Q,z.a.Db):this.contextMenuController.rUd(this.OB,Q,U):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(Q,U,N){const W=this.Bhd(N,Q);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(W)}`);this.contextMenuController?(this.hSf(),this.contextMenuController.ozc(Q,U,N)):(Q=JSON.stringify(Q),
b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${Q}.`))}sUd(Q,U,N){var W=this.Bhd(N,Q);W=JSON.stringify(W);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${W}`);this.contextMenuController?(this.hSf(),this.contextMenuController.qUd(Q,U,N,this.OB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}$Rf(Q){this.contextMenuController=
Q}dispose(){this.$&&this.$.Ja.mcb(this);this.jb=null;this.Tfg();this.Mvc&&(f.a.Ia(this.Mvc),this.Mvc=null);super.dispose()}FJh(Q){var U=this.$.da.za(204);U&&(U=U.mKh(this.juf))&&Q.tc.push(U)}Td(Q){return(new J.a(this.$.xa)).Td(Q)}Wbf(Q){for(const U of Q.tc)if(Object(t.a)(375,U)){Q=U;Q.title&&(Q.title=M.dg(Q.title));for(const N of Q.buttons)Object(t.a)(376,N)?(Q=N,Q.label=M.dg(Q.label),Q.mS(M.dg(Q.alt))):Object(t.a)(377,N)&&this.Wbf(N.menu)}}guf(Q,U=!1){const N=[];for(const W of Q)N.push(this.$C(W,
U));return N}$C(Q){const U=[];for(const N of Q.MenuItems)switch(N.Type){case 3:U.push(this.m$g(N));break;case 2:U.push(this.Xeh(N));break;case 1:U.push(this.Jah(N))}return Object(c.a)(new d.a,{ControlList:U,Title:Q.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}Wdd(Q,U){U=[this.Htb,Q.RibbonCommand.toString(),U?this.v2e(U):this.v2e(Q.Label),Q.Disabled?Q.Disabled.toString():"False"];let N=Q.CommandData;N=G.a.hashCode(N).toString();
U.push(N,Q.Identifier.toString());U=U.join("_");Q.IsChecked&&(U+="_Checked");return U}nKh(Q){const U=[this.Htb,G.a.hashCode(Q.Title).toString()];for(const N of Q.MenuItems)U.push(N.RibbonCommand.toString());return U.join("_")}pZe(Q){var U=Q.Label;U=G.a.hashCode(U).toString();U=[this.Htb,U];T.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&Q.Id&&U.push(G.a.hashCode(Q.Id).toString());U=U.join("_");Q.IsChecked&&(U+="_Checked");return U}m$g(Q){let U,
N,W;({label:N,pMa:W,Mr:U}=this.Yac(Q,!1));const X=this.Wdd(Q,N);return Object(c.a)(new h.a,{Command:Q.Disabled?(-251203935).toString():U.toString(),ExternalId:X,Id:X,Image16by16Class:W,LabelText:N||Q.Label,MenuItemId:Q.CommandData,CommandValueId:Q.CommandData})}Xeh(Q){let U,N,W;({label:N,pMa:W,Mr:U}=this.Yac(Q,Q.IsChecked));const X=this.Wdd(Q,N);return Object(c.a)(new m.a,{Command:Q.Disabled?(-251203935).toString():U.toString(),ExternalId:X,Id:X,Image16by16Class:W,LabelText:N||Q.Label,MenuItemId:Q.CommandData,
CommandValueId:Q.CommandData,IsChecked:Q.IsChecked})}Jah(Q){let U;var N;({label:U,pMa:N}=this.zZe(Q));const W=Object(c.a)(new e.a,{MenuSectionList:[],UpdateDynamically:!0});W.MenuSectionList.push(...this.guf(Q.SubMenu.Sections,!0));const X=this.pZe(Q);Q=U||Q.Label;return Object(c.a)(new l.a,{ExternalId:X,Id:X,LabelText:Q,PopulateOnlyOnce:!1,Menu:W,Image16by16Class:N,ImageIsVisible:!!N})}zZe(Q){let U,N;({label:Q,pMa:U,Mr:N}=this.Yac(Q,!0));return{label:Q,pMa:U,Mr:N}}Yac(Q,U){let N;switch(Q.Identifier){case 26:N=
912804500;U=v.a.MTe;Q=C.a.instance.ga(1942);break;case 3:N=-1902148570;U=U?v.a.zaa:null;Q=C.a.instance.ga(1902);break;case 4:N=-1902148570;U=U?v.a.zaa:null;Q=C.a.instance.ga(1903);break;case 5:N=-1902148570;U=U?v.a.zaa:null;Q=null;break;case 1:N=-1677817820;U=v.a.Q9b;Q=C.a.instance.ga(233);break;case 2:N=-1649376918;U=Q.IsChecked?v.a.Yua:null;Q=C.a.instance.ga(2116);break;case 23:N=1701016594;U=Q.IsChecked?v.a.Yua:null;Q=C.a.instance.ga(2116);break;case 6:N=-87741481;U=null;Q=C.a.instance.ga(2117);
break;case 7:N=1948650742;U=v.a.wSe;Q=C.a.instance.ga(1940);break;case 8:N=1933713114;U=v.a.vSe;Q=C.a.instance.ga(1941);break;case 14:N=504133448;U=v.a.RJa;Q=C.a.instance.ga(145);break;case 30:N=504133448;U=v.a.RJa;Q=C.a.instance.Ua(742);break;case 32:N=504133448;U=v.a.RJa;Q=C.a.instance.ga(149);break;case 34:N=504133448;U=v.a.RJa;Q=C.a.instance.ga(151);break;case 27:N=1701016594;U=U?v.a.T9b:v.a.RJa;Q=C.a.instance.ga(145);break;case 15:N=-798968736;U=v.a.SJa;Q=C.a.instance.ga(147);break;case 31:N=
-798968736;U=v.a.SJa;Q=C.a.instance.Ua(743);break;case 33:N=-798968736;U=v.a.SJa;Q=C.a.instance.ga(150);break;case 35:N=-798968736;U=v.a.SJa;Q=C.a.instance.ga(152);break;case 28:N=1701016594;U=U?v.a.U9b:v.a.SJa;Q=C.a.instance.ga(147);break;case 21:N=-2058042992;U=v.a.n3a;Q=null;break;case 29:N=1701016594;U=v.a.n3a;Q=null;break;case 9:N=1701016594;Q=U=null;break;case 11:N=-1494291901;Q=U=null;break;case 25:N=-1045020714;U=Q.IsChecked?v.a.Yua:null;Q=null;break;case 13:N=1701016594;U=Q.IsChecked?v.a.Yua:
null;Q=C.a.instance.ga(154);break;case 16:N=1701016594;U=v.a.I9b;Q=C.a.instance.ga(1078);break;case 17:N=1701016594;U=v.a.m3a;Q=null;break;case 18:N=1701016594;U=v.a.l3a;Q=null;break;case 19:N=1701016594;U=v.a.J9b;Q=C.a.instance.ga(1083);break;case 20:N=1701016594;U=v.a.$$c;Q=C.a.instance.ga(1084);break;case 24:N=1675506831;Q=U=null;break;case 22:N=Q.RibbonCommand;U=Q.IsChecked?v.a.zaa:null;Q=null;break;case 36:N=1461300262;U=null;Q=C.a.instance.ga(153);break;case 38:N=Q.RibbonCommand;U=v.a.pad;Q=
C.a.instance.ga(1813);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(Q)}`),N=1461300262,Q=U=null}return{label:Q,pMa:U,Mr:N}}v2e(Q){return G.a.hashCode(Q+O.HelperMethods.Bsj).toString()}FHg(Q){if(!this.$.ea.amIAlone){var U=this.$.da.za(25);if((void 0!==U&&null!==U||!T.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!w.a.isEmpty(U.JCa)&&(U=U.T3h(),!n.a.Dh(U))){var N=[];y.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").odh(U,
N);Q.MenuSectionList.push(...N)}}}hSf(){this.cqd||(this.Mvb&&this.Mvb.I_b(this.gD),this.Vqb&&this.Vqb.I_b(this.gD),this.cqd=!!this.Mvb||!!this.Vqb)}Tfg(){this.Mvb&&this.Mvb.suc(this.gD);this.Vqb&&this.Vqb.suc(this.gD);this.cqd=!1}static epd(Q,U){U=x.C(U);Q=H.h(Q).Ea.kLa(U);return!(null===Q||void 0===Q||!Q.Qk)}static cfd(Q,U,N){U=x.C(U);var W=H.h(Q).Ea.kLa(U);U=H.h(Q).getCellBounds(W);const X=W.pSg;W=W.oSg;let sa=U.x+X.x;U=U.y+X.y;N&&T.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&
(H.h(Q).rtl||(sa+=W),U-=W);return new Sys.UI.Point(sa,U)}static JBh(Q){try{Object(r.a)(Q.CommandValueId)}catch(U){}}static dg(Q){const U=M.vua.parseFromString(Q,"text/html");return U?U.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),Q)}}M.vua=new DOMParser;M.DXe="Unsupported";Object(u.a)(M,"ContextMenuBase",E.a,[223,378,2])},773:function(u,E,a){a.d(E,"j",function(){return"ContextMenuPerf.A"});a.d(E,"b",function(){return"ContextMenuPerf.B"});a.d(E,"d",function(){return"ContextMenuPerf.C1"});
a.d(E,"a",function(){return"ContextMenuPerf.C2"});a.d(E,"c",function(){return"ContextMenuPerf.D"});a.d(E,"e",function(){return w});a.d(E,"f",function(){return t});a.d(E,"h",function(){return r});a.d(E,"i",function(){return v});a.d(E,"k",function(){return B});a.d(E,"g",function(){return z});var c=a(15),b=a(321),e=a(8),f=a(61),d=a(24),h=a(11),m=a(21),l=a(1);const w=(x,D)=>{var J=x.Sb(null);if((null===J||void 0===J?0:J.cell.Qk)&&n(J,x,D))return x.getCellBounds(J.cell);J=x.ha.ra.activeCell;return(D=y(new d.Range(J.top,
J.left,e.a.fh,J.left,!1,!1),2,!0,x,D)||y(new d.Range(1,J.left,J.top,J.left,!1,!1),2,!1,x,D)||y(new d.Range(J.top,J.right,J.top,e.a.qh,!1,!1),1,!0,x,D)||y(new d.Range(J.top,1,J.top,J.right,!1,!1),1,!1,x,D)||null)&&D.Qk?x.getCellBounds(D):Sys.UI.DomElement.getBounds(x.Gwa.mc)},n=(x,D,J)=>{var L=D.rtl,T=J.isChromeRtl;x=x.cell;return(J=m.h(J).oK(x))?(J=J.topLeft,L=J.x+=L===T?x.offsetWidth:0,T=J.y+=x.offsetHeight,D.view.visibleArea.contains(new f.a(L,T,0,0))):!1},y=(x,D,J,L,T)=>{x=L.kk("ContextMenuHelper.FindFirstCellInViewportArea",
x,D,J);try{for(x.$$rst();x.$$mn();){const O=x.$$cu();if(O&&n(O,L,T))return O.cell}}finally{x&&x.dispose()}return null},t=x=>x.Bb.E5(x.ha.ra.activeCell),r=x=>{x=m.h(x).ha.ra;return x.Og&&(x.$c.isRow||x.$c.hf)},v=(x,D)=>{h.HelperMethods.j_c&&window.performance.mark(D)},B=()=>{if(b.a.eqb){const x=A("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),D=A("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),J=A("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,
0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${x}], PrepInfraWork=[${D}], EWAPopulation =[${J}]`)}},A=(x,D,J)=>{window.performance.measure(x,D,J);D=window.performance.getEntriesByName(x);D.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${x}] returned no measures.`);return D[D.length-1]?D[D.length-1].duration:-1},z=x=>l.EwaSettings.isChangeGateEnabled("OfficeVSO:7214067_CheckShareModeCapability")?x.qd&33554432?!0:!1:!0},775:function(u,
E,a){a.d(E,"a",function(){return c});u=a(0);class c{}c.eQe="ewa-ac";c.Jrh="ewa-ac-param";c.cRe="ewa-function-help-link";c.D9b="ewa-lb";c.YQe="ewa-fb-refactor";c.listItem="list-item";c.eDb="list-item-selected";c.iDb="list-table-touch";c.hDb="list-table";c.cxh="ewa-suggested-cell-name";c.h4g="columnName-header";c.aSe="ewa-tt";c.Duh="ewa-function-link-container";c.dRe="ewa-function-udf-name";c.rtl="rtl";Object(u.a)(c,"CssClassNames",null,[])},811:function(u,E,a){a.r(E);u=a(0);var c=a(15),b=a(816),e=
a(723),f=a(5),d=a(76),h=a(53),m=a(198),l=a(35),w=a(1),n=a(13);class y{constructor(Q,U,N,W,X,sa,da,S){this.frg=Q;this.grg=U;this.erg=N;this.Oga=W;this.gCg=X;this.yyg=sa;this.xkb=da;this.yxg=S}get sxe(){return this.frg}get W1b(){return this.grg}get rxe(){return this.erg}get width(){return this.Oga}get EKj(){return this.gCg}get UIi(){return this.yyg}get lineHeight(){return this.xkb}get vwi(){return this.yxg}static hVg(){return new y("BorderStyleSolidLine",1957,1,"1","",1,8,0)}static dVg(){return new y("BorderStyleDashedLine",
1958,3,"1","5,3",1,8,0)}static eVg(){return new y("BorderStyleDottedLine",1959,4,"1","1,1",1,8,0)}static gVg(){return new y("BorderStyleMediumLine",1960,2,"2","",1,8,0)}static iVg(){return new y("BorderStyleThickLine",1961,5,"3","",1,8,0)}static fVg(){return new y("BorderStyleDoubleLine",1962,6,"1","",2,8,3)}}Object(u.a)(y,"BorderLineStyleProperties",null,[]);class t{constructor(){this.iconName=this.title=this.key=null}}Object(u.a)(t,"BorderLineStyleProps",null,[]);class r{constructor(Q){Q.sSf()}getBorderLineStyleProps(){const Q=
a(811).BorderFormatManager.T_a,U=Array(Object.keys(Q).length);let N=0;for(let sa in Q){var W=sa,X=Q[sa];U[N]=new t;U[N].key=W;W=X;U[N].title=n.a.instance.ga(W.W1b);U[N].iconName=W.sxe;N++}return U}}Object(u.a)(r,"BorderMenuController",null,[582]);var v=a(263),B=a(85),A=a(239),z=a(14),x=a(107),D=a(24),J=a(47),L=a(46),T=a(208),O=a(11),G=a(21),C=a(34),H=a(42);class I{constructor(Q,U){this.cIb=this.ribbonCommandInfo=this.cellFormat=this.ds=this.qb=this.ha=null;this.Atc=!1;this.YMf=this.AMa=this.mHd=this.V$d=
this.$za=this.Zma=null;this.Y1b=this.Bua=this.dNf=0;this.borderStyle=this.U_a=this.borderColor=null;this.wB=!1;this.currentSelectedRange=this.obb=null;this.z0=()=>{if(!this.wB||G.h(this.$).Dz)this.wB=!1,G.h(this.$).Dz=!1,this.Bua=0,G.h(this.$).Hf.gm(f.a.QQ),1===this.$.Ja.LH()&&(G.h(this.$).P4(w.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?H.d(this.mHd):v.a.clone(this.mHd),this.dNf,this.$.oa?this.$.oa.sheetName:null,null,this.YMf.clone(),null,null,0,"DrawBorderBehavior.ResetBehavior",
!0),G.h(this.$).oTa(!0)),this.Uv(),this.C_d(),this.gk(),this.Atc=!1,this.$za=this.Zma=null,this.ds&&(this.ds.cancel(),this.ds.dispose()),c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=N=>{try{if(N=this.Vd(N),G.h(this.$).Dz=!0,this.Zma={},this.$za={},this.obb=null,this.hqb(this.Y1b),2===N.tb){const W=G.h(this.$).ha.io(N.clientPoint,N.Gb,5,void 0,void 0,!1);W&&(this.currentSelectedRange=this.AMa=W,this.gbj())}}catch(W){G.h(this.$).Dz=
!1}return!0};this.Gh=N=>{try{N=this.Vd(N);const W=G.h(this.$).ha.io(N.clientPoint,N.Gb,5,void 0,void 0,!1),X=G.h(this.$).Ea.ps(W);if(!this.cIb||X&&(X.XQ!==this.cIb.XQ||X.WQ!==this.cIb.WQ))if(this.wB=!0,this.cIb=X,W){let sa=new D.Range(this.AMa.top,this.AMa.left,this.AMa.top,this.AMa.left,!0,!1);sa.union(W);sa=G.h(this.$).ha.nZh(sa);this.c2b(W);this.TXf(this.obb,sa);if(this.bottomRightCorner(sa.bottom,sa.right))return c.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),
!1;const da=new D.Range(sa.top,sa.left,sa.bottom+1,sa.right+1,!0,!1),S=G.h(this.$).caa("DrawBorderBehavior.OnPointerMove",[da]);if(this.Zma&&this.$za)for(;S.$$mn();){const oa=S.$$cu(),K=oa.cell.getRange().toString();K in this.Zma&&1!==this.Bua||(this.Zma[K]=oa,this.$za[K]=oa.cell.fN())}this.obb=da;this.currentSelectedRange=sa;G.h(this.$).P4([sa],0,this.$.oa.sheetName,null,sa.topLeft,null,null,0,"DrawBorderBehavior.OnPointerMove",!0);this.Ag.nea(G.h(this.$),-1690267012,this.cellFormat,!0,null,[sa])}return!0}catch(W){return G.h(this.$).Dz=
!1}};this.Pf=N=>{N=this.Vd(N);(N=G.h(this.$).ha.io(N.clientPoint,N.Gb,5,void 0,void 0,!1))?this.wB&&(this.c2b(N),this.AMa.union(N),3===this.Bua?this.hqb(0):this.hqb(this.Y1b),G.h(this.$).P4([this.AMa],0,this.$.oa.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp1",!0),this.Ag.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.Bua?this.hqb(0):this.hqb(this.Y1b),G.h(this.$).P4([this.currentSelectedRange],0,this.$.oa.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp2",
!0),this.Ag.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));this.wB=!1;this.C_d();this.$za=this.Zma=null;return!0};this.onKeyDown=N=>{N=this.Vd(N);if(this.wB||[17,16,18,20].includes(N.Ca.keyCode))return!0;this.z0();return!1};this.onKeyUp=N=>{N=this.Vd(N);if(N.Ca.keyCode===B.a.JG&&this.wB)return this.wB=!1,this.TXf(this.obb,this.currentSelectedRange,!0),this.C_d(),!0;if(this.wB||N.Ca.keyCode===B.a.w1||N.Ca.keyCode===B.a.AFc||N.Ca.keyCode===B.a.zFc||[17,16,18,20,37,39,38,40,33,34,9,
13].includes(N.Ca.keyCode)||N.Ca.keyCode===B.a.U3d||N.Ca.keyCode===B.a.Q3d||N.Ca.keyCode===B.a.M3d)return!0;this.z0();return!1};this.XN=(N,W)=>{G.h(this.$).Dz&&!this.Zai.includes(W.Wd.command)&&(N=JSON.stringify(W.Wd),c.ULS.sendTraceTag(537159512,0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${N} `),this.z0())};this.$=Q;this.Ag=U}get Zai(){return this.V$d||(this.V$d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,
-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}LEg(Q){c.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=G.h(this.$).ha;this.qb=G.h(this.$).qb;this.ribbonCommandInfo=Q;this.mHd=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?H.d(this.ha.ra.selectedRanges):v.a.clone(this.ha.ra.selectedRanges);this.dNf=this.ha.ra.Bs;this.YMf=this.ha.ra.activeCell.clone();this.qb&&this.qb.tld();
this.Ns();this.Lj()}dispose(){this.z0();this.cIb=this.ribbonCommandInfo=this.cellFormat=null}hqb(Q){var {BorderFormatManager:U}=a(811);this.cellFormat={};const N={};this.borderColor=this.borderColor||U.i7c;var W=m.a.HH(this.borderColor,!1);N.Color=[W,W,W,W];w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.U_a&&(N.ThemeBorderColor=[this.U_a,this.U_a,this.U_a,this.U_a],N.ColorTypeOption=1);W=a(811).BorderFormatManager.T_a;this.borderStyle=this.borderStyle||U.borderStyleSolidLine;
U=W[this.borderStyle].rxe;N.LineStyle=[U,U,U,U];this.cellFormat.BorderFormat=N;this.cellFormat.ValidMembers=128;this.cellFormat.Border=Q}Ns(){for(const Q of G.h(this.$).Mn)A.a.instance.ta(z.a.pointerDown,Q.domElement,this.onPointerDown);x.KeyInputManager.instance.ta(z.a.Pb,document.documentElement,this.onKeyDown);x.KeyInputManager.instance.ta(z.a.Fd,document.documentElement,this.onKeyUp)}gbj(){for(const Q of G.h(this.$).Mn)A.a.instance.ta(z.a.Jj,Q.domElement,this.Gh),A.a.instance.ta(z.a.Qf,Q.domElement,
this.Pf);A.a.instance.ta(z.a.Qf,document.documentElement,this.Pf);A.a.instance.ta(z.a.Fy,document.documentElement,this.Pf);this.Atc=!0}Uv(){try{for(const Q of G.h(this.$).Mn)A.a.instance.Ba(z.a.pointerDown,Q.domElement,this.onPointerDown);x.KeyInputManager.instance.Ba(z.a.Pb,document.documentElement,this.onKeyDown);x.KeyInputManager.instance.Ba(z.a.Fd,document.documentElement,this.onKeyUp)}catch(Q){G.h(this.$).Dz=!1,c.ULS.sendTraceTag(537159514,0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${Q}`)}}C_d(){if(this.Atc)try{this.Atc=
!1;for(const Q of G.h(this.$).Mn)A.a.instance.Ba(z.a.Jj,Q.domElement,this.Gh),A.a.instance.Ba(z.a.Qf,Q.domElement,this.Pf);A.a.instance.Ba(z.a.Qf,document.documentElement,this.Pf);A.a.instance.Ba(z.a.Fy,document.documentElement,this.Pf)}catch(Q){G.h(this.$).Dz=!1,c.ULS.sendTraceTag(537159513,0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${Q}`)}}Lj(){this.$.xa.Vf(this.z0);G.h(this.$).Vb.Yk(this.z0);G.h(this.$).AC(this.z0);this.$.Ja.osa(this.XN)}gk(){this.$.xa.Dg(this.z0);
G.h(this.$).Vb.Hk(this.z0);G.h(this.$).ZD(this.z0);this.$.Ja.BAa(this.XN)}TXf(Q,U,N=!1){if(Q&&this.Zma&&this.$za)for(Q=G.h(this.$).caa("DrawBorderBehavior.ApplyBordersOnPreviewCells",[Q]);Q.$$mn();){var W=Q.$$cu().cell.getRange();if(N||!U.contains(W)||1===this.Bua){W=W.toString();const X=l.a.Dc(this.Zma,W);if(X){const sa=l.a.Dc(this.$za,W);this.setBorders(X,sa);delete this.Zma[W];delete this.$za[W]}}}}setBorders(Q,U){var N=Q.cell;const W=N.getRange();N.lcb();W.right!==this.obb.right&&(N=new D.Range(W.top,
W.left-1,W.bottom,W.left-1,!0,!1),G.h(this.$).Ea.ps(N).gRa(3));W.bottom!==this.obb.bottom&&(N=new D.Range(W.top-1,W.left,W.top-1,W.right,!0,!1),G.h(this.$).Ea.ps(N).gRa(1));if(null===U||void 0===U?0:U.Borders.length){N={};let da=0;const S=Array(4),oa=Array(4);for(var X=0;4>X;X++)S[X]=1,oa[X]=0;for(var sa of U.Borders)U=sa.BorderPosition,S[U]=sa.BorderLineStyle,X=new T.a(sa.Color.Red,sa.Color.Green,sa.Color.Blue),oa[U]=X.yS(),da|=O.HelperMethods.x4a(sa.BorderPosition);N.LineStyle=S;N.Color=oa;sa={};
sa.BorderFormat=N;sa.Border=da;this.Ag.wwj(Q,sa,W)}}c2b(Q){const U=new D.Range(Math.max(1,Q.top-1),Math.max(1,Q.left-1),Q.bottom+1,Q.right+1,!1,!1);G.h(this.$).IK(U)||this.ds&&this.ds.Ep||(this.ds=J.a.instance.create(()=>{G.h(this.$).Ht(U,60,"DrawBorderBehavior.BringRangeIntoView")},40,L.a.onh))}bottomRightCorner(Q,U){return 1048576<=Q||16384<=U?!0:!1}Vd(Q){return C.a(this.$).Vd(Q)}}Object(u.a)(I,"DrawBorderBehavior",null,[2]);a.d(E,"BorderFormatManager",function(){return M});class M{constructor(Q,
U,N){this.dSb=null;this.gG={};this.TSb=this.Bx=null;c.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=Q;this.i7d=M.i7c;this.j7d=M.borderStyleSolidLine;this.Ag=U;this.Va=N;w.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.JU=new I(this.$,this.Ag);this.zD=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get KIa(){return this.j7d}get N3(){return this.i7d}get Rta(){return this.TSb}get themesManager(){this.Bx||
(this.Bx=this.$.da.za(422));return this.Bx}O8e(Q,U){c.ULS.sendTraceTag(537159564,0,50,`HandleBorderCommand : Begin handling, Command being executed: ${U.command.toString()}`);const N={},W={};var X=m.a.HH(this.N3,!1);W.Color=[X,X,X,X];this.zD&&this.Rta&&(W.ThemeBorderColor=[this.Rta,this.Rta,this.Rta,this.Rta],W.ColorTypeOption=1);Q=-600086683===U.command?"OutsideBorders":Q[d.a.Jc];W.LineStyle=l.a.Dc(M.iMf,Q);W.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${Q}`):
(X=M.T_a[this.KIa].rxe,W.LineStyle=[X,X,X,X],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.KIa}`));X=l.a.wq(M.fUg,Q,0);c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${Q}, the border color selected is ${this.N3}`);N.BorderFormat=W;4!==X&&8!==X||!this.$.oa.displayRtl||(X=4===X?8:4);N.ValidMembers=128;N.Border=X;this.Ag.formatCells(-1690267012,
N,U);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${U.command.toString()}`);return!0}Sjd(Q,U,N){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${Q.toString()} is being executed, the previous border color is ${this.N3}`);if(this.zD){if((U.SqmControlId||"").includes("ThemeColorPicker")){let W,X;({themeIndex:W,aCa:X}=this.themesManager.getThemeColor(U.Color)).returnValue?(this.TSb={},this.Rta.ThemeColorIndex=W,this.Rta.ThemeColorRow=X):this.TSb=null}else this.TSb=
null;this.JU.U_a=this.Rta}this.i7d=-1803452024===Q?M.i7c:U.Color;this.JU.borderColor=this.N3;this.vOe(N);this.$.af();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${Q.toString()} is being executed, the updated border color is ${this.N3}`);return!0}s7h(Q){c.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const U=this.Va.aq();var N=this.Va.Ec();U.tc.push(N);const W=this.Va.aB("StyleDashGallery",1,"Size120by20");N.buttons.push(W);N=M.T_a;for(let X in N){const sa=
X,da=N[X],S=n.a.instance.ga(da.W1b);W.iu(sa,-2118943501,"QueryBorderStyle",da.W1b,sa,sa,void 0,void 0,S)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");Q.MenuItems=U.JC();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}Q5h(Q,U){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.KIa}`);Q=Q[d.a.Jc];if(M.Bsi(Q))this.j7d=Q,c.ULS.sendTraceTag(537159554,0,50,`RibbonCommand.BorderStyle: Updated Border Style is ${this.KIa}`);
else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${Q}`),!0;this.JU.borderStyle=this.KIa;this.vOe(U);this.$.af();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.KIa}`);return!0}Wjd(Q){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${Q.command.toString()}`);this.YUc(Q,64,this.N3,110,1);return!0}Xjd(Q){c.ULS.sendTraceTag(537159523,
0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${Q.command.toString()}`);this.YUc(Q,112,this.N3,111,2);return!0}b9e(Q){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${Q.command.toString()}`);this.YUc(Q,112,"white",112,3);return!0}x7h(Q){this.$uj(this.hUg,Q,Q.MenuItemId?Q.MenuItemId:M.borderStyleSolidLine)}$uj(Q,U,N){N in Q?(Q=Q[N],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${N}`),
this.bvj(U,Q)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${N}' in BorderLineStyleButtons dictionary`)}I7h(Q,U){const N=Q[d.a.Jc];return"DrawBorder"===N?this.Wjd(U):"DrawBorderGrid"===N?this.Xjd(U):"EraseBorder"===N?this.b9e(U):this.O8e(Q,U)}sSf(){this.dSb||this.jVg()}rNh(){return new r(this)}get hUg(){this.sSf();return this.dSb}jVg(){this.dSb={};let Q=0;const U=M.T_a;for(let N in U){const W=U[N],X=W.sxe;n.a.instance.ga(W.W1b);this.dSb[X]=X;this.ecb(X,()=>
appChrome.buildBorderStyleIconNew(W.EKj,W.width,W.UIi,W.lineHeight,W.vwi));Q++}}ecb(Q,U){if(!(Q in this.gG)){const N={};U=U();N[Q]=U;appChrome.api.registerIconProvider(()=>N);this.gG[Q]=!0}return Q}bvj(Q,U){Q.MenuItemId&&(Q[b.a.On]=Q.MenuItemId===this.KIa,Q[e.a.Icon]=U)}YUc(Q,U,N,W,X){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.V0g(Q,X)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.JU.z0()):(G.h(this.$).Dz&&this.JU.z0(),h.a.current&&(W=String.format(f.a.Xta,h.a.current.fo(W)),G.h(this.$).Hf.gm(W)),this.JU.Y1b=U,this.JU.borderColor=N,G.h(this.$).Dz=!0,this.JU.LEg(Q),this.JU.Bua=X)}vOe(Q){if(Q)switch(this.JU.Bua){case 2:this.Xjd(Q);break;default:this.Wjd(Q)}}V0g(Q,U){return this.JU.Bua===U&&-236759591!==Q.command&&-2118943501!==Q.command?!0:!1}static get T_a(){return M.t5d||(M.t5d={["BorderStyleSolidLine"]:y.hVg(),["BorderStyleDashedLine"]:y.dVg(),["BorderStyleDottedLine"]:y.eVg(),
["BorderStyleMediumLine"]:y.gVg(),["BorderStyleThickLine"]:y.iVg(),["BorderStyleDoubleLine"]:y.fVg()})}static get fUg(){return M.s5d||(M.s5d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get iMf(){return M.Xge||
(M.Xge={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:M.Nhh,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static Bsi(Q){return Q?Q in M.iMf||Q in M.T_a:!1}}M.s5d=null;M.t5d=null;M.Xge=null;M.i7c="black";M.borderStyleSolidLine="BorderStyleSolidLine";M.Nhh=[1,1,1,1];Object(u.a)(M,"BorderFormatManager",null,[553])},836:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{}c.edit="Edit";c.clipboard=
"Clipboard";c.copy="Copy";c.color="Color";c.mSg="AutoFill";c.bnj="RowOperations";c.i4g="ColumnOperations";c.G0j="ViewModeRowOperations";c.F0j="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.fzj="ShapeStyle";c.sGh="FloatingObjectClipboard";c.gLf="PivotTableCopyDelete";c.iLf="PivotTableFieldListActions";c.FAe="CellFloatie";c.bzj="ShapeFloatie";c.contextMenu="ContextMenu";c.h5h="GridContextMenu";c.u1i="PivotTableContextMenu";c.tGh="FloatingObjectContextMenu";c.b0g=
"CellRTEFloatie";c.j5f="ShapeRTEFloatie";Object(u.a)(c,"FloatieGroupIdentifiers",null,[])},837:function(u,E,a){a.d(E,"a",function(){return l});u=a(0);var c=a(87),b=a(224),e=a(14),f=a(239);E=a(238);var d=a(12),h=a(71),m=a(21);class l extends E.a{constructor(w,n,y){super(n);this.mlc=this.oR=!1;this.Kn=this._selectedRowListBox=this.pOa=null;this.$Cf=t=>this.onItemClick(t);this.WCd=t=>{h.g(t.Ca);this.raiseEvent(l.z5a);this.raiseEvent(l.EQd);return!0};this.onScroll=t=>{h.g(t);this.vId();this.raiseEvent(l.z5a)};
this.onBlur=t=>{h.g(t);this.vId()};this.onPointerDown=()=>{this.vId();this.raiseEvent(l.z5a);this.raiseEvent(l.nQa);return!1};this.XFb=t=>{const r=t.Ca;if(r.button===Sys.UI.MouseButton.leftButton||r.button===Sys.UI.MouseButton.rightButton||r.type.includes("touch"))this.Oj=this.Bbc(r),this.onPointerDown(t);this.raiseEvent(l.Jtd);return!1};this.jb=w;this.dDb=y;this.OBa(!0)}a$(w){this.get_events().addHandler(l.z5a,w)}Ida(w){this.get_events().removeHandler(l.z5a,w)}F_b(w){this.get_events().addHandler(l.lmd,
w)}quc(w){this.get_events().removeHandler(l.lmd,w)}vob(w){this.get_events().addHandler(l.EQd,w)}YJb(w){this.get_events().removeHandler(l.EQd,w)}tob(w){this.get_events().addHandler(l.nQa,w)}UJb(w){this.get_events().removeHandler(l.nQa,w)}GWc(w){this.get_events().addHandler(l.Jtd,w)}BLd(w){this.get_events().removeHandler(l.Jtd,w)}get Oj(){return this._selectedRowListBox}set Oj(w){this.fCa(this._selectedRowListBox);w?(this._selectedRowListBox=w,this.fCa(this._selectedRowListBox),this.ywc(w)):this._selectedRowListBox=
null}get RV(){return this.dDb.ListCellClass}get i6(){return this.dDb.ListTableClass}get qI(){return 8}get aEb(){return 5}get llc(){return 24}get klc(){return 35}get Kf(){return this.domElement}get $(){return this.jb}dispose(){this.c8(!1);this.OBa(!1);c.a.qc([this.pOa]);this.pOa=null;super.dispose()}Bbc(w){return d.DOMElementExtensions.Tfd(w.target,"tr",!0)}BB(w){if(w){if(!this.Oj){var n=this.Kn;if(!n||!n.rows.length)return;this.Oj=n.rows[0];0<w?w--:w++}n=this.Oj;for(let y=0,t=Math.abs(w);y<t;y++)if(0>
w){if(!n.previousSibling)break;n=n.previousSibling}else{if(!n.nextSibling)break;n=n.nextSibling}n&&(this.Oj=n)}}bob(w,n){d.DOMElementExtensions.toggleCssClass(w,this.dDb.ListTableClassInTouch,n)}c8(w){const n=this.Kn;n&&(w&&!this.mlc?(b.a.instance.ta(e.a.click,n,this.$Cf),b.a.instance.ta(e.a.Ek,n,this.WCd),f.a.instance.ta(e.a.pointerDown,n,this.XFb),this.mlc=!0):this.mlc&&(b.a.instance.Ba(e.a.click,n,this.$Cf),b.a.instance.Ba(e.a.Ek,n,this.WCd),f.a.instance.Ba(e.a.pointerDown,n,this.XFb),this.mlc=
!1))}fCa(w){let n=null;w&&(n=d.DOMElementExtensions.nk(w,this.dDb.ListCellClass))&&n.classList.toggle(this.dDb.ListCellSelectedClass);return n}OBa(w){this.Kf&&(w&&!this.oR?(this.pOa=this.Ce.Zd(this.Kf),this.pOa.ka("scroll",this.onScroll),this.pOa.ka("blur",this.onBlur),f.a.instance.ta(e.a.pointerDown,this.domElement,this.onPointerDown),this.oR=!0):this.oR&&(c.a.Ia(this.pOa),this.pOa=null,f.a.instance.Ba(e.a.pointerDown,this.domElement,this.onPointerDown),this.oR=!1))}onItemClick(w){return this.WCd(w)}ywc(w){if(w){var n=
w.offsetTop,y=this.Kf.scrollTop;n<y?this.L_f(!0):n+w.offsetHeight>y+this.Kf.clientHeight&&this.L_f(!1)}}L_f(w){this.Kf.scrollTop=w?this.Oj.offsetTop:this.Oj.offsetTop+this.Oj.offsetHeight-this.Kf.clientHeight}vId(){m.h(this.$).eb&&this.raiseEvent(l.lmd)}}l.z5a="GotFocus";l.lmd="IgnoreBlur";l.EQd="SetCell";l.nQa="PointerDown";l.Jtd="ItemPointerDown";Object(u.a)(l,"ListBox",E.a,[417,2])},906:function(u,E,a){a.d(E,"a",function(){return b});u=a(0);var c=a(22);class b{compare(e,f){return c.a.compare(e,
f,!0)}}Object(u.a)(b,"IgnoreCaseComparer",null,[454])},907:function(u,E,a){a.d(E,"a",function(){return f});u=a(0);var c=a(24),b=a(11),e=a(173);class f{constructor(d,h){this.Ea=d;this.A3a=h}bMb(d,h,m){const l=h.Border;h=h.BorderFormat;let w=0,n=!1;if(0===l)d.cell.lcb(),this.pJb(d.cell.getRange());else{for(let y=0;3>=y;y++)f.pAj(d,m,y,l)&&(w|=b.HelperMethods.x4a(y),this.X_d(d.cell.getRange(),y,h),n=!0);b.HelperMethods.dR(l,16)&&!e.c(d,0,m)&&(w|=2,this.X_d(d.cell.getRange(),0,h),n=!0);b.HelperMethods.dR(l,
32)&&!e.c(d,2,m)&&(w|=4,this.X_d(d.cell.getRange(),2,h),n=!0);n&&(m=d.cell.my.qf,b.HelperMethods.dR(w,2)&&this.w6f(d,m,0)&&(w&=-3),b.HelperMethods.dR(w,1)&&this.v6f(d,m,1)&&(w&=-2),b.HelperMethods.dR(w,4)&&this.w6f(d,m,2)&&(w&=-5),b.HelperMethods.dR(w,8)&&this.v6f(d,m,3)&&(w&=-9),d.cell.setBorders(h,w,!1))}}KQ(d,h){d=f.XZe(d,h);return d.Jz?(d=this.Ea.Hja(d))&&d.length?d:null:null}pJb(d){for(let m=0;3>=m;m++){var h=f.XZe(d,m);if(!h.Jz)continue;h=this.Ea.Hja(h);if(!h||!h.length)continue;const l=f.s4e(m);
for(let w=0;w<h.length;w++)h[w].gRa(l)}}X_d(d,h,m){if(d=this.KQ(d,h)){var l=f.s4e(h),w=b.HelperMethods.x4a(l);for(let n=0;n<d.length;n++){const y=d[n];this.Zii(y,l)&&f.setBorders(y,m,w,h,l)}}}Zii(d,h){const m=d.my.qf;var l=d.getRange();l=this.KQ(l,h);let w=!1,n=!1,y=!1,t=!1;l&&(w=f.A7a(l,!0),n=f.A7a(l,!1),t=f.Sqd(l),y=1===l.length?!0:!1);switch(h){case 0:return f.oii(d,m,t,n,y);case 1:return f.lii(d,m,t,w,y);case 2:return f.mii(d,m,t,w,y);case 3:return f.nii(d,m,t,n,y)}return!1}w6f(d,h,m){if(!d.cell.PF)return!1;
const l=d.range,w=this.KQ(l,m),n=e.c(d,m,h);let y=!1;h=0===m?l.top<h.top:l.left<h.left;!f.RAb(d.cell)&&w&&1!==w.length&&(y=(0===m?f.A7a(w,!0):f.A7a(w,!1))?!1:!0);return!n&&y||h?!0:!1}v6f(d,h,m){const l=d.cell,w=this.KQ(l.getRange(),m);d=e.c(d,m,h);h=!1;if(w){const y=f.A7a(w,!0);var n=f.A7a(w,!1);const t=y&&!n;n=n&&!y;1!==m||f.TBb(l)?3!==m||f.JAb(l)||f.wAj(l,w,n,t)&&(h=!0):f.vAj(l,w,y,n)&&(h=!0)}return!d&&h||f.RAb(l)?!0:!1}static cVg(d,h,m){const l={};l.LineStyle=Array(4);l.LineStyle[m]=d.LineStyle[h];
l.Color=Array(4);l.Color[m]=d.Color[h];return l}static Nff(d,h,m,l,w){return b.HelperMethods.dR(d,w)&&e.c(h,m,l)}static pAj(d,h,m,l){return f.Nff(l,d,m,h,b.HelperMethods.x4a(m))||f.Nff(l,d,m,h,64)||112===l}static setBorders(d,h,m,l,w){h=f.cVg(h,l,w);d.setBorders(h,m,!1)}static XZe(d,h){switch(h){case 0:return new c.Range(d.top-1,d.left,d.top-1,d.right,!1,!1);case 2:return new c.Range(d.top,d.left-1,d.bottom,d.left-1,!1,!1);case 1:return new c.Range(d.bottom+1,d.left,d.bottom+1,d.right,!1,!1);case 3:return new c.Range(d.top,
d.right+1,d.bottom,d.right+1,!1,!1)}return d}static s4e(d){switch(d){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static A7a(d,h){for(let m=0;m<d.length;m++){const l=d[m];if(l.PF)return h?f.JAb(l):f.TBb(l)}return!1}static RAb(d){const h=d.my.qf,m=d.getRange();return d.PF&&(m.top<h.top||m.bottom>h.bottom||m.left<h.left||m.right>h.right)?!0:!1}static Sqd(d){for(let h=0;h<d.length;h++)if(f.RAb(d[h]))return!0;return!1}static vAj(d,h,m,l){if(!d.PF){if(!m||f.Sqd(h))return!0}else if(f.JAb(d)&&
(1===h.length&&f.sQg(d,h[0])||!m))return!0;return l}static wAj(d,h,m,l){if(!d.PF){if(!m||f.Sqd(h))return!0}else if(f.TBb(d)&&(1===h.length&&f.tQg(d,h[0])||!m))return!0;return d.sla||l}static oii(d,h,m,l,w){const n=d.getRange();return f.JAb(d)?f.RAb(d)||w:h.top===n.top||!l||m}static lii(d,h,m,l,w){const n=d.getRange();return f.JAb(d)?h.bottom===n.bottom&&w:l&&!m||h.bottom===n.bottom}static mii(d,h,m,l,w){const n=d.getRange();return f.TBb(d)?f.RAb(d)||w:h.left===n.left||!l||m}static nii(d,h,m,l,w){const n=
d.getRange();return d.sla?!1:f.TBb(d)?h.right===n.right&&w:l&&!m||h.right===n.right}static JAb(d){return 0<d.getRange().right-d.getRange().left}static TBb(d){return 0<d.getRange().bottom-d.getRange().top}static tQg(d,h){d=d.getRange();h=h.getRange();return d.top===h.top&&d.bottom===h.bottom}static sQg(d,h){d=d.getRange();h=h.getRange();return d.left===h.left&&d.right===h.right}}Object(u.a)(f,"BorderModelAccessorHelper",null,[])},909:function(u,E,a){a.d(E,"a",function(){return d});u=a(0);var c=a(87);
E=a(94);var b=a(47),e=a(46),f=a(71);class d extends E.a{constructor(h,m){super(m.textBox.domElement);this.cZc=null;this.oKi=()=>{this.zBd()};this.RAf=(l,w)=>{this.jg(l,w)};this.VAf=(l,w)=>{this.rh(l,w)};this.jb=h;this.oJ=m;m.b3&&(m.b3.add(this),m.Yk(this.VAf),m.Rm(this.RAf))}get $(){return this.jb}get Za(){return this.oJ}dispose(){const h=this.oJ;if(null===h||void 0===h?0:h.b3)h.b3.remove(this),h.Hk(this.VAf),h.em(this.RAf);c.a.Ia(this.cZc);this.oJ=null;super.dispose()}Yh(h,m){switch(m){case -1470715894:case -1231471547:this.XY(!1);
break;default:if(this.ZHd(h,m))return f.g(h),!0;d.Zni(m)||this.XY(!1)}return!1}XY(){c.a.Ia(this.cZc);this.cZc=b.a.instance.create(this.oKi,10,e.a.Cwi)}rh(){this.XY(!1)}static Zni(h){switch(h){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}Object(u.a)(d,"ListAutoCompleteBehavior",E.a,[394,2])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/5a9f4d370bead43e2c3a69b6c0e4ec55/EwaDSEsNext.kpae.js.map