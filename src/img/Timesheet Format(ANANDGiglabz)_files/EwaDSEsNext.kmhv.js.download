'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1049:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1050:function(u,E,a){a.d(E,"a",function(){return h});u=a(0);var c=a(15),b=a(84);E=a(146);var e=a(4),f=a(45),d=a(30);class h extends E.a{constructor(m,l,w,n,y,t,r=null){super();this.sJ=null;this.La=l;this.MX=n;this.Mga=t;this.lb=m;this.$s=y;this.ef=w;this.djb=this.lb.qa("SaveToHostWithExtraCharsInFileName");this.Mh=r;this.oc(1,CommonUIStrings.l_SaveButtonLabel)}get sa(){return this.ef}ELe(m,l){this.AL(1,!!m&&m!==l);this.sJ=document.getElementById(h.kWe);f.a.addHandler(this.sJ,"change",Object(b.a)(this,
this.Loc,"onFileNameChange"));f.a.addHandler(this.sJ,"input",Object(b.a)(this,this.Loc,"onFileNameChange"));this.sJ.focus()}H$b(m){return this.djb?(new RegExp("["+this.p9b('\\/:*?"<>|')+"]")).test(m):(new RegExp("["+this.p9b('\\/:*?"<>|#{}%~&')+"]")).test(m)}p9b(m){return m.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}$jd(){const m=d.a.Rq(e.AFrameworkApplication.sm.tn);this.AL(1,!!this.sJ&&""!==this.sJ.value&&this.sJ.value!==m)}Loc(){this.sJ&&window.setTimeout(()=>{this.$jd()},0)}G$b(m,l){if(1!==
m)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{m=l[h.kWe];l=h.MJf in l?l[h.MJf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",d.a.mtc(m),l);const w=d.a.D4(e.AFrameworkApplication.fileName);(m=m?m.trim():null)&&""!==m&&""!==w||1===this.sa.state?this.H$b(m)?this.$s.create().displayError(1,m,l):this.Mga.voa(m+w,l,this.Mh):this.$s.create().displayError(2,m,l)}}dispose(){this.sJ&&
(f.a.removeHandler(this.sJ,"change",Object(b.a)(this,this.Loc,"onFileNameChange")),f.a.removeHandler(this.sJ,"input",Object(b.a)(this,this.Loc,"onFileNameChange")),this.sJ=null);super.dispose()}}h.kWe="txtFileName";h.MJf="chkOverwrite";Object(u.a)(h,"FileNameDialogBase",E.a,[])},1051:function(u,E,a){a.d(E,"a",function(){return n});u=a(0);var c=a(15),b=a(157),e=a(84),f=a(4),d=a(641),h=a(834),m=a(374),l=a(105),w=a(25);class n{constructor(y,t,r,v){this.gXb=null;this.PAg=y;this.lb=r;this.Mfe=t;this.sde=
new b.a;this.Ah=v}r8a(){return this.lb.qa("SaveToCloudStorageUIIsEnabled")}MZe(){return w.a.saveToCloudStorage}G2b(){m.a.dKd(Object(e.a)(this,this.$Zf,"saveToCloudActionDispatcher"));m.a.N9c([new h.a(w.a.saveToCloudStorage,l.a.frame,0)],this.Mfe.a5a())}Hg(){const y=this.Mfe.a5a();y?(y.b$(()=>{this.sde.setResult(!0)}),this.G2b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}jRf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}$Zf(y,
t,r,v,B){return t.contextId!==l.a.frame||y!==this.MZe()?2:this.r8a()?1===r?d.SessionStatusManager.instance.Q5a||f.AFrameworkApplication.u5?8:32:2===r?(this.jRf(),B&&B.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Ah&&(this.gXb=this.Ah.Ac("DialogShown","SaveToOneDriveReponseTime")),this.sde.task.continueWith(()=>{this.gXb&&(this.gXb.stop(),this.gXb=null);this.PAg.start(B)}),32):8:8}}Object(u.a)(n,"SaveToCloudStorageActor",null,[560])},
1052:function(u,E,a){a.d(E,"a",function(){return y});u=a(0);var c=a(15),b=a(84),e=a(1053),f=a(4),d=a(41),h=a(40),m=a(240),l=a(373),w=a(164),n=a(766);class y{constructor(t,r,v,B,A){this.d9=this.Nm=this.zDa=null;this.hEa=!1;this.Mh=this.Lga=null;this.dUc=t;this.Mlb=r;this.$s=v;this.ef=B;this.Ah=A}GNb(){this.ef&&1===this.ef.state||(this.Nm=this.Mlb(),this.Nm.message=CommonUIStrings.l_CommentProgressTooltip,this.Nm.Rb=5,this.Nm.It=!1,this.Nm.EBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}qJa(){this.Nm&&
(this.Nm.close(),this.Nm=null)}rS(){1!==f.AFrameworkApplication.sa.state&&this.$s().displayError(e.a.default)}WQa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");h.a.lf(this.d9,h.a.CX(3),void 0,"UploadToCloudManager.RedirectToFolder")}VQa(t){let r=!1,v=!1;f.AFrameworkApplication.fa&&(r=f.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),v=f.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
t,r);if(r&&v){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const B={};B[l.a.QQa]="1";B[l.a.documentUrl]=t;f.AFrameworkApplication.jV().execute(A=>{A.Pj(w.a.tua,B)})}else h.a.lf(t,h.a.CX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}voa(t,r,v=null,B=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Ah&&(this.Lga=this.Ah.Ac("DialogShown","SaveToOneDriveUploadTime"));this.GNb();this.d9=r;this.zDa=this.dUc.create(t,
v,B);this.Mh=B;this.zQ()}zQ(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.zDa.execute(Object(b.a)(this,this.jVi,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.iVi,"onSaveToCloudUploadFailed"))}jVi(t){this.qJa();this.hEa=!1;if(t&&t.data&&t.data.ue){var r;if(({At:r}=d.d(t.data.ue)).returnValue)if(t=r,t.StatusCode!==m.a.lP&&t.StatusCode!==m.a.Lsb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.rS();else{c.ULS.sendTraceTag(6590603,
216,50,"UploadToCloudManager upload success.");try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.VQa(t.NewDocumentUrl):this.WQa()}catch(v){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",v.toString())}this.AHb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:n.a.Yfb(t.data.ue)}),this.rS()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.rS()}iVi(t){5!==t.data.status&&12!==t.data.status||
this.hEa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",t.data.status),this.qJa(),this.rS(),this.AHb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.hEa=!0,this.zQ())}AHb(){this.Lga&&(this.Lga.stop(),this.Lga=null)}}Object(u.a)(y,"UploadToCloudManager",null,[552])},1053:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{}c.default=0;Object(u.a)(c,"SaveToCloudErrorCodes",null,[])},1054:function(u,E,a){a.d(E,"a",
function(){return d});u=a(0);var c=a(15),b=a(84),e=a(1053),f=a(82);class d{constructor(h,m,l,w,n,y){this.Mh=null;this.HBg=h;this.r2=m;this.gnb=l;this.lb=w;this.URb=n;this.$s=y}start(h){this.Mh=h;if("SharePointOnlineConsumer"===this.lb.Xa("FileSource")){const m=f.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(m){m.start(null,h);return}}this.r2.QMa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.gZg()):(c.ULS.sendTraceTag(6590560,
216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.HBg.create().sQ()}vj(){this.$s().displayError(e.a.default)}gZg(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let h={["client_id"]:this.lb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.URb||2===this.URb)h={["client_id"]:this.lb.appSettings.UploadToSkyDriveClientId};WL.init(h);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.I6,"onFailure"))}catch(h){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",h,h.stack),this.vj()}}onSuccess(h){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");h&&h.data&&h.data.folders&&this.gnb.voa(h.data.folders[0].id,h.data.folders[0].urls.viewInBrowser,null,this.Mh)}I6(h){if(h&&
h.error){if("user_canceled"===h.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",h.error.code,h.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.vj()}}Object(u.a)(d,"SaveToCloudManager",null,[562])},1055:function(u,E,a){a.d(E,"a",function(){return f});u=a(0);var c=a(15),b=a(40),e=a(80);a=a(705);class f extends a.a{constructor(d,
h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.wya;this.Fwa=!0}get linkText(){return f.Dsf}Bma(d){super.Bma(d);b.a.openWindow(4,e.a.NH(f.Csf))}GD(d){super.GD(d);f.gxd&&f.gxd(null)}static initialize(d,h,m,l){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.wya=d;f.Dsf=h;f.Csf=m;f.gxd=l}}f.wya=null;f.Dsf=null;f.Csf=null;f.gxd=null;Object(u.a)(f,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1056:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{}c.Qrh="ewa-bb";c.Rrh="ewa-bb-entry";c.Srh="ewa-bb-react";c.gQe="ewa-bb-entry-body";c.mQe="ewa-bb-icon";c.iQe="ewa-bb-entry-icon";c.lQe="ewa-bb-entry-title";c.kQe="ewa-bb-entry-message";c.x9b="ewa-bb-entry-button";c.jQe="ewa-bb-entry-link";c.hQe="ewa-bb-entry-close";c.y9b="ewa-bb-entry-button-holder";c.fQe="ewa-bb-content";Object(u.a)(c,"CssClassNames",null,[])},1057:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);
a=a(705);class c extends a.a{constructor(b,e){super(b,e);this.xs=!0;this.title=c.zpa;this.message=c.xpa}get actionButton(){return c.wpa}$m(b){super.$m(b);(b=c.ypa)&&b(null)}static initialize(b,e,f,d){c.zpa=b;c.xpa=e;c.wpa=f;c.ypa=d}}c.zpa=null;c.xpa=null;c.wpa=null;c.ypa=null;Object(u.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1058:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);a=a(705);class c extends a.a{constructor(b,e){super(b,e);this.xs=!0;this.title=c.zpa;this.message=
c.xpa}get actionButton(){return c.wpa}$m(b){super.$m(b);(b=c.ypa)&&b(null)}static initialize(b,e,f,d){c.zpa=b;c.xpa=e;c.wpa=f;c.ypa=d}}c.zpa=null;c.xpa=null;c.wpa=null;c.ypa=null;Object(u.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1059:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);a=a(705);class c extends a.a{constructor(b,e){super(b,e);this.xs=!0;this.title=c.zpa;this.message=c.xpa}get actionButton(){return c.wpa}$m(b){super.$m(b);(b=c.ypa)&&b(null)}static initialize(b,
e,f,d){c.zpa=b;c.xpa=e;c.wpa=f;c.ypa=d}}c.zpa=null;c.xpa=null;c.wpa=null;c.ypa=null;Object(u.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1060:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);a=a(705);class c extends a.a{constructor(b,e){super(b,e);this.xs=!0;this.title=c.TDb;this.message=c.wya}get actionButton(){return c.z9a}$m(b){super.$m(b);c.yya&&c.yya(null)}static initialize(b,e,f,d){c.TDb=b;c.wya=e;c.z9a=f;c.yya=d}}c.TDb=null;c.wya=null;c.z9a=null;c.yya=null;Object(u.a)(c,
"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1061:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);a=a(705);class c extends a.a{constructor(b,e){super(b,e);c.z9a&&c.yya&&(this.xs=!0);this.title=c.TDb;this.message=c.wya}get actionButton(){return c.z9a}$m(b){super.$m(b);c.yya&&c.yya(null)}static initialize(b,e,f,d){c.TDb=b;c.wya=e;c.z9a=f;c.yya=d}}c.TDb=null;c.wya=null;c.z9a=null;c.yya=null;Object(u.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1063:function(u,
E,a){a.d(E,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.fhb=function(){function b(){return l()&&(A()||3<=(r()?z("version/"):0))}function e(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function d(){Y||(Y=!0,Oa=h("Windows Phone"))}function h(xa){xa=(new RegExp(xa+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var fb=-1;return null!=xa&&2<=xa.length&&(fb=parseFloat(xa[1]),
isNaN(fb)&&(fb=-1)),fb}function m(){return"function"==typeof navigator.msLaunchUri&&!f()&&!B()&&!w()}function l(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function w(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function n(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function y(){return n()?8==window.document.documentMode:!1}function t(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function r(){return 0<=
window.navigator.userAgent.indexOf(" AppleWebKit/")}function v(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function B(){var xa=window.navigator.userAgent.toLowerCase();return 0<=xa.indexOf("android")&&0<=xa.indexOf("chrome")}function A(){return 3<=(t()?z("firefox/"):0)}function z(xa){var fb=window.navigator.userAgent.toLowerCase(),Jb=fb.indexOf(xa),Ob,eb;return 0<=Jb?(Ob=Jb+xa.length,eb=fb.length,parseInt(fb.substring(Ob,eb))):0}function x(xa,fb,Jb,Ob,eb){if(Ob&&null!=fb)fb();
else if(m())navigator.msLaunchUri(xa,fb,Jb);else if(!(v()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&l())||w())J(xa,fb,Jb);else if(v()&&eb)a:{try{window.open(xa,"_self")}catch(Ma){null!=Jb&&Jb();break a}null!=fb&&fb()}else D(xa,fb,Jb)}function D(xa,fb,Jb){var Ob=document.getElementById("OICLinkTag"),eb;null==Ob&&(Ob=document.createElement("a"),Ob.id="OICLinkTag",Ob.style.visibility="hidden",Ob.href="",Ob.target=0==(wb.Options&
Ca.SupportsTopTargetNavigation)||wb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Ob),null!=Ob.addEventListener&&Ob.addEventListener("click",function(Ma){null!=Ma.stopPropagation&&Ma.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(eb=function(Ma){var va=document.createEvent("MouseEvent");return va.initMouseEvent(Ma,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),va},eb.prototype=Event.prototype,window.MouseEvent=eb),Ob.href=xa,Ob.dispatchEvent(new MouseEvent("click"))}catch(Ma){null!=
Jb&&Jb();return}null!=fb&&fb()}function J(xa,fb,Jb){var Ob=document.getElementById("OICFrame");null==Ob&&(Ob=document.createElement("iframe"),Ob.className="ObjectInDialog",Ob.style.visibility="hidden",Ob.src="about:blank",document.body.appendChild(Ob),Ob.id="OICFrame");try{Ob.contentWindow.location.href=xa}catch(eb){null!=Jb&&Jb();return}null!=fb&&fb()}function L(xa){return 0!=(xa.Options&Ca.SkipProtocolHandler)||y()}function T(xa){return xa===Wa.ReadOnly||xa===Wa.ReadWrite}function O(xa,fb,Jb,Ob){var eb,
Ma;try{if(eb=new ActiveXObject(Ia),eb)return Ma=eb.ViewDocument3(window.self,xa,fb,Ob),Ma?(K(la.O14ActiveX),Ra.None):Ra.Failed}catch(va){}if(Ca.O14Only===(Jb&Ca.O14Only))return wb.DescriptiveUnattemptedEnums?Ra.O14AttemptFailure:Ra.Unattempted;try{if(eb=new ActiveXObject(ra),eb)return Ma=eb.ViewDocument3(window.self,xa,fb,Ob),Ma?(K(la.O12ActiveX),Ra.None):Ra.Failed}catch(va){}if(Ca.O12UpOnly===(Jb&Ca.O12UpOnly))return wb.DescriptiveUnattemptedEnums?Ra.O12UpOnlyFail:Ra.Unattempted;try{if(eb=new ActiveXObject(pa),
eb)return Ma=T(fb)?eb.ViewDocument2(window.self,xa,Ob):eb.EditDocument2(window.self,xa,Ob),Ma?(K(la.O11ActiveX),Ra.None):Ra.Failed}catch(va){}return wb.DescriptiveUnattemptedEnums?Ra.ActiveXUnattempted:Ra.Unattempted}function G(xa,fb,Jb,Ob,eb){var Ma,va,Pa;xa==ua.Visio&&Jb==Wa.ReadWrite&&(Jb=Wa.WriteOnly);xa=eb;(Ob=Ob||f()&&!(d(),8<=Oa))||(Ma="",Ma+=T(Jb)?ka+ta:qa,Ma+=rb,xa+=H(Ma));xa+=H(fb);wb.NewTelemetryDataIsEnabled&&(va=wb.SessionOrigin?"|or|"+wb.SessionOrigin:"",va+=wb.ClickTime?"|ct|"+wb.ClickTime:
"",va+=wb.CorrelationId?"|cid|"+wb.CorrelationId:"",xa+=H(va),wb.CorrelationIdForWinClient&&(xa+=H(wb.CorrelationIdForWinClient)));fb=window.location.href;Jb=gb;Ob=fb.toLowerCase().indexOf("&"+Jb+"=");var Ha;Jb=-1==Ob?void 0:(Pa=Ob+(Jb.length+2),Ha=fb.indexOf("&",Pa),-1==Ha)?fb.substr(Pa):fb.substring(Pa,Ha);if(null!=Jb&&"undefined"!=typeof Jb){Pa="";try{Pa=decodeURIComponent(Jb)}catch(tb){}0<Pa.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Pa)&&(xa+=Za,xa+=Pa)}return xa}
function C(xa,fb,Jb,Ob,eb,Ma){var va=da(xa),Pa;return null==va?(ea(wb.DescriptiveUnattemptedEnums?Ra.ProtocolHandlerIsNull:Ra.Unattempted,wb.Application),!1):(Pa=G(xa,fb,Jb,Ob,va),x(Pa,I,M,eb,Ma),!0)}function H(xa){if(l()&&v()){var fb="";try{fb=decodeURI(xa)}catch(Jb){}if(fb==xa)return encodeURI(xa)}return xa}function I(){K(la.ProtocolHandler)}function M(){wb.Options|=Ca.SkipProtocolHandler;oa(wb,cc,ic)}function Q(){null!=xb&&xb(la.RoamingProtocolHandler)}function U(){null!=Vb&&Vb(Ra.ControlNeeded)}
function N(){var xa=document.getElementById(Va),fb;if(null==xa){if(fb=ba,l()&&3<=(r()?z("version/"):0)&&W(fa,!0)&&(fb=fa),!W(fb,!0))if(l()&&W(ja,!0))fb=ja;else return null;xa=document.createElement("object");xa.id=Va;xa.type=fb;xa.style.width="0px";xa.style.height="0px";xa.style.setProperty("visibility","hidden","");document.body.appendChild(xa);xa=document.getElementById(Va)}return xa}function W(xa,fb){var Jb=window.navigator.mimeTypes,Ob;return null==Jb?!1:(Ob=Jb[xa],Ob)?fb&&!Ob.enabledPlugin?!1:
!0:!1}function X(xa){try{if(null!=new ActiveXObject(xa))return!0}catch(fb){}return!1}function sa(xa){switch(xa){case ua.OneNote:return wa;default:return""}}function da(xa){if(xa!=ua.OneNote&&f()&&!(d(),8<=Oa))return"office:";switch(xa){case ua.Excel:return"ms-excel:";case ua.OneNote:return"onenote:";case ua.PowerPoint:return"ms-powerpoint:";case ua.Visio:return"ms-visio:";case ua.Word:return"ms-word:";case ua.Project:return"ms-project:";case ua.Publisher:return"ms-publisher:";case ua.Infopath:return"ms-infopath:";
case ua.Access:return"ms-access:";default:return""}}function S(xa){switch(xa){case ua.Excel:return"root\\office15\\excel.exe";case ua.PowerPoint:return"root\\office15\\powerpnt.exe";case ua.Visio:return"root\\office15\\visio.exe";case ua.Word:return"root\\office15\\winword.exe";case ua.Project:return"root\\office15\\winproj.exe";case ua.Publisher:return"root\\office15\\mspub.exe";case ua.Infopath:return"root\\office15\\infopath.exe";case ua.Access:return"root\\office15\\msaccess.exe";default:return null}}
function oa(xa,fb,Jb){if(wb=xa,cc=fb,ic=Jb,xa.DocumentUrl){var Ob=Jb=fb=xa.DocumentUrl;try{Ob=decodeURIComponent(xa.DocumentUrl)}catch(tb){}try{Jb=encodeURI(xa.DocumentUrl)}catch(tb){}wb.NewTelemetryDataIsEnabled||(fb=fb+""+xa.CorrelationIdForWinClient,Ob+=xa.CorrelationIdForWinClient,Jb+=xa.CorrelationIdForWinClient);xa.Mode===Wa.ReadWrite&&Ca.CheckoutRequired===(xa.Options&Ca.CheckoutRequired)&&(xa.Mode=Wa.ForceCheckout);Ca.HostIsEditOnly===(xa.Options&Ca.HostIsEditOnly)&&(xa.Mode=Wa.WriteOnly);
if(L(xa)?0:l()&&(xa.Application==ua.OneNote||W(Ka,!1)||W(aa,!1))||m()||B()||!(b()||A()||"ActiveXObject"in window&&!f()||v())||15<=ya())C(xa.Application,xa.EncodeUrl?Jb:fb,xa.Mode,xa.Application==ua.OneNote,xa.SilentExternalHandler,xa.NavigateUsingWindowOpen);else{var eb;if(eb=y())a:{var Ma=xa.EncodeUrl?fb:Ob,va=xa.Mode,Pa=sa(xa.Application);try{eb=(new ActiveXObject(La)).ViewDocument3(window.self,Ma,va,Pa);break a}catch(tb){}eb=!1}if(eb)K(la.O15ActiveX);else{if(b()||A()){var Ha=xa.EncodeUrl?fb:Ob;
Ob=xa.Mode;eb=sa(xa.Application);Ma=N();if(null==Ma)Ha=wb.DescriptiveUnattemptedEnums?Ra.PluginIsNull:Ra.Unattempted;else{va=!1;try{va=Ma.ViewDocument3(window.self,Ha,Ob,eb)}catch(tb){}if(!va)try{va=T(Ob)?Ma.ViewDocument2(window.self,Ha,eb):Ma.EditDocument2(window.self,Ha,eb)}catch(tb){}Ha=va?(K(la.NpapiPlugin),Ra.None):Ra.Failed}}else{try{Ha=new ActiveXObject(bb),null!=Ha&&Ha.SaveSSOCreds()}catch(tb){}Ha=O(xa.EncodeUrl?fb:Ob,xa.Mode,xa.Options,sa(xa.Application))}if(Ha!=Ra.None){if(Ob=xa.CouldUseRoamingApps)cb||
(cb=!0,lb=h("Windows NT")),Ob=6.1<=lb&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(n()||A()||v());if(Ob&&xa.Application!=ua.OneNote){if(!c.fhb.V2j()){ea(Ra.ControlNeeded,wb.Application);return}if(xa.RoamingAppsLauncher){"undefined"==typeof xa.RoamingAppsLauncher||null==xa.RoamingAppsLauncher?ea(wb.DescriptiveUnattemptedEnums?Ra.RoamingLauncherIsNull:Ra.Unattempted,wb.Application):"undefined"==typeof xa.RoamingBitsUrl||null==xa.RoamingBitsUrl?c.fhb.g3j(xa.DocumentUrl,xa.RoamingAppsLauncher,
xa.Application,xa.ApplicationParameters,cc,ic):c.fhb.Kng(xa.DocumentUrl,xa.RoamingAppsLauncher,xa.RoamingApplicationExe,xa.ApplicationParameters,xa.RoamingPlatform,xa.RoamingBitsUrl,cc,ic);return}if(!xa.ContinueIfLauncherIsNull){ea(Ra.LauncherNeeded,wb.Application);return}}Ca.NoProtocolHandlerFallback==(xa.Options&Ca.NoProtocolHandlerFallback)||L(xa)||n()||l()&&!(wb.DescriptiveUnattemptedEnums?Ha>=Ra.O14Unattempted&&Ha<=Ra.DocumentUrlIsNull:Ha==Ra.Unattempted)?ea(Ha,wb.Application):C(xa.Application,
xa.EncodeUrl?Jb:fb,xa.Mode,xa.Application==ua.OneNote,xa.SilentExternalHandler,xa.NavigateUsingWindowOpen)}}}}else ea(wb.DescriptiveUnattemptedEnums?Ra.DocumentUrlIsNull:Ra.Unattempted,wb.Application)}function K(xa){null!=cc&&cc(xa)}function ea(xa,fb){"undefined"==typeof fb&&(fb=null);null!=ic&&ic(xa,fb)}function ya(){var xa=0;if(b()||A()||v()){var fb=N();try{null!=fb&&(xa=fb.GetOfficeVersion())}catch(Jb){}}else X(La)?xa=15:X(Ia)?xa=14:X(ra)?xa=12:X(pa)&&(xa=11);return xa}function ha(){return l()&&
(W(ba,!0)||W(fa,!0))}var La="SharePoint.OpenDocuments.5",Ia="SharePoint.OpenDocuments.4",ra="SharePoint.OpenDocuments.3",pa="SharePoint.OpenDocuments.2",ba="application/x-sharepoint",fa="application/x-sharepoint-webkit",Ka="application/x-sharepoint-protocolhandler",aa="application/x-sharepoint-webkit-protocolhandler",ja="application/officelive",Va="npSharePointPlugin",bb="IDBHO.IDBHOCtrl",wa="OneNote.Notebook",ka="ofv|",ta="ofc|",qa="ofe|",rb="u|",Za="|f|",gb="wdlor",mb="",Ga="",ib="",cc,ic,xb,Vb,
wb,cb,lb,Y,Oa,Wa={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Ca={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Ra={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
la={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},ua={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Wa,OpenDocumentOptions:Ca,OpenDocumentFailureType:Ra,OpenDocumentControl:la,OfficeApplication:ua,EditDocumentInClient:oa,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=ua.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:ya,
IsO14MacPluginInstalled:ha,OfferOfficeInDialog:function(){return e()&&11>=ya()},OfferOfficeNoIntrusive:function(){return e()&&15>ya()},OfferMacOffice:function(){return l()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ha()},InstallRoamingControl:function(){t()?window.InstallTrigger.install({Office:{URL:Ga}}):J(ib,null,null)},CanUseRoamingControl:function(){var xa,fb,Jb;if(m())return!0;if(v())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(t())return xa=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(xa),fb=document.createEvent("Events"),fb.initEvent("RoamingOfficeInstalled",!0,!1),xa.dispatchEvent(fb),!!xa.getAttribute("installed");if(n())try{return Jb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),Jb.HrExists()}catch(Ob){}return!1},InitUrls:function(xa,fb,Jb){mb=xa;Ga=Jb;ib=fb},LaunchRoamingApps:function(xa,fb,Jb,Ob,eb,Ma){c.fhb.Kng(xa,fb,S(Jb),Ob,"x86",mb,eb,Ma)},LaunchRoamingApps2:function(xa,
fb,Jb,Ob,eb,Ma,va,Pa){var Ha="",tb;if(null!=Ob&&(Ha+=" "+Ob),null!=xa&&(Ha+=' "'+xa+'"'),m()||v())xb=va,Vb=Pa,va='office: "'+(Ma+'" "')+(Jb+'" "ROAMING"'),va+=' "'+fb+'"',va+=' "'+eb+'"',va+=" "+Ha,x(va,Q,U,!1,!1);else if(t())xa=document.createElement("RoamingExtensionElement"),xa.setAttribute("cabUrl",Ma),xa.setAttribute("app",Jb),xa.setAttribute("licensingEntitlements",fb),xa.setAttribute("platform",eb),xa.setAttribute("args",Ha),document.documentElement.appendChild(xa),fb=document.createEvent("Events"),
fb.initEvent("RoamingOfficeLaunch",!0,!1),xa.dispatchEvent(fb),null!=va&&va(la.RoamingFFExtension);else if(n()){if(tb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=tb)try{tb.HrConfigureSingle(Ma,Jb,fb,eb,Ha),null!=va&&va(la.RoamingActiveX)}catch(Ya){}}else null!=Pa&&Pa(Ra.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:D,OpenDocumentWithProtocolHandler:C,OpenDocumentWithProtocolHandlerNoCallBack:function(xa,fb,Jb,Ob){var eb=da(xa),Ma;return null==
eb?(ea(wb.DescriptiveUnattemptedEnums?Ra.ProtocolHandlerNoCallbackIsNull:Ra.Unattempted,wb.Application),!1):(Ma=G(xa,fb,Jb,Ob,eb),x(Ma,null,null,!1,!1),!0)}}}();c.ClientUtils=c.fhb},1064:function(u,E,a){a.d(E,"a",function(){return b});u=a(0);var c=a(40);class b{constructor(e,f){this._url=e;this.Nyg=f}Nve(){}q8c(){this.Nyg?c.a.downloadFile(this._url):c.a.lf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(u.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,
[175,2])},1065:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1066:function(u,E,a){a.d(E,"a",function(){return d});u=a(0);var c=a(1194),b=a(4),e=a(54),f=a(82);class d{constructor(h,m,l,w,n,y){this.gY=h;this.hY=m;this.wLc=l;this.oE=w;this.kTb=n;this.LVa=y}get L7f(){return!this.hY&&!this.wLc}get kxf(){return 2===this.LVa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get GPe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get ccf(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Kwa(){return CommonUIStrings.l_OICErrorHelpLink}get Eaf(){return"OICFailure"}get icon(){return 3}get kZb(){return 2===
this.LVa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get Pl(){return CommonUIStrings.l_DefaultDialogTitle}w9i(h){this.Hxf(h)}ewi(h){this.Hxf(h)}Hxf(h){let m=10;1===h?(f.a.instance.resolve("Common.IOfficeTrialExperience").Xkc(this.LVa),m=3):2===h&&((!this.wLc||this.wLc(this.oE))&&this.hY&&c.a.instance.wch(this.hY,this.gY,this.oE),m=5);(0===h||1===h)&&this.gY&&this.gY(this.oE);b.AFrameworkApplication.Zuc(e.a.mJf,this.kTb,m);this.dispose()}dispose(){this.oE=
this.hY=this.gY=null}}Object(u.a)(d,"AOICErrorDialogWithTrial",null,[2])},1067:function(u,E,a){a.d(E,"a",function(){return d});u=a(0);var c=a(1359),b=a(4),e=a(41),f=a(80);class d{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}fQd(){return e.c([this.Vaa(),this])}execute(h,m,l){let w="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(w=f.a.Nl(w,"wdEnableRoaming","1"));b.AFrameworkApplication.Dd.Pm(w,2,this.fQd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.sxb(),h,m,l,void 0,void 0,void 0,void 0,"6")}}Object(u.a)(d,"ARoamingAppsRequest",null,[])},1068:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1069:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1070:function(u,E,a){a.d(E,"a",function(){return b});var c=a(511);const b=()=>{c.a.Oi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1076:function(u,E,a){a.d(E,"a",function(){return b});u=a(0);var c=a(15);class b{constructor(e){this.isEnabled=Boolean.parse(e.DirectPrintIsEnabled||"false");Boolean.parse(e.DirectPrintProbeIsEnabled||"false");this.Xmi=Boolean.parse(e.DirectPrintEnabledForInternetExplorer||"false");this.$Ta=(e.DirectPrintSupportedMimeTypes||
"").split(b.U7c);this.aUa=(e.DirectPrintSupportedPlugins||"").split(b.U7c);this.qbi=(e.DirectPrintImmersivePreviewPlugins||"").split(b.U7c);this.Xgf=Boolean.parse(e.DirectPrintEnabledForEdge||"false");this.Dji=Boolean.parse(e.ChromePrintLayoutFixIsEnabled||"false");this.J1g=parseInt(e.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Nyd=14;this.Euf=14394;if(e=e.DirectPrintMinimalSupportedEdgeVersion){const f=e.split(".");2===f.length?(this.Nyd=parseInt(f[0]),this.Euf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",e)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.U7c=",";Object(u.a)(b,"DirectPrintBrsSettings",null,[])},1077:function(u,E,a){a.d(E,"a",function(){return c});u=a(0);class c{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(u.a)(c,"PrintPreviewPaneProps",null,[])},1142:function(u,E,a){var c=a(9),b=a(0),e=a(15),f=a(4),d=a(1342),h=a(692),m=a(50),l=a(37),w=a(1),n=a(899),y=a(64),t=a(42),r=a(183),v=a(21),B=a(372),A=a(572);class z{constructor(Fa,Ab){this.sHd=0;this.X$d=!1;this.qA=Fa;this.ignorePrintArea=Ab}get qA(){return this.sHd}set qA(Fa){0<=Fa&&2>=Fa?this.sHd=Fa:(e.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),
this.sHd=1)}get ignorePrintArea(){return this.X$d}set ignorePrintArea(Fa){Fa||!Fa?this.X$d=Fa:e.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)(z,"PdfPrintDialogBrowserSessionState",null,[]);var x=a(7),D=a(134),J=a(170),L=a(97),T=a(1397);class O{constructor(Fa,Ab){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=Fa;this.addToPrintArea=Ab}}Object(b.a)(O,"MacroRecorderPrintAreaSetPayload",null,[137]);var G=a(371),C=a(188),H=a(11),I=a(13),M=a(281),Q=
a(67);class U{constructor(Fa){this.sharedSheetCell=null;this.sharedSheetCell=Fa}}Object(b.a)(U,"MacroRecorderPageBreakInsertedPayload",null,[137]);class N{constructor(Fa){this.sharedSheetCell=null;this.sharedSheetCell=Fa}}Object(b.a)(N,"MacroRecorderPageBreakRemovedPayload",null,[137]);class W{constructor(Fa){this.sheetName=null;this.sheetName=Fa}getSheetName(){return this.sheetName}}Object(b.a)(W,"MacroRecorderPageBreaksAllResetPayload",null,[137]);class X{constructor(Fa){this.sheetName=null;this.sheetName=
Fa}getSheetName(){return this.sheetName}}Object(b.a)(X,"MacroRecorderPrintAreaClearedPayload",null,[137]);var sa=a(60);const da=(Fa,Ab,$b,Cb,Rb,uc,nb,Fb=null)=>{Fb=Fa.Na(9,Fb);Fb.sheetName=Ab;Fb.printSettings=$b;return sa.g(Fa,"SetSheetPrintSettings",Fb,Cb,Rb,uc,nb,0)},S=(Fa,Ab,$b,Cb,Rb,uc,nb=null)=>{nb=Fa.Na(1,nb);nb.ConvertInParameters=Ab;return sa.g(Fa,"ConvertWorkbookToPrintPdf",nb,$b,Cb,Rb,uc,4)},oa=(Fa,Ab,$b,Cb,Rb,uc,nb,Fb=null)=>{Fb=Fa.Na(1,Fb);Fb.sheetName=Ab;Fb.printOptions=$b;return sa.g(Fa,
"SetPrintOptions",Fb,Cb,Rb,uc,nb,0)},K=(Fa,Ab,$b,Cb,Rb,uc,nb,Fb=null)=>{Fb=Fa.Na(1,Fb);Fb.sheetName=Ab;Fb.locale=$b;return sa.g(Fa,"GetPrintSettings",Fb,Cb,Rb,uc,nb,4)},ea=(Fa,Ab,$b,Cb,Rb,uc,nb,Fb=null)=>{Fb=Fa.Na(1,Fb);Fb.selectedRanges=Ab;Fb.addToPrintArea=$b;return sa.g(Fa,"SetPrintArea",Fb,Cb,Rb,uc,nb,0)},ya=(Fa,Ab,$b,Cb,Rb,uc,nb=null)=>{nb=Fa.Na(1,nb);nb.sheetName=Ab;return sa.g(Fa,"ClearPrintArea",nb,$b,Cb,Rb,uc,0)},ha=(Fa,Ab,$b,Cb,Rb,uc,nb=null)=>{nb=Fa.Na(9,nb);nb.sheetCell=Ab;return sa.g(Fa,
"InsertPageBreak",nb,$b,Cb,Rb,uc,0)},La=(Fa,Ab,$b,Cb,Rb,uc,nb=null)=>{nb=Fa.Na(9,nb);nb.sheetCell=Ab;return sa.g(Fa,"RemovePageBreak",nb,$b,Cb,Rb,uc,0)},Ia=(Fa,Ab,$b,Cb,Rb,uc,nb=null)=>{nb=Fa.Na(9,nb);nb.sheetName=Ab;return sa.g(Fa,"ResetAllPageBreaks",nb,$b,Cb,Rb,uc,0)};var ra=a(124),pa=a(112),ba=a(51),fa=a(189);class Ka{constructor(){this.Col=this.Row=null}}Object(b.a)(Ka,"PageBreaksInformation",null,[]);class aa{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(aa,"RowColBreak",null,[]);
class ja{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)(ja,"SharedRange",null,[]);var Va=a(176),bb=a(55);class wa{constructor(Fa){this.ribbonCommandInfo=this.SGb=null;this.DQj=(Ab,$b,Cb)=>{$b=!!Ab&&!!Ab.RequestTelemetryData;v.h(this.$).ji&&v.h(this.$).ji.Vla(this.FLa.na(this.ribbonCommandInfo.command),Ab.StateId,$b?Ab.RequestTelemetryData.EcsOperationDuration:0,$b?Ab.RequestTelemetryData.EcsRequestDuration:0,$b?Ab.RequestTelemetryData.WfeRequestDuration:0);
H.HelperMethods.s_&&this.K0g(Cb)};this.$=Fa;this.FLa=new Va.a;this.uwa=new Va.a;this.uwa.add(78661008,12);this.uwa.add(275604654,13);this.uwa.add(-13332329,14);this.uwa.add(-837651977,9);this.uwa.add(-1778266776,10);this.uwa.add(845325699,11)}executeCommand(Fa,Ab,$b,Cb,Rb=null,uc=null,nb=null){this.ribbonCommandInfo=Ab;this.NIj(Ab.command);Fa=M.b(Rb,this.DQj);e.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${Ab.command} command execution started`);switch(Ab.command){case 78661008:return this.X9e(Ab,
Fa,uc,nb,!1);case 275604654:return this.X9e(Ab,Fa,uc,nb,!0);case -13332329:return this.V8e(Ab,Fa,uc,nb);case -837651977:return this.Q6h(Ab,Fa,uc,nb);case -1778266776:return this.N7h(Ab,Fa,uc,nb);case 845325699:return this.S9e(Ab,Fa,uc,nb)}return r.a(Ab.command)}wc(Fa,Ab){switch(Ab.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===Fa;case 845325699:case -13332329:return!0}return!1}Z3f(Fa,Ab,$b){const Cb=v.h(this.$);var Rb=Cb.Ea;const uc=t.r(Cb.ha.ra.selectedRanges,this.$);
if((Rb=Rb.nD())&&Rb.length){for(const nb of Rb){Rb=nb;const Fb=Rb.sf;if(!Fb)continue;const Jc=t.j(Rb.qf),Fc=[];for(const zb of uc.Ranges){if(zb.FirstRow>Jc.LastRow+1||zb.LastRow<Jc.FirstRow||zb.FirstColumn>Jc.LastColumn+1||zb.LastColumn<Jc.FirstColumn)continue;const hb=this.QYh(Jc,zb,Fb),Pb=this.PYh(Jc,zb,Fb);Fc.push(Object(x.a)(new ja,{FirstRow:hb.FirstRow,FirstColumn:Pb.FirstColumn,LastRow:hb.LastRow,LastColumn:Pb.LastColumn}))}0<Fc.length&&!$b?Fb.setPrintArea(Fc):0<Fc.length&&$b?Fb.addToPrintArea(Fc):
!$b&&Fb.hasPrintArea()&&Fb.clearPrintArea();!Fb.isDirty()&&Fb.hasPageLayout()&&Fb.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Rb.zd,4)}this.xPb(Cb,Fa,Ab)}}D2g(Fa,Ab){const $b=v.h(this.$);var Cb=v.h(this.$).Ea.nD();if(Cb&&Cb.length){for(const Rb of Cb){Cb=Rb;const uc=Cb.sf;uc&&(uc.clearPrintArea(),!uc.isDirty()&&uc.hasPageLayout()&&uc.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+Cb.zd,4))}this.xPb($b,Fa,Ab)}}Zfi(Fa,Ab){const $b=v.h(this.$);var Cb=$b.Ea;
const Rb=t.o($b.ha.ra.activeCell,this.$);if(Rb){var uc=Cb.nD();if(uc&&uc.length){Cb=null;for(var nb of uc){let Fb=nb,Jc=Fb.sf;if(!Jc)continue;let Fc=t.j(Fb.qf);if(!(Rb.FirstRow>Fc.LastRow||Rb.FirstRow<Fc.FirstRow||Rb.FirstColumn>Fc.LastColumn||Rb.FirstColumn<Fc.FirstColumn)&&(Cb=this.Jch(Jc,Fc,Rb),Jc.insertPageBreak(Cb),!Jc.isDirty()&&Jc.hasPageLayout()&&Jc.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Fb.zd,4),Cb))break}if(!Cb)for(const Fb of uc)if(Cb=Fb,nb=Cb.sf)Cb=t.j(Cb.qf),
Cb=this.VHe(nb,Cb,Rb),nb.insertPageBreak(Cb);this.xPb($b,Fa,Ab)}}}fej(Fa,Ab){const $b=v.h(this.$);var Cb=$b.Ea;const Rb=t.o($b.ha.ra.activeCell,this.$);if(Rb&&(Cb=Cb.nD())&&Cb.length){for(const nb of Cb){Cb=nb;const Fb=Cb.sf;if(Fb){var uc=t.j(Cb.qf);(uc=this.VHe(Fb,uc,Rb))&&Fb.removePageBreak(uc);!Fb.isDirty()&&Fb.hasPageLayout()&&Fb.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+Cb.zd,4)}}this.xPb($b,Fa,Ab)}}$jj(Fa,Ab){const $b=v.h(this.$);var Cb=$b.Ea.nD();if(Cb&&Cb.length){for(const Rb of Cb){Cb=
Rb;const uc=Cb.sf;uc&&(uc.resetAllPageBreak(),!uc.isDirty()&&uc.hasPageLayout()&&uc.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+Cb.zd,4))}this.xPb($b,Fa,Ab)}}X9e(Fa,Ab,$b,Cb,Rb){if(!Rb){var uc=this.$.Cb.getItemByName("PRINT_AREA");if(uc&&(e.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${uc.type}`),2===uc.type))return this.Ehi(),bb.Task.Ta(!0)}uc=v.h(this.$).ha.ra;const nb=t.r(uc.selectedRanges,
this.$);if(1===nb.Ranges.length&&!Rb){if(uc.Yba())return this.c8h(Fa,nb,Ab,$b,Cb,Rb),bb.Task.Ta(!0);if(t.R(nb.Ranges[0]))return this.$.xa.oa.hasPrintArea?this.V8e(Fa,Ab,$b,Cb):bb.Task.Ta(!0)}this.Z3f(Fa.command,Cb,Rb);return this.fff(Fa,Ab,$b,nb,Rb)}V8e(Fa,Ab,$b,Cb){this.D2g(Fa.command,Cb);return this.qhi(Fa,Ab,$b)}Q6h(Fa,Ab,$b,Cb){this.Zfi(Fa.command,Cb);return this.Bhi(Fa,Ab,$b)}N7h(Fa,Ab,$b,Cb){const Rb=t.r(v.h(this.$).ha.ra.selectedRanges,this.$);if(t.R(Rb.Ranges[0]))return this.S9e(Fa,Ab,$b,
Cb);this.fej(Fa.command,Cb);return this.Fhi(Fa,Ab,$b)}S9e(Fa,Ab,$b,Cb){this.$jj(Fa.command,Cb);return this.Ihi(Fa,Ab,$b)}fff(Fa,Ab,$b,Cb,Rb){const uc=this.$.pa.ya,nb=()=>new O(Cb,Rb);return G.a(this.$.userOperationManager,(Fb,Jc,Fc)=>ea(uc,Cb,Rb,M.b(Fb,Ab),M.a(Jc,$b),Fc,null),Fb=>new C.a(241,0,Fb,64,nb),Fa)}qhi(Fa,Ab,$b){const Cb=this.$.xa.oa.name,Rb=this.$.pa.ya,uc=()=>new X(Cb);return G.a(this.$.userOperationManager,(nb,Fb,Jc)=>ya(Rb,Cb,M.b(nb,Ab),M.a(Fb,$b),Jc,null),nb=>new C.a(243,0,nb,64,uc),
Fa)}Bhi(Fa,Ab,$b){const Cb=v.h(this.$),Rb=t.o(Cb.ha.ra.activeCell,this.$),uc=()=>new U(Rb);return G.a(this.$.userOperationManager,(nb,Fb,Jc)=>ha(this.$.pa.ya,Rb,M.b(nb,Ab),M.a(Fb,$b),Jc,null),nb=>new C.a(244,0,nb,64,uc),Fa)}Fhi(Fa,Ab,$b){const Cb=v.h(this.$),Rb=t.o(Cb.ha.ra.activeCell,this.$),uc=()=>new N(Rb);return G.a(this.$.userOperationManager,(nb,Fb,Jc)=>La(this.$.pa.ya,Rb,M.b(nb,Ab),M.a(Fb,$b),Jc,null),nb=>new C.a(245,0,nb,64,uc),Fa)}Ihi(Fa,Ab,$b){const Cb=this.$.xa.oa.name,Rb=()=>new W(Cb);
return G.a(this.$.userOperationManager,(uc,nb,Fb)=>Ia(this.$.pa.ya,Cb,M.b(uc,Ab),M.a(nb,$b),Fb,null),uc=>new C.a(246,0,uc,64,Rb),Fa)}QYh(Fa,Ab,$b){if(!Fa||!Ab||!$b)return null;const Cb=new ja;Cb.FirstRow=Ab.FirstRow===Fa.LastRow+1?$b.getRowIndex(Fa.LastRow+1)+1:Ab.FirstRow<Fa.FirstRow?0:$b.getRowIndex(Ab.FirstRow+1);Cb.LastRow=Ab.FirstRow===Fa.LastRow+1||Ab.LastRow>Fa.LastRow?$b.getRowIndex(Fa.LastRow+1)+1:$b.getRowIndex(Ab.LastRow+1);return Cb}PYh(Fa,Ab,$b){if(!Fa||!Ab||!$b)return null;const Cb=
new ja;Cb.FirstColumn=Ab.FirstColumn===Fa.LastColumn+1?$b.getColumnIndex(Fa.LastColumn+1)+1:Ab.FirstColumn<Fa.FirstColumn?0:$b.getColumnIndex(Ab.FirstColumn+1);Cb.LastColumn=Ab.FirstColumn===Fa.LastColumn+1||Ab.LastColumn>Fa.LastColumn?$b.getColumnIndex(Fa.LastColumn+1)+1:$b.getColumnIndex(Ab.LastColumn+1);return Cb}Jch(Fa,Ab,$b){if(!Ab||!$b||!Fa)return null;const Cb=Fa.getPrintArea();if(!Cb||!Cb.length)return null;const Rb=Fa.getRowIndex($b.FirstRow+1),uc=Fa.getColumnIndex($b.FirstColumn+1);let nb=
null,Fb=null;for(const Jc of Cb)if(Rb>=Jc.FirstRow&&Rb<=Jc.LastRow&&uc>=Jc.FirstColumn&&uc<=Jc.LastColumn){if($b.FirstRow===Jc.FirstRow&&$b.FirstColumn===Jc.FirstColumn)return new Ka;Rb>Jc.FirstRow&&(nb=Object(x.a)(new aa,{Index:Rb-1,Min:Jc.FirstColumn-1,Max:Math.min(Jc.LastColumn,Fa.getColumnIndex(Ab.LastColumn+1))}));uc>Jc.FirstColumn&&(Fb=Object(x.a)(new aa,{Index:uc-1,Min:Jc.FirstRow-1,Max:Math.min(Jc.LastRow,Fa.getRowIndex(Ab.LastRow+1))}));break}return nb||Fb?Object(x.a)(new Ka,{Row:nb?[nb]:
null,Col:Fb?[Fb]:null}):null}Zdh(Fa,Ab,$b){if(!Ab||!$b||!Fa)return null;let Cb=null;$b.FirstRow>Ab.FirstRow&&$b.FirstRow<=Ab.LastRow?Cb=Object(x.a)(new aa,{Index:Fa.getRowIndex($b.FirstRow+1)-1,Min:-1,Max:-1}):$b.FirstRow===Ab.LastRow+1&&(Cb=Object(x.a)(new aa,{Index:Fa.getRowIndex(Ab.LastRow+1),Min:-1,Max:-1}));return Cb}t$g(Fa,Ab,$b){if(!Ab||!$b||!Fa)return null;let Cb=null;$b.FirstColumn>Ab.FirstColumn&&$b.FirstColumn<=Ab.LastColumn?Cb=Object(x.a)(new aa,{Index:Fa.getColumnIndex($b.FirstColumn+
1)-1,Min:-1,Max:-1}):$b.FirstColumn===Ab.LastColumn+1&&(Cb=Object(x.a)(new aa,{Index:Fa.getColumnIndex(Ab.LastColumn+1),Min:-1,Max:-1}));return Cb}VHe(Fa,Ab,$b){if(!$b||!Fa||!Ab)return null;const Cb=this.Zdh(Fa,Ab,$b);Fa=this.t$g(Fa,Ab,$b);return Cb||Fa?Object(x.a)(new Ka,{Row:Cb?[Cb]:null,Col:Fa?[Fa]:null}):null}Ehi(){const Fa=new D.StandardDialog;Fa.Rb=0;Fa.oc(1,I.a.instance.ga(4));Fa.Zl(I.a.instance.ga(569),I.a.instance.ga(570),1,null)}NIj(Fa){if(this.uwa.mb(Fa)&&(H.HelperMethods.s_&&(this.SGb=
this.$.Jb.Ac("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.FLa.mb(Fa)&&this.FLa.remove(Fa),this.FLa.add(Fa,J.a.create().toString()),v.h(this.$).ji)){const Ab=ba.b()?ba.b().uj(Fa):"";v.h(this.$).ji.X7(this.uwa.na(Fa),this.FLa.na(Fa),Ab)}}K0g(Fa){if(this.SGb&&Fa){const Ab=this.SGb.zc;this.SGb.stop();this.SGb=null;switch(Fa){case "SetPrintArea":this.brb(Ab,1700,Fa);break;case "ClearPrintArea":this.brb(Ab,1500,Fa);break;case "InsertPageBreak":this.brb(Ab,1500,Fa);break;case "RemovePageBreak":this.brb(Ab,
1600,Fa);break;case "ResetAllPageBreaks":this.brb(Ab,1700,Fa)}}}brb(Fa,Ab,$b){Fa>Ab&&(Ab=Object(x.a)(new fa.a,{extendedProperties:new Map}),Ab.extendedProperties.set("OperationName",$b),Ab.extendedProperties.set("OperationExecutionTime",Fa.toString()),L.Health.instance.recordQosError(ra.a.yHj,[pa.a.tHj],!1,!0,!0,!1,Ab))}c8h(Fa,Ab,$b,Cb,Rb,uc){const nb=new D.StandardDialog,Fb=new T.a(I.a.instance.ga(567),I.a.instance.ga(568),I.a.instance.ga(6),I.a.instance.ga(5));nb.Rb=1;nb.oc(1,Fb.confirmButton);
nb.oc(0,Fb.cancelButton);nb.Zl(Fb.title,Fb.body,3,Jc=>{1===Jc&&(this.Z3f(Fa.command,Rb,uc),this.fff(Fa,$b,Cb,Ab,uc))})}xPb(Fa,Ab,$b){$b();this.FLa.mb(Ab)&&Fa.ji.uS(this.FLa.na(Ab),Q.BasicTelemetryCalculator.$Q)}}Object(b.a)(wa,"PrintAreaBreakManager",null,[755]);var ka=a(383),ta=a(87),qa=a(27);class rb{constructor(){this.margin=this.C0=this.bda=this.orientation=this.qA=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.C2a=!1;this.NoColor=null}equals(Fa){return Fa?this.orientation===Fa.orientation&&
this.bda===Fa.bda&&this.C0===Fa.C0&&this.margin===Fa.margin&&this.sheetPrintOptions===Fa.sheetPrintOptions&&this.C2a===Fa.C2a&&this.NoColor===Fa.NoColor:!1}static UFe(Fa,Ab){Fa&&Ab&&(Ab.qA=Fa.qA,Ab.orientation=Fa.orientation,Ab.bda=Fa.bda,Ab.C0=Fa.C0,Ab.margin=Fa.margin,Ab.ignorePrintArea=Fa.ignorePrintArea,Ab.sheetPrintOptions=Fa.sheetPrintOptions,Ab.C2a=Fa.C2a,Ab.NoColor=Fa.NoColor)}}Object(b.a)(rb,"PrintSettingsContainer",null,[]);var Za=a(8),gb=a(58),mb=a(299),Ga=a(965),ib=a(207),cc=a(116),ic=
a(154),xb=a(345),Vb=a(38),wb=a(29),cb=a(22),lb=a(764),Y=a(782),Oa=a(187),Wa=a(639),Ca=a(553);class Ra{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(Ra,"PrintSettingMarginOption",null,[]);class la{constructor(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(la,"PrintSettingMarginValue",null,[]);class ua{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(ua,"PrintSettingOption",null,[]);class xa{constructor(Fa){this.HHi=
[.75,.75,.7,.7,.3,.3];this.xGi=[.75,.75,.25,.25,.3,.3];this.B1j=[1,1,1,1,.5,.5];this.Ude=this.Tie=this.lge=this.Vfe=this.Bme=this.f7=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.hm=Fa;this.Jei();this.Pei()}get whatToPrintOptions(){return this.Bme}get orientationOptions(){return this.Vfe}get paperSizeOptions(){return this.lge}get scalingOptions(){return this.Tie}get marginDetailedOptions(){return this.Ude}dispose(){}rxb(Fa){if(!Fa)return null;const Ab=new la;Ab.left=Fa.Left;
Ab.right=Fa.Right;Ab.top=Fa.Top;Ab.bottom=Fa.Bottom;Ab.header=Fa.Header;Ab.footer=Fa.Footer;return Ab}F5c(Fa){e.ULS.shipAssertTag(537154186,0,6===Fa.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const Ab={};Ab.Top=Fa[0];Ab.Bottom=Fa[1];Ab.Left=Fa[2];Ab.Right=Fa[3];Ab.Header=Fa[4];Ab.Footer=Fa[5];return Ab}Pei(){this.Bme=[Object(x.a)(new ua,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1226)}),Object(x.a)(new ua,{printSettingOptionKey:2,
printSettingOptionText:this.hm.ga(1219)}),Object(x.a)(new ua,{printSettingOptionKey:0,printSettingOptionText:this.hm.ga(1218)})];this.Vfe=[Object(x.a)(new ua,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1229)}),Object(x.a)(new ua,{printSettingOptionKey:2,printSettingOptionText:this.hm.ga(1228)})];this.lge=[Object(x.a)(new ua,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1231)}),Object(x.a)(new ua,{printSettingOptionKey:5,printSettingOptionText:this.hm.ga(1232)}),Object(x.a)(new ua,
{printSettingOptionKey:6,printSettingOptionText:this.hm.ga(1239)}),Object(x.a)(new ua,{printSettingOptionKey:7,printSettingOptionText:this.hm.ga(1233)}),Object(x.a)(new ua,{printSettingOptionKey:8,printSettingOptionText:this.hm.ga(1234)}),Object(x.a)(new ua,{printSettingOptionKey:9,printSettingOptionText:this.hm.ga(1235)}),Object(x.a)(new ua,{printSettingOptionKey:11,printSettingOptionText:this.hm.ga(1236)}),Object(x.a)(new ua,{printSettingOptionKey:12,printSettingOptionText:this.hm.ga(1237)}),Object(x.a)(new ua,
{printSettingOptionKey:13,printSettingOptionText:this.hm.ga(1238)}),Object(x.a)(new ua,{printSettingOptionKey:3,printSettingOptionText:this.hm.ga(1230)})];this.Tie=[Object(x.a)(new ua,{printSettingOptionKey:0,printSettingOptionText:this.hm.ga(1247)}),Object(x.a)(new ua,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1248)}),Object(x.a)(new ua,{printSettingOptionKey:2,printSettingOptionText:this.hm.ga(1249)}),Object(x.a)(new ua,{printSettingOptionKey:3,printSettingOptionText:this.hm.ga(1250)})];
this.Ude=[Object(x.a)(new Ra,{printSettingOption:Object(x.a)(new ua,{printSettingOptionKey:0,printSettingOptionText:this.hm.ga(1253)}),marginValue:this.rxb(this.normal)}),Object(x.a)(new Ra,{printSettingOption:Object(x.a)(new ua,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1254)}),marginValue:this.rxb(this.wide)}),Object(x.a)(new Ra,{printSettingOption:Object(x.a)(new ua,{printSettingOptionKey:2,printSettingOptionText:this.hm.ga(1255)}),marginValue:this.rxb(this.narrow)}),Object(x.a)(new Ra,
{printSettingOption:Object(x.a)(new ua,{printSettingOptionKey:3,printSettingOptionText:this.hm.ga(1256)}),marginValue:this.rxb(this.f7)})]}Jei(){this.normal=this.F5c(this.HHi);this.narrow=this.F5c(this.xGi);this.wide=this.F5c(this.B1j)}}xa.fih=1;xa.Qhh=1;xa.t7c=9;xa.Vhh=2;xa.Ohh=0;xa.Hhh=!1;xa.Chh=!1;xa.cJa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(xa,"PrintSettingsManagerBase",null,[2]);var fb=a(121),Jb=a(282);class Ob{constructor(Fa,Ab){this.sheetPrintOptions=
this.sheetName=null;this.sheetName=Fa;this.sheetPrintOptions=Ab}getSheetName(){return this.sheetName}}Object(b.a)(Ob,"MacroRecorderSheetPrintOptionsSavedPayload",null,[137]);class eb{constructor(Fa,Ab){this.printSettings=this.sheetName=null;this.sheetName=Fa;this.printSettings=Ab}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(eb,"MacroRecorderSheetPrintSettingsSavedPayload",null,[137]);class Ma extends xa{constructor(Fa,Ab,$b,Cb,Rb,uc){super(Rb);this.n9f=
this.Cd=!1;this.zDd=nb=>{this.VD.zDd(nb)};this.JDd=nb=>{this.VD.JDd(nb)};this.hVi=()=>{e.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};this.gVi=nb=>{nb=cc.a.Pe(nb.data);e.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${wb.a.sc(nb)}.`)};this.Sz=(nb,Fb)=>{2===Fb.Kr?this.Jv.clear():1===Fb.Kr&&this.Jv&&this.Jv.contains(Fb.Rf)&&(e.ULS.sendTraceTag(537154188,
0,50,`PrintSettingsManager.OnQueueChanged: web method ${fb.a(Fb.Rf.operation.operationName)} returned, it took ${Fb.Rf.dequeueUtcTime.getTime()-Fb.Rf.enqueueUtcTime.getTime()} milliseconds to complete.`),this.Jv.remove(Fb.Rf))};this.VD=Fa;this.Pab=$b;this.$=Ab;this.sheetName=Cb;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.va.UICultureTag;this.v_i=this.d8g();this.$.userOperationManager.ur(this.Sz);this.Jv=new Oa.a;this.bI=uc}vhi(Fa){this.whi(Ab=>{Fa&&(Ab=this.VYh(Ab),
Fa(Ab))})}POd(Fa,Ab){if(Fa){var $b=new z(Fa.qA,Fa.ignorePrintArea);this.foj($b);!Ab||this.n9f?e.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${Ab?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(Ab=this.XYh(Fa.C0),Ab.IsLandscape=2===Fa.orientation,Ab.PaperSize=Fa.bda,this.bI&&(Ab.NoColor=Fa.NoColor),Ab.PageMargin=this.Ahd(Fa.margin),Ab.SheetPrintOptions=xa.cJa,Ab.SheetPrintOptions.PrintGrid=Fa.sheetPrintOptions.PrintGrid,
Ab.SheetPrintOptions.HorizontalCenter=Fa.sheetPrintOptions.HorizontalCenter,Ab.SheetPrintOptions.VerticalCenter=Fa.sheetPrintOptions.VerticalCenter,Ab.SheetPrintOptions.PrintHeaders=Fa.sheetPrintOptions.PrintHeaders,this.eoj(Ab))}else e.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}Ahd(Fa){let Ab={};0===Fa?Ab=this.normal:1===Fa?Ab=this.wide:2===Fa?Ab=this.narrow:3===Fa&&(Ab=this.f7);return Ab}Mhi(Fa){if(Fa){e.ULS.sendTraceTag(537154197,
0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Ab=this.$.pa.ya,$b=this.$.pa.ya.Wb(),Cb=new C.a(598,0,(Rb,uc,nb)=>oa(Ab,this.$.xa.oa.name,Fa,M.b(this.zDd,Rb),M.a(this.JDd,uc),nb,$b),64,()=>new Ob(this.$.xa.oa.name,Fa));this.$.userOperationManager.Ic(Cb,null)}else e.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.Cd||(this.Cd=!0,this.$.userOperationManager.ko(this.Sz),
this.sY())}foj(Fa){this.Pab.qA=Fa.qA;this.Pab.ignorePrintArea=Fa.ignorePrintArea}whi(Fa){const Ab=uc=>{Jb.a(uc)?e.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${wb.a.sc(uc.Errors)}.`):(e.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),Fa(uc.Result))},$b=uc=>{uc=cc.a.Pe(uc.data);e.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${wb.a.sc(uc)}.`);
Fa(null)},Cb=this.$.pa.ya.Wb();var Rb=new C.a(247,0,(uc,nb,Fb)=>K(this.$.pa.ya,this.sheetName,this.locale,M.b(uc,Ab),M.a(nb,$b),Fb,Cb),80);Rb=this.$.userOperationManager.Ic(Rb,null);this.Jv.add(Rb)}eoj(Fa){e.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const Ab=this.$.pa.ya.Wb();this.$.userOperationManager.Ic(new C.a(226,0,($b,Cb,Rb)=>da(this.$.pa.ya,this.sheetName,Fa,M.b($b,this.hVi),M.a(Cb,this.gVi),Rb,
Ab),void 0,()=>new eb(this.sheetName,Fa)),null)}Toi(Fa){return this.Bgf(Fa)||!this.Jjf(Fa.PaperSize)}fGh(Fa){this.Bgf(Fa)&&(e.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),Fa.ScalingWidth=Ma.Xhh,Fa.ScalingHeight=Ma.Whh,Fa.ScalingPercent=Ma.jKe,Fa.FitToPage=Ma.Dhh);this.Jjf(Fa.PaperSize)||(e.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${Fa.PaperSize.toString()} present in file which is unsupported by XLO.`),
Fa.PaperSize=Ma.t7c);return Fa}TYh(Fa){if(Fa.FitToPage){if(1===Fa.ScalingWidth&&1===Fa.ScalingHeight)return 1;if(!Fa.ScalingWidth&&1===Fa.ScalingHeight)return 3}else return 0;return 2}SYh(Fa){return this.ird(Fa,this.normal)?0:this.ird(Fa,this.wide)?1:this.ird(Fa,this.narrow)?2:3}ird(Fa,Ab){return Fa.Left===Ab.Left&&Fa.Right===Ab.Right&&Fa.Top===Ab.Top&&Fa.Bottom===Ab.Bottom&&Fa.Header===Ab.Header&&Fa.Footer===Ab.Footer}XYh(Fa){const Ab={};Ab.ScalingPercent=Ma.jKe;Ab.FitToPage=0!==Fa;2===Fa?(Ab.ScalingWidth=
1,Ab.ScalingHeight=0):3===Fa?(Ab.ScalingWidth=0,Ab.ScalingHeight=1):1===Fa&&(Ab.ScalingWidth=1,Ab.ScalingHeight=1);return Ab}Jjf(Fa){return this.v_i.contains(Fa.toString())}Bgf(Fa){return 100!==Fa.ScalingPercent||Fa.FitToPage&&(1<Fa.ScalingWidth||1<Fa.ScalingHeight)}d8g(){const Fa=new Wa.a(Ca.a.Yj());for(let Ab=0;Ab<this.paperSizeOptions.length;Ab++)Fa.add(this.paperSizeOptions[Ab].printSettingOptionKey.toString());return Fa}VYh(Fa){let Ab=null;if(Fa){const $b=this.Pab.qA,Cb=this.Pab.ignorePrintArea;
this.Toi(Fa)&&(this.n9f=!0,Fa=this.fGh(Fa));Ab=new rb;Ab.qA=$b;Ab.ignorePrintArea=Cb;Ab.orientation=Fa.IsLandscape?2:1;Ab.bda=Fa.PaperSize;Ab.C0=this.TYh(Fa);Ab.sheetPrintOptions=xa.cJa;Ab.sheetPrintOptions.PrintGrid=Fa.SheetPrintOptions.PrintGrid;Ab.C2a=Fa.Draft;this.bI&&(Ab.NoColor=Fa.NoColor);Ab.sheetPrintOptions.HorizontalCenter=Fa.SheetPrintOptions.HorizontalCenter;Ab.sheetPrintOptions.VerticalCenter=Fa.SheetPrintOptions.VerticalCenter;Ab.sheetPrintOptions.PrintHeaders=Fa.SheetPrintOptions.PrintHeaders;
Ab.margin=this.SYh(Fa.PageMargin);e.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${Ab.margin}`);3===Ab.margin&&(this.f7={},this.f7.Left=Fa.PageMargin.Left,this.f7.Right=Fa.PageMargin.Right,this.f7.Top=Fa.PageMargin.Top,this.f7.Bottom=Fa.PageMargin.Bottom,this.f7.Header=Fa.PageMargin.Header,this.f7.Footer=Fa.PageMargin.Footer)}return Ab}sY(){if(this.Jv){for(let Fa of this.Jv)this.$&&this.$.userOperationManager&&(Fa.operation&&e.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${fb.a(Fa.operation.operationName)}.`),
this.$.userOperationManager.iua(Fa)),this.Jv.remove(Fa);this.Jv=null}}}Ma.Xhh=1;Ma.Whh=0;Ma.jKe=100;Ma.t7c=9;Ma.Dhh=!0;Object(b.a)(Ma,"PrintSettingsManager",xa,[]);var va=a(69);class Pa{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(Pa,"PrintSettingsTaskPaneCallbacks",null,[]);class Ha{constructor(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(Ha,"SelectedPrintSettings",null,[]);class tb{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}}Object(b.a)(tb,"PrintOperationCallbacks",null,[]);class Ya{constructor(){this.onBackToSheet=null}}Object(b.a)(Ya,"PrintPreviewPaneCallbacks",
null,[]);var V=a(1077);class za{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)(za,"UniversalPrintAppSettings",null,[]);var yb=a(420),jc=a(33);class Cc{constructor(Fa,Ab,$b,Cb){this.activeCell=this.selectedRange=this.tg=this.graphServiceEndpoint=null;this.jIb=0;this.pda=this.Kv=null;this.UH=new rb;this.Ok=new rb;this.jca=0;this.O8a=null;this.tOb=!1;this.b4a=this.iHb=null;this.Crd=!1;this.N7a=
this.cBb=!0;this.Oma=this.Iza=this.T8a=null;this.eAb=!1;this.L8a=null;this.b7a=this.TMc=!1;this.aOi=Rb=>{if(!(Rb&&Rb.data&&Rb.data.ue&&Rb.data.responseHeaders&&Rb.data.ue.length)){var uc=Rb?Rb.data?Rb.data.ue?Rb.data.responseHeaders?Rb.data.ue.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.tg&&(Rb=this.YRa(I.a.instance.ga(1207)),
this.DBa(Rb,0));e.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${uc}`);this.FMd&&(Rb=Object(x.a)(new fa.a,{extendedProperties:new Map}),Rb.extendedProperties.set("InvalidParameterName",uc),L.Health.instance.recordQosError(ra.a.iNf,[pa.a.jNf],!1,!0,!0,!1,Rb))}else if(0<this.jca&&Rb.data.id===this.jca){if(Rb.data.responseHeaders["Content-Type"]&&(cb.a.contains(Rb.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||cb.a.contains(Rb.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){e.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var nb=null;cb.a.contains(Rb.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(nb=this.h$g(Rb));uc={};this.cAf(nb);Rb.data.responseHeaders["Total-Pdf-PageCount"]?(nb=parseInt(Rb.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),this.eAb||(this.vHd>=nb?this.Oma=nb:this.eAb=!0),this.N7a&&this.tg&&this.tg.setPageRangeSettings(nb,this.vHd,this.eAb,
this.Iza,this.Oma)):e.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else uc=gb.a.li(Rb.data.ue),wb.a.p$(uc.Errors)||va.a(this.$).hd.sM(uc.Errors[0].MessageId),this.X$i(uc.Errors),this.tg&&(nb=this.YRa(uc.Errors[0].Description),-1831476778===uc.Errors[0].MessageId?(e.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.DBa(nb,0,I.a.instance.ga(1210))):
this.DBa(nb,0)),297284985===uc.Errors[0].MessageId?e.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${uc.Errors[0].MessageId}`):e.ULS.sendTraceTag(593266763,0,15,`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${uc.Errors[0].MessageId}`);Rb=Rb.data.state;Rb.FRe(uc,Rb.userContext,Rb.methodName)}};this.$Ni=Rb=>{if(0<this.jca&&Rb.data.id===this.jca){var uc=cc.a.Pe(Rb.data);this.tg&&this.DBa(this.YRa(uc[0].Description),
1);e.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${wb.a.sc(uc)}]`);uc=Rb.data.state;uc.cja(Rb,uc.userContext,uc.methodName);this.$.userOperationManager.Bla.operation.nBa(()=>this.tOb)}};this.yMi=Rb=>{Rb.Errors&&0<Rb.Errors.length&&this.tg?(wb.a.p$(Rb.Errors)||va.a(this.$).hd.sM(Rb.Errors[0].MessageId),this.DBa(this.YRa(Rb.Errors[0].Description),0),e.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${Rb.Errors[0].MessageId}`)):
(e.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.cAf(null))};this.xMi=Rb=>{Rb=cc.a.Pe(Rb.data);this.tg&&this.DBa(this.YRa(Rb[0].Description),1);e.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${wb.a.sc(Rb)}]`);this.$.userOperationManager.Bla.operation.nBa(()=>this.tOb)};this.zEf=(Rb,uc)=>{if(uc)switch(uc.Q4i){case 1:if(this.Ok&&this.b4a)switch(Rb=this.b4a.zc,this.b4a.stop(),
this.b4a=null,this.Ok.qA){case 1:this.r1c(Rb,4800,"ActiveSheet");break;case 0:this.r1c(Rb,6100,"CurrentSelection");break;case 2:this.r1c(Rb,7500,"EntireWorkbook")}break;case 0:this.iHb&&(Rb=this.iHb.zc,this.iHb.stop(),2400<Rb&&(uc=Object(x.a)(new fa.a,{extendedProperties:new Map}),uc.extendedProperties.set("PaneLoadTime",Rb.toString()),L.Health.instance.recordQosError(ra.a.xHj,[pa.a.t9f],!1,!0,!0,!1,uc)),this.Kv.vhi(nb=>{this.vFj(nb)}))}};this.Sz=(Rb,uc)=>{(1===uc.Kr&&this.T8a===uc.Rf||2===uc.Kr)&&
this.rNd()};this.$=Fa;this.J7b=Ab;this.v3=$b;this.hFb=Cb;this.FMd=H.HelperMethods.s_;this.Ra=new Vb.a;this.vHd=this.$.va.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.gDj();this.rei();this.Qii=this.P0g();this.nsi=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebUniversalPrintFloodgateSurvey",!1)&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",
!1);this.bI=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);if(this.isUniversalPrintEnabled=!!Cb&&Cb.PMa()&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.ie.get(116))this.graphServiceEndpoint=this.$.va.GraphServiceEndpoint;this.isExportPdfMode=!1}get Soi(){return this.TMc}SLg(Fa){this.Ra.addHandler("ppocek",Fa)}Ogj(Fa){this.Ra.removeHandler("ppocek",Fa)}uFj(Fa,Ab,$b){this.xkj();this.$.userOperationManager.ur(this.Sz);
this.pda=Fa;this.Ra.raiseEvent("ppocek");this.isExportPdfMode=$b;this.pda.SelectedRanges&&this.pda.SelectedRanges.Ranges&&0<this.pda.SelectedRanges.Ranges.length&&this.pda.SelectedRanges.Ranges[0]&&(this.selectedRange=t.B(this.pda.SelectedRanges.Ranges[0]).toString());e.ULS.shipAssertTag(537154268,0,!this.Kv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.Kv=new Ma(this,this.$,Ab,this.$.xa.oa.name,I.a.instance,this.bI);e.ULS.shipAssertTag(537154267,0,!this.tg,
"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.tg=new Y.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.tg.Mlh();this.tg.wFj(this.isExportPdfMode);this.tg.lLg(this.zEf)}bWh(){this.Kv.f7&&4<=this.Kv.marginDetailedOptions.length&&(this.Kv.marginDetailedOptions[3].marginValue=this.Kv.rxb(this.Kv.f7));return this.Kv.marginDetailedOptions}W5f(){return!!this.pda&&!!this.pda.ObjectId||!v.h(this.$).ha.ra.Og}YYh(){const Fa=Object(x.a)(new Ha,
{selectedWhatToPrint:xa.fih,selectedOrientation:xa.Qhh,selectedPaperSize:xa.t7c,selectedScaling:xa.Vhh,selectedMargin:xa.Ohh,selectedIgnorePrintArea:xa.Hhh,selectedPrintGridlines:xa.cJa.PrintGrid,selectedDraft:xa.Chh,selectedHorizontalCenter:xa.cJa.HorizontalCenter,selectedVerticalCenter:xa.cJa.VerticalCenter,selectedRowAndColumnHeadings:xa.cJa.PrintHeaders});this.UH?(Fa.selectedWhatToPrint=this.UH.qA,Fa.selectedOrientation=this.UH.orientation,Fa.selectedPaperSize=this.UH.bda,Fa.selectedScaling=this.UH.C0,
Fa.selectedMargin=this.UH.margin,Fa.selectedIgnorePrintArea=this.UH.ignorePrintArea,Fa.selectedPrintGridlines=this.UH.sheetPrintOptions.PrintGrid,Fa.selectedDraft=this.UH.C2a,this.bI&&(Fa.selectedColor=this.UH.NoColor?0:1),Fa.selectedHorizontalCenter=this.UH.sheetPrintOptions.HorizontalCenter,Fa.selectedVerticalCenter=this.UH.sheetPrintOptions.VerticalCenter,Fa.selectedRowAndColumnHeadings=this.UH.sheetPrintOptions.PrintHeaders):e.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");
return Fa}b5e(){return Object(x.a)(new Ya,{onBackToSheet:()=>{this.rma()}})}UYh(){return Object(x.a)(new V.a,{backActionButtonText:I.a.instance.ga(1206),printPreviewPaneCallbacks:this.b5e(),logger:new ka.a,disableTellMeControl:!0,isExportPdfMode:this.isExportPdfMode,printOperationCallbacks:Object(x.a)(new tb,{onClosePreviewer:()=>{this.rma()},getGraphServiceAuthorizationToken:this.mbc(),onLocalPrint:()=>{this.kFf()},onNotifyPrintJobStatus:(Fa,Ab)=>{this.onNotifyPrintJobStatus(Fa,Ab)}}),universalPrintAppSettings:Object(x.a)(new za,
{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.Xii()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})}WYh(){return Object(x.a)(new Pa,{onSettingChange:Fa=>{this.$Ti(Fa)},onPrint:()=>{this.kFf()}})}$Ti(Fa){this.jIb++;Fa?(this.tg&&this.tg.nGj(),this.Ok.qA=Fa.selectedWhatToPrint,this.Ok.C0=Fa.selectedScaling,this.Ok.orientation=Fa.selectedOrientation,this.Ok.bda=Fa.selectedPaperSize,this.Ok.margin=Fa.selectedMargin,
this.bI&&(this.Ok.NoColor=!Fa.selectedColor),this.Ok.ignorePrintArea=Fa.selectedIgnorePrintArea,this.dwj(Fa.selectedPageStart,Fa.selectedPageEnd),this.Kv&&this.p9h(this.Ok,Fa)?(this.Ok.sheetPrintOptions=xa.cJa,this.Ok.sheetPrintOptions.PrintGrid=Fa.selectedPrintGridlines,this.Ok.sheetPrintOptions.HorizontalCenter=Fa.selectedHorizontalCenter,this.Ok.sheetPrintOptions.VerticalCenter=Fa.selectedVerticalCenter,this.Ok.sheetPrintOptions.PrintHeaders=Fa.selectedRowAndColumnHeadings,this.Kv.Mhi(this.Ok.sheetPrintOptions)):
this.jod()):e.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}rma(){this.b7a&&(this.tOb=!0);e.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.jIb} times before clicking on backToWorkbook icon`);this.jFf();this.PBe()}kFf(){e.ULS.sendTraceTag(591196512,0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.jIb} times before clicking on print button.`);
e.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.Ok.margin}, Initial margin value : ${this.UH.margin}`);if(this.useMSPdfViewer)this.kNf();else if(this.N7a)try{this.tg.printPdf(),this.z2c()}catch(Fa){e.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.kNf()}else this.J7b.tFj(this.J5b(!0)),this.z2c()}kNf(){const Fa=this.J5b(!0);this.z2c();H.HelperMethods.lf(Fa,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){ta.a.Ia(this.Ra)}jod(){if(this.$.Z6a)this.shi();
else{this.sY();this.jYf();var Fa=null;this.hei();e.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.T8a=this.$.userOperationManager.Ic(new C.a(223,0,(Ab,$b,Cb)=>{Ab=new mb.a(Ab,null,$b,Cb,null,!0,!1,"GetFileCopyFileHandler","");Ab.correlationID=J.a.create().toString();Fa=Ab;this.jca=this.v3.Zga(this.J5b(this.N7a?!1:!0,this.Qii?"Base64":"Pdf"),1,null,null,Cc.GDh,!1,2,this.aOi,this.$Ni,Fa,void 0,void 0,void 0,12E4);Ab.requestId=
this.jca;e.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.jca}.`);return bb.Task.Ta(!0)},80),null)}}z2c(){this.jFf();this.PBe()}zDd(Fa){wb.a.Nq(Fa.Errors)?this.tg.showErrorMessageForPrintOptions(I.a.instance.ga(1257)):(e.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.jod(),this.tg&&this.tg.hideErrorMessageForPrintOptions())}JDd(Fa){this.tg&&this.tg.showErrorMessageForPrintOptions(I.a.instance.ga(1257));
Fa=cc.a.Pe(Fa.data);e.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${wb.a.sc(Fa)}.`)}shi(){e.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.sY();const Fa=this.$.pa.ya.Wb();this.T8a=this.$.userOperationManager.Ic(new C.a(133,0,(Ab,$b,Cb)=>{const Rb={};Rb.WhatToPrint=this.Ok.qA;Rb.UseNamedAction=this.J7b.a7f();Rb.SelectedSheetName=this.$.xa.oa.name;
Rb.ActiveCell=this.activeCell;Rb.SelectedRanges=[this.selectedRange];Rb.IsPdfDocumentRequired=!1;Rb.Orientation=this.Ok.orientation;Rb.PaperSize=this.Ok.bda;Rb.Scaling=this.Ok.C0;Rb.RichValuesEnabled=!0;Rb.IgnorePrintArea=this.Ok.ignorePrintArea;Rb.Preview=!0;this.bI&&(Rb.NoColor=this.Ok.NoColor);this.P5f()&&(Rb.PaginationStartPage=this.Iza,Rb.PaginationEndPage=this.Oma,Rb.OutputTotalPdfPageCount=!0);const uc=this.Kv.Ahd(this.Ok.margin);uc&&(Rb.PageMargin={},Rb.PageMargin.Top=uc.Top,Rb.PageMargin.Bottom=
uc.Bottom,Rb.PageMargin.Left=uc.Left,Rb.PageMargin.Right=uc.Right,Rb.PageMargin.Header=uc.Header,Rb.PageMargin.Footer=uc.Footer);return this.O8a=S(this.$.pa.ya,Rb,M.b(this.yMi,Ab),M.a(this.xMi,$b),Cb,Fa)},80),null)}PBe(){this.$.userOperationManager.ko(this.Sz);this.sY();this.jYf();e.ULS.shipAssertTag(537154261,0,!!this.tg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.isExportPdfMode=!1;this.tg&&(this.tg.rgj(this.zEf),this.tg.Vlh(),this.tg=null);this.pda=
null;this.Kv&&(this.Kv.dispose(),this.Kv=null);this.b4a=this.iHb=null;this.TMc=!1;this.Ra&&this.Ra.raiseEvent("ppocek")}bBj(){return this.$.isEditMode&&!!this.UH&&!!this.Ok&&2!==this.Ok.qA&&this.q9h()}POd(){e.ULS.shipAssertTag(537154260,0,!!this.Kv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Kv&&this.Kv.POd(this.Ok,this.bBj())}J5b(Fa,Ab="Pdf"){const $b=new Sys.StringBuilder;$b.append(Ga.a(this.$,Ab,!0));ib.a.Zk($b,Za.a.xOf,""+this.Ok.qA);Fa&&this.J7b.a7f()&&
ib.a.Zk($b,Za.a.eZj,"1");ib.a.Zk($b,Za.a.T6i,this.$.xa.oa.name);0===this.Ok.qA&&(ib.a.Zk($b,Za.a.S6i,this.selectedRange),ib.a.Zk($b,Za.a.K6i,this.activeCell));ib.a.Zk($b,Za.a.N6i,""+this.Ok.orientation);ib.a.Zk($b,Za.a.O6i,""+this.Ok.bda);ib.a.Zk($b,Za.a.R6i,""+this.Ok.C0);ib.a.Zk($b,Za.a.Q6i,"1");ib.a.Zk($b,Za.a.J6i,this.Ok.ignorePrintArea?"1":"0");ib.a.Zk($b,Za.a.P6i,"1");this.CPg($b);this.bI&&ib.a.Zk($b,Za.a.M6i,this.Ok.NoColor?"1":"0");this.BPg($b);cb.a.equals(Ab,"Pdf",!0)&&($b.append("&#toolbar=0"),
$b.append("&zoom=100"));Fa=$b.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");e.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${Fa}`);return Fa}dwj(Fa,Ab){Fa||Ab?(this.eAb=!0,this.Iza=Fa,this.Oma=Ab):this.wXf()}CPg(Fa){this.P5f()&&(ib.a.Zk(Fa,Za.a.V6i,""+this.Iza),ib.a.Zk(Fa,Za.a.U6i,""+this.Oma),ib.a.Zk(Fa,Za.a.W6i,"1"),e.ULS.sendTraceTag(537154258,0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.Iza} to ${this.Oma}`))}P5f(){return null!=
this.Iza&&0<this.Iza&&null!=this.Oma&&0<this.Oma}BPg(Fa){if(this.Kv&&this.Ok){const Ab=this.Kv.Ahd(this.Ok.margin);Ab&&ib.a.Zk(Fa,Za.a.L6i,""+Ab.Top+" "+Ab.Bottom+" "+Ab.Left+" "+Ab.Right+" "+Ab.Header+" "+Ab.Footer)}}cAf(Fa){this.tg&&(e.ULS.shipAssertTag(537154255,0,!!this.$.xa.oa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.xa.oa&&(this.N7a?(Fa||(Fa=this.J5b(!1)),this.tg.fxi(Fa)):this.oFj()))}q9h(){return!this.UH.equals(this.Ok)}jFf(){!this.tOb&&
0<this.jIb&&(this.Crd?this.POd():e.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));e.ULS.shipAssertTag(537154250,0,!!this.tg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.tg&&this.tg.A$h()}vj(){e.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.tg){var Fa=this.YRa(I.a.instance.ga(1));this.DBa(Fa,1)}else Fa=wb.a.Zc(1,0,26,
0,1,-1100324317,"GetPrintSettingsFailedError"),w.EwaSettings.Iz()?new xb.a(this.$,Fa):(new ic.ErrorDialog(this.$,Fa)).vg()}vFj(Fa){Fa?(0===Fa.qA&&this.W5f()&&(e.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.pda.ObjectId?"floatingObject":"discontinuousRange"}.`),Fa.qA=1),rb.UFe(Fa,this.UH),rb.UFe(Fa,this.Ok),e.ULS.shipAssertTag(537154248,0,!!this.tg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),
this.tg&&(this.Crd=!0,this.tg.xFj(),this.jod())):(e.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.vj())}r1c(Fa,Ab,$b){Fa>Ab&&(Ab=Object(x.a)(new fa.a,{extendedProperties:new Map}),Ab.extendedProperties.set("WtpSelectedValue",$b),Ab.extendedProperties.set("FullyRenderedPdfLoadTime",Fa.toString()),L.Health.instance.recordQosError(ra.a.wHj,[pa.a.t9f],!1,!0,!0,!1,Ab))}sY(){this.T8a&&(0<this.jca||this.O8a)&&(e.ULS.sendTraceTag(537154246,
0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.jca}.`),this.$.userOperationManager.iua(this.T8a),this.O8a?cc.a.Ru(this.O8a.lu):this.v3.Ru(this.jca),this.rNd())}rNd(){this.O8a=this.T8a=null}hei(){this.FMd&&this.Ok&&(this.b4a=this.$.Jb.Ac("UserAction",(1===this.Ok.qA?"ActiveSheet":0===this.Ok.qA?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}wXf(){this.eAb=!1;this.Iza=1;this.Oma=this.vHd}YRa(Fa){if(Fa)return Fa.replace("&#39;",
"'");e.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return Fa}oFj(){e.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.cBb)e.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{let Fa=this.YRa(I.a.instance.ga(1212));this.DBa(Fa,3)}}DBa(Fa,Ab,$b=null){this.tg.fA(Fa,Ab,$b)}rei(){this.N7a=this.cBb=!0;e.ULS.sendTraceTag(557061534,
0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.cBb}, isPdfPreviewSupportedInPreviewer: ${this.N7a}`)}xkj(){this.L8a=null;this.rNd();this.wXf();this.iHb=this.$.Jb.Ac("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.oa.activeCell.toString();this.jIb=0;this.Crd=this.b7a=this.tOb=!1;this.TMc=!0}gDj(){const Fa=this.Mri()||this.asi();e.ULS.sendTraceTag(537154242,0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${Fa}`);return Fa}P0g(){let Fa=
15;qa.a.$H&&qa.a.bub&&(Fa=parseFloat(qa.a.bub));return 14<Fa&&this.cBb}Mri(){var Fa;if(w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ModifyTeamsHostCheck",!1)){const Ab="teams"===(null===(Fa=f.AFrameworkApplication.fa.appSettings[f.AFrameworkApplication.o8])||void 0===Fa?void 0:Fa.toLowerCase());e.ULS.sendTraceTag(512350017,0,50,`PrintPreviewManager:isTeamsHost - isElectron: ${qa.a.Ez} isTeamsUIHost: ${Ab} isUnifiedHostMode: ${f.AFrameworkApplication.isUnifiedHostMode}`);return qa.a.Ez||
Ab}return qa.a.Ez||f.AFrameworkApplication.isUnifiedHostMode}asi(){return!this.$.ie.get(111)}jYf(){this.L8a&&(URL.revokeObjectURL(this.L8a),this.L8a=null)}h$g(Fa){var Ab=Fa.data.ue;Fa=this.$.Jb.Ac("UserAction","PrintPreviewBlobFileCreation");var $b=window.self.atob(Ab);Ab=new Uint8Array(Ab.length);for(let Cb=0;Cb<$b.length;Cb++)Ab[Cb]=$b.charCodeAt(Cb)&255;$b=new Blob([Ab],{type:"application/pdf"});this.L8a=URL.createObjectURL($b);e.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${Fa.zc} ms. Blob size: ${$b.size}`);
Fa.stop();return this.L8a+"#toolbar=0&zoom=100"}X$i(Fa){if(this.FMd&&wb.a.dh(Fa,Cc.I0i)){const Ab=Object(x.a)(new fa.a,{extendedProperties:new Map});Ab.extendedProperties.set("ErrorMessageIdName",Fa[0].MessageIdName);L.Health.instance.recordQosError(ra.a.iNf,[pa.a.jNf],!1,!0,!0,!1,Ab)}}p9h(Fa,Ab){return Fa.sheetPrintOptions.PrintGrid!==Ab.selectedPrintGridlines||Fa.sheetPrintOptions.HorizontalCenter!==Ab.selectedHorizontalCenter||Fa.sheetPrintOptions.VerticalCenter!==Ab.selectedVerticalCenter||Fa.sheetPrintOptions.PrintHeaders!==
Ab.selectedRowAndColumnHeadings}bRj(){this.nsi&&this.$.Xc(1936706533,-1,0,null)}Xii(){return!!this.$.va&&!!this.$.va.DocumentHostInfo&&"TestHost"===this.$.va.DocumentHostInfo.HostTier}getToken(){e.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.hFb.PL("Print",this.graphServiceEndpoint).then(Fa=>Fa?(Fa.IsSuccess?e.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):
e.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${Fa.ErrorCode}, Error message : ${Fa.ErrorMessage}`),Fa):Object(x.a)(new lb.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(Fa=>{let Ab=new lb.a;Object.getType(Fa)===Object.getType(Ab)?Ab=Fa:(Ab.ErrorMessage=Fa.toString(),Ab.ErrorCode="exception");return Promise.resolve(Ab)})}mbc(){return()=>{const Fa=Promise.resolve("");try{if(this.hFb&&this.hFb.PMa())return this.getToken().then(Ab=>
Ab.IsSuccess?Promise.resolve(Ab.Token):Fa,()=>Fa)}catch(Ab){e.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return Fa}}onNotifyPrintJobStatus(Fa,Ab){Fa=yb.a.yC.notificationBar.K3(Fa,!1);"pending"==Ab&&(Fa.displayTimeoutSeconds=3,this.bRj());if(jc.a.U7a())switch(Ab){case "failure":Fa.image=1;break;case "success":Fa.image=3;break;default:Fa.image=0}else Fa.image=0;yb.a.yC.notificationBar.zC(Fa)}}Cc.I0i=[-953554093,1773721536,-1104435974,
-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];Cc.GDh=["Content-Type","Total-Pdf-PageCount"];Object(b.a)(Cc,"PrintPreviewManager",null,[657,2,658]);class Sa{constructor(Fa,Ab,$b){this.ignorePrintArea=!1;this.xQj=()=>{const Cb=v.h(this.$).Ea;this.vSc=!0;Cb.OAd()};this.ETi=()=>{this.lkd()};this.DTi=(Cb,Rb,uc)=>{e.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${uc} failed to execute`);
this.lkd()};this.$=Fa;this.ea=Fa.ea;this.J7b=Ab;this.Pab=new z(1,this.ignorePrintArea);this.VD=Ab=new Cc(Fa,Ab,f.AFrameworkApplication.Dd,$b);this.$.da.Ga(418,Ab);this.gNf=new wa(Fa);this.$.da.Ga(384,this);this.vSc=!1}get Z5f(){return this.vSc}nc(){return!1}executeCommand(Fa,Ab,$b,Cb){const Rb=Ab.command;return 1588554917===Rb||1531172830===Rb||-2050819419===Rb?(Ab.pAb=!0,B.a(this.$)&&this.$.da.za(423).vzc(!1),this.vmh(Ab)?bb.Task.Ta(!0):r.a(Rb)):this.gNf.executeCommand(Fa,Ab,$b,Cb,this.ETi,this.DTi,
this.xQj)}wc(Fa,Ab){switch(Ab.command){case 1588554917:return e.ULS.shipAssertTag(537154305,0,this.$.$ka,"Command execute requested for Print operation when data duplication is disallowed."),!0;case 1531172830:return w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExportToPdf",!1)&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);case -2050819419:return w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SaveAsPDF",!1)&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",
!1);default:return this.gNf.wc(Fa,Ab)}}Kc(){return!1}vmh(Fa){return this.$.ea.Zb?this.wmh(Fa):!1}wmh(Fa){e.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");const Ab=this.$.Jb.Ac("UserAction","DoPrintHtml");var $b=this.$;$b=this.RYh($b,this.ea.isNamedObjectViewMode?$b.Cb.oa.sheetName:$b.xa.oa.name);if(A.a(this.$))e.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened.");else{const Cb=1531172830===Fa.command||-2050819419===Fa.command;
this.VD.uFj($b,this.Pab,Cb);e.ULS.sendTraceTag(591196515,0,50,`PrintCommandHandler:DoPrintHtml Print previewer opened. isExportPdfMode: ${Cb} Command: ${n.a[Fa.command]}`)}Ab.stop();this.lkd();return!0}RYh(Fa,Ab){const $b={};$b.SessionId=this.ea.sessionId;$b.UsedRangeTooBig=!1;var Cb=v.h(Fa),Rb=Cb.ha;const uc=Rb.Oe;if(y.e(Fa.oa))$b.Type=0,$b.ObjectId=Fa.oa.name,$b.UseSelection=!1;else if(y.g(Fa.oa))$b.Type=1,$b.ObjectId=Fa.oa.imageId,$b.UseSelection=!0;else if(2===uc||4===uc||64===uc)Cb=Rb.Sa.$b.floatingObject,
$b.Type=1,$b.SheetName=Ab,$b.ObjectId=Cb.id,$b.UseSelection=!0;else if(uc&470)$b.ObjectId=Rb.Sa.$b.floatingObject.id,$b.SheetName=Ab;else if(y.i(Fa.oa)){$b.Type=2;$b.SheetName=Ab;if(Rb.ra.Og)if(Rb=Rb.ra.$c,$b.SelectedRanges=t.q(Rb,Fa),20<Rb.qH)$b.UseSelection=!0;else{Ab=0;Cb=Cb.kk("PrintCommandHandler.DoPrintHtml",Rb);try{for(Cb.$$rst();Cb.$$mn()&&2>Ab;)Cb.$$cu().text&&Ab++;$b.UseSelection=2<=Ab}finally{Cb&&Cb.dispose()}}else $b.UseSelection=!1,$b.SelectedRanges=t.q(Rb.ra.activeRange,Fa);this.ea.isNamedObjectViewMode&&
($b.UsedRange=t.v(Fa.oa.usedRange,Fa))}$b.Title=Fa.workbookContext.WorkbookFileName;return $b}lkd(){v.h(this.$);if(!this.Z5f){this.vSc=!0;const Fa=this.$.Jb.Ac("UserAction","HandlePageLayoutRendering");this.LQj();e.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${Fa.zc} ms.`);Fa.stop()}}LQj(){const Fa=v.h(this.$).Ea,Ab=Fa.nD();let $b=!1,Cb=0;for(let Rb=0;Rb<Ab.length;Rb++){const uc=Ab[Rb],nb=uc.sf;nb&&nb.hasPageLayout()&&($b=!0,nb.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+
uc.zd,4),Cb++)}$b&&(e.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${Ab.length}, number of blocks that require re-rendering is ${Cb}`),Fa.OAd())}}Object(b.a)(Sa,"PrintCommandHandler",null,[223,633]);var na=a(1076),jb=a(1289),Ib=a(1290);class dc extends h.a{constructor(Fa){super(Fa)}ld(){var Fa=f.AFrameworkApplication.fa.appSettings,Ab=this.$.va.DirectPrintSetting;Fa.DirectPrintIsEnabled=Ab.DirectPrintIsEnabled.toString();Fa.DirectPrintProbeIsEnabled=
Ab.DirectPrintProbeIsEnabled.toString();Fa.DirectPrintEnabledForInternetExplorer=Ab.DirectPrintEnabledForInternetExplorer.toString();Fa.DirectPrintSupportedMimeTypes=Ab.DirectPrintSupportedMimeTypes;Fa.DirectPrintSupportedPlugins=Ab.DirectPrintSupportedPlugins;Fa.DirectPrintImmersivePreviewPlugins=Ab.DirectPrintImmersivePreviewPlugins;Fa.DirectPrintMinimalSupportedEdgeVersion=Ab.DirectPrintMinimalSupportedEdgeVersion;Fa.DirectPrintEnabledForEdge=Ab.DirectPrintEnabledForEdge.toString();Fa=new na.a(Fa);
let $b=null;Ab=null;try{Ab=window.navigator.mimeTypes}catch(Rb){e.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let Cb=null;try{Cb=window.navigator.plugins}catch(Rb){e.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}$b=new Ib.a(Fa,Ab,Cb,Ib.a.Zgf,Ib.a.ulf,new jb.a(f.AFrameworkApplication.sa.qX),f.AFrameworkApplication.sa.iE,Ib.a.vlf,(Rb,uc)=>new d.a(Rb,!1,uc),!1);if(w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&
w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.ie.get(116)){const Rb=m.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Ya);l.TaskExtensions.Aa(Rb,()=>{const uc=new Sa(this.$,$b,Rb.result);this.Yc([uc])},this.$.la)}else this.Yc([new Sa(this.$,$b,null)])}static ka(Fa){h.a.Nd(73,new dc(Fa))}}Object(b.a)(dc,"PrintCommandHandlerFactory",h.a,[]);a.d(E,"a",function(){return ob});const ob=()=>{c.a.Fa(dc.ka)}},1147:function(u,E,a){var c=a(9),b=
a(0),e=a(222),f=a(50),d=a(37),h=a(15),m=a(87),l=a(83),w=a(242),n=a(620),y=a(207),t=a(116),r=a(35),v=a(40),B=a(238),A=a(44),z=a(6),x=a(36),D=a(69),J=a(589);class L extends B.a{constructor(ob,Fa){super(ob);this.$Yj=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.TFb=()=>{const Ab=this.ZRh();if(Ab){this.$.CI(!0);if(-2028960985!==this.command&&1461300262!==this.command){const $b=D.a(this.$).hd.activityState;$b[x.a.kZa]=z.a.download;$b[J.a.oVc]=this.command}A.a(this.$).Pr(Ab.Errors)}};
this.iframe=ob;this.$=Fa;this.Gc.ka("load",this.TFb)}get Yai(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(ob,Fa){const Ab={};(ob=this.JCh(ob,Ab))&&v.a.Orc("dlfr",ob,Ab);this.command=Fa}JCh(ob,Fa){var Ab=ob.split("?");if(2!==Ab.length)return ob=null,h.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),ob;Ab=Ab[1].split("&");for(const Cb of Ab){var $b=
Cb.split("=",2);if(2!==$b.length){ob=null;h.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}Ab=$b[0];this.$Yj.includes(Ab)&&($b=decodeURIComponent($b[1]),Fa[Ab]=$b,ob=y.a.EJb(ob,Ab))}return ob}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}ZRh(){try{return this.iframe.contentWindow.ewaResult}catch(ob){if(!this.$.ea.dc.isDivSyndicated){const Fa=window.document.referrer.match(RegExp("://(.[^/]+)/"));
h.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<Fa.length?Fa[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.Z6a}`);throw ob;}return null}}static Qve(ob){let Fa=document.createElement("iframe");Fa.id="ewaFileLoader";Fa.style.cssText="height:0;width:0;display:none";Fa.src="about:blank";Fa.setAttribute("name","dlfr");Fa=ob.domElement.appendChild(Fa);return new L(Fa,
ob)}}Object(b.a)(L,"FileLoader",B.a,[]);var T=a(143),O=a(55);class G{constructor(ob,Fa){this.Tc=()=>{r.a.xg(D.a(this.$).hd.activityState,T.a.mBd)||this.hva.reset()};this.$=Fa;this.Vlc=ob;this.ea=Fa.ea;this.ea.Uj(this.Tc);this.hva=L.Qve(this.$)}bnh(){const ob=this.uXg(this.$),Fa=this.$.userOperationManager.operationCount;0<Fa&&h.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${Fa}`);this.$.userOperationManager.u4("DownloadACopyOperation.DownloadForkedFile");this.Vlc&&h.ULS.sendTraceTag(537154821,
0,50,"DownloadACopyOperation - Dataloss scenario");this.hva.downloadFile(ob,-21742208);d.TaskExtensions.Aa(O.Task.delay(1),()=>{this.qcf()},this.hva.la,3)}dispose(){this.ea&&this.ea.uk(this.Tc);this.$=this.ea=null}qcf(ob=null){ob||(ob=this.$.Jb.Ac("LoadResource","DownloadACopyOperation"));!this.hva.Yai&&ob.zc<G.Atf?window.setTimeout(()=>{this.qcf(ob)},G.cnh):(ob.zc>=G.Atf&&h.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),D.a(this.$).hd.MM())}uXg(ob){const Fa=new Sys.StringBuilder,
Ab=ob.workbookContext,$b=ob.va;Fa.append(ob.Pna);Fa.append($b.FileHandlerRelativeUri);Fa.append("?id=");Fa.append(encodeURIComponent(y.a.EJb(Ab.WorkbookUri,"sc")));ob.ea.Zb&&(Fa.append("&sessionId="),Fa.append(encodeURIComponent(ob.ea.sessionId)));Fa.append("&workbookType=FullForkedWorkbook");Fa.append("&dataloss=");Fa.append(this.Vlc?"true":"false");t.a.Uob(Fa,$b);return Fa.toString()}}G.Atf=1E5;G.cnh=100;Object(b.a)(G,"DownloadACopyOperation",null,[2]);class C extends w.a{constructor(ob,Fa,Ab=!1){super(ob,
Fa);this.JDb=null;this.ADd=$b=>{this.unsubscribe(Cb=>{$b.remove_disposing(Cb)});this.ih(z.a.Vj);this.Jp()};this.Vlc=Ab}execute(ob){const Fa=Object(l.a)(7,ob.Ge);if(!Fa.$ka)return h.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.lod(ob),this.ih(z.a.idle),1;this.JDb||(this.JDb=new G(this.Vlc,Fa));this.JDb.bnh();h.ULS.shipAssertTag(537154817,0,3!==D.a(Fa).fi.yu,"The current activity should not be closed.");return 1}lod(ob){const Fa=
Object(l.a)(7,ob.Ge),Ab=new n.a(Fa);this.subscribe(ob,this.ADd,$b=>{Ab.add_disposing($b)});h.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Ab.initialize();Ab.vg()}dispose(){m.a.Ia(this.JDb);this.JDb=null;super.dispose()}}Object(b.a)(C,"DownloadAForkedCopyActivity",w.a,[]);class H extends e.a{constructor(ob){super();this.$=ob;this.Fb()}create(){d.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),
()=>{this.ob(new C(z.a.B2a,z.a.Vj,!0))},this.la)}}Object(b.a)(H,"DownloadACopyPreDatalossActivityFactory",e.a,[]);class I extends e.a{constructor(ob){super();this.$=ob;this.Fb()}create(){d.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),()=>{this.ob(new C(z.a.unmergeableDownloadCopy,z.a.$oa))},this.la)}}Object(b.a)(I,"DownloadAForkedCopyActivityFactory",e.a,[]);var M=a(84),Q=a(4),U=a(80),N=a(27),W=a(105),X=a(25);class sa{constructor(ob,Fa,Ab){this.La=ob;this.Ewg=Fa;
this.g2=Ab}Hg(){this.La.Nb(X.a.tryMacOffice,W.a.frame,Object(M.a)(this,this.AXi,"onTryMacOffice"));this.La.Nb(X.a.Oeg,W.a.frame,Object(M.a)(this,this.oIf,"onTryMacOfficeFromViewer"));this.La.Nb(X.a.Neg,W.a.frame,Object(M.a)(this,this.oIf,"onTryMacOfficeFromViewer"))}AXi(ob,Fa,Ab,$b,Cb){if(1===Ab)return 32;Cb?(ob=Cb.SourceControlId,"btnjTryMacOfficeForWordEditor"===ob?v.a.lf(U.a.QZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===ob&&v.a.lf(U.a.QZ(22),"_blank",
void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.yof();return 32}oIf(ob,Fa,Ab){if(1===Ab)return 32;switch(ob){case X.a.Oeg:v.a.lf(U.a.QZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case X.a.Neg:v.a.lf(U.a.QZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}yof(){v.a.lf(sa.VBi,"_blank",void 0,"LaunchMacTrialWindow")}get Syc(){return this.Ewg&&N.a.isMac&&!N.a.Loi&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get BBj(){return this.Syc}static get VBi(){return U.a.NH("522401")}}
Object(b.a)(sa,"MacOfficeOffer",null,[218]);var da=a(82);class S{constructor(ob,Fa,Ab){this.La=ob;this.Iwg=Fa;this.DGc=null;(this.OYb=Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&da.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute($b=>{this.DGc=$b});this.g2=Ab}Hg(){this.La.Nb(X.a.tryOffice,W.a.frame,Object(M.a)(this,this.BXi,"onTryOffice"));this.La.Nb(X.a.tryOfficeThroughTellMe,
W.a.frame,Object(M.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Nb(X.a.Reg,W.a.frame,Object(M.a)(this,this.Seg,"tryOfficeThroughViewer"));this.La.Nb(X.a.Qeg,W.a.frame,Object(M.a)(this,this.Seg,"tryOfficeThroughViewer"))}BXi(ob,Fa,Ab,$b,Cb){if(this.OYb&&1===Ab)return this.isFreemiumUpsellEnabled&&this.dNb?32:8;2===Ab&&(Cb?(ob=Cb.SourceControlId,"btnjTryOfficeForWordEditor"===ob?v.a.lf(U.a.QZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===
ob?v.a.lf(U.a.QZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Xkc()):this.Xkc());return 32}tryOfficeThroughTellMe(ob,Fa,Ab,$b,Cb){if(this.OYb&&1===Ab)return this.isFreemiumUpsellEnabled&&this.dNb?32:8;2===Ab&&(Cb?(ob=Cb.SourceControlId,v.a.lf(U.a.NH("862405")+this.XXh(ob),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):v.a.lf(U.a.NH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}Seg(ob,Fa,Ab){if(this.OYb&&1===Ab)return this.isFreemiumUpsellEnabled&&
this.dNb?32:8;if(2===Ab)switch(ob){case X.a.Reg:v.a.lf(U.a.QZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case X.a.Qeg:v.a.lf(U.a.QZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get jxf(){return this.dNb}get gJi(){return this.dNb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get dNb(){return this.Iwg&&!N.a.isMac}get isFreemiumUpsellEnabled(){let ob=!1;this.DGc&&(ob=this.DGc.isFreemiumUpsellEnabled());return ob}Xkc(ob=null){let Fa=0;ob&&(Fa=ob);v.a.lf(S.IVh(Fa),"_blank",void 0,
"LaunchOfficeOffer")}XXh(ob){let Fa=0;switch(ob){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":Fa=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":Fa=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":Fa=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":Fa=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":Fa=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":Fa=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":Fa=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":Fa=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":Fa=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":Fa=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":Fa=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":Fa=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":Fa=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":Fa=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":Fa=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":Fa=
26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":Fa=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":Fa=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":Fa=29}return 0===Fa?"":String.format("&pc={0:D}",Fa)}static IVh(ob){if(N.a.Yg)switch(ob){case 1:return U.a.NH("393806");case 2:return U.a.NH("393810");case 3:return U.a.NH("393809");case 5:return U.a.NH("393805")}else if(N.a.Ap)switch(ob){case 1:return U.a.NH("521979");case 3:return U.a.NH("521980");case 5:return U.a.NH("521978");
case 2:return U.a.NH("522490")}else{if(2===ob)return U.a.NH("517778");if(1===ob)return U.a.QZ(30)}return U.a.NH("522402")}}Object(b.a)(S,"OfficeTrialExperience",null,[217]);class oa{Wh(ob){ob.register(S,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").xc().Fc(()=>new S(Q.AFrameworkApplication.ub,Q.AFrameworkApplication.ZAb,Q.AFrameworkApplication.lcid));ob.register(sa,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").xc().Fc(()=>new sa(Q.AFrameworkApplication.ub,
Q.AFrameworkApplication.nic,Q.AFrameworkApplication.lcid))}}Object(b.a)(oa,"OpenInClientConfiguration",null,[5]);var K=a(552),ea=a(1359),ya=a(38),ha=a(1194),La=a(146),Ia=a(152),ra=a(224),pa=a(14),ba=a(85),fa=a(107),Ka=a(86);const aa=ob=>{for(let Fa=0;Fa<ob.children.length;Fa++){const Ab=ob.children[Fa];Ab.style.position="relative";Ab.style.top=(Ab.parentNode.offsetHeight-Ab.offsetHeight)/2+"px"}},ja=ob=>ob.Ca.keyCode===ba.a.Lh||ob.Ca.keyCode===ba.a.$ea?(ob.Gb.click(),!0):!1,Va=(ob,Fa,Ab,$b,Cb,Rb,
uc)=>{const nb=document.createElement("a");nb.className="ProtocolLaunchingDialogButtonAnchor";nb.className+=" OICDialog";nb.id=ob;nb.setAttribute(Ka.a.Ld,Ka.a.ot);nb.style.padding="0";nb.style.margin="0";$b&&bb(Cb,Fa,Ab,$b,nb);ob=document.createElement("span");ob.className="ProtocolLaunchingDialogButtonLabel";ob.innerText=Cb;nb.appendChild(ob);nb.tabIndex=0;Rb&&ra.a.instance.ta(pa.a.click,nb,Rb);uc&&fa.KeyInputManager.instance.ta(pa.a.Fd,nb,uc);return nb},bb=(ob,Fa,Ab,$b,Cb)=>{var Rb=document.createElement("img");
Rb.alt=ob;Rb.className=Ia.getImageClassWithCluster(Ab,$b);Rb.src=Fa;Rb.setAttribute(Ka.a.Ld,Ka.a.cs);ob=document.createElement("span");ob.className="ProtocolLaunchingDialogImg32Container";ob.appendChild(Rb);Rb=document.createElement("span");Rb.className="ProtocolLaunchingDialogIconContainer";Rb.appendChild(ob);Cb.appendChild(Rb)};class wa{static get qg(){return La.a.gq(wa.ol,CommonUIStrings.l_OICLaunchDialogTitle)}}wa.ol="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(wa,"OICLaunchDialogHtml",null,[]);class ka extends La.a{constructor(ob){super();this.QVa=this.vDa=null;this.iqa=!1;this.Eq=ob;this.qg=wa.qg;this.Rb=5;this.Fe="OICLaunchDialog";this.showDialog("",Object(M.a)(this,this.tJi,"oicLaunchDialogResultHandler"));this.s3f();this.eX("ProtocolLaunchingDialogTitle");4!==Q.AFrameworkApplication.sa.Pa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.RI(this.vDa);h.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Q$a(){this.vDa=Va("BtnRichClient",this.Eq.Itb,this.Eq.fzb,this.Eq.Bmd,CommonUIStrings.l_OICLaunchRichClient,Object(M.a)(this,this.dGf,"onRichClientButtonClick"),ja);document.getElementById("OICLaunchRichClient").appendChild(this.vDa);aa(this.vDa);this.QVa=Va("BtnReturn",this.Eq.Itb,this.Eq.fzb,this.Eq.Dcf,CommonUIStrings.l_OICReturnToOnlineClient,Object(M.a)(this,this.aGf,"onReturnButtonClick"),
ja);document.getElementById("OICReturnToApp").appendChild(this.QVa);aa(this.QVa)}aGf(){this.hide();this.Eq.$cb();return!0}dGf(){h.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();Q.AFrameworkApplication.ub.processAction(X.a.IRa,2);return!0}tJi(){this.Eq.$cb()}dispose(){this.iqa||(this.vDa&&(ra.a.instance.Ba(pa.a.click,this.vDa,Object(M.a)(this,this.dGf,"onRichClientButtonClick")),fa.KeyInputManager.instance.Ba(pa.a.Fd,this.vDa,ja)),this.QVa&&(ra.a.instance.Ba(pa.a.click,
this.QVa,Object(M.a)(this,this.aGf,"onReturnButtonClick")),fa.KeyInputManager.instance.Ba(pa.a.Fd,this.QVa,ja)),super.dispose(),this.iqa=!0)}}Object(b.a)(ka,"OICLaunchDialog",La.a,[]);class ta{static get qg(){return La.a.gq(ta.ol,CommonUIStrings.l_OICDialogTitle)}}ta.ol="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(ta,"ProtocolLaunchingDialogV2Html",null,[]);a(418);var qa=a(106);class rb extends La.a{constructor(ob){super();this.PVa=this.nfa=null;this.iqa=!1;this.Opa=null;this.Eq=ob;this.qg=ta.qg;this.Rb=5;this.Fe="ProtocolLaunchingDialog";this.JIc="OICRetryDialog";Q.AFrameworkApplication.Gi.U5a&&Q.AFrameworkApplication.Gi.wvc();Q.AFrameworkApplication.Gi.Eg(new qa.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(M.a)(this,this.aId,"protocolLaunchingDialogResultHandler"));
this.s3f();this.eX("Issues");this.YXe();h.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Q$a(){const ob=document.getElementById("Issues");if(ob){bb("",this.Eq.Itb,this.Eq.fzb,this.Eq.Bmd,ob);const Fa=document.createElement("span");Fa.className="WACDialogSectionTitle";Fa.innerText=5===this.Eq.gJf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;ob.appendChild(Fa);aa(ob);ob.style.display="none"}Q.AFrameworkApplication.sa.Pa.Ajd?
(this.PVa=Va("GiveFeedback",this.Eq.Itb,this.Eq.fzb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(M.a)(this,this.Roc,"onGiveFeedbackClick"),Object(M.a)(this,this.lCf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.PVa),aa(this.PVa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===Q.AFrameworkApplication.sa.Pa.editMode||Q.AFrameworkApplication.Mkh?document.getElementById("ButtonEdit").style.display="none":
(this.nfa=Va("Edit",this.Eq.Itb,this.Eq.fzb,"",2===Q.AFrameworkApplication.sa.Pa.Gj?4===Q.AFrameworkApplication.sa.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===Q.AFrameworkApplication.sa.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(M.a)(this,this.QAf,"onEditClick"),Object(M.a)(this,this.UAf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.nfa),aa(this.nfa));0===
Q.AFrameworkApplication.sa.Pa.editMode&&!Q.AFrameworkApplication.ZAb&&ob&&(ob.style.display="none")}$Xe(){return this.Opa?(this.RI(this.Opa),!0):!1}YXe(){return this.nfa?(this.RI(this.nfa),!0):!1}UAf(ob){return this.JBd(ob,0)}lCf(ob){return this.JBd(ob,2)}$Ff(ob){return this.JBd(ob,1)}JBd(ob,Fa){let Ab=!1;if(ob.Ca.keyCode===ba.a.Lh||ob.Ca.keyCode===ba.a.$ea)ob.Gb.click(),Ab=!0;else if(ob.Ca.keyCode===Sys.UI.Key.down||ob.Ca.keyCode===Sys.UI.Key.up)switch(Fa){case 1:Ab=this.YXe();break;case 0:Ab=this.$Xe()}return Ab}QAf(){this.hide();
4===Q.AFrameworkApplication.sa.Pa.editMode?(h.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Eq.$cb()):(h.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Eq.Yjd());return!0}Roc(){h.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Eq.v9e();return!0}Qpc(){h.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";Q.AFrameworkApplication.ub.processAction(X.a.IRa,2);return!0}aId(){this.Eq.$cb()}switchToBackupMode(){var ob=
document.getElementById("ProtocolLaunchingDialogTitle");if(ob){ob.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(ob=document.getElementById("Issues"))ob.style.display="block";(ob=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!ob.children.length&&(this.Opa=Va("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(M.a)(this,this.Qpc,"onRetryOICClick"),Object(M.a)(this,this.$Ff,"onRetryOICKeyUp")),ob.appendChild(this.Opa),aa(this.Opa),this.nfa||this.$Xe())}}dispose(){this.iqa||(this.nfa&&
(ra.a.instance.Ba(pa.a.click,this.nfa,Object(M.a)(this,this.QAf,"onEditClick")),fa.KeyInputManager.instance.Ba(pa.a.Fd,this.nfa,Object(M.a)(this,this.UAf,"onEditKeyUp"))),this.PVa&&(ra.a.instance.Ba(pa.a.click,this.PVa,Object(M.a)(this,this.Roc,"onGiveFeedbackClick")),fa.KeyInputManager.instance.Ba(pa.a.Fd,this.PVa,Object(M.a)(this,this.lCf,"onGiveFeedbackKeyUp"))),this.Opa&&(ra.a.instance.Ba(pa.a.click,this.Opa,Object(M.a)(this,this.Qpc,"onRetryOICClick")),fa.KeyInputManager.instance.Ba(pa.a.Fd,
this.Opa,Object(M.a)(this,this.$Ff,"onRetryOICKeyUp"))),super.dispose(),this.iqa=!0)}}Object(b.a)(rb,"ProtocolLaunchingDialog",La.a,[]);var Za=a(134),gb=a(424);class mb extends Za.StandardDialog{constructor(ob){super();this.Eq=ob;this.Fe="ProtocolLaunchingDialog";Q.AFrameworkApplication.Gi.U5a&&Q.AFrameworkApplication.Gi.wvc();Q.AFrameworkApplication.sa.Pa.Ajd&&this.Foe(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(M.a)(this,this.Roc,"onGiveFeedbackClick"));mb.u$e?(this.Rb=12,this.oc(1,
CommonUIStrings.l_CloseFile),this.oc(2,CommonUIStrings.l_OICDialogContinueHere),this.oc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Rb=4,this.oc(1,CommonUIStrings.l_OICDialogContinueHere),this.oc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.jEb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Eq.gJf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(M.a)(this,this.aId,"protocolLaunchingDialogResultHandler"),null)}Roc(ob){h.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.lBf(ob)}Qpc(){h.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");Q.AFrameworkApplication.ub.processAction(X.a.IRa,2)}aId(ob){mb.u$e?3===ob?this.bYf():2===ob||0===ob?this.continueEditing():1===ob&&this.v3g():2===ob?this.bYf():(1===ob||0===ob)&&this.continueEditing()}v3g(){h.ULS.sendTraceTag(577783557,211,50,"Closing the document");Q.AFrameworkApplication.ub.ae(X.a.close,2,gb.a)}bYf(){h.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(M.a)(this,
this.Qpc,"onRetryOICClick"),0)}continueEditing(){4===Q.AFrameworkApplication.sa.Pa.editMode||Q.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===Q.AFrameworkApplication.sa.mode?(h.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Eq.$cb()):(h.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Eq.Yjd())}static get u$e(){return Q.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===Q.AFrameworkApplication.ub.processAction(X.a.close,
1)}}Object(b.a)(mb,"StandardProtocolLaunchingDialog",Za.StandardDialog,[]);var Ga=a(1240);class ib{}Object(b.a)(ib,"EditDocumentInClientParams",null,[]);class cc{static d9c(ob,Fa,Ab,$b,Cb,Rb,uc=!1,nb=!1,Fb="",Jc=!1,Fc=!1,zb=!1,hb="",Pb="",ud="",Ub=!1){const Ac=new ib;Ac.DocumentUrl=ob;Ac.Mode=Fa;Ac.Options=Ab;Ac.Application=$b;Ac.SilentExternalHandler=uc;Ac.EncodeUrl=nb;Ac.CorrelationIdForWinClient=Fb;Ac.NavigateUsingWindowOpen=Jc;Ac.DescriptiveUnattemptedEnums=Fc;Ac.NoBrowserModalDialogs=zb;Ac.SessionOrigin=
hb;Ac.CorrelationId=Pb;Ac.ClickTime=ud;Ac.NewTelemetryDataIsEnabled=Ub;MSOJS.ClientUtils.EditDocumentInClient(Ac,Cb,Rb)}}Object(b.a)(cc,"ClientUtils",null,[]);var ic=a(97),xb=a(145),Vb=a(473),wb=a(170),cb=a(821),lb=a(373),Y=a(164),Oa=a(72),Wa=a(189);class Ca{constructor(ob){this.hga=this.q8d=this.WVa=null;this.tjb=!1;this.BOc=this.wfe=null;this.ySb=this.qE=this.GXb="";this.application=this.nC=0;this.yLj=this.qXd=!1;this.dZj=ob&&Q.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");Q.AFrameworkApplication.ub.z4(X.a.IRa)||
Q.AFrameworkApplication.ub.Nb(X.a.IRa,W.a.frame,Object(M.a)(this,this.$lj,"retryOpenInClientAction"));this.X8f=!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.qa("SilentExternalHandler")}get gJf(){return this.nC}fyc(ob,Fa="",Ab=""){this.qE=Ab||wb.a.create().toString();this.GXb=Fa||Vb.a.f4e();this.ySb=ob}$lj(ob,Fa,Ab){return Fa.contextId!==W.a.frame?2:1===Ab?32:this.IRa()}get options(){let ob=0;Q.AFrameworkApplication.Xjj&&(ob|=1);Q.AFrameworkApplication.openInClientEditOnly&&(ob|=4);this.vLj()&&
(ob|=64);return ob}vLj(){return!(2===this.application&&Q.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))}get Itb(){return Q.AFrameworkApplication.sB}get fzb(){return Q.AFrameworkApplication.q6a}get Dcf(){return""}get Bmd(){return""}get $ag(){return Q.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}get vBc(){return this.wfe||(this.wfe=da.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.qXd||this.HBh()}$cb(){this.yLj||this.ZBh()}NQf(ob){this.dZj&&N.a.Yg?new ka(this):
this.w4b(ob)}w4b(ob){const Fa=({nCa:ob}=this.fvi(ob)).returnValue;h.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===Fa,ob);return Fa}nHa(ob,Fa,Ab,$b,Cb,Rb){this.WVa=ob;this.q8d=Fa;this.hga=Rb;this.application=Ab;this.nC=$b;Q.AFrameworkApplication.downloadCopyOnOpenInClient?this.vof():Q.AFrameworkApplication.limitedEdit&&!Q.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?Q.AFrameworkApplication.r8f():this.aTg(Cb)}get sJi(){return!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}IRa(){this.sJi&&this.Yxi();return this.w4b(this.tjb)}P0f(){const ob=new cb.a(Y.a.openInClient);ob.Values["ui-language"]=Q.AFrameworkApplication.lcid.toString();ob.Values[Ga.a.q6c]=Q.AFrameworkApplication.userSessionId;return this.hga.value.send(ob)?32:8}Yxi(){ic.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Wa.a,{inStaging:!0}))}xrj(ob){const Fa=new cb.a(Y.a.T0j);Fa.Values["ui-language"]=Q.AFrameworkApplication.lcid.toString();
Fa.Values[Ga.a.q6c]=Q.AFrameworkApplication.userSessionId;Fa.Values[lb.a.S0j]=ob;this.hga.value.send(Fa)}fvi(ob){this.tjb=ob;this.xrj(5===this.nC?Ca.$Yi:Ca.bZi);return 5===this.nC?this.evi():this.jvi()}evi(){this.Cof();return{returnValue:32,nCa:"HostEditUrl,"}}jvi(){let ob;var Fa=ob="";Q.AFrameworkApplication.wpe&&(Fa="|f|"+Q.AFrameworkApplication.userSessionId);const Ab=Q.AFrameworkApplication.fa.qa("IsAssignmentMode")&&Q.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
Q.AFrameworkApplication.isUnifiedHostMode||N.a.Rxa,$b=Q.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),Cb=Q.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(Q.AFrameworkApplication.ub.nnc){var Rb=Q.AFrameworkApplication.ub.XZ(3588168074);Rb&&this.fyc(Rb.epochClickTime,Rb.sessionOrigin,Rb.correlationId);this.Gqf()}if(Q.AFrameworkApplication.jMf){ob+="NewOrder,";Rb=8;this.hga&&this.hga.value&&this.hga.value.isEnabled()&&Q.AFrameworkApplication.c1d&&(ob+="Post,",Rb=this.P0f());if(32===
Rb)return{returnValue:Rb,nCa:ob};h.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return Q.AFrameworkApplication.sm.sab?(h.ULS.shipAssertTag(5566816,211,!!Q.AFrameworkApplication.sm.sab),ob+="HostUrl,",{returnValue:Q.AFrameworkApplication.sa.d$a(Q.AFrameworkApplication.sm.sab),nCa:ob}):this.WVa?(h.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",Q.AFrameworkApplication.userSessionId),ob+="DocUrl,",cc.d9c(this.WVa,this.nC,
this.options,this.application,Object(M.a)(this,this.TAf,"onEditInClientSuccess"),Object(M.a)(this,this.SAf,"onEditInClientFailure"),this.X8f,Q.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Fa,Ab,$b,Cb,this.GXb,this.qE,this.ySb,Q.AFrameworkApplication.ub.nnc),{returnValue:32,nCa:ob}):{returnValue:8,nCa:ob}}ob+="OldOrder,";if(!this.WVa&&Q.AFrameworkApplication.sm.sab)return this.hga&&this.hga.value&&this.hga.value.isEnabled()&&Q.AFrameworkApplication.c1d?(ob+="Post,",Fa=this.P0f()):(h.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),Fa=8),32!==Fa?(h.ULS.shipAssertTag(22595484,211,!!Q.AFrameworkApplication.sm.sab),ob+="HostUrl,",{returnValue:Q.AFrameworkApplication.sa.d$a(Q.AFrameworkApplication.sm.sab),nCa:ob}):{returnValue:Fa,nCa:ob};h.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",Q.AFrameworkApplication.userSessionId);ob+="DocUrl,";cc.d9c(this.WVa,this.nC,this.options,this.application,Object(M.a)(this,this.TAf,"onEditInClientSuccess"),
Object(M.a)(this,this.SAf,"onEditInClientFailure"),this.X8f,Q.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Fa,Ab,$b,Cb,this.GXb,this.qE,this.ySb,Q.AFrameworkApplication.ub.nnc);return{returnValue:32,nCa:ob}}ZVf(ob){Q.AFrameworkApplication.Tn.setDw(8981,ob)}TAf(ob){this.ZVf(ob);h.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===ob&&MSOJS.ClientUtils.ShouldShowDialog()?(this.$ag||this.Cof(),this.Gqf()):this.qXd||this.closeApplication()}SAf(ob,Fa=0){h.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",ob,Fa);if(5===ob)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const Ab=!!this.q8d&&!this.tjb;let $b=0;1===ob&&($b=2);6<=ob&&13>=ob&&($b=1,1===Fa&&(this.qXd=!0));this.vBc.gJi?(h.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",$b),ha.a.instance.xch(this.tjb?Object(M.a)(this,this.Fxf,"oicErrorDialogHandlerCloseForced"):Object(M.a)(this,this.Gxf,"oicErrorDialogHandlerNoCloseForced"),
Ab?Object(M.a)(this,this.qDf,"onLaunchDownload"):null,this.sLe(!1)?Object(M.a)(this,this.Fai,"iHaveOfficeButtonHandler"):null,$b,Fa)):(h.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",$b),ha.a.instance.vch(this.tjb?Object(M.a)(this,this.Fxf,"oicErrorDialogHandlerCloseForced"):Object(M.a)(this,this.Gxf,"oicErrorDialogHandlerNoCloseForced"),Ab?Object(M.a)(this,this.qDf,"onLaunchDownload"):null,$b))}}Gqf(){try{const ob=[Object.assign(new Oa.a,{name:"CorrelationId",string:this.qE}),
Object.assign(new Oa.a,{name:"SessionOrigin",string:this.GXb}),Object.assign(new Oa.a,{name:"ClickTime",string:this.ySb}),Object.assign(new Oa.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];xb.a("OpenInClientCompleted",!0,0,ob)}catch(ob){h.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+ob.toString())}}Cof(){Q.AFrameworkApplication.sa&&Q.AFrameworkApplication.sa.Pa.Hv&&Q.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new mb(this):new rb(this)}Fxf(){this.closeApplication()}Gxf(){this.$cb()}qDf(){this.vof()}Fai(){return this.sLe(!0)}sLe(ob){const Fa=
(N.a.xif||N.a.$H)&&!!Q.AFrameworkApplication.I7b;Fa&&ob&&(v.a.lf(Q.AFrameworkApplication.I7b,"_blank",void 0,"OpenInClient"),this.closeApplication());return Fa}}Ca.bZi="OpenInDesktop";Ca.$Yi="OpenInBrowser";Object(b.a)(Ca,"AOpenInClientOperation",null,[]);var Ra=a(5),la=a(203),ua=a(76),xa=a(59),fb=a(326),Jb=a(47),Ob=a(46),eb=a(192),Ma=a(91),va=a(29),Pa=a(11),Ha=a(21),tb=a(477),Ya=a(250),V=a(253),za=a(150),yb=a(588);class jc extends Ca{constructor(ob,Fa,Ab){super(!0);this.Ra=new ya.a;this.B8c=this.jYe=
!1;this.x4b=this.Sm=this.fDe=null;this.Tc=()=>{r.a.xg(D.a(this.$).hd.activityState,T.a.mBd)||this.hva.reset()};this.yNi=$b=>{this.ZVf($b)};this.xNi=()=>{this.eEj()};this.$=ob;this.ea=ob.ea;this.sK=Fa;this.businessBar=Ab;this.ea.Uj(this.Tc);this.hva=L.Qve(this.$);this.k6g();ob.da.Ga(55,this);this.zga=da.a.instance.Ub("Common.ISystemInitiatedFeedback")}get Dcf(){return"EditInExcelWebApp_32x32x32"}get la(){this.Sm=this.Sm||new eb.a;return this.Sm.token}get Bmd(){return"excel32"}get $ag(){return this.ea.dc.inWebPart}B5g(){this.NQf(this.jYe)}E7g(){const ob=
this.$;d.TaskExtensions.Aa(this.sK.value,Fa=>{this.nHa(ob.workbookContext.ClientUrl,Q.AFrameworkApplication.vZ,1,ob.isEditMode?2:0,!0,new K.a(()=>Fa.result))},this.la,3)}Yjd(){0!==xa.a.zg.editMode&&(this.$.rb.uy=!1)}v9e(){const ob={};ob[Ra.a.B$b]=!1;ob[Ra.a.CQ]="OpenInExcel";this.$.Xc(802602464,ua.a.Db,8,ob)}Z3c(){if(this.ea.Zb){var ob=this.$;ob.isEditMode&&d.TaskExtensions.Aa(this.sK.value,Fa=>{this.nHa(ob.workbookContext.ClientUrl,Q.AFrameworkApplication.vZ,1,2,!1,new K.a(()=>Fa.result))},this.la,
3)}}qFe(){this.ea.Zb&&d.TaskExtensions.Aa(this.sK.value,ob=>{this.nHa(this.$.workbookContext.ClientUrl,Q.AFrameworkApplication.vZ,1,this.$.isEditMode?2:0,!1,new K.a(()=>ob.result))},this.la,3)}fyc(ob){super.fyc(ob)}openInExcelClient(){this.ea.Zb&&(this.$.isEditMode||d.TaskExtensions.Aa(this.sK.value,ob=>{this.nHa(this.$.workbookContext.ClientUrl,Q.AFrameworkApplication.vZ,1,0,!1,new K.a(()=>ob.result))},this.la,3))}openInBrowser(){this.ea.Zb&&d.TaskExtensions.Aa(this.sK.value,ob=>{this.nHa(this.$.workbookContext.ClientUrl,
Q.AFrameworkApplication.vZ,1,5,!1,new K.a(()=>ob.result))},this.la,3)}downloadFile(ob){const Fa=this.gye(ob);this.hva.downloadFile(Fa,ob);this.Ayi()}Ayi(){Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.zga&&this.zga.execute(ob=>ob.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}cJf(ob,Fa=0){if(this.ea.Zb){var Ab=this.$;D.a(Ab).RMa?this.dJf(ob,Ab):0<Fa?this.qJj(ob,
Ab,Fa):this.g7f(Ab)}}nHa(ob,Fa,Ab,$b,Cb,Rb){this.$.rb.uy=!this.$.dc.inWebPart;this.jYe=Cb;this.x4b=null;this.B8c=!1;this.fTg(ob,Fa,$b,Cb,Rb)}w4b(ob){const Fa=this.$.dc;h.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${Fa.inEmbedView}, InWebPart:${Fa.inWebPart}, DivSyndicated:${Fa.isDivSyndicated}, Mode:${this.$.isEditMode?la.a.edit:la.a.view}`);return jc.ijf()?(this.Y3b(),cc.d9c(this.WVa,this.nC,this.options,1,this.yNi,this.xNi,!1,Q.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),
32):super.w4b(ob)}HBh(){this.eXf();const ob=this.$;if(!this.ea.dc.inWebPart&&this.ea.Zb&&!ob.isEditMode){const Fa=new Ma.a(2145659238,ua.a.Db,this.$.Hc,0,null);this.fDe=Jb.a.instance.create(()=>{ob.Ja.Kb(Fa)},0,Ob.a.cZi)}}dispose(){this.ea&&this.ea.uk(this.Tc);m.a.qc([this.Ra,this.fDe,this.Sm]);this.$=this.ea=null}ZBh(){this.eXf()}vof(){Jb.a.instance.create(()=>{this.$.Ja.Kb(new Ma.a(-2028960985,ua.a.Db,0,30,null))},0,Ob.a.dZi,!0,!0)}aTg(ob){const Fa=this.$,Ab=D.a(this.$).hd.activityState;Ab[tb.a.Kne]=
!0;Fa.isEditMode&&this.ea.Zb?(this.Y3b(),A.a(Fa).Js(new Ya.a(z.a.ey,5,()=>{Fa.CI(!1);Ab[V.a.Jq]=z.a.$3b;Ab[tb.a.hFg]=ob;Ab[T.a.rcd]=!0;Fa.isEditMode&&(Ab[T.a.DT]=1,Ab[T.a.xY]=!0,Ab[za.a.SZb]=!0,Ab[za.a.uVc]=!0);Ab[tb.a.Nne]=1455037301}))):this.NQf(ob)}T9f(){const ob=Q.AFrameworkApplication.vZ;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.d$a(ob,!0)){const Fa=this.$.ea.dc;h.ULS.sendTraceTag(537154773,0,50,`Url:[${ob}] IsEmbedded:[${Fa.inEmbedView}] InWebPart:[${Fa.inWebPart}] DivSyndicated:[${Fa.isDivSyndicated}], Mode:[${this.$.isEditMode?
la.a.edit:la.a.view}]`)}}else this.hva.downloadFile(ob,-2028960985);this.B8c=!0;this.Y3b()}Dvi(){this.vBc.jxf&&this.vBc.Xkc(1)}Evi(){this.vBc.jxf&&Pa.HelperMethods.lf(U.a.QZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}Lvi(){Pa.HelperMethods.lf(U.a.QZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}Mvi(){Pa.HelperMethods.lf(U.a.QZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}gye(ob){const Fa=new Sys.StringBuilder,Ab=this.$.workbookContext,
$b=this.$.va;Fa.append(this.$.Pna);Fa.append($b.FileHandlerRelativeUri);Fa.append("?id=");Fa.append(encodeURIComponent(y.a.EJb(Ab.WorkbookUri,"sc")));this.$.ea.Zb&&(Fa.append("&sessionId="),Fa.append(encodeURIComponent(this.$.ea.sessionId)));switch(ob){case -974518828:Fa.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:Fa.append("&workbookType=FullWorkbook");break;case -1059172980:Fa.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:Fa.clear()}t.a.Uob(Fa,
$b);return Fa.toString()}k6g(){ea.a.instance.w1g();const ob=this.$.va;MSOJS.ClientUtils.InitUrls(ob.RoamingAppsX86RootUrl,ob.RoamingAppsControlInstallerUrl,ob.RoamingAppsFirefoxExtensionUrl)}eXf(){const ob=this.$;this.ea.Zb||fb.a.eId(ob,D.a(ob).hd);this.Y3b();this.x4b&&this.x4b(this,this.B8c);ob.frame.Xt.rm(this.$.frame.Yaa());ob.frame.qX.rm(this.$.frame.Yaa());ob.rb.uy=!1;Ha.h(ob).focus()}fTg(ob,Fa,Ab,$b,Cb){const Rb=this.$;Q.AFrameworkApplication.sa&&!jc.ijf()&&(Rb.frame.Xt.Dn(Rb.frame.Yaa()),Rb.frame.qX.Dn(Rb.frame.Yaa()));
super.nHa(ob,Fa,1,Ab,$b,Cb)}Y3b(){const ob=this.$;D.a(ob).fi.activityName===z.a.openInExcelClient&&D.a(ob).hd.MM()}eEj(){const ob=va.a.Zc(1,0,681,682,0,1341525452,"OpenInExcelActiveXError");A.a(this.$).Pr([ob])}qJj(ob,Fa,Ab){let $b=null;const Cb=window.setTimeout(()=>{D.a(Fa).iuc($b);this.g7f(Fa)},Ab);$b=()=>{D.a(Fa).RMa&&(D.a(Fa).iuc($b),window.clearTimeout(Cb),this.dJf(ob,Fa))};D.a(Fa).yWc($b)}g7f(ob){const Fa=va.a.Zc(1,1,0,696,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");A.a(ob).Pr([Fa])}dJf(ob,
Fa){A.a(Fa).Js(new Ya.a(z.a.ey,5,()=>{Fa.CI(!1);const Ab=D.a(Fa).hd,$b=Ab.activityState;$b[V.a.Jq]=z.a.QMe;$b[yb.a.UZb]=Fa.ea.dc.hasUnsupportedFeaturesForEdit;$b[J.a.oVc]=ob;Ab.rr(va.a.q4(this.businessBar.r9c,[1437034227]))}))}static ijf(){return 1<xa.a.getRegisteredEwaInstances().length}}Object(b.a)(jc,"OpenInExcelOperation",Ca,[383,2]);class Cc extends e.a{constructor(ob){super();this.$=ob;this.Fb();Cc.j6g()}create(){if(this.$.da.za(55))this.ob(this.$.da.za(55));else{var ob=f.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.Ya),Fa=f.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Ya);d.TaskExtensions.Aa(O.Task.jJ(ob,Fa),()=>{this.ob(new jc(this.$,new K.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Ya)),Fa.result))},this.la,3)}}static j6g(){Cc.Ixf||(Cc.Ixf=!0,(new oa).Wh(da.a.instance),da.a.instance.resolve("Common.IOfficeTrialExperience").Hg(),da.a.instance.resolve("Common.IMacOfficeOffer").Hg())}}Cc.Ixf=!1;Object(b.a)(Cc,"OpenInClientFactory",e.a,[]);var Sa=a(114),na=a(387);class jb extends Sa.a{constructor(ob,
Fa){super(ob,Fa)}execute(ob){const Fa=Object(l.a)(7,ob.Ge);d.TaskExtensions.Aa(f.GetServiceTaskFactory.create(Fa.da,56,Fa.la,0),Ab=>{Fa.downloadCopyOnOpenInClient?(ob.activityState[na.a.Lne]=!0,Ab.result.T9f()):Ab.result.E7g()},Fa.la,3);return 1}}Object(b.a)(jb,"OpenInExcelClientActivity",Sa.a,[]);class Ib extends e.a{constructor(ob){super();this.$=ob;ob.da.Ga(56,new Cc(ob));this.Fb()}create(){d.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),()=>{this.ob(new jb(z.a.openInExcelClient,
z.a.idle))},this.la)}}Object(b.a)(Ib,"OpenInExcelClientActivityFactory",e.a,[]);a.d(E,"a",function(){return dc});const dc=()=>{c.a.Fa(ob=>{ob.da.Ga(57,new Ib(ob));ob.da.Ga(60,new I(ob));ob.da.Ga(63,new H(ob))})}},1150:function(u,E,a){a.r(E);u=a(0);var c=a(15),b=a(85),e=a(4),f=a(107),d=a(14),h=a(87),m=a(54),l=a(30),w=a(27),n=a(12),y=a(238),t=a(1056),r=a(5),v=a(259),B=a(1057),A=a(705),z=a(1263),x=a(91);class D extends A.a{constructor(wb,cb,lb){super(wb,cb);this.xs=!0;this.command=lb}$m(wb){super.$m(wb);
this.businessBar.$.Ja.Kb(new x.a(this.command,wb,this.businessBar.$.Hc,10,null))}}Object(u.a)(D,"CommandActionBusinessBarEntry",A.a,[]);class J extends D{constructor(wb,cb,lb){super(wb,cb,lb)}GD(wb){super.GD(wb)}}Object(u.a)(J,"EditAttemptReadOnlyBusinessBarEntry",D,[]);var L=a(44);class T extends A.a{constructor(wb,cb,lb,Y){super(wb,cb);this.error=lb;this.options=Y;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.xs=
!(Y&4)}$m(wb){super.$m(wb);this.error.Appearance&=-33;L.a(this.businessBar.$).Pr([this.error])}}Object(u.a)(T,"ErrorBusinessBarEntry",A.a,[]);class O extends T{constructor(wb,cb,lb,Y,Oa){super(wb,cb,lb,Y);this.command=Oa;this.nV=!0}YV(wb){super.YV(wb);this.businessBar.$.Ja.Kb(new x.a(this.command,wb,this.businessBar.$.Hc,10,null))}}Object(u.a)(O,"ErrorAndCommandBusinessBarEntry",T,[]);var G=a(13);class C{constructor(wb,cb,lb,Y,Oa,Wa,Ca,Ra,la){this.vJ=this.D8=this.nP=0;this.rrg=wb;this.EOj=cb;this.yP=
lb;this.Gvg=Ca;this.Gjb=l.a.mw(la);this.Htg=la;this.B5d=Ra;0!==Y&&(this.nP=Y);0!==Oa&&(this.D8=Oa);0!==Wa&&(this.vJ=Wa)}get title(){return C.ga(this.EOj)}get message(){return C.ga(this.yP)}get messageId(){return this.yP}get f0a(){return this.rrg}get actionButton(){return C.ga(this.nP)}get ysa(){return C.ga(this.D8)}get link(){return C.ga(this.vJ)}get Fk(){return this.Gvg}get n2b(){return this.B5d}get hash(){return this.Gjb}get alt(){const {BusinessBarControl:wb}=a(1150);switch(this.Fk){case wb.Uia:return C.ga(26);
case wb.nA:return C.ga(25);case wb.Di:return C.ga(24);default:return C.ga(0)}}get j$c(){return this.Htg}set n2b(wb){this.B5d=wb}static ga(wb){return G.a.instance.ga(wb)}}Object(u.a)(C,"EwaBusinessBarEntry",null,[]);class H extends C{constructor(wb,cb,lb,Y,Oa,Wa,Ca,Ra){super(wb,0,cb,lb,Y,Oa,Wa,Ca,Ra)}get title(){return""}}Object(u.a)(H,"EwaNoTitleBusinessBarEntry",C,[]);var I=a(71);class M extends A.a{constructor(wb,cb){super(wb,cb);this.nV=this.xs=!0}$m(wb){super.$m(wb);this.set_visible(!1);this.businessBar.$.GI();
this.businessBar.$.Ja.Kb(new x.a(1038998010,wb,this.businessBar.$.Hc,10,null))}YV(wb){super.YV(wb);this.businessBar.$.Ja.Kb(new x.a(-722953877,wb,this.businessBar.$.Hc,10,null))}GD(wb){this.businessBar.removeEntry(55);I.g(wb)}}Object(u.a)(M,"ExternalLinksEnableContentBusinessBarEntry",A.a,[]);class Q extends A.a{constructor(wb,cb){super(wb,cb);this.xs=!0;this.nV=!1}$m(wb){super.$m(wb);this.businessBar.$.Ja.Kb(new x.a(-722953877,wb,this.businessBar.$.Hc,10,null))}GD(wb){this.businessBar.removeEntry(5);
I.g(wb)}}Object(u.a)(Q,"ExternalLinksShowErrorBusinessBarEntry",A.a,[]);var U=a(11);class N extends A.a{constructor(wb,cb,lb){super(wb,cb);this.Hyb=lb;this.xs=!0}$m(wb){super.$m(wb);U.HelperMethods.eW(this.businessBar.$.GG,this.Hyb,this.businessBar.$.GS)}}Object(u.a)(N,"HelpButtonBusinessBarEntry",A.a,[]);class W extends A.a{constructor(wb,cb,lb){super(wb,cb);this.Hyb=lb;this.Fwa=!0}Bma(wb){super.Bma(wb);U.HelperMethods.eW(this.businessBar.$.GG,this.Hyb,this.businessBar.$.GS)}}Object(u.a)(W,"HelpTextBusinessBarEntry",
A.a,[]);var X=a(76);class sa extends A.a{constructor(wb,cb,lb,Y){super(wb,cb);this.Hyb=lb;this.command=Y;this.Fwa=!0;this.xs=1461300262!==Y}$m(wb){super.$m(wb);this.businessBar.$.Ja.Kb(new x.a(this.command,wb,this.businessBar.$.Hc,10,null))}Bma(wb){super.Bma(wb);const cb=new x.a(-859308420,wb,this.businessBar.$.Hc,12,null);this.businessBar.$.Ja.Kb(cb,{[X.a.og]:"HelpID="+this.Hyb,["InputMethod"]:wb,[X.a.Jc]:r.a.qV,[r.a.Ioa]:!0})}}Object(u.a)(sa,"HelpTextTaskPaneAndCommandBusinessBarEntry",A.a,[]);
class da extends A.a{constructor(wb,cb){super(wb,cb);this.nV=this.xs=!0}$m(wb){super.$m(wb);this.set_visible(!1);this.businessBar.$.GI();this.businessBar.$.Ja.Kb(new x.a(-1081442996,wb,this.businessBar.$.Hc,10,null))}YV(wb){super.YV(wb);this.businessBar.$.Ja.Kb(new x.a(1702917262,wb,this.businessBar.$.Hc,10,null))}GD(wb){this.businessBar.removeEntry(59);I.g(wb)}}Object(u.a)(da,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",A.a,[]);var S=a(1059);class oa extends A.a{constructor(wb,cb){super(wb,
cb);(this.policyManager=wb.$.da.za(274))?(this.message=this.policyManager.Erc,this.title=this.policyManager.title,this.Fwa=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}Bma(wb){super.Bma(wb);(wb=this.policyManager.lSi)&&wb(null)}}Object(u.a)(oa,"PolicyBusinessBarEntry",A.a,[]);var K=a(1058),ea=a(1061),ya=a(1060);a(418);var ha=a(145),La=a(25);class Ia extends A.a{constructor(wb,
cb){super(wb,cb);this.xs=!0;this.title=""}$m(wb){super.$m(wb);ha.c(La.a.aHi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(u.a)(Ia,"UnsupportedBrowserBusinessBarEntry",A.a,[]);var ra=a(1055),pa=a(1288);class ba extends A.a{constructor(wb,cb){super(wb,cb);this.XCa=pa.a.$5b();this.xs=!0;this.nV=this.XCa.kZj;this.title=this.XCa.title;this.message=this.XCa.message}get actionButton(){return this.XCa.wye}get ysa(){return this.XCa.yye}$m(wb){super.$m(wb);this.XCa.Qyf(null)}YV(wb){super.YV(wb);
this.XCa.Tyf(null)}GD(wb){super.GD(wb);this.XCa.MLe(null)}}Object(u.a)(ba,"WildFireMobileAppBusinessBarEntry",A.a,[]);var fa=a(247),Ka=a(22),aa=a(215),ja=a(159),Va=a(39),bb=a(7),wa=a(170),ka=a(1062),ta=a(72),qa=a(132),rb=a(223),Za=a(1);class gb extends A.a{constructor(wb,cb,lb,Y){super(wb,cb);Za.EwaSettings.getBooleanFeatureGate(rb.a.dB,!1)?(this.officeScriptsCommandManager=lb.da.za(519),c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager)):(this.automateCommandManager=lb.da.za(352),
c.ULS.shipAssertTag(526787654,0,!!this.automateCommandManager));this.id=wa.a.create();this.$=lb;this.title=G.a.instance.ga(2276);this.message="";this.zWd=G.a.instance.ga(2272);this.rkg=G.a.instance.ga(2273);this.pkg=G.a.instance.ga(2274);this.$Ee=G.a.instance.ga(2275);this.update(Y)}update(wb){this.scriptLink=wb.scriptLink;this.runStatus=wb.runStatus;this.buttonText=wb.buttonText||"";this.$xi(wb.clickId);this.ekj();"preparing"===this.runStatus?(this.dBa(0),this.message=String.format(G.a.instance.nb(208),
this.buttonText),this.xs=!0,this.Yra=this.zWd,this.vrb=this.Pga=this.jab):"running"===this.runStatus?(this.dBa(0),this.message=String.format(G.a.instance.nb(207),this.buttonText),this.xs=!0,this.Yra=this.zWd,this.vrb=this.Pga=this.jab):"succeeded"===this.runStatus?(this.dBa(0),this.message=String.format(G.a.instance.nb(210),this.buttonText),"true"===wb.hasLogs?(this.xs=!0,this.Yra=this.pkg,this.Pga=this.BIf,this.nV=!0,this.FXc=this.rkg,this.GXc=this.CIf):(this.xs=!0,this.Yra=this.rkg,this.Pga=this.CIf)):
"runFailed"===this.runStatus?(this.dBa(1),this.message=String.format(G.a.instance.nb(209),this.buttonText),this.j6a=Vb.Uia,"true"===wb.hasLogs?(this.xs=!0,this.Yra=this.pkg,this.Pga=this.BIf,"false"===wb.isOwner&&(this.nV=!0,this.FXc=this.$Ee,this.GXc=this.Vzf)):"false"===wb.isOwner&&(this.xs=!0,this.Yra=this.$Ee,this.Pga=this.Vzf)):"fetchFailed"===this.runStatus?(this.dBa(1),this.j6a=Vb.Uia,this.message=String.format(G.a.instance.nb(211),this.buttonText)):"canceled"===this.runStatus?(this.dBa(0),
this.j6a=Vb.nA,this.message=String.format(G.a.instance.nb(213),this.buttonText)):"alreadyRunning"===this.runStatus?(this.dBa(5),this.j6a=Vb.nA,this.message=String.format(G.a.instance.nb(212),this.buttonText),this.xs=!0,this.Yra=this.zWd,this.vrb=this.Pga=this.jab):"initializing"===this.runStatus&&(this.dBa(0),this.j6a=Vb.Di,this.message=G.a.instance.ga(2277))}get Fk(){return this.j6a}get actionButton(){return this.Yra}get ysa(){return this.FXc}$m(wb){super.$m(wb);this.Pga&&this.Pga()}YV(wb){super.YV(wb);
this.ysa&&this.GXc()}GD(wb){super.GD(wb);this.vrb&&this.vrb()}ekj(){this.message="";this.j6a=Vb.Di;this.xs=!1;this.Yra="";this.Pga=void 0;this.nV=!1;this.FXc="";this.GXc=void 0;this.hideCloseButton=!1;this.vrb=void 0}jab(){const wb=wa.a.create().toString();Za.EwaSettings.getBooleanFeatureGate(rb.a.dB,!1)?this.officeScriptsCommandManager.Rjd(wb):this.automateCommandManager.Rjd(wb);this.wlc(-2186799,wb)}BIf(){const wb=wa.a.create().toString();Za.EwaSettings.getBooleanFeatureGate(rb.a.dB,!1)?this.officeScriptsCommandManager.Qjd(wb):
this.automateCommandManager.Qjd(wb);this.wlc(1036446140,wb)}CIf(){const wb=wa.a.create();if(this.scriptLink){const cb=new ka.b(this.scriptLink);Za.EwaSettings.getBooleanFeatureGate(rb.a.dB,!1)?this.officeScriptsCommandManager.ayb(this.id.toString(),JSON.stringify(cb),wb):this.automateCommandManager.ayb(this.id.toString(),JSON.stringify(cb),wb)}this.wlc(-585097204,wb.toString())}Vzf(){const wb=wa.a.create().toString();Za.EwaSettings.getBooleanFeatureGate(rb.a.dB,!1)?this.officeScriptsCommandManager.Pjd(wb):
this.automateCommandManager.Pjd(wb);this.wlc(-639858579,wb)}$xi(wb){const cb=[];cb.push(Object(bb.a)(new ta.a,{name:"id",string:this.id.toString()}));cb.push(Object(bb.a)(new ta.a,{name:"hasScriptLink",bool:!!this.scriptLink}));cb.push(Object(bb.a)(new ta.a,{name:"runStatus",string:this.runStatus}));cb.push(Object(bb.a)(new ta.a,{name:"clickId",string:wb}));cb.push(Object(bb.a)(new ta.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));ha.a(qa.a.lJi,void 0,void 0,cb)}wlc(wb,cb){const lb=
[];lb.push(Object(bb.a)(new ta.a,{name:"id",string:this.id.toString()}));lb.push(Object(bb.a)(new ta.a,{name:"hasScriptLink",bool:!!this.scriptLink}));lb.push(Object(bb.a)(new ta.a,{name:"runStatus",string:this.runStatus}));lb.push(Object(bb.a)(new ta.a,{name:"clickId",string:cb}));ha.d(wb,void 0,void 0,void 0,void 0,void 0,lb)}}Object(u.a)(gb,"OfficeScriptsRunStatusBusinessBarEntry",A.a,[]);var mb=a(47);class Ga extends D{constructor(wb,cb,lb,Y,Oa,Wa){super(wb,cb,lb);mb.a.instance.create(()=>{this.showCallout(cb,
Y)},Oa,Wa,!0,!0)}showCallout(wb,cb){if(this.businessBar&&this.businessBar.cla(wb.f0a)&&this.zse()){wb=new x.a(-847286761,0,this.businessBar.$.Hc,0,null);var lb={};lb.CalloutName=cb;Za.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?lb.Target=this.nK():lb.Target=Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.nP.domElement;this.businessBar.$.Ja.Kb(wb,lb)}}zse(){return!0}}
Object(u.a)(Ga,"CalloutBusinessBarEntry",D,[]);class ib extends Ga{constructor(wb,cb,lb,Y,Oa,Wa){super(wb,cb,lb,Y,Oa,Wa)}zse(){if(!Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const wb=this.businessBar.$.da.za(465);return wb&&wb.nwc?!1:!0}}Object(u.a)(ib,"OptimizeWorkbookCalloutBusinessBarEntry",Ga,[]);var cc=a(19);class ic extends A.a{constructor(wb,cb,lb){super(wb,cb);this.update(lb)}update(wb){this.title=
wb.title?wb.title:"";this.message=wb.message?wb.message:"";this.hideCloseButton=!!wb.hideCloseButton}}Object(u.a)(ic,"MsFormsDataSyncStatusBusinessBarEntry",A.a,[]);class xb extends A.a{constructor(wb,cb,lb,Y){super(wb,cb);this.nV=this.xs=!0;this.M4i=lb;this.zOg=Y}$m(wb){super.$m(wb);this.businessBar.$.Ja.Kb(new x.a(this.M4i,wb,this.businessBar.$.Hc,10,null))}YV(wb){super.$m(wb);this.businessBar.$.Ja.Kb(new x.a(this.zOg,wb,this.businessBar.$.Hc,10,null))}}Object(u.a)(xb,"DualCommandActionsBusinessBarEntry",
A.a,[]);a.d(E,"BusinessBarControl",function(){return Vb});class Vb extends y.a{constructor(wb,cb){super(cb);this.kHh=n.DOMElementExtensions.Gr+",div";this.oQ=Array(70);this.Lm=!1;this.bW=lb=>{if(lb.Ca.keyCode===b.a.Yy){var Y=this.mc.querySelectorAll(this.kHh);const Oa=n.DOMElementExtensions.um(Y);Y=n.DOMElementExtensions.nB(Y);return n.DOMElementExtensions.kBa(lb.Ca,Oa,Y)}return!1};this.jb=wb;this.set_visible(!1);this.addCssClass(t.a.Qrh);Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)&&e.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&this.addCssClass(t.a.Srh);f.KeyInputManager.instance.ta(d.a.Pb,this.mc,this.bW);v.a(wb).ai(this)}get de(){return fa.a.B_c}get mc(){return this.domElement}get Gf(){return this.get_visible()}get $(){return this.jb}kg(wb,cb){cb||n.DOMElementExtensions.setFocus(this.domElement.firstChild);return!cb}mh(wb){return n.DOMElementExtensions.yf(this.mc,wb)}sj(){}Zj(){}dispose(){this.Lm||(f.KeyInputManager.instance.Ba(d.a.Pb,this.mc,this.bW),h.a.qc(this.oQ),
this.oQ=Array(70),this.jb=null,super.dispose(),this.Lm=!0)}cla(wb){if(!this.get_visible())return!1;wb=this.oQ[wb];return!!wb&&wb.isVisible}Eed(wb){return this.cla(wb)?this.oQ[wb].nK():null}$E(wb){return!!this.oQ[wb]}XPb(wb,cb){if(wb=this.oQ[wb])wb.update(cb),wb.bVj()}zC(wb,cb,lb=null,Y=null){let Oa=!1;if(this.$E(wb))lb=this.oQ[wb].get_visible();else{this.set_visible(!0);const Ca=Vb.$7e()[wb];this.oQ[wb]=this.K3(wb,cb,lb,Y);lb=!1;Oa=!0;Y="";let Ra=0;cb&&(Y=cb.MessageIdName,Ra=cb.MessageId);const la=
Ca.j$c;var Wa=Va.PageLoadTrackingInfo.instance.jwa(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${wb}, time from app interactive: ${Wa}`);Za.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")&&(Wa=this.oQ.filter(ua=>null!=ua).length,1<Wa&&c.ULS.sendTraceTag(525349006,0,50,`Total BizBars: ${Wa.toString()}`));Za.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===Ca.n2b||ja.a(this.$).xMd(Ca.hash,
Y,Ra,m.a.ACc,!0,1,cb,la)}lb||!z.a.Jdc().includes(wb)&&!Oa||(this.oQ[wb].set_visible(!0),this.$.GI())}removeEntry(wb){return this.Edj(wb)}EKd(){h.a.qc(this.oQ);this.oQ=Array(70);this.set_visible(!1)}Edj(wb){if(!this.$E(wb))return!1;h.a.Ia(this.oQ[wb]);this.oQ[wb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.GI();return!0}K3(wb,cb,lb=null,Y=null){const Oa=Vb.$7e()[wb],Wa=!!(this.$.qd&64);switch(wb){case 2:case 4:case 23:case 25:case 26:case 36:case 35:wb=new A.a(this,Oa);break;
case 12:case 29:case 30:case 31:case 32:case 57:wb=Wa?new D(this,Oa,-8805455):new A.a(this,Oa);break;case 34:wb=Wa?new xb(this,Oa,-8805455,-104572626):new A.a(this,Oa);break;case 22:wb=new J(this,Oa,-8805455);break;case 46:case 45:wb=Wa?new O(this,Oa,cb,0,-8805455):new T(this,Oa,cb,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:wb=new T(this,Oa,cb,0);break;case 19:wb=new A.a(this,Oa);break;case 47:wb=new T(this,Oa,cb,0);break;case 6:case 14:wb=new N(this,Oa,cb.HelpTopicId);break;case 67:case 65:wb=
new W(this,Oa,cb.HelpTopicId);break;case 37:wb=new W(this,Oa,r.a.Jgh);break;case 38:wb=new A.a(this,Oa);break;case 68:wb=new J(this,Oa,924877417);break;case 16:wb=new A.a(this,Oa);wb.title=l.a.Gg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);wb.message=l.a.Gg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:wb=new D(this,Oa,-1762562205);wb.hideCloseButton=!0;break;case 20:wb=new ba(this,Oa);break;case 21:case 56:wb=new A.a(this,Oa);break;case 28:wb=new A.a(this,
Oa);break;case 24:wb=new Ia(this,Oa);break;case 27:wb=new oa(this,Oa);break;case 39:wb=new ra.a(this,Oa);break;case 40:wb=new B.a(this,Oa);break;case 41:wb=new K.a(this,Oa);break;case 42:wb=new S.a(this,Oa);break;case 48:wb=new A.a(this,Oa);break;case 49:wb=new A.a(this,Oa);break;case 50:wb=new A.a(this,Oa);break;case 51:wb=new A.a(this,Oa);break;case 52:wb=new A.a(this,Oa);break;case 53:wb=new ya.a(this,Oa);break;case 54:wb=new ea.a(this,Oa);break;case 55:wb=new M(this,Oa);break;case 5:wb=new Q(this,
Oa);break;case 58:wb=new D(this,Oa,-1753056834);cb?(cb=cb.Directive,Ka.a.Vq(cb)||"&nbsp;"===cb||(wb.message=cb)):lb&&(wb.message=lb);break;case 59:wb=new da(this,Oa);break;case 60:wb=new A.a(this,Oa);break;case 63:wb=new W(this,Oa,r.a.wIi);break;case 61:wb=new sa(this,Oa,r.a.SSg,-8805455);break;case 66:wb=new sa(this,Oa,r.a.$9i,1461300262);break;case 62:wb=new ib(this,Oa,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");wb.message=lb;break;case 64:wb=new gb(this,Oa,this.$,
Y);break;case 69:wb=new ic(this,Oa,Y);break;default:wb=new T(this,Oa,cb,7)}wb.P4c();return wb}static $7e(){let wb;wb=aa.a.lNa()?261:260;return Vb.lye||(Vb.lye=[new C(0,276,277,278,0,0,Vb.Uia,1,"BB_UnableToRefreshLock"),new C(1,276,277,278,0,0,Vb.Uia,1,"BB_UnableToRefreshLockExpected"),new C(2,268,269,0,0,0,Vb.nA,5,"BB_WorkbookAlmostTooLarge"),new C(3,270,271,272,0,0,Vb.Uia,1,"BB_WorkbookTooLarge"),new C(4,259,wb,0,0,0,Vb.nA,5,"BB_ExternalWorkbookLinksDisabled"),new C(5,263,262,264,0,0,Vb.Uia,1,"BB_ExternalWorkbookLinksShowError"),
new C(6,265,266,267,0,0,Vb.Di,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new C(7,251,252,253,0,0,Vb.Di,5,"BB_UnsupportedFeatures"),new C(8,0,0,0,0,0,Vb.Di,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new C(9,0,0,0,0,0,Vb.Di,0,"BB_CollabDataStringsLocaleMismatch"),new C(10,0,0,0,0,0,Vb.Di,0,"BB_CollabDataLocaleMismatch"),new C(11,279,280,281,0,0,Vb.Uia,1,"BB_LastGenericStatusError"),new C(12,282,283,284,0,0,Vb.nA,5,"BB_ScratchPadWarning"),new C(13,285,286,287,0,0,Vb.Uia,1,"BB_AuthenticationLost"),
new C(14,288,289,290,0,0,Vb.nA,5,"BB_OdfCompatibilityIssues"),new C(15,0,575,0,0,0,Vb.nA,5,"BB_PivotChartInteractivityMissingWarning"),new C(16,0,0,0,0,0,Vb.Di,2,"BB_WorkbookIsIrmProtected"),new C(17,0,0,0,0,0,Vb.Di,0,"BB_BIFeatureNotAvailable"),new C(18,291,292,287,0,0,Vb.nA,5,"BB_AnonymousCreateMode"),new C(19,254,255,0,0,0,Vb.nA,5,"BB_UnsupportedInteractiveReportEditing"),new C(20,0,0,0,0,0,Vb.Di,0,"BB_MobileAppCampaignBizBar"),new C(21,297,298,0,0,0,Vb.Di,0,"BB_TransientServerCommunicationFailures"),
new C(22,1638,1649,1650,0,0,Vb.Di,5,"BB_EditAttemptInReadOnly"),new C(23,1638,1649,0,0,0,Vb.Di,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new C(24,0,U.HelperMethods.wUj(),1627,0,0,Vb.Di,3,"BB_UnsupportedBrowser"),new C(25,300,301,0,0,0,Vb.Di,2,"BB_ReadOnlyPermissions"),new C(26,302,303,0,0,0,Vb.Di,2,"BB_DocumentIsIrmProtectedWarning"),new C(27,0,0,0,0,0,Vb.nA,5,"BB_PolicyWarningMessage"),new C(28,1281,299,0,0,0,Vb.Di,0,"BB_WorkingOnIt"),new C(29,1638,1636,1637,0,0,Vb.Di,2,"BB_PasswordProtectedWorkbookLockedForEdit"),
new C(30,1651,1652,1653,0,0,Vb.Di,5,"BB_WorkbookIsReadOnlyRecommended"),new C(31,1638,1654,1655,0,0,Vb.Di,5,"BB_WorkbookHasPasswordToModify"),new C(32,1638,1656,1659,0,0,Vb.Di,3,"BB_LegacySharedWorkbookEditWarning"),new C(33,1646,1657,253,0,0,Vb.Di,5,"BB_LegacyConnectionsWarning"),new C(34,1638,1954,1955,1956,0,Vb.Di,0,"BB_TooManyLoadBlockingFloatingObjects"),new C(35,1647,1648,0,0,0,Vb.Di,2,"BB_GroupedSlicers"),new C(36,313,314,0,0,0,Vb.nA,5,"BB_ThirdPartyAddinDisabled"),new C(37,1780,1781,0,0,1782,
Vb.Di,5,"BB_FinanceLinkedEntityDisclaimerBar"),new C(38,1809,1810,0,0,0,Vb.nA,5,"BB_WolframDeprecationAlertBar"),new C(39,0,0,0,0,0,Vb.Di,0,"BB_WacGdprNotice"),new C(40,0,0,0,0,0,Vb.Di,0,"BB_AutomaticSensitivityLabel"),new C(41,0,0,0,0,0,Vb.Di,0,"BB_RecommendedSensitivityLabel"),new C(42,0,0,0,0,0,Vb.Di,0,"BB_MandatorySensitivityLabel"),new C(43,315,316,317,0,0,Vb.Di,0,"BB_LocalStorageDisabled"),new C(44,632,633,0,0,0,Vb.Di,0,"BB_AutoRefreshDisabled"),new C(45,1011,1009,1013,1310,0,Vb.Di,4,"BB_CorruptedFileRepaired"),
new C(46,1012,1010,1013,1310,0,Vb.Di,5,"CorruptedOdsFileRepaired"),new C(47,273,274,275,0,0,Vb.nA,5,"BB_MinorVersionLimitReached"),new C(48,304,305,0,0,0,Vb.nA,5,"BB_SensitivityApplicationGenericError"),new C(49,306,308,0,0,0,Vb.nA,5,"BB_SensitivityApplicationTooLargeFileError"),new C(50,307,308,0,0,0,Vb.nA,5,"BB_SensitivityApplicationLabelNotSupportedError"),new C(51,309,310,0,0,0,Vb.nA,5,"BB_SensitivityApplicationLabelDisabledError"),new C(52,311,312,0,0,0,Vb.nA,5,"BB_SensitivityApplicationMandatoryConflictError"),
new C(53,0,0,0,0,0,Vb.nA,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new C(54,0,0,0,0,0,Vb.nA,5,"BB_SensitivityApplicationSetLabelError"),new C(55,2113,2114,2115,2118,0,Vb.Di,5,"BB_ExternalWorkbookLinksPromptEnableContent"),new C(56,297,298,0,0,0,Vb.Di,0,"BB_NetworkDown"),new C(57,318,319,320,0,0,Vb.Di,2,"BB_DefaultToViewDueToCogs"),new C(58,1806,1807,1808,0,0,Vb.Di,1,"BB_RefreshLinkedEntityErrorBar"),new C(59,1783,1784,1785,1786,0,Vb.Di,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),
new H(60,250,0,0,0,Vb.Di,5,"BB_CanvasHealth"),new C(61,1014,1015,1310,0,1016,Vb.Di,5,"BB_MismatchedFileFormatConverted"),new C(62,2232,0,2234,0,0,Vb.Di,5,"BB_OptimizeWorkbook"),new C(63,321,322,0,0,323,Vb.Di,0,"BB_NovModePostDepreciation"),new C(64,0,0,0,0,0,Vb.Di,0,"BB_OfficeScriptsRunning"),new C(65,2208,2209,0,0,2211,Vb.Di,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new C(66,324,325,0,0,326,Vb.Di,5,"BB_ReadOnlyPivotTable"),new C(67,2208,2210,0,0,2211,Vb.Di,0,"BB_PowerQueryRefreshHostNotSupported"),
new C(68,1053,w.a.Dic?1055:1054,1052,0,0,Vb.Di,4,"BB_RefreshPageAfterEnablingTheExtension"),new C(69,0,0,0,0,0,Vb.Di,0,"BB_MsFormsDataSyncStatus")])}}Vb.Uia=cc.a.$uh;Vb.nA=cc.a.bvh;Vb.Di=cc.a.avh;Vb.lye=null;Object(u.a)(Vb,"BusinessBarControl",y.a,[36])},1153:function(u,E,a){var c=a(9);u=a(0);var b=a(692),e=a(50),f=a(37),d=a(15),h=a(1071),m=a(148),l=a(24),w=a(76),n=a(58);class y{constructor(Ca){this.options=null;this.options=Ca}}Object(u.a)(y,"MacroRecorderRangeCustomSortedPayload",null,[137]);var t=
a(955),r=a(956),v=a(42),B=a(371),A=a(188),z=a(283),x=a(142),D=a(29),J=a(282),L=a(1),T=a(183),O=a(22),G=a(281),C=a(21),H=a(800),I=a(749),M=a(261),Q=a(208),U=a(13),N=a(134);class W{constructor(Ca){this.vw=Ra=>{switch(Ra){case 0:this.COa("Cancel");break;case 1:this.COa("Expand and sort");this.dVe(!0);break;case 2:this.COa("Just sort"),this.dVe(!1)}};this.dVe=Ca}show(){const Ca=new N.StandardDialog;Ca.Rb=11;Ca.oc(1,U.a.instance.ga(2120));Ca.oc(2,U.a.instance.ga(2121));Ca.n8f(U.a.instance.ga(2119),U.a.instance.Ua(657),
this.vw)}COa(Ca){d.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${Ca}`)}}Object(u.a)(W,"ExpandSortSelectionDialog",null,[]);const X=(Ca,Ra)=>{Ca=Ca.ColumnInfo;switch(Ra){case 1:return Ca.CellColors&&Ca.CellColors.length?!0:(d.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return Ca.TextColors&&Ca.TextColors.length?
!0:(d.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return Ca.Icons&&Ca.Icons.length?!0:(d.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return d.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),
!1}},sa=(Ca,Ra,la,ua)=>{Ca=Ca.HeaderColumnInfo;return ua||Ca?2===Ra&&la?Ca.CellColors&&1!==Ca.CellColors.length?(d.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):Ca.TextColors&&1!==Ca.TextColors.length?(d.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):Ca.Icons&&1!==Ca.Icons.length?(d.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:Ca?(d.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${la} == 0.`),!1):!0:!0};var da=a(187);class S{static isValid(Ca){return S.oCh.includes(Ca.Position)?
!0:(d.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${Ca.Position}]`),!1)}}S.oCh=[0,.5,1];Object(u.a)(S,"FillGradientStopExtension",null,[]);class oa{constructor(Ca,Ra,la,ua){new Sys.UI.Point(Ca,Ra);new Sys.UI.Point(la,ua)}}Object(u.a)(oa,"GradientLine",null,[]);class K{static isValid(Ca){if(!(Ca.Degree.toString()in K.mCh))return d.ULS.shipAssertTag(537159829,0,!1,`FillGradientExtension.IsValid: unexpected degree value [${Ca.Degree}]`),!1;if(!Ca.GradientStops)return d.ULS.shipAssertTag(537159828,
0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(Ca.GradientStops.length<K.LEi||Ca.GradientStops.length>K.qDi)return d.ULS.shipAssertTag(537159827,0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${Ca.GradientStops.length}]`),!1;for(const Ra of Ca.GradientStops)if(!S.isValid(Ra))return!1;return!0}}K.LEi=2;K.qDi=3;K.mCh={["0"]:new oa(0,0,1,0),["180"]:new oa(1,0,0,0),["90"]:new oa(0,0,0,1),["270"]:new oa(0,1,0,0),["45"]:new oa(0,0,1,1),["225"]:new oa(1,1,0,0),
["135"]:new oa(1,0,0,1),["315"]:new oa(0,1,1,0)};Object(u.a)(K,"FillGradientExtension",null,[]);const ea=Ca=>Ca.SortRange?4===Ca.SortRangeType?(d.ULS.sendTraceTag(537151622,0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${Ca.SortRangeType}`),!1):2===Ca.SortRangeType&&Ca.SortTopToBottom&&(null==Ca.HeaderRowSize||0>Ca.HeaderRowSize)?(d.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),
!1):!0:(d.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),ya=Ca=>{if(!Ca.SortConditions)return!0;for(const Ra of Ca.SortConditions){if(!La(Ca,Ra.RowColOffset))return d.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${Ra.RowColOffset}] is out of bounds. sort range: ${Ca.SortRange}`),!1;if(1===Ra.SortConditionType&&Ra.FillGradient&&!K.isValid(Ra.FillGradient))return d.ULS.sendTraceTag(537151619,0,
10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},ha=Ca=>{if(!Ca.SortColumnInfoItems)return d.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var Ra=new da.a;for(var la of Ca.SortColumnInfoItems){if(!La(Ca,la.ColumnOffset))return d.ULS.sendTraceTag(537151617,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${la.ColumnOffset}] is out of bounds. sort range: ${Ca.SortRange}`),
!1;if(!la.Name)return d.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${la.ColumnOffset}]`),!1;if(la.CellColors&&!la.CellColors.length)return d.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${la.CellColors.length}]`),!1;if(la.TextColors&&!la.TextColors.length)return d.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${la.TextColors.length}]`),
!1;if(la.Icons&&!la.Icons.length)return d.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${la.Icons.length}]`),!1;Ra.add(la.ColumnOffset)}if(Ca.SortConditions)for(const ua of Ca.SortConditions)if(!Ra.contains(ua.RowColOffset))return d.ULS.shipAssertTag(537151584,0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${ua.RowColOffset}]`),!1;if(Ca.HeaderColumnInfoItems){if(Ca.HeaderColumnInfoItems.length!==
Ca.SortColumnInfoItems.length)return d.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Ra=0;Ra<Ca.HeaderColumnInfoItems.length;++Ra){la=Ca.HeaderColumnInfoItems[Ra];if(la.ColumnOffset!==Ca.SortColumnInfoItems[Ra].ColumnOffset)return d.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;
if(la.CellColors&&1<la.CellColors.length)return d.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(la.TextColors&&1<la.TextColors.length)return d.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(la.Icons&&1<la.Icons.length)return d.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),
!1}}return!0},La=(Ca,Ra)=>{const la=Ca.SortRange;Ca=Ca.SortTopToBottom?la.LastColumn-la.FirstColumn:la.LastRow-la.FirstRow;return 0<=Ra&&Ra<=Ca};var Ia=a(380),ra=a(132),pa=a(89),ba=a(133);class fa extends Ia.a{constructor(Ca,Ra){super(Ca,Ra);this.iEb=this.Ydd();this.Qr()}get pc(){return"SortMergedCellsErrorDialog"}OO(Ca,Ra){if(1===Ca){var la=v.v(this.iEb,this.$);C.h(this.$).Bg(la,null,null,null,0,"SortErrorDialog.MergeCellRangeSelected")}la={["DialogButton"]:Ca,["Location"]:"dialog"};ba.b(this.$).ud(ra.a.VHj,
la,null,!0);super.OO(Ca,Ra)}Qr(){super.Qr();const Ca=this.SHj();this.Rb=1;this.oc(1,U.a.instance.ga(2239));this.Zl(U.a.instance.ga(2240),pa.a.dg(Ca),1,this.Y7)}SHj(){return String.format(U.a.instance.nb(174),this.iEb.toString())}Ydd(){const Ca=this.error.Description.split("_");return new l.Range(Number.parseInvariant(Ca[1])+1,Number.parseInvariant(Ca[2])+1,Number.parseInvariant(Ca[3])+1,Number.parseInvariant(Ca[4])+1,!0,!1)}}Object(u.a)(fa,"SortMergedCellsErrorDialog",Ia.a,[]);var Ka=a(69),aa=a(574),
ja=a(608);class Va extends H.a{constructor(Ca,Ra,la,ua){super(Ca);this.shc=this.ITd=!1;this.Z6=[];this.yhi=(xa,fb)=>{const Jb=this.Wah(xa);this.FMa(214,(Ob,eb,Ma)=>z.p(this.$.pa.ya,Jb,this.E0a(Ob,this.MJh(fb)),this.dU(eb),Ma,null),16,!0)};this.xhi=(xa,fb,Jb)=>{xa=z.o(this.$.pa.ya,fb,this.xKh(fb,Jb),this.qQi,null,xa);this.Z6.push(xa)};this.qQi=()=>{d.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.T7b(Va.ssb())};
this.P7c=(xa,fb)=>{if(1===xa){xa=fb.sortRangeType;const Jb={};Jb.SortOptions=fb.sortOptions;Jb.ShouldRestoreSelection=this.ITd;Jb.SelectedRange=this.selectedRange;Jb.OriginalActiveCell=this.zqc;Jb.TopCellAddress=this.yUa;Jb.ShouldPromptNamedSheetViewTeachingDialog=0===xa||3===xa;Va.i8i(this.$,Jb)}else this.ITd&&this.hpa(this.selectedRange,this.zqc)};this.Y$h=(xa,fb)=>{this.ITd=!0;this.hpa(xa,fb)};this.getColorName=xa=>I.a.iLa(Q.a.GH(xa));d.ULS.shipAssertTag(529105669,0,!!Ra.ActiveCell);d.ULS.shipAssertTag(529105668,
0,!!Ra.SelectedRange);d.ULS.shipAssertTag(529105667,0,v.D(Ra.SelectedRange).contains(v.C(Ra.ActiveCell)));d.ULS.shipAssertTag(529105666,0,O.a.equals(Ra.SelectedRange.SheetName,Ra.ActiveCell.SheetName,!0));this.ldb=new ja.a(Ca,aa.a.jgh,()=>this.shc,1);this.selectedRange=Ra.SelectedRange;this.zqc=Ra.ActiveCell;this.pZg=Ra.ExpandSelection;this.namedSheetViewPublic=la;this.yUa=ua;this.initializeAndShow(U.a.instance.ga(181),this.P7c,this.Jta(Ra))}dispose(){this.shc||(this.shc=!0,this.S2b(),this.Z6=null,
this.ldb.dispose(),this.ldb=null);super.dispose()}get pc(){return"CustomSortDialog"}get ha(){return C.h(this.$).ha}MJh(Ca){return Ra=>{J.b(Ra,-901005882)?(Ka.a(this.$).hd.sM(-901005882),this.YHd()):J.b(Ra,-569193796)?(Ka.a(this.$).hd.sM(-569193796),this.hide(),new fa(this.$,Ra.Errors[0])):J.a(Ra)?(d.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),this.hide()):(Ra=Ra.Result,this.$.pk(Ra.SortRange),Ra&&ea(Ra)&&ya(Ra)&&
ha(Ra)?Ca(Ra):this.T7b(Va.ssb()))}}xKh(Ca,Ra){return(la,ua)=>{if(this.shc)d.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!la||J.a(la))d.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${D.a.sc(la.Errors)}`),this.$.ea.Qo(la.Errors),this.hide();else{la=la.Result;var xa=Ca.RangeType,fb=Ca.HeaderRowSize,Jb=Ca.SortTopToBottom;
la&&X(la,Ca.ConditionType)&&sa(la,xa,fb,Jb)?(la.ColumnInfo.ColumnOffset=ua,void 0!==la.HeaderColumnInfo&&null!==la.HeaderColumnInfo&&(la.HeaderColumnInfo.ColumnOffset=ua),Ra(la,Ca.ConditionType,Ca.SortTopToBottom)):(d.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.T7b(Va.ssb()))}}}Wah(Ca){const Ra={};Ra.SelectedRange=this.selectedRange;Ra.ActiveCell=this.zqc;Ra.SortInfoMode=Ca;Ra.ExpandSortSelection=
this.pZg;Ra.ExpandSortSelectionSupported=!0;return Ra}Jta(Ca){const Ra={};Ra[M.a.uu]=this.pc;Ra.fromAutoFilter=Ca.FromAutoFilter;Ra.gridRTL=C.h(this.$).rtl;Ra.activeCell=Ca.ActiveCell;Ra.selectedRange=Ca.SelectedRange;Ra.invokeGetSortInfo=this.yhi;Ra.invokeGetSortConditionColorsOrIcons=this.xhi;Ra.highlightSortRange=this.Y$h;Ra.getColorName=this.getColorName;return Ra}hpa(Ca,Ra){Ca=v.D(Ca);this.ha.ra.$c.equals(Ca)||this.ha.updateSelection(Ca,v.C(Ra),0,void 0,void 0,void 0,!0)}YHd(){(new W(Ca=>{const Ra=
{};Ra.ActiveCell=this.zqc;Ra.SelectedRange=this.selectedRange;Ra.ExpandSelection=Ca;Ra.FromAutoFilter=!1;this.$.Xc(-207540907,w.a.Db,8,{["SortCommandData"]:Ra})})).show()}S2b(){if(void 0!==this.Z6&&null!==this.Z6)for(const Ca of this.Z6)this.$.pa.ya.Zfb(Ca.lu)}static i8i(Ca,Ra){Ca.Xc(1659552324,w.a.Db,8,{["CustomSortCommandData"]:Ra})}static ssb(){return D.a.Zc(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}Object(u.a)(Va,"CustomSortDialog",H.a,[]);var bb=a(1072);class wa{constructor(Ca){this.selection=
null;this.selection=Ca}getSelection(){return this.selection}}Object(u.a)(wa,"MacroRecorderRangeAutoFilterClearedPayload",null,[137]);class ka{constructor(Ca){this.filterRange=null;this.filterRange=Ca}}Object(u.a)(ka,"MacroRecorderRangeFilterReappliedPayload",null,[137]);var ta=a(60);const qa=(Ca,Ra,la,ua,xa,fb,Jb=null)=>{Jb=Ca.Na(41,Jb);Jb.options=Ra;return ta.g(Ca,"Sort",Jb,la,ua,xa,fb,0)},rb=(Ca,Ra,la,ua,xa,fb,Jb=null)=>{Jb=Ca.Na(41,Jb);Jb.selectedRange=Ra;return ta.g(Ca,"ClearAutoFilter",Jb,la,
ua,xa,fb,0)},Za=(Ca,Ra,la,ua,xa,fb,Jb=null)=>{Jb=Ca.Na(41,Jb);Jb.filterRange=Ra;return ta.g(Ca,"ReapplyAutoFilter",Jb,la,ua,xa,fb,0)};var gb=a(771),mb=a(772),Ga=a(112),ib=a(55),cc=a(1073),ic=a(198),xb=a(33),Vb=a(343),wb=a(64);class cb{constructor(Ca,Ra){this.sortOptions=this.ETa=this.selectedRange=null;this.sgf=!1;this.activeCell=this.Be=this.vb=this.jc=null;this.onContentReady=()=>{this.ZRf(!1);const la=this.ha();la.ra.Og&&la.ra.$c.equals(this.ETa)&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?
la.updateSelection(this.selectedRange,v.C(this.activeCell),0,void 0,void 0,void 0,!0):la.updateSelection(this.selectedRange,la.ra.activeCell,0,void 0,void 0,void 0,!0))};this.ZPi=(la,ua)=>{la&&!D.a.ag(la.Errors)&&this.jc&&(this.jc.fp=la.Result,this.fMb(),this.applyPivotSort(ua))};this.YPi=()=>{};this.uXi=(la,ua)=>{var xa;((null===ua||void 0===ua?0:ua.WOj)||(null===(xa=this.$.oa)||void 0===xa?0:xa.hasAutoFilter))&&ua.selection&&xb.a.tif()&&(la=wb.d(this.$.xa.oa),this.XOj(new Vb.a(v.D(ua.selection),
la)))};this.$=Ca;this.jof="";this.namedSheetViewPublic=Ra;this.gridView=C.h(this.$);this.$.Jb.Pg("LoadResource","LoadDialogControlsStopwatch")}m1(Ca){if(L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){var Ra=this.$.da.za(465);Ra&&Ra.m1(5,Ca)}}nc(Ca,Ra){return!this.Zrd(Ca,Ra)}executeCommand(Ca,Ra,la){let ua=null;Ca=Ra.command;switch(Ca){case -864298118:ua=this.mmh(Ra,la);break;case -1010737776:ua=this.v8c(!0,Ra,la);break;case 2123420468:ua=
this.v8c(!1,Ra,la);break;case -1089513346:la=this.W0e(la);if(!this.EBb([v.D(la.SortOptions.SelectedRange)]))return f.TaskExtensions.Sj();ua=this.qMe(Ra,la);break;case -1032691499:case -764711886:case -2016161444:ua=this.l6i(Ra,la);break;case -207540907:case -1677817820:ua=this.gridView.Bb.E5(this.ha().ra.activeCell)?this.b6i():this.Z5i(Ra,la);break;case 1659552324:ua=this.qMe(Ra,this.W0e(la));break;case 368460465:ua=this.Cmh(Ra,la);break;case 529856798:ua=this.hmh(Ra);break;case 644342024:ua=this.xmh(Ra)}return ua||
T.a(Ca)}wc(Ca,Ra){if(Ca=1===Ca)switch(Ra.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:case -1032691499:case -764711886:case -2016161444:break;default:Ca=!1}return Ca}Kc(){return!1}ha(){return this.$&&this.gridView?this.gridView.ha:null}ZRf(Ca){Ca?this.gridView.jv(this.onContentReady):this.gridView.Ky(this.onContentReady);this.sgf=Ca}get ra(){return this.ha().ra}RCj(Ca){return!!this.sortOptions&&
O.a.equals(this.jof,Ca.yia,!0)}Zrd(Ca,Ra){const la=C.h(this.$).ha.ra.selectedRanges;return(new x.a(this.$.xa)).xm(Ca,Ra,la,this.gridView)}v8c(Ca,Ra,la){const ua=new h.a;this.Edf(ua,la,Ca);return this.EBb([v.D(ua.SelectedRange)])?this.gridView.Bb.E5(v.D(ua.SelectedRange))?this.umh(Ca):this.mod(ua,Ra):f.TaskExtensions.Sj()}mmh(Ca,Ra){d.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");let la=null;const ua=this.ha();ua&&(this.RCj(ua)?this.EBb(ua.ra.selectedRanges)&&
(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,la=this.mod(this.sortOptions,Ca)):la=this.v8c(!0,Ca,Ra));return la}EBb(Ca){return L.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")?this.$.isEditMode?this.$.Yp(Ca,!0,1):this.$.rYc(Ca,!0,1):!0}umh(Ca){this.mYh(Ca);return ib.Task.Ta(!0)}dWg(Ca){if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const Ra=this.gridView.Bb.Bj(this.ra.$c,!1);if(Ra)return new r.a(Ra.name,this.ra.activeCell.left-
Ra.usedRange.left,Ca.IsAscending)}return new t.a(Ca)}mod(Ca,Ra){this.gridView.Hf.rH(!1);const la=()=>this.dWg(Ca);return this.O9c((ua,xa,fb)=>qa(this.$.pa.ya,Ca,G.b(ua,this.yKh(Ra)),xa,fb,Ca),ua=>new A.a(141,0,ua,void 0,la),Ra,this.JBj(Ca))}JBj(Ca){if(!this.namedSheetViewPublic)return!1;const Ra=this.ra.$c,la=v.v(this.ra.$c,this.$),ua=this.gridView.Bb.G5(Ra,!0),xa=this.ra.Yba()&&this.gridView.Bb.akf(la),fb=this.gridView.Bb.fpi(la);Ca=(Ra.R5||Ra.y_)&&!Ra.isSingle&&(null==Ca.ExpandSortSelection?!1:
Ca.ExpandSortSelection)&&this.gridView.Bb.akf(la);return ua||xa||fb||Ca}b6i(){return this.$.Xc(-1556797033,w.a.Db,8,null)}Z5i(Ca,Ra){Ca=8===Ca.$e&&Ra&&void 0!==Ra[cb.Seb]&&null!==Ra[cb.Seb]?Ra[cb.Seb]:19===Ca.$e&&Ra&&void 0!==Ra[w.a.og]&&null!==Ra[w.a.og]?n.a.li(Ra[w.a.og]):this.aah();if(!this.EBb([v.D(Ca.SelectedRange)]))return f.TaskExtensions.Sj();C.h(this.$).Hf.rH(!1);let la=null;(Ra=Ra.TopCellAddress)&&(la=v.o(Ra,this.$));new Va(this.$,Ca,this.namedSheetViewPublic,la);return ib.Task.Ta(!0)}W0e(Ca){return Ca[cb.igh]}qMe(Ca,
Ra){const la=fb=>{this.S$e(fb)?this.F9e(fb.Errors[0]):(Ra.ShouldRestoreSelection&&this.hpa(Ra.SelectedRange,Ra.OriginalActiveCell),d.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${Ca.$e}`),this.OQj(Ra),this.m1(fb))},ua=()=>{Ra.ShouldRestoreSelection&&this.hpa(Ra.SelectedRange,Ra.OriginalActiveCell);d.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${Ca.$e}`)},
xa=()=>new y(Ra.SortOptions);return this.O9c((fb,Jb,Ob)=>qa(this.$.pa.ya,Ra.SortOptions,G.b(fb,la),G.a(Jb,ua),Ob,this.sortOptions),fb=>new A.a(187,0,fb,void 0,xa),null,Ra.ShouldPromptNamedSheetViewTeachingDialog)}hpa(Ca,Ra){Ca=v.D(Ca);C.h(this.$).ha.ra.$c.equals(Ca)||C.h(this.$).ha.updateSelection(Ca,v.C(Ra),0,void 0,void 0,void 0,!0)}aah(){const Ca={};Ca.ActiveCell=v.o(this.ra.activeCell,this.$);Ca.SelectedRange=v.v(this.ra.$c,this.$);Ca.FromAutoFilter=!1;Ca.ExpandSelection=null;return Ca}Cmh(Ca,
Ra){const la=this.Xaa();if(!la)return ib.Task.Ta(!1);const ua=this.$.pa.ya.Wb(),xa=()=>new bb.a(la);return B.a(this.$.userOperationManager,(fb,Jb,Ob)=>z.B(this.$.pa.ya,la,G.b(gb.a.p5a(Ga.a.Kpb,mb.a.toggleAutoFilter,fb),this.uXi),Jb,Ob,{selection:la,WOj:Ra.On},ua),fb=>new A.a(516,0,fb,64,xa),Ca)}hmh(Ca){const Ra=this.Xaa();if(!Ra)return ib.Task.Ta(!1);const la=this.gridView.Bb.Bj(this.ra.$c,!0);la&&d.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${la.type.toString()}`);
const ua=this.$.pa.ya.Wb(),xa=()=>new wa(Ra);return this.O9c((fb,Jb,Ob)=>rb(this.$.pa.ya,Ra,gb.a.p5a(Ga.a.lHa,mb.a.clearAutoFilter,fb),Jb,Ob,null,ua),fb=>new A.a(517,0,fb,64,xa),Ca)}O9c(Ca,Ra,la,ua=!0){return this.namedSheetViewPublic&&ua?this.namedSheetViewPublic.mTa().continueWith(xa=>{xa.result&&B.a(this.$.userOperationManager,Ca,Ra,la)}):B.a(this.$.userOperationManager,Ca,Ra,la)}xmh(Ca){const Ra=this.Xaa();if(!Ra)return ib.Task.Ta(!1);const la=this.$.pa.ya.Wb(),ua=()=>new ka(Ra);return B.a(this.$.userOperationManager,
(xa,fb,Jb)=>Za(this.$.pa.ya,Ra,gb.a.p5a(Ga.a.lHa,mb.a.Z8i,xa),fb,Jb,null,la),xa=>new A.a(518,0,xa,64,ua),Ca)}yKh(Ca){return(Ra,la)=>{var ua;J.b(Ra,-901005882)?(Ka.a(this.$).hd.sM(-901005882),this.YHd(la,Ca.command)):this.S$e(Ra)?this.F9e(Ra.Errors[0]):!J.a(Ra)&&Ra.Result&&(this.sortOptions=la,this.ETa=v.D(Ra.Result.ActualSortRange),this.jof=this.ha().yia,this.sgf||(this.selectedRange=this.ra.$c,this.selectedRange.equals(this.ETa)||(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&
(this.activeCell=v.o(this.ra.activeCell,this.$)),this.WFj())),(null===(ua=this.sortOptions)||void 0===ua?0:ua.ActiveCell)&&this.Y6f(this.sortOptions)&&(la=this.sortOptions.ActiveCell,la=new l.Range(la.FirstRow+1,la.FirstColumn+1,la.FirstRow+1,la.FirstColumn+1,!0,!1),this.BS(la),this.NZd(la)),this.m1(Ra))}}S$e(Ca){return J.b(Ca,-569193796)}F9e(Ca){Ka.a(this.$).hd.sM(-569193796);new fa(this.$,Ca)}YHd(Ca,Ra){(new W(la=>{const ua={};ua.ActiveCell=Ca.ActiveCell;ua.SelectedRange=Ca.SelectedRange;ua.ExpandSelection=
la;this.$.Xc(Ra,w.a.Db,8,{[cb.Seb]:ua})})).show()}WFj(){const Ca=this.ha();if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let Ra=v.C(this.activeCell);this.ETa.Ke(Ra)||(Ra=this.ETa.topLeft);Ca.updateSelection(this.ETa,Ra,0,void 0,void 0,void 0,!0)}else Ca.updateSelection(this.ETa,Ca.ra.activeCell,0,void 0,void 0,void 0,!0);this.ZRf(!0)}Xaa(){const Ca=this.ha();if(!Ca)return d.ULS.shipAssertTag(537151573,0,!!Ca,"SelectionManger is null"),null;
this.gridView.Hf.rH(!1);return v.v(Ca.ra.$c,this.$)}fMb(){this.jc&&this.jc.fp&&(this.Be=this.jc.fp,this.vb=this.jc.Qbc())}mYh(Ca){if(this.$.isEditMode&&(this.jc=this.gridView.Bb.xp(this.ra.activeCell))){this.activeCell=v.o(this.ra.activeCell,this.$);if(this.jc&&this.jc.fp){var Ra=this.jc.fp.CurrentCol;if(this.jc.fp.CurrentRow===this.activeCell.FirstRow&&Ra===this.activeCell.FirstColumn){this.fMb();this.applyPivotSort(Ca);return}}this.$.pa.ya.Wb();Ra=new A.a(228,0,(la,ua,xa)=>z.l(this.$.pa.ya,this.activeCell,
G.b(la,this.ZPi),G.a(ua,this.YPi),xa,Ca),16);this.$.userOperationManager.Ic(Ra,null)}}applyPivotSort(Ca){if(this.jc&&this.vb&&this.activeCell&&this.Be){var Ra=8===this.Be.CellArea,la=1===this.Be.CellArea||2===this.Be.CellArea;(Ra||la)&&8!==this.Be.CellType&&4!==this.Be.CellType&&(Ra?B.a(this.$.userOperationManager,(ua,xa,fb)=>z.b(this.$.pa.ya,this.activeCell,Ca?1:2,this.vb.Caption,ua,xa,fb,null),ua=>new A.a(1015,0,ua,void 0,null),null):(Ra=1===this.Be.CellArea?1:2,this.$.ma(682)?m.a.naps(this.$.domElement,
this.activeCell.FirstRow,this.activeCell.FirstColumn,this.jc.externalSourceIndex,this.vb.Index.toString(),this.vb.Caption,this.jc.isOlap?"":this.vb.Caption,Ra,Ca):m.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.jc.externalSourceIndex,this.vb.Index.toString(),Ca)))}}OQj(Ca){this.Y6f(Ca.SortOptions)&&(Ca.TopCellAddress?Ca=v.C(Ca.TopCellAddress):(Ca=Ca.OriginalActiveCell,Ca=new l.Range(Ca.FirstRow+1,Ca.FirstColumn+1,Ca.FirstRow+1,Ca.FirstColumn+1,!0,!1)),this.BS(Ca))}BS(Ca){xb.a.ola(this.$)&&
f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,430,431,1),Ra=>{Ra.result.Lea(Ca);d.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}NZd(Ca){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,476,475,0),Ra=>{Ra.result.NZd(Ca,0);d.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},
this.$.la,3)}l6i(Ca,Ra){if(!this.EBb(this.ra.selectedRanges))return f.TaskExtensions.Sj();const la=new h.a;this.Edf(la,Ra);la.SortConditions=[this.qdh(Ca)];la.OperationType=2;return this.mod(la,Ca)}qdh(Ca){const Ra=this.gridView.Sb(this.ra.activeCell);let la=new cc.a;la.IsAscending=!0;switch(Ca.command){case -1032691499:Ra.gyb?(Ca=ic.a.rp(Ra.backgroundColor),la.SortColor=Ca.yS(!0)):la.SortColor=cb.NoColor;la.SortConditionType=1;break;case -764711886:la.SortColor=Ra.J2c===cb.NoColor?cb.NoColor:ic.a.Pwe(Ra.J2c);
la.SortConditionType=2;break;case -2016161444:Ra.myb?(la.SortIcon=Ra.cell.kkc,la.SortIconSet=Ra.lkc):(la.SortIcon=cb.y3d,la.SortIconSet=cb.y3d);la.SortConditionType=3;break;default:d.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return la}XOj(Ca){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),Ra=>{void Ra.result.iCc(Ca,"Filter")},this.$.la,3)}Edf(Ca,Ra,la=!0){Ca.OperationType=
0;Ca.IsAscending=la;Ca.HasHeader=!0;Ca.GuessHeader=!0;Ca.SortTopToBottom=!0;Ca.ExpandSortSelectionSupported=!0;Ra&&Ra[cb.Seb]?(Ra=Ra[cb.Seb],Ca.ActiveCell=Ra.ActiveCell,Ca.SelectedRange=Ra.SelectedRange,Ca.ExpandSortSelection=Ra.ExpandSelection):(Ca.ActiveCell=v.o(this.ra.activeCell,this.$),Ca.SelectedRange=v.v(this.ra.$c,this.$),Ca.ExpandSortSelection=null)}Y6f(Ca){return!Ca.SortConditions||Ca.SortConditions.some(Ra=>0===Ra.SortConditionType)}}cb.igh="CustomSortCommandData";cb.Seb="SortCommandData";
cb.y3d=-1;cb.NoColor=0;Object(u.a)(cb,"SortCommandHandler",null,[223]);class lb extends b.a{constructor(Ca){super(Ca)}ld(){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Ya),Ca=>{this.Yc([new cb(this.$,Ca.result)])},this.$.la,3)}static ka(Ca){b.a.Nd(160,new lb(Ca))}}Object(u.a)(lb,"SortCommandHandlerFactory",b.a,[]);H=a(222);class Y{constructor(Ca){Ca.da.Ga(446,this)}yeh(Ca,Ra){new fa(Ca,Ra)}}Object(u.a)(Y,"SortUtil",null,[336]);class Oa extends H.a{constructor(Ca){super();
this.$=Ca;this.Fb()}create(){let Ca=this.$.da.za(446);Ca||(Ca=new Y(this.$),this.$.da.Ga(446,Ca));this.ob(Ca)}static ka(Ca){Ca.da.Ga(447,new Oa(Ca))}}Object(u.a)(Oa,"SortUtilFactory",H.a,[]);a.d(E,"a",function(){return Wa});const Wa=()=>{c.a.Fa(Ca=>{lb.ka(Ca);Oa.ka(Ca)})}},1157:function(u,E,a){u=a(0);var c=a(552),b=a(15),e=a(134),f=a(54);class d extends e.StandardDialog{constructor(){super();this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose)}displayError(qa,rb){this.WLe(qa,rb,f.a.Vnj)}WLe(qa,rb,Za){b.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",Za);this.fA(Za,qa,rb,null)}j8c(qa,rb){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.fA(f.a.Xnj,qa,rb,null,!0)}}Object(u.a)(d,"ErrorDialog",e.StandardDialog,[287]);var h=a(84);e=a(1050);var m=a(146);class l{static get qg(){return m.a.gq(l.ol,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}l.ol="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(u.a)(l,"FileNameDialogHtml",null,[]);var w=a(4),n=a(14),y=a(45),t=a(85),r=a(86),v=a(30);class B extends e.a{constructor(qa,rb,Za,gb,mb,Ga,ib,cc){super(qa,rb,Za,gb,mb,Ga,cc);this.Dqa=this.SRc=this.fz=null;this.MXg=CommonUIStrings.l_SaveToAnotherFolder;this.qg=l.qg;this.Fe="FileNameDialog-SaveToSharePoint";this.nmb=ib;this.Pyg=cc}sQ(qa){const rb=v.a.Rq(w.AFrameworkApplication.sm.tn),Za=w.AFrameworkApplication.breadcrumbFolderName,gb=w.AFrameworkApplication.breadcrumbBrandName,mb={["txtFileName"]:qa||
rb};let Ga=CommonUIStrings.L_SaveAs;2===w.AFrameworkApplication.sa.Pa.Gj&&(Ga=CommonUIStrings.L_SaveACopy);this.initializeAndShow(Ga,Object(h.a)(this,this.G$b,"fileNameDialogHandler"),mb);this.ELe(qa,rb);this.jJa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");w.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.fz=document.getElementById("anotherFolder"),qa=document.getElementById("folderLocation"),this.SRc=
r.a.Nte(qa,this.fz,"anotherFolderDescribedBy"),this.fz.className="WACButton WACDialogButtonNormal",qa=!1,Za&&Za.length?(this.koe(this.fz,this.SRc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,gb,Za)),qa=this.JFg(gb,Za)):this.koe(this.fz,this.SRc,CommonUIStrings.l_CurrentOnlineFolder),this.JGg(this.fz),this.MFg(this.fz),qa?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.fz,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,
50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.fz,"SaveToAnotherLocationOne"),y.a.addHandler(this.fz,n.a.click,Object(h.a)(this,this.KDd,"onSaveToAnotherLocationClick")),y.a.addHandler(this.fz,n.a.Pb,Object(h.a)(this,this.lGf,"onSaveToAnotherLocationKeyDown")))}JFg(qa,rb){let Za;Za=!1;const gb=document.getElementById("currentLocation");gb.innerText="";const mb=this.M3e(gb,qa),Ga=this.M3e(gb,rb);let ib=255,cc=255;255<mb+Ga&&(ib=Math.max(238,408-mb),cc=
Math.max(170,408-Ga),Za=!0);this.iIg(gb,qa,cc,rb,ib);return Za}M3e(qa,rb){const Za=document.createElement("div");Za.innerText=rb;Za.style.visibility="hidden";qa.appendChild(Za);rb=Za.clientWidth;qa.removeChild(Za);return rb}iIg(qa,rb,Za,gb,mb){rb&&(this.ioe(qa,rb,Za),this.$Hg(qa));gb&&this.ioe(qa,gb,mb)}ioe(qa,rb,Za){const gb=document.createElement("div");gb.innerText=rb;gb.title=rb;gb.className="SaveToAnotherFolderBreadcrumb";gb.style.maxWidth=Za.toString()+"px";qa.appendChild(gb)}$Hg(qa){const rb=
document.createElement("span");rb.id="FolderSeparator";const Za=document.createElementNS("http://www.w3.org/2000/svg","svg");Za.setAttribute("class","SeparatorCaret");const gb=document.createElementNS("http://www.w3.org/2000/svg","polygon");gb.setAttribute("points","1 4 1 11 5 7.5");Za.appendChild(gb);rb.appendChild(Za);qa.appendChild(rb)}koe(qa,rb,Za){Za=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Za);rb&&(rb.innerText=Za);qa.tabIndex=0;qa.setAttribute(r.a.Ld,r.a.ot)}MFg(qa){const rb=
document.createElement("span");rb.id="anotherFolderText";rb.innerText=this.MXg;rb.className="AnotherFolderTextSpan";qa.appendChild(rb)}JGg(qa){const rb=document.createElement("span");rb.className="cui-img-cont-float cui-img-16by16 ";this.Dqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Dqa.setAttribute("class","FolderIconSVG");const Za=document.createElementNS("http://www.w3.org/2000/svg","path");Za.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.Dqa.appendChild(Za);rb.appendChild(this.Dqa);qa.appendChild(rb)}lGf(qa){!qa||qa.keyCode!==t.a.Lh&&qa.keyCode!==t.a.AX||this.KDd(qa)}KDd(){if(this.sJ){const qa=v.a.D4(w.AFrameworkApplication.fileName);let rb=this.sJ.value;this.hide();rb&&""!==rb&&""!==qa||1===this.sa.state?(""!==qa&&(rb+=qa),this.H$b(rb)?this.$s.create().displayError(1,rb,!1):this.nmb.start(rb,this.Pyg)):this.$s.create().displayError(2,rb,!1)}}s0g(qa){this.fz&&this.Dqa&&(qa?(this.fz.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.fz,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Dqa,"DisabledFolderIconSVG")):(this.fz.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.fz,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Dqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.fz,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Dqa,"DisabledFolderIconSVG"))))}$jd(){super.$jd();this.s0g(!!this.sJ&&""!==this.sJ.value)}dispose(){this.fz&&(y.a.removeHandler(this.fz,n.a.click,Object(h.a)(this,
this.KDd,"onSaveToAnotherLocationClick")),y.a.removeHandler(this.fz,n.a.Pb,Object(h.a)(this,this.lGf,"onSaveToAnotherLocationKeyDown")),this.fz=null);super.dispose()}}Object(u.a)(B,"FileNameDialog",e.a,[303]);var A=a(682),z=a(553),x=a(187),D=a(812),J=a(904),L=a(97),T=a(136);class O{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(u.a)(O,"SaveAsDialogInput",null,[]);class G{constructor(){this.properties=this.friendlyPath=this.folderName=
null}}Object(u.a)(G,"SaveLocation",null,[]);var C=a(373),H=a(189);class I{constructor(qa,rb,Za,gb,mb,Ga,ib,cc,ic){this.cOc=null;this.DA="";this.nmb=qa;this.$s=rb;this.Mh=ic;this.Mga=Za;this.ef=mb;this.Zv=gb;this.$Fa=ib;this.yYa=cc;Ga&&(this.cOc=new c.a(()=>new D.a(Ga.value,null)))}fQh(){const qa=new A.a(z.a.Yj());qa.ia("type","currentHost");return Object.assign(new G,{folderName:this.Zv.breadcrumbFolderName,friendlyPath:this.Zv.breadcrumbBrandName,properties:qa})}Nqi(qa){return!!qa&&"ClassicMru"===
qa.type&&!!qa.service_info&&!!qa.service_info.service_id&&-1!==qa.service_info.service_id.indexOf("SHAREPOINT")}A0h(){if(!this.cOc||!this.$Fa)return null;var qa=this.cOc.value.WZ("SaveAsToSharePointDialog",!1);if(!qa||3!==qa.state||!qa.evf)return null;qa=qa.evf;const rb=new x.a;let Za=0,gb=0;for(var mb=0;mb<qa.length;mb++){var Ga=qa[mb];if(!this.Nqi(Ga))continue;Za++;if(!Ga.sharepoint_info)continue;const ib=Ga.url,cc=Ga.sharepoint_info.site_url,ic=Ga.title;Ga=J.b(Ga,w.AFrameworkApplication.isRtl);
if(!(ib&&cc&&ic&&Ga))continue;gb++;const xb=new A.a(z.a.Yj());xb.ia("type","SharePoint");xb.ia("siteUrl",cc);xb.ia("folderUrl",ib);gb++;rb.add(Object.assign(new G,{folderName:ic,friendlyPath:Ga,properties:xb}))}mb=new Map;mb.set("NumPlaces",qa.length.toString());mb.set("NumSharepointPlaces",Za.toString());mb.set("placesWithMetadata",gb.toString());L.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",mb);0<Za&&(gb?.5>1*gb/Za&&L.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"PartialPlacesMetadataMissing",!1,!1,null):L.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return rb}VQh(){const qa=new x.a;qa.add(this.fQh());const rb=this.A0h();rb&&qa.addRange(rb);return Object.assign(new O,{enableMoreLocations:!w.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.DA,extension:v.a.D4(this.Zv.tn),saveLocations:qa.toArray(),scenario:"SaveToSharePoint"})}Tbc(){const qa=Object(h.a)(this,this.VQh,
"getDialogInput"),rb={};rb.inputPropsCallback=qa;return rb}sQ(qa){this.DA=qa;this.DA||(this.DA=String.format(CommonUIStrings.l_SaveACopy_Filename,v.a.Rq(this.Zv.tn)));qa={["id"]:"SaveAsDialog",["bodyControls"]:this.Tbc()};let rb=CommonUIStrings.L_SaveAs;2===this.ef.Pa.Gj&&(rb=CommonUIStrings.L_SaveACopy);const Za=new m.a(!1,!1,!0);Za.Rb=1;Za.Fe="SaveAsDialog";Za.oc(1,CommonUIStrings.l_SaveButtonLabel);Za.initializeAndShow(rb,Object(h.a)(this,this.Rnj,"saveAsDialogHandler"),qa)}YEj(qa,rb){qa&&""!==
qa&&""!==rb||1===this.ef.state?this.Mqi()?this.oxi(qa,rb):(""!==rb&&(qa+=rb),this.nmb.start(qa,this.Mh)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.$s.create().displayError(2,qa,!1))}oxi(qa,rb){L.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const Za=this.yYa.iHe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.yYa.Rfd(Za).then(gb=>{if(gb&&0<gb.length){const mb=
gb[0][C.a.k1i];gb=gb[0][C.a.cLf];if(""!==mb&&""!==gb)this.$Fa.voa(gb,qa+rb,mb,this.Mh),L.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.$s.create().displayError(0,qa,!1);const Ga=T.a.fs();Ga&&(Ga.set("SiteUrlAvailable",""===mb?"false":"true"),Ga.set("FolderUrlAvailable",""===gb?"false":"true"));L.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new H.a,{extendedProperties:Ga}))}}else this.$s.create().displayError(0,qa,
!1),L.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(gb=>{"Canceled"===gb?((gb=T.a.fs())&&gb.set("IsCanceled","true"),L.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new H.a,{extendedProperties:gb}))):L.Health.instance.recordKpiFailure("SaveACopySFP",gb,!1,!1,null)})}Mqi(){return this.yYa?this.yYa.tsd():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Rnj(qa,rb){if(rb&&1===qa){qa=rb.fileName;var Za=v.a.D4(this.Zv.tn);
rb.moreLocationsSelected&&this.YEj(qa,Za);if(rb.locationCallback){var gb=rb.locationCallback();gb?gb.properties&&"currentHost"===gb.properties.na("type")?this.Mga.voa(qa+Za,!1,this.Mh):gb.properties&&"SharePoint"===gb.properties.na("type")?(rb=gb.properties.na("siteUrl"),gb=gb.properties.na("folderUrl"),this.$Fa.voa(gb,qa+Za,rb,this.Mh)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,
216,10,"locationCallback is empty")}}}Object(u.a)(I,"ReactSaveAsDialog",null,[303]);class M{constructor(qa,rb,Za,gb,mb,Ga,ib,cc=null,ic=null,xb=null){this.La=rb;this.lb=qa;this.MX=gb;this.Mga=Ga;this.$s=mb;this.ef=Za;this.Qie=ib;this.vxg=cc;this.$Fa=ic;this.yYa=xb}create(qa){return this.ef&&this.ef.Pa.Hv?new I(this.Qie,this.$s,this.Mga,w.AFrameworkApplication.sm,this.ef,this.vxg,this.$Fa,this.yYa,qa):new B(this.lb,this.La,this.ef,this.MX,this.$s,this.Mga,this.Qie,qa)}}Object(u.a)(M,"FileNameDialogFactory",
null,[286]);class Q{constructor(qa,rb,Za,gb){this.Yo=this.llb=null;this.kjb=qa;this.ef=Za;this.kzg=gb;this.qEa=new c.a(()=>new D.a(rb.value,Object(h.a)(this,this.bxb,"getMoreInfoEventReceived")))}get UIf(){this.llb||(this.qEa.value.WZ("Save As",!0),this.Yo&&this.Yo.IR&&this.Yo.IR.length&&(this.llb=this.yXh(this.Yo.IR)));return this.llb}start(qa){if(!this.UIf)if(w.AFrameworkApplication.breadcrumbFolderUrl&&w.AFrameworkApplication.breadcrumbFolderUrl.length)this.llb=w.AFrameworkApplication.breadcrumbFolderUrl;
else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Yo),!1;const rb=this.kzg();rb.qFj();const Za=rb.gYh();if(!Za)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.kjb.start((gb,mb)=>{rb.hide();qa(gb,mb)},()=>{this.sPa(rb)},Za,this.llb);return!0}sPa(qa){qa.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}yXh(qa){qa=
qa.toLowerCase();qa.endsWith("/")||(qa+="/");const rb=qa.indexOf("/documents/");return-1!==rb?qa.substring(0,rb+1)+"_layouts/15/onedrive.aspx":""}bxb(qa){this.Yo||3!==qa.state||(this.Yo=qa)}}Object(u.a)(Q,"OneDriveFilePickerHelper",null,[289]);class U extends m.a{constructor(){super()}qFj(){this.JIc="FilePickerDialog";this.qg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Fe="PickerDialog-MsoSp";this.showDialog("",null)}gYh(){return document.getElementById("FilePickerDiv")}VI(){}kAa(){}}
Object(u.a)(U,"PickerDialog",m.a,[288]);var N=a(641),W=a(834),X=a(374),sa=a(27),da=a(105),S=a(25);class oa{constructor(qa,rb,Za,gb,mb,Ga,ib){this.lb=qa;this.VJc=Za;this.La=rb;this.nmb=gb;this.kjb=mb;this.KPc=Ga;this.Hrg=ib}Hg(){const qa=this.kjb.a5a();qa?sa.a.fla||this.lb.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Ne(S.a.saveToSharePoint,da.a.frame,Object(h.a)(this,this.a_f,"saveToSharePointActionDispatcher"),64):(qa.k9a.continueWith(rb=>{rb.Xf&&this.kjb.YCd(rb)}),this.G2b()):b.ULS.sendTraceTag(25180162,
216,15,"Failure with OneDrive API download as the js url is empty.")}G2b(){X.a.dKd(Object(h.a)(this,this.a_f,"saveToSharePointActionDispatcher"));X.a.N9c([new W.a(S.a.saveToSharePoint,da.a.frame,0)],this.kjb.a5a())}get r8a(){return this.lb.qa("SaveToAnotherFolderBrsIsEnabled")}get Kze(){return this.lb.qa("UserCanWriteRelative")}a_f(qa,rb,Za,gb,mb){return rb.contextId!==da.a.frame||qa!==S.a.saveToSharePoint?2:this.r8a&&(this.KPc.UIf||this.Kze)?1===Za?N.SessionStatusManager.instance.Q5a||w.AFrameworkApplication.u5?
8:this.Hrg()?32:8:2===Za?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(mb&&mb.SaveEntryPoint&&"VersionHistory"===mb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Kze?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.VJc.create(mb).sQ(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.nmb.start(null,mb)),32):8:8}}Object(u.a)(oa,"SaveToSharePointActor",
null,[]);class K{constructor(qa,rb,Za,gb){this.Mh=this.Tee=null;this.$Fa=qa;this.$s=rb;this.KPc=Za;this.ef=gb}start(qa,rb){b.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Tee=qa;this.Mh=rb;this.KPc.start((Za,gb)=>{this.G5i(Za,gb)})||this.KUd()}G5i(qa,rb){if(qa)this.onSuccess(rb);else this.I6(rb)}KUd(){1!==this.ef.state&&this.$s().j8c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(qa){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");
if(qa&&qa.data&&qa.data.value&&qa.data.value.length&&qa.data.value[0].sharePoint){const rb=qa.data.value[0].sharePoint.url;qa=qa.data.value[0].sharePoint.listUrl;let Za=null;if(rb&&(Za=qa?this.T0h(qa):this.S0h(rb))){this.$Fa.voa(rb,this.Tee,Za,this.Mh);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!rb,!Za)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.KUd()}S0h(qa){qa.endsWith("/")||
(qa+="/");let rb=0;for(let Za=0;Za<qa.length;Za++)if("/"===qa.charAt(Za)&&5===++rb)return qa.substr(0,Za);return null}T0h(qa){qa.endsWith("/")&&(qa=qa.substring(0,qa.length-1));const rb=qa.lastIndexOf("/");return-1!==rb?qa.substring(0,rb):null}I6(qa){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");qa&&qa.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",qa.error.errorCode,qa.error.message):b.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.KUd()}}Object(u.a)(K,"SaveToSharePointManager",null,[573]);var ea=a(80);class ya{constructor(qa,rb,Za,gb,mb,Ga,ib,cc){this.gGa=qa;this.DA=rb;this.EWa=gb;this.LQc=Ga;this.d9=Za;this.OBg=mb;this.Nfa=ib;this.Mh=cc}execute(qa,rb){if(!w.AFrameworkApplication.Ng&&w.AFrameworkApplication.Dd){var Za=this.gGa+this.Nfa;Za=ea.a.Nl(Za,"fu",v.a.mf(this.d9));Za=ea.a.Nl(Za,"su",v.a.mf(this.OBg));Za=ea.a.Nl(Za,"fn",v.a.mf(this.DA));Za=ea.a.Nl(Za,"n",v.a.mf((new Date).getTime().toString()));
this.Mh&&this.Mh.FileDownloadUrl&&(Za=ea.a.Nl(Za,"furl",v.a.mf(this.Mh.FileDownloadUrl)));Za=Za+"&"+this.LQc;this.EWa&&this.EWa.length?Za=ea.a.Nl(Za,"fnn",v.a.mf(this.EWa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");w.AFrameworkApplication.Dd.Pm(Za,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,qa,rb,null,void 0,void 0,void 0,void 0,"9")}}}Object(u.a)(ya,"SharePointSaveAsCaller",
null,[590]);class ha{constructor(qa){this.hGa=qa.appSettings.SaveAsToHostWebServiceBase;this.DA=qa.appSettings.FileName;this.Nfa=qa.Xa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(qa,rb,Za,gb){return new ya(this.hGa,this.DA,qa,rb,Za,w.AFrameworkApplication.Ii,this.Nfa,gb)}}Object(u.a)(ha,"SharePointUploadCallerFactory",null,[572]);var La=a(41),Ia=a(40),ra=a(240),pa=a(685),ba=a(164),fa=a(642),Ka=a(766);class aa{constructor(qa,rb,Za,gb,mb){this.Nm=this.zDa=null;this.nGc=!1;this.ORc=
this.d9=null;this.dUc=rb;this.Mlb=Za;this.$s=gb;this.ef=mb;this.La=qa}voa(qa,rb,Za,gb){this.nGc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.GNb();this.d9=qa;gb&&gb.SaveEntryPoint&&(this.ORc=gb.SaveEntryPoint);this.zDa=this.dUc.create(qa,rb,Za,gb);gb&&"true"===gb.SkipSaveToHost?this.zQ():this.tHh()}tHh(){const qa=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.zQ()};32!==this.La.ae(S.a.aSa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.zQ()},qa])&&qa()}zQ(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.zDa.execute(Object(h.a)(this,this.lVi,"onSaveToSharePointUploadFinished"),Object(h.a)(this,this.kVi,"onSaveToSharePointUploadFailed"))}lVi(qa){if(qa&&qa.data&&qa.data.ue){var rb;if(({At:rb}=La.d(qa.data.ue)).returnValue)if(rb.StatusCode!==ra.a.lP&&rb.StatusCode!==
ra.a.Lsb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",qa.data.status,rb.StatusCode),rb.StatusCode!==ra.a.QWf&&this.uMe(qa.data.status)||(this.Nda(rb.StatusCode.toString()),this.cEj(rb.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.MMd();try{rb.NewDocumentUrl?this.VQa(rb.NewDocumentUrl):this.WQa()}catch(Za){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
Za.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ka.a.Yfb(qa.data.ue)}),this.j8b()||(this.Nda("Failed to deserialize response"),this.ENb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.j8b()||(this.Nda("Unknown"),this.ENb())}kVi(qa){qa&&qa.data?this.uMe(qa.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Nda(pa.a[qa.data.status]),this.ENb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.j8b()||(this.Nda("Unknown"),this.ENb()))}j8b(){if(!this.nGc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.nGc=!0,this.zQ(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}uMe(qa){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",qa);return this.j8b()}WQa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ia.a.lf(this.d9,Ia.a.CX(3),void 0,"UploadToSharePointManager.RedirectToFolder")}VQa(qa){let rb=
!1,Za=!1;w.AFrameworkApplication.fa&&(rb=w.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),Za=w.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",qa,rb);if(rb&&Za){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const gb={};gb[C.a.QQa]="1";gb[C.a.documentUrl]=qa;gb[C.a.reason]=fa.a.saveAs;w.AFrameworkApplication.jV().execute(mb=>
{mb.Pj(ba.a.tua,gb)})}else Ia.a.lf(qa,Ia.a.CX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}GNb(){this.ef&&1===this.ef.state||(this.Nm=this.Mlb(),this.Nm.message=CommonUIStrings.l_CommentProgressTooltip,this.Nm.Rb=5,this.Nm.It=!1,this.Nm.EBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}qJa(){this.Nm&&(this.Nm.close(),this.Nm=null)}ENb(){this.vj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}bFj(){this.vj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}kEj(){const qa=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.vj(CommonUIStrings.l_SaveAsFileTooLargeTitle,qa,f.a.Snj)}vj(qa,rb,Za=f.a.Wnj){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",qa,rb);this.qJa();1!==this.ef.state&&this.$s().WLe(qa,rb,Za)}cEj(qa){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",qa);switch(qa){case ra.a.tfg:this.bFj();break;case ra.a.QWf:this.kEj();break;default:this.ENb()}}MMd(){"VersionHistory"===this.ORc&&
this.La.processAction(S.a.fvc,2)}Nda(qa){"VersionHistory"===this.ORc&&this.La.ae(S.a.OMd,2,{["FailureReason"]:qa})}}Object(u.a)(aa,"UploadToSharePointManager",null,[544]);var ja=a(248),Va=a(783),bb=a(518),wa=a(55);class ka{constructor(){this.Jra=this.dPc=this.ZOc=this.gb=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Wh(qa){this.gb=qa;this.ZOc=bb.a.kr(qa.Ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.dPc=bb.a.kr(qa.Ub("Common.IEventEmitter<Common.IMruResult>"));
this.Jra=bb.a.kr(qa.Ub("Common.App.SharedFilePicker.ISharedFilePicker"));wa.Task.WAA.call(null,this.ZOc,this.dPc,this.Jra).continueWith(()=>{this.Jaj()})}Jaj(){this.gb.register(ha,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Fc(()=>new ha(w.AFrameworkApplication.fa)).xc();this.gb.register(aa,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Fc(()=>new aa(w.AFrameworkApplication.ub,
this.gb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Va.a).create(),()=>new d,w.AFrameworkApplication.sa)).xc();this.gb.register(K,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Fc(()=>new K(this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new d,this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),w.AFrameworkApplication.sa)).xc();this.gb.register(Q,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Fc(()=>
new Q(this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.ZOc.result),w.AFrameworkApplication.sa,()=>new U)).xc();this.gb.register(M,"Common.App.SaveToSharePoint.FileNameDialogFactory").Fc(()=>new M(w.AFrameworkApplication.fa,w.AFrameworkApplication.ub,w.AFrameworkApplication.sa,w.AFrameworkApplication.sa.Pa,this.gb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.gb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new c.a(()=>this.dPc.result),this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Jra?this.Jra.result:null)).xc();this.gb.register(oa,"Common.App.SaveToSharePoint.SaveToSharePointActor").Fc(()=>new oa(w.AFrameworkApplication.fa,w.AFrameworkApplication.ub,this.gb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>w.AFrameworkApplication.sa.NZg)).xc();w.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.gb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Hg()}static main(){ja.a.instance.Fi(new ka)}}Object(u.a)(ka,"PackageManager",null,[4,5]);a.d(E,"a",function(){return ta});const ta=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");ka.main()}},1166:function(u,E,a){var c=a(9);u=a(0);var b=a(692),
e=a(50),f=a(37),d=a(1),h=a(183);class m{constructor(ka,ta){this.$=ka;this.presentModeManager=ta}nc(){return!1}wc(ka,ta){if(!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(ta.command){case 642419866:return!0;case 588342182:return this.presentModeManager.Hz;default:return!1}}executeCommand(ka,ta){ka=f.TaskExtensions.Sj();ta=ta.command;switch(ta){case 642419866:this.presentModeManager.vzc(!this.presentModeManager.Hz);this.presentModeManager.$g("TogglePresentMode");
break;case 588342182:this.presentModeManager.f8a=!this.presentModeManager.f8a;this.presentModeManager.e8f(this.presentModeManager.f8a,"TogglePresentModeOverlay");this.presentModeManager.$g("TogglePresentModeOverlay");break;default:ka=h.a(ta)}return ka}Kc(){return!1}}Object(u.a)(m,"PresentModeCommandHandler",null,[223]);class l extends b.a{constructor(ka){super(ka)}ld(){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,423,424,this.Ya),ka=>{this.Yc([new m(this.$,ka.result)])},this.la,3)}static ka(ka){b.a.Nd(420,
new l(ka))}}Object(u.a)(l,"PresentModeCommandHandlerFactory",b.a,[]);var w=a(222),n=a(15),y=a(128),t=a(4),r=a(111),v=a(83);class B{}B.Ivh="ewa-presentMode-overlay";B.Jvh="ewa-presentMode-panel-container";B.Kvh="ewa-presentMode-rowHdrParent-container";Object(u.a)(B,"CssClassNames",null,[]);var A=a(19),z=a(5),x=a(149),D=a(292),J=a(132),L=a(371),T=a(188);a(59);var O=a(113),G=a(435),C=a(12),H=a(11),I=a(99),M=a(347),Q=a(21),U=a(133),N=a(421),W=a(107),X=a(14),sa=a(259),da=a(247),S=a(171),oa=a(46);class K{constructor(ka){this.Hve=
this.tQa=this.OGd=this.PGd=this.lda=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.Irc={};this.Hrc={};this.pQa=null;this.xLf=0;this.onKeyDown=ta=>{ta=ta.Ca;if(9===ta.keyCode){var qa=this.lda.querySelectorAll(C.DOMElementExtensions.Gr);const rb=C.DOMElementExtensions.um(qa);qa=C.DOMElementExtensions.nB(qa);C.DOMElementExtensions.kBa(ta,rb,qa);return!0}return!1};this.am=()=>{this.$.da.$a(337,ta=>{this.tQa.getPresentModeFloatieControlsMap().then(qa=>{const rb={};for(let Za=0;Za<qa.length;Za++)rb[qa[Za].controlId]=
qa[Za].modelType;qa=ta.n7.u5a(rb);0<qa.length&&appChrome.api.dispatch(qa);this.poj()})})};this.$=ka}dispose(){this.$=this.OGd=this.PGd=this.lda=this.tQa=null}Ydi(){window.requestAnimationFrame(()=>{this.lda=document.createElement("div");this.$.qu.insertBefore(this.lda,this.$.qu.lastChild);this.lda.id=this.$.Eb+z.a.lac;this.lda.classList.add(B.Jvh);this.PGd=document.getElementById(this.$.Eb+z.a.a7c);this.OGd=[this.$.aF];this.isInitialized=!0});this.tQa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();
this.tQa.initializePresentModeFloatie()}Z1h(){const ka={};ka.PollingCountPerCaller=r.a.toJSON(this.Hrc);ka.PollingDurationPerCaller=r.a.toJSON(this.Irc);return ka}JUd(ka){this.isInitialized?ka?(this.tQa.showPresentModeFloatie(this.lda,this.PGd,this.OGd),this.$g("ShowOrHideFloatiePanel"),this.Kbj()):(this.tQa.hidePresentModeFloatie(),this.RTj()):n.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}$g(ka){this.xLf=H.HelperMethods.Tb();
this.pQa=ka;this.Hve=S.AsyncMethodContext.Er(this.am,100,oa.a.s4i+ka,this.Hve)}get mc(){return this.lda}get Gf(){this.tQa.updatePresentModeFloatieShyState(2);return!!this.lda}get de(){return da.a.MMf}kg(ka,ta){if(ta)return!1;ka=C.DOMElementExtensions.um(this.lda.querySelectorAll(C.DOMElementExtensions.Gr));if(!ka)return n.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;ka.focus();return!0}mh(ka){return C.DOMElementExtensions.yf(this.mc,
ka)}sj(){}Zj(){}Kbj(){sa.a(this.$).ai(this);this.$.da.$a(15,ka=>{this.ewaAccessibilityManager=ka;this.ewaAccessibilityManager.mode=5});W.KeyInputManager.instance.ta(X.a.Pb,this.mc,this.onKeyDown)}RTj(){sa.a(this.$).Xz(this);Q.h(this.$).R0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);W.KeyInputManager.instance.Ba(X.a.Pb,this.mc,this.onKeyDown)}poj(){const ka=H.HelperMethods.Tb()-this.xLf,ta=this.Irc[this.pQa]?this.Irc[this.pQa]:0;this.Irc[this.pQa]=ta>ka?ta:ka;this.Hrc[this.pQa]=
this.Hrc[this.pQa]?this.Hrc[this.pQa]+1:1}}Object(u.a)(K,"PresentModeFloatieManager",null,[769,36,2]);var ea=a(7),ya=a(61);class ha{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}}Object(u.a)(ha,"OverlayCavityInfo",null,[]);class La{constructor(){this.height=this.width=0}}Object(u.a)(La,"OverlayContainerInfo",null,[]);class Ia{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(u.a)(Ia,"PresentModeOverlayProps",
null,[]);class ra{constructor(ka){this.m0a=this.QGd=null;this.$=ka;this.gridView=Q.h(this.$)}Iei(){this.QGd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>{this.m0a=Array(5);let ka,ta;for(let qa=1;4>=qa;qa++)ka=document.createElement("div"),C.DOMElementExtensions.setVisible(ka,!1),ka.id=`${"PresentModeOverlay"}-${qa}`,C.DOMElementExtensions.toggleCssClass(ka,B.Ivh,!0),ta=this.gridView.Bf(qa).domElement,ta.insertBefore(ka,ta.firstChild),
this.m0a[qa]=ka})}d8f(ka){ka&&this.qXj();for(let ta=1;4>=ta;ta++)this.Ijf(ta)&&C.DOMElementExtensions.setVisible(this.m0a[ta],ka);C.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-overlay",ka)}qXj(){const ka=this.TYg();let ta;for(let qa=1;4>=qa;qa++)ta=qa,ka[ta]&&this.QGd.showOverlayWithCavity(this.m0a[ta],ka[ta])}dispose(){this.QGd=this.m0a=this.gridView=this.$=null}TYg(){let ka;const ta=Q.h(this.$).rtl;let qa;const rb=Array(5);for(let gb=1;4>=gb;gb++)if(ka=gb,this.Ijf(gb)){var Za=
this.gridView.Bf(gb);qa=this.gridView.ha.Sa.p_?this.TSh(gb,Za,ta):this.NTh(gb,Za,ta);Za=this.Ich(Za);rb[ka]=this.cdh(this.m0a[ka].id,Za,qa)}return rb}Ijf(ka){return this.gridView.ib.UQ(ka)}Ich(ka){return Object(ea.a)(new La,{width:ka.Am.width,height:ka.Am.height})}cdh(ka,ta,qa){return Object(ea.a)(new Ia,{containerId:ka,overlayContainerInfo:ta,overlayCavityInfos:qa?[qa]:null})}TSh(ka,ta,qa){var rb=Q.h(this.$).ha.Sa.$b;if(!rb)return n.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;let Za,gb;if(({QCa:ka,rotation:rb,translateX:Za,translateY:gb}=rb.extension.WSh(ka)).returnValue){const mb=ka.x-ta.Am.x;return Object(ea.a)(new ha,{left:(qa?ta.Am.width-(mb+ka.width):mb)-3+1,top:ka.y-ta.Am.y-3+1,width:ka.width+5,height:ka.height+5,angle:rb,translateX:Za,translateY:gb})}return null}NTh(ka,ta,qa){ka=this.gridView.qb.lwb(this.gridView.ha.ra.activeRange,ka)||ya.a.i4;if(!ka.Ke(ta.Am))return null;const rb=ka.x-ta.Am.x;return Object(ea.a)(new ha,{left:qa?ta.Am.width-(rb+ka.width)-2:
rb-3,top:ka.y-ta.Am.y-3,width:ka.width+5,height:ka.height+5})}}Object(u.a)(ra,"PresentModeOverlayRenderer",null,[768,2]);var pa=a(60);const ba=(ka,ta,qa,rb,Za,gb,mb=null)=>{mb=ka.Na(41,mb);mb.shouldEnablePresentMode=ta;return pa.g(ka,"SetPresentMode",mb,qa,rb,Za,gb,0)};var fa=a(284);class Ka extends fa.a{constructor(ka,ta){super(ka);this.t4i=()=>{this.mda.JUd(!0)};this.mda=ta;this.domElement.classList.add("ewr-presentMode-on");ka={[Ka.uu]:this.pc};this.Rb=0;this.initializeAndShow("",this.t4i,ka)}get pc(){return"PresentModeWelcomeDialog"}hide(){super.hide();
y.a.Pv(z.a.k8f,"false",this.$.va.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(u.a)(Ka,"PresentModeWelcomeDialog",fa.a,[]);class aa{static get GIh(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get HIh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?
"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(ka){ka.webkitRequestFullscreen?ka.webkitRequestFullscreen():ka.msRequestFullscreen?ka.msRequestFullscreen():ka.mozRequestFullScreen?ka.mozRequestFullScreen():ka.requestFullscreen?ka.requestFullscreen():n.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():n.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get dmi(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(u.a)(aa,"FullscreenUtils",null,[]);class ja{constructor(ka){this.Toa=
this.NYe=this.XHb=this.k3a=this.csc=this.mda=this.vQa=null;this.nsd=this.ZPb=this.aOd=!1;this.kNb=!0;this.yhc=!1;this.NUd=!0;this.YPb=this.T1a=this.gFe=0;this.Owc={};this.Jqc={};this.Iqc={};this.LMf=0;this.f8a=this.Hbe=!1;this.sej=()=>{C.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-transition",!1);$removeHandler(this.k3a,"transitionend",this.Toa)};this.hj=()=>{parseInt(this.$.qu.style.right,10)!==this.gFe&&window.requestAnimationFrame(()=>{this.fDc(0);this.$.hAa(D.a.RZ("PresentModeManager.OnContentAreaResized"))})};
this.R6=()=>{var ta=Object(v.a)(I.a,this.$.oa);if(ta&&this.Hz){this.gridView.Zhc=!1;ta=ta.headersVisible;var qa=Q.h(this.$).rtl;C.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on-headers-off",!ta);C.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on-rtl",qa);(12!==this.T1a&&!ta||32!==this.T1a&&ta&&!qa||0!==this.T1a&&ta&&qa)&&window.requestAnimationFrame(()=>{this.fDc(2)})}};this.dd=()=>{this.dff();this.$g("OnWorkbookOpened");n.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.Mp=()=>{this.nsd=!0;this.Sea("OnSelectionStarted")};this.Cg=()=>{this.nsd=!1;this.Sea("OnSelectionEnded");this.WZf()};this.rh=()=>{this.Sea("OnEditStarted")};this.jg=()=>{this.Sea("OnEditEnded")};this.Ww=()=>{if(!this.yhc){const ta=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.Sea("OnVisibleAreaChanged",!0,ta)}};this.vFb=()=>{this.yhc=!0};this.Ln=()=>{this.Sea("OnCurrentSelectionModeChanged");this.WZf();this.$g("OnCurrentSelectionModeChanged")};this.an=
()=>{this.Sea("OnBlockCacheItemEvicted")};this.tf=()=>{this.Sea("OnBlockCacheItemChanged")};this.ZF=()=>{this.yhc||this.Sea("OnActiveItemPanesChanged")};this.Fh=()=>{this.yhc=!1;this.mda.$g("ActiveSheetChanged");this.R6()};this.vGb=(ta,qa)=>{if(ta=Object(v.a)(I.a,qa.item))ta.Yqb(16,!0),ta.FZa(this.R6)};this.GOi=()=>{aa.dmi||(this.csc&&this.csc.Hn&&this.csc.hide(),Q.h(this.$).eb&&Q.h(this.$).Uo(!0),this.vzc(!1),n.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.HOi=()=>{n.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=ka;this.gridView=Q.h(this.$);this.$oj=ka.va.PresentModeRenderUpdateTimeout;this.initialize(ka)}get Hz(){return this.Hbe}vzc(ka){this.Hz!==ka&&(this.Hbe=ka,this.f8a=this.Hz,this.dff(),this.kNb=this.R6f(),window.requestAnimationFrame(()=>{C.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-transition",!0);$addHandler(this.k3a,"transitionend",this.Toa);
this.hFj(!ka);this.b_i();C.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on",ka);this.gFj(ka);x.b(this.$).b8f(this.Hz);x.c(this.$).b8f(this.Hz);this.$.JAa();this.vQa.d8f(this.kNb);if(this.Hz){this.w_a();y.a.get(z.a.k8f)?this.mda.JUd(this.Hz):this.csc=new Ka(this.$,this.mda);var ta=N.b(this.$);ta&&(this.aOd=ta.y9c(!1));this.LMf=H.HelperMethods.Tb()}else this.mda.JUd(ka),this.aOd&&(ta=N.b(this.$))&&(ta.y9c(!0),this.aOd=!1),this.t7b(),this.Xzi()}))}e8f(ka,ta){this.NUd=ka;this.Sea(ta)}$g(ka){this.mda.$g(ka)}dispose(){this.t7b();
this.vQa&&(this.vQa.dispose(),this.vQa=null);this.gridView=this.$=null}hFj(ka){const ta=this.$.da.za(25);void 0===ta||null===ta?n.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):ka?ta.qzc():ta.Zec()}b_i(){C.DOMElementExtensions.toggleCssClass(document.getElementById(t.AFrameworkApplication.v3a),A.a.Ao,this.Hz);C.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on",this.Hz);this.jFj(this.Hz);this.gridView.Zhc=!this.Hz;this.GXj();this.$.da.$a(32,
ka=>{ka.bYj(this.Hz)});O.b(this.$,ka=>{ka.phg(this.Hz)})}jFj(ka){if(this.XHb)if(ka){if(ka=Object(v.a)(I.a,this.$.oa))C.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on-headers-off",!ka.headersVisible),C.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on-rtl",Q.h(this.$).rtl);this.fDc(0)}else this.$.vr.classList.remove("ewr-presentMode-on-headers-off"),this.$.vr.classList.remove("ewr-presentMode-on-rtl"),this.fDc(1)}fDc(ka){var ta=Object(v.a)(I.a,this.$.oa);if(ta){var qa=
parseInt(this.$.qu.style.right,10);if(1===ka||2===ka){if(isNaN(qa)||qa<this.T1a)return;qa-=this.T1a}if(0===ka||2===ka)ka=ta.headersVisible,ta=Q.h(this.$).rtl,ka=ka?ta?0:32:12,qa=isNaN(qa)?ka:qa+ka,this.T1a=ka;this.$.qu.style.right=H.HelperMethods.uc(qa);this.gFe=qa}}GXj(){const ka=document.getElementById(this.$.Eb+z.a.V6b).parentNode;C.DOMElementExtensions.toggleCssClass(ka,B.Kvh,this.Hz)}initialize(ka){this.vQa=new ra(ka);this.vQa.Iei();this.mda=new K(ka);this.mda.Ydi();this.k3a=document.getElementById("MainApp");
this.NYe=this.GOi;$addHandler(this.k3a,aa.GIh,this.NYe);$addHandler(this.k3a,aa.HIh,this.HOi);this.XHb||(this.XHb=document.createElement("div"),this.XHb.className="ewa-presentMode-right-frame",this.$.aF.appendChild(this.XHb));this.Toa=this.sej}w_a(){this.gridView.ha.S2(this.Mp);this.gridView.ha.FY(this.Cg);this.gridView.fc.Yk(this.rh);this.gridView.fc.Rm(this.jg);this.gridView.AC(this.Ln);this.gridView.view.nt(this.Ww);this.gridView.rWc(this.vFb);this.gridView.Ea.hH(this.an);this.gridView.Ea.mt(this.tf);
this.$.xa.Vf(this.Fh);this.$.xa.nsa(this.ZF);this.$.xa.eha(this.vGb);this.$.PA(this.hj);this.$.ml(this.dd);const ka=Object(v.a)(M.a,this.$.xa);for(const ta of ka.items)ta.FZa(this.R6)}t7b(){this.gridView&&(this.gridView.ha.t7(this.Mp),this.gridView.ha.JW(this.Cg),this.gridView.fc.Hk(this.rh),this.gridView.fc.em(this.jg),this.gridView.ZD(this.Ln),this.gridView.view.gr(this.Ww),this.gridView.mLd(this.vFb),this.gridView.Ea.EI(this.an),this.gridView.Ea.er(this.tf));if(this.$){this.$.xa.Dg(this.Fh);this.$.xa.zAa(this.ZF);
this.$.xa.rna(this.vGb);this.$.YD(this.hj);this.$.Jl(this.dd);const ka=Object(v.a)(M.a,this.$.xa);for(const ta of ka.items)ta.Fuc(this.R6)}}R6f(){if(!this.Hz||!this.f8a)return!1;if(1===this.gridView.ha.Oe){const ka=this.$.oa.activeRange.isSingle,ta=1===this.$.oa.selectedRanges.length&&!ka,qa=this.gridView.eb,rb=this.nsd;ta||n.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${ka}`);return this.NUd&&ta&&!qa&&
!rb}return this.NUd}gFj(ka){ka?aa.requestFullscreen(this.k3a):aa.exitFullscreen()}Sea(ka,ta=!1,qa=!1){ta||(this.kNb=this.R6f());n.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${ka}, visibility: ${this.kNb}, immediateUpdate: ${qa}`);if(this.ZPb&&qa)n.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.YPb}`),window.cancelAnimationFrame(this.YPb),this.YPb=0;else if(this.ZPb){n.ULS.sendTraceTag(543023558,0,
50,`PresentModeManager.UpdateLayout: Skipping update layout for ${ka}`);return}qa?this.t0d(H.HelperMethods.Tb(),ka):(this.YPb=window.requestAnimationFrame(rb=>{this.t0d(rb,ka)}),this.ZPb=!0)}t0d(ka,ta){var qa=H.HelperMethods.Tb();if(qa-ka>this.$oj)this.YPb=window.requestAnimationFrame(Za=>{this.t0d(Za,ta)}),this.ZPb=!1,n.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${qa-ka}ms.`);else{this.vQa.d8f(this.kNb);this.ZPb=!1;var rb=
H.HelperMethods.Tb();ka=H.HelperMethods.Tb()-ka;qa=rb-qa;this.boj(ka,ta);n.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${qa}ms. rafTotalDuration = ${ka}ms`)}}dff(){L.a(this.$.userOperationManager,(ka,ta,qa)=>ba(this.$.pa.ya,this.Hz,ka,ta,qa,null),ka=>new T.a(252,0,ka),null)}WZf(){let ka=G.a(this.gridView.Oe);1!==this.gridView.Oe||this.$.oa.activeRange.isSingle||(ka="Range");this.Owc[ka]=this.Owc[ka]?this.Owc[ka]+1:1}boj(ka,ta){const qa=this.Jqc[ta]?
this.Jqc[ta]:0;this.Jqc[ta]=qa>ka?qa:ka;this.Iqc[ta]=this.Iqc[ta]?this.Iqc[ta]+1:1}Xzi(){const ka={};var ta=H.HelperMethods.Tb()-this.LMf;ka.PresentModeDuration=ta;ka.SelectionCountPerObject=r.a.toJSON(this.Owc);ka.OverlayCountPerCaller=r.a.toJSON(this.Iqc);ka.OverlayDurationPerCaller=r.a.toJSON(this.Jqc);ta=this.mda.Z1h();for(let qa in ta)ka[qa]=ta[qa];U.b(this.$).ud(J.a.r4i,ka,void 0,!0)}}Object(u.a)(ja,"PresentModeManager",null,[627,2]);var Va=a(184);class bb extends w.a{constructor(ka){super();
this.$=ka;this.Fb()}create(){const ka=e.GetServiceTaskFactory.Oa(this.$.da,283,284,1);f.TaskExtensions.Aa(ka,()=>{f.TaskExtensions.Aa(Va.c(ka.result.ln.loadScript("presentMode")),()=>{let ta=this.$.da.za(423);ta||(ta=new ja(this.$),this.$.da.Ga(423,ta));this.ob(ta)},this.$.la,3)},this.$.la,3)}static ka(ka){ka.da.Ga(424,new bb(ka))}}Object(u.a)(bb,"PresentModeManagerFactory",w.a,[]);a.d(E,"a",function(){return wa});const wa=()=>{c.a.Fa(ka=>{bb.ka(ka);l.ka(ka)})}},1170:function(u,E,a){var c=a(9);u=
a(0);var b=a(552),e=a(692),f=a(50),d=a(37),h=a(15),m=a(1240),l=a(4),w=a(164),n=a(753),y=a(97),t=a(263),r=a(642),v=a(27),B=a(157),A=a(178),z=a(290),x=a(5),D=a(148),J=a(101),L=a(76),T=a(74),O=a(371),G=a(188),C=a(59),H=a(60),I=a(326),M=a(587),Q=a(1337),U=a(418),N=a(319),W=a(13);class X extends Q.a{constructor(Ma,va){super(Ma,void 0,void 0,va)}get UOa(){return W.a.instance.Ua(419)}get hlc(){return W.a.instance.Ua(420)}get glc(){return"DownloadOdsLink"}get WCb(){return"#"}get f9a(){return W.a.instance.Ua(421)}get uuf(){return!0}fqf(){h.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}hqf(){h.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}alc(){U.Redirect.showHelp(N.a.eJi);return!0}}Object(u.a)(X,"DownloadACopyAsOdsDialog",Q.a,[]);class sa{constructor(Ma,va){this.dialog=null;this.zAf=()=>{this.dialog&&this.dialog.hide()};this.uJi=Ma;this.rb=va;this.rb.job(this.zAf)}Nve(Ma){this.dialog=Ma}q8c(){this.uJi.cJf(-1059172980)}dispose(){this.rb.LJb(this.zAf)}}
Object(u.a)(sa,"DownloadACopyAsOdsDialogDownloadBehavior",null,[175,2]);const da=(Ma,va,Pa,Ha,tb,Ya,V=null)=>{V=Ma.Na(9,V);V.isReadOnlyRecommended=va;return H.g(Ma,"SetReadOnlyRecommended",V,Pa,Ha,tb,Ya,0)},S=(Ma,va,Pa,Ha,tb,Ya,V=null)=>{V=Ma.Na(9,V);V.calc_type=va;return H.g(Ma,"SetCalculationOptions",V,Pa,Ha,tb,Ya,0)};class oa{constructor(Ma){this.calculationMode=0;this.calculationMode=Ma}}Object(u.a)(oa,"MacroRecorderWorkbookCalculationModeSetPayload",null,[137]);class K{constructor(Ma){this.calculateType=
0;this.calculateType=Ma}}Object(u.a)(K,"MacroRecorderWorkbookRecalculatedPayload",null,[137]);var ea=a(85),ya=a(146),ha=a(177),La=a(14),Ia=a(107),ra=a(1);Q=a(261);class pa{static get WYi(){return pa.VYi}}pa.VYi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(u.a)(pa,"OpenInAppDialogCopyHtml",null,[]);var ba=a(152);class fa extends Q.a{constructor(Ma){super(Ma);this.nI=null;this.DFb=()=>{h.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.va.IsMeetingLiveSession)return this.vFc(),!0;v.a.Ap?(h.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.Ox&&this.Ox.length||h.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.Ox+
"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.Fm+";end","_top")):9<=v.a.hmd?(h.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.nma,"_top"),window.setTimeout(()=>{this.openUrl(this.Fm,"_blank")},9E3)):(h.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.nma,
"_top"),window.setTimeout(()=>{this.openUrl(this.Fm,"_blank")},500));return!0};this.CPa=va=>va.Ca.keyCode===ea.a.Lh||va.Ca.keyCode===ea.a.$ea?(h.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),va.Gb.click(),!0):!1;1===l.AFrameworkApplication.sa.Pa.Gj&&(this.Ox=this.$.workbookContext.ClientUrl,this.nma="ms-excel:ofe|u|"+this.Ox,this.Fm=l.AFrameworkApplication.fa.Xa("AppUrl"),v.a.Nba?this.Fm="itms-apps://"+l.AFrameworkApplication.fa.Xa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":
v.a.Ap&&(ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&this.$.va.IsMeetingLiveSession?(h.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.Fm=l.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):v.a.NAb?this.Fm=l.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<v.a.MXc.QOa&&(this.Fm=l.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get pc(){return"OpenInAppDialogCopy"}openUrl(Ma,
va){let Pa=document.getElementById("link");Pa||(Pa=document.createElement("a"),Pa.id="link",Pa.style.visibility="hidden",Pa.href="",document.body.appendChild(Pa));Pa.target=va;Pa.href=Ma;Pa.click()}vFc(){h.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ma=>{let va={};va.OpenInAppUrl=this.nma;va.StoreUrl=this.Fm;Ma.result.Pj("UI_OpenInMobileApp",va)},this.$.la)}XYi(){h.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}gg(){this.qg=
ya.a.gq(pa.WYi,W.a.instance.ga(662),W.a.instance.ga(663),l.AFrameworkApplication.sB,ba.getImageClass(l.AFrameworkApplication.fa.Xa("AppIcon")),W.a.instance.ga(664));this.Fe="OpenInAppDialog";this.Rb=5;this.initializeAndShow("",this.XYi.bind(this),null);this.RI(this.nI)}Ov(Ma){super.Ov(Ma);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.nI=document.getElementById("LinkToInstall");ha.a.instance.ta(La.a.click,this.nI,this.DFb);Ia.KeyInputManager.instance.ta(La.a.Fd,this.nI,
this.CPa)}dispose(){this.nI&&(ha.a.instance.Ba(La.a.click,this.nI,this.DFb),Ia.KeyInputManager.instance.Ba(La.a.Fd,this.nI,this.CPa),this.nI=null);super.dispose()}}Object(u.a)(fa,"OpenInAppDialogCopy",Q.a,[]);var Ka=a(134),aa=a(373);class ja{constructor(Ma){this.Gai="itms-apps://";this.Hai="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.Yng=va=>{1==va&&this.vFc()};this.$=Ma;this.Ox=l.AFrameworkApplication.sa.Pa.Ox;this.nma="ms-excel:ofe|u|"+this.Ox;this.Fm=l.AFrameworkApplication.fa.Xa("AppUrl");
v.a.Nba||v.a.Yg?this.Fm=this.Gai+this.Hai:v.a.Ap&&(l.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(h.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.Fm=l.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):v.a.NAb?this.Fm=l.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<v.a.MXc.QOa&&(this.Fm=l.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")))}vFc(){h.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ma=>{let va={};va[aa.a.iJf]=this.nma;va[aa.a.Fm]=this.Fm;Ma.result.Pj("UI_OpenInMobileApp",va)},this.$.la)}gg(){h.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const Ma=new Ka.StandardDialog;Ma.Rb=0;Ma.oc(1,W.a.instance.ga(668));Ma.Zl(W.a.instance.ga(666),W.a.instance.ga(667),0,this.Yng)}}Object(u.a)(ja,"OpenInAppDialogReact",null,[]);Q=a(284);class Va extends Q.a{constructor(Ma){super(Ma);
this.sessionId=Ma.va.UserSessionId;this.oWg=Ma.va.BuildVersion}get pc(){return"WACSessionIdDialog"}kN(){return{[Va.tsj]:W.a.instance.ga(669),[Va.usj]:this.sessionId,[Va.id]:"WACSessionIdDialog",[Va.v_c]:W.a.instance.ga(670),[Va.buildVersion]:this.oWg}}gg(){const Ma=this.kN();this.Rb=5;this.initializeAndShow(W.a.instance.ga(1023),this.c1j.bind(this),Ma)}c1j(){h.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}Va.id="id";Va.tsj="sessionIdLabel";Va.usj="sessionIdValue";Va.v_c=
"buildLabel";Va.buildVersion="buildVersion";Object(u.a)(Va,"WACSessionIdDialog",Q.a,[]);var bb=a(28),wa=a(29),ka=a(356),ta=a(11),qa=a(183),rb=a(281),Za=a(21),gb=a(44),mb=a(250),Ga=a(461),ib=a(377),cc=a(51),ic=a(6),xb=a(143),Vb=a(967),wb=a(81),cb=a(36),lb=a(302),Y=a(253);class Oa{MQ(Ma,va){Ma=wa.a.Zc(12,1,671,0,0,0,"Blank");Ma.Description=String.format(W.a.instance.ga(672),va);return Ma}cbc(Ma){switch(Ma){case 1:case 2:return 0;default:return 2}}}Object(u.a)(Oa,"ReloadCloseConfirmation",null,[124]);
var Wa=a(150),Ca=a(588),Ra=a(69),la=a(55),ua=a(174),xa=a(33);class fb extends A.a{constructor(Ma,va,Pa,Ha){super();this.$=Ma;this.businessBar=Ha;this.openInExcelOperation=va;this.sK=Pa}get Zb(){return this.$.ea.Zb}get workbookContext(){return this.$.workbookContext}get l8b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return Ra.a(this.$)}get dc(){return this.$.dc}B9h(){var Ma,va;return null!==(va=null===(Ma=this.$.workbookContext.LoadBlockingFloatingObjectsInfo)||void 0===
Ma?void 0:Ma.LoadBlockType)&&void 0!==va?va:!1}nc(){return!1}executeCommand(Ma,va,Pa,Ha){const tb=this.l8b,Ya=this.$,V=va.command,za=this.openInExcelOperation,yb=this.$.Eb,jc=Pa.SourceControlId;Ya.hl.lpe(V);za.fyc(va.startTime.getTime().toString());Ma=null;switch(V){case 1455037301:this.$.J5?za.qFe():za.Z3c();break;case -2044628748:case 2004484710:this.$.J5?za.qFe():za.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===jc?(this.yDb("CellLongPress"),h.ULS.sendTraceTag(576495705,
0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.yDb("PencilIcon"),h.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:h.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const Cc=Ra.a(this.$).hd.activityState;gb.a(Ya).Js(new mb.a(ic.a.ey,5,()=>{Cc[Y.a.Jq]=ic.a.ij}));break;case 480922297:ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",
!1)&&(new Va(this.$)).gg();break;case -2028960985:za.T9f();break;case -1059172980:new X(za.gye(V),new sa(za,Ya.rb));break;case -1285148982:this.clientWorkflow.hd.activityState[cb.a.qVc]=!0;this.jCc(!1);break;case -75280711:this.jCc(!1);break;case -455164169:this.jCc(!0);break;case -1388494670:this.$.da.$a(400,ob=>{ob.TCi();this.jCc(!1)});break;case 810888577:l.AFrameworkApplication.zk=(new Date).getTime();h.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${l.AFrameworkApplication.zk}`);
break;case -1804063550:case -974518828:va=0;x.a.sEd in Pa&&(va=Pa[x.a.sEd]);za.cJf(V,va);break;case -1339961039:va=!1;Pa&&x.a.LKb in Pa&&(va=Pa[x.a.LKb]);this.reloadWorkbook(!1,va);break;case -8805455:const Sa=this.workbookContext;if(ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&this.B9h()&&xa.a.fd(this.$)){const ob=f.GetServiceTaskFactory.Oa(this.$.da,522,523,0);d.TaskExtensions.Aa(ob,()=>{ob.result.eE()},this.$.la,3)}else Ya.isEditMode||(fb.QCe(Ya),
Ma=d.TaskExtensions.Aa(this.sK.value,ob=>{ob=ob.result;var Fa=ob.isEnabled();Fa&&M.a(ob,w.a.copyAndEdit,C.a.zg.H0e(),this.$.ea.Wg.get(2))?h.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):Fa&&l.AFrameworkApplication.Rig?(Fa={},Fa[m.a.oHd]=l.AFrameworkApplication.userSessionId,Fa[l.AFrameworkApplication.gFi]=bb.a.Qa.zb.getTime().toString(),h.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),
ob.Pj(w.a.editMode,Fa)):tb.CopyAndEditUrl?this.I8g():(this.dc.supportsEditing||Sa.EditUrl)&&this.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Ya.isEditMode&&(fb.QCe(Ya),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const na=Ya.pa.ya.Wb(),jb=-1355155015===V?1:0,Ib=()=>new K(jb);Ma=O.a(this.$.userOperationManager,(ob,Fa,Ab)=>H.y(Ya.pa.ya,jb,null,ob,Fa,Ab,null,na),ob=>new G.a(128,0,ob,void 0,Ib),va);Za.h(Ya).Hf.rH(!1);break;case -1158102843:Ma=Za.h(Ya).Hf.recalcSheet(va);
Za.h(Ya).Hf.rH(!1);break;case -988468372:if(ra.EwaSettings.ma(297))if(Ha=parseInt(Pa[L.a.Jc],10),0<=Ha&&3>Ha)this.setCalculationMode(va,Ha);else return h.ULS.sendTraceTag(537162652,0,10,`SetCalculationMode , unexpected menuItemId: ${Pa[L.a.Jc]}`),qa.a(V);break;case 257398710:D.a.ntw(tb.ReportAbuseUrl,Ya);break;case 1800405051:this.Ynj();break;case -48469327:this.saveACopy();break;case 214430355:va=!1;Pa&&x.a.Y8c in Pa&&(va=Pa[x.a.Y8c]);if(!this.IBj(va,Pa))break;l.AFrameworkApplication.u5?this.businessBar.ng(42,
null):this.businessBar.ng(va?22:23,null);break;case 1389557314:Ma=d.TaskExtensions.Aa(this.sK.value,ob=>{M.a(ob.result,w.a.YDh,null,this.$.ea.Wg.get(6))||D.a.ntw(tb.FileVersionUrl,Ya)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:jc===yb+x.a.bnf?za.Evi():za.Dvi();break;case 512141517:jc===yb+x.a.anf?za.Mvi():za.Lvi();break;case -1224038235:const dc=n.a.On in Pa?!Pa[n.a.On]:J.j(Ya.ea.workbookContext.Options);Pa[n.a.Description]=dc?W.a.instance.ga(571):W.a.instance.ga(572);
Ma=O.a(this.$.userOperationManager,(ob,Fa,Ab)=>da(this.$.pa.ya,!dc,ob,Fa,Ab,null),ob=>new G.a(129,0,ob),va);break;case 1118926154:if(this.$.isEditMode){const ob=new B.a;this.$.da.$a(53,Fa=>{Fa?(Fa.Em.wvi(this.$.Eb+x.a.Qtd),ob.setResult(!0)):h.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});Ma=ob.task}break;case -1698025133:za.openInBrowser();break;case 520859864:Ma=d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,393,394,Ha.I4()),
ob=>{ob.result||h.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:Ma=qa.a(V)}return Ma||la.Task.Ta(!0)}yDb(Ma){if(ta.HelperMethods.s_){const va=new Map;va.set("EntryPoint",Ma);y.Health.instance.recordKpiUsage(ib.a.UYi,0,Ga.a.UEi,va)}else h.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){l.AFrameworkApplication.isMobileMode&&
(this.$.va.IsMeetingLiveSession&&ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(h.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new ja(this.$)).gg()):ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(h.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new fa(this.$)).gg()):
(h.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),l.AFrameworkApplication.showOpenInAppDialog()))}IBj(Ma,va){return l.AFrameworkApplication.isMobileMode&&!T.a(this.$.va,29)?(this.showOpenInAppDialog(),h.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.yDb("CellDoubleTap"),h.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):l.AFrameworkApplication.xic&&(Ma&&ka.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(h.ULS.sendTraceTag(537162645,0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${ka.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):t.a.any([25,26,30,31,57,32,34],Pa=>this.businessBar.cla(Pa))?
(h.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):va&&x.a.$5i in va&&!Ma?!1:!0}wc(Ma,va){Ma=!1;switch(va.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:Ma=
!0;break;case 480922297:case 520859864:Ma=ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case 924877417:Ma=ua.a.Aqd?!0:!1;break;case -1285148982:case -75280711:case -455164169:Ma=ra.EwaSettings.ma(108);break;case -1388494670:Ma=ra.EwaSettings.ma(108);break;case 810888577:Ma=ra.EwaSettings.ma(268);break;case -1224038235:Ma=this.$.ea.amIAlone;break;case -988468372:Ma=ra.EwaSettings.ma(297);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:Ma=
!0,h.ULS.shipAssertTag(537162642,0,this.$.$ka,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return Ma}Kc(){return!1}Ynj(){if(this.Zb){var Ma=this.$;gb.a(Ma).Js(new mb.a(ic.a.ey,5,()=>{Ma.CI(!1,!0);const va=this.clientWorkflow.hd.activityState;va[Y.a.Jq]=ic.a.Wda;va[xb.a.DT]=2;va[cb.a.Zr]=Ma.isEditMode;va[xb.a.Tga]=!1}))}}saveACopy(){if(this.Zb){var Ma=this.$;gb.a(Ma).Js(new mb.a(ic.a.ey,5,()=>{Ma.CI(!1,!1);const va=this.clientWorkflow.hd,Pa=va.activityState;
Pa[Y.a.Jq]=ic.a.zZf;Pa[Ca.a.UZb]=this.dc.hasUnsupportedFeaturesForEdit;Pa[xb.a.Tga]=!1;va.rr(wa.a.q4(this.businessBar.r9c,[-502303485]))}))}}jCc(Ma){gb.a(this.$).Js(new mb.a(ic.a.Tna,2,()=>{this.$.CI(!0,!0);var va=Ra.a(this.$).hd,Pa=this.$.isEditMode;Pa=wa.a.Zc(1,1,0,0,0,Pa?-315732528:-2087635043,Pa?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Pa.ForceVersionUpgrade=Ma;va.rr([Pa]);va=Ra.a(this.$).hd.activityState;va[Y.a.Jq]=ic.a.Tna;va[cb.a.Zr]=this.$.isEditMode;va[xb.a.Tga]=!1}))}closeWorkbook(){if(this.Zb){var Ma=
this.$;C.a.zg.Jyc("2145659238")?d.TaskExtensions.Aa(this.sK.value,va=>{va.result.Pj(w.a.fWe,{})},this.la,3):gb.a(Ma).Js(new mb.a(ic.a.ey,5,()=>{Ma.CI(!0,!1);const va=this.clientWorkflow.hd.activityState;va[xb.a.xY]=!1;va[xb.a.Tga]=!1;this.dc.inViewerFromWebPart?(I.a.eId(Ma,this.clientWorkflow.hd),Ma.hl.hz("InViewerFromWebPart"),va[Y.a.Jq]=ic.a.X_):(va[Y.a.Jq]=ic.a.Vj,Ma.qd&32?va[xb.a.DT]=0:(va[xb.a.DT]=1,va[xb.a.JZb]=new Vb.a),va[Wa.a.Jne]=!0)}))}}I8g(){const Ma=this.dc.vbaRemovedDuringConversion;
h.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${Ma}`);const va=this.$;Ma?gb.a(va).Js(new mb.a(ic.a.ey,5,()=>{const Pa=wa.a.Zc(3,0,0,1261,0,1069271157,"XLSMacroFailure");this.clientWorkflow.hd.rr([Pa]);this.clientWorkflow.hd.activityState[Y.a.Jq]=ic.a.Sfb})):l.AFrameworkApplication.hideHeader?ta.HelperMethods.lf(this.l8b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):D.a.ntw(this.l8b.CopyAndEditUrl,va)}reloadWorkbookInEditMode(){if(this.Zb)if(C.a.zg.IV&&
C.a.zg.TJd(),l.AFrameworkApplication.xic&&!l.AFrameworkApplication.$ba)ta.HelperMethods.lf(this.$.kqb(!0),z.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var Ma=this.$,va=!1,Pa=this.dc.hasUnsupportedFeaturesForEdit,Ha=this.workbookContext.FileWasRepaired;ka.d(this.workbookContext.WorkbookFileName)?(va=!0,h.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${Pa}`)):ka.a(this.workbookContext.WorkbookFileName)&&
(va=!0,h.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var tb=Ma.ie.get(59);tb=!(Ma.ea.dc.supportsEditing&&tb);if(va&&!Pa||tb&&(va||Pa)){let Ya;Ya=tb?Pa?-2066104278:816071846:ra.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&T.a(this.$.va,25)&&!this.$.wBb?765011943:-213064907;va=()=>{const V=wa.a.b0a([Ya]);this.clientWorkflow.hd.rr(V);this.clientWorkflow.hd.activityState[Y.a.Jq]=ic.a.Sfb}}else va=()=>{Ma.CI(!0,
!1);var Ya=this.clientWorkflow.hd;const V=Ya.activityState;V[xb.a.DT]=1;V[lb.a.OZb]=r.a.Lmc;V[cb.a.Zr]=!0;V[Ca.a.UZb]=this.dc.hasUnsupportedFeaturesForEdit;V[xb.a.Tga]=!!this.workbookContext.EditUrl;V[wb.a.E2]=this.workbookContext.EditUrl;if(!this.l8b.CopyAndEditUrl){const za=[ra.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&T.a(this.$.va,25)&&!this.$.wBb?-943219229:1821390342];Ya.rr(wa.a.q4(this.businessBar.r9c,za))}Ha&&!Pa?(ka.b(this.workbookContext.WorkbookFileName)&&
ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(Ya=wa.a.b0a([-425642652]),h.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Ya=wa.a.b0a([108482388]),this.clientWorkflow.hd.rr(Ya),V[Y.a.Jq]=ic.a.NZf):this.$.ea.U$e?(h.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),cc.b().mWd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session",
"PasswordToModifyDialogShown"),V[Y.a.Jq]=ic.a.rHb):V[Y.a.Jq]=this.$.ea.jic?ic.a.$Cb:ic.a.Sfb};gb.a(Ma).Js(new mb.a(ic.a.ey,5,va))}}reloadWorkbookInViewMode(){if(this.Zb){C.a.zg.IV&&C.a.zg.TJd();var Ma=this.$;v.a.Yg&&Za.h(Ma).Vb.textBox.blur();gb.a(Ma).Js(new mb.a(ic.a.ey,5,()=>{Ma.CI(!Ma.ea.isNamedObjectViewMode,!1);const va=this.clientWorkflow.hd.activityState;va[Y.a.Jq]=ic.a.bia;va[xb.a.DT]=1;va[xb.a.xY]=!0;va[cb.a.Zr]=!1;va[cb.a.Jnb]=!0;va[lb.a.OZb]=r.a.Lmc}))}}reloadWorkbook(Ma,va){if(this.Zb){var Pa=
this.$;Pa.WU&65536&&gb.a(Pa).Js(new mb.a(ic.a.ey,5,()=>{Pa.CI(Ma,!0);const Ha=this.clientWorkflow.hd.activityState;Ha[Y.a.Jq]=ic.a.pz;Ha[cb.a.tVc]=this.workbookContext.NovMode;va||(Ha[xb.a.DT]=1,Ha[xb.a.JZb]=new Oa)}))}}setCalculationMode(Ma,va){h.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${va} `);const Pa=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=va;const Ha=()=>new oa(va);return O.a(this.$.userOperationManager,(tb,Ya,V)=>S(this.$.pa.ya,
va,rb.b(tb,fb.MVi(this.$,Pa)),rb.a(Ya,fb.LVi(this.$,Pa)),V,null),tb=>new G.a(197,0,tb,void 0,Ha),Ma)}static QCe(Ma){Ma.rb&&0<Ma.rb.GR&&Ma.rb.Tad(va=>{va.rv()})}static MVi(Ma,va){return Pa=>{wa.a.ag(Pa.Errors)&&(Ma.ea.workbookContext.CalcMode=va,h.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${va}.  Error id names: ${wa.a.sc(Pa.Errors)}`))}}static LVi(Ma,va){return()=>{Ma.ea.workbookContext.CalcMode=va;h.ULS.sendTraceTag(537162627,
0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${va})`)}}}Object(u.a)(fb,"FileOperationsCommandHandler",A.a,[223]);var Jb=a(153);class Ob extends e.a{constructor(Ma){super(Ma)}ld(){const Ma=this.$,va=[],Pa=f.GetServiceTaskFactory.create(Ma.da,56,this.la,this.Ya);va.push(Pa);const Ha=f.GetServiceTaskFactory.Oa(Ma.da,5,4,this.Ya);va.push(Ha);d.TaskExtensions.Aa(la.Task.jJ(...va),()=>{Jb.b(Pa)&&this.Yc([new fb(Ma,Pa.result,new b.a(()=>f.GetServiceTaskFactory.create(Ma.da,
137,this.la,this.Ya)),Ha.result)])},this.la,0)}static ka(Ma){e.a.Nd(94,new Ob(Ma))}}Object(u.a)(Ob,"FileOperationsCommandHandlerFactory",e.a,[]);a.d(E,"a",function(){return eb});const eb=()=>{c.a.Fa(Ob.ka)}},1171:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(8),f=a(19),d=a(65),h=a(61),m=a(5),l=a(31);class w{}w.gwh="ewa-resizehdr-row-hidden";w.fwh="ewa-resizehdr-col-hidden";Object(u.a)(w,"CssClassNames",null,[]);var n=a(239),y=a(14),t=a(156),r=a(631),v=a(27),B=a(224),A=a(4),z=a(263),x=a(15),D=
a(76),J=a(132),L=a(42),T=a(142),O=a(24),G=a(53),C=a(12),H=a(71),I=a(1),M=a(94),Q=a(11),U=a(13),N=a(251),W=a(133),X=a(372),sa=a(44),da=a(34);class S{constructor(lb,Y,Oa,Wa,Ca,Ra,la){this.Hwa=lb;this.rEb=Y;this.mPa=Oa;this.eld=Wa;this.Xcb=Ca;this.Xlf=Ra;this.R8h=la}}Object(u.a)(S,"HeaderEventCachedInfo",null,[]);class oa{constructor(lb){this.Q8c=lb}HFe(lb){lb=Q.HelperMethods.TFd(lb);return Math.max(0,Math.min(oa.Ttf,lb))}xFe(lb){return this.J1i(lb)}e4g(lb){return Math.round(this.Q8c*lb+2*this.p1e()+
1)}J1i(lb){return Math.max(0,Math.min(oa.ytf,(Math.max(0,Math.min(e.a.omc,lb))-2*this.p1e()-1)/this.Q8c))}p1e(){return Math.floor(Math.max((this.Q8c+3)/4,2))}Fcc(lb,Y){return Y?lb?oa.Ttf:e.a.hyd:lb?oa.ytf:e.a.omc}}oa.Ttf=409;oa.ytf=255;Object(u.a)(oa,"ResizeHeadersConverter",null,[]);var K=a(191);class ea extends M.a{constructor(lb,Y){super(Y.domElement);this.cY=this.FXf=!1;this.ni=this.N8a=this.KBa=null;this.bNd=!0;this.ljc=!1;this.lLb=this.ql=this.offset=0;this.qN=this.aS=this.d1=null;this.U9h=
"headerResizeTooltip";this.FG=this.vwd=null;this.kZc=this.dY=this.LAa=!1;this.BJf=this.zab=e.a.dxa;this.Hff=I.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");this.YQb=!1;this.bO=Oa=>{if(this.grid.Dj)return!1;Oa=da.a(this.grid.$).Vd(Oa);if(3===Oa.tb&&!this.Ylf(Oa.Ca)||!this.xMf(Oa,!1))return!1;x.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const Wa=this.zzc();this.$dd(Oa.clientPoint,Wa,!0);this.LAa||(n.a.instance.ta(y.a.Jj,
this.domElement.ownerDocument.body,this.J$a),t.a.instance.ta(y.a.Zf,this.domElement.ownerDocument.body,this.J$a),this.LAa=!0);this.Uhf()&&this.cY&&this.wcf(Oa);return!1};this.JFb=Oa=>{Oa=da.a(this.grid.$).Vd(Oa);this.Uhf()&&this.kZc&&this.wcf(Oa);if(!Oa.Ca.type.includes("touch")&&Oa.Ca.button!==Sys.UI.MouseButton.leftButton||!this.pBb)return!1;H.g(Oa.Ca);this.MOe();Oa=this.grid.Dj?this.zab:e.a.dxa;var Wa=!1;if(this.grid.Dj&&this.ni){var Ca=Oa!==this.ql||!this.Hff&&this.dY;I.EwaSettings.isChangeGateEnabled("OfficeVSO:7021389_removeHiddenCellFromModelFix")&&
!Ca&&this.YQb&&(this.fe.removeRowColFromModel(this.ni.nnb,this.ni.HSf),Wa=!0,I.EwaSettings.wm()&&(this.fe.r8(this.grid.ha.ra.selectedRanges),this.fe.fn("HeaderResizeBehavior::onDocumentMouseUp")))}else this.ni&&(Oa=this.dY?this.Cfd():this.ni.E4()),Ca=Oa!==this.ql;this.KBa&&Ca&&Oa!==e.a.dxa?(Oa=this.grid,Wa=this.Ohd(Oa),Ca={},Ca.SheetMultiRange=L.r(Wa,Oa.$),ea.ERd(Ca,this.isRow,this.ql),I.EwaSettings.rod()&&this.grid.Dj&&(Wa=Ca.SheetMultiRange.Ranges[0],x.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.ni?
this.ni.nnb:-1}, isResizingHiddenHeader=${this.dY}, headerViewBlockHashCode=${this.fe.hashCode},
          rangeFirstRow=${Wa.FirstRow}, rangeFirstColumn=${Wa.FirstColumn}, rangeLastRow=${Wa.LastRow}, rangeLastColumn=${Wa.LastColumn},`)),this.cqh(Ca),Oa.QLj=!0):(!I.EwaSettings.wm()&&Wa&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7094259_fixSelectionBugAfterRehideRowCol")&&this.fe.r8(this.grid.ha.ra.selectedRanges),this.fe.fn("HeaderResizeBehavior::onDocumentMouseUp")),this.Cg(null,null),this.yJb());return this.YQb=this.dY=!1};this.Nca=Oa=>{if(this.grid.Dj)return!1;Oa=r.a.create(Oa.eventName,
Oa.Gb,Oa.Ca,Oa.tb);Oa=da.a(this.grid.$).Vd(Oa);if(!this.xMf(Oa,!0))return!1;Oa=this.grid;var Wa=this.Ohd(Oa);Wa=L.r(Wa,Oa.$);Oa.qb.Xg([this.isRow?13:14]);Oa.qb.pTa();this.yJb();Oa.$.Xc(this.isRow?146338636:1391094586,D.a.Db,30,{["autoFitRanges"]:Wa});return!1};this.zCf=Oa=>{this.cY?(this.dY&&!this.YQb&&(this.FGg(),I.EwaSettings.wm()&&this.fe.fn("HeaderResizeBehavior::onHeaderResizeChanged")),this.ljc||this.Pdf(),Oa=new Sys.UI.DomEvent(Oa),Oa=r.a.create(y.a.Dha,this.domElement,Oa,2),Oa=da.a(this.grid.$).Vd(Oa),
this.ICd(Oa.clientPoint)):x.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.ni?this.ni.nnb:-1}, isRow = ${this.isRow}`)};this.ACf=Oa=>{Oa=new Sys.UI.DomEvent(Oa);Oa=r.a.create(y.a.Dha,this.domElement,Oa,2);this.JFb(Oa)};this.QQi=Oa=>{this.oza(Oa,this.ni,!1)};this.J$a=Oa=>{Oa=da.a(this.grid.$).Vd(Oa);H.g(Oa.Ca);return this.ICd(Oa.clientPoint)};this.yI=Oa=>{if(this.grid.Dj)return!1;Oa=da.a(this.grid.$).Vd(Oa);let Wa;
if(!this.ukf||-1!==this.grid.ha.selectionType)return sa.a(this.grid.$).mq()&&(Wa=this.ogd(Oa))&&(Wa.Hwa.style.cursor=""),!1;if(this.cY)return this.Pdf(),!1;Wa=this.ogd(Oa);if(!Wa)return!1;Wa.Hwa.style.cursor=!this.grid.eb&&this.Btd(Wa)?this.isRow?"row-resize":"col-resize":"";H.g(Oa.Ca);return!0};this.Mp=()=>{this.yJb()};this.Cg=()=>{if((3===D.a.Db||v.a.Dp)&&this.grid.ha.ra.Og){var Oa=this.grid.ha.ra.$c;if(!(!Oa.isRow&&!Oa.hf||!this.domElement||Oa.isRow&&this.isRow&&!this.fe.Jt.includes(Oa.top)||Oa.hf&&
!this.isRow&&!this.fe.Jt.includes(Oa.left))){var Wa=this.grid.fg(Oa,this.fe.$i.paneType);if(Wa){if(this.grid.Dj){const Ca=this.isRow?Oa.bottom:Oa.right;this.ni=this.fe.rs(O.Range.Qc(Oa.bottom,Oa.right));if(!this.ni){x.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Ca}, is row ${this.isRow}`);return}}this.FG||this.dfh();Oa.isRow&&this.isRow?(C.DOMElementExtensions.setVisible(this.FG,!0),this.FG.style.top=
Wa.bottomRight.y-this.FG.offsetHeight/2+"px"):Oa.isRow||this.isRow||(C.DOMElementExtensions.setVisible(this.FG,!0),N.c(this.FG.style,this.grid.rtl,Wa.bottomRight.x-this.FG.offsetWidth/2+"px"))}}}};this.aG=(Oa,Wa)=>{I.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&x.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Wa.pM}`);Wa.pM&&this.Nqb()};this.fe=Y;this.isRow=Y.isRow;this.rtl=
Y.$i.rtl;this.grid=lb;this.Btf=this.isRow?e.a.hyd:e.a.omc;this.P9h=U.a.instance.ga(436);this.Y9h=U.a.instance.ga(435);this.S9h=U.a.instance.ga(437);W.a(this.grid.$,Oa=>{this.vwd=Oa.mQ(J.a.blj,!1)});this.kbj();this.grid.ha.NT(this.Cg);this.grid.ha.S2(this.Mp);this.grid.jv(this.Cg);sa.a(this.grid.$).Yf.c$(this.aG)}get pBb(){return this.cY}get ukf(){const lb=(new T.a(this.grid.$.xa)).Td(this.isRow?16:8),Y=this.grid.$.rb.uy,Oa=this.grid.si,Wa=sa.a(this.grid.$).mq();return lb&&!Y&&!Oa&&!Wa}get dlj(){this.Lqh();
return ea.Ycb}oza(lb,Y,Oa){var Wa=new Sys.UI.DomEvent(lb);Wa=r.a.create(y.a.Dha,this.domElement,Wa,2);Wa=da.a(this.grid.$).Vd(Wa);this.wMf(Y,Wa.clientPoint.x,Wa.clientPoint.y,!1,Oa,lb);lb=this.zzc();this.$dd(this.KBa,lb,!0);this.LAa||(lb=this.domElement.ownerDocument.body,lb.addEventListener(y.a.Dha,this.zCf),lb.addEventListener(y.a.wHa,this.ACf),this.LAa=!0)}OQi(lb,Y,Oa){this.wMf(Y,lb.clientX,lb.clientY,!0,this.Hff?Oa:!1,lb);lb=this.grid;Y=this.Ohd(lb);Y=L.r(Y,lb.$);lb.qb.Xg([this.isRow?13:14]);
lb.qb.pTa();this.yJb();lb.$.Xc(this.isRow?146338636:1391094586,D.a.Db,30,{["autoFitRanges"]:Y})}dispose(){this.X1c();this.grid.ha&&(this.grid.ha.XR(this.Cg),this.grid.ha.t7(this.Mp));this.grid.Ky(this.Cg);sa.a(this.grid.$)&&sa.a(this.grid.$).Yf.Jda(this.aG);B.a.instance.Ba(y.a.Ek,this.domElement,this.Nca);n.a.instance.Ba(y.a.Qf,this.domElement.ownerDocument.body,this.JFb);t.a.instance.Ba(y.a.xe,this.domElement.ownerDocument.body,this.JFb);v.a.Dp||(n.a.instance.Ba(y.a.pointerDown,this.domElement,this.bO),
n.a.instance.Ba(y.a.Jj,this.domElement,this.yI));this.LAa&&(n.a.instance.Ba(y.a.Jj,this.domElement.ownerDocument.body,this.J$a),t.a.instance.Ba(y.a.Zf,this.domElement.ownerDocument.body,this.J$a),this.LAa=!1);this.FG&&(n.a.instance.Ba(y.a.pointerDown,this.FG,this.bO),B.a.instance.Ba(y.a.Ek,this.FG,this.Nca),this.X1c(),this.FG=null);this.FXf&&(C.DOMElementExtensions.uf(ea.Ycb),ea.Ycb=null);this.fe=null;super.dispose()}kbj(){B.a.instance.ta(y.a.Ek,this.domElement,this.Nca);n.a.instance.ta(y.a.Qf,this.domElement.ownerDocument.body,
this.JFb);t.a.instance.ta(y.a.xe,this.domElement.ownerDocument.body,this.JFb);v.a.Dp||(n.a.instance.ta(y.a.pointerDown,this.domElement,this.bO),n.a.instance.ta(y.a.Jj,this.domElement,this.yI))}Lqh(){if(!ea.Ycb){document.getElementById(ea.EXf);this.FXf=!0;var lb=ea.Ycb=document.createElement("div");this.grid.$.frame.Yaa().appendChild(lb);lb.id=ea.EXf;lb.className=l.a.hwh;C.DOMElementExtensions.setVisible(lb,!1)}}MOe(){if(this.LAa){const lb=this.domElement.ownerDocument.body;this.grid.Dj?(lb.removeEventListener(y.a.Dha,
this.zCf),lb.removeEventListener(y.a.wHa,this.ACf)):(n.a.instance.Ba(y.a.Jj,lb,this.J$a),t.a.instance.Ba(y.a.Zf,lb,this.J$a));this.LAa=!1}this.cY=!1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.ETf():(this.gYf(),this.fLd());X.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}gYf(){this.grid.qb.Xg([this.isRow?13:14]);this.grid.qb.pTa()}FGg(){this.fe.addRowColToModel(this.ni.nnb-1,this.ni.HSf);this.YQb=!0}ICd(lb){if(!this.cY)return!1;const Y=this.isRow;
if(!this.grid.Dj&&!this.d1){this.d1=document.createElement("div");this.d1.style.cssText="position: relative; width: inherit; height: inherit;"+(Y?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Oa=this.ni.rK();Oa.nextSibling;)this.d1.appendChild(Oa.nextSibling);Oa.parentNode.appendChild(this.d1)}Oa=Y?lb.y-this.N8a.y:(this.rtl?-1:1)*(lb.x-this.N8a.x);const Wa=Y?lb.y-this.KBa.y:(this.rtl?-1:1)*(lb.x-this.KBa.x),Ca=this.grid.Dj?this.zab:this.ni.E4();if(Ca===e.a.dxa)return!1;Oa&&(0<this.ql||
0<Ca+Wa)&&Ca+Wa<=this.Btf&&(this.ql=this.zzc(Wa),this.$dd(lb,this.ql,!1),this.grid.Dj?this.ql>=ea.qaf?(this.bNd=!0,this.ni.setCellExtent(this.ql)):this.bNd&&(this.bNd=!1,this.ni.setCellExtent(ea.qaf)):(C.DOMElementExtensions.fpa(this.ni.rK(),!Y,Math.max(this.lLb+Wa,0)),this.d1.style[Y?"top":this.rtl?"right":"left"]=Math.max(Wa,-this.lLb)+"px"),Oa=(this.grid.Dj?this.BJf:Y?this.ni.fe.FC:this.ni.fe.HC)+Math.max(Wa,this.grid.Dj?-this.zab+ea.Zdc:-this.lLb),C.DOMElementExtensions.fpa(this.ni.fe.domElement,
!Y,Oa),this.grid.Dj&&this.ni.fe.atj(Oa),this.N8a=new Sys.UI.Point(lb.x,lb.y),C.DOMElementExtensions.setVisible(this.FG,!1));return!0}E4(){return this.ni?this.dY?ea.e$h:this.ni.E4():e.a.dxa}$dd(lb,Y,Oa){this.qN&&Oa&&(x.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.fLd());this.qN||Oa||x.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");
this.vwd&&this.vwd(()=>({["Location"]:"canvas"}));this.qN?this.FZe(Y):(this.qN=document.createElement("div"),this.qN.id=this.U9h,this.FZe(Y),this.qN.className=l.a.Nuh,Y=document.getElementById(this.grid.$.Eb+m.a.nvf),Y.insertBefore(this.qN,Y.firstChild),lb=da.a(this.grid.$).cka(lb),this.qN.style.left=(this.rtl?Math.max(lb.x-this.qN.offsetWidth,0):lb.x-Math.max(lb.x+this.qN.offsetWidth-Y.offsetWidth,0)).toString()+"px",Y=document.getElementById(m.a.Csa),this.qN.style.top=(lb.y-(A.AFrameworkApplication.sa&&
A.AFrameworkApplication.sa.Pa.Ye?0:Y.offsetHeight)-this.qN.offsetHeight).toString()+"px")}fLd(){C.DOMElementExtensions.uf(this.qN);this.qN=null}FZe(lb){var Y=new oa(this.grid.$.workbookContext.DxDigitNormal);Y=this.isRow?Y.HFe(lb).toFixed(2):Y.xFe(lb).toFixed(2);this.qN.innerText=`${this.isRow?this.P9h:this.Y9h} ${Y} (${lb.toString()} ${this.S9h})`}xMf(lb,Y){let Oa;if(-1!==this.grid.ha.selectionType||2===lb.tb&&lb.Ca.button!==Sys.UI.MouseButton.leftButton||!this.Btd(Oa=this.ogd(lb))||!this.ukf)return!1;
H.g(lb.Ca);this.KBa=this.N8a=new Sys.UI.Point(lb.clientPoint.x,lb.clientPoint.y);this.oYg(Oa,Y);if(!this.ni)return!1;this.cY=!0;this.Mpi(this.ni,Oa)&&this.Sci();this.lLb=this.Cfd();return this.yMf(lb.Ca.rawEvent,Y)}wMf(lb,Y,Oa,Wa,Ca,Ra){this.cY=!0;this.dY=Ca;this.ni=lb;this.ljc=!1;this.KBa=this.N8a=new Sys.UI.Point(Y,Oa);lb=this.ni.getRange();this.aS=Ca?this.hse(lb):lb;this.zab=this.E4();this.BJf=this.isRow?this.ni.fe.FC:this.ni.fe.HC;this.yMf(Ra,Wa)}yMf(lb,Y){const Oa=I.EwaSettings.rod()&&this.grid.Dj?
{["IsResizingHiddenHeader"]:this.dY,["IsAutoFitting"]:Y,["NumberOfSelectedRanges"]:this.grid.ha.ra.YF,["Location"]:"canvas",["ResizeRange"]:this.aS,["ResizedCellAbsoluteIndex"]:this.ni.nnb,["HeaderViewBlockHashCode"]:this.fe.hashCode}:{["IsResizingHiddenHeader"]:this.dY,["IsAutoFitting"]:Y,["NumberOfSelectedRanges"]:this.grid.ha.ra.YF,["Location"]:"canvas"};W.b(this.grid.$).ud(J.a.Tkj,Oa);this.grid.TCj&&(Y=Y?"header_resize_autofit":"header_resize_start",K.b(this.grid.$).mCa(lb,Y,void 0));this.offset=
this.ni.iba();this.ql=this.grid.Dj?this.zab:this.ni.E4();if(this.ql===e.a.dxa)return!1;X.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}Mpi(lb,Y){var Oa=this.ni.rK();if(!Oa)return x.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Oa=Oa.nextSibling;if(!Oa)return!1;lb=lb.getRange();Oa=this.fe.Jva(Oa).getRange();if(!lb||!Oa)return x.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;lb=this.isRow?lb.bottom:lb.right;
Oa=this.isRow?Oa.bottom:Oa.right;return lb+1!==Oa&&lb!==Oa&&this.Btd(Y,!0)}Sci(){var lb=this.ni.rK();const Y=this.fe.Jva(lb.nextSibling);ea.Npi(Y,this.isRow)?(this.ni=Y,this.aS=this.ni.getRange()):(this.GGg(lb),this.ni=Y,lb=this.ni.getRange(),this.aS=this.hse(lb),this.dY=!0)}hse(lb){return this.isRow?new O.Range(lb.top-1,lb.left,lb.top-1,lb.right,!1,!0):new O.Range(lb.top,lb.left-1,lb.bottom,lb.left-1,!1,!0)}GGg(lb){const Y=this.fe.Jva(lb.nextSibling),Oa=ea.fbh(Y,this.isRow,this.rtl);Oa&&lb.parentNode.insertBefore(Oa,
Y.rK())}Ohd(lb){const Y=this.aS,Oa=lb.ha.ra.selectedRanges;if(lb.ha.ra.Ntb(Y))if(this.isRow){if(z.a.all(Oa,Wa=>Wa.isRow))return Oa}else if(z.a.all(Oa,Wa=>Wa.hf))return Oa;return[Y]}getCellExtent(){return this.ni.getCellExtent()}Cfd(){const lb=this.ni.rK().style;return Math.max(0,Math.min(this.Btf,0|parseInt(this.isRow?lb.height:lb.width,10)))}zzc(lb=0){const Y=this.grid;var Oa=this.fe.$i.paneType;let Wa;Wa=this.isRow?3===Oa?[3,2]:[1,4]:4===Oa?[2,4]:[1,3];var Ca=Math.max(this.grid.Dj?this.zab:this.ni.E4(),
0);lb=this.dY&&!this.grid.Dj?Math.max(this.Cfd(),0):Math.max(Ca+lb,0);Oa=Y.cWh(Oa,this.isRow);Oa=this.isRow?new h.a(0,this.offset,Oa,lb):new h.a(this.offset,0,lb,Oa);Ca=[this.isRow?13:14];Y.qb.Ti(new O.Range(1,1,e.a.fh,e.a.qh,!1,!0),Ca,!1);Y.qb.Sn(Ca,Oa,Wa);return lb}X1c(){this.aS=this.KBa=this.N8a=null;if(this.d1){const lb=this.d1.parentNode;if(lb)for(lb.removeChild(this.d1);this.d1.firstChild;)lb.appendChild(this.d1.firstChild);this.d1=null}this.ni=null;this.cY=!1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||
this.ETf()}ETf(){this.ljc=!1;this.fLd();C.DOMElementExtensions.setVisible(ea.Ycb,!1);C.DOMElementExtensions.setVisible(this.FG,!1);I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.gYf()}ogd(lb){if(C.DOMElementExtensions.Fz(lb.Gb,"a"))return null;const Y=this.Ylf(lb.Ca);if(Y&&this.grid.ha.ra.Og){var Oa=this.grid.ha.ra.$c;Oa=this.fe.rs(O.Range.Qc(Oa.bottom,Oa.right))}else Oa=this.fe.Jva(lb.Gb);if(!Oa)return null;const Wa=Oa.rK(),Ca=new Sys.UI.Bounds(Wa.offsetLeft,Wa.offsetTop,
Wa.offsetWidth,Wa.offsetHeight);var Ra=C.DOMElementExtensions.getBoundingClientRect(lb.Gb);Ra=new Sys.UI.Point(lb.clientPoint.x-Ra.x,lb.clientPoint.y-Ra.y);this.isRow&&!Y&&(Ra.y+=Q.HelperMethods.oD(lb.Gb,Wa,this.rtl).y);return new S(Wa,Ra,Ca,Oa.getRange(),Math.max(ea.QEi,Math.min(ea.KDi,(this.isRow?Ca.height:Ca.width)*ea.clj)),Y,!this.isRow&&0<Wa.getElementsByTagName("input").length)}Btd(lb,Y=!1){if(!lb||this.grid.eb)return!1;if(lb.Xlf)return!0;var Oa=lb.mPa;const Wa=lb.Xcb;var Ca=this.fe.$i.paneType,
Ra=this.grid.Bf(Ca).vi,la=!!Ra&&Ra.top===lb.eld.top,ua=!!Ra&&Ra.left===lb.eld.left;Ca=!!Ra&&Ra.bottom===lb.eld.bottom&&(3===Ca||2===Ca);this.isRow?(ua=lb.rEb.y,lb=ua<=Wa&&!la,Oa=ua>=Oa.height-Wa-(Ca?ea.xIh:0),Y=Y?lb:Oa||lb):(Ca=lb.R8h,la=this.rtl,Ra=lb.rEb.x,lb=Ra<=Wa&&(!ua||la)&&(!Ca||!la),Oa=Ra>=Oa.width-Wa&&(!la||!ua)&&(!Ca||la),Y=Y?la?Oa:lb:lb||Oa);return Y}oYg(lb,Y){const Oa=this.isRow;if(lb.Xlf)this.ni=this.fe.Jva(lb.Hwa);else if(Oa&&lb.rEb.y<=lb.Xcb&&lb.mPa.height>lb.Xcb||!Oa&&lb.mPa.width>
lb.Xcb&&(!this.rtl&&lb.rEb.x<=lb.Xcb||this.rtl&&lb.rEb.x>=lb.mPa.width-lb.Xcb)){if(this.ni=lb.Hwa.previousSibling?this.fe.Jva(lb.Hwa.previousSibling):this.qVh(),Y&&lb.Hwa.classList.contains(Oa?l.a.AUe:l.a.zUe)&&(lb=this.fe.Jva(lb.Hwa)))lb=lb.getRange(),this.aS=Oa?new O.Range(lb.top-1,lb.left,lb.top-1,lb.right,!1,!0):new O.Range(lb.top,lb.left-1,lb.bottom,lb.left-1,!1,!0)}else this.ni=this.fe.Jva(lb.Hwa);!this.aS&&this.ni&&(this.aS=this.ni.getRange())}qVh(){var lb=this.isRow?1:0;return(lb=this.fe.$i.KG(this.fe.$i.Ea.Mg(this.grid.$.oa,
d.a.QM(this.fe.position.X+lb-1,this.fe.position.Y-lb,this.fe.position.PaneType))))?lb.pVh():null}Pdf(){this.ljc=!0;const lb=this.dlj;C.DOMElementExtensions.setVisible(lb,!0);lb.style.cursor=this.isRow?l.a.IRe:l.a.sQe;this.zzc()}cqh(lb){this.grid.$.Xc(this.isRow?745189930:-445963340,D.a.Db,30,{["resizeRowColumnParameters"]:lb})}dfh(){const lb=document.createElement("div");lb.className=l.a.gxh;const Y=document.createElement("div");Y.className=f.a.qv;lb.appendChild(Y);const Oa=document.createElement("img");
Oa.src=G.a.we(0);Oa.className=this.isRow?f.a.ewh:f.a.$vh;Y.appendChild(Oa);this.fe.UA.domElement.parentNode.insertBefore(lb,this.fe.UA.domElement);this.grid.Dj?lb.addEventListener(y.a.z$,this.QQi):(n.a.instance.ta(y.a.pointerDown,lb,this.bO),B.a.instance.ta(y.a.Ek,lb,this.Nca));C.DOMElementExtensions.setVisible(lb,!1);this.FG=lb}yJb(){this.X1c();this.FG&&(this.fe.UA.domElement.parentNode.removeChild(this.FG),this.FG=null)}Ylf(lb){return C.DOMElementExtensions.yf(this.FG,lb.target)}Nqb(){this.cY&&
(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.Dj&&this.ICd(this.KBa),this.MOe(),this.grid.Dj||C.DOMElementExtensions.fpa(this.ni.rK(),!this.isRow,this.lLb),this.yJb(),this.YQb=this.dY=!1)}Uhf(){return I.EwaSettings.ma(666)}wcf(lb){(lb=lb.Ca.rawEvent)&&lb.detail===ea.Kpj&&(lb.type===y.a.qq?(this.cY=!1,this.kZc=!0):lb.type===y.a.uI&&(this.cY=!0,this.kZc=!1))}static bbh(lb,Y){return new ea(lb,Y)}static ERd(lb,Y,Oa){if(Y){lb.ColumnWidth=-1;lb.RowHeight=Oa;for(const Wa of lb.SheetMultiRange.Ranges)Wa.FirstColumn=
0,Wa.LastColumn=0}else{lb.RowHeight=-1;lb.ColumnWidth=Oa;for(const Wa of lb.SheetMultiRange.Ranges)Wa.FirstRow=0,Wa.LastRow=0}}static Npi(lb,Y){if(!lb||!lb.rK())return x.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const Oa=lb.getRange();lb=lb.rK().style;if(!Oa||!lb)return x.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;lb=Y?lb.height:lb.width;return(Y?Oa.top:Oa.left)===(Y?e.a.fh:e.a.qh)&&lb===ea.Flg}static fbh(lb,Y,Oa){if(!lb)return x.ULS.shipAssertTag(537154012,
2,!1,"header after hidden is null"),null;var Wa=lb.rK();if(!Wa||!Wa.style)return x.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;lb=document.createElement("div");const Ca=Wa.style;lb.style.top=Y?Ca.top:ea.Flg;Y||(Oa?lb.style.right=Ca.right:lb.style.left=Ca.left);lb.classList.add(Y?w.gwh:w.fwh);lb.classList.add(Y?l.a.Qub:l.a.Pub);Oa=document.createElement("div");Oa.classList.add(Y?l.a.nUe:l.a.Ead);Wa=Y?Number.parseInvariant(Wa.innerText):O.Range.a1a(Wa.innerText);
Oa.innerText=Y?(Wa-1).toString():O.Range.OM(Wa-1);lb.appendChild(Oa);return lb}}ea.QEi=0;ea.KDi=5;ea.Zdc=1;ea.qaf=1;ea.e$h=0;ea.xIh=3;ea.clj=.1;ea.EXf="ewa-rszrbg";ea.Flg="0px";ea.Kpj=2;ea.Ycb=null;Object(u.a)(ea,"HeaderResizeBehavior",M.a,[629]);class ya extends b.a{constructor(){super();this.Fb()}create(){this.ob(ea.bbh)}static ka(lb){lb.da.Ga(136,new ya)}}Object(u.a)(ya,"HeaderResizeBehaviorFactory",b.a,[]);var ha=a(55),La=a(692),Ia=a(50),ra=a(37),pa=a(170),ba=a(423),fa=a(371),Ka=a(188),aa=a(282),
ja=a(281),Va=a(67),bb=a(21);class wa{constructor(lb,Y){this.isRow=!1;this.autoFitRange=null;this.isRow=lb;this.autoFitRange=Y}}Object(u.a)(wa,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[137]);class ka{constructor(lb){this.resizeParameters=null;this.resizeParameters=lb}}Object(u.a)(ka,"MacroRecorderSheetRowsColumnsResizedPayload",null,[137]);var ta=a(83);b=a(284);var qa=a(22);class rb extends b.a{constructor(lb,Y){super(lb);this.Wwb=Oa=>{Oa=this.Cgd(Oa);return this.Sdd(Oa)};this.Ukj=(Oa,Wa)=>
{var Ca=this.j8a=Wa[rb.zki];1===Oa?(Oa=Wa[rb.BGj],Ca=this.C7e(Oa,Ca),x.ULS.shipAssertTag(537153996,0,Ca!==rb.Hba,`ResizeHeadersDialogHandler - invalid size input, size = ${Oa}`),Oa=Ca!==this.ind,x.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.j8a,Ca,Oa),Oa&&this.H9g(Ca)):x.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===
Y.command;this.gridView=bb.h(this.$);this.rvc=new oa(this.$.workbookContext.DxDigitNormal);this.ind=this.OYg();lb=this.o8g(this.ind);Y=this.q8g(this.ind);this.Pl=U.a.instance.ga(this.isRow?477:478);lb=this.kN(lb,Y);this.initializeAndShow(this.Pl,this.Ukj,lb);x.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get pc(){return"ResizeHeadersDialog"}get j8a(){return rb.Wbe}set j8a(lb){rb.Wbe=lb}kN(lb,Y){return{[rb.sV]:this.pc,[rb.aqi]:this.isRow,[rb.qdi]:lb,
[rb.pdi]:Y,[rb.Pmi]:this.j8a,[rb.Bgd]:this.Wwb}}OYg(){const lb=this.FLh();try{return this.hQh(lb)}finally{lb&&lb.dispose()}}H9g(lb){const Y={};Y.SheetMultiRange=L.r(this.gridView.ha.ra.selectedRanges,this.$);rb.ERd(Y,this.isRow,lb);this.$.Xc(this.isRow?745189930:-445963340,D.a.Db,8,{["resizeRowColumnParameters"]:Y})}C7e(lb,Y){return qa.a.y5(lb)?Y?this.n8g(lb):this.p8g(lb):rb.Hba}p8g(lb){return Math.floor(parseFloat(lb))}n8g(lb){lb=parseFloat(lb);return 0>lb?rb.Hba:lb?this.isRow?Q.HelperMethods.R1i(lb):
this.rvc.e4g(lb):0}q8g(lb){return lb===rb.Hba?"":this.isRow?this.rvc.HFe(lb).toString():this.rvc.xFe(lb).toFixed(2)}o8g(lb){return lb===rb.Hba?"":lb.toString()}hQh(lb){if(!lb||!lb.$$mn()||!lb.Zn)return rb.Hba;var Y=Object(ta.a)(272,lb.Zn);if(!Y)return rb.Hba;for(Y=this.isRow?Y.uzb:Y.gnd;lb.$$mn();){const Oa=Object(ta.a)(272,lb.Zn);if(Oa&&(this.isRow?Oa.uzb:Oa.gnd)!==Y)return rb.Hba}return Y}FLh(){const lb=[];for(const Oa of this.gridView.ha.ra.selectedRanges){const Wa=Oa.clone();var Y=this.gridView.Bf(this.gridView.ib.Ni(Wa));
Y=Wa.Ke(Y.vi);if(!Y)return null;this.isRow?Wa.right=Wa.left=Y.left:Wa.top=Wa.bottom=Y.top;lb.push(Wa)}return lb.length?this.gridView.caa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",lb):null}Cgd(lb){if(!qa.a.y5(lb))return 1;lb=this.C7e(lb,this.j8a);if(0===lb)if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)){const Y=this.gridView.ha.ra.selectedRanges;if(this.gridView.Xd){if(!this.gridView.Xd.wze(Y,this.isRow))return 3}else if(this.vkf())return 3}else if(this.vkf())return 3;
return this.Rsi(lb)?0:2}vkf(){const lb=this.gridView.ha.ra.selectedRanges;return this.isRow&&L.P(lb)||!this.isRow&&L.O(lb)}Sdd(lb){let Y="";switch(lb){case 0:Y="";break;case 1:Y=U.a.instance.ga(767);break;case 2:Y=String.format(U.a.instance.nb(99),0,this.Fcc(this.j8a));break;case 3:Y=U.a.instance.ga(768)}return Y}Rsi(lb){return 0<=lb&&lb<=this.Fcc(!1)}Fcc(lb){return this.rvc.Fcc(lb,this.isRow)}static ERd(lb,Y,Oa){if(Y){lb.ColumnWidth=rb.Hba;lb.RowHeight=Oa;for(const Wa of lb.SheetMultiRange.Ranges)Wa.FirstColumn=
0,Wa.LastColumn=0}else{lb.RowHeight=rb.Hba;lb.ColumnWidth=Oa;for(const Wa of lb.SheetMultiRange.Ranges)Wa.FirstRow=0,Wa.LastRow=0}}}rb.sV="id";rb.aqi="isRow";rb.qdi="initialSizeInPx";rb.pdi="initialSizeInDefaultUnits";rb.Pmi="isInitialUnitsDefaultUnits";rb.Bgd="getInputErrorIfInvalid";rb.BGj="size";rb.zki="isDefaultUnits";rb.Hba=-1;rb.Wbe=!0;Object(u.a)(rb,"ResizeHeadersDialog",b.a,[]);var Za=a(60);const gb=(lb,Y,Oa,Wa,Ca,Ra,la=null)=>{la=lb.Na(41,la);la.resizeRowColumnParameters=Y;return Za.g(lb,
"ResizeRowsColumns",la,Oa,Wa,Ca,Ra,0)};var mb=a(343),Ga=a(288),ib=a(64),cc=a(190),ic=a(29),xb=a(345);class Vb{constructor(lb,Y,Oa){this.GUi=(Wa,Ca)=>{if(!aa.a(Wa)&&Ca){const Ra=!!Wa&&!!Wa.RequestTelemetryData;bb.h(this.$).ji.Vla(Ca,Wa.StateId,Ra?Wa.RequestTelemetryData.EcsOperationDuration:0,Ra?Wa.RequestTelemetryData.EcsRequestDuration:0,Ra?Wa.RequestTelemetryData.WfeRequestDuration:0)}};this.ULi=(Wa,Ca)=>{Ca&&Ca.y1b&&Ca.y1b.SheetName&&Ca.y1b.Ranges.length&&Ca.Oji&&I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",
!1)&&(this.hXd=Ca.y1b.Ranges[0],this.DV()?this.KDe(this.hXd):this.grid.AZa(this.nza))};this.nza=()=>{this.DV()&&(this.grid.wcb(this.nza),this.KDe(this.hXd))};this.$=lb;this.Ag=Y;this.gridInstantaneousAction=Oa;this.grid=bb.h(this.$);this.hXd=null}nc(lb,Y){lb=!0;switch(Y){case -445963340:case 1391094586:lb=this.Td(8);break;case 745189930:case 146338636:lb=this.Td(16)}return!lb}executeCommand(lb,Y,Oa){var Wa=bb.h(this.$);const Ca=Y.command;var Ra=pa.a.create().toString();let la=ra.TaskExtensions.Sj();
switch(Ca){case 1391094586:case 146338636:lb=1391094586===Ca;(Ra=Oa.autoFitRanges)&&Ra.Ranges&&Ra.Ranges.length||(Ra=L.r(Wa.ha.ra.selectedRanges,this.$));la=this.gmh(lb?1:0,Ra,Y);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:lb=-445963340===Ca||-706918724===Ca||369708605===Ca;if(-445963340===Ca||745189930===Ca){var ua=ba.a(Y.command);Wa.ji.X7(16,Ra,ua);Wa=Oa.resizeRowColumnParameters}else{Oa=Wa.ha.ra.selectedRanges;let fb=0;for(var xa of Oa)if(-706918724===
Ca||369708605===Ca){const Jb=xa.right-xa.left+1;fb+=0<Jb?Jb:-1*Jb}else if(1542466017===Ca||1051390410===Ca)fb+=xa.bottom-xa.top+1;369708605===Ca||1542466017===Ca?x.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${fb}`):(-706918724===Ca||1051390410===Ca)&&x.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${fb}`);if(!I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)||!Wa.Xd){if(-706918724===
Ca&&6===Y.$e&&L.O(Oa)){x.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===Ca&&6===Y.$e&&L.P(Oa)){x.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}xa=369708605===Ca||1542466017===Ca?-2:0;Wa={};Wa.SheetMultiRange=L.r(Oa,this.$);if(lb)for(ua of Wa.SheetMultiRange.Ranges)ua.FirstRow=0,ua.LastRow=
0;else for(const Jb of Wa.SheetMultiRange.Ranges)Jb.FirstColumn=0,Jb.LastColumn=0;Wa.RowHeight=lb?-1:xa;Wa.ColumnWidth=lb?xa:-1}la=this.Amh(Wa,Y,Ra,lb);break;case 957527587:case 2040891415:new rb(this.$,Y)}return la}KDe(lb){if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)){const Y=ib.d(this.$.xa.oa),Oa=new mb.a(L.B(lb),Y);ra.TaskExtensions.Aa(Ia.GetServiceTaskFactory.Oa(this.$.da,426,427,1),Wa=>{void Wa.result.iCc(Oa,"ColumnAutoFit")},
this.$.la,3)}}wc(lb,Y,Oa,Wa){if(lb=!!Oa&&!!Wa&&1===Wa.mz)switch(Y.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:lb=!1}return lb}Kc(){return!1}jzi(lb){x.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(Ga.c)(lb)}. Reason: ${Object(Ga.c)(lb)?void 0:lb.reason}.`)}Td(lb){return(new T.a(this.$.xa)).Td(lb)}DV(){return this.grid.Ea.EN(4,
this.$.oa)}gmh(lb,Y,Oa){const Wa=this.$.pa.ya.Wb(),Ca=0===lb,Ra=()=>new wa(Ca,Y);return fa.a(this.$.userOperationManager,(la,ua,xa)=>{var fb=this.$.pa.ya;la=ja.b(la,this.ULi);var Jb={Oji:!Ca,y1b:Y};const Ob=fb.Na(41,Wa);Ob.isRow=Ca;Ob.autoFitRanges=Y;return Za.g(fb,"AutoFit",Ob,la,ua,xa,Jb,0)},la=>new Ka.a(135,0,la,void 0,Ra),Oa)}Amh(lb,Y,Oa,Wa){const Ca=Y.command,Ra=bb.h(this.$),la=L.g(lb.SheetMultiRange.Ranges);if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)){var ua=
-706918724===Ca||-445963340===Ca&&0===lb.ColumnWidth;if((1051390410===Ca||745189930===Ca&&0===lb.RowHeight||ua)&&null!=Ra.Xd&&!Ra.Xd.wze(la,!Wa))return this.qlh(Wa),ra.TaskExtensions.Sj()}let xa;ua=I.EwaSettings.$hf()&&-706918724===Ca;if(745189930===Ca||-445963340===Ca||ua)x.ULS.shipAssertTag(537154002,0,this.$.activeItemName===lb.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),ua?Object(cc.c)(()=>{},this.$.la,0):(xa=this.Ag.PEj(Ra,la,Wa?lb.ColumnWidth:
lb.RowHeight,!Wa),this.jzi(xa),Object(Ga.c)(xa)&&Ra.ji.uS(Oa,Va.BasicTelemetryCalculator.$Q));const fb=this.$.pa.ya.Wb({uca:!0,Dba:3});Wa=(Ob,eb,Ma)=>{this.$.My();L.i(la,",",this.$,!1);return gb(this.$.pa.ya,lb,ja.b(Ob,this.GUi),eb,Ma,Oa,fb)};const Jb=()=>new ka(lb);return xa&&Object(Ga.c)(xa)?fa.a(this.$.userOperationManager,Wa,Ob=>new Ka.a(136,0,Ob,64,Jb),Y):fa.a(this.$.userOperationManager,Wa,Ob=>new Ka.a(136,0,Ob,void 0,Jb),Y)}qlh(lb){lb=ic.a.Zc(1,0,lb?769:771,lb?770:772,0,lb?-2037763134:503471870,
lb?"HideAllColumnsError":"HideAllRowsError");new xb.a(this.$,lb)}}Object(u.a)(Vb,"ResizeCommandHandler",null,[223]);class wb extends La.a{constructor(lb){super(lb)}ld(){const lb=Ia.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Ya);let Y;Y=I.EwaSettings.$hf?Ia.GetServiceTaskFactory.Oa(this.$.da,528,529,this.Ya):ha.Task.Ta(null);ra.TaskExtensions.Aa(lb,()=>{this.Yc([new Vb(this.$,lb.result,Y.result)])},this.la,3)}static ka(lb){La.a.Nd(113,new wb(lb))}}Object(u.a)(wb,"ResizeCommandHandlerFactory",
La.a,[]);a.d(E,"a",function(){return cb});const cb=()=>{c.a.Fa(lb=>{ya.ka(lb);wb.ka(lb)})}},1177:function(u,E,a){u=a(0);var c=a(134);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose)}displayError(O){this.fA(O,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}j8c(O){this.fA(O,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(u.a)(b,"ErrorDialog",c.StandardDialog,[446]);
var e=a(15),f=a(157);class d{g_e(){e.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const O=new f.a;O.setResult("api.onedrive.com");return O.task}}Object(u.a)(d,"OneDriveConsumerEndpointHelper",null,[318]);var h=a(84),m=a(54),l=a(374),w=a(228);class n{constructor(O,G,C,H){this.hFa=this.J6=null;this.kSc=this.mSc=!1;this.NXa=null;this.lb=O;this.URb=G;this.OEa=C;this.$s=H}get tte(){return this.URb}get fa(){return this.lb}a5a(){this.NXa||(this.NXa=this.rab?w.a.create(this.rab,null,null,
null,!1):null);return this.NXa}setup(O){this.hFa=O;this.mSc||this.kSc?this.mSc&&this.hFa&&this.hFa(!0):(O=this.a5a())?(this.kSc=!0,O.k9a.continueWith(G=>{this.xTi(G)}),l.a.Sia(O)):(e.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.hFa(!1))}YCd(O){e.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",O.exception?O.exception.toString():"No error detail.")}xTi(O){this.kSc=!1;if(O.Xf)this.YCd(O),this.hFa(!1);else try{this.mSc=
!0,e.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.nnd(),e.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.hFa(!0)}catch(G){e.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",G.toString()),this.hFa(!1)}}startPicker(O){this.J6=O;this.OEa?e.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,
this.xBd,"onApiReady")))}xBd(O){O?this.Wkc():this.vj()}vj(){this.$s().displayError(m.a.IYi)}onSuccess(O){e.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.J6&&this.J6(!0,O)}dispose(){this.NXa&&this.NXa.dispose()}}Object(u.a)(n,"AOneDriveFilePickerApiManager",null,[451,2]);class y extends n{constructor(O,G,C,H,I,M){super(G,C,H,M);this.Mh=null;this.r2=O;this.BBg=I}get rab(){return this.fa.Xa("OneDriveApiUrl")}start(O,G){this.Mh=O;this.startPicker(G)}nnd(){WL.init(1===
this.tte||2===this.tte?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}startPicker(O){this.J6=O;!this.OEa&&this.r2.QMa?(e.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(h.a)(this,this.xBd,"onApiReady"))):(e.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.BBg())}Wkc(){try{e.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),
WL.fileDialog(this.Mh).then(Object(h.a)(this,this.onSuccess,"onSuccess"),Object(h.a)(this,this.I6,"onFailure"))}catch(O){e.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",O,O.stack),this.vj()}}I6(O){if(O&&O.error){if("user_canceled"===O.error.code){e.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}e.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",O.error.code,O.error.message)}else e.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.J6&&this.J6(!1,O);this.vj()}}Object(u.a)(y,"OneDriveFilePickerApiManagerV5",n,[]);class t extends n{constructor(O,G,C,H,I){super(O,G,C,H);this.oUb=this.Lfe=null;this.Etg=I;this.options={};this.options.clientId=this.fa.Xa("OneDriveApiV7ClientId");this.options.cancel=Object(h.a)(this,this.NBc,"toggleHostDivVisibility")}get rab(){return this.fa.Xa("OneDriveApiV72Url")}start(O,G){this.oUb=G;const C=this.Etg.g_e();C.continueWith(()=>{e.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Lfe=C.result;this.startPicker((H,I)=>{this.NBc();O(H,I)})},3);C.continueWith(()=>{e.ULS.sendTraceTag(24134242,352,15,C.exception.message);this.NBc()},5)}nnd(){this.options.success=O=>{const G={};G.data=O;this.onSuccess(G)};this.options.error=O=>{const G={};G.error=O;this.I6(G)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Lfe;this.options.advanced.iframeParentDiv=
this.oUb}Wkc(){try{e.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.NBc(),OneDrive.open(this.options)}catch(O){e.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",O.message),this.vj()}}I6(O){this.J6&&this.J6(!1,O);this.vj()}NBc(){this.oUb.style.visibility="hidden"===this.oUb.style.visibility?"":"hidden"}}Object(u.a)(t,"OneDriveFilePickerApiManagerV7",n,[]);class r extends n{constructor(O,G,C,H){super(O,G,C,H);this.xqg=O;this.options=
{};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Xa("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get rab(){return this.fa.Xa("OneDriveApiV72Url")}start(O,G,C,H){this.options.advanced.iframeParentDiv=C;this.options.advanced.endpointHint=H;this.options.cancel=G;this.xqg.qa("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(O)}startPicker(O){this.J6=O;this.OEa?e.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.xBd,"onApiReady")))}nnd(){this.options.success=O=>{const G={};G.data=O;this.onSuccess(G)};this.options.error=O=>{const G={};G.error=O;this.I6(G)}}Wkc(){try{e.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(O){e.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",O.message,O.stack),this.vj()}}YCd(O){e.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",O.exception?O.exception.toString():"No error detail.");l.a.lej(this.rab);this.NXa=null}vj(){this.$s().j8c(m.a.Unj)}I6(O){this.J6&&this.J6(!1,O)}}Object(u.a)(r,"OneDriveFilePickerApiManagerV72",n,[]);
class v{constructor(O){this.olsSessionId=this.value=this.key=null;this.olsSessionId=O}}Object(u.a)(v,"IExtraData",null,[]);var B=a(4);class A extends r{constructor(O,G,C,H){super(O,G,C,H);this.options.advanced.filter=O.Xa("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=B.AFrameworkApplication.Bte;O.qa("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=O.Xa("OneDriveApiV72CommandMode")||"none");O.qa("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new v(B.AFrameworkApplication.userSessionId))}get rab(){return this.fa.Xa("OneDriveApiV72Url")}Wkc(){try{e.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",B.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(O){e.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",O.message,O.stack),this.vj()}}}Object(u.a)(A,"OneDriveFilePickerApiOpenManagerV72",r,[]);var z=a(240);class x{constructor(O){this.yk=null;this.yh=O;this.nRc=3}g_e(){this.yk=new f.a;e.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.TPd();return this.yk.task}TPd(O=null){const G=String.format("GetMoreInfoHandler.ashx?{0}",B.AFrameworkApplication.MIa);this.yh.Zga(G,1,null,O,
["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(h.a)(this,this.zWh,"getMoreInfoSucceeded"),Object(h.a)(this,this.xWh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}xWh(O){if(O.data.httpStatus===z.a.THb&&"X-NewKey"in O.data.responseHeaders){e.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const G={};G["X-Key"]=O.data.responseHeaders["X-NewKey"];this.TPd(G)}else 0<this.nRc?(e.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.nRc),this.nRc--,this.TPd()):(e.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.yk.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}zWh(O){"PersonalFileStorageUrl"in O.data.responseHeaders&&""!==O.data.responseHeaders.PersonalFileStorageUrl?(e.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.yk.setResult(O.data.responseHeaders.PersonalFileStorageUrl)):(e.ULS.sendTraceTag(24134240,
352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.yk.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(u.a)(x,"OneDriveForBusinessEndpointHelper",null,[318]);var D=a(248),J=a(559);class L{constructor(){this.gb=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Wh(O){this.gb=O;this.gb.register(y,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").xc().Fc(()=>
new y(J.a.instance,B.AFrameworkApplication.fa,B.AFrameworkApplication.Z2a,B.AFrameworkApplication.limitedEdit,B.AFrameworkApplication.r8f,()=>new b));B.AFrameworkApplication.klf?this.gb.register(318,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").xc().Fc(()=>new d):this.gb.register(318,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").xc().Fc(()=>new x(B.AFrameworkApplication.Dd));this.gb.register(t,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").xc().Fc(()=>
new t(B.AFrameworkApplication.fa,B.AFrameworkApplication.Z2a,B.AFrameworkApplication.limitedEdit,()=>new b,this.gb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.gb.register(r,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").xc().Fc(()=>new r(B.AFrameworkApplication.fa,B.AFrameworkApplication.Z2a,B.AFrameworkApplication.limitedEdit,()=>new b));this.gb.register(A,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").xc().Fc(()=>new A(B.AFrameworkApplication.fa,
B.AFrameworkApplication.Z2a,B.AFrameworkApplication.limitedEdit,()=>new b))}static main(){D.a.instance.Fi(new L)}}Object(u.a)(L,"PackageManager",null,[4,5]);a.d(E,"a",function(){return T});const T=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");L.main()}},1184:function(u,E,a){u=a(0);var c=a(84),b=a(15),e=a(134),f=a(54),d=a(25);class h extends e.StandardDialog{constructor(U,N){super();this.OXa=!1;this.DA=null;this.La=U;this.djb=N;this.qTa=!1}displayError(U,N,W){this.DA=N;this.OXa=W;
b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",U,W);U=this.v1c(U);0===U?(this.Rb=6,this.oc(0,CommonUIStrings.l_DialogClose)):(this.Rb=0,this.oc(1,CommonUIStrings.l_DialogClose));0===U&&b.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.fA(f.a.Tnj,this.sfd(U),this.WQh(U,N),Object(c.a)(this,this.ZNd,"retryDialogHandler"),!0)}ZNd(U){1===U?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.DA?this.La.ae(d.a.gLb,
2,[this.DA,this.OXa]):this.La.processAction(d.a.gLb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}v1c(U){return 0>U||6<U?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",U),0):U}WQh(U,N){U=this.v1c(U);return this.djb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,N),CommonUIStrings.l_LockTargetText,
CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][U]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,N),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][U]}sfd(U){U=this.v1c(U);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][U]}}Object(u.a)(h,"ErrorRetryDialog",e.StandardDialog,[588]);class m{constructor(U,N){this.lb=U;this.La=N;this.djb=this.lb.qa("SaveToHostWithExtraCharsInFileName")}create(){return new h(this.La,this.djb)}}Object(u.a)(m,"ErrorRetryDialogFactory",null,[571]);e=a(1050);var l=a(146);class w{static get qg(){return l.a.gq(w.ol,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
w.ol="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(u.a)(w,"FileNameDialogHtml",null,[]);var n=a(4),y=a(30);class t extends e.a{constructor(U,N,W,X,sa,da){super(U,N,W,X,sa,da);this.qg=w.qg;this.Fe="FileNameDialog-SaveAsToHost"}sQ(U,N){const W=y.a.Rq(n.AFrameworkApplication.sm.tn);N={["txtFileName"]:U||W,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:N};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.G$b,"fileNameDialogHandler"),N);this.ELe(U,W)}}Object(u.a)(t,"FileNameDialog",e.a,[589]);class r{constructor(U,
N,W,X,sa,da){this.La=N;this.lb=U;this.MX=X;this.Mga=da;this.$s=sa;this.ef=W}create(){return new t(this.lb,this.La,this.ef,this.MX,this.$s,this.Mga)}}Object(u.a)(r,"FileNameDialogFactory",null,[570]);var v=a(641),B=a(105);class A{constructor(U,N,W){this.Mga=W;this.VJc=N;this.lb=U}Hg(){2===n.AFrameworkApplication.sa.Pa.Gj?n.AFrameworkApplication.ub.Ne(d.a.gLb,B.a.frame,Object(c.a)(this,this.IZf,"saveAsToHostActionDispatcher"),4):n.AFrameworkApplication.ub.Nb(d.a.gLb,B.a.frame,Object(c.a)(this,this.IZf,
"saveAsToHostActionDispatcher"))}IZf(U,N,W,X,sa){return N.contextId!==B.a.frame||U!==d.a.gLb?2:this.lb.qa("SaveAsToHostBrsIsEnabled")?1===W?v.SessionStatusManager.instance.Q5a||n.AFrameworkApplication.u5?8:32:2===W?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),U=this.VJc.create(),sa&&Object.getType(sa)===Array&&2===sa.length?U.sQ(sa[0],!!sa[1]):U.sQ(null,!1),32):8:8}}Object(u.a)(A,"SaveAsToHostActor",null,[]);var z=a(41),x=a(80),D=a(40),J=a(240),L=a(373),
T=a(164),O=a(642),G=a(766);class C{constructor(U,N,W,X,sa,da,S,oa){this.Nm=null;this.OXa=this.hEa=!1;this.Lga=this.Mh=this.DA=null;this.lb=N;this.gGa=this.lb.appSettings.SaveAsToHostWebServiceBase;this.Iae=X;this.Mlb=sa;this.yh=W;this.$s=da;this.Ah=oa;this.ef=S;this.La=U;this.Nfa=N.Xa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}GNb(){1!==this.ef.state&&(this.Nm=this.Mlb(),this.Nm.message=CommonUIStrings.l_CommentProgressTooltip,this.Nm.Rb=5,this.Nm.It=!1,this.Nm.EBa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}rS(U=0){1!==this.ef.state&&this.$s.create().displayError(U,y.a.Rq(this.DA),this.OXa)}WQa(){const U=this.lb.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");D.a.lf(U,D.a.CX(3),void 0,"UploadToHostManager.RedirectToFolder")}VQa(U){let N=!1,W=!1;this.lb&&(N=this.lb.qa("SaveACopyIsEnabledForUiHost"),W=this.lb.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
U,N,W);if(N&&W){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const X={};X[L.a.QQa]="1";X[L.a.documentUrl]=U;X[L.a.reason]=O.a.saveAs;n.AFrameworkApplication.jV().execute(sa=>{sa.Pj(T.a.tua,X)})}else N&&!W&&n.AFrameworkApplication.Rba?D.a.lf(U,D.a.CX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):D.a.lf(U,D.a.CX(3),void 0,"UploadToHostManager.RedirectToEditUrl")}voa(U,N,W=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.Iae&&!this.Iae()&&this.yh&&(this.Ah&&(this.Lga=this.Ah.Ac("DialogShown","SaveAsToHostUploadTime")),this.GNb(),this.OXa=N,this.DA=U,(this.Mh=W)&&"true"===this.Mh.SkipSaveToHost?this.e$b():this.zQ())}zQ(){32!==this.La.processAction(d.a.aSa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.e$b()):this.La.ae(d.a.aSa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.e$b()},(U,
N)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.rS(N)}])}UXi(U){this.qJa();this.hEa=!1;if(U&&U.data&&U.data.ue)if(({At:N}=z.d(U.data.ue)).returnValue)if(U=N,U.StatusCode!==J.a.lP&&U.StatusCode!==J.a.Lsb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var N={};N.FailureReason=U.StatusCode.toString();N.ExtraInfo=U.ExtraInfo;this.Nda(N);this.rS(parseInt(U.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.MMd();try{U.NewDocumentUrl&&""!==U.NewDocumentUrl?this.VQa(U.NewDocumentUrl):this.WQa()}catch(W){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",W.toString())}this.AHb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:G.a.Yfb(U.data.ue)}),this.Nda({["FailureReason"]:"Failed to deserialize response"}),this.rS();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Nda({["FailureReason"]:"null response"}),this.rS()}TXi(U){5!==U.data.status&&12!==U.data.status||this.hEa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:U.data.status,["HttpStatus"]:U.data.httpStatus}),this.Nda({["FailureReason"]:U.data.httpStatus.toString()}),this.qJa(),this.rS(),this.AHb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.hEa=!0,this.Mh&&"true"===this.Mh.SkipSaveToHost?this.e$b():
this.zQ())}qJa(){this.Nm&&(this.Nm.close(),this.Nm=null)}AHb(){this.Lga&&(this.Lga.stop(),this.Lga=null)}MMd(){this.Mh&&"VersionHistory"===this.Mh.SaveEntryPoint&&this.La.processAction(d.a.fvc,2)}Nda(U){this.Mh&&"VersionHistory"===this.Mh.SaveEntryPoint&&this.La.ae(d.a.OMd,2,U)}e$b(){let U=this.gGa+this.Nfa;U=x.a.Nl(U,"qs",y.a.mf(n.AFrameworkApplication.Ii));U=x.a.Nl(U,"n",y.a.mf((new Date).getTime().toString()));U=x.a.Nl(U,"ov",y.a.mf(this.OXa.toString()));U=x.a.Nl(U,"fn",y.a.mf(this.DA));this.Mh&&
this.Mh.FileDownloadUrl&&(U=x.a.Nl(U,"furl",y.a.mf(this.Mh.FileDownloadUrl)));this.yh.Pm(U,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.UXi,"onUploadFinished"),Object(c.a)(this,this.TXi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(u.a)(C,"UploadToHostManager",null,[545]);var H=a(248),I=a(783);class M{constructor(){this.gb=null}get name(){return"Common.App.SaveAsToHost"}init(){n.AFrameworkApplication.fa.Dv(Object(c.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){n.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&
this.gb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Hg()}Wh(U){this.gb=U;this.gb.register(m,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Fc(()=>new m(n.AFrameworkApplication.fa,n.AFrameworkApplication.ub)).xc();this.gb.register(C,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Fc(()=>new C(n.AFrameworkApplication.ub,n.AFrameworkApplication.fa,n.AFrameworkApplication.Dd,()=>n.AFrameworkApplication.Ng,
()=>(new I.a).create(),U.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),n.AFrameworkApplication.sa,n.AFrameworkApplication.sa.iE)).xc();this.gb.register(r,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Fc(()=>new r(n.AFrameworkApplication.fa,n.AFrameworkApplication.ub,n.AFrameworkApplication.sa,n.AFrameworkApplication.sa.Pa,U.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),U.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).xc();
this.gb.register(A,"Common.App.SaveAsToHost.SaveAsToHostActor").Fc(()=>new A(n.AFrameworkApplication.fa,U.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),U.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).xc()}dispose(){}static main(){H.a.instance.Fi(new M)}}Object(u.a)(M,"SaveAsToHostPackage",null,[4,5]);a.d(E,"a",function(){return Q});const Q=()=>{Type.registerNamespace("Common.App.SaveAsToHost");M.main()}},1185:function(u,E,a){u=a(0);var c=a(84),b=a(15),e=a(146);class f{static get qg(){return e.a.gq(f.ol,
CommonUIStrings.l_SaveACopyFileName)}}f.ol="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(u.a)(f,"FileNameDialogHtml",null,[]);var d=a(4),h=a(30);class m extends e.a{constructor(G,C,H,I){super();this.bUb=
this.d9=null;this.La=G;this.MX=C;this.gnb=H;this.oc(1,CommonUIStrings.l_SaveButtonLabel);this.qg=f.qg;this.Fe="FileNameDialog-SaveACopy";this.Mh=I}sQ(G,C,H){this.bUb=G;this.d9=H;G={["txtFileName"]:h.a.Rq(d.AFrameworkApplication.sm.tn),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,C)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.G$b,"fileNameDialogHandler"),G);b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}G$b(G,C){1!==G?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(G=C.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),C=h.a.D4(d.AFrameworkApplication.fileName),G&&""!==G&&""!==C&&(G+=C),this.gnb.voa(this.bUb,this.d9,G,this.Mh))}}Object(u.a)(m,"FileNameDialog",e.a,[587]);class l{constructor(G,C,H){this.La=G;this.MX=C;this.gnb=H}create(G){return new m(this.La,
this.MX,this.gnb,G)}}Object(u.a)(l,"FileNameDialogFactory",null,[563]);var w=a(134),n=a(25);class y extends w.StandardDialog{constructor(G){super();this.Rb=1;this.oc(1,CommonUIStrings.l_RetryButtonLabel);this.oc(0,CommonUIStrings.l_DialogClose);this.La=G}displayError(G){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",G);this.fA(G,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(c.a)(this,this.ZNd,"retryDialogHandler"))}ZNd(G){1===G?(b.ULS.sendTraceTag(7165653,
216,50,"User click to retry the action."),this.La.processAction(n.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(u.a)(y,"RetryDialog",w.StandardDialog,[561]);w=a(1051);var t=a(834),r=a(374),v=a(105);class B extends w.a{constructor(G,C,H,I){super(G,C,H,I);this.Iyg=C}r8a(){return this.lb.qa("SaveACopyBrsIsEnabled")}MZe(){return n.a.saveACopy}G2b(){r.a.dKd(Object(c.a)(this,this.$Zf,"saveToCloudActionDispatcher"));r.a.N9c([new t.a(n.a.saveACopy,v.a.frame,0)],
this.Iyg.a5a())}jRf(){d.AFrameworkApplication.pya("CreateCopy_cf;CreateCopy_tf");b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(u.a)(B,"SaveACopyActor",w.a,[]);w=a(1054);class A extends w.a{constructor(G,C,H,I,M,Q,U){super(C,H,I,M,Q,U);this.eug=G}onSuccess(G){G&&G.data&&G.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.eug.create(this.Mh).sQ(G.data.folders[0].id,G.data.folders[0].name,G.data.folders[0].urls.viewInBrowser)):
(b.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.vj())}I6(G){G&&G.error&&"user_canceled"===G.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.I6(G)}vj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.vj()}}Object(u.a)(A,"SaveACopyManager",w.a,[]);var z=a(1052);class x extends z.a{constructor(G,C,H,I,M,Q){super(C,H,I,M,Q);this.La=G}esd(){return!!this.Mh&&!!this.Mh.SaveEntryPoint&&
"VersionHistory"===this.Mh.SaveEntryPoint.toString()}rS(){b.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.esd()&&this.La.ae(n.a.OMd,2,{["FailureReason"]:"Unknown"});super.rS()}WQa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.esd()&&this.La.processAction(n.a.fvc,2);super.WQa()}VQa(G){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",G);this.esd()&&this.La.processAction(n.a.fvc,2);super.VQa(G)}zQ(){this.Mh&&
"true"===this.Mh.SkipSaveToHost?super.zQ():32!==this.La.processAction(n.a.aSa,1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.zQ()):this.La.ae(n.a.aSa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");z.a.prototype.zQ.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.rS()}])}}Object(u.a)(x,"SaveACopyUploadToCloudManager",
z.a,[]);var D=a(248),J=a(559),L=a(783);class T{constructor(){this.gb=null}get name(){return"Common.App.SaveACopy"}init(){d.AFrameworkApplication.fa.Dv(Object(c.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){d.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.gb.resolve("Common.App.SaveACopy.SaveACopyActor").Hg()}dispose(){}Wh(G){this.gb=G;this.gb.register(x,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Fc(()=>new x(d.AFrameworkApplication.ub,G.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new L.a).create(),()=>new y(d.AFrameworkApplication.ub),d.AFrameworkApplication.sa,d.AFrameworkApplication.sa.iE)).xc();this.gb.register(l,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Fc(()=>new l(d.AFrameworkApplication.ub,d.AFrameworkApplication.sa.Pa,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).xc();this.gb.register(B,"Common.App.SaveACopy.SaveACopyActor").Fc(()=>new B(G.resolve("Common.App.SaveACopy.SaveACopyManager"),
G.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.iE)).xc();this.gb.register(A,"Common.App.SaveACopy.SaveACopyManager").Fc(()=>new A(G.resolve("Common.App.SaveACopy.FileNameDialogFactory"),G.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),J.a.instance,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.Z2a,()=>new y(d.AFrameworkApplication.ub))).xc()}static main(){D.a.instance.Fi(new T)}}
Object(u.a)(T,"PackageManager",null,[4,5]);a.d(E,"a",function(){return O});const O=()=>{Type.registerNamespace("Common.App.SaveACopy");T.main()}},1186:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(30),d=a(83),h=a(242),m=a(36);class l extends h.a{constructor(H,I,M){super(H,I);this.qFd=this.executionContext=null;this.s0i=(Q,U)=>{this.sHb(Q,U)};this.hK=M}initialize(H){super.initialize(H)}execute(H){this.executionContext=H;H=Object(d.a)(7,this.executionContext.Ge);this.Csb(H);return 1}fJ(H){super.fJ(H)}Csb(){this.subscribe(this.executionContext,
this.s0i,H=>{this.qFd.add_disposing(H)})}sHb(H){this.unsubscribe(I=>{H.remove_disposing(I)});this.executionContext.activityState[m.a.G2]=0}}Object(u.a)(l,"PasswordProtectedFileActivity",h.a,[]);var w=a(284),n=a(261),y=a(13);class t extends w.a{constructor(H){super(H);this.gqa=0;this.H9i=(I,M)=>{this.Qbb(I,M)};this.H1d=(I,M)=>{this.aVa(I,M)}}get pc(){return"PasswordDialog"}get xtb(){return this.gqa}get Pl(){return y.a.instance.ga(1976)}Qbb(H){this.gqa=H}J3(){const H={};H[w.a.description]=y.a.instance.ga(1977);
H[w.a.b7]=y.a.instance.ga(1973);H[w.a.yKf]=y.a.instance.ga(1995);H[w.a.wKf]=y.a.instance.ga(1996);H[w.a.xKf]=y.a.instance.ga(1974);H[w.a.Nmd]=y.a.instance.ga(1980);H[w.a.awe]=y.a.instance.ga(1661);H[w.a.i0j]=y.a.instance.Ua(25);H[w.a.bkg]=this.H1d;return H}Jta(){const H={};H[n.a.uu]=this.pc;H[w.a.R_a]=this.J3();return H}gg(){this.Rb=1;this.initializeAndShow(this.Pl,this.H9i,this.Jta())}}Object(u.a)(t,"PasswordProtectedFilePasswordInputDialog",w.a,[]);var r=a(60),v=a(29),B=a(282),A=a(51);class z extends t{constructor(H){super(H);
this.UNd=5;this.Ebe=!1;this.passwordToModify=null;this.zKf=()=>{this.$.isEditMode&&this.Iic&&(A.b().L9c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.Jl(this.zKf))};this.gg();this.$.ml(this.zKf)}get Iic(){return this.Ebe}get Pl(){return y.a.instance.ga(1978)}Qbb(H,I){super.Qbb(H,I);e.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${H}`)}aVa(H,I){this.passwordToModify=H;const M={};M.FileModifyPassword=
f.a.mf(H);r.M(this.$.pa.ya,M,this.ZXi(I),this.YXi(I),null,null)}J3(){const H=super.J3();H[w.a.Nmd]=y.a.instance.ga(1981);H[w.a.description]=y.a.instance.Ua(24);return H}gg(){A.b().L9c("PasswordToModifyDialogShown");e.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.gg()}ZXi(H){return I=>{v.a.dh(I.Errors,[-2019873242])&&this.T7b(this.ssb());if(!I||B.a(I))if(0<this.UNd)this.NPf(H);else{e.ULS.sendTraceTag(537154754,
0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${v.a.sc(I.Errors)}`);this.$.ea.Qo(I.Errors);this.hide();return}this.Ebe=I.Result;this.Iic&&(A.b().mWd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),e.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
H(this.Iic?0:1)}}YXi(H){return()=>{0<this.UNd?this.NPf(H):(e.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),H(3))}}NPf(H){--this.UNd;this.aVa(this.passwordToModify,H)}ssb(){return v.a.Zc(1,0,1660,1661,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(u.a)(z,"PasswordProtectedFileModifyPasswordInputDialog",t,[]);var x=a(6);class D extends l{constructor(H,I,M){super(H,I,M)}Csb(H){this.qFd=
new z(H);super.Csb(H)}sHb(H,I){const M=H.xtb,Q=H.Iic,U=H.passwordToModify;super.sHb(H,I);this.executionContext.Hya([2001366804]);switch(M){case 1:Q?(I=Object(d.a)(7,this.executionContext.Ge),this.executionContext.activityState[m.a.aoe]=f.a.mf(U),this.executionContext.activityState[m.a.jZa]=!0,H.passwordToModify="",this.ih(I.isEditMode?x.a.Ij:this.$J)):e.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Jp();break;case 0:this.executionContext.activityState[m.a.Zr]=!1;this.ih(this.hK);this.Jp();break;default:e.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${M}'`)}}}Object(u.a)(D,"PasswordProtectedFileModifyActivity",l,[]);class J extends b.a{constructor(H,I,M,Q){super();this.activityName=H;this.$J=I;this.hK=M;this.$=Q;this.Fb()}create(){this.ob(new D(this.activityName,this.$J,this.hK))}static ka(H){H.da.Ga(434,new J(x.a.rHb,
x.a.Sfb,x.a.urb,H))}}Object(u.a)(J,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var L=a(44);class T extends t{constructor(H,I){super(H);this.password=null;this.wmf=I;this.gg()}aVa(H,I){this.password=H;I(0)}J3(){const H=super.J3();this.wmf&&(H[w.a.frh]=1);return H}gg(){e.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.wmf}`);super.gg();L.a(this.$).kse()}}Object(u.a)(T,"PasswordProtectedFileOpenPasswordInputDialog",
t,[]);class O extends l{constructor(H,I,M){super(H,I,M)}Csb(H){const I=v.a.dh(this.executionContext.errors,[1217361942]);this.qFd=new T(H,I);H.Jgc||H.kLe();super.Csb(H)}sHb(H,I){let M,Q;M=H.password;H.password="";Q=H.xtb;super.sHb(H,I);this.executionContext.activityState[m.a.yVc]=f.a.mf(M);this.executionContext.activityState[m.a.jZa]=!0;this.executionContext.Hya([110414285,1217361942]);e.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${Q}`);
switch(Q){case 1:this.ih(this.$J);this.Jp();break;case 0:this.ih(this.hK),this.Jp()}}}Object(u.a)(O,"PasswordProtectedFileOpenActivity",l,[]);class G extends b.a{constructor(H,I,M,Q){super();this.activityName=H;this.$J=I;this.hK=M;this.$=Q;this.Fb()}create(){this.ob(new O(this.activityName,this.$J,this.hK))}static ka(H){H.da.Ga(386,new G(x.a.Zqc,x.a.Ij,x.a.Vj,H))}}Object(u.a)(G,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(E,"a",function(){return C});const C=()=>{c.a.Fa(G.ka);c.a.Fa(J.ka)}},
1193:function(u,E,a){u=a(0);var c=a(134);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose)}displayError(O){this.fA(O,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(u.a)(b,"ErrorDialog",c.StandardDialog,[561]);var e=a(1054),f=a(1051),d=a(15),h=a(84),m=a(4),l=a(252),w=a(40),n=a(25);class y extends c.StandardDialog{constructor(O,G,C){super();this.La=O;this.r2=G;this.MX=C;this.$v=!1;this.Rb=1;this.Q0(1);
this.oc(1,CommonUIStrings.l_SignIn);this.oc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}sQ(){this.r2.vZa(Object(h.a)(this,this.rHf,"onSignIn"));this.Zl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(h.a)(this,this.Hfi,"inputHandler"))}Hfi(O){0===O?(d.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.a7()}O0g(){let O="2";if(this.MX)switch(this.MX.Gj){case 3:O="0";break;case 2:O="3";break;case 1:O="1"}return O}hide(){this.r2.HJb(Object(h.a)(this,
this.rHf,"onSignIn"));super.hide()}a7(){var O=m.AFrameworkApplication.fa.qa("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";O=new l.QueryStringBuilder(O);O.Yi("prompt","1");O.Yi("cbcxt",this.O0g());m.AFrameworkApplication.mZa(O);w.a.lf(O.toString(),"LoginWindow",void 0,"SignInDialog")}rHf(){this.Hn&&this.hide();d.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(n.a.saveToCloudStorage,2)}}Object(u.a)(y,
"SignInDialog",c.StandardDialog,[580]);class t{constructor(O,G,C){this.La=O;this.r2=G;this.MX=C}create(){return new y(this.La,this.r2,this.MX)}}Object(u.a)(t,"SignInDialogFactory",null,[559]);var r=a(80),v=a(30);class B{constructor(O,G,C,H,I,M,Q){this.gGa=O;this.DA=G;this.EWa=C;this.bUb=H;this.LQc=I;this.Nfa=M;this.Mh=Q}execute(O,G){if(!m.AFrameworkApplication.Ng&&m.AFrameworkApplication.Dd){var C=this.gGa+this.Nfa;C=r.a.Nl(C,"fo",v.a.mf(this.bUb));C=r.a.Nl(C,"fn",v.a.mf(this.DA));C=r.a.Nl(C,"qs",
v.a.mf(this.LQc));C=r.a.Nl(C,"n",v.a.mf((new Date).getTime().toString()));this.Mh&&this.Mh.FileDownloadUrl&&(C=r.a.Nl(C,"furl",v.a.mf(this.Mh.FileDownloadUrl)));this.EWa&&(C=r.a.Nl(C,"fnn",v.a.mf(this.EWa)));m.AFrameworkApplication.Dd.Pm(C,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,O,G,null)}}}Object(u.a)(B,"SkyDriveUploadCaller",null,[579]);class A{constructor(O){this.lb=O;this.hGa=O.appSettings.SkyDriveUploadWebServiceBase;this.DA=O.appSettings.FileName;this.Nfa=O.Xa("SkyDriveUploadHandler")||
"skydriveuploadhandler.ashx"}create(O,G,C){return new B(this.hGa,this.DA,G,O,m.AFrameworkApplication.Ii,this.Nfa,C)}}Object(u.a)(A,"SkydriveUploadCallerFactory",null,[558]);var z=a(1052),x=a(248),D=a(559),J=a(783);class L{constructor(){this.gb=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.gb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Hg()}dispose(){}Wh(O){this.gb=O;this.gb.register(t,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Fc(()=>
new t(m.AFrameworkApplication.ub,D.a.instance,m.AFrameworkApplication.sa.Pa)).xc();this.gb.register(A,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Fc(()=>new A(m.AFrameworkApplication.fa)).xc();this.gb.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Fc(()=>new f.a(O.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),O.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
m.AFrameworkApplication.fa,m.AFrameworkApplication.sa.iE)).xc();this.gb.register(z.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Fc(()=>new z.a(O.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new J.a).create(),()=>new b,m.AFrameworkApplication.sa,m.AFrameworkApplication.sa.iE)).xc();this.gb.register(e.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Fc(()=>new e.a(O.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),D.a.instance,O.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
m.AFrameworkApplication.fa,m.AFrameworkApplication.Z2a,()=>new b)).xc()}static main(){x.a.instance.Fi(new L)}}Object(u.a)(L,"PackageManager",null,[4,5]);a.d(E,"a",function(){return T});const T=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");L.main()}},1194:function(u,E,a){u=a(0);var c=a(84),b=a(15),e=a(4),f=a(54),d=a(418),h=a(82);class m{constructor(z,x,D,J){this.BOc=null;this.kTb=J;this.gY=z;this.hY=x;this.oE=D;this.Uje=this.atf.BBj;z=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.Rxg=z[0];this.Qxg=z[1]}get atf(){return this.BOc||(this.BOc=h.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Kwa(){return CommonUIStrings.l_OICErrorHelpLink}get Syc(){return this.Uje}get ctf(){return this.Rxg}get btf(){return this.Qxg}get $sf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Uje?3:2}get zub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get P4b(){return!!this.hY}get Aub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get Pl(){return CommonUIStrings.l_DefaultDialogTitle}VId(z){this.oFb(z)}gvd(z){this.oFb(z)}oFb(z){let x=
10;this.hY&&1===z&&(this.hY(this.oE),x=1);this.gY&&this.gY(this.oE);this.lG(x)}nPa(){d.Redirect.showHelp("OICFailure");this.lG(2)}nBd(){this.atf.yof();this.lG(4)}lG(z){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.kTb,z);e.AFrameworkApplication.Zuc(f.a.kJf,this.kTb,z)}dispose(){this.oE=this.gY=this.hY=null}}Object(u.a)(m,"AOICErrorDialog",null,[2]);var l=a(45),w=a(134);class n extends m{constructor(z,x,D,J){super(z,x,D,J);this.$qa=this.nm=null;z=
document.createElement("span");z.id="errorMessageText";z.innerText=this.errorMessage;z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));this.nm=document.createElement("a");this.nm.href="#";this.nm.innerText=this.Kwa;z.appendChild(this.nm);l.a.addHandler(this.nm,"click",Object(c.a)(this,this.nPa,"oicErrorHelpLinkHandler"));x=new w.StandardDialog;x.Fe=this.id;this.Syc?(D=document.createElement("span"),J=document.createElement("span"),D.innerText=this.ctf,J.innerText=
this.btf,this.$qa=document.createElement("a"),this.$qa.href="#",this.$qa.innerText=this.$sf,z.appendChild(document.createElement("br")),z.appendChild(D),z.appendChild(this.$qa),z.appendChild(J),l.a.addHandler(this.$qa,"click",Object(c.a)(this,this.nBd,"oicErrorMacOfferLinkHandler"))):this.P4b&&(z.appendChild(document.createElement("br")),z.appendChild(document.createElement("br")),D=document.createElement("span"),D.innerText=this.zub,z.appendChild(D));this.P4b?(x.Rb=1,x.oc(1,this.Aub)):x.Rb=0;x.Zl(this.Pl,
null,this.icon,Object(c.a)(this,this.gvd,"legacyOICErrorDialogHandler"),z);x.eX("errorMessageText")}dispose(){this.nm&&(l.a.removeHandler(this.nm,"click",Object(c.a)(this,this.nPa,"oicErrorHelpLinkHandler")),this.nm=null);this.$qa&&(l.a.removeHandler(this.$qa,"click",Object(c.a)(this,this.nBd,"oicErrorMacOfferLinkHandler")),this.$qa=null);super.dispose()}}Object(u.a)(n,"OICErrorDialog",m,[]);class y{constructor(z,x,D){this.gY=x;this.hY=z;this.oE=D}get id(){return"OICErrorDialogWithDownload"}get HPe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Kwa(){return CommonUIStrings.l_OICErrorHelpLink}get zub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Aub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get Pl(){return CommonUIStrings.l_DefaultDialogTitle}VId(z){this.oFb(z)}gvd(z){this.oFb(z)}oFb(z){let x=
10;1===z&&(this.hY(this.oE),x=1);this.gY&&this.gY(this.oE);this.lG(x)}nPa(){d.Redirect.showHelp("OICFailure");this.lG(2)}lG(z){e.AFrameworkApplication.Zuc(f.a.lJf,3,z)}dispose(){this.oE=this.hY=this.gY=null}}Object(u.a)(y,"AOICErrorDialogWithDownload",null,[2]);class t extends y{constructor(z,x,D){super(z,x,D);this.nm=null;z=document.createElement("span");z.id="errorMessageText";z.innerText=this.HPe;z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));this.nm=document.createElement("a");
this.nm.href="#";this.nm.innerText=this.Kwa;z.appendChild(this.nm);l.a.addHandler(this.nm,"click",Object(c.a)(this,this.nPa,"oicErrorHelpLinkHandler"));z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.zub;z.appendChild(x);x=new w.StandardDialog;x.Fe=this.id;x.Rb=1;x.oc(1,this.Aub);x.Zl(this.Pl,null,this.icon,Object(c.a)(this,this.gvd,"legacyOICErrorDialogHandler"),z);x.eX("errorMessageText")}dispose(){this.nm&&
(l.a.removeHandler(this.nm,"click",Object(c.a)(this,this.nPa,"oicErrorHelpLinkHandler")),this.nm=null);super.dispose()}}Object(u.a)(t,"OICErrorDialogWithDownload",y,[]);var r=a(146);class v extends m{constructor(z,x,D,J){super(z,x,D,J);x={["errorMessage"]:this.errorMessage};x.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Kwa,["onExecute"]:L=>{this.nPa(L)}};this.Syc?(x.macOfficePreLinkText=this.ctf,x.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.$sf,
["onExecute"]:L=>{this.nBd(L)}},x.macOfficePostText=this.btf):this.P4b&&(x.errorFileDownloadOffer=this.zub);z=new r.a(!1,!1,!0);this.P4b?(z.Rb=1,z.oc(1,this.Aub)):z.Rb=0;z.Fe=this.id;x={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:x};z.initializeAndShow(this.Pl,Object(c.a)(this,this.VId,"reactOICErrorDialogHandler"),x)}}Object(u.a)(v,"ReactOICErrorDialog",m,[]);class B extends y{constructor(z,x,D){super(z,x,D);x={["errorMessage"]:this.HPe,["errorFileDownloadOffer"]:this.zub};x.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Kwa,["onExecute"]:J=>{this.nPa(J)}};z=new r.a(!1,!1,!0);z.Rb=1;z.oc(1,this.Aub);z.Fe=this.id;x={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:x};z.initializeAndShow(this.Pl,Object(c.a)(this,this.VId,"reactOICErrorDialogHandler"),x)}}Object(u.a)(B,"ReactOICErrorDialogWithDownload",y,[]);a.d(E,"a",function(){return A});class A{constructor(){this.ekb=!!e.AFrameworkApplication.sa&&e.AFrameworkApplication.sa.Pa.Hv}vch(z,x,D){this.ekb?
new v(z,x,null,D):new n(z,x,null,D)}wch(z,x,D){this.ekb?new B(z,x,D):new t(z,x,D)}xch(z,x,D,J,L){const {ReactOICErrorDialogWithTrial:T}=a(1338),{OICErrorDialogWithTrial:O}=a(1339);this.ekb?new T(z,x,D,null,J,L):new O(z,x,D,null,J,L)}static get instance(){return A.Ma||(A.Ma=new A)}}A.Ma=null;Object(u.a)(A,"OICErrorDialogFactory",null,[249])},1212:function(u,E,a){var c=a(9);u=a(0);var b=a(692),e=a(21),f=a(42),d=a(1),h=a(15),m=a(30),l;(function(J){J[J.url=0]="url";J[J.ref=1]="ref";J[J.mailto=2]="mailto"})(l||
(l={}));Object(u.b)("HyperlinkSelectionState",l);var w=a(770),n=a(8),y=a(584),t=a(60),r=a(89),v=a(13);class B extends w.a{constructor(J,L,T){super(J);this.Enb=0;this.qAb=!1;this.v2a=null;this.xLe=!1;this.fsb=!0;this.Pl=this.hVc=null;this.$zd=0;this.Zzd=this.aAd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.Cai=(O,G)=>{1===O||2===O?(h.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===O?"OK":"Remove"} pressed`),this.aAd=G[B.Awi],this.$zd=G[B.nqj],this.Zzd=G[B.Clh],2===O&&(this.removeHyperLink=
!0),this.commit()):h.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.R_j=(O,G)=>0!==G&&O.length?1===G?this.A1e(f.y(O,this.ea.xa)||this.kGi(O),760):this.A1e(m.a.Kpd(O),762):null;this.selectedRange=L;this.qM=T;this.ea=J.ea;this.sheetName=L.SheetName;this.zMa();this.uq();this.Rb=this.qAb?9:1;this.oc(1,v.a.instance.ga(4));this.qAb&&this.oc(2,v.a.instance.ga(763));this.initializeAndShow(this.Pl,this.Cai,{[B.uu]:this.pc,[B.S_j]:this.R_j,[B.YTg]:{[B.Lkh]:this.xLe,[B.Dlh]:this.v2a,[B.YEg]:this.Enb,
[B.ZEg]:this.hVc,[B.P8g]:this.fsb}})}get pc(){return"HyperLinkDialog"}p3e(J,L){switch(L){case 2:return J.startsWith("mailto:")?J:"mailto:"+J;case 1:return`${n.a.dMf}${this.HVh(J)}`;default:return J}}get cC(){return 526}nH(){const J=this.$;this.location=this.p3e(this.aAd,this.$zd);try{this.location=r.a.dg(this.location)}catch(O){h.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}h.ULS.sendTraceTag(555755667,0,50,`Committing ${l[this.$zd]} link`);this.cellValue=this.Zzd.length?this.Zzd:
this.aAd;J.My();const L=J.pa.ya.Wb(),T=f.s(this.selectedRange);return(O,G,C)=>t.b(J.pa.ya,T,this.cellValue,this.location,this.removeHyperLink,!1,123,O,G,C,this.qM.range,L)}jk(){const J=f.s(this.selectedRange);return()=>new y.a(J,this.cellValue,this.location)}ICh(){let J=this.qM.cell.h6a;this.qM.cell.Cwa?J&&J.startsWith("mailto:")?(this.Enb=2,J=J.substr(7)):this.Enb=0:this.Enb=1;return J}zMa(){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.qAb=this.qM.nba:this.qAb=!!this.qM.fLa(64)||
!!this.qM.fLa(128)}uq(){if(this.qAb){this.v2a=this.qM.text;const J=this.ICh();J&&(this.hVc=J);this.Pl=v.a.instance.ga(827);this.fsb=this.hVc===this.v2a}else this.qM.text?(this.v2a=this.qM.text,this.fsb=!1):(this.v2a="",this.fsb=!0),this.Enb=0,this.Pl=v.a.instance.ga(826);this.qM.qB&&(this.fsb=!1,this.xLe=!0,d.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.v2a=this.qM.formulaBarText))}kGi(J){return this.ea.Cb.Rk(J)}A1e(J,L){return J?null:v.a.instance.ga(L)}HVh(J){let L,
T;({sheetName:L,range:T}=f.Z(J,this.ea.xa)).returnValue&&T&&(J=f.x(T,L||this.sheetName,!1));return J}}B.S_j="validateLinkValues";B.YTg="bodyProps";B.Lkh="disableDisplayText";B.Dlh="displayTextValue";B.YEg="activeLinkOption";B.ZEg="activeLinkValue";B.P8g="copyLinkValueToDisplay";B.Awi="linkValue";B.nqj="selectedLink";B.Clh="displayText";Object(u.a)(B,"HyperlinkDialog",w.a,[]);var A=a(55);class z{constructor(J,L){this.$=J;this.gridView=L}nc(){return!1}wc(J,L){return 1===J&&-1583422759===L.command}Kc(){return!1}executeCommand(){this.IEj();
return A.Task.Ta(!0)}IEj(){const J=f.v(this.gridView.ha.ra.$c,this.$),L=e.f(this.gridView);(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Yp([this.gridView.ha.ra.$c],!0))&&L&&new B(this.$,J,L)}}Object(u.a)(z,"ShowHyperlinkCommandHandler",null,[223]);class x extends b.a{constructor(J){super(J)}ld(){this.Yc([new z(this.$,e.h(this.$))])}static ka(J){b.a.Nd(105,new x(J))}}Object(u.a)(x,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(E,
"a",function(){return D});const D=()=>{c.a.Fa(x.ka)}},1213:function(u,E,a){var c=a(9);u=a(0);var b=a(4),e=a(105),f=a(692),d=a(60),h=a(50),m=a(37),l=a(15),w=a(183),n=a(25),y=a(55);class t{constructor(x,D){this.$=x;this.Uh=D}nc(){return!1}executeCommand(x,D,J){x=2;switch(D.command){case -309686558:x=this.Uh.ae(n.a.saveACopy,2,J);break;case 617689800:x=this.Uh.ae(n.a.saveToCloudStorage,2,J);break;case -1244760097:x=this.Uh.ae(n.a.saveToSharePoint,2,J)}return 2===x&&D?w.a(D.command):y.Task.Ta(!0)}wc(x,
D){x=!1;switch(D.command){case -1244760097:case -309686558:case 617689800:x=!0,l.ULS.shipAssertTag(537153984,0,this.$.$ka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return x}Kc(){return!1}}Object(u.a)(t,"SaveToHostCommandHandler",null,[223]);class r extends f.a{constructor(x){super(x);this.sHh=(D,J,L,T,O)=>1===L?32:D===n.a.aSa&&2===L?(D=this.$.pa.ya.Wb(),d.C(this.$.pa.ya,O[0],O[1],null,null,D),32):8}ld(){m.TaskExtensions.Aa(h.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.Ya),()=>{this.Yc([new t(this.$,b.AFrameworkApplication.ub)])},this.la,3);b.AFrameworkApplication.ub.Nb(n.a.aSa,e.a.frame,this.sHh)}static ka(x){f.a.Nd(267,new r(x))}}Object(u.a)(r,"SaveToHostCommandHandlerFactory",f.a,[]);var v=a(222);class B{constructor(x,D){this.$=x;this.Uh=D;this.$.da.Ga(393,this)}nc(x){switch(x){case -309686558:return 8===this.Uh.processAction(n.a.saveACopy,1,null);case 617689800:return 8===this.Uh.ae(n.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.Uh.ae(n.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(u.a)(B,"SaveToHostManager",null,[359,2]);class A extends v.a{constructor(x){super();this.$=x;this.Fb()}create(){this.ob(this.$.da.za(393)||new B(this.$,b.AFrameworkApplication.ub))}static ka(x){x.da.Ga(394,new A(x))}}Object(u.a)(A,"SaveToHostManagerFactory",v.a,[]);a.d(E,"a",function(){return z});const z=()=>{c.a.Fa(r.ka);c.a.Fa(A.ka)}},1214:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(83),d=a(114),h=a(29),
m=a(36);class l extends d.a{constructor(G,C){super(G,C)}execute(G){const C=Object(f.a)(7,G.Ge);e.ULS.shipAssertTag(537153921,0,h.a.epb(G.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");C.CI(!0,!0);G.activityState[m.a.NZb]=C.ea.sessionId;G.activityState[m.a.Inb]=!0;G.activityState[m.a.TZb]=!0;e.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(u.a)(l,"SessionReloadActivity",d.a,
[]);var w=a(6);class n extends b.a{constructor(){super();this.Fb()}create(){this.ob(new l(w.a.Ddb,w.a.pz))}static ka(G){G.da.Ga(142,new n)}}Object(u.a)(n,"SessionReloadActivityFactory",b.a,[]);var y=a(58),t=a(265),r=a(109),v=a(47),B=a(46),A=a(35),z=a(1),x=a(39),D=a(246),J=a(115);class L extends d.a{constructor(G,C,H,I,M){super(G,C);L.Bxd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];L.Axd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
L.Vsf=[-1468309555,611268539,-1750576502,61029505];L.Usf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.Fzc=H;this.vGj=I;this.BPj=M}execute(G){var C=Object(f.a)(7,G.Ge);G.activityState[m.a.dsa]=!0;var H=L.Q0h(G);if(L.rAj(G,H))return L.VCi(G),H=50,0<G.errors.length&&(H=15),e.ULS.sendTraceTag(537153891,0,H,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.sc(G.errors)}`),G.activityState[m.a.dsa]=!1,this.ih(w.a.idle),
3;switch(H){case 1:case 3:this.Bfi(G,H);break;case 2:this.Afi(G);break;case 0:G.activityState[m.a.kZa]=null}e.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${H}. activityName:${this.activityName}. NextActivityName:${this.$_}. TimeFromLastStatefulResponse:${C.ea.j1}.`);var I=A.a.xg(G.activityState,J.a.Vfb);e.ULS.shipAssertTag(40502925,0,!I||I&&(1===H||3===H),`triggerSilentReloadAfterTokenRefresh: ${I}, silentReloadType: ${H}`);C=C.hl.reloadCount;return 0!==H&&
0<C?(I=t.a.kwa(C,200),e.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${H}] retryNum [${C}] delayInMs [${I}] activityName [${this.activityName}]`),v.a.instance.create(()=>{L.MM(G)},I,B.a.wsj),1):3}Bfi(G,C){e.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const H=Object(f.a)(7,G.Ge);G.activityState[m.a.Inb]=!0;H.Jgc||x.PageLoadTrackingInfo.instance.xj("ReopenOnLoad");!L.isEditMode(G)&&h.a.epb(G.errors)&&
(e.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),G.activityState[m.a.NZb]=H.ea.sessionId,G.activityState[m.a.TZb]=!0);G.Uxd();3===C?(H.ea.Nf()||H.ea.rIi(),H.CI(!0,!0),this.ih(this.BPj),G.activityState[m.a.Rne]=H.workbookContext.CalcMode):(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===C&&H.CI(!0,!0),G.activityState[m.a.qVc]=!1,this.ih(this.Fzc))}Afi(G){e.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");G.activityState[m.a.kZa]=null;G.Uxd();this.ih(this.vGj);G=Object(f.a)(7,G.Ge);G.Jgc||(x.PageLoadTrackingInfo.instance.xj("RefreshOnLoad"),G.lKb())}static MM(G){G.MM()}static Q0h(G){const C=Object(f.a)(7,G.Ge),H=C.ea,I=L.isEditMode(G);var M=h.a.dh(G.errors,I?L.Axd:L.Bxd);const Q=h.a.dh(G.errors,I?L.Usf:L.Vsf),U=C.wN,N=C.hl.reloadCount,W=C.va.MaxConsecutiveSilentReloadAllowed,X=C.hl.R$e(),sa=h.a.sc(G.errors),da=h.a.sc(G.bAa),
S=0<h.a.aN(ya=>!ya.triggerSilentReopenOnly,G.errors).length;let oa=M;const K=A.a.xg(G.activityState,J.a.Vfb);K&&(oa=!0);const ea={name:"SessionReloadSilentActivity.GetSilentReloadType"};ea.editMode=I;ea.isSilentReopenError=M;ea.isSilentRefreshError=Q;ea.reloadSequenceCount=C.hl.dRa;ea.reloadCount=N;ea.maxReloads=W;ea.stopSilentReloads=X;ea.errorNames=sa;ea.processedErrorNames=da;ea.isClientDirty=U;ea.errorsForSilentReopenOnly=S;ea.triggerSilentReloadAfterTokenRefresh=K;ea.IsReopenDisabled=C.yNa;M=
y.a.hc(ea);e.ULS.sendTraceTag(21837004,0,50,M);if(!X){if(oa&&(I?L.iAj(G):L.kAj(G)))return D.a.R5f(G,C)?3:C.yNa?2:1;if(Q&&(I||!H.Tbb))return 2}return 0}static rAj(G,C){for(const H of G.errors)if(-1337545025===H.MessageId||-238814601===H.MessageId)return!1;return h.a.aN(H=>!H.triggerSilentReopenOnly,G.errors).length?3!==C:!1}static VCi(G){const C=h.a.aN(H=>!H.triggerSilentReopenOnly,G.errors);for(const H of C)G.wca(H)}static isEditMode(G){const C=Object(f.a)(7,G.Ge);return C.ea.Zb?C.Ot&&!!(C.qd&64):
A.a.xg(G.activityState,m.a.Zr)}static kAj(G){const C=Object(f.a)(7,G.Ge),H=h.a.q4(G.errors,L.Bxd);if(r.b(H,I=>I.ForceVersionUpgrade))return!1;G=h.a.epb(G.errors);return!C.ea.Tbb||G?!0:!1}static iAj(G){G=h.a.q4(G.errors,L.Axd);return!r.b(G,C=>C.ForceVersionUpgrade)}}L.Bxd=null;L.Axd=null;L.Vsf=null;L.Usf=null;Object(u.a)(L,"SessionReloadSilentActivity",d.a,[]);class T extends b.a{constructor(G,C){super();this.activityName=G;this.$J=C;this.Fb()}create(){this.ob(new L(this.activityName,this.$J,w.a.pz,
w.a.ij,w.a.pPb))}static ka(G){G.da.Ga(143,new T(w.a.Tna,w.a.C1b));G.da.Ga(144,new T(w.a.nxc,w.a.VPa));G.da.Ga(145,new T(w.a.oxc,w.a.uEd));G.da.Ga(154,new T(w.a.Edb,w.a.gP))}}Object(u.a)(T,"SessionReloadSilentActivityFactory",b.a,[]);a.d(E,"a",function(){return O});const O=()=>{c.a.Fa(G=>{n.ka(G);T.ka(G)})}},1226:function(u,E,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(83),d=a(242),h=a(319),m=a(29),l=a(13),w=a(380),n=a(89);class y extends w.a{constructor(z,x){super(z,x);this.gqa=0;this.Qr()}get pc(){return"SharedWorkbookDialog"}get xtb(){return this.gqa}OO(z,
x){this.gqa=z;super.OO(z,x)}Qr(){super.Qr();this.Rb=9;const z=this.zVh();this.oc(1,l.a.instance.ga(1659));this.oc(2,l.a.instance.ga(991));this.Zl(l.a.instance.ga(702),n.a.dg(z),this.icon,this.Y7)}zVh(){return String.format(l.a.instance.ga(703))}}Object(u.a)(y,"LegacySharedWorkbookDialog",w.a,[]);var t=a(6),r=a(36);class v extends d.a{constructor(z,x,D){super(z,x);this.executionContext=null;this.iwi=J=>{const L=this.Zs.hd,T=Object(f.a)(7,L.Ge);let O;O=J.xtb;this.unsubscribe(G=>{J.remove_disposing(G)});
for(let G=0,C=L.errors.length;G<C;G++)-573864504===L.errors[G].MessageId&&L.wca(L.errors[G]);switch(O){case 1:T.ea.uCc=!0;e.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.ih(T.isEditMode?t.a.pPb:this.Phh);this.Jp();break;case 2:this.ih(t.a.openInExcelClient);this.Jp();break;case 0:L.activityState[r.a.Zr]=!1,this.ih(this.hK),this.Jp()}};this.Phh=x;this.hK=D}initialize(z){super.initialize(z)}execute(z){this.executionContext=
z;this.X4c();return 1}fJ(z){super.fJ(z)}X4c(){const z=Object(f.a)(7,this.executionContext.Ge),x=m.a.b0a([-573864504]);x[0].HelpDescription=l.a.instance.ga(705);x[0].HelpTopicId=h.a.jwi;const D=new y(z,x[0]);this.subscribe(this.executionContext,this.iwi,J=>{D.add_disposing(J)})}}Object(u.a)(v,"LegacySharedWorkbookActivity",d.a,[]);class B extends b.a{constructor(z,x,D,J){super();this.activityName=z;this.$J=x;this.hK=D;this.$=J;this.Fb()}create(){this.ob(new v(this.activityName,this.$J,this.hK))}static ka(z){z.da.Ga(460,
new B(t.a.$Cb,t.a.Sfb,z.VBb?t.a.Vj:t.a.urb,z))}}Object(u.a)(B,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(E,"a",function(){return A});const A=()=>{c.a.Fa(B.ka)}},1249:function(u,E,a){var c=a(9);u=a(0);var b=a(222);class e{constructor(){}dispose(){}}Object(u.a)(e,"GridInstantaneousAction",null,[628]);var f=a(695);class d extends b.a{constructor(m){super();this.$=m;this.Fb()}create(){this.ob(Object(f.a)(this.$.da,528,()=>new e))}static ka(m){m.da.Ga(529,new d(m))}}Object(u.a)(d,"GridInstantaneousActionFactory",
b.a,[]);a.d(E,"a",function(){return h});const h=()=>{c.a.Fa(m=>{d.ka(m)})}},1250:function(u,E,a){u=a(0);var c=a(1289),b=a(1290),e=a(4);class f{constructor(){this.b8d=this.gb=null}get name(){return"Common.App.DirectPrint"}Wh(m){this.gb=m;m.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").xc().Fc(()=>new c.a(e.AFrameworkApplication.sa.qX));m.register(624,"Common.App.DirectPrint.IDirectPrintManager").xc().Fc(()=>b.a.create(this.gb))}init(){this.b8d=this.gb.resolve("Common.App.DirectPrint.IDirectPrintManager");
this.b8d.start()}dispose(){}}Object(u.a)(f,"PackageManager",null,[4,5]);var d=a(248);a.d(E,"a",function(){return h});const h=()=>{Type.registerNamespace("Common.App.DirectPrint");d.a.instance.Fi(new f)}},1263:function(u,E,a){u=a(0);var c=a(15),b=a(4),e=a(87),f=a(27),d=a(38),h=a(78),m;(function(I){I[I.unableToRefreshLock=0]="unableToRefreshLock";I[I.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";I[I.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";I[I.workbookTooLarge=3]="workbookTooLarge";
I[I.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";I[I.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";I[I.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";I[I.unsupportedFeatures=7]="unsupportedFeatures";I[I.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";I[I.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";I[I.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";I[I.lastGenericStatusError=
11]="lastGenericStatusError";I[I.scratchPadWarning=12]="scratchPadWarning";I[I.authenticationLost=13]="authenticationLost";I[I.odfCompatibilityIssues=14]="odfCompatibilityIssues";I[I.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";I[I.workbookIsIrmProtected=16]="workbookIsIrmProtected";I[I.biFeatureNotAvailable=17]="biFeatureNotAvailable";I[I.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";I[I.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";
I[I.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";I[I.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";I[I.editAttemptInReadOnly=22]="editAttemptInReadOnly";I[I.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";I[I.unsupportedBrowser=24]="unsupportedBrowser";I[I.readOnlyPermissions=25]="readOnlyPermissions";I[I.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";I[I.policyWarningMessage=27]="policyWarningMessage";
I[I.workingOnIt=28]="workingOnIt";I[I.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";I[I.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";I[I.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";I[I.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";I[I.legacyConnectionsBB=33]="legacyConnectionsBB";I[I.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";I[I.groupedSlicersBB=35]="groupedSlicersBB";
I[I.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";I[I.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";I[I.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";I[I.wacGdprNotice=39]="wacGdprNotice";I[I.automaticSensitivityLabel=40]="automaticSensitivityLabel";I[I.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";I[I.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";I[I.localStorageDisabled=43]="localStorageDisabled";I[I.autoRefreshDisabled=
44]="autoRefreshDisabled";I[I.corruptedFileRepaired=45]="corruptedFileRepaired";I[I.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";I[I.minorVersionLimitReached=47]="minorVersionLimitReached";I[I.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";I[I.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";I[I.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";I[I.sensitivityApplicationLabelDisabledError=
51]="sensitivityApplicationLabelDisabledError";I[I.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";I[I.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";I[I.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";I[I.promptEnableExternalLinks=55]="promptEnableExternalLinks";I[I.networkDown=56]="networkDown";I[I.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";I[I.refreshLinkedEntityErrorBar=
58]="refreshLinkedEntityErrorBar";I[I.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";I[I.canvasHealth=60]="canvasHealth";I[I.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";I[I.optimizeWorkbook=62]="optimizeWorkbook";I[I.novModePostDepreciation=63]="novModePostDepreciation";I[I.officeScriptsRunning=64]="officeScriptsRunning";I[I.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";I[I.readOnlyPivotTable=
66]="readOnlyPivotTable";I[I.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";I[I.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";I[I.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";I[I.count=70]="count"})(m||(m={}));Object(u.b)("EwaBusinessBarEntryType",m);var l=a(5),w=a(1057);class n extends Sys.EventArgs{constructor(I,M,Q=null){super();this.f0a=I;this.k8c=M;this.data=Q}}Object(u.a)(n,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,
[]);var y=a(1059),t=a(1058),r=a(1061),v=a(1060),B=a(1055),A=a(476),z=a(50),x=a(37),D=a(644),J=a(29),L=a(1),T=a(21),O=a(57),G=a(69),C=a(835);a.d(E,"a",function(){return H});class H extends h.a{constructor(I,M){super();this.Ra=new d.a;this.XP=null;this.uJc=[];this.eoc=()=>{this.$.pa.QMa?this.removeEntry(13):this.ng(13,null)};this.gh=(Q,U)=>{for(let N=0,W=H.Jdc().length;N<W;N++)Q=H.Jdc()[N],this.removeEntry(Q);U.context&&0<U.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
this.removeEntry(21));this.Cij()};this.zm=(Q,U)=>{var N;Q=this.rEh(U.errors);let W=[];for(let sa=0,da=Q.length;sa<da;++sa){const S=Q[sa];if(1===S.Type&&S.Appearance&32)W=this.$7h(S,W);else if(U.gsj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var X=(null===(N=U.context)||void 0===N?0:N.stopwatch)?U.context.stopwatch.zc:-1;5E3>X?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${X}ms).`):
b.AFrameworkApplication.iri()||this.PIg(S,U.context.methodName)}X=[...H.Jdc()];for(let oa=0,K=W.length;oa<K;++oa){const ea=W[oa];this.ng(ea,S);Array.remove(X,ea)}for(let oa=0,K=X.length;oa<K;++oa)this.removeEntry(X[oa])}};this.Tc=(Q,U)=>{this.Bc(Q,U)};this.Bc=()=>{const Q=this.$.ea;Q.Zb||Q.Nf()||(this.EKd(),this.uJc.length=0)};this.dd=(Q,U)=>{this.$.ea.Nf()&&!U.KV||this.cdf(U.KV)};this.MGb=()=>{const Q=this.$.userOperationManager.vdc();Q&&Q.operation.flags&1&&this.K7f()};this.rCf=()=>{this.K7f()};
this.zf=()=>{this.iBe();this.T7f()};this.aO=()=>{if(this.$.J5&&this.$.ea.Nf()&&this.$.ea.Zb)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const Q=this.$.da.za(331);Q&&Q.dKa||this.removeEntry(55);this.removeEntry(5)}};this.$=I;this.ZZa=M;this.gRg();b.AFrameworkApplication.Dd&&b.AFrameworkApplication.Dd.WVc(this);this.gZa=Array(70);
for(let Q=0;70>Q;Q++)this.gZa[Q]=null;this.Oh=D.EcmaDateClock.instance;this.tnf=this.Oh.zb.getTime();M&&(M=I.pa,M.iw(this.zm),M.Mq(this.gh),M.gob(this.eoc),M.vZa(this.eoc),I.ea.Uj(this.Tc),I.ea.ku(this.zf),I.ml(this.dd),I.ik(this.Bc),I.ea.DY(this.aO),I.userOperationManager.ur(this.MGb),L.EwaSettings.ma(167)&&I.ea.Wg.get(45)&&b.AFrameworkApplication.fa.qa("SupportsPolicies")||this.J9e(),this.cdf(O.c(I)));I.da.Ga(5,this)}J9e(){J.a.Nq(this.$.ea.cG)&&this.zm(this,new A.a(this.$.ea.cG,null,!1,-1,-1,-1,
-1,"",-1,"",-1))}rJg(I){this.Ra.addHandler("bBarAttachedOrDetached",I)}get r9c(){return this.uJc}get domElement(){return this.XP?this.XP.domElement:null}dispose(){if(this.$){const I=this.$,M=I.pa;M.hx(this.zm);M.Lr(this.gh);M.fuc(this.eoc);M.HJb(this.eoc);I.ea.uk(this.Tc);I.ea.Mv(this.zf);I.Jl(this.dd);I.Il(this.Bc);I.ea.w0(this.aO);I.userOperationManager.ko(this.MGb);T.h(I).Vb.Hk(this.rCf)}e.a.Ia(this.XP);this.$=this.XP=null;super.dispose()}eji(I){switch(I){case 4:case 5:case 11:case 55:case 7:case 37:case 38:return!0;
case 59:return L.EwaSettings.ma(644);default:return!1}}ng(I,M,Q=null,U=null,N=null){if(!this.$.isMobileMode||this.eji(I))this.ZZa&&!this.$E(I)&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170254,0,50,`Adding entry to BB: ${Enum.toString(m,I)}`),this.gZa[I]=this.Oh.Yea,this.XP.zC(I,M,U,N),this.Ra.raiseEvent("bBarAttachedOrDetached",new n(I,!0,Q))),M&&32===M.Appearance&&G.a(this.$).hd.wca(M)}xEj(I,M,Q,U){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");
B.a.initialize(I,M,Q,U);this.ng(39,null)}xDj(I,M,Q,U){w.a.initialize(I,M,Q,U);this.ng(40,null)}FFj(I,M,Q,U){t.a.initialize(I,M,Q,U);this.ng(41,null)}WEj(I,M,Q,U){y.a.initialize(I,M,Q,U);this.ng(42,null)}OFj(I,M,Q,U){v.a.initialize(I,M,Q,U);this.ng(53,null)}NFj(I,M,Q,U){r.a.initialize(I,M,Q,U);this.ng(54,null)}removeEntry(I){this.ZZa&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(m,I)}`),this.gZa[I]=
null,this.XP.removeEntry(I)&&this.Ra.raiseEvent("bBarAttachedOrDetached",new n(I,!1)))}cla(I){return this.ZZa?this.XP.cla(I):!1}$E(I){return this.ZZa?this.XP.$E(I):!1}LEb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}inc(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}gRg(){const {BusinessBarControl:I}=a(1150);if(this.ZZa&&
!this.XP){T.h(this.$).Vb.Yk(this.rCf);var M=document.getElementById(this.$.Eb+l.a.nye);this.XP=new I(this.$,M)}}EKd(){this.ZZa&&this.XP.EKd()}Cij(){if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const M=this.Oh.Yea;if(3E5<=M-this.tnf){this.tnf=M;for(let Q=0;70>Q;Q++){var I=this.gZa[Q];if(I&&(I=M-I,3E5<=I)){const U=Enum.toString(m,Q);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${U}] was activated but not turned off for ${I} Millis`)}}}}}rEh(I){const M=
[];for(const Q of I)switch(Q.MessageId){case -113742550:const U=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||J.a.dh(I,U))&&M.push(-113742550)}return J.a.PB(I,M)}$7h(I,M){switch(I.MessageId){case 2113407564:const Q=J.a.b0a([1821390342,-943219229,-502303485,1437034227]);for(let U=0;U<Q.length;U++)Q[U].HelpTopicId=I.HelpTopicId,Q[U].HelpDescription=I.HelpDescription,this.uJc.push(Q[U])}switch(I.MessageId){case -395951567:this.ng(6,
I);break;case 1643490758:this.ng(4,I);break;case -907264831:this.ng(5,I);break;case 757111532:case 2113407564:this.ng(7,I);break;case 2010656511:this.ng(15,I);break;case 1321660996:this.$.Q6c=!0;this.ng(8,I);break;case 526339737:this.$.Q6c=!0;this.ng(9,I);break;case -407088521:this.ng(10,I);break;case 1756116017:this.ng(14,I);break;case -1703455218:this.ng(17,I);break;case 1393475740:this.ng(25,I);break;case -949523941:this.ng(26,I);break;case 1779381952:this.ng(44,I);break;case 1421575100:this.ng(45,
I);break;case 613676060:this.ng(46,I);break;case 1233668252:this.ng(61,I);break;case 1911608588:I=!!(this.$.qd&64);!this.$.ea.Nf()&&I&&M.push(29);break;case 1544494907:break;case -655555355:M.push(this.Ysd()?1:0);break;case -1221382671:M.push(2);break;case 1662282929:M.push(3);break;case 104919273:this.$.ea.Nf()||M.push(30);break;case -689453604:I=!!(this.$.qd&64);this.$.ea.U$e=!0;!this.$.ea.Nf()&&I&&M.push(31);break;case 157762400:this.$.ea.jic=!0;!this.$.ea.Nf()&&this.$.qd&64&&!this.$.isEditMode&&
M.push(32);break;case -1125398042:L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.Nf()&&this.$.qd&64&&!this.$.isEditMode&&M.push(34);break;case -73730134:!this.$.ea.Nf()&&this.$.qd&64&&M.push(33);break;case -293349236:M.push(65);break;case 1580811823:M.push(67);break;case -37299333:break;case 136737622:M.push(47);break;case -1780327030:this.ng(55,I);break;case -113742550:this.ng(57,I);break;case -260312420:this.$.ea.Nf()||M.push(66);break;
default:this.ng(11,I)}return M}ldi(){if(b.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!C.a.Nqd(C.a.Aed(1))&&(f.a.Ap||f.a.Yg)){const I=z.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);x.TaskExtensions.Aa(I,()=>{this.ng(20,null)},this.la,3)}}Eci(I){I||3!==this.$.workbookContext.WorkbookNovType||this.ng(63,null)}cdf(I){(!I&&!this.$.printingEnabled||this.$.ie.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),
this.ng(16,null));this.ldi();this.iBe();this.T7f();this.Eci(I)}iBe(){this.$.workbookContext.Options&32768&&this.mEj()}mEj(){this.gZa[37]||this.ng(37,null)}pGj(){this.gZa[38]||this.ng(38,null)}T7f(){L.EwaSettings.ma(644)&&this.$.workbookContext.Options&524288&&this.ng(59,null)}p8f(I,M){this.ng(58,I,null,M)}cWc(I,M=null){this.XP.$E(I)?this.XP.XPb(I,M):this.ng(I,null,null,null,M)}K7f(){this.$.qd&8&&this.ng(12,null)}Ysd(){const I=this.$.da.za(38);return I?I.tokenExpired:!1}PIg(I,M){if(!this.$E(21)&&-1387426400!==
I.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const Q={};Q.FailedMethod=M;this.ng(21,I,Q)}}static Jdc(){return H.xse||(H.xse=[0,1,2,3])}Eed(I){return this.XP.Eed(I)}}H.xse=null;Object(u.a)(H,"BusinessBarManager",h.a,[853,2,86])},1276:function(u,E,a){u=a(0);var c=a(222),b=a(1263);class e extends c.a{constructor(h){super();this.$=h;this.Fb()}create(){this.ob(this.$.da.za(5)||new b.a(this.$,!this.$.vba))}static ka(h){h.da.Ga(4,
new e(h))}}Object(u.a)(e,"BusinessBarManagerFactory",c.a,[]);var f=a(9);a.d(E,"a",function(){return d});const d=()=>{f.a.Fa(e.ka)}},1288:function(u,E,a){u=a(0);var c=a(15),b=a(84),e=a(848),f=a(835),d=a(1205);class h{constructor(){this.vGc=new d.a;this.tGc=new d.a;this.sGc=new d.a;this.$Ug(this.vGc);this.ZUg(this.tGc);this.YUg(this.sGc);this.zLc=new d.a;this.yLc=new d.a;this.xLc=new d.a;this.xXg(this.zLc);this.wXg(this.yLc);this.vXg(this.xLc);this.MHc=new d.a;this.sVg(this.MHc);this.vGa(this.MHc);
this.vGa(this.sGc);this.vGa(this.tGc);this.vGa(this.vGc);this.vGa(this.yLc);this.vGa(this.zLc);this.vGa(this.xLc)}t1h(y,t){switch(y){case 1:return this.K4h(t);case 2:return this.pMh(t)}return f.a.dzc?this.MHc:null}$Ug(y){y.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}ZUg(y){y.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);
y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}YUg(y){y.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}xXg(y){y.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
y.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);y.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);y.add("OverlayBig","Get the Word app");y.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");y.add("OverlaySmallSplit1","Discover Word");y.add("OverlaySmallSplit2","designed for the iPad.");y.add("SkipButton","Skip for now")}sVg(y){y.add("Headline",
"Get the Office Online extension for Chrome");y.add("UseAppButton","Get the extension");y.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}wXg(y){y.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);y.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);
y.add("OverlayBig","Get the PowerPoint app");y.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");y.add("OverlaySmallSplit1","Discover PowerPoint");y.add("OverlaySmallSplit2","designed for the iPad.");y.add("SkipButton","Skip for now")}vXg(y){y.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);y.add("OpenAppButton",
CommonUIStrings.l_WildFireBizBarOpenAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}vGa(y){y.add("Corporation","Microsoft Corporation")}K4h(y){switch(y){case 3:return this.zLc;case 2:return this.yLc;case 1:return this.xLc}return null}pMh(y){switch(y){case 3:return this.vGc;case 2:return this.tGc;case 1:return this.sGc}return null}static get instance(){h.Ma||(h.Ma=new h);return h.Ma}}h.Ma=null;Object(u.a)(h,"WildFireStringFactory",null,[]);var m=a(4),l=a(40),
w=a(27);a.d(E,"a",function(){return n});class n{constructor(y,t,r,v,B=null,A=null){this.MPc=null;this._id=y;this.uQc=t;this.Wug=B;this.Zjb=v;this.kmb=A;this.Ipa=null;this.SYa=r;this.Imb=h.instance.t1h(t,y)}P4c(){this.Ipa=new e.a(this.title,this.message,null);this.Ipa.addButton(this.wye,Object(b.a)(this,this.Qyf,"onButtonOneClick"),"");this.SYa&&this.Ipa.YHg(this.yye,Object(b.a)(this,this.Tyf,"onButtonTwoClick"));this.Ipa.N$=Object(b.a)(this,this.MLe,"dismissBar");this.Ipa.image=3;this.Ipa.id=16;this.Ipa.closeable=
!0}get title(){return this.Imb.na("Headline")}get message(){return this.Imb.na("CallToAction")}get kZj(){return this.SYa}get wye(){return this.SYa?this.Imb.na("InstallButton"):this.Imb.na("UseAppButton")}get yye(){return this.SYa?this.Imb.na("OpenAppButton"):""}Qyf(){this.SYa?this.igi():this.aZj()}Tyf(){this.SYa&&this.NYi()}get AXg(){return this.Ipa}get openUrl(){this.MPc||(this.MPc=this.Wug());return this.MPc}igi(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Zjb&&
this.kmb&&this.kmb();f.a.vRf(this._id,this.uQc)}NYi(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Zjb&&this.kmb&&this.kmb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.Dte(this._id),this.openUrl,0,!1))}aZj(){f.a.dzc?this.DXg():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),f.a.WRd("BizBarClicked"),1!==this.uQc&&2!==this.uQc||f.a.Z2g(this.openUrl,this.Zjb,this._id,this.kmb))}DXg(){this.Zjb?c.ULS.sendTraceTag(17571974,
323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");l.a.YU(m.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}alh(){this.Zjb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.WRd(f.a.FBe)}MLe(){f.a.dzc?this.alh():(f.a.WRd(f.a.Aed(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static $5b(){const y=m.AFrameworkApplication.sa.Pa,
t=new n(y.Gj,f.a.Hdc(),8<w.a.i6a,1===y.B6,()=>y.Ox,y.BZf());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return t}}Object(u.a)(n,"WildFireBusinessBar",null,[])},1289:function(u,E,a){u=a(0);var c=a(15),b=a(84),e=a(134),f=a(4),d=a(14),h=a(95),m=a(45),l=a(180),w=a(1075),n=a(86),y=a(56),t=a(80),r=a(937);class v extends e.StandardDialog{constructor(A,z,x,D=null){super();this.GP=this.om=this.uqa=null;this.rn=[];this.nWb=z;this.zP=A;this.rvg=x;this.zXb=D;this.Hmb=new r.a("LoadResource","LoadPrintablePdf")}sQ(){this.Rb=
5;this.width=40;const A=document.createElement("span");A.id=this.mi("DirectPrintHeaderContent");const z=document.createElement("span");z.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(z,"DirectPrintHeader");this.GP=document.createElement("iframe");this.GP.name="pdfObjectFrame";this.GP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.GP.onload=Object(b.a)(this,this.T4i,"printablePdfLoaded");if(this.zXb&&0<this.zXb.count){var x=t.a.rhd(this.nWb,this.zXb);const D=
t.a.bLd(this.nWb,this.zXb);this.om=document.createElement("form");this.om.id="printPreviewPostForm";this.om.method="POST";this.om.target=this.GP.name;this.om.action=D;for(let J of x)x=document.createElement("input"),x.type="hidden",x.name=J.key,x.value=J.value,this.om.appendChild(x)}else this.GP.setAttribute("src",this.nWb);Sys.UI.DomElement.addCssClass(this.GP,l.a.qfe);this.rvg?(Sys.UI.DomElement.addCssClass(this.GP,"DirectPrintPdfObjectHidden"),z.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
n.a.wh(this.GP,n.a.BC,n.a.Bk)):(Sys.UI.DomElement.addCssClass(this.GP,"DirectPrintPdfObject"),this.rn.push(this.GP));A.appendChild(z);A.appendChild(document.createElement("br"));A.appendChild(this.GP);this.om&&A.appendChild(this.om);A.appendChild(document.createElement("br"));A.appendChild(this.J6g(this.om?"#":this.nWb));this.Hmb.start();this.jEb(CommonUIStrings.l_AppTitle,null,null,null,null,A);this.eX(this.mi("DirectPrintHeaderContent"));this.om&&this.om.submit();this.Kah();c.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}J6g(A){const z=document.createElement("span");var x=document.createElement("span");x.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;z.appendChild(x);f.AFrameworkApplication.fa&&(2===f.AFrameworkApplication.sa.Pa.Gj&&f.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.sa.Pa.Gj&&f.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(A=document.createElement("span"),2===f.AFrameworkApplication.sa.Pa.Gj?
A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.sa.Pa.Gj&&(A.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.uqa=A,z.appendChild(document.createElement("br")),z.appendChild(A)):(x=document.createElement("a"),x.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,x.href=A,x.target="_blank",x.id="PrintPDFLink",x.className="AllowBrowserClick",this.uqa=
x,z.appendChild(document.createElement("br")),z.appendChild(x),this.om&&m.a.addHandler(x,"click",Object(b.a)(this,this.cqc,"onSubmit")),this.zP.ta(d.a.click,this.uqa,Object(b.a)(this,this.TMe,"downloadPDFLinkClicked"),null));this.rn.push(this.uqa);return z}cqc(A){this.om&&(this.om.target="_blank",this.om.submit());A.preventDefault()}Kah(){if(0<this.rn.length){const A=new w.a(this.rn),z=h.FocusManager.instance().LQ();z&&(this.uqa.focus(),z.jf=A,z.N_=!0)}}TMe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");
return!1}Vvd(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}T4i(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Hmb&&this.Hmb.stop()}dispose(){this.uqa&&(this.zP.Ba(d.a.click,this.uqa,Object(b.a)(this,this.TMe,"downloadPDFLinkClicked")),this.uqa=null);y.a.v0(this.GP);this.GP=null;super.dispose()}}Object(u.a)(v,"DirectPrintDialog",e.StandardDialog,[653]);a.d(E,"a",function(){return B});class B{constructor(A){this.zP=A}bRh(A,
z){return new v(this.zP,A,z,null)}}Object(u.a)(B,"DirectPrintDialogFactory",null,[631])},1290:function(u,E,a){u=a(0);var c=a(15),b=a(552),e=a(84),f=a(1342),d=a(1076);class h{constructor(t,r){this.Rag=t;this.aUa=r}}Object(u.a)(h,"DirectPrintProbeResults",null,[]);var m=a(4),l=a(263),w=a(27),n=a(111);a.d(E,"a",function(){return y});class y{constructor(t,r,v,B,A,z,x,D,J,L){this.RYb=null;this.mtg=t;this.clb=r;this.nPc=v;this.vwg=B;this.axg=A;this.EQc=new b.a(Object(e.a)(this,this.aZh,"getProbeResults"));
this.nWa=z;this.jde=J;this.cCg=x;this.bxg=D;this.ixg=L}get eD(){return this.mtg}start(){}Z6i(){const t=Array(this.eD.$Ta.length);if(void 0!==this.clb&&null!==this.clb)for(let r=0;r<this.eD.$Ta.length;r++)t[r]=this.eD.$Ta[r]in this.clb&&this.vwg(this.clb[this.eD.$Ta[r]]);return t}$6i(){const t=Array(this.eD.aUa.length),r=!(void 0===this.nPc||null===this.nPc);for(let v=0;v<this.eD.aUa.length;v++){const B=this.eD.aUa[v];t[v]=r&&B in this.nPc?!0:this.axg(B)}return t}I1h(){const t=this.Z6i(),r=Array(t.length);
for(let v=0;v<t.length;v++)r[v]=t[v]?this.LCh(this.clb[this.eD.$Ta[v]]):null;return r}LCh(t){if(void 0===t||null===t)return null;t=t.enabledPlugin;return void 0===t||null===t?null:t.name}aZh(){var t=this.I1h();const r=this.$6i(),v={},B={};for(let A=0;A<this.eD.$Ta.length;A++)v[this.eD.$Ta[A]]=t[A];for(t=0;t<this.eD.aUa.length;t++)B[this.eD.aUa[t]]=r[t];return new h(v,B)}dDj(){return this.ixg||!this.eD.isEnabled||m.AFrameworkApplication.isUnifiedHostMode?!1:this.lLj()}a7f(){if(null!=this.RYb)return this.RYb;
const t=y.Wgf(this.eD);return this.RYb=this.eD.Xgf&&t||this.Bji()}Bji(){return w.a.Bp&&this.eD.Dji&&w.a.HBe>=this.eD.J1g?!0:!1}lLj(){if(!this.bxg(this.eD))return!1;var t=n.a.ljd(this.EQc.value.Rag);for(const r of t)if(void 0!==r&&null!==r)return!0;t=n.a.ljd(this.EQc.value.aUa);for(const r of t)if(r)return!0;return!1}e9h(){const t=n.a.ljd(this.EQc.value.Rag);for(const r of t)if(l.a.contains(this.eD.qbi,r))return!0;return!1}tFj(t){m.AFrameworkApplication.sa&&m.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?
this.jde(t,null):this.dDj()?this.tlh(t,this.e9h()&&!0):this.jde(t,null)}tlh(t,r){const v=this.cCg.Ac("UserAction","OpenDirectPrintDialog");this.nWa.bRh(t,r).sQ();v.stop()}static ulf(t){try{return new ActiveXObject(t),!0}catch(r){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",t)}return!1}static Zgf(t){return void 0===t||null===t?!1:!(void 0===t.enabledPlugin||null===t.enabledPlugin)}static create(t){const r=new d.a(m.AFrameworkApplication.fa.appSettings);let v=
null;try{v=window.navigator.mimeTypes}catch(L){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let B=null;try{B=window.navigator.plugins}catch(L){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const A=y.Zgf,z=y.ulf;t=t.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const x=m.AFrameworkApplication.sa.iE,D=y.vlf,J=!!m.AFrameworkApplication.sa&&m.AFrameworkApplication.sa.Pa.Hv&&!m.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");
return new y(r,v,B,A,z,t,x,D,(L,T)=>new f.a(L,!1,T,!0,J),m.AFrameworkApplication.Jba)}static vlf(t){return w.a.Bp||w.a.Fv&&t.Xmi||t.Xgf&&y.Wgf(t)?!0:!1}static Wgf(t){var r=w.a.bub;if(r){var v=r.split(".");if(2===v.length)return r=parseInt(v[0]),v=parseInt(v[1]),r>t.Nyd||r===t.Nyd&&v>=t.Euf}return!1}}Object(u.a)(y,"DirectPrintManager",null,[624])},1337:function(u,E,a){a.d(E,"a",function(){return l});u=a(0);var c=a(84);E=a(134);var b=a(1064),e=a(260),f=a(4),d=a(14),h=a(80),m=a(27);class l extends E.StandardDialog{constructor(w,
n=!0,y=!1,t=null,r=null,v=!1){super();this.KWa=this.JWa=this.om=this.eY=null;var B=this.HYd?this.HYd:CommonUIStrings.l_DefaultDialogTitle;l.Z5a=v;this.sTb=t||new b.a(w,!0);this.sTb.Nve(this);const A=[],z=[];l.Uu&&(this.mXc&&this.mXc.forEach(J=>{Array.add(A,J)}),this.Tre&&this.Tre.forEach(J=>{Array.add(z,J)}));n?y?(this.Rb=4,this.oc(1,this.buttonText),this.oc(2,CommonUIStrings.l_DialogClose)):(this.Rb=6,this.oc(0,CommonUIStrings.l_DialogClose)):this.Rb=5;v=document.createElement("span");this.g6c&&
(v.className=this.g6c);t=document.createElement("a");t.innerText=this.hlc;t.href=w;t.target="_blank";t.id=this.glc;t.className=e.AFrame.Ase;var x=!m.a.Ez&&!!r&&0<r.count;if(x){const J=h.a.rhd(w,r);r=h.a.bLd(w,r);t.href="#";t.target="_self";this.om=document.createElement("form");this.om.id="printPreviewPostForm1";this.om.method="post";this.om.target="_blank";this.om.action=r;for(var D of J)r=document.createElement("input"),r.type="hidden",r.name=D.key,r.value=D.value,this.om.appendChild(r)}else this.om=
null;this.om||l.Z5a?l.Z5a||Array.add(z,{["type"]:"AppLinkProps",["id"]:this.glc,["text"]:this.hlc,["onExecute"]:()=>{this.UPf()}}):Array.add(z,{["type"]:"AppLinkProps",["id"]:this.glc,["text"]:this.hlc,["handler"]:{["href"]:x?"#":w,["target"]:x?"_self":"_blank"}});this.UOa&&Array.add(A,this.UOa);y?(w=document.createElement("span"),w.innerText=this.UOa.replace("{0}",""),v.appendChild(w)):this.uuf?(w=document.createElement("span"),w.id=this.mi("message"),D=document.createElement("span"),r=document.createElement("span"),
x=this.UOa.split("{0}"),D.innerText=x[0],r.innerText=x[1],w.appendChild(D),w.appendChild(t),w.appendChild(r),v.appendChild(w)):(w=document.createElement("span"),w.innerText=this.UOa,v.appendChild(w),v.appendChild(document.createElement("br")),v.appendChild(document.createElement("br")),v.appendChild(t),l.Z5a||Array.add(A,"{0}"));this.om&&v.appendChild(this.om);l.Uu&&(this.f9a&&(this.WCb?this.Doe(this.f9a,this.WCb):(Array.add(A,"{0}"),Array.add(z,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.f9a,
["onExecute"]:()=>{this.alc()}}))),this.esa(A,z));this.jEb(B,null,this.jcf,null,Object(c.a)(this,this.vw,"dialogHandler"),l.Uu?null:v);this.eX(this.mi("message"));!l.Uu&&this.WCb&&this.f9a&&(B=document.createElement("div"),B.className="WACDialogLearnMoreLinkContainer",this.eY=document.createElement("a"),this.eY.innerText=this.f9a,this.eY.href=this.WCb,this.eY.target="_blank",this.eY.id=this.mi("LearnMoreLinkId"),this.eY.className=e.AFrame.Ase,B.appendChild(this.eY),n?this.wb.insertBefore(B,this.wb.lastChild):
this.wb.appendChild(B),this.eX(String.format("{0} {1}",this.mi("message"),this.mi("LearnMoreLinkId"))));this.Mib=t;y?this.RI(this.hC):this.RI(this.Mib);this.fqf();f.AFrameworkApplication.sa.qX.ta(d.a.click,this.Mib,Object(c.a)(this,this.RMe,"downloadLinkClicked"),null);this.eY&&f.AFrameworkApplication.sa.qX.ta(d.a.click,this.eY,Object(c.a)(this,this.alc,"learnMoreLinkClicked"),null);this.qTb=!1}get jcf(){return null}get HYd(){return null}get UOa(){return null}get WCb(){return null}get f9a(){return null}get uuf(){return!1}get buttonText(){return CommonUIStrings.l_Open}get g6c(){return null}get mXc(){return null}get Tre(){return null}QYc(){this.om&&
(this.JWa||(this.JWa=Object(c.a)(this,this.DJi,"onActionButtonClicked"),this.Zy.ta(d.a.click,this.hC,this.JWa)),this.KWa||(this.KWa=Object(c.a)(this,this.EJi,"onActionButtonKeyUp"),this.Yd.ta(d.a.Fd,this.hC,this.KWa)));super.QYc()}DJi(w){this.UUe(w);return!0}EJi(w){return this.lnf(w,Object(c.a)(this,this.UUe,"executeDismissActionButtonFromArgs"))}UUe(w){this.om&&this.om.submit();this.ava(w.Gb)}Vvd(){}RMe(){this.hqf();this.om?this.om.submit():this.sTb.q8c();return!0}alc(){return!1}dispose(){this.sTb.dispose();
this.Mib&&(f.AFrameworkApplication.sa.qX.Ba(d.a.click,this.Mib,Object(c.a)(this,this.RMe,"downloadLinkClicked")),this.Mib=null);this.eY&&(f.AFrameworkApplication.sa.qX.Ba(d.a.click,this.eY,Object(c.a)(this,this.alc,"learnMoreLinkClicked")),this.eY=null);this.Zy&&this.JWa&&(this.Zy.Ba(d.a.click,this.hC,this.JWa),this.JWa=null);this.Yd&&this.KWa&&(this.Yd.Ba(d.a.Fd,this.hC,this.KWa),this.KWa=null);super.dispose()}UPf(){this.om&&(document.body.appendChild(this.om),this.om.submit(),document.body.removeChild(this.om))}vw(w){1===
w&&(this.Vvd(),this.om?l.Uu&&this.UPf():this.sTb.q8c());this.dispose()}static get Uu(){return f.AFrameworkApplication.sa.Pa.Hv&&f.AFrameworkApplication.sa.Pa.dkf}static get Z5a(){return l.E$d}static set Z5a(w){l.E$d=w}}l.E$d=!1;Object(u.a)(l,"ADialogWithLinkToResource",E.StandardDialog,[])},1338:function(u,E,a){a.r(E);a.d(E,"ReactOICErrorDialogWithTrial",function(){return f});u=a(0);var c=a(84);E=a(1066);var b=a(418),e=a(146);class f extends E.a{constructor(d,h,m,l,w,n){super(d,h,m,l,w,n);h={["errorMessage"]:this.GPe,
["offerString"]:this.kxf};d=new e.a(!1,!1,!0);this.L7f?(d.Rb=1,h.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Kwa,["onExecute"]:()=>{b.Redirect.showHelp(this.Eaf)}}):(d.Rb=4,d.oc(2,this.ccf));d.oc(1,this.kZb);d.Fe=this.id;h={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:h};d.initializeAndShow(this.Pl,Object(c.a)(this,this.w9i,"reactOICErrorDialogWithTrialHandler"),h)}}Object(u.a)(f,"ReactOICErrorDialogWithTrial",E.a,[])},1339:function(u,E,a){a.r(E);a.d(E,"OICErrorDialogWithTrial",
function(){return e});u=a(0);var c=a(84);E=a(1066);var b=a(134);class e extends E.a{constructor(f,d,h,m,l,w){super(f,d,h,m,l,w);f=document.createElement("span");f.innerText=this.GPe;f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));d=document.createElement("span");d.innerText=this.kxf;f.appendChild(d);d=new b.StandardDialog;this.L7f?(d.Rb=1,d.Moe(this.Kwa,this.Eaf)):(d.Rb=4,d.oc(2,this.ccf));d.oc(1,this.kZb);d.Fe=this.id;d.Zl(this.Pl,null,this.icon,Object(c.a)(this,
this.ewi,"legacyOICErrorDialogWithTrialHandler"),f)}}Object(u.a)(e,"OICErrorDialogWithTrial",E.a,[])},1340:function(u,E,a){a.r(E);a.d(E,"CheckRoamingRightsRequest",function(){return c});u=a(0);a=a(1067);class c extends a.a{constructor(){super()}sxb(){return 2}Vaa(){return 1}}Object(u.a)(c,"CheckRoamingRightsRequest",a.a,[])},1341:function(u,E,a){a.r(E);a.d(E,"GetRoamingLauncherRequest",function(){return c});u=a(0);a=a(1067);class c extends a.a{constructor(){super()}sxb(){return 0}Vaa(){return 2}}
Object(u.a)(c,"GetRoamingLauncherRequest",a.a,[])},1342:function(u,E,a){a.d(E,"a",function(){return l});u=a(0);var c=a(15),b=a(1337),e=a(1064),f=a(4),d=a(86),h=a(80),m=a(27);class l extends b.a{constructor(w,n,y=null,t=!0,r=!1){super(w,!0,!(l.CCa&&t),new e.a(w,n),y,r);l.CCa=l.CCa&&t;if(l.CCa){n=document.createElement("iframe");t=null;r=this.okh;n.name="pdfObjectFrame";n.id="pdfObjectIFrame";if(y&&0<y.count){const v=h.a.rhd(w,y);w=h.a.bLd(w,y);t=document.createElement("form");t.id="printPreviewPostForm";
t.method="POST";t.target=n.name;t.action=w;for(let B of v)w=document.createElement("input"),w.type="hidden",w.name=B.key,w.value=B.value,t.appendChild(w)}else n.src=w;r.appendChild(n);t&&(r.appendChild(t),t.submit());Sys.UI.DomElement.addCssClass(n,"DirectPrintPdfObjectHidden");d.a.wh(n,d.a.BC,d.a.Bk)}}get jcf(){return"Print_32x32x32"}get HYd(){return l.CCa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get UOa(){return l.CCa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get mXc(){const w=
[];Array.add(w,CommonUIStrings.l_PrintDialogCanCloseDocument);if(b.a.Z5a){let n=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.sa.Pa.mJe&&(n=f.AFrameworkApplication.sa.Pa.mJe);Array.add(w,n)}return l.CCa?w:null}get hlc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get glc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get g6c(){return f.AFrameworkApplication.dLe?"UIFontDialogTextLarge":null}fqf(){c.ULS.sendTraceTag(7690390,
324,50,"Legacy print dialog displayed")}hqf(){f.AFrameworkApplication.Tn.mzb(9540);c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Vvd(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get CCa(){return!!f.AFrameworkApplication.sa&&f.AFrameworkApplication.sa.Pa.Hv&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(m.a.Ez||m.a.Fv||m.a.If||m.a.BNa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set CCa(w){}}
Object(u.a)(l,"PrintDialogWithLinkToPdf",b.a,[])},1359:function(u,E,a){u=a(0);var c=a(84),b=a(41);class e{constructor(){this.classId=0}static gJa(l){try{return b.a(l)}catch(w){}return null}}Object(u.a)(e,"ARoamingAppsResponse",null,[]);class f{constructor(){this.state=this.callback=null;this.bqd=!1}}Object(u.a)(f,"GetRoamingAppsLauncherContext",null,[]);var d=a(4),h=a(106);a.d(E,"a",function(){return m});class m{constructor(l){this.KHc=!1;this.hYa=m.$fc;this.vRc=this.zPc=0;this.platform=null;this.DAg=
l;this.eme=this.wRc=!1}get roamingAppsAreEnabled(){return this.DAg}get wZj(){return this.roamingAppsAreEnabled&&this.wRc?this.eme:!1}w1g(){d.AFrameworkApplication.Cic&&this.roamingAppsAreEnabled&&!this.wRc&&!this.KHc&&(this.vRc=1,this.KHc=!0,this.Bkj(),this.RUe())}Bkj(){this.hYa=m.$fc;this.zPc=0}getRoamingAppsLauncher(l,w,n){this.wZj?(l=new f,l.callback=w,l.state=n,l.bqd=!0,this.WUe(l)):w(!1,"",n)}RUe(){const l=new (a(1340).CheckRoamingRightsRequest);l.RoamingApp=this.vRc;l.BaseDocQuerySignature=
d.AFrameworkApplication.Ii;l.execute(Object(c.a)(this,this.y1g,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.x1g,"checkUserRoamingRightsFailed"),null)}y1g(l){d.AFrameworkApplication.Ng||((l=e.gJa(l.data.ue))?this.YRd(l.HasRights):this.YRd(!1))}x1g(){if(!d.AFrameworkApplication.Ng)if(this.zPc>=m.BDi)this.YRd(!1);else{var l=new h.a(2,1,this.hYa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);d.AFrameworkApplication.Gi.Eg(l);this.zPc++;this.hYa*=m.Xlj;
this.hYa>m.Qtf&&(this.hYa=m.Qtf)}}YRd(l){this.eme=l;this.wRc=!0;this.KHc=!1}retryCheckUserRoamingRights(){this.RUe()}WUe(l){const w=new (a(1341).GetRoamingLauncherRequest);w.RoamingApp=this.vRc;w.BaseDocQuerySignature=d.AFrameworkApplication.Ii;w.execute(Object(c.a)(this,this.B_h,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.A_h,"getRoamingAppsLauncherFailed"),l)}B_h(l){if(!d.AFrameworkApplication.Ng){var w=e.gJa(l.data.ue);l=l.data.state;w?(this.platform=w.Platform,l.callback(!0,w.Launcher,
l.state)):l.callback(!1,"",l.state)}}A_h(l){if(!d.AFrameworkApplication.Ng){var w=l.data.state;5===l.data.status&&w.bqd?(w.bqd=!1,this.WUe(w)):w.callback(!1,"",w.state)}}static get instance(){return m.tC||(m.tC=new m(d.AFrameworkApplication.BQg))}}m.$fc=1E3;m.Xlj=5;m.Qtf=12E5;m.BDi=5;m.tC=null;Object(u.a)(m,"RoamingAppsManager",null,[])},1433:function(u,E,a){a.r(E);var c=a(1049),b=a(0),e=a(248);class f{get name(){return"Common.App.DialogWithLinkToResource"}Wh(){}init(){}dispose(){}static main(){e.a.instance.Fi(new f)}}
Object(b.a)(f,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var d=a(552),h=a(15),m=a(84),l=a(812),w=a(30),n=a(131);class y{static Hph(qc){return y.hye("New",qc)}static Iph(qc){return y.hye("Open",qc)}static Sxe(qc,Uc){return y.Fha("LoadingMenuSection",y.yxi,qc,y.lqb("lblLoading",Uc))}static mqb(qc,Uc,ub=null,Xb=null){return y.Fha("MessageMenuSection",y.dvf,Uc,y.lqb("lblMessage",qc,ub,Xb))}static mWg(qc){return y.Sxe(qc,CommonUIStrings.l_VoicedLoadingText)}static nWg(qc,Uc){return y.mqb(CommonUIStrings.l_NewCreationLocationMessage,
qc.ui,Uc.IR,Uc.Aoa)}static lWg(qc,Uc){return y.mqb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,Uc.Aoa,"\n\n"),qc.ui)}static Uxe(qc){return y.mqb(CommonUIStrings.l_NewGenericErrorMessage,qc.ui)}static jWg(qc,Uc,ub){return y.Fha("menuNewBlank",y.M9h,ub?qc.ui:null,y.gqb(qc.naf,qc.oaf,qc.paf,null,qc.Dka,qc.azb,Uc,"blank"))}static iXg(){return y.lqb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static eye(){return y.lqb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static jXg(qc,
Uc){return y.Fha("menuNewTemplates",qc,null,Uc)}static hWg(qc,Uc){return y.Fha("menuNewMoreTemplates",y.iYe,null,y.gqb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,qc,Uc))}static kVg(qc,Uc,ub){let Xb="";ub&&Uc&&(Xb=y.Fha("BrowseMoreMenuSection",y.iYe,null,y.gqb("btnBrowseMore",Uc,Uc,null,null,null,qc||"1959943459",ub)));return Xb}static lqb(qc,Uc,ub=null,Xb=null){let wc=Xb;Uc&&0<Uc.length&&(wc=y.$vf.rrc(Uc).trimEnd(),wc=0<=wc.indexOf("{0}")?
String.format(wc,Xb):String.format("{0} {1}",wc,Xb));ub=ub&&Xb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',w.a.df(ub),w.a.df(Xb),w.a.df(wc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',w.a.df(qc||""),y.$vf.rrc(w.a.df(Uc||"")),ub)}static gqb(qc,Uc,ub,Xb,wc,Tc,sd,qb){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
w.a.df(qc||""),w.a.df(Uc||""),w.a.df(ub||""),Xb||"32by32",w.a.df(wc||""),w.a.df(Tc||""),sd,w.a.df(qb||""))}static hye(qc,Uc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',qc,Uc)}static Fha(qc,Uc,ub,Xb){ub=ub?String.format('Title="{0}"',w.a.df(ub)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
w.a.df(qc||""),w.a.df(Uc||""),ub,Xb)}}y.dvf="MenuMru";y.yxi="MenuLoading";y.M9h="MenuHeader";y.iYe="MenuFooter";y.$vf=n.a.Sx("\n","&#10;");Object(b.a)(y,"NewAndOpenXmlUtilities",null,[]);var t=a(4),r=a(97),v=a(145),B=a(137);class A{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(b.a)(A,"HostInformation",null,[]);var z=a(106),x=a(40),D=a(373),J=a(164),L=a(642),T=a(575),O=a(105),G=a(25);class C{constructor(qc,Uc,ub,Xb,wc,Tc){this.xTc=this.Yo=this.kSb=null;this.XXb=
this.ISc=!1;this.gee=0;this.wSc=this.UMc=!1;this.k2=qc;this.jjb=Uc;this.qEa=new d.a(()=>new l.a(ub.value,Object(m.a)(this,this.bxb,"getMoreInfoEventReceived")));this.gyg=Xb;this.gra=wc;this.tBg=Tc;this.ymb=this.bzc;2===this.$K.Dca&&(this.wSc=!0)}get NP(){switch(this.$K.Dca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Hg(){const qc=this.$K.h$a;qc.Nb(G.a.newDocument,O.a.frame,Object(m.a)(this,this.newDocument,"newDocument"));qc.Ne(G.a.Lrc,
O.a.frame,Object(m.a)(this,this.Lrc,"populateNewMenu"),96)}newDocument(qc,Uc,ub,Xb,wc){if(1===ub)return 32;if(2===ub&&wc){if(t.AFrameworkApplication.fa.qa("BackstagePremiumTemplateExperienceEnabled")&&wc.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),t.AFrameworkApplication.ub.processAction(G.a.H3i,2);if(wc.MenuItemId&&wc.SourceControlId)return"NewDocumentHome"===wc.SourceControlId&&v.a("NewDocumentFromHomeTab"),this.G1a(wc.MenuItemId,wc.SourceControlId)}return 8}G1a(qc,
Uc){var ub=this.lnc.A5c;if(null===ub)return 8;var Xb=t.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(t.AFrameworkApplication.$ba&&Xb){h.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const wc={};wc[D.a.$bg]=qc;wc[D.a.NP]=this.NP;wc[D.a.lcid]=t.AFrameworkApplication.lcid.toString();wc[D.a.reason]=L.a.createNew;t.AFrameworkApplication.jV().execute(Tc=>{Tc.Pj(J.a.G1a,wc)})}else Xb=(new Date).getTime(),
Uc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",ub,w.a.mf(this.cma),w.a.mf(qc),w.a.mf(this.NP),w.a.mf(t.AFrameworkApplication.lcid.toString()),w.a.mf(Xb.toString()),w.a.mf(Uc),w.a.mf(t.AFrameworkApplication.canary),t.AFrameworkApplication.Ii),(ub=t.AFrameworkApplication.fa.Xa("ScenarioId"))&&""!==ub&&(Uc+="&wdscenarioid="+w.a.mf(ub)),Uc+="&"+t.AFrameworkApplication.jdc(),t.AFrameworkApplication.Cxa&&(Uc+="&"+t.AFrameworkApplication.Acc()),
(ub=this.Yo?this.Yo.IR:null)&&(Uc+="&DestinationUrl="+w.a.mf(ub)),x.a.lf(Uc,"_blank",void 0,"CreateNewDocument");2===this.$K.Dca&&h.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:T.a[this.$K.Dca],["Template"]:qc});return 32}LAi(qc){let Uc=Number.MAX_VALUE,ub=Number.MIN_VALUE;const Xb=window.performance;if(Xb&&"undefined"!==typeof Xb.getEntriesByName){for(let Tc=0;Tc<qc.length;Tc++){var wc=Xb.getEntriesByName(qc[Tc]);wc&&0<wc.length&&(wc=wc[0],Uc=Math.min(parseInt(String(wc.fetchStart)),
Uc),ub=Math.max(parseInt(String(wc.responseEnd)),ub))}ub>Uc&&h.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:ub-Uc,["MinFetchStart"]:Uc,["MaxResponseEnd"]:ub})}}Lrc(qc,Uc,ub,Xb,wc){if(1===ub)return this.wSc&&(t.AFrameworkApplication.MN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.wSc=!1),32;2!==ub||this.UMc||(this.gee=(new Date).getTime(),h.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",
{["ShouldShowTemplates"]:this.bzc,["CachedNewMenuXmlExists"]:!!this.kSb,["ShouldCallGetMoreInfo"]:this.$K.supportsGetMoreInfoForPersonalStorage}));return this.y2i(wc)}y2i(qc){qc&&(this.kSb?qc.PopulationXML=this.kSb:(this.$K.supportsGetMoreInfoForPersonalStorage&&!this.Yo&&this.kHi.WZ("Opened New menu",!0),qc.PopulationXML=this.lLh(this.getTemplateListJson())));return 32}ikf(){return!this.$K.supportsGetMoreInfoForPersonalStorage||!!this.Yo&&3===this.Yo.state&&!!this.Yo.Aoa&&!!this.Yo.IR}wpi(){return t.AFrameworkApplication.sa&&
t.AFrameworkApplication.sa.Pa.w_?!0:this.ikf()}getTemplateListJson(){if(!this.bzc||!this.wpi())return null;if(this.ymb&&!this.XXb){var qc="9";const Uc=t.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in Uc&&(qc=Uc.NumberOfTemplatesInBackstage);let ub=this.NP;"TemplateCollectionId"in Uc&&(ub=Uc.TemplateCollectionId);qc=String.format(this.$K.Z_+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",w.a.mf(t.AFrameworkApplication.lcid.toString()),w.a.mf(ub),qc);Boolean.parse(Uc.AppendOriginQueryParam||
"false")&&(qc+="&org=backstage");Boolean.parse(Uc.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in Uc&&(qc+="&templateTier="+Uc.TemplateTier);qc+="&"+t.AFrameworkApplication.jdc();t.AFrameworkApplication.Cxa&&(qc+="&"+t.AFrameworkApplication.Acc());this.$K.MEb.Pm(qc,1,null,null,!1,2,Xb=>{this.$K.AOa("CreateNewActor.GetTemplateListJson",Xb.data);this.PMj(Xb.data.ue)},Xb=>{this.$K.AOa("CreateNewActor.GetTemplateListJson",Xb.data);this.OMj()},null,void 0,void 0,void 0,void 0,"5");
this.ymb=!1}return this.xTc}PMj(qc){this.xTc=qc;this.ymb=!1;this.UIb();if(t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Pa.w_&&B.c()){qc=t.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const Uc=t.AFrameworkApplication.$ba;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.xTc,!0,qc&&Uc))}}OMj(){this.XXb=this.ymb=!0;this.UIb();t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Pa.w_&&B.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",
!1,!1));r.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}p2h(qc){var Uc=0;for(var ub=0;ub<qc.length;ub++)if("ST"===qc[ub].ImageType){Uc=ub;break}const Xb=qc.length?qc[Uc]:null;qc=Xb?Xb.Url||"":"";var wc;let Tc=ub=Uc=!1;if(Xb&&(wc=Xb.AspectRatio))wc=parseFloat(wc),1>wc?Uc=!0:1.5<wc?ub=!0:1===wc&&(Tc=!0);else switch(h.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:qc}),this.$K.Dca){case 3:Uc=!0;break;case 2:ub=
!0;break;case 5:Tc=!0}return{returnValue:qc,mbi:Uc?"95by123":ub?"123by69":Tc?"100by100":"123by95"}}lLh(qc){qc=({Hyc:Uc}=this.kWg(qc,this.lnc,this.lnc.yHa||"1056925771")).returnValue;if(Uc){this.kSb=qc;var Uc=(new Date).getTime()-this.gee;h.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:Uc})}return qc}bxb(qc,Uc){h.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Yo||3!==qc.state?2===qc.state&&(h.ULS.sendTraceTag(590964759,
202,50,"GetMoreInfoResult was bad, need to retry"),this.ISc=!0,this.UIb()):(this.Yo=qc,Uc||this.UIb(),t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Pa.w_&&B.c()&&B.d("setFileMenuHostInformation")&&(qc=Object.assign(new A,{hostUrl:this.Yo.IR,hostName:this.Yo.Aoa,folderUrl:t.AFrameworkApplication.breadcrumbFolderUrl,folderName:t.AFrameworkApplication.breadcrumbFolderName}),h.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(qc))))}kWg(qc,
Uc,ub){let Xb;Xb=!1;const wc=this.ikf();let Tc="";this.$K.supportsGetMoreInfoForPersonalStorage&&(this.ISc?(Tc=y.Uxe(Uc),this.ISc=!1,h.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Yo?wc?Tc=y.nWg(Uc,this.Yo):this.Yo.sgi?(Xb=!0,this.ymb=!1,Tc=y.lWg(Uc,this.Yo),h.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Xb=!0,Tc=y.Uxe(Uc),h.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.Yo.IR,["StorageServiceDisplayNameIsSet"]:!!this.Yo.Aoa})):(Tc=y.mWg(Uc.ui),h.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));wc&&(Tc+=y.jWg(Uc,ub,!Tc)+({Hyc:Xb}=this.hXg(qc,ub)).returnValue);return{returnValue:y.Hph(Tc),Hyc:Xb}}hXg(qc,Uc){let ub;ub=!1;if(!this.bzc)return ub=!0,h.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Hyc:ub};let Xb="",wc="",Tc="MenuTemplate";if(this.XXb)Xb=
y.eye(),this.XXb=!1,h.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(qc){try{const sd=Sys.Serialization.JavaScriptSerializer.deserialize(qc,!0);Xb=this.gXg(sd,Uc);h.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");t.AFrameworkApplication.awf&&"OneDrive"===this.cma&&(wc=y.hWg(this.lHi,t.AFrameworkApplication.awf))}catch(sd){h.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:qc}),
Xb=y.eye()}ub=!0}else Tc="MenuLoading",Xb=y.iXg(),h.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:y.jXg(Tc,Xb)+wc,Hyc:ub}}gXg(qc,Uc){let ub="";const Xb=[];for(let Tc=0;Tc<qc.length;Tc++){var wc=qc[Tc];let sd="";if(wc){const qb=wc.Title,Sb=wc.AssetId;wc=wc.Thumbnails;Sb&&qb&&wc&&({mbi:wc,returnValue:sd}=this.p2h(wc),ub+=y.gqb("jbtnNewTemplate"+Tc,qb,null,wc,null,sd,Uc,Sb))}Xb[Tc]=sd}qc=new z.a(4,1,5E3,()=>{this.LAi(Xb)},106);this.$K.jnc.Eg(qc);
return ub}UIb(){this.UMc=!0;this.$K.Tvf.px(this.lnc.zvb);this.UMc=!1}get $K(){return this.k2.value}get lnc(){return this.jjb.value}get kHi(){return this.qEa.value}get lHi(){return this.gyg.value}get cma(){return this.gra.value}get bzc(){return this.tBg.value}}Object(b.a)(C,"CreateNewActor",null,[]);var H=a(1336);class I extends H.a{constructor(){super()}Ape(){this.JT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.JT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.JT(2,CommonUIStrings.l_Open);
this.JT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.JT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.JT(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return I.Ma||(I.Ma=new I)}static jZi(qc){return I.instance.ga(qc)}}I.Ma=null;Object(b.a)(I,"MruActorIntlHelper",H.a,[]);var M;(function(qc){qc[qc.success=0]="success";qc[qc.failure=1]="failure";qc[qc.spinner=2]="spinner";qc[qc.none=3]="none"})(M||(M={}));Object(b.b)("DisplayState",M);var Q=a(41);class U{constructor(qc,Uc,ub,Xb,wc,
Tc,sd,qb){this.sHc=null;this.uUc=!0;this.jSb="";this.$Cg=0;this.tXa=null;this.ONc=3;this.lb=qb;this.k2=qc;this.qj=Uc;this.fug=ub;this.krg=Xb;this.jrg=wc;this.qEa=new d.a(()=>new l.a(Tc.value,null));this.Qug=new d.a(()=>new l.a(sd.value,Object(m.a)(this,this.VFi,"mruEventResultReceived")));this.lb.qa("WacInTabOpenMRUIsEnabledForUiHost");this.lb.qa("UiHostSupportsDocRebootFeatures")}VFi(qc,Uc){this.tXa=qc;Uc||this.MRf()}jcj(){this.LD.h$a.Ne(G.a.Krc,O.a.frame,Object(m.a)(this,this.Krc,"populateMruMenu"),
96)}Krc(qc,Uc,ub,Xb,wc){return 1!==ub&&wc?this.v2i(wc):32}v2i(qc){this.lqh();this.kqh();qc.PopulationXML=y.Iph(this.jSb+this.sHc);return 32}lqh(){var qc=3;let Uc=!1;if(this.jSb&&this.$Cg===this.tXa.AOj)h.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),qc=this.ONc;else{h.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var ub=this.LD.Bw();this.tXa=this.UFi.WZ("File Open opened",
!0);this.jSb&&2!==this.ONc&&3!==this.tXa.state?Uc=!0:(qc=this.k0h(this.tXa),t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Pa.w_&&B.c()&&qc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(qc,!0)),this.jSb=({cHi:qc}=this.mLh(this.tXa)).returnValue);ub=this.LD.Bw()-ub;h.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:ub})}2!==qc&&(ub={["DisplayState"]:M[qc]},1!==qc&&(ub.IsStale=Uc),h.ULS.sendTraceTag(5849630,
202,50,"MRU section display state {0}",ub));this.ONc=qc}k0h(qc){let Uc;try{Uc=Q.c(qc.lzd)}catch(ub){Uc=null,h.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",ub)}return Uc}kqh(){this.uUc?(h.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.sHc=({l1j:this.uUc}=this.eCi()).returnValue):h.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");h.ULS.sendTraceTag(5849633,202,
50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.uUc,["NotDisplayingLink"]:!this.sHc})}mLh(qc){let Uc;1===qc.state||0===qc.state?(h.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),qc=2,Uc=y.Sxe(this.ika(2),this.ika(5))):3===qc.state&&qc.lzd?(Uc=this.iWg(qc.lzd),qc=0):(h.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),Uc=y.mqb(this.ika(1),this.ika(2)),qc=1);return{returnValue:Uc,cHi:qc}}iWg(qc){let Uc;const ub=
this.fEb.yHa||"2155708348";if(qc.length){Uc=y.lqb("lblRecentDocuments",this.ika(3));let Xb=0;for(let wc=0;wc<qc.length;wc++){const Tc=qc[wc];"FileName"in Tc&&"DocumentUrl"in Tc&&"Path"in Tc&&(Uc+=y.gqb("MruButton"+wc,Tc.FileName.toString(),Tc.Path.toString(),null,this.fEb.Dka,this.fEb.azb,ub,Tc.DocumentUrl.toString()),Tc.IsPinned&&Xb++)}Uc=y.Fha("RecentDocumentsMenuSection",y.dvf,this.ika(2),Uc);h.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:qc.length,
["NumPinnedDocuments"]:Xb})}else Uc=y.mqb(this.ika(0),this.ika(2)),h.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return Uc}eCi(){let qc;qc=!0;let Uc=this.DUg;var ub=this.CUg;if(Uc&&ub||!this.LD.supportsGetMoreInfoForPersonalStorage)qc=!1;else{const Xb=this.Hcc.WZ("File Open",!1);3===Xb.state&&(Uc=Xb.IR,ub=Xb.Aoa,qc=!1)}ub=ub?String.format(this.ika(4),ub):null;return{returnValue:y.kVg(this.fEb.yHa,ub,Uc),l1j:qc}}MRf(){this.LD.Tvf.px(this.fEb.zvb)}get LD(){return this.k2.value}get ika(){return this.qj.value}get fEb(){return this.fug.value}get DUg(){return this.krg.value}get CUg(){return this.jrg.value}get Hcc(){return this.qEa.value}get UFi(){return this.Qug.value}}
Object(b.a)(U,"MruRenderer",null,[]);var N=a(240),W=a(766);class X{constructor(qc,Uc,ub,Xb,wc,Tc,sd){this.Yo=null;this.aje=!1;this.wqa=this.K5d=0;this.nyg=qc;this.KXa=Uc;this.OVb=ub;this.jjb=Xb;this.gra=wc;this.k2=Tc;this.qEa=new d.a(()=>new l.a(sd.value,Object(m.a)(this,this.bxb,"getMoreInfoEventReceived")))}G1a(){!this.Yo&&this.Xzd.supportsGetMoreInfoForPersonalStorage?this.Hcc.WZ("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}bxb(qc){if(!this.Yo&&3===qc.state)this.Yo=qc;else if(2===
qc.state){this.aje?h.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Hcc.WZ("NewDocumentFromStream",!0),this.aje=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.K5d=(new Date).getTime();var qc=this.MDh.A5c;if(null===qc)this.KXa(null);else{var Uc=this.OVb.menuItemId,ub=this.OVb.uG,Xb=this.OVb.BKj,wc=this.OVb.RDh;this.wqa="streamBase64"===Xb?wc.length/1024:0;h.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.NP,
this.wqa);var Tc=(new Date).getTime();qc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",qc,w.a.mf(this.cma),w.a.mf(Uc),w.a.mf(this.NP),w.a.mf(t.AFrameworkApplication.lcid.toString()),w.a.mf(Tc.toString()),w.a.mf(ub),w.a.mf(t.AFrameworkApplication.canary),t.AFrameworkApplication.Ii,w.a.mf(Xb));qc+="&"+t.AFrameworkApplication.jdc();t.AFrameworkApplication.Cxa&&(qc+="&"+t.AFrameworkApplication.Acc());(Uc=this.Yo?this.Yo.IR:null)&&
(qc+="&DestinationUrl="+w.a.mf(Uc));this.Xzd.MEb.Pm(qc,2,wc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(m.a)(this,this.fHi,"newDocumentFromStreamSuccessHandler"),Object(m.a)(this,this.eHi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}fHi(qc){if(qc&&qc.data&&qc.data.ue)if(({At:Uc}=Q.d(qc.data.ue)).returnValue)if(qc=Uc,qc.StatusCode!==N.a.lP&&qc.StatusCode!==N.a.Lsb)h.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.NP,this.wqa,qc.StatusCode),this.KXa(null);else if(qc.NewDocumentUrl&&""!==qc.NewDocumentUrl){var Uc=(new Date).getTime()-this.K5d;h.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.NP,this.wqa,Uc);this.nyg(qc.NewDocumentUrl)}else h.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.NP,this.wqa),this.KXa(null);else h.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.NP,this.wqa,{["ResponseData"]:W.a.Yfb(qc.data.ue)}),this.KXa(null);else h.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.NP,this.wqa),this.KXa(null)}eHi(qc){qc&&qc.data&&h.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.NP,this.wqa,qc.data.status);this.KXa(null)}get NP(){switch(this.Xzd.Dca){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get MDh(){return this.jjb.value}get cma(){return this.gra.value}get Xzd(){return this.k2.value}get Hcc(){return this.qEa.value}}Object(b.a)(X,"NewDocumentFromStreamOperation",null,[]);class sa{constructor(qc,Uc,ub,Xb){this.jjb=qc;this.gra=Uc;this.k2=ub;this.Pug=Xb}create(qc,Uc,ub){return new X(qc,Uc,ub,this.jjb,this.gra,this.k2,this.Pug)}}Object(b.a)(sa,"NewDocumentFromStreamOperationFactory",null,[871]);var da=a(82),S=a(518),oa=a(55);
class K{get name(){return"Common.App.NewAndOpen.UX"}Wh(qc){qc.register(sa,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").xc().Fc(()=>new sa(new d.a(()=>t.AFrameworkApplication.sa.Pa.Pfd()),new d.a(()=>t.AFrameworkApplication.cma),new d.a(()=>qc.Kh("Common.INewAndOpenCommonHelpers")),new d.a(()=>qc.Kh("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){t.AFrameworkApplication.fa.Dv(()=>{this.rzb()})}rzb(){const qc=
S.a.kr(da.a.instance.Ub("Common.INewAndOpenCommonHelpers")),Uc=S.a.kr(da.a.instance.Ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"));t.AFrameworkApplication.cma&&oa.Task.WAA.call(null,qc,Uc).continueWith(()=>{const ub=new C(new d.a(()=>qc.result),new d.a(()=>t.AFrameworkApplication.sa.Pa.Pfd()),new d.a(()=>Uc.result),new d.a(()=>t.AFrameworkApplication.sa.Pa.Qfd().yHa||"1959943459"),new d.a(()=>t.AFrameworkApplication.cma),new d.a(()=>t.AFrameworkApplication.aoi));ub.Hg();ub.UIb()});if(t.AFrameworkApplication.pQf){const ub=
S.a.kr(da.a.instance.Ub("Common.IEventEmitter<Common.IMruResult>"));oa.Task.WAA.call(null,qc,Uc,ub).continueWith(()=>{const Xb=new U(new d.a(()=>qc.result),new d.a(()=>I.jZi),new d.a(()=>t.AFrameworkApplication.sa.Pa.Qfd()),new d.a(()=>t.AFrameworkApplication.iZi),new d.a(()=>t.AFrameworkApplication.hZi),new d.a(()=>Uc.result),new d.a(()=>ub.result),t.AFrameworkApplication.fa);Xb.jcj();Xb.MRf()})}}dispose(){}}Object(b.a)(K,"UXPackageManager",null,[4,5,2]);var ea=a(1177),ya=a(1184),ha=a(1157),La=a(1193),
Ia=a(1185),ra;(function(qc){qc[qc.myFiles=0]="myFiles";qc[qc.recent=1]="recent";qc[qc.currentFolder=2]="currentFolder";qc[qc.yourPhone=3]="yourPhone"})(ra||(ra={}));Object(b.b)("SharedFilePickerLandingLocation",ra);class pa{constructor(qc){this.mMa=this.zbb=null;this._initialized=!1;this.Tld=qc}U2a(qc){this._initialized||(qc.so(J.a.SQf),qc.dm(J.a.SQf,Object(m.a)(this,this.uUi,"onReceivedPickerResponse")),this._initialized=!0)}Rfd(qc){return this.mMa=new Promise((Uc,ub)=>{const Xb={};Xb[D.a.j1i]=qc;
this.zbb=(wc,Tc)=>{""===Tc?(h.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Uc(wc)):("Canceled"===Tc?h.ULS.sendTraceTag(572548164,306,50,Tc):h.ULS.sendTraceTag(556901065,306,10,Tc),ub(Tc))};this.Tld.execute(wc=>{this.U2a(wc);wc.Pj(J.a.nZi,Xb)})})}uUi(qc){this.zbb(qc.Values[D.a.pqj],void 0===qc.Values[D.a.NFd]||null===qc.Values[D.a.NFd]?"":qc.Values[D.a.NFd])}tsd(){return t.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")}iHe(qc,Uc,ub,Xb,wc,Tc,sd){const qb={};qb[D.a.bqj]=
qc;qb[D.a.titleText]=Uc;qb[D.a.sOg]=ub;qb[D.a.tOg]=Xb;qb[D.a.uOg]=!1;qb[D.a.slh]=!0;qb[D.a.XDh]=wc;qb[D.a.n1i]=Tc;qb[D.a.m1i]=ra[sd];B.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(qb[D.a.o1i]="Dark");return qb}}Object(b.a)(pa,"SharedFilePickerManager",null,[422]);class ba{constructor(){this.gb=null}get name(){return"Common.App.SharedFilePicker"}Wh(qc){this.gb=qc;qc.register(pa,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").xc().Fc(()=>
new pa(qc.Ub("Postmessage.IHostPostmessenger")))}init(){t.AFrameworkApplication.fa.Dv(()=>{this.rzb()})}rzb(){this.gb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Fi(new ba)}}Object(b.a)(ba,"SharedFilePickerPackage",null,[4,5]);var fa=a(1288),Ka=a(835),aa=a(27);class ja{get name(){return"Common.App.WildFire"}joe(qc){let Uc=!1;qc&&(qc.P4c(),qc.AXg&&(Uc=!1));return Uc}p$g(){var qc=t.AFrameworkApplication.sa.Pa;qc=new fa.a(qc.Gj,Ka.a.Hdc(),!1,1===qc.B6);
this.joe(qc)&&h.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}$5b(qc,Uc,ub,Xb,wc,Tc){qc=new fa.a(qc,ub,Xb,Uc,wc,Tc);this.joe(qc)&&h.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}xfh(){const qc=t.AFrameworkApplication.sa.Pa;var Uc=t.AFrameworkApplication.fa;const ub=qc.Gj,Xb=1===qc.B6;if(Uc.qa(Ka.a.Z3h(ub))){var wc=Ka.a.Hdc(),Tc=8<aa.a.i6a;if(2!==ub||2!==wc||!Xb){Uc=Uc.qa(Ka.a.$3h(ub));var sd=qc.BZf(),qb=()=>qc.Ox;Uc&&!Ka.a.Nqd(Ka.a.Aed(ub))&&this.$5b(ub,Xb,wc,Tc,qb,sd)}}}init(){var qc=
t.AFrameworkApplication.fa;const Uc=qc.qa("WildFireChromeExtensionEnabled");qc=qc.qa("WildFireChromeExtensionBar")&&Uc;Ka.a.dzc&&qc&&!Ka.a.Nqd(Ka.a.FBe)?this.p$g():(document.body&&Ka.a.BCj&&this.xfh(),t.AFrameworkApplication.ub.Nb(G.a.Xud,O.a.frame,Object(m.a)(this,this.Xud,"launchWildFireBusinessBar")))}Xud(qc,Uc,ub,Xb,wc){if(1===ub)return 32;if(!wc)return 8;this.$5b(wc.app,wc.mode,wc.platform,wc.useTwoButton,null,null);return 32}dispose(){}Wh(){}static main(){e.a.instance.Fi(new ja)}}Object(b.a)(ja,
"PackageManager",null,[4,5]);var Va=a(1276);a(1063);var bb=a(9),wa=a(692),ka=a(50),ta=a(37),qa=a(183),rb=a(1);class Za{constructor(qc){this.Uh=qc}nc(){return!1}executeCommand(qc,Uc,ub){return 2!==this.Uh.ae(G.a.newDocument,2,ub)?oa.Task.Ta(!0):qa.a(Uc.command)}wc(qc,Uc){return 1056925771===Uc.command}Kc(qc,Uc,ub){qc=!0;switch(Uc){case "PopulateNewMenu":this.Uh&&(rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&t.AFrameworkApplication.Ip("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),
rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",!1)&&(t.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",t.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.Uh.ae(G.a.Lrc,2,ub));break;default:qc=!1}return qc}}Object(b.a)(Za,"CreateNewCommandHandler",null,[223]);class gb extends wa.a{constructor(qc){super(qc)}ld(){const qc=ka.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),Uc=ka.GetServiceTaskFactory.create(this.$.da,
165,this.la,this.Ya);ta.TaskExtensions.Aa(ta.TaskExtensions.Ed([qc,Uc],this.la),()=>{this.Yc([new Za(t.AFrameworkApplication.ub)])},this.la,3)}static ka(qc){wa.a.Nd(87,new gb(qc))}}Object(b.a)(gb,"CreateNewCommandHandlerFactory",wa.a,[]);var mb=a(1170),Ga=a(1065),ib=a(1212),cc=a(511),ic=a(101),xb=a(188),Vb=a(11),wb=a(22),cb=a(281),lb=a(992);class Y{}Y.create="Create";Y.activate="Activate";Y.close="Close";Y.remove="Delete";Y.duplicate="Duplicate";Object(b.a)(Y,"Actions",null,[]);var Oa=a(29),Wa=a(44);
class Ca extends oa.Task{constructor(qc){super();this.W2d=null;this.Y2d=0;this.$Rb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.LXa=this.LXa()}catch(Uc){this.dispose(),this.pBa(Uc),this._state=3}};this.au=qc;this.LXa=this.iFc;this.moveNext()}iFc(){this.W2d=Oa.a.Zc(3,2,0,1662,0,-1244327602,"MsFormDeleteConfirmation");this.$Rb=Wa.a(this.au.$).vj(this.W2d).G();this.$Rb.isCompleted||(this._state=2,this.$Rb.F$a(this.moveNext));return this.Vlg}Vlg(){this.Y2d=this.$Rb.WZ();
0===this.Y2d&&(this.au.$.workbookContext.Options=Vb.HelperMethods.JO(!1,this.au.$.workbookContext.Options,2048),this.au.deleteMsFormMetaDataSheet());this._state=3;this.cMb(!0)}dispose(){}}Object(b.a)(Ca,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",oa.Task,[2]);class Ra{}Ra.action="Action";Ra.jGh="FlexPane";Ra.Cac="formId";Ra.id="id";Ra.title="Title";Ra.kRb="XlWorkbookId";Ra.eIh="Fragment";Ra.host="Host";Ra.zPj="TopView";Ra.accountType="auth_pvr";Object(b.a)(Ra,
"Parameters",null,[]);var la=a(60);const ua=(qc,Uc,ub,Xb,wc,Tc,sd=null)=>{sd=qc.Na(9,sd);sd.sheetName=Uc;sd.confirmationChoice=!0;return la.g(qc,"DeleteSheet",sd,ub,Xb,wc,Tc,0)};class xa{constructor(qc){this.Co="Excel";this.$=qc;this.ZU=lb.a.current}get hasMsForm(){return ic.c(this.$.lg)}get Ymc(){return this.$.workbookContext.MsFormId}get gRb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return wb.a.contains(this.$.mv.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}nc(qc,
Uc){switch(Uc){case -105284469:return!ic.i(this.$.lg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(qc,Uc){qc=ta.TaskExtensions.Sj();Uc=Uc.command;switch(Uc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:qc=this.deleteMsForm();break;default:qc=qa.a(Uc)}return qc}wc(qc,Uc){if(!this.$.ea.Wg.get(61))return!1;
qc=!1;switch(Uc.command){case -105284469:qc=ic.i(this.$.lg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:qc=this.hasMsForm}return qc}Kc(){return!1}insertMsForm(){const qc=w.a.Rq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Uc={},ub={};Uc[Ra.action]=Y.create;Uc[Ra.accountType]=this.accountType;ub[Ra.action]=Y.create;ub[Ra.kRb]=encodeURIComponent(this.gRb);ub[Ra.host]=this.Co;ub[Ra.title]=encodeURIComponent(qc);this.XDb(Uc,ub);this.$.workbookContext.Options=
Vb.HelperMethods.JO(!1,this.$.workbookContext.Options,2048)}editMsForm(){const qc={},Uc={};qc[Ra.accountType]=this.accountType;Uc[Ra.Cac]=this.Ymc;Uc[Ra.kRb]=encodeURIComponent(this.gRb);Uc[Ra.host]=this.Co;this.XDb(qc,Uc)}previewMsForm(){const qc={},Uc={};qc[Ra.accountType]=this.accountType;Uc[Ra.Cac]=this.Ymc;Uc[Ra.kRb]=encodeURIComponent(this.gRb);Uc[Ra.host]=this.Co;Uc[Ra.zPj]="Preview";this.XDb(qc,Uc)}sendMsForm(){const qc={},Uc={};qc[Ra.accountType]=this.accountType;Uc[Ra.Cac]=this.Ymc;Uc[Ra.jGh]=
"SendForm";Uc[Ra.kRb]=encodeURIComponent(this.gRb);Uc[Ra.host]=this.Co;this.XDb(qc,Uc)}deleteMsForm(){return new Ca(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.kD(new xb.a(158,0,(qc,Uc,ub)=>ua(this.$.pa.Uw,this.ZU.Gvb,cb.b(qc,()=>{this.Iih()}),Uc,ub,null)))}Iih(){const qc={},Uc={};qc[Ra.action]=Y.remove;qc[Ra.accountType]=this.accountType;Uc[Ra.action]=Y.remove;Uc[Ra.host]=this.Co;Uc[Ra.Cac]=encodeURIComponent(this.Ymc);Uc[Ra.kRb]=encodeURIComponent(this.gRb);this.XDb(qc,Uc)}XDb(qc,
Uc){const ub=this.$.va.MsFormBaseUrl+"/Pages/DesignPage.aspx";let Xb="";var wc="";if(Uc){for(let qb in Uc){var Tc=qb,sd=Uc[qb];wc+=wc.length?"&":"";wc+=Tc+"="+sd}qc||(qc={});qc[Ra.eIh]=encodeURIComponent(wc)}if(qc)for(let qb in qc)Uc=qb,wc=qc[qb],Xb+=Xb.length?"&":"?",Xb+=Uc+"="+wc;window.open(ub+Xb,"_blank")}}Object(b.a)(xa,"MsFormCommandHandler",null,[223]);class fb extends wa.a{constructor(qc){super(qc)}ld(){const qc=ka.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Ya);ta.TaskExtensions.Aa(ta.TaskExtensions.Ed([qc],
this.la),()=>{this.Yc([new xa(this.$)])},this.la,3)}static ka(qc){qc.ea.Wg.get(61)&&wa.a.Nd(215,new fb(qc))}}Object(b.a)(fb,"MsFormCommandHandlerFactory",wa.a,[]);var Jb=a(222);class Ob extends Jb.a{constructor(qc){super();this.$=qc;this.Fb()}create(){ta.TaskExtensions.Aa(ka.GetServiceTaskFactory.create(this.$.da,164,this.la,this.Ya),()=>{this.ob(new K)},this.la,3)}}Object(b.a)(Ob,"NewAndOpenUXFactory",Jb.a,[]);class eb{constructor(qc,Uc){this.Uh=Uc;this.$=qc}executeCommand(qc,Uc,ub){qc=2;switch(Uc.command){case G.a.openUrlInNewTab:qc=
this.Uh.ae(G.a.openUrlInNewTab,2,ub);break;case G.a.UPa:qc=this.Uh.ae(G.a.UPa,2,ub)}return 2!==qc?oa.Task.Ta(!0):qa.a(Uc.command)}wc(qc,Uc){return Uc.command===G.a.openUrlInNewTab||Uc.command===G.a.UPa}Kc(qc,Uc,ub){return"PopulateMruMenu"===Uc?(this.Uh.ae(G.a.Krc,2,ub),!0):!1}nc(){return!1}}Object(b.a)(eb,"OpenFromMruCommandHandler",null,[223]);class Ma extends wa.a{constructor(qc){super(qc)}ld(){const qc=ka.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),Uc=ka.GetServiceTaskFactory.create(this.$.da,
165,this.la,this.Ya);ta.TaskExtensions.Aa(ta.TaskExtensions.Ed([qc,Uc],this.la),()=>{this.Yc([new eb(this.$,t.AFrameworkApplication.ub)])},this.la,3)}static ka(qc){wa.a.Nd(88,new Ma(qc))}}Object(b.a)(Ma,"OpenFromMruCommandHandlerFactory",wa.a,[]);var va=a(1147),Pa=a(1186),Ha=a(1226),tb=a(1068),Ya=a(1166),V=a(1069),za=a(1070),yb=a(1171),jc=a(1213),Cc=a(1214),Sa=a(83),na=a(371),jb=a(99),Ib=a(21),dc=a(372);class ob{constructor(qc,Uc){this.sheetName=null;this.value=!1;this.sheetName=qc;this.value=Uc}getSheetName(){return this.sheetName}qwa(){return this.value}}
Object(b.a)(ob,"MacroRecorderSheetOptionToggledPayload",null,[137]);const Fa=(qc,Uc,ub,Xb,wc,Tc,sd,qb=null)=>{qb=qc.Na(9,qb);qb.sheetName=Uc;qb.show=ub;return la.g(qc,"ShowGridlines",qb,Xb,wc,Tc,sd,0)},Ab=(qc,Uc,ub,Xb,wc,Tc,sd,qb=null)=>{qb=qc.Na(9,qb);qb.sheetName=Uc;qb.show=ub;return la.g(qc,"ShowHeadings",qb,Xb,wc,Tc,sd,0)},$b=(qc,Uc,ub,Xb,wc,Tc,sd,qb=null)=>{qb=qc.Na(9,qb);qb.sheetName=Uc;qb.directionRtl=ub;return la.g(qc,"ChangeSheetDirection",qb,Xb,wc,Tc,sd,0)};class Cb{constructor(qc){this.$=
qc}nc(){return!1}executeCommand(qc,Uc){const ub={};this.$.pk(ub);qc=Uc.command;const Xb=Object(Sa.a)(jb.a,this.$.xa.getItemByName(ub.SheetName));if(!Xb)return qa.a(qc);let wc,Tc,sd,qb,Sb;switch(qc){case 705559150:case -1411193626:wc=16;Tc=!Xb.hideGridLines;sd=Fa;Sb=183;qb=Xb.hideGridLines;break;case -2052321504:case 515737500:wc=4;Tc=!Xb.headersVisible;sd=Ab;Sb=184;qb=!Xb.headersVisible;break;case -1478455630:wc=2;Tc=!Xb.displayRtl;sd=$b;Sb=185;qb=!Xb.displayRtl;Ib.h(this.$).Ea.XUj(Tc);break;default:return qa.a(qc)}Xb.Yqb(wc,
Tc);const mc=()=>new ob(ub.SheetName,qb),Lc=this.$.pa.ya;return na.a(this.$.userOperationManager,(rd,Z,db)=>sd(Lc,ub.SheetName,qb,cb.b(rd,Lb=>{Cb.BGb(Lb,Xb,wc,Tc)}),cb.a(Z,()=>{Cb.OFb(Xb,wc,Tc)}),db,null),rd=>new xb.a(Sb,0,rd,void 0,mc),Uc)}wc(qc,Uc){qc=!1;switch(Uc.command){case -1411193626:case 515737500:case -1478455630:qc=!0;break;case 705559150:case -2052321504:qc=dc.a(this.$)}return qc}Kc(){return!1}static BGb(qc,Uc,ub,Xb){Oa.a.Nq(qc.Errors)&&Uc.Yqb(ub,!Xb)}static OFb(qc,Uc,ub){qc.Yqb(Uc,!ub)}}
Object(b.a)(Cb,"SheetOptionsToggleCommandHandler",null,[223]);class Rb extends wa.a{constructor(qc){super(qc)}ld(){this.Yc([new Cb(this.$)])}static ka(qc){wa.a.Nd(100,new Rb(qc))}}Object(b.a)(Rb,"SheetOptionsToggleCommandHandlerFactory",wa.a,[]);var uc=a(170),nb=a(178),Fb=a(148),Jc=a(64),Fc=a(59),zb=a(207),hb=a(587),Pb=a(91),ud=a(250),Ub=a(210),Ac=a(12);class Ic extends Ub.a{constructor(qc,Uc,ub,Xb=null){super(qc,ub,2,Xb);this.uLc=null;this.onResize=()=>{const wc=this.rUh();this.oMa.setAttribute("width",
wc.x.toString());this.oMa.setAttribute("height",wc.y.toString());this.JVj(wc);this.NCd()};this.lKe=Uc;this.$.PA(this.onResize);this.Wec()}get oMa(){return this.uLc}initialize(){const qc=this.$.Eb+"iframeDialog_frame",Uc=this.$.Eb+"iframeDialog";this.Mb.style.margin=Vb.HelperMethods.uc(0);this.Mb.style.marginBottom=Vb.HelperMethods.uc(-2);if(rb.EwaSettings.isChangeGateEnabled("OfficeVSO:7111358_IFrameDialogReduceInnerHtml")){var ub=document.createElement("iframe");ub.id=qc;ub.frameBorder="0";ub.scrolling=
"auto";ub.src=this.fgd(Uc);this.Mb.appendChild(ub)}else ub=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',qc,this.fgd(Uc)),this.Mb.innerHTML=ub;this.uLc=document.getElementById(qc);this.domElement.id=Uc;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.YD(this.onResize);super.dispose()}setFocus(){Ac.DOMElementExtensions.setFocus(this.oMa)}onHide(){this.oMa.contentWindow.close();Ac.DOMElementExtensions.uf(this.oMa);this.uLc=
null;super.onHide()}JVj(qc){const Uc=this.domElement.style;Uc.width=Vb.HelperMethods.uc(qc.x);Uc.marginLeft=Vb.HelperMethods.uc(-qc.x/2)}rUh(){const qc=Ac.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*qc.width),this.lKe.x),Math.min(Math.floor(.9*qc.height),this.lKe.y))}}Object(b.a)(Ic,"IFrameDialog",Ub.a,[]);var dd=a(5),Ud=a(74),Hd=a(13);class me extends Ic{constructor(qc){super(qc,new Sys.UI.Point(960,680),Hd.a.instance.ga(1260));this.name=dd.a.lOe}get pc(){return"EmbeddingDialog"}fgd(qc){const Uc=
new Sys.StringBuilder(this.$.va.EmbedConfiguratorUrl);zb.a.Zk(Uc,dd.a.wsh,qc);Ud.a(this.$.va,33)&&zb.a.Zk(Uc,dd.a.tQe,"1");Ud.a(this.$.va,34)&&zb.a.Zk(Uc,dd.a.vQe,"1");Ud.a(this.$.va,35)&&zb.a.Zk(Uc,dd.a.uQe,"1");return Uc.toString()}onShow(){h.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(b.a)(me,"EmbeddingDialog",Ic,[]);var xe=a(1240),Ke=a(87),vd=a(80),Qe=a(821);class bc{}bc.n5f="FrameDialog_ShareFromEdit";bc.view="FrameDialog_View";
bc.MCe="FrameDialog_CloseAndRefresh";bc.pzj="FrameDialog_ShareFromView";bc.edit="FrameDialog_Edit";bc.zaj="FrameDialog_RefreshGrid";bc.z3g="FrameDialog_CloseMe";bc.WCe="FrameDialog_CloseMeError";bc.ready="FrameDialog_Ready";bc.Q1i="FrameDialog_PleaseClose";bc.xK="GotoRange";Object(b.a)(bc,"PostMessageConstants",null,[]);var Zc=a(283),gd=a(116),Sc=a(282);class Gd{constructor(){this.xK=null;this.rGd=1461300262}}Object(b.a)(Gd,"SessionUpdateContext",null,[]);class Vd extends Ic{constructor(qc,Uc,ub){super(qc,
new Sys.UI.Point(Vd.gih,Vd.Ghh),Hd.a.instance.ga(Uc?1265:1264));this.N1a=null;this.KMc=!1;this.kqc=Xb=>{const wc=this.$,Tc=new Gd;Tc.xK=Xb.Values[bc.xK];let sd=!1;switch(Xb.MessageId){case bc.n5f:this.rv();sd=!0;Tc.rGd=1334518759;break;case bc.view:this.Moa=Hd.a.instance.ga(1265);this.tig(!0);break;case bc.MCe:this.rv(),sd=!0}Xb=new xb.a(140,0,(qb,Sb,mc)=>Zc.n(wc.pa.ya,cb.b(qb,this.KVi),Sb,mc,Tc));Xb.flags=sd?16:80;wc.userOperationManager.Ic(Xb,this.Wd)};this.zNi=()=>{const Xb=this.$;Xb.va.SurveyRedirectUrl?
(this.rv(),Xb.Xc(1305810481,0,8,null)):(this.Moa=Hd.a.instance.ga(1264),this.tig(!1))};this.YVi=()=>{const Xb=this.$;this.rv();Xb.Xc(1334518759,0,8,null)};this.roc=Xb=>{const wc=this.$;this.rv();Xb.MessageId===bc.WCe&&wc.ea.bdd()};this.qUi=()=>{this.KMc=!0;this.raiseEvent(Vd.hvd)};this.KVi=(Xb,wc)=>{if(!Sc.a(Xb)){Xb=this.$;if(wc.xK){const Tc=Xb.ea.xa;if(Tc.contains(wc.xK.SheetName))this.cpc(wc);else{let sd=null;sd=()=>{Tc.rna(sd);this.cpc(wc)};Tc.eha(sd)}}1461300262!==wc.rGd&&Xb.Xc(wc.rGd,0,8,null)}};
this.Ibe=Uc;this.Wd=ub}XKg(qc){this.addHandler(Vd.hvd,qc)}dgj(qc){this.removeHandler(Vd.hvd,qc)}get pc(){return"FormDialog"}get Kif(){return this.KMc}get S7a(){return this.Ibe}dispose(){Ke.a.Ia(this.N1a);this.N1a=null;super.dispose()}initialize(){super.initialize();const qc=vd.a.eba(this.$.va.FormLightBoxUrl),Uc=this.N1a=new xe.a(this.oMa.contentWindow,qc);Uc.isEnabled()&&Uc.tGa(qc)&&(this.ina(bc.n5f,this.kqc),this.ina(bc.view,this.kqc),this.ina(bc.MCe,this.kqc),this.ina(bc.pzj,this.YVi),this.ina(bc.edit,
this.zNi),this.ina(bc.zaj,this.kqc),this.ina(bc.ready,this.qUi),this.ina(bc.z3g,this.roc),this.ina(bc.WCe,this.roc))}close(qc){qc===this.LM&&this.Kif&&this.N1a.send(new Qe.a(bc.Q1i))||super.close(qc)}fgd(){return this.gHe(this.S7a)}gHe(qc){const Uc=this.$.va,ub=new Sys.StringBuilder(Uc.FormLightBoxUrl);zb.a.Zk(ub,dd.a.NHh,this.$.ea.sessionId);zb.a.Zk(ub,dd.a.LHh,qc?dd.a.MHh:dd.a.KHh);gd.a.Uob(ub,Uc);return ub.toString()}tig(qc){this.KMc=!1;this.oMa.src=this.gHe(qc);this.Ibe=qc}ina(qc,Uc){this.N1a.so(qc);
this.N1a.dm(qc,Uc)}cpc(qc){const Uc=this.$.ea.xa.getItemByName(qc.xK.SheetName);Uc&&0===Uc.TB&&Ib.h(this.$).Bg(qc.xK,null,null,null,20,"FormDialog.OnItemInserted")}}Vd.gih=900;Vd.Ghh=1200;Vd.hvd="lightBoxReady";Object(b.a)(Vd,"FormDialog",Ic,[309]);var Ed;(function(qc){qc[qc.comment=10]="comment";qc[qc.range=12]="range";qc[qc.table=13]="table";qc[qc.chart=14]="chart";qc[qc.sheet=15]="sheet"})(Ed||(Ed={}));Object(b.b)("NavigationType",Ed);var Od=a(975),se=a(108),Le=a(19),Id=a(557),fe=a(941),Yd=a(285),
Ce=a(752),ye=a(53);class Ae extends Ce.a{constructor(qc,Uc,ub,Xb,wc,Tc=0,sd){super(qc,Hd.a.instance.ga(Uc),!1);this.htmlSanitizationHelper=null;this.message=ub;this.vJi=Xb;this.m2d=wc;this.operationFlags=Tc;this.htmlSanitizationHelper=sd}get pc(){return"WebMethodConfirmationDialog"}get cC(){return 1005}get kIa(){return this.operationFlags}initialize(){let qc="<div class='"+se.a.zo+"'>\r\n\t<div class='"+se.a.LQe+"'>\r\n\t\t<div class='"+Le.a.DCe+"'>\r\n\t\t\t<img src='{0}' class='"+Le.a.HTe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+
se.a.NQe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";qc=String.format(qc,ye.a.we(13),Hd.a.instance.ga(25),Hd.a.instance.ga(this.message));this.htmlSanitizationHelper&&rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&rb.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?this.htmlSanitizationHelper.dk(this.Mb,qc):this.Mb.innerHTML=qc;this.addButton(0,this.vJi);this.addButton(1);super.initialize()}nH(){return this.m2d}}Object(b.a)(Ae,"WebMethodConfirmationDialog",
Ce.a,[]);class He extends Od.a{constructor(qc,Uc){super(qc,Hd.a.instance.ga(1267));this.htmlSanitizationHelper=this.JUa=this.iSa=this.textBox=null;this.sIf=()=>{const ub=this.$;this.rv();const Xb=new Ae(ub,1270,1271,1272,(wc,Tc,sd)=>{var qb=ub.pa.ya.Wb(),Sb=ub.pa.ya;qb=Sb.Na(1,qb);return la.g(Sb,"UnshareForm",qb,wc,Tc,sd,null,0)},16,this.htmlSanitizationHelper);Xb.initialize();Xb.vg()};this.htmlSanitizationHelper=Uc}get pc(){return"ShareFormDialog"}dispose(){this.JUa&&this.JUa.Hda(this.sIf);Ke.a.qc([this.textBox,
this.iSa,this.JUa]);this.JUa=this.iSa=this.textBox=null;super.dispose()}initialize(){let qc="<div class='"+se.a.zo+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+se.a.i3a+"'>\r\n\t<input type='text' id='{1}' class='"+se.a.oF+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";qc=String.format(qc,Hd.a.instance.ga(1268),"sfd_input","sfd_unshare",Le.a.Ao,Hd.a.instance.ga(1269));this.htmlSanitizationHelper&&rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
rb.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?this.htmlSanitizationHelper.dk(this.Mb,qc):this.Mb.innerHTML=qc;this.textBox=new Yd.a(this.getElementById("sfd_input"));this.iSa=new fe.a(this.textBox.domElement);this.JUa=Id.a.create(this.getElementById("sfd_unshare"));this.JUa.O2(this.sIf);this.textBox.text=Hd.a.instance.ga(736);this.textBox.enabled=!1;this.textBox.readOnly=!aa.a.Yg;this.addButton(1,10);super.initialize()}c0a(){return(qc,Uc,ub)=>{var Xb=this.$.pa.ya.Wb(),
wc=this.$.pa.ya;qc=this.B4a(qc);Uc=this.PKa(Uc);Xb=wc.Na(1,Xb);return la.g(wc,"ShareForm",Xb,qc,Uc,ub,null,0)}}d0(qc,Uc,ub){this.textBox.text=qc.Result;this.textBox.enabled=!0;Ac.DOMElementExtensions.setVisible(this.JUa.domElement,!0);super.d0(qc,Uc,ub)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(qc){}super.setFocus()}}Object(b.a)(He,"ShareFormDialog",Od.a,[]);var gf=a(246),Xe=a(6),$a=a(81),ac=a(253),Da=a(69),Na=a(621),sb=a(140),Kb=a(424),Yb=a(255),vc=a(17),
ad=a(252);class ld extends nb.a{constructor(qc,Uc,ub){super();this.tze=this.uze=!1;this.y3a=0;this.bja=!1;this.RKi=()=>{this.uze=!0;this.o7f()};this.$=qc;this.Va=Uc;this.sK=ub;Da.a(this.$).$Jd(new sb.a(Xe.a.pgg,Xe.a.idle,ld.l0g),new gf.a(Xe.a.UCe,Xe.a.X_,null,Xe.a.gP,Xe.a.idle))}get XEc(){return ic.b(this.$.lg)}get NOd(){return this.$.isEditMode&&(this.$.ea.Wnh||this.$.wN)}nc(qc,Uc){switch(Uc){case 353606613:case -1099009678:case 192430811:return!rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||this.X5f();case 783415632:return!rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.X5f();case 869186573:return this.Y5f();case -1570751769:case 1986648902:return 131072!==(this.$.WU&131072);case 330035228:return!(this.X3a(!0)&&this.XEc);case -509039657:return!(this.X3a()&&this.XEc);case 1334518759:return!(this.X3a()&&this.XEc&&this.Fze())}return!1}X5f(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.Y5f()}Y5f(){const qc=this.$.workbookContext.FullDocumentInfo,
Uc=Yb.a()&&this.$.ea.Wg.get(5);return!qc.FileSharingUrl&&!Uc}executeCommand(qc,Uc,ub){qc=this.$.workbookContext.FullDocumentInfo;var Xb=G.a.workflow,wc=ta.TaskExtensions.Sj();const Tc=Uc.command;if(Tc===Xb||-266099===Tc)return this.B8h(Uc,Xb,qc);switch(Tc){case 1986648902:this.C4f();break;case -1570751769:this.j6h(Uc);break;case 869186573:Uc=G.a.ozj;wc=t.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");Xb=null;(rb.EwaSettings.ma(545)||wc)&&ub&&"CopyLink"===ub.SourceControlId?(Xb={},Xb[D.a.LMb]="copy",
Uc=G.a.m5f):wc&&ub&&"ManageAccess"===ub.SourceControlId?(Xb={},Xb[D.a.LMb]="manageAccess",Uc=G.a.qzj):ub&&"LinkToComment"===ub.SourceControlId&&(Xb={},Xb[D.a.LMb]="copy",Xb[D.a.sSd]=ub.navId,Uc=G.a.m5f);wc=this.w8f(qc,Xb);v.c(Uc);break;case -1099009678:wc=this.pyc(12,qc);break;case 192430811:wc=this.pyc(13,qc);break;case 353606613:wc=this.pyc(14,qc);break;case 783415632:ub&&"LinkToThisSheet"===ub.SourceControlId&&h.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");
wc=this.pyc(15,qc);break;case -59906385:case 1197060601:this.P7h(Uc,qc);break;case 1305810481:this.r9e(!1,Uc);break;case 330035228:this.r9e(!0,Uc);break;case -509039657:rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&rb.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?ta.TaskExtensions.Aa(ka.GetServiceTaskFactory.Oa(this.$.da,498,499,0),sd=>{this.deleteForm(sd.result)},this.$.la,3):this.deleteForm(null);break;case 1334518759:Uc.pAb=
!0;rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&rb.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?ta.TaskExtensions.Aa(ka.GetServiceTaskFactory.Oa(this.$.da,498,499,0),sd=>{this.shareForm(sd.result)},this.$.la,3):this.shareForm(null);break;case 710925581:Fc.a.zg.Jyc("710925581")&&(wc=ta.TaskExtensions.Aa(this.sK.value,sd=>{sd.result.Pj(J.a.conversation,{})},this.la,3));break;case 327119921:this.X5h();break;default:wc=qa.a(Tc)}return wc}wc(qc,
Uc){qc=!1;Uc=Uc.command;if(Uc===G.a.workflow)return!0;switch(Uc){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:qc=!0;break;case 353606613:case -1099009678:case 192430811:qc=rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:qc=rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",
!1)&&!this.$.ea.isNamedObjectViewMode}return qc}Kc(qc,Uc,ub){if("PopulateFormMenu"===Uc){Uc=this.XEc?this.Fze()?ld.dCh:ld.eCh:ld.jHi;qc=this.Va.Ec();for(let Xb=0;Xb<Uc.length;Xb++)qc.buttons.push(this.Va.pb(Uc[Xb]));Uc=this.Va.aq("Forms.Flyout");Uc.tc.push(qc);ub.MenuItems=Uc.JC();return!0}return!1}B8h(qc,Uc,ub){return this.NOd&&qc.command===Uc?(this.LOd(qc,-266099),ta.TaskExtensions.jba()):ta.TaskExtensions.Aa(this.sK.value,Xb=>{hb.a(Xb.result,J.a.workflow,null,ub.WorkflowPostMessage)||Vb.HelperMethods.lf(ub.WorkflowUrl,
"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)}Fze(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Wg.get(26)}X5h(){var qc=uc.a.create().toString();h.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${qc}`);var Uc=this.$.frame,ub=Uc.d$a,Xb=this.$;const wc=new ad.QueryStringBuilder(t.AFrameworkApplication.fa.Xa("TeamsMeetingShareEndpoint"));wc.Yi("deeplinkId",qc);wc.Yi("lm","deeplink");qc=wc.Yi;var Tc={};const sd=new ad.QueryStringBuilder(t.AFrameworkApplication.fa.Xa("TeamsAppSharingUrl"));
sd.Yi("auth","2");sd.Yi("flight","officeunihost");sd.Yi("source","TEAMS-ELECTRON.meetingStage.deeplink");var qb={};qb.fileType=w.a.D4(Xb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);qb.objectUrl=Xb.workbookContext.FullDocumentInfo.WorkbookPath;qb.baseUrl=Xb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{Xb=Xb.workbookContext.WorkbookFileVersionId;let Sb=decodeURIComponent(Xb);for(;Xb!=Sb;)Xb=Sb,Sb=decodeURIComponent(Xb);0>Xb.indexOf("{")||0>Xb.indexOf("}")?(h.ULS.sendTraceTag(528250338,
306,15,`Decoded fileId does not match expected format. Decoded id: ${Xb}`),Xb=""):Xb=Xb.substring(Xb.indexOf("{")+1,Xb.indexOf("}")).toLowerCase()}qb.fileId=Xb;qb=Q.c(Q.c(qb));sd.Yi("subEntityId",qb.substring(1,qb.length-1));Tc.appSharingUrl=sd.toString();Tc.appId=t.AFrameworkApplication.fa.Xa("TeamsAppId");Tc=JSON.stringify(Tc);qc.call(wc,"appContext",Tc);ub.call(Uc,wc.toString(),!0)}j6h(qc){this.NOd?this.LOd(qc,1986648902):this.C4f()}r9e(qc,Uc){!qc&&this.$.va.SurveyRedirectUrl?this.a6i():(qc=new Vd(this.$,
qc,Uc),qc.initialize(),qc.vg())}P7h(qc,Uc){this.NOd&&1197060601===qc.command?this.LOd(qc,-59906385):ta.TaskExtensions.Aa(this.sK.value,ub=>{ub=ub.result;ub&&hb.a(ub,J.a.replyWithChanges,null,this.$.ea.Wg.get(8))||(ub=new Sys.StringBuilder(Uc.ReplyWithChangesUrl),zb.a.Zk(ub,Kb.e,Kb.d),Fb.a.ntw(ub.toString(),this.$))},this.la,3)}LOd(qc,Uc){const ub=Da.a(this.$).hd.activityState,Xb=new Pb.a(Uc,qc.method,qc.mode,qc.$e,qc.tabName);Wa.a(this.$).Js(new ud.a(Xe.a.ey,5,()=>{ub[ac.a.Jq]=Xe.a.CZf;ub[Na.a.mVc]=
Xb;this.$.hl.hz("SocialSharingSaveBeforeCommand");this.$.hl.lpe(Xb.command)}))}C4f(){const qc=this.$.va.DocumentHostInfo;qc.HostEmbeddedViewUrl||this.uze?this.o7f():this.$.ie.get(53)&&ta.TaskExtensions.Aa(this.sK.value,Uc=>{this.wSj(Uc.result)||Fb.a.ntw(qc.FileEmbedCommandUrl,this.$)},this.la,3)}wSj(qc){return qc.isEnabled()&&(this.tze||(this.tze=qc.dm(J.a.sze,this.RKi)))?qc.Pj(J.a.ADh,null):!1}o7f(){if(aa.a.Dp)Fb.a.ntw(this.$.va.EmbedConfiguratorUrl,this.$);else{const qc=new me(this.$);qc.initialize();
qc.vg()}}deleteForm(qc){const Uc=this.$;qc=new Ae(Uc,1273,1274,1266,(ub,Xb,wc)=>{var Tc=Uc.pa.ya.Wb(),sd=Uc.pa.ya;Tc=sd.Na(9,Tc);Tc.surveyId=null;return la.g(sd,"DeleteSurvey",Tc,ub,Xb,wc,null,0)},0,qc);qc.initialize();qc.vg()}shareForm(qc){const Uc=this.$.workbookContext.FullDocumentInfo;this.$.ea.Wg.get(26)?(qc=new He(this.$,qc),qc.initialize(),qc.vg()):ta.TaskExtensions.Aa(this.sK.value,ub=>{hb.a(ub.result,J.a.shareForm,{[D.a.BLj]:this.$.workbookContext.SurveyTitle},this.$.ea.Wg.get(10))||Fb.a.ntw(Uc.ShareFormCommandUrl,
this.$)},this.la,3)}a6i(){const qc=this.$;qc.va.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const Uc=new Sys.StringBuilder(qc.va.SurveyRedirectUrl);zb.a.Zk(Uc,"startupDialog","FormEdit");const ub=Da.a(this.$),Xb=ub.hd.activityState;Xb[$a.a.E2]=Uc.toString();Xb[$a.a.rM]=$a.a.Hzd;this.$.hl.hz("SocialSharingEnvironmentChange");Wa.a(qc).Js(new ud.a(Xe.a.ey,5,()=>{const wc=Oa.a.Zc(3,2,1318,1319,1320,554412057,"FossEnvironmentUnsupported");ub.hd.rr([wc]);Xb[ac.a.Jq]=
Xe.a.pgg}))}X3a(qc=!1){return(this.$.ea.isEditMode||qc)&&this.$.ea.Wg.get(25)&&Yb.a()}B0h(qc){var Uc=Ib.h(this.$).ha;const ub=this.$.xa.oa?Jc.d(this.$.xa.oa):null;if(!ub)return h.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${Ed[qc]}.`),null;var Xb=null;14===qc?Xb=this.b0h(Uc):12===qc?(Xb=Uc.yia,Xb=wb.a.contains(Xb,"!",!0)?Xb.split("!")[1]:Xb):13===qc&&(Uc=Uc.ra.selectedRanges,Uc[0]&&(Uc=Ib.h(this.$).Bb.Bj(Uc[0])))&&(Xb=
Uc.nj);if(!Xb&&15!==qc)return h.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${Ed[qc]}`),null;Uc={};Uc[D.a.LMb]="copy";Uc[D.a.sSd]=this.ORh(qc,Xb,ub);Uc[D.a.rzj]="deepLinkShare";h.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${Ed[qc]} and sectionNameOrId: ${Xb} and SheetId: ${ub}`);return Uc}b0h(qc){if(qc.Sa.p_&&(qc=
qc.Sa.$b.floatingObject)&&0===qc.type){const Uc=qc.id.split(".");if(1<Uc.length)return Uc[1];h.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${qc.id}`)}return null}ORh(qc,Uc,ub){let Xb=qc+"_";Xb=btoa(15===qc?Xb+ub:Xb+(Uc+"_"+ub));Xb=Xb.replace(RegExp("\\+","g"),"-");Xb=Xb.replace(RegExp("\\/","g"),"_");return Xb=Xb.replace(RegExp("\\=+$","g"),"")}w8f(qc,Uc,ub=!1){return ta.TaskExtensions.Aa(this.sK.value,Xb=>{hb.a(Xb.result,
J.a.sharing,Uc,this.$.ea.Wg.get(5))?(h.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${Uc?Uc[D.a.LMb]:""}`),ub&&rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&!this.bja&&(this.y3a=window.setInterval(()=>{this.yQj()},6E4),this.bja=!0)):Vb.HelperMethods.lf(qc.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},
this.la,3)}pyc(qc,Uc){if(15===qc&&!rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==qc&&!rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;const ub=this.B0h(qc);if(ub)return h.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${ub[D.a.sSd]}`),this.w8f(Uc,ub,!0);h.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${Ed[qc]}`);
return null}yQj(){this.bja&&window.clearInterval(this.y3a);rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&(this.$.Xc(638984051,0,0,null),h.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}ld.jHi=[103];ld.dCh=[107,104,105,106];ld.eCh=[104,105];ld.l0g=[new vc.a(Xe.a.UCe,554412057,0,0,1321),new vc.a(Xe.a.idle,554412057,0,1)];Object(b.a)(ld,"SocialSharingCommandHandler",nb.a,[223]);class md extends wa.a{constructor(qc){super(qc)}ld(){const qc=
new d.a(()=>ka.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Ya));ta.TaskExtensions.Aa(ka.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya),Uc=>{this.Yc([new ld(this.$,Uc.result,qc)])},this.la,3)}static ka(qc){wa.a.Nd(114,new md(qc))}}Object(b.a)(md,"SocialSharingCommandHandlerFactory",wa.a,[]);var Qd=a(1153);class ce{constructor(qc){this.Uh=qc}executeCommand(qc,Uc,ub){return 2!==this.Uh.ae(G.a.tryOfficeThroughTellMe,2,ub)?oa.Task.Ta(!0):qa.a(Uc.command)}wc(qc,Uc){return 215809929===
Uc.command}Kc(){return!1}nc(){return!1}}Object(b.a)(ce,"TryOfficeThroughTellMeCommandHandler",null,[223]);class ec extends wa.a{constructor(qc){super(qc)}ld(){this.Yc([new ce(t.AFrameworkApplication.ub)])}static ka(qc){wa.a.Nd(207,new ec(qc))}}Object(b.a)(ec,"TryOfficeThroughTellMeCommandHandlerFactory",wa.a,[]);var Vc=a(157),td=a(76),he=a(153),ne=a(261),Te=a(146),Me=a(185);class Ye{static gN(){return Te.a.gq(Ye.ol,Me.a.Ua(442))}}Ye.ol="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(b.a)(Ye,"NamedSheetViewTeachingDialogHtml",null,[]);var pf=a(51);class Be extends ne.a{constructor(qc){super(qc);this.stopwatch=this.pp=null;this.sGi=Uc=>{if(1===Uc)this.$.Ja.Kb(new Pb.a(-2050946363,td.a.Db,2,8,null)).continueWith(ub=>{this.pp.setResult(!he.a(ub)&&ub.result)}),Uc="Yes";else{const ub=2===Uc;this.pp.setResult(ub);Uc=2===Uc?"No":"Close";ub&&this.A4i()}this.Czi(Uc);this.hide()}}get pc(){return"ShowNamedSheetViewTeachingDialog"}gg(){this.Rb=4;this.stopwatch=this.$.Jb.Ac("UserAction",
this.pc);const qc=Hd.a.instance.ga(1904);this.qg=Ye.gN();this.pp=new Vc.a;this.initializeAndShow(qc,this.sGi,{});return this.pp.task}Ov(qc){super.Ov(qc);this.oc(1,Hd.a.instance.ga(1906));this.oc(2,Hd.a.instance.Ua(455))}A4i(){this.$.ea.fnc=!1}Czi(qc){const Uc={};Uc.a=this.$.va.UserSessionId;Uc.b="NamedSheetViewTeachingDialogClose";Uc.c=qc;Uc.e=!0;this.stopwatch&&(this.stopwatch.stop(),Uc.d=this.stopwatch.zc);pf.b().Qe(53,Uc,!0)}}Object(b.a)(Be,"NamedSheetViewTeachingDialog",ne.a,[]);var Ie=a(155);
class Hf{constructor(qc){this.$=qc;qc.da.Ga(309,this)}mTa(){if(this.kCj()){if(rb.EwaSettings.ma(569)){this.$.xa.oa.Gd.MTd=!0;const qc=new Vc.a;this.$.Ja.Kb(new Pb.a(-2050946363,td.a.Db,2,0,null)).continueWith(Uc=>{qc.setResult(!he.a(Uc)&&Uc.result)});return qc.task}return(new Be(this.$)).gg()}return oa.Task.Ta(!0)}kCj(){const qc=this.$.xa.oa;return this.$.ea.q$a&&this.$.ea.fnc&&!qc.Gd.Gv&&this.$.ea.WM&&!Ie.g(this.$)}}Object(b.a)(Hf,"NamedSheetViewPublic",null,[667]);class Ne extends Jb.a{constructor(qc){super();
this.$=qc;this.Fb()}create(){this.ob(this.$.da.za(309)||new Hf(this.$))}static ka(qc){qc.da.Ga(310,new Ne(qc))}}Object(b.a)(Ne,"NamedSheetViewPublicFactory",Jb.a,[]);var Je=a(7),Jf=a(187),Ue=a(1335),ab=a(859),Nb=a(462);class tc{constructor(qc,Uc,ub,Xb,wc,Tc,sd){this.title=qc;this.body=Uc;this.L4i=ub;this.primaryButtonAction=Xb;this.secondaryButtonAction=Tc;this.b0f=wc;this.targetObject=sd}}Object(b.a)(tc,"NamedSheetViewTeachingCalloutContent",null,[]);class Nc{constructor(qc){this.kle=0;this.Obg=
qc}get Mbg(){return this.kle}get j6i(){return this.Mbg<this.Obg.count?this.Obg.na(this.kle++):null}}Object(b.a)(Nc,"NamedSheetViewTeachingCalloutList",null,[]);var pd=a(1074);class zd{constructor(qc){this.stopwatch=this.I0b=this.mBc=this.YXd=null;this.Nbg=0;this.$=qc}ddi(qc){this.Nbg=qc;const Uc=Object(Je.a)(new Jf.a,{});zd.zli(qc)?(Uc.add(new tc(Hd.a.instance.Ua(444),Hd.a.instance.Ua(445),Hd.a.instance.ga(1934),()=>{this.oI(2,"Continue");this.bK(!0)},Hd.a.instance.ga(1935),()=>{this.bK();this.oI(1,
"ExitGuide")},pd.a())),1===qc&&Uc.add(new tc(Hd.a.instance.ga(1936),Hd.a.instance.Ua(447),Hd.a.instance.ga(1934),()=>{this.oI(2,"FirstEnterTempViewContinueSecond");this.bK(!0)},Hd.a.instance.ga(1935),()=>{this.bK();this.oI(1,"FirstEnterTempViewExitGuideSecond")},pd.a())),Uc.add(new tc(Hd.a.instance.Ua(448),Hd.a.instance.Ua(449),Hd.a.instance.ga(1934),()=>{this.oI(2,"FirstEnterExitCalloutContinue");this.bK(!0)},Hd.a.instance.ga(1935),()=>{this.bK();this.oI(1,"FirstEnterExitCalloutGuide")},zd.R3e())),
Uc.add(new tc(Hd.a.instance.ga(1937),Hd.a.instance.Ua(446),Hd.a.instance.ga(1938),()=>{this.Y7f();this.bK();this.oI(1,"LearnMore")},Hd.a.instance.ga(1939),()=>{this.bK();this.oI(1,"Done")},zd.Q3e()))):2===qc?Uc.add(new tc(Hd.a.instance.ga(1936),Hd.a.instance.Ua(447),Hd.a.instance.ga(1933),()=>{this.bK();this.oI(1,"EnterTempViewAfterPersistedView")},null,null,pd.a())):3===qc&&(Uc.add(new tc(Hd.a.instance.Ua(444),Hd.a.instance.ga(1945),Hd.a.instance.ga(1934),()=>{this.oI(2,"AutoOptInExitCalloutContinue");
this.bK(!0)},Hd.a.instance.ga(1935),()=>{this.bK();this.oI(1,"AutoOptInExitGuide")},zd.R3e())),Uc.add(new tc(Hd.a.instance.ga(1936),Hd.a.instance.Ua(447),Hd.a.instance.ga(1934),()=>{this.oI(2,"Continue");this.bK(!0)},Hd.a.instance.ga(1935),()=>{this.bK();this.oI(1,"ExitGuide")},pd.a())),Uc.add(new tc(Hd.a.instance.ga(1937),Hd.a.instance.Ua(446),Hd.a.instance.ga(1938),()=>{this.Y7f();this.bK();this.oI(1,"LearnMore")},Hd.a.instance.ga(1939),()=>{this.bK();this.oI(1,"Done")},zd.Q3e())));this.YXd=new Nc(Uc)}Y7f(){const qc=
new Pb.a(-859308420,td.a.Db,this.$.Hc,9,null);this.$.Ja.Kb(qc,{[td.a.og]:"HelpID=SheetViews",["InputMethod"]:td.a.Db,[td.a.Jc]:dd.a.qV,["ShouldCanvasTakeFocus"]:!0})}show(qc){this.ddi(qc);this.Ceb()}Svj(qc){this.I0b=qc}Ceb(){var qc=this.YXd.j6i;if(qc){var Uc=Object(Je.a)(new Ue.a,{label:qc.L4i,onExecute:qc.primaryButtonAction}),ub=null;qc.b0f&&(ub=Object(Je.a)(new Ue.a,{label:qc.b0f,onExecute:qc.secondaryButtonAction}));qc=Object(Je.a)(new ab.a,{target:qc.targetObject,content:qc.body,title:qc.title,
showCloseIcon:!0,primaryButtonProps:Uc,secondaryButtonProps:ub,useTeachingStyles:!0});qc=this.I0b.callout(qc);Uc=Object(Je.a)(new Nb.a,{onShow:()=>{this.oI(0)}});this.mBc=this.I0b.addNotification(qc,Uc)}}dismiss(){this.bK();this.oI(1,"DismissedByOthers")}bK(qc=!1){this.mBc&&(this.I0b.removeNotification(this.mBc),this.mBc=null);qc&&this.Ceb()}oI(qc,Uc=null){const ub={};ub.a=this.$.va.UserSessionId;ub.b=this.Nbg;ub.c=this.YXd.Mbg;ub.d=qc;ub.e=Uc;0===qc?this.stopwatch=this.$.Jb.Ac("UserAction","ShowNamedSheetViewTeachingCallout"):
(this.stopwatch&&(this.stopwatch.stop(),ub.f=this.stopwatch.zc,this.stopwatch=null),2===qc&&(this.stopwatch=this.$.Jb.Ac("UserAction","ShowNamedSheetViewTeachingCalloutNext")));pf.b().Qe(52,ub,!0)}static Q3e(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static R3e(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static zli(qc){return 0===qc||1===qc}}Object(b.a)(zd,"NamedSheetViewTeachingCallout",null,[666]);class Sd extends Jb.a{constructor(qc){super();
this.$=qc;this.Fb()}create(){let qc=this.$.da.za(322);qc||(qc=new zd(this.$),this.$.da.Ga(322,qc));this.ob(qc)}static ka(qc){qc.da.Ga(323,new Sd(qc))}}Object(b.a)(Sd,"NamedSheetViewTeachingCalloutFactory",Jb.a,[]);var ke=a(1250),ie=a(1142),Fe=a(1249);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(c.a)();Type.registerNamespace("CADWLTR");f.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.Fi(new K);Object(ea.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(ya.a)();Object(ha.a)();Object(La.a)();Object(Ia.a)();Type.registerNamespace("Common.App.SharedFilePicker");
ba.main();Type.registerNamespace("Common.App.WildFire");ja.main();Object(Va.a)();bb.a.Fa(gb.ka);Object(mb.a)();Object(Ga.a)();Object(ib.a)();cc.a.Oi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{bb.a.Fa(qc=>{fb.ka(qc)})})();(()=>{bb.a.Fa(qc=>{qc.da.Ga(165,new Ob(qc))})})();bb.a.Fa(Ma.ka);Object(va.a)();Object(Pa.a)();Object(Ha.a)();Object(tb.a)();
Object(Ya.a)();Object(V.a)();Object(za.a)();Object(yb.a)();Object(jc.a)();Object(Cc.a)();Object(Fe.a)();bb.a.Fa(Rb.ka);bb.a.Fa(md.ka);Object(Qd.a)();bb.a.Fa(ec.ka);(()=>{bb.a.Fa(qc=>{Ne.ka(qc);Sd.ka(qc)})})();Object(ke.a)();Object(ie.a)()},705:function(u,E,a){a.d(E,"a",function(){return T});u=a(0);var c=a(7),b=a(15),e=a(87),f=a(224),d=a(14),h=a(107),m=a(172),l=a(4),w=a(85);E=a(238);var n=a(1056),y=a(19),t=a(5),r=a(324),v=a(53),B=a(12),A=a(71),z=a(13),x=a(21),D=a(89),J=a(897),L=a(1);class T extends E.a{constructor(O,
G){super(document.createElement("div"));this.Tof=this.Pse=this.ane=this.X3b=this.mca=this.D8=this.nP=this.oz=null;this.Fwa=this.nV=this.xs=this.hideCloseButton=!1;this.LLi=C=>{this.GD(C)};this.RLi=C=>{13===C.keyCode&&this.GD(C)};this.qBd=C=>{this.$m(C.tb);return!0};this.vBd=C=>{this.YV(C.tb);return!0};this.gpc=C=>{this.Bma(C.tb?C.tb:0);return!0};this.MLi=C=>{this.GD(C.Ca);return!0};this.bog=(C=null)=>{this.$m(C.inputMethod?C.inputMethod:0);return!0};this.cog=(C=null)=>{this.YV(C.inputMethod?C.inputMethod:
0);return!0};this.G1=O;this.lD=G;this.nZc=G.f0a.toString();this.title=G.title;this.message=G.message;this.set_visibilityMode(1)}get CXg(){return this.lD.f0a}get businessBar(){return this.G1}get actionButton(){return this.lD?this.lD.actionButton:""}get ysa(){return this.lD?this.lD.ysa:""}get linkText(){return this.lD?this.lD.link:""}get Fk(){return this.lD?this.lD.Fk:""}get alt(){return this.lD?this.lD.alt:""}dBa(O){this.lD.n2b=O}dispose(){e.a.qc([this.X3b,this.nP,this.D8]);this.xs&&this.nP&&(f.a.instance.Ba(d.a.click,
this.nP.domElement,this.qBd),h.KeyInputManager.instance.Tv(this.domElement,this.ane));this.nV&&this.D8&&(f.a.instance.Ba(d.a.click,this.D8.domElement,this.vBd),h.KeyInputManager.instance.Tv(this.domElement,this.Pse));this.Fwa&&this.mca&&(f.a.instance.Ba(d.a.click,this.mca,this.gpc),h.KeyInputManager.instance.Tv(this.domElement,this.Tof));this.mca=this.oz=this.G1=this.D8=this.nP=null;super.dispose()}update(){}bVj(){this.THe(!0)}P4c(){this.THe(!1)}wdh(){this.message=D.a.dg(this.message);this.title=
D.a.dg(this.title);m.UISurfaces.Tgd().then(O=>{O.initializeMessageBarInStore();let G=Object(c.a)(new J.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.lD.n2b,dismissButtonAriaLabel:z.a.instance.ga(10)});this.hideCloseButton||(G.onDismiss=this.MLi);this.Fwa&&(G.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.gpc});this.xs&&(G.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.bog});this.nV&&
(G.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.ysa,["onExecute"]:this.cog});O.createNewMessageBar(this.domElement,G);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized");return null});l.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)}Gch(O){O||
(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var G=this.businessBar.$.Eb;O=G+"ewaBusinessBarEntryBody"+this.nZc;const C=G+"ewaBusinessBarEntryTitle"+this.nZc;var H=G+"ewaBusinessBarEntryIcon"+this.nZc;this.domElement.className=n.a.Rrh;if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&L.EwaSettings.isChangeGateEnabled("OfficeVSO:7073931_CleanUpInnerHtmlInBusinessBarEntry")){G=document.createElement("div");G.className=n.a.gQe;G.id=
O;var I=document.createElement("div");I.className=n.a.fQe;var M=document.createElement("a");M.className=n.a.mQe;M.title=this.alt;const Q=document.createElement("span");Q.classList.add(y.a.qrb);Q.classList.add(n.a.iQe);Q.id=H;this.Fk.length&&(H=document.createElement("img"),H.classList.add(this.Fk),H.src=v.a.we(0),Q.appendChild(H));M.appendChild(Q);I.appendChild(M);H=document.createElement("span");H.classList.add(n.a.lQe);H.id=C;H.innerText=D.a.dg(this.title);I.appendChild(H);H=document.createElement("span");
H.classList.add(n.a.kQe);H.id="message";H.innerText=D.a.dg(this.message);I.appendChild(H);H=document.createElement("a");H.id="link";H.href="#";H.className=n.a.jQe;H.innerText=D.a.dg(this.linkText);I.appendChild(H);H=document.createElement("span");H.classList.add(n.a.y9b);M=document.createElement("button");M.type="button";M.id="action";M.className=n.a.x9b;M.innerText=D.a.dg(this.actionButton);H.appendChild(M);I.appendChild(H);H=document.createElement("span");H.classList.add(n.a.y9b);M=document.createElement("button");
M.type="button";M.id="altAction";M.className=n.a.x9b;M.innerText=D.a.dg(this.ysa);H.appendChild(M);I.appendChild(H);G.appendChild(I);I=document.createElement("a");I.className=n.a.hQe;I.tabIndex=0;I.setAttribute("role","button");H=document.createElement("span");H.id="close";H.classList.add(y.a.qv);M=document.createElement("img");M.classList.add(y.a.S9b);M.src=v.a.we(13);M.alt=z.a.instance.ga(793);M.title=z.a.instance.ga(793);M.setAttribute("role","button");H.appendChild(M);I.appendChild(H);G.appendChild(I);
this.domElement.appendChild(G)}else G="<div class='"+n.a.gQe+"' id='{0}'><div class='"+n.a.fQe+"'><a class='"+n.a.mQe+"' title='{1}'><span class='"+y.a.qrb+" "+n.a.iQe+"' id='{2}'>",this.Fk.length&&(G+="<img class='{3}' src='{4}'/>"),G+="</span></a><span class='"+n.a.lQe+"' id='{5}'>{6}</span><span class='"+n.a.kQe+"' id='message'>{7}</span><a id='link' href='#' class='"+n.a.jQe+"'>{8}</a><span class='"+n.a.y9b+"'><button type='button' id='action' class='"+n.a.x9b+"'>{9}</button></span><span class='"+
n.a.y9b+"'><button type='button' id='altAction' class='"+n.a.x9b+"'>{10}</button></span></div><a class='"+n.a.hQe+"' tabindex='0' role='button'><span id='close' class='"+y.a.qv+"'><img class='"+y.a.S9b+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>",this.domElement.innerHTML=String.format(G,O,this.alt,H,this.Fk,v.a.we(0),C,this.title,this.message,this.linkText,this.actionButton,this.ysa,v.a.we(13),z.a.instance.ga(793));B.DOMElementExtensions.Nu(this.domElement,t.a.Hsa,C,O);
this.mca=$get("link",this.domElement);B.DOMElementExtensions.setVisible(this.mca,this.Fwa);this.Fwa&&(f.a.instance.ta(d.a.click,this.mca,this.gpc),this.Tof=h.KeyInputManager.instance.Ls(this.mca,this.gpc,w.a.Lh,w.a.AX));this.nP=new r.a(B.DOMElementExtensions.getElementById(this.domElement,"action"));this.nP.isVisible=this.xs;this.D8=new r.a(B.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.D8.isVisible=this.nV;this.xs&&(f.a.instance.ta(d.a.click,this.nP.domElement,this.qBd),
this.ane=h.KeyInputManager.instance.Ls(this.nP.domElement,this.qBd,w.a.Lh,w.a.AX),this.nV&&(f.a.instance.ta(d.a.click,this.D8.domElement,this.vBd),this.Pse=h.KeyInputManager.instance.Ls(this.nP.domElement,this.vBd,w.a.Lh,w.a.AX)));this.oz=$get("close",this.domElement);this.X3b=this.Ce.Zd(this.oz);this.X3b.ka("click",this.LLi);this.X3b.ka("keydown",this.RLi);B.DOMElementExtensions.setVisible(this.oz,!this.hideCloseButton)}THe(O){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)&&l.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?this.wdh():this.Gch(O)}$m(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.lD.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.lD.j$c}`);x.h(this.businessBar.$).Uo(!0)}YV(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.lD.hash}]: BusinessBarEntry.OnAltActionClick()`);x.h(this.businessBar.$).Uo(!0)}Bma(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.lD.hash}]: BusinessBarEntry.OnLinkClick()`);x.h(this.businessBar.$).Uo(!0)}GD(O){b.ULS.sendTraceTag(21517971,
0,50,`BusinessBar [${this.lD.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.lD.j$c}`);this.set_visible(!1);this.businessBar.removeEntry(this.CXg);A.g(O)}nK(){return L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&l.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?this.domElement.getElementsByTagName("button")[0]:this.nP.domElement}}Object(u.a)(T,"BusinessBarEntry",E.a,[])},782:function(u,E,a){a.r(E);u=a(0);var c=a(7),b=a(15),e=a(4);a(27);var f=
a(383),d=a(38),h=a(50),m=a(12),l=a(127),w=a(1),n=a(13),y=a(21);class t extends Sys.EventArgs{constructor(H){super();this.Q4i=H}}Object(u.a)(t,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var r=a(259),v=a(247);class B{constructor(H){this.tg=H}ai(){r.a(this.tg.$).pB(this.de)||r.a(this.tg.$).ai(this)}q8(){r.a(this.tg.$).pB(this.de)&&r.a(this.tg.$).Xz(this)}get de(){return v.a.lNf}get mc(){const {PrintPreviewPane:H}=a(782);return document.getElementById(H.O4i)}get Gf(){return!0}mh(H){return m.DOMElementExtensions.yf(this.mc,
H)}sj(){this.tg.$.frame.Me.wk(this.tg.$.frame.Me.mF)}Zj(){}kg(H,I){return I?!1:(this.tg.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(u.a)(B,"PrintPreviewHeaderKeyboardAccessibleSection",null,[36]);class A{constructor(H){this.tg=H}ai(){r.a(this.tg.$).pB(this.de)||r.a(this.tg.$).ai(this)}q8(){r.a(this.tg.$).pB(this.de)&&r.a(this.tg.$).Xz(this)}get de(){return v.a.mNf}get mc(){const {PrintPreviewPane:H}=a(782);return this.tg.useMSPdfViewer?document.getElementById(a(782).PrintPreviewPane.sFd):document.getElementById(H.JKf)}get Gf(){return!0}mh(H){return m.DOMElementExtensions.yf(this.mc,
H)}sj(){this.tg.$.frame.Me.wk(this.tg.$.frame.Me.mF)}Zj(){}kg(H,I){return I?!1:(this.tg.useMSPdfViewer?(H=document.getElementById(a(782).PrintPreviewPane.sFd))&&m.DOMElementExtensions.setFocus(H,!0):m.DOMElementExtensions.setFocus(this.tg.fL),!0)}}Object(u.a)(A,"PrintPreviewKeyboardAccessibleSection",null,[36]);class z{constructor(H){this.tg=H}ai(){r.a(this.tg.$).pB(this.de)||r.a(this.tg.$).ai(this)}q8(){r.a(this.tg.$).pB(this.de)&&r.a(this.tg.$).Xz(this)}get de(){return v.a.oNf}get mc(){const {PrintPreviewPane:H}=
a(782);return document.getElementById(H.wHd)}get Gf(){return!0}mh(H){return m.DOMElementExtensions.yf(this.mc,H)}sj(){this.tg.$.frame.Me.wk(this.tg.$.frame.Me.mF)}Zj(){}kg(H,I){return I?!1:(this.tg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)}}Object(u.a)(z,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[36]);class x{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(u.a)(x,"MSPdfViewerFileUrl",null,[]);class D{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=
this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(u.a)(D,"PrintSettingsTaskPaneProps",null,[]);class J{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(u.a)(J,"ViewerPaneProps",
null,[]);var L=a(1077),T=a(378),O=a(5);class G{}G.printDialogTitle="PrintDialogTitle";G.z9b="ewa-dlg-elements-container-rtl";G.$w="PrintPreviewerContainer";Object(u.a)(G,"CssClassNames",null,[]);a.d(E,"PrintPreviewPane",function(){return C});class C extends d.a{constructor(H,I,M,Q){super();this.mDb=this.olc=this.fL=this.iIb=this.$w=this.kW=this.WD=this.fG=null;this.lDb=!1;this.uxa=!0;this.xHd=this.tHd=this.uHd=this.ewaAccessibilityManager=this.erc=null;this.wpd=!1;this.VCf=()=>{b.ULS.sendTraceTag(537154206,
0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.lDb}`);this.lDb&&(this.L$h(),this.fL.style.visibility="visible",this.olc?this.olc.stop():b.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),this.raiseEvent(C.ZEb,new t(1)),this.aRd(),this.lDb=!1)};this.$=H;this.VD=I;this.idh();this.useMSPdfViewer=M;this.isUniversalPrintEnabled=Q;this.bI=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",
!1);this.isExportPdfMode=!1}lLg(H){this.addHandler(C.ZEb,H)}rgj(H){this.removeHandler(C.ZEb,H)}wFj(H){this.isExportPdfMode=H;this.ddh()}xFj(){var H=this.$.Jb.Ac("UserAction","createSettingsPaneStopwatch");const I=document.getElementById(C.wHd);this.kdh();const M=this.ldh();this.WD.createPrintSettingsTaskPane(I,M);H.stop();this.lDb=!1;if(this.isUniversalPrintEnabled&&this.$w){H="A4";switch(M.selectedPrintSettingsValues.selectedPaperSize){case 8:H="A3";break;case 9:H="A4";break;case 11:H="A5";break;
case 12:H="JIS B4";break;case 13:H="JIS B5";break;case 5:H="North America Legal";break;case 1:H="North America Letter";break;case 6:H="North America Invoice";break;case 7:H="North America Executive";break;case 3:H="North America Ledger"}this.fG.setDocumentSettings({mediaSize:H,orientation:2===M.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===M.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.lKd()}setPageRangeSettings(H,I,M,Q,U){this.WD&&
(this.WD.setPageRangeSettings(H,I,M,Q,U),this.M3f(String.format(n.a.instance.nb(205),Q,U,H)))}A$h(){this.$w&&(this.$w.style.display="none")}Vlh(){this.dispose();this.J_d();this.VSj();this.fG&&this.fG.closePrintPreviewPane();this.kW=this.WD=this.fG=this.$w=null}fxi(H){b.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.mDb=this.$.Jb.Ac("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||b.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),
this.kW.renderPdf(H)):this.fL&&((this.olc=this.$.Jb.Ac("UserAction","loadPdfStopwatch"))||b.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.lDb=!0,this.fL.src&&this.fL.src===H?this.VCf(null):this.fL.src=H);if(this.bI&&this.$w){const I=T.b(this.$.workbookContext);this.fG.setFileUrl(H,I)}}onPdfLoad(){this.mDb?(b.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.mDb.zc} ms, isFirstTimeLoad: ${this.uxa}`),this.mDb.stop()):
b.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(C.ZEb,new t(1));this.hideWaitCursor();this.aRd()}printPdf(){m.DOMElementExtensions.setFocus(this.fL);this.fL.contentWindow.print()}nGj(){this.showSpinner();this.showWaitCursor();this.M3f("")}L$h(){this.hideSpinner();this.hideWaitCursor()}fA(H,I,M=null){this.$w&&this.kW&&(this.wpd=!1,this.kW.showErrorDetails(I,H,M),this.VD.b7a=!0,this.fL&&(this.fL.src=""),this.disablePrintButton(),
this.hideWaitCursor(),C.Aoi(I)&&(this.wpd=!0,this.ITi()))}hidePreviewError(){this.VD.b7a=!1;this.kW.hidePreviewError();this.enablePrintButton()}Mlh(){(this.iIb=document.getElementById(C.nNf))&&this.iIb.parentNode&&this.iIb.parentNode.removeChild(this.iIb)}hideErrorMessageForPrintOptions(){this.WD&&this.WD.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(H){this.WD&&this.WD.showErrorMessageForPrintOptions(H)}showSpinner(){this.VD.b7a||this.wpd?this.hidePreviewError():this.fL&&(this.fL.style.visibility=
"hidden");this.kW&&this.kW.showSpinner()}hideSpinner(){this.kW&&this.kW.hideSpinner()}enablePrintButton(){this.WD&&this.WD.enablePrintButton();this.bI&&this.$w&&this.fG.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.WD&&this.WD.disablePrintButton();this.bI&&this.$w&&this.fG.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.WD&&this.WD.showWaitCursor();this.bI&&this.$w&&this.fG.updatePrintButtonEnableDisableState(!1)}hideWaitCursor(){this.WD&&this.WD.hideWaitCursor();
this.bI&&this.$w&&this.fG.updatePrintButtonEnableDisableState(!0)}gdh(){if(this.$w)b.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.$w=document.createElement("div"),this.$w.id=C.nNf,this.$w.classList.add(C.R4i),this.$.vr.insertBefore(this.$w,this.$.vr.firstChild),e.AFrameworkApplication.sa&&e.AFrameworkApplication.sa.Pa.Ye){const H=document.getElementById(O.a.Csa);H&&(this.$w.style.top=`${H.clientHeight}px`,
this.$w.style.height=`calc(100vh - ${H.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.fG.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.fG.enterPrintSettingsTaskPaneFocusTrapZone()}C2i(){this.$.da.$a(15,H=>{this.ewaAccessibilityManager=H;this.ewaAccessibilityManager.mode=3})}idh(){this.xHd=new z(this);this.uHd=new A(this);this.tHd=new B(this)}lKd(){this.xHd.ai();this.uHd.ai();this.tHd.ai();this.C2i()}J_d(){this.xHd.q8();this.uHd.q8();this.tHd.q8();
y.h(this.$).R0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}tO(){this.erc=l.a.instance.Zd(this.fL);this.erc.ka("load",this.VCf)}VSj(){this.erc&&this.fL&&this.erc.detach("load")}aRd(){this.bI?this.R2f(C.P4i,C.nHi):this.R2f(C.wHd,C.hNf)}R2f(H,I){this.uxa&&(H=document.getElementById(H))&&(I=m.DOMElementExtensions.getElementById(H,I))&&(this.uxa=!1,I.focus())}ITi(){this.VD.b7a=!1;this.enablePrintButton();this.aRd()}ddh(){const H=h.GetServiceTaskFactory.Oa(this.$.da,283,284,0).result.ln;
H.loadScript("excel-print-preview-sprite").then(()=>{H.loadScript("printPreviewer").then(()=>{H.loadScript("excelPrintPreviewer").then(()=>{this.jdh()})},()=>{b.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},()=>{b.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}jdh(){const H=this.$.Jb.Ac("UserAction",
"createEmptyPreviewerStopwatch");this.gdh();this.hdh();this.bI?this.fG.createEmptyPrintPreviewPaneAsync(this.$w,this.ZHe()).then(()=>{H.stop();this.OEe();this.fG.updatePrintButtonEnableDisableState(!1)}):(this.fG.createEmptyPrintPreviewPane(this.$w,this.ZHe()),H.stop(),this.OEe())}OEe(){const H=this.$.Jb.Ac("UserAction","createPdfPreviewPaneStopwatch"),I=document.getElementById(C.sFd);this.useMSPdfViewer&&(I.tabIndex=0);this.Qch();this.Pch(I);H.stop();this.raiseEvent(C.ZEb,new t(0))}hdh(){this.fG||
(this.fG=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.fG||b.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}kdh(){this.WD||(this.WD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.WD||b.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}Qch(){this.kW||
(this.kW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.kW||b.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}Pch(H){this.kW.createPrintPreviewPane(H,this.ufh());this.useMSPdfViewer||(this.fL=m.DOMElementExtensions.getElementById(this.$w,C.JKf),this.fL.title=n.a.instance.ga(1208),this.tO())}ldh(){let H,I="en-US";H=this.$.va.IsMetricMeasurementUnit;this.$.va.DataCultureTag?
I=this.$.va.DataCultureTag:b.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(c.a)(new D,{whatToPrintOptions:this.VD.Kv.whatToPrintOptions,orientationOptions:this.VD.Kv.orientationOptions,paperSizeOptions:this.VD.Kv.paperSizeOptions,scalingOptions:this.VD.Kv.scalingOptions,marginDetailedOptions:this.VD.bWh(),selectedPrintSettingsValues:this.VD.YYh(),printSettingsTaskPaneCallbacks:this.VD.WYh(),
logger:new f.a,shouldDisableCurrentSelection:this.VD.W5f(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:H,dataCultureTag:I,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}ZHe(){return this.bI?this.VD.UYh():Object(c.a)(new L.a,{backActionButtonText:n.a.instance.ga(1206),printPreviewPaneCallbacks:this.VD.b5e(),logger:new f.a,disableTellMeControl:!0,isExportPdfMode:!1})}ufh(){return this.useMSPdfViewer?Object(c.a)(new J,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.cch(),onPdfLoad:()=>
{this.onPdfLoad()}}):Object(c.a)(new J,{useMSPdfViewer:!1})}cch(){return Object(c.a)(new x,{pdfViewerWorkerUrl:this.$.va.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.va.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.va.PrintPreviewerMSPdfKitWasmUrl})}M3f(H){this.$w&&this.fG.setAdditionalHeaderText(H)}static Aoi(H){return 3===H||2===H}}C.nNf="PrintPreviewerContainer";C.wHd="printSettingsTaskPaneId";C.sFd="previewId";C.JKf="printpreviewiframe";C.O4i="printPreviewHeaderId";C.hNf="printButton";
C.P4i="printPreviewPaneId";C.nHi="printButtonId";C.R4i=G.$w;C.ZEb="pppnosu";Object(u.a)(C,"PrintPreviewPane",d.a,[716])},835:function(u,E,a){a.d(E,"a",function(){return d});u=a(0);var c=a(15),b=a(4),e=a(40),f=a(27);class d{static k_e(h,m){switch(h){case 3:return d.c4h(m);case 2:return d.TXh(m);case 1:return d.bSh(m)}return""}static c4h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static TXh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static bSh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,m,l){if(f.a.Yg||f.a.Ap)window.setTimeout(()=>{d.vRf(l,d.Hdc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.Dte(l),h,0,!1)}static Z2g(h,m,l,w){m&&
w&&w();d.openInClient(h,m,l)}static Hdc(){return f.a.Yg?1:f.a.Ap?2:f.a.D8a?3:f.a.isMac?4:0}static Z3h(h){switch(h){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static $3h(h){switch(h){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get NAb(){return"zh-CN"===window.navigator.language}static vRf(h,m){1===m?(c.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),h=d.k_e(h,m),8<f.a.i6a?e.a.lf(h,void 0,void 0,"RedirectToAppStore"):e.a.YU(h)):document.hidden||(d.NAb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.YU(h)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.k_e(h,
m),null,null)))}static Dte(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get dzc(){return(f.a.D8a||f.a.isMac)&&f.a.Bp}static get BCj(){return f.a.Yg||f.a.Ap}static Aed(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Nqd(h){return(h=d.ZUh(h))&&""!==h?Boolean.parse(h):!1}static WRd(h){d.pvj(h)}static ZUh(h){try{return localStorage.getItem(h)}catch(m){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+m.message),null}}static pvj(h){try{localStorage.setItem(h,"true")}catch(m){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+m.message)}}}d.FBe="ChromeExtensionBarDismiss";Object(u.a)(d,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/5998772de2061f05b4f85d0c7bae660c/EwaDSEsNext.kmhv.js.map