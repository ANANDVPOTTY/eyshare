'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1198:function(u,E,a){u=a(0);var c=a(84),b=a(15),e=a(137),f=a(40);class d{constructor(z){this.qga=this.kga=this.uga=this.tga=null;this.o$d=this.Ice=this.tx=this.hM=!1;this.dRc=this.Yce=null;this.Qce=0;this.lb=this.Wce=null;this.U1=z;this.sA=3;this.Wjb=!0}initialize(z,x,D){this.tga=this.Uhd(z,x);this.uga=CommonUIStrings.l_SavingStatus;this.kga=CommonUIStrings.l_ReadOnlyStatus;this.qga=CommonUIStrings.l_ReviewModeStatus;
this.U1&&this.U1.execute(J=>{J.JWc(Object(c.a)(this,this.mQb,"updateToSavingStatus"))});this.tx=!0;this.lb=D;return!0}Tea(z,x){this.hM=z;this.sA=x;this.ES(this.Wjb)}ES(z){!this.Wjb&&z&&(this.Wce=new Date);this.Wjb=z;z=null;3===this.sA&&(z=this.Wjb?this.tga:this.uga);this.nlh(z)}Uhd(z,x){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):x&&x.length?String.format(CommonUIStrings.l_SavedToStatus,x):CommonUIStrings.l_SavedStatus}mQb(){this.ES(!1)}pWh(){switch(this.sA){case 1:return this.kga;
case 2:return this.qga;default:return null}}Eki(z){return this.Ice===this.hM&&this.Qce===this.sA&&this.Yce===z}e8c(z){appChrome.getHeaderApi().then(x=>{x.updateDocumentTitleStatus(this.hM,z,this.pWh(),this.Wce,this.Wjb);this.o$d=!0;return null});this.dRc=null}nlh(z){this.tx&&e.c()&&!this.Eki(z)&&(!this.o$d&&this.lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.e8c(z):f.a.TWf()?(this.dRc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.dRc=window.requestIdleCallback(()=>{this.e8c(z)})):window.requestAnimationFrame(()=>{this.e8c(z)}),this.Ice=this.hM,this.Yce=z,this.Qce=this.sA)}}Object(u.a)(d,"ReactSaveStatusUIHandler",null,[389]);var h=a(164);class m{constructor(z,x){this.As=null;this.tga=CommonUIStrings.l_SavedStatus;this.uga=CommonUIStrings.l_SavingStatus;this.kga=CommonUIStrings.l_ReadOnlyStatus;this.qga=CommonUIStrings.l_ReviewModeStatus;this.qUb=x;this.U1=z;this.sA=3;this.Bra=!0}Ns(){this.U1&&this.U1.execute(z=>{z.JWc(Object(c.a)(this,
this.mQb,"updateToSavingStatus"))});this.qUb.execute(z=>{this.As=z})}Tea(z,x){this.sA=x;3===x?this.ES(this.Bra):2===x?this.o_d(this.qga):this.o_d(this.kga)}mQb(){this.ES(!1)}ES(z){this.Bra=z;this.o_d(this.Bra?this.tga:this.uga)}o_d(z){this.As&&this.As.Pj(h.a.KSj,this.O6g(z))}O6g(z){const x={};x.StatusText=z;return x}}Object(u.a)(m,"SaveStatusPostMessageHandler",null,[389]);var l=a(93),w=a(123),n=a(56);class y{constructor(z,x,D,J){this.qga=this.kga=this.uga=this.tga=null;this.UEa=0;this.AE=this.QRc=
this.jDa=this.zGc=this.SFa=null;this.Md=z;this.j9=x;this.U1=D;this.pj=J;this.cbe=!0;this.hM=!1;this.sA=3;this.Bra=!0}initialize(z,x){if(!this.Md)return!1;this.tga=this.Uhd(z,x);this.uga=CommonUIStrings.l_SavingStatus;this.kga=CommonUIStrings.l_ReadOnlyStatus;this.qga=CommonUIStrings.l_ReviewModeStatus;this.Ns();return!0}Uhd(z,x){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):x&&x.length?String.format(CommonUIStrings.l_SavedToStatus,x):CommonUIStrings.l_SavedStatus}Ns(){this.j9&&
this.j9.execute(z=>{z.ILg(Object(c.a)(this,this.vIe,"createStatusAndModeElements"));z.zLg(Object(c.a)(this,this.EEj,"showHideSaveStatusElement"));z.yPj&&this.vIe(null,null)});this.U1&&this.U1.execute(z=>{z.JWc(Object(c.a)(this,this.mQb,"updateToSavingStatus"))})}Uv(){this.AE&&this.Md&&this.Md.HG(this.AE)}EEj(z,x){this.Tea("true"===x,this.sA)}Tea(z,x){this.hM=z;this.sA=x;this.zGc&&(this.zGc.style.display=this.hM||3===this.sA||!this.SFa?"none":"");this.jDa&&(this.jDa.style.display=this.hM||3===this.sA?
"none":"",this.jDa.innerText=1===this.sA?this.kga:this.qga,this.jDa.title=1===this.sA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.QRc&&(this.QRc.style.display=this.hM||1===this.sA||!this.SFa&&!this.jDa?"none":"");this.AE&&(this.AE.style.display=this.hM||1===this.sA?"none":"",this.ES(this.Bra),this.AE.title=CommonUIStrings.l_SaveStatusTooltip)}vIe(z,x){z=document.getElementById(l.CuiHelper.taf);x&&x.E1j||!z||""===this.tga||""===this.uga||""===this.kga||""===
this.qga||(this.SFa=document.getElementById(l.CuiHelper.b2b),this.zGc=l.CuiHelper.Hta(z,"BreadcrumbAppModeDash","-",null,!1),this.jDa=l.CuiHelper.Hta(z,"BreadcrumbAppModeStatus",1===this.sA?this.kga:this.qga,null,!1),this.fhg(this.jDa),this.QRc=l.CuiHelper.Hta(z,"BreadcrumbSaveStatusDash","-",null,!1),this.AE=l.CuiHelper.Hta(z,"BreadcrumbSaveStatus",this.tga,null,!1),this.fhg(this.AE),this.Tea(this.hM,this.sA))}mQb(){this.ES(!1)}ES(z){this.Bra=z;this.RXj(this.Bra?this.tga:this.uga)}RXj(z){!this.AE||
3!==this.sA&&2!==this.sA||(this.cbe&&!this.Bra?(this.UEa=this.AE.offsetWidth<this.UEa?this.UEa:this.AE.offsetWidth,this.MUj(this.uga),this.cbe=!1):this.AE.innerText=z)}fhg(z){z.style.direction=this.pj?"rtl":"ltr";z.style.width="auto";z.style.textAlign=this.pj?"right":"left";z.style.display=this.hM?"none":"";z.setAttribute("Unselectable","on")}MUj(z){this.AE&&(this.AE.style.width="",this.AE.innerText=z,this.UEa=this.AE.offsetWidth<this.UEa?this.UEa:this.AE.offsetWidth,z=w.a.lB(this.AE),this.AE.style.width=
this.UEa-n.a.OD(z.paddingLeft)-n.a.OD(z.paddingRight)+1+"px")}}Object(u.a)(y,"SaveStatusUIHandler",null,[389]);var t=a(4),r=a(92);class v{constructor(){this.RRc=this.SQc=this.mmb=this.gb=null}get name(){return"Common.App.SaveStatus"}Wh(z){this.gb=z;t.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&t.AFrameworkApplication.hideHeaderEmbedded?this.gb.register(m,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").xc().Fc(()=>new m(this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"),
this.gb.Ub("Postmessage.IHostPostmessenger"))):t.AFrameworkApplication.sa.Pa.zlf||(t.AFrameworkApplication.sa.Pa.Es?this.gb.register(d,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").xc().Fc(()=>new d(this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"))):this.gb.register(y,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").xc().Fc(()=>new y(r.EventHandlerManager.instance,this.gb.Ub("Common.App.Header.HeaderEventSource"),
this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"),t.AFrameworkApplication.isRtl)))}init(){t.AFrameworkApplication.fa.Dv(Object(c.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){const z=t.AFrameworkApplication.fa,x=!!t.AFrameworkApplication.sa.Pa&&4===t.AFrameworkApplication.sa.Pa.Gj;if(z.qa("WordEditorAutoSaveImprovementIsEnabled")||z.qa("PptEditorSaveStatusInHeaderEnabled")||x&&z.qa("SimplifiedReactRibbonUxIsEnabled")||z.qa("ExcelSaveStatusInHeaderEnabled")||z.qa("VisioSaveStatusInHeaderEnabled"))t.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&
t.AFrameworkApplication.hideHeaderEmbedded?(this.RRc=this.gb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.RRc.Ns():t.AFrameworkApplication.sa.Pa.zlf||(t.AFrameworkApplication.sa.Pa.Es?(this.SQc=this.gb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.SQc.initialize(z.qa("IsSkyDrive"),z.Xa("HostNameToIncludeInSavedStatus"),t.AFrameworkApplication.fa):(this.mmb=this.gb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.mmb.initialize(z.qa("IsSkyDrive"),
z.Xa("HostNameToIncludeInSavedStatus")))}dispose(){this.mmb&&this.mmb.Uv()}}Object(u.a)(v,"PackageManager",null,[4,5]);var B=a(248);a.d(E,"a",function(){return A});const A=()=>{Type.registerNamespace("Common.App.SaveStatus");B.a.instance.Fi(new v)}},1256:function(u,E,a){var c=a(9);u=a(0);var b=a(82),e=a(222),f=a(226),d=a(29),h=a(21);class m{constructor(y,t){this.Pie=this.iMc=!1;this.Bza=(r,v)=>{(null===v||void 0===v?0:v.AH)&&d.a.CQg([v.AH])&&(this.jLb=!0)};this.Oo=()=>{this.jLb=!1};this.Tc=(r,v)=>
{f.b(v)&&this.Tea(!0);this.jLb=!1};this.dd=()=>{this.wN=this.$.wN;this.Tea()};this.kGf=()=>{this.ES()};this.nFf=()=>{this.wN=this.$.wN};this.LBd=()=>{h.h(this.$).Ea.gx(this.LBd);this.wN=this.$.wN};this.ZZf=t;this.$=y;this.$.userOperationManager.ur(this.nFf);this.$.ml(this.dd);this.$.ea.hMg(this.kGf);this.$.ea.Uj(this.Tc);this.$.O_b(this.Bza);this.$.ea.uM(this.Oo);this.Tea()}get Sui(){return this.$.ea?this.$.ea.fof:!1}get wN(){return this.iMc}set wN(y){y?this.iMc=!0:h.h(this.$)&&h.h(this.$).Ea&&(h.h(this.$).Ea.h5()?
this.iMc=!1:h.h(this.$).Ea.hw(this.LBd));this.ES()}get jLb(){return this.Pie}set jLb(y){this.Pie=y;this.ES()}dispose(){this.$&&(this.$.Jl(this.dd),this.$.zuc(this.Bza),this.$.userOperationManager&&this.$.userOperationManager.ko(this.nFf),this.$.ea&&(this.$.ea.chj(this.kGf),this.$.ea.uk(this.Tc),this.$.ea.VR(this.Oo)),h.h(this.$)&&h.h(this.$).Ea&&h.h(this.$).Ea.gx(this.LBd))}Tea(y=!1){y=!this.$.isEditMode||y;this.ZZf.Tea(y,this.$.isEditMode?3:1);this.ES()}ES(){this.$.isEditMode&&this.ZZf.ES(!this.wN&&
!this.Sui&&!this.jLb)}}Object(u.a)(m,"SaveStatusManager",null,[2]);var l=a(695);class w extends e.a{constructor(y){super();this.Lc=y;this.Fb()}create(){const y=b.a.instance;y.Ub("Common.App.SaveStatus.ISaveStatusUIHandler").execute(t=>{const r=new m(this.Lc,t);y.register(m,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").xc().Fc(()=>r);t=Object(l.a)(this.Lc.da,300,()=>y.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.ob(t)})}static ka(y){y.da.Ga(299,
new w(y))}}Object(u.a)(w,"SaveStatusFactory",e.a,[]);a.d(E,"a",function(){return n});const n=()=>{c.a.Fa(w.ka)}},1401:function(u,E,a){a.r(E);u=a(1198);a=a(1256);Type.registerNamespace("_Ewa");Object(u.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.savestatus.js.map/159b25010ecf63447da7dc22a2f80973/EwaDSEsNext.savestatus.js.map